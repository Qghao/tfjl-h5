window.__require=function e(t,o,i){function a(r,s){if(!o[r]){if(!t[r]){var c=r.split("/");if(c=c[c.length-1],!t[c]){var l="function"==typeof __require&&__require;if(!s&&l)return l(c,!0);if(n)return n(c,!0);throw new Error("Cannot find module '"+r+"'")}r=c}var d=o[r]={exports:{}};t[r][0].call(d.exports,function(e){return a(t[r][1][e]||e)},d,d.exports,e,t,o,i)}return o[r].exports}for(var n="function"==typeof __require&&__require,r=0;r<i.length;r++)a(i[r]);return a}({AI:[function(e,t,o){"use strict";cc._RF.push(t,"88f7fRcLXxLsK3Cz8cmxono","AI"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../utils/ConfigUtils"),a=e("../../utils/NameManager"),n=e("../CombatManager"),r=e("../../combat/unit/DropEquipObj"),s=e("../../common/CombatModule"),c=e("../../utils/ConstValue"),l=e("../../utils/GameUtils"),d=e("../../modules/manager/cheat/SafeNumber"),u=e("../../network/protocol/TypeProtocols"),h=function(){function e(){this.delta=0,this.index=1,this.aiId=0,this.tbHeroList=[],this.aiSex=0,this.aiName="",this.aiHeadIconId=1,this.nRefreshTime=0,this.usedheroList=[],this.autoManaged=!0,this.delayTime=3e3,this.delayAction=c.AI_Atcion.none,this.carObj=null,this.playerModel=null,this.tbRandomList=[],this.unUsedHeroList=[]}return e.prototype.init=function(e,t){var o=this;if(this.aiId=e,this.carObj=t,this.playerModel=n.default.getInstance().getPlayerModelByCamp(this.carObj.camp),n.default.getInstance().isSkyCastleEnemy(this.carObj.camp)){var i=n.default.getInstance().getController().getCheatValueCom();i&&i.checkObjCheat(this.playerModel,this.playerModel.getProtectStr),this.playerModel.money+=1e3,i&&i.protectObj(this.playerModel,this.playerModel.getProtectStr)}if(this.aiSex=Math.floor(2*Math.random()),this.aiName=a.default.getInstance().getName(this.aiSex),this.aiHeadIconId=Math.floor(8*Math.random())+1,!n.default.getInstance().isSkyCastle()||this.playerModel.camp!=c.PLAYER_CAMP.opponents&&this.playerModel.camp!=c.PLAYER_CAMP.opponentsCoop)s.default._matchPlayerCards&&s.default._matchPlayerCards.forEach(function(e){o.tbHeroList.push(e.heroID)});else{var r=s.default.getMatchBattleAIInfo(this.playerModel.camp);r&&r.heros.forEach(function(e){o.tbHeroList.push(e.heroID)})}this.carObj.aiInfo&&(this.delta=this.carObj.aiInfo.delta,this.index=this.carObj.aiInfo.index,this.nRefreshTime=this.carObj.aiInfo.nRefreshTime,this.usedheroList=this.carObj.aiInfo.usedheroList,this.autoManaged=this.carObj.aiInfo.autoManaged,this.delayAction=this.carObj.aiInfo.delayAction)},e.prototype.unbind=function(){this.delta=0,this.index=1,this.aiId=0,this.tbHeroList=[],this.aiSex=0,this.aiName="",this.aiHeadIconId=1,this.nRefreshTime=0,this.usedheroList=[],this.autoManaged=!0,this.delayTime=3e3,this.delayAction=c.AI_Atcion.none,this.carObj=null,this.playerModel=null,this.tbRandomList=[],this.unUsedHeroList=[]},e.prototype.update=function(e){if(s.default.matchType==u.FIGHT_TYPE.FIGHT_TYPE_BATTLE_GREAT_SAILING)return!1;this.delta=this.delta+1e3*e;var t=i.default.getInstance().getAIConfig(this.aiId,this.index);if(null!=t){if(this.delta<t.time)99999999==t.time&&(this.index-=1);else if(!(this.delayAction!=c.AI_Atcion.none&&this.delta<t.time+this.delayTime)){if(this.nRefreshTime<t.refresh){for(var o=this.nRefreshTime+1;o<=t.refresh;o++){if(C=this.getCostByReTimes(o),!1===(m=this.playerModel.useMoney(C)))return void(this.delayAction=c.AI_Atcion.refreshCard);this.nRefreshTime=o}this.nRefreshTime=t.refresh,this.playerModel.combatStatistic.refreshTimes=this.nRefreshTime}var a=t.carLevel;if(this.playerModel.getLevel()<a&&-2===(m=this.playerModel.reqCarLevelUp()))return void(this.delayAction=c.AI_Atcion.updateCar);var r=t.heroInfo.split("|");for(var d in r){var h=r[d].split("#"),p=Number(h[0]);if(p>0){var f=Number(h[1]),g=this.playerModel.getHeroLevel(p);if(g<f){var m;if(-1===(m=this.playerModel.reqHeroLevelUp(p))&&p!=c.Enum_Elf_Card.huanElf)return void(this.delayAction=c.AI_Atcion.buycard);1!=m||!this.onCheckCardIsSpirit(p)||s.default.matchRoleIdentity!=c.PLAYER_IDENTITY.home&&1!=s.default.opponentsReplaced||cc.director.emit("Event_SummonSpirit",p,this.carObj.camp)}else g>=1&&0===f&&1==n.default.getInstance().getPlayerModelByCamp(this.carObj.camp).reqSellHero(p)&&(cc.director.emit("Event_changeHero",this.carObj.camp,p),cc.director.emit("Event_SellHero",this.carObj.camp,p))}}this.delayAction=c.AI_Atcion.none,this.delta=0,this.index=this.index+1}}else{if(0==this.autoManaged)return;if(this.delta<this.delayTime)return;if(this.usedheroList.length>0){var _=l.getRand(this.usedheroList.length),y=this.usedheroList[_],v=this.getCostByHeroId(y);return this.playerModel.getCurMoney()>=v&&this.buyCard(y,_),void(this.delta=0)}var C=this.getCostByReTimes(this.nRefreshTime);this.playerModel.getCurMoney()>=C&&(this.playerModel.combatStatistic.countRefreshTime(1),this.playerModel.useMoney(C),this.refreshCard())}},e.prototype.onDropEquip=function(e,t){for(var o=0,a=i.default.getInstance().getEquipByID(Number(e)),n=0;n<a.length;n++)a[n].star>o&&(o=a[n].star);var c=!1,l=s.default.getDropEquipList(),d=l[this.carObj.camp]?l[this.carObj.camp]:[];for(n=0;n<d.length;n++)if(d[n]._templateId==Number(e)&&d[n].starNum>=o){c=!0;break}if(1!=c){var u=0;for(n=0;n<d.length;n++)d[n]._templateId==Number(e)&&d[n].starNum>u&&(u=d[n].starNum);if(!(u>=Number(t))){var h=new r.default;h.init(Number(e),null,null,this.carObj.camp,null),s.default.pushDropEquipList(h)}}},e.prototype.onCheckCardIsSpirit=function(e){return 2==i.default.getInstance().getHeroConfig(e).hero_type},e.prototype.getCostByReTimes=function(e){if(0==e)return 5;var t=i.default.Instance.getRandomConstfig();for(var o in t)if(e>=t[o].min_times&&e<=t[o].max_times)return n.default.getInstance().isCoop()?t[o].const_coop:t[o].const},e.prototype.getCostByHeroId=function(e){var t=i.default.getInstance().getHeroConfig(e),o=this.playerModel.getHeroLevel(e);return t.starSellPrice.split("|")[o]},e.prototype.arrOverAdd=function(e){if(!e||e.length<=0)return[];for(var t=[],o=0;o<e.length;o++)t[o]=0==o?parseInt(e[o]):t[o-1]+parseInt(e[o]);return t},e.prototype.getArrIndex=function(e,t){var o=0;if(e>=t[t.length-1])return t.length-1;for(var i=0;i<this.tbHeroList.length;i++){if(e<=t[i]){o=i;break}if(e>t[i]&&e<=t[i+1]){o=i+1;break}}return o},e.prototype.getHeroAdditionWeight=function(e,t){for(var o=i.default.getInstance().getHeroTalentTableDataCfg(),a="",n=[],r=0,s=Object.keys(o);r<s.length;r++){var c=s[r];o.hasOwnProperty(c)&&o[c].heroId==e&&n.push(o[c])}if(n.forEach(function(e){Number(t)>=e.level&&(a=e.skillIdList)}),""!=a){var l=a.split("|");for(var d in l){var u=i.default.getInstance().getPassiveSkillConfig(Number(l[d]));if(u&&30==u.type)return u.attr_value}}return 0},e.prototype.getRandomCard=function(){var e=[],t=this.playerModel.getLevel()-1,o=c.randomQualityList[t];for(var a in this.tbHeroList)if(this.tbHeroList[a]){var n=i.default.getInstance().getHeroConfig(this.tbHeroList[a]),r=100;switch(n.hero_color){case 1:r=o.green;break;case 2:r=o.blue;break;case 3:r=o.purple;break;case 4:r=o.orange}var s=n.weight.split("|"),l=this.playerModel.getHeroLevel(this.tbHeroList[a]),u=s[0];l>=1&&l<c.HeroMaxLevel?u=s[l]:l==c.HeroMaxLevel&&(u=0);var h=this.getHeroAdditionWeight(this.tbHeroList[a],l);e.push((Number(u)+h)*this.playerModel.getHeroNumWeightParam(this.tbHeroList[a])*r)}if(!((e=this.arrOverAdd(e)).length<=0)){var p=e[e.length-1],f=Math.random()*p,g=this.getArrIndex(f,e),m=this.tbHeroList[g];if(this.playerModel.getHeroLevel(m)!=c.HeroMaxLevel){var _=new d.SafeNumber(m);this.tbRandomList.push(_);for(var y=g+1;y<this.tbHeroList.length;y++)this.tbHeroList[y-1]=this.tbHeroList[y];this.tbHeroList.pop()}}},e.prototype.getRandomCardList=function(){var e=this;for(this.tbHeroList=[],s.default._matchPlayerCards&&s.default._matchPlayerCards.forEach(function(t){e.tbHeroList.push(t.heroID)}),this.tbRandomList=[];this.tbRandomList.length<c.randomCardMaxNum;)this.getRandomCard()},e.prototype.refreshCard=function(){console.log("--------------- ai auto refresh ---------------------"),this.getRandomCardList(),this.usedheroList=[],this.unUsedHeroList=[];for(var e=0;e<this.tbRandomList.length;++e)if(this.tbRandomList[e]instanceof d.SafeNumber){var t=this.tbRandomList[e].value;if(!this.playerModel.carInfo.tbHeroList[t]){this.unUsedHeroList.push(t);continue}this.usedheroList.push(t)}},e.prototype.buyCard=function(e){if(this.usedheroList&&1==this.playerModel.reqHeroLevelUp(e)){console.log("--------------- ai auto buy hero\uff1a"+e),this.usedheroList=[];var t=0;for(var o in this.playerModel.carInfo.tbHeroList)this.playerModel.carInfo.tbHeroList[o]&&this.playerModel.carInfo.tbHeroList[o].starLevel<c.HeroMaxLevel&&(t+=1);0==t&&(this.autoManaged=!1)}},e}();o.default=h,cc._RF.pop()},{"../../combat/unit/DropEquipObj":"DropEquipObj","../../common/CombatModule":"CombatModule","../../modules/manager/cheat/SafeNumber":"SafeNumber","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/ConfigUtils":"ConfigUtils","../../utils/ConstValue":"ConstValue","../../utils/GameUtils":"GameUtils","../../utils/NameManager":"NameManager","../CombatManager":"CombatManager"}],AcquirePopupView:[function(e,t,o){"use strict";cc._RF.push(t,"72910Gnr8hCfqbMC5khgoBs","AcquirePopupView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../modules/base/BaseView"),s=e("../utils/GameTools"),c=e("../modules/base/Decorators"),l=e("../utils/Tools"),d=e("../StaticData/SoundTableData"),u=cc._decorator,h=u.ccclass,p=u.property,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.itemLyoutNode=null,t.spineNode=null,t.tipNode=null,t}return a(t,e),t.path=function(){return"ui/CommonPrefab/AcquirePopup"},t.prototype.init=function(e){var t=this;this.spineNode.active=!0;var o=this.spineNode.getComponent(sp.Skeleton);o.setAnimation(0,"idle",!1),o.setTrackEventListener(o.getCurrent(0),function(o,i){"jiangli"===(i.data?i.data.name:"")&&(t.itemLyoutNode.active=!0,e.items.forEach(function(o,i,a){s.default.createNormalItems(o.dropID,o.dropNum,t.itemLyoutNode,function(e){e.opacity=0,e.scale=0,cc.tween(e).delay(.2*i).to(.1,{opacity:255}).to(.2,{scale:1.25}).to(.2,{scale:1}).start()}),i>=a.length-1&&(t.tipNode.active=!0,t.node.on(cc.Node.EventType.TOUCH_END,function(){t.closeView(),e.closeCb&&e.closeCb()}))}))});var i=d.SoundTableData.getById(2).res;l.playAudioEffect(i)},n([p(cc.Node)],t.prototype,"itemLyoutNode",void 0),n([p(cc.Node)],t.prototype,"spineNode",void 0),n([p(cc.Node)],t.prototype,"tipNode",void 0),n([c.Register_Class,h],t)}(r.default);o.default=f,cc._RF.pop()},{"../StaticData/SoundTableData":"SoundTableData","../modules/base/BaseView":"BaseView","../modules/base/Decorators":"Decorators","../utils/GameTools":"GameTools","../utils/Tools":"Tools"}],ActivityChatPanel:[function(e,t,o){"use strict";cc._RF.push(t,"58894n5In5KMIOC1TrR0fYU","ActivityChatPanel");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/cores/UISuperLayout"),s=e("../../common/PlayerModule"),c=e("../../network/protocol/TypeProtocols"),l=e("../../network/ClientNetwork"),d=e("../../network/protocol/ChatProtocols"),u=e("../../network/protocol/ChatProtocols"),h=e("../../Global/GameGlobal"),p=cc._decorator,f=p.ccclass,g=p.property,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.scrollViewNode=null,t.unreadNode=null,t.tMsgDatas=new Array,t.nUnreadMsgCount=0,t}return a(t,e),t.prototype.onLoad=function(){var e=this,t=this.tMsgDatas;l.ClientNetwork.getInstance().listenProtocol(d.CHAT_CLIENT_ENUM.P_Chat_CloseFightRoom,function(o){o.resetPos();var i=new u.S_Chat_CloseFightRoom;if(i.read(o)){for(var a=!1,n=0;n<t.length;n++)if(t[n].chatType==c.TYPE_CHAT.TYPE_CHAT_ROOMFIGHT&&t[n].chatText==i.roomID&&1!=t[n].chatParam){t[n].chatParam=1,a=!0;break}1==a&&e.scrollViewNode.children.forEach(function(t){t.roomId&&t.roomId==i.roomID&&e.scrollViewNode.notifyRefreshItem(t)})}},this),this.schedule(function(){e.nUnreadMsgCount=0,e.tMsgDatas.forEach(function(t){t.bReadState&&0!=t.bReadState||e.nUnreadMsgCount++}),e.nUnreadMsgCount>99&&(e.nUnreadMsgCount=99),e.node.getChildByName("unread").active=e.nUnreadMsgCount>1,e.nUnreadMsgCount>=99?e.node.getChildByName("unread").children[0].getComponent(cc.Label).string=h.G.StringManager.getWorldString("chat_unread_max"):e.node.getChildByName("unread").children[0].getComponent(cc.Label).string=h.G.StringManager.getWorldString("chat_unread",e.nUnreadMsgCount)},.2),this.node.children[0].off("scroll-to-bottom"),this.node.children[0].on("scroll-to-bottom",function(){e.scrollViewNode.scrollView.isScrollBounceBottom=!0},this)},t.prototype.onEnable=function(){this.scrollViewNode.total(this.tMsgDatas.length),this.onClickUnreadCallBack()},t.prototype.addChatMsg=function(e){var t=this;1!=this.checkRoomInChannel(e)&&(this.tMsgDatas.push(e),0!=this.node.active&&(this.scrollViewNode.total(this.tMsgDatas.length),1!=s.default.UUID.equals(e.roleID)&&1!=this.scrollViewNode.scrollView.isScrollBounceBottom||(e.bReadState=1,setTimeout(function(){try{t.scrollViewNode.scrollToFooter(.1)}catch(e){}},50))))},t.prototype.onClickUnreadCallBack=function(){var e=this;this.tMsgDatas.forEach(function(e){e.bReadState=1}),this.scrollViewNode.scrollView.isScrollBounceBottom=!0,setTimeout(function(){try{e.scrollViewNode.scrollToFooter(.1)}catch(t){}},50)},t.prototype.checkRoomInChannel=function(e){for(var t=0;t<this.tMsgDatas.length;t++)if(this.tMsgDatas[t].chatText==e.chatText&&this.tMsgDatas[t].chatType==c.TYPE_CHAT.TYPE_CHAT_ROOMFIGHT)return!0;return!1},t.prototype.onListRender=function(e,t){e.getComponent("ChatItem").show(this.tMsgDatas[t])},t.prototype.onDestroy=function(){this.unscheduleAllCallbacks(),l.ClientNetwork.getInstance().removeMessageTarget(this)},n([g(r.default)],t.prototype,"scrollViewNode",void 0),n([g(cc.Node)],t.prototype,"unreadNode",void 0),n([f],t)}(cc.Component);o.default=m,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../common/PlayerModule":"PlayerModule","../../modules/cores/UISuperLayout":"UISuperLayout","../../network/ClientNetwork":"ClientNetwork","../../network/protocol/ChatProtocols":"ChatProtocols","../../network/protocol/TypeProtocols":"TypeProtocols"}],ActivityDayPrizeTableData:[function(e,t,o){"use strict";cc._RF.push(t,"b50cdrFb8ZO1ItqWO4WcNKH","ActivityDayPrizeTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.ActivityDayPrizeTableData=void 0;var i=e("../TableReader"),a=e("./BaseTableData"),n=function(){function e(){this.activityID=0,this.day=0,this.prize=new Array}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.activityID=e.getNumber(),this.day=e.getNumber();for(var o=e.getString(),n=new i.TableReader(o);n.getPos()<n.getLen();){var r=new a.DropItem;r.readOriginal(n),this.prize.push(r)}},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"ActivityDayPrizeTableData"},e.prototype.isAutoId=function(){return!0},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.ActivityDayPrizeTableData=n,cc._RF.pop()},{"../TableReader":"TableReader","./BaseTableData":"BaseTableData"}],ActivityFristRechargeView:[function(e,t,o){"use strict";cc._RF.push(t,"6abeaZX0ttOQJ7Lv5Hf2p8M","ActivityFristRechargeView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r,s=e("../../Global/GameGlobal"),c=e("../../modules/base/BaseView"),l=e("../../modules/base/Decorators"),d=e("../../network/ClientNetwork"),u=e("../../StaticData/ActivityDayPrizeTableData"),h=e("../../utils/GameTools"),p=e("../../network/protocol/ActivityProtocols"),f=e("../../common/PlayerModule"),g=e("../../StaticData/RechargeTableData"),m=e("../../StaticData/ActivityTableData"),_=e("../../utils/ResourcesManager"),y=e("../../network/LocalMessage"),v=e("../../modules/base/GameView"),C=e("../../utils/ConfigUtils"),S=e("../../StaticData/LuckyGiftSelectTableData"),T=e("../../network/protocol/TypeProtocols"),I=e("../../network/protocol/RoleProtocols"),N=e("../../utils/GameUtils"),b=e("../../utils/GamePlatform");(function(e){e[e.FirstRecharge_tab=1]="FirstRecharge_tab",e[e.NewBoy_tab=2]="NewBoy_tab",e[e.EveryDayRecharge_tab=3]="EveryDayRecharge_tab"})(r||(r={}));var w=cc._decorator,E=w.ccclass,P=w.property,R=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.firstRechargeNode=null,t.newBoxRechargeNode=null,t.EveryDayRechargeNode=null,t.ToggleContainer=null,t._curSelTab=0,t._selectHeroId=0,t}return a(t,e),t.path=function(){return"ui/activity/prefab/ActivityFristRechargeView"},t.prototype.onLoad=function(){var e=this;d.ClientNetwork.getInstance().listenLocalMessage(y.LOCAL_MESSAGE.LocalMsg_RechargeSuccess,function(){if(cc.isValid(e))if(r.FirstRecharge_tab==e._curSelTab){var t=m.ActivityTableData.getById(p.ACTIVITY_ID_ENUM.P_Activity_FristRecharge),o=f.default.getRoleRechargeData();1==o.has(t.param2)&&0==o.get(t.param2).bFirstPrize&&(e.firstRechargeNode.getChildByName("drawBtnNode").active=!0,e.firstRechargeNode.getChildByName("drawBtnNode").children[1].active=!1,e.firstRechargeNode.getChildByName("drawBtnNode").children[0].active=!0,e.firstRechargeNode.getChildByName("buyBtnNode").active=!1,e.firstRechargeNode.getChildByName("day0").getChildByName("dayLabel").color=cc.Color.YELLOW);var i=v.default.getViewByName("MainSceneView");i&&i.view&&i.view.onActivityFristRechargeRedpoint(!0)}else r.NewBoy_tab==e._curSelTab?e.initBoxInfo():r.EveryDayRecharge_tab==e._curSelTab&&e.initEveryDayRecharge()},this),d.ClientNetwork.getInstance().listenProtocol(p.ACTIVITY_CLIENT_ENUM.P_Activity_ReceiveDayPrize,function(t){if(cc.isValid(e)){var o=new p.S_Activity_ReceiveDayPrize;if(o.read(t)){o.rewards.length>0&&v.default.addPopView("BaseCtrl","AcquirePopupView","AcquirePopupView",{items:o.rewards});var i=v.default.getViewByName("MainSceneView");i&&i.view&&i.view.onActivityFristRechargeRedpoint(!1)}}},this),d.ClientNetwork.getInstance().listenProtocol(I.ROLE_CLIENT_ENUM.P_Role_Day_Recharge_Select,function(){e.showSelectCard()},this)},t.prototype.start=function(){},t.prototype.init=function(){var e=this;this.tFirstRechargeCfgData=[],u.ActivityDayPrizeTableData.getDataMap().forEach(function(t){t.activityID==p.ACTIVITY_ID_ENUM.P_Activity_FristRecharge&&e.tFirstRechargeCfgData.push(t)}),this.initBoxInfo(),this.initEveryDayRecharge();var t=new p.C_Activity_GetDayPrizeData;t.activityID=p.ACTIVITY_ID_ENUM.P_Activity_FristRecharge,d.ClientNetwork.getInstance().Send(p.ACTIVITY_CLIENT_ENUM.P_Activity_GetDayPrizeData,t)},t.prototype.initFirstRechargeInfo=function(e){this.initFirstRechargeRewards(e);var t=m.ActivityTableData.getById(p.ACTIVITY_ID_ENUM.P_Activity_FristRecharge),o=u.ActivityDayPrizeTableData.getDataMap().size;if(1==e.isOpen){var i=this.firstRechargeNode.getChildByName("drawBtnNode");i.active=!0,1==e.dayPrizeNum?(i.children[1].active=!0,i.children[0].active=!1,i.getComponent(cc.Button).enableAutoGrayEffect=!0,i.getComponent(cc.Button).interactable=!1):(i.children[1].active=!1,i.children[0].active=!0,i.getComponent(cc.Button).enableAutoGrayEffect=!1,i.getComponent(cc.Button).interactable=!0,e.totalDay==o&&(i.children[1].active=!0,i.children[0].active=!1,i.getComponent(cc.Button).enableAutoGrayEffect=!0,i.getComponent(cc.Button).interactable=!1))}else this.firstRechargeNode.getChildByName("buyBtnNode").active=!0,_.default.loadSprite(g.RechargeTableData.getById(t.param2).special_label,this.firstRechargeNode.getChildByName("buyBtnNode").getChildByName("sprite").getComponent(cc.Sprite)),this.firstRechargeNode.getChildByName("buyBtnNode").getChildByName("buyLabel").getComponent(cc.Label).string=s.G.StringManager.getString("SUPER_SALE_MONEY",h.default.getRechargeMoneyByPlatform(g.RechargeTableData.getById(t.param2))/100);if(1==e.isOpen)if(e.totalDay==o){for(var a=f.default.getRoleRechargeData(),n=!0,r=p.ACTIVITY_ID_ENUM.P_Activity_Box1;r<p.ACTIVITY_ID_ENUM.P_Activity_Box1+3;r++){var c=m.ActivityTableData.getById(r),l=0;a.has(c.param2)&&(l=a.get(c.param2).totalNum),l<c.param3&&(n=!1)}n?this.onClickEveryDayRecharge():this.onClickNewBoyGift()}else this.onClickFirstRecharge();else this.onClickFirstRecharge()},t.prototype.initFirstRechargeRewards=function(e){for(var t=function(t){var i=o.tFirstRechargeCfgData[t].prize,a=o.firstRechargeNode.getChildByName("day"+t).getChildByName("RewardNode");a.destroyAllChildren(),i.forEach(function(e,t){h.default.createNormalItems(e.dropID,e.dropNum,a,function(e){e.scale=.85,e.y=80,e.x=1==t?-60:60})});var n=o.firstRechargeNode.getChildByName("day"+t).getChildByName("dayLabel");1==e.isOpen&&t<=e.totalDay-e.dayPrizeNum?n.color=cc.Color.YELLOW:n.color=cc.Color.WHITE},o=this,i=0;i<this.tFirstRechargeCfgData.length;i++)t(i)},t.prototype.initBoxInfo=function(){var e=f.default.getRoleRechargeData(),t=p.ACTIVITY_ID_ENUM.P_Activity_Box1;(b.GamePlatform.getMiYa()||b.GamePlatform.IsSmallBag()||b.GamePlatform.IsH5SmallBag()||b.GamePlatform.IsMiYaIosH5())&&(t=21),this.newBoxRechargeNode.children.forEach(function(o){var i=m.ActivityTableData.getById(t),a=o.getChildByName("BuyNode");a.rechargeId=i.param2;var n=a.children[0];n.getComponent(cc.Label).string=s.G.StringManager.getString("SUPER_SALE_MONEY",h.default.getRechargeMoneyByPlatform(g.RechargeTableData.getById(i.param2))/100),_.default.loadSprite(g.RechargeTableData.getById(i.param2).special_label,a.children[1].getComponent(cc.Sprite));var r=0;e.has(i.param2)&&(r=e.get(i.param2).totalNum),o.getChildByName("count").getComponent(cc.Label).string="("+r+"/"+i.param3+")";for(var c=o.getChildByName("boxReward"),l=i.activityText.split("|"),d=0;d<c.children.length;d++){var u=c.children[d].children[0];u.getComponent(cc.Label).string="x "+l[d],u.getComponent(cc.Label).fontSize=28}r>=i.param3&&(a.children[1].active=!1,a.getComponent(cc.Button).enableAutoGrayEffect=!0,a.getComponent(cc.Button).interactable=!1,n.getComponent(cc.Label).string="\u5df2\u552e\u5b8c"),a.tRechargeItemInfo={rechargeID:i.param2,rechargeNum:1},t++})},t.prototype.initEveryDayRecharge=function(){var e=this,t=f.default.getRoleAttrValByKey(T.ROLE_ATTR_VALUES.ROLE_ATTR_DAY_RECHARGE_ID),o=f.default.getRoleAttrValByKey(T.ROLE_ATTR_VALUES.ROLE_ATTR_DAY_RECHARGE_SELECTID),i=f.default.getRoleAttrValByKey(T.ROLE_ATTR_VALUES.ROLE_ATTR_DAY_RECHARGE_TIME),a=t,n=f.default.getServersTime(),r=N.getLocalData("isSeeEveryDayRecharge");this.EveryDayRechargeNode.getChildByName("saleOver").active=!1,this.EveryDayRechargeNode.getChildByName("exchSpr").active=!1;var c=function(e){var t=new Date(1e3*e);return t.getFullYear()+"-"+(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-"+(t.getDate()<10?"0"+t.getDate():t.getDate())},l=c.call(this,i),d=c.call(this,n),u=!1,p=!1,m=0;0==t&&(t=300),l===d&&(u=!0,this.EveryDayRechargeNode.getChildByName("saleOver").active=!0,this.EveryDayRechargeNode.getChildByName("buyBtnNode").active=!1);var y=N.getLocalData("lastClickEveryRechargeTime");c.call(this,y)==d&&(p=!0),""!==r&&(0==a||u||p)||(this.ToggleContainer.getChildByName("toggle3").getChildByName("redpoint").active=!0),307!=t||u||(m=300),((m=u?t:t+1)<301||m>307)&&(m=301);var S=t%300;u||(S=m%300),(0==a||307==t&&!u)&&(S=0);var I=g.RechargeTableData.getById(m).firstPrize,b=this.EveryDayRechargeNode.getChildByName("BgNode").getChildByName("RewardNode");b.removeAllChildren(),I.forEach(function(e){h.default.createNormalItems(e.dropID,e.dropNum,b,function(t){2===C.default.getInstance().getItemByID(e.dropID).type&&t.on(cc.Node.EventType.TOUCH_END,function(){v.default.addPopView("BaseCtrl","DrawNewHeroCardView","DrawNewHeroCardView",{heroId:e.dropID,bShowNew:!0,bAction:!0})})})}),o&&0!=o&&(this.EveryDayRechargeNode.getChildByName("exchSpr").active=!0),307==t&&u&&(this.EveryDayRechargeNode.getChildByName("exchSpr").active=!1);for(var w=1;w<=7;w++){var E="ui/activity/image/firstRecharge/bg1";w<S?E="ui/activity/image/firstRecharge/bg2":w==S&&(E=u?"ui/activity/image/firstRecharge/bg2":"ui/activity/image/firstRecharge/bg3"),0==S&&1==w&&(E="ui/activity/image/firstRecharge/bg3"),_.default.loadSprite(E,this.EveryDayRechargeNode.getChildByName("sprite"+w).getComponent(cc.Sprite),function(e){e.addRef()})}this.EveryDayRechargeNode.getChildByName("ProgressBar").getComponent(cc.ProgressBar).progress=(S-1)/6,this.EveryDayRechargeNode.getChildByName("buyBtnNode").getChildByName("buyLabel").getComponent(cc.Label).string="\uffe5"+(h.default.getRechargeMoneyByPlatform(g.RechargeTableData.getById(m))/100).toString(),h.default.registerTouchEvent(this.EveryDayRechargeNode.getChildByName("buyBtnNode"),function(){if(o=f.default.getRoleAttrValByKey(T.ROLE_ATTR_VALUES.ROLE_ATTR_DAY_RECHARGE_SELECTID),307!=m||0!=o){var t=function(){var t={rechargeID:m,rechargeNum:1};e.sendEvent("SendProtocolRecharge",t)};307==m?v.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:s.G.StringManager.getString("BUY_EVERYDAYRECHARGE_LASTDAY"),confirmCb:function(){t.call(e)}}):t.call(e)}else s.G.StringManager.PopString(s.G.StringManager.getString("EVERYDAY_RECHARGE"))})},t.prototype.onClickHeroBtn=function(){var e=N.getConfigIntValue("activity_daily_chaozhi_choose"),t=S.LuckyGiftSelectTableData.getById(Number(e)).prize;v.default.addPopView("BaseCtrl","LuckyGiftSelectRewardView","LuckyGiftSelectRewardView",{tRewards:t,index:1,isEveryDayReacharge:!0,parent:this})},t.prototype.showSecectRwd=function(e){if(this.EveryDayRechargeNode.getChildByName("HeroSpineNode2").removeAllChildren(),0!=e){this._selectHeroId=e;var t=new I.C_Role_Day_Recharge_Select;t.selectId=e,d.ClientNetwork.getInstance().Send(I.ROLE_CLIENT_ENUM.P_Role_Day_Recharge_Select,t)}},t.prototype.showSelectCard=function(){var e=this,t=f.default.getRoleAttrValByKey(T.ROLE_ATTR_VALUES.ROLE_ATTR_DAY_RECHARGE_SELECTID);if(!(t<=0)){this.EveryDayRechargeNode.getChildByName("exchSpr").active=!0,this.EveryDayRechargeNode.getChildByName("jinka").active=!1,this.EveryDayRechargeNode.getChildByName("HeroSpineNode2").removeAllChildren();var o=C.default.getInstance().getHeroConfig(t),i=C.default.getInstance().getNpcTemplateConfig(o.npc_id,1).res_id,a=C.default.getInstance().getResConfig(i).uiScale;_.default.loadSpine(C.default.getInstance().getResConfig(i).animation,function(t){if(!cc.isValid(e.node))return t.destroy();t.parent=e.EveryDayRechargeNode.getChildByName("HeroSpineNode2"),t.scale=t.scale*(a-15)/100,t.getComponent(sp.Skeleton).setAnimation(0,"idle",!0)})}},t.prototype.onClickFirstRechargeCallBack=function(){var e=m.ActivityTableData.getById(p.ACTIVITY_ID_ENUM.P_Activity_FristRecharge),t={rechargeID:Number(e.param2),rechargeNum:1};this.sendEvent("SendProtocolRecharge",t)},t.prototype.onClickBuyBoxCallBack=function(e){var t={rechargeID:e.target.tRechargeItemInfo.rechargeID,rechargeNum:e.target.tRechargeItemInfo.rechargeNum};this.sendEvent("SendProtocolRecharge",t)},t.prototype.onClickFirstRechargeRewardCallBack=function(){var e=new p.C_Activity_ReceiveDayPrize;e.activityID=p.ACTIVITY_ID_ENUM.P_Activity_FristRecharge,d.ClientNetwork.getInstance().Send(p.ACTIVITY_CLIENT_ENUM.P_Activity_ReceiveDayPrize,e)},t.prototype.onClickFirstRecharge=function(){var e=this;if(r.FirstRecharge_tab!=this._curSelTab){this._curSelTab=r.FirstRecharge_tab,this.firstRechargeNode.active=!0,this.newBoxRechargeNode.active=!1,this.EveryDayRechargeNode.active=!1,0==this.ToggleContainer.getChildByName("toggle1").getComponent(cc.Toggle).isChecked&&(this.ToggleContainer.getChildByName("toggle1").getComponent(cc.Toggle).isChecked=!0);for(var t=[36,7],o=function(o){if(i.firstRechargeNode.getChildByName("HeroSpineNode1").childrenCount>0||i.firstRechargeNode.getChildByName("HeroSpineNode2").childrenCount>0)return"continue";var a=C.default.getInstance().getHeroConfig(t[o]),n=C.default.getInstance().getNpcTemplateConfig(a.npc_id,1).res_id,r=C.default.getInstance().getResConfig(n).uiScale;_.default.loadSpine(C.default.getInstance().getResConfig(n).animation,function(t){if(!cc.isValid(e.node))return t.destroy();t.parent=0==o?e.firstRechargeNode.getChildByName("HeroSpineNode1"):e.firstRechargeNode.getChildByName("HeroSpineNode2"),t.scale=t.scale*(r-15)/100,t.getComponent(sp.Skeleton).setAnimation(0,"idle",!0)})},i=this,a=0;a<t.length;a++)o(a)}},t.prototype.onClickEveryDayRechargeCallBack=function(){},t.prototype.onClickNewBoyGift=function(){r.NewBoy_tab!=this._curSelTab&&(this._curSelTab=r.NewBoy_tab,this.firstRechargeNode.active=!1,this.EveryDayRechargeNode.active=!1,this.newBoxRechargeNode.active=!0,0==this.ToggleContainer.getChildByName("toggle2").getComponent(cc.Toggle).isChecked&&(this.ToggleContainer.getChildByName("toggle2").getComponent(cc.Toggle).isChecked=!0))},t.prototype.setRedPointStatus=function(){""===N.getLocalData("isSeeEveryDayRecharge")&&N.setLocalData("isSeeEveryDayRecharge","1"),this.ToggleContainer.getChildByName("toggle3").getChildByName("redpoint").active=!1;var e=v.default.getViewByName("MainSceneView");e&&e.view&&e.view.onActivityEveryDayRechargeRedpoint(!1)},t.prototype.onClickEveryDayRecharge=function(){var e=this;if(r.EveryDayRecharge_tab!=this._curSelTab){this.setRedPointStatus();var t=f.default.getServersTime();N.setLocalData("lastClickEveryRechargeTime",t),this._curSelTab=r.EveryDayRecharge_tab,this.firstRechargeNode.active=!1,this.newBoxRechargeNode.active=!1,this.EveryDayRechargeNode.active=!0,0==this.ToggleContainer.getChildByName("toggle3").getComponent(cc.Toggle).isChecked&&(this.ToggleContainer.getChildByName("toggle3").getComponent(cc.Toggle).isChecked=!0);var o=f.default.getRoleAttrValByKey(T.ROLE_ATTR_VALUES.ROLE_ATTR_DAY_RECHARGE_SELECTID);if(this.EveryDayRechargeNode.getChildByName("HeroSpineNode1").removeAllChildren(),this.EveryDayRechargeNode.getChildByName("HeroSpineNode2").removeAllChildren(),0!=o){this.EveryDayRechargeNode.getChildByName("jinka").active=!1;var i=C.default.getInstance().getHeroConfig(o),a=C.default.getInstance().getNpcTemplateConfig(i.npc_id,1).res_id,n=C.default.getInstance().getResConfig(a).uiScale;_.default.loadSpine(C.default.getInstance().getResConfig(a).animation,function(t){if(!cc.isValid(e.node))return t.destroy();t.parent=e.EveryDayRechargeNode.getChildByName("HeroSpineNode2"),t.scale=t.scale*(n-15)/100,t.getComponent(sp.Skeleton).setAnimation(0,"idle",!0)})}_.default.loadSpine("combat/animation/pet/longbaobao2/longbaobao2",function(t){if(!cc.isValid(e.node))return t.destroy();t.parent=e.EveryDayRechargeNode.getChildByName("HeroSpineNode1"),t.scale=t.scale,t.getComponent(sp.Skeleton).setAnimation(0,"idle",!0)})}},t.prototype.onDestroy=function(){d.ClientNetwork.getInstance().removeMessageTarget(this)},n([P(cc.Node)],t.prototype,"firstRechargeNode",void 0),n([P(cc.Node)],t.prototype,"newBoxRechargeNode",void 0),n([P(cc.Node)],t.prototype,"EveryDayRechargeNode",void 0),n([P(cc.Node)],t.prototype,"ToggleContainer",void 0),n([l.Register_Class,E],t)}(c.default);o.default=R,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/ActivityDayPrizeTableData":"ActivityDayPrizeTableData","../../StaticData/ActivityTableData":"ActivityTableData","../../StaticData/LuckyGiftSelectTableData":"LuckyGiftSelectTableData","../../StaticData/RechargeTableData":"RechargeTableData","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/base/GameView":"GameView","../../network/ClientNetwork":"ClientNetwork","../../network/LocalMessage":"LocalMessage","../../network/protocol/ActivityProtocols":"ActivityProtocols","../../network/protocol/RoleProtocols":"RoleProtocols","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/ConfigUtils":"ConfigUtils","../../utils/GamePlatform":"GamePlatform","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils","../../utils/ResourcesManager":"ResourcesManager"}],ActivityGoldenLeagueIntroduceView:[function(e,t,o){"use strict";cc._RF.push(t,"46d62NcFx5E36hMoKLqekDs","ActivityGoldenLeagueIntroduceView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=cc._decorator,l=c.ccclass,d=(c.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.path=function(){return"ui/goldenLeagueCal/GoldenLeagueCalIIntroduce"},n([s.Register_Class,l],t)}(r.default));o.default=d,cc._RF.pop()},{"../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators"}],ActivityGoldenLeagueMatch:[function(e,t,o){"use strict";cc._RF.push(t,"66d4b8HAu1IbrH8nW7NLQpI","ActivityGoldenLeagueMatch");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../Global/GameGlobal"),s=e("../../modules/base/BaseView"),c=e("../../modules/base/Decorators"),l=e("../../utils/GameUtils"),d=e("../../common/PlayerModule"),u=e("../../network/protocol/TypeProtocols"),h=e("../../modules/manager/LoadResManager"),p=e("../../utils/GameTools"),f=e("../../network/ClientNetwork"),g=e("../../network/LocalMessage"),m=e("../../modules/base/GameView"),_=e("../../network/protocol/MatchProtocols"),y=e("../heroCardBag/HeroSkinUtils"),v=e("../../StaticData/HeroSkinTableData"),C=cc._decorator,S=C.ccclass,T=C.property,I=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.playerHeadNode=null,t.matchingNode=null,t.opponentNode=null,t.matchFinishNode=null,t.heroFormationNode=null,t.time=0,t.dt=0,t.matchStatus=-1,t}return a(t,e),t.path=function(){return"ui/goldenLeagueCal/GoldenLeagueCalMatch"},t.prototype.start=function(){this.initPlayerHeadInfo(),this.initPlayerHeroLineup(),this.onInitListenEvent(),this.matchFinishNode.active=!1,this.matchingNode.active=!0;var e=new _.C_Match_Fight;e.fightType=u.FIGHT_TYPE.FIGHT_TYPE_BATTLE_GOLDENLEAGUE,e.params.push(l.getConfigVersion()),f.ClientNetwork.getInstance().Send(_.MATCH_CLIENT_ENUM.P_Match_Fight,e)},t.prototype.onInitListenEvent=function(){var e=this;f.ClientNetwork.getInstance().listenLocalMessage(g.LOCAL_MESSAGE.LocalMsg_MatchSuccess,function(){e.matchFinishNode.active=!0,e.matchingNode.active=!1,e.opponentNode.children[0].active=!0,e.opponentNode.children[1].active=!1},this),f.ClientNetwork.getInstance().listenLocalMessage(g.LOCAL_MESSAGE.LocalMsg_LoginFightServerSuccess,function(){this.matchStatus=2}.bind(this),this),f.ClientNetwork.getInstance().listenProtocol(_.MATCH_CLIENT_ENUM.P_Match_Fight,function(t){t.resetPos();var o=new _.S_Match_Fight;if(o.read(t)){var i=o.errorcode;8089==i?(m.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:r.G.StringManager.getString("BATTLE_VERSION_NOT_MATCH"),confirmCb:function(){}}),e.onClickCloseCallBack()):(e.matchStatus=0,0!=i&&r.G.StringManager.PopStringOnce(r.G.StringManager.getString("MATCH_ROOM_FAIL")))}},this)},t.prototype.initPlayerHeadInfo=function(){var e=this;l.setRemoteHeadIcon(d.default.getHeadUrl(),d.default.getRoleAttrValByKey(u.ROLE_ATTR_VALUES.ROLE_ATTR_HEADID),this.playerHeadNode.getComponent(cc.Sprite));var t=d.default.getRoleAttrValByKey(u.ROLE_ATTR_VALUES.ROLE_ATTR_HEADFRAMEID);t<=0&&(t=200),h.default.loadSpriteFrame("ui/headFrame/frame_"+t).then(function(t){e.playerHeadNode&&(e.playerHeadNode.children[0].getComponent(cc.Sprite).spriteFrame=t)})},t.prototype.initPlayerHeroLineup=function(){var e=d.default.getBattleHeroCarData(d.default.fightHeroArrayIndex);for(var t in e)if(e[t]){var o=e[t]._heroId,i=y.default.Instance.getCurSkinIdByHeroUUID(null,o);if(i>0){var a=v.HeroSkinTableData.getById(i);null!=a&&(o=a.itemId)}p.default.createNormalItems(o,e[t]._heroLevel,this.heroFormationNode,function(e){e.getChildByName("num").active=!1,e.scale=.75})}},t.prototype.onClickCloseCallBack=function(){var e=new _.C_Match_Cacel;f.ClientNetwork.getInstance().Send(_.MATCH_CLIENT_ENUM.P_Match_Cancel,e),this.closeView()},t.prototype.update=function(e){this.matchStatus<0||(this.dt+=e,this.dt>1&&(0==this.matchStatus?(this.dt=0,this.time++,this.matchingNode.getChildByName("time").getComponent(cc.Label).string=r.G.StringManager.getString("MATCH_TIME",this.time)):2==this.matchStatus&&(this.matchStatus=-1)))},t.prototype.onDestroy=function(){f.ClientNetwork.getInstance().removeMessageTarget(this),f.ClientNetwork.getInstance().removeLocalMessage(g.LOCAL_MESSAGE.LocalMsg_MatchSuccess),f.ClientNetwork.getInstance().removeLocalMessage(g.LOCAL_MESSAGE.LocalMsg_LoginFightServerSuccess)},n([T(cc.Node)],t.prototype,"playerHeadNode",void 0),n([T(cc.Node)],t.prototype,"matchingNode",void 0),n([T(cc.Node)],t.prototype,"opponentNode",void 0),n([T(cc.Node)],t.prototype,"matchFinishNode",void 0),n([T(cc.Node)],t.prototype,"heroFormationNode",void 0),n([c.Register_Class,S],t)}(s.default);o.default=I,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/HeroSkinTableData":"HeroSkinTableData","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/base/GameView":"GameView","../../modules/manager/LoadResManager":"LoadResManager","../../network/ClientNetwork":"ClientNetwork","../../network/LocalMessage":"LocalMessage","../../network/protocol/MatchProtocols":"MatchProtocols","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils","../heroCardBag/HeroSkinUtils":"HeroSkinUtils"}],ActivityGoldenLeagueRanktem:[function(e,t,o){"use strict";cc._RF.push(t,"17d2fhHvP5Cq5SEVt3h1Yxs","ActivityGoldenLeagueRanktem");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../utils/GameTools"),s=e("../../modules/base/GameView"),c=e("../../utils/GameUtils"),l=e("../../modules/manager/LoadResManager"),d=cc._decorator,u=d.ccclass,h=d.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.rankIconNodeArr=[],t.loseNodeArr=[],t.rankNumNode=null,t.playerHeadNode=null,t.playerNameLab=null,t.winCountLab=null,t.sociatyNameLab=null,t}return a(t,e),t.prototype.show=function(e,t){var o=this,i=JSON.parse(e);this.rankIconNodeArr.forEach(function(e){e.active=!1}),this.rankNumNode.active=!1,this.rankIconNodeArr[t]?this.rankIconNodeArr[t].active=!0:(this.rankNumNode.active=!0,this.rankNumNode.children[0].getComponent(cc.Label).string=(t+1).toString()),this.playerNameLab.string=i.nickname,c.setRemoteHeadIcon(i.headurl,i.headid,this.playerHeadNode.getComponent(cc.Sprite));var a=i.headframeid;(a<=0||a>=2e3)&&(a=200),l.default.loadSpriteFrame("ui/headFrame/frame_"+a).then(function(e){o.playerHeadNode&&(o.playerHeadNode.children[0].getComponent(cc.Sprite).spriteFrame=e)}),this.winCountLab.string="\u80dc\u573a\uff1a"+i.score,this.loseNodeArr.forEach(function(e,t){0==i.goldenleaguescore?e.children[0].active=!1:(e.children[0].active=!1,t+1<=i.goldenleaguescore&&(e.children[0].active=!0))}),this.playerHeadNode.roleid=i.roleid,r.default.registerTouchEvent(this.playerHeadNode,function(e){var t=s.default.getViewByName("MainSceneView");t&&t.view&&t.view.onCallGetRoleSimpleInfo(e.target.roleid)}),this.sociatyNameLab.string=i.sociatyName?i.sociatyName:""},n([h(cc.Node)],t.prototype,"rankIconNodeArr",void 0),n([h(cc.Node)],t.prototype,"loseNodeArr",void 0),n([h(cc.Node)],t.prototype,"rankNumNode",void 0),n([h(cc.Node)],t.prototype,"playerHeadNode",void 0),n([h(cc.Label)],t.prototype,"playerNameLab",void 0),n([h(cc.Label)],t.prototype,"winCountLab",void 0),n([h(cc.Label)],t.prototype,"sociatyNameLab",void 0),n([u],t)}(cc.Component);o.default=p,cc._RF.pop()},{"../../modules/base/GameView":"GameView","../../modules/manager/LoadResManager":"LoadResManager","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils"}],ActivityGoldenLeagueRewardtem:[function(e,t,o){"use strict";cc._RF.push(t,"751b5ls2tRPg4ffDIkz2UD0","ActivityGoldenLeagueRewardtem");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../utils/GameTools"),s=cc._decorator,c=s.ccclass,l=s.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.rankIconNodeArr=[],t.rankLab=null,t.rewardLayoutNode=null,t}return a(t,e),t.prototype.show=function(e,t){var o=this;this.rankIconNodeArr.forEach(function(e){e.active=!1}),e.rankMin==e.rankMax&&this.rankIconNodeArr[t]?this.rankIconNodeArr[t].active=!0:this.rankLab.string=e.rankMin+" - "+e.rankMax;for(var i=0;i<e.prize.length;i++)r.default.createNormalItems(e.prize[i].dropID,e.prize[i].dropNum,null,function(e){e.scale=.8,e.parent=o.rewardLayoutNode.node})},n([l(cc.Node)],t.prototype,"rankIconNodeArr",void 0),n([l(cc.Label)],t.prototype,"rankLab",void 0),n([l(cc.Layout)],t.prototype,"rewardLayoutNode",void 0),n([c],t)}(cc.Component);o.default=d,cc._RF.pop()},{"../../utils/GameTools":"GameTools"}],ActivityGoldenLeagueView:[function(e,t,o){"use strict";cc._RF.push(t,"d1c8bqpa1BARZEy2YL4qKcJ","ActivityGoldenLeagueView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r,s=e("../../Global/GameGlobal"),c=e("../../modules/base/BaseView"),l=e("../../modules/base/Decorators"),d=e("../../modules/manager/LoadResManager"),u=e("../../utils/LogUtil"),h=e("../../common/PlayerModule"),p=e("../../utils/ConfigUtils"),f=e("../../utils/GameTools"),g=e("../../StaticData/GoldenLeagueRewardTableData"),m=e("../../StaticData/ActivityTableData"),_=e("../../network/protocol/ActivityProtocols"),y=e("../../utils/GamePlatform"),v=e("../../../load"),C=e("../../network/protocol/TypeProtocols"),S=e("../../modules/cores/UISuperLayout"),T=e("../../StaticData/GoldenLeagueRankListTableData"),I=e("../../modules/base/GameView"),N=e("../../network/ClientNetwork"),b=e("./ActivityModule"),w=e("../../common/NetworkProtocolCommon");(function(e){e[e.DeficiencyScore=1]="DeficiencyScore",e[e.FailMaxNum=2]="FailMaxNum",e[e.NotOpenTime=3]="NotOpenTime",e[e.Normal=4]="Normal"})(r||(r={}));var E=cc._decorator,P=E.ccclass,R=E.property,L=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.openTimeLab=null,t.myRankInfoNode=null,t.rankListNode=null,t.rewardListNode=null,t.LoseNodeArr=[],t.rewardNodeArr=[],t.spineNode=null,t.rankItemPrefab=null,t.rewardItemPrefab=null,t.matchBtnNode=null,t.layout=null,t._tSeasonReward=[],t._rankListDatas=[],t._pillPageIndex=1,t._selfWinCount=0,t._selfFailCount=0,t._bCallRank=!1,t}return a(t,e),t.path=function(){return"ui/goldenLeagueCal/GoldenLeagueCalMain"},t.prototype.onLoad=function(){var e=this;d.default.loadPrefab("ui/CommonPrefab/TopView").then(function(t){t.parent=e.node,t.getChildByName("goldDiamondContent").active=!1,t.getComponent("TopView").bindExitEvent(function(){e.closeView()})}).catch(function(e){u.default.info(e)}),this.layout.total(this._rankListDatas.length),f.default.registerTouchEvent(this.matchBtnNode,function(t){e.onClickMatchCallBack(t)})},t.prototype.onEnable=function(){var e=I.default.getViewByName("ActivityMainView");if(e&&e.view&&e.view.node){e.view.node.active=!1;var t=e.view.node.parent.getChildByName("UI_Mask_ActivityMainView");t&&(t.active=!1)}},t.prototype.onDestroy=function(){N.ClientNetwork.getInstance().removeMessageTarget(this);var e=I.default.getViewByName("ActivityMainView");if(e&&e.view&&e.view.node){e.view.node.active=!0;var t=e.view.node.parent.getChildByName("UI_Mask_ActivityMainView");t&&(t.active=!0)}},t.prototype.start=function(){if(this._endTime=0,this.checkIsOpen()){var e=m.ActivityTableData.getById(_.ACTIVITY_ID_ENUM.P_Activity_WuDaoHui),t=h.default.getGameTime(),o=e.param5.toString(),i=t.year+"-"+t.month+"-"+t.day+" "+o.slice(0,2)+":"+o.slice(2,4)+":00";console.log(i),this._endTime=Math.floor(this.getTargetTime(i)/1e3)}this.initActivityProtocol(),this.initActivityOpenState(),this.initSeasonRewards(),this.pullRankDataInfo(),this.initRewardListInfo();var a=new _.C_Activity_GetGoldenLeagueData;a.activityID=_.ACTIVITY_ID_ENUM.P_Activity_WuDaoHui,N.ClientNetwork.getInstance().Send(_.ACTIVITY_CLIENT_ENUM.P_Activity_GetGoldenLeagueData,a),b.default.ClickGoldenLeagueState=!0},t.prototype.getTargetTime=function(e){var t=e.split(" ")[0],o=e.split(" ")[1],i=new Date;return i.setFullYear(t.split("-")[0]),i.setMonth(t.split("-")[1]-1),i.setDate(t.split("-")[2]),i.setHours(o.split(":")[0]),i.setMinutes(o.split(":")[1]),i.setSeconds(o.split(":")[2]),i.getTime()},t.prototype.checkIsOpen=function(){var e=m.ActivityTableData.getById(_.ACTIVITY_ID_ENUM.P_Activity_WuDaoHui),t=h.default.getGameTime();if(t.weedDay!=e.param2)return!1;var o=e.param4.toString(),i=t.year+"-"+t.month+"-"+t.day+" "+o.slice(0,2)+":"+o.slice(2,4)+":00",a=Math.floor(this.getTargetTime(i)/1e3),n=e.param5.toString(),r=t.year+"-"+t.month+"-"+t.day+" "+n.slice(0,2)+":"+n.slice(2,4)+":00",s=Math.floor(this.getTargetTime(r)/1e3),c=h.default.getServersTime();return c>=a&&c<s},t.prototype.initActivityProtocol=function(){var e=this;N.ClientNetwork.getInstance().listenProtocol(_.ACTIVITY_CLIENT_ENUM.P_Activity_GetGoldenLeagueData,function(t){t.resetPos();var o=new _.S_Activity_GetGoldenLeagueData;if(o.read(t)){if(0!=o.error)return;e._selfFailCount=o.dayFailNum,e.initPlayerActivityData(o)}},this),N.ClientNetwork.getInstance().listenProtocol(_.ACTIVITY_CLIENT_ENUM.P_Activity_ReceiveGoldenLeagueWinNumPrize,function(e){e.resetPos();var t=new _.S_Activity_ReceiveGoldenLeagueWinNumPrize;if(t.read(e)){if(0!=t.errorcode)return s.G.StringManager.PopString("\u9886\u53d6\u5931\u8d25"+t.errorcode);I.default.addPopView("BaseCtrl","AcquirePopupView","AcquirePopupView",{items:t.rewards})}},this)},t.prototype.initPlayerActivityData=function(e){this.LoseNodeArr.forEach(function(t,o){0==e.dayFailNum?t.children[0].active=!1:(t.children[0].active=!1,o+1<=e.dayFailNum&&(t.children[0].active=!0))}),this.initWinRewardInfo(e),this.setMatchBtnNodeState()},t.prototype.initActivityOpenState=function(){var e=this;if(this.checkIsOpen()){var t=function(){var o=h.default.getServersTime(),i=e._endTime-o;if(i<=0)return e.unschedule(t),e.openTimeLab.string=s.G.StringManager.getString("WUDAOHUI_OFF_TIP"),e.setMatchBtnNodeState(),void(e.node.getChildByName("ranshao").active=!1);e.openTimeLab.string=s.G.StringManager.getString("WUDAOHUI_OPEN_TIP")+function(e){var t=e%36e5/6e4;return parseInt((e%864e5/36e5).toString())+" \u5c0f\u65f6 "+Math.ceil(t)+" \u5206\u949f "}.call(e,1e3*i)};this.schedule(t,30),t.call(this),this.node.getChildByName("ranshao").active=!0,this.node.getChildByName("ranshao").scaleX=this.node.getChildByName("backgroundNode").scaleX}else this.openTimeLab.string=s.G.StringManager.getString("WUDAOHUI_OFF_TIP"),this.node.getChildByName("ranshao").active=!1},t.prototype.initSeasonRewards=function(){var e=this,t=h.default.getRoleAttrValByKey(C.ROLE_ATTR_VALUES.ROLE_ATTR_GOLDENLEAGUE_SEASON);g.GoldenLeagueRewardTableData.getDataMap().forEach(function(o){t==o.seasonId&&e._tSeasonReward.push(o)}),this.initActivityHeroSpine()},t.prototype.initActivityHeroSpine=function(){var e=this,t=p.default.getInstance().getHeroConfig(this._tSeasonReward[0].heroId),o=p.default.getInstance().getNpcTemplateConfig(t.npc_id,1).res_id;d.default.loadSpineNode(p.default.getInstance().getResConfig(o).animation).then(function(t){t.parent=e.spineNode,t.getComponent(sp.Skeleton).setAnimation(0,"idle",!0),t.scaleX=.01*e._tSeasonReward[0].heroScale*-1,t.scaleY=.01*e._tSeasonReward[0].heroScale}).catch(function(e){u.default.info(e)})},t.prototype.initWinRewardInfo=function(e){var t=this,o=function(e,t){return 1==e.has(t)};this._selfWinCount=e.winNum,this.rewardNodeArr.forEach(function(e,o){e.active=!1;var i=t._tSeasonReward[o];if(i){e.winNum=i.winNum,e.active=!0;var a=i.prize,n=e.getChildByName("rewardItemNode");n&&n.destroy(),f.default.createNormalItems(a[0].dropID,a[0].dropNum,e,function(e){e.scale=.7,e.name="rewardItemNode"}),e.children[0].getComponent(cc.Label).string=i.winNum+"\u80dc",e.getComponent(cc.Sprite).enabled=!1}}),this.scheduleOnce(function(){t.rewardNodeArr.forEach(function(i,a){var n=t._tSeasonReward[a];n&&e.winNum>=n.winNum&&(1==o.call(t,e.prize,n.winNum)?(f.default.setNodeBright(i,!1),i.hasEventListener(cc.Node.EventType.TOUCH_START)&&i.off(cc.Node.EventType.TOUCH_START),i.hasEventListener(cc.Node.EventType.TOUCH_MOVE)&&i.off(cc.Node.EventType.TOUCH_MOVE),i.hasEventListener(cc.Node.EventType.TOUCH_END)&&i.off(cc.Node.EventType.TOUCH_END),i.hasEventListener(cc.Node.EventType.TOUCH_CANCEL)&&i.off(cc.Node.EventType.TOUCH_CANCEL)):(i.getComponent(cc.Sprite).enabled=!0,f.default.registerTouchEvent(i,function(e){t.onReceiveGoldenLeagueWinNumPrize(e.target.winNum)})))})},.2)},t.prototype.initRewardListInfo=function(){var e=this,t=[],o=h.default.getRoleAttrValByKey(C.ROLE_ATTR_VALUES.ROLE_ATTR_GOLDENLEAGUE_SEASON);T.GoldenLeagueRankListPrizeTableData.getDataMap().forEach(function(e){e.seasonId==o&&t.push(e)}),t.forEach(function(t,o){var i=cc.instantiate(e.rewardItemPrefab);i.parent=e.rewardListNode.getComponent(cc.ScrollView).content,i.getComponent("ActivityGoldenLeagueRewardtem").show(t,o)})},t.prototype.setMatchBtnNodeState=function(){if(this.matchBtnNode.nodeState=r.Normal,0==this.checkIsOpen())this.matchBtnNode.nodeState=r.NotOpenTime;else{var e=m.ActivityTableData.getById(_.ACTIVITY_ID_ENUM.P_Activity_WuDaoHui);h.default.getRoleAttrValByKey(C.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE)<e.param1?this.matchBtnNode.nodeState=r.DeficiencyScore:this._selfFailCount>=e.param3&&(this.matchBtnNode.nodeState=r.FailMaxNum)}this.matchBtnNode.nodeState!=r.Normal?f.default.setNodeBright(this.matchBtnNode,!1):f.default.setNodeBright(this.matchBtnNode,!0)},t.prototype.pullRankDataInfo=function(e){var t=this;if(void 0===e&&(e=null),1!=this._bCallRank){var o=s.G.StringManager.getString("RANKLIST_URL");(y.GamePlatform.isWechat()||y.GamePlatform.isQQMiniGame()||y.GamePlatform.isByteDanceMiniGame()||y.GamePlatform.isKuaishouMiniGame())&&(o=v.getSubmitReviewState()?s.G.StringManager.getString("RANKLIST_URL"):s.G.StringManager.getString("RANKLIST_URL_MOBILE")),(y.GamePlatform.getMiYa()||y.GamePlatform.isQQGameRoom())&&(o=s.G.StringManager.getString("RANKLIST_URL_MOBILE")),"bigBlue"==y.GamePlatform.getMiYaVideoTypeNoSet()&&(o=s.G.StringManager.getString("RANKLIST_URL_MOBILE_BIGBLUE")),"ly5add7"==y.GamePlatform.getMiYaVideoTypeNoSet()&&(o=s.G.StringManager.getString("RANKLIST_URL_MOBILE_ADDCHANNEL"));var i=0,a=h.default.getGameTime(),n=m.ActivityTableData.getById(_.ACTIVITY_ID_ENUM.P_Activity_WuDaoHui);if(n.param2==a.weedDay){var r=n.param4.toString(),c=a.year+"-"+a.month+"-"+a.day+" "+r.slice(0,2)+":"+r.slice(2,4)+":00",l=Math.floor(this.getTargetTime(c)/1e3),d=h.default.getServersTime();i=this.checkIsOpen()||d<l?C.RANKLIST_TYPE.RANKLIST_TYPE_ACTIVITY_GOLDENLEAGUE:C.RANKLIST_TYPE.RANKLIST_TYPE_ACTIVITY_GOLDENLEAGUEHISTORY}else i=C.RANKLIST_TYPE.RANKLIST_TYPE_ACTIVITY_GOLDENLEAGUEHISTORY;e&&e<=0&&(i=C.RANKLIST_TYPE.RANKLIST_TYPE_ACTIVITY_GOLDENLEAGUEHISTORY),o+="?",o+="ranktype="+i,o+="&roleid="+h.default.uuidTransformRoieId(),o+="&page="+this._pillPageIndex,console.log(this._pillPageIndex);var u=new XMLHttpRequest;u.onreadystatechange=function(){if(4==u.readyState&&u.status>=200&&u.status<400){var e=u.responseText.toString();e=(e=(e=e.replace('"','"')).replace("\ufeff","")).replace(" ","");var o=JSON.parse(e);if(0==t.isVaild())return;if(o.maxpage<=0&&0==t._bCallRank)return t._bCallRank=!0,t.pullRankDataInfo(o.maxpage);if(t._pillPageIndex!=o.page)return void t.scheduleOnce(function(){return t.layout.total(t._rankListDatas.length)},.2);if(t._pillPageIndex=o.page+1,t.onRefreshSelfRankInfo(o),"ranklist"in o){var i=o.ranklist;for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&t._rankListDatas.push(i[a])}t.scheduleOnce(function(){return t.layout.total(t._rankListDatas.length)},.2)}},u.open("GET",o,!0),u.send()}},t.prototype.onRefreshSelfRankInfo=function(e){var t=0,o=this.myRankInfoNode.getChildByName("my_rank_num").getComponent(cc.Label),i=this.myRankInfoNode.getChildByName("my_score_label").getComponent(cc.Label);if("playerrank"in e){if(o.string=e.playerrank,"playerdata"in e){var a=JSON.parse(e.playerdata);t=a.score,a.goldenleaguescore,i.string=t.toString()}}else o.string=s.G.StringManager.getString("NO_RANK"),i.string=this._selfWinCount.toString()},t.prototype.onClickRankCallBack=function(){1!=this.rankListNode.active&&(this.rankListNode.active=!0,this.rewardListNode.active=!1,this.myRankInfoNode.active=!0)},t.prototype.onClickRewardCallBack=function(){1!=this.rewardListNode.active&&(this.rankListNode.active=!1,this.rewardListNode.active=!0,this.myRankInfoNode.active=!1,this.rewardListNode.getComponent(cc.ScrollView).scrollToTop())},t.prototype.onClickMatchCallBack=function(e){var t=e.target.nodeState;if(t==r.DeficiencyScore){var o=m.ActivityTableData.getById(_.ACTIVITY_ID_ENUM.P_Activity_WuDaoHui);return s.G.StringManager.PopString(s.G.StringManager.getString("WUDAOHUI_SCORE_TIP",o.param1))}return t==r.NotOpenTime?s.G.StringManager.PopString(s.G.StringManager.getString("WUDAOHUI_TIP1")):t==r.FailMaxNum?s.G.StringManager.PopString(s.G.StringManager.getString("WUDAOHUI_TIP2")):b.default.isChickenDinnerMatching()?(w.default.callRoleClientLog("CHICKENDINNER_MATCHING6"),s.G.StringManager.PopString(s.G.StringManager.getString("CHICKENDINNER_MATCHING")),void console.log("isChickenDinnerMatching code=6")):void I.default.addPopView("BaseCtrl","ActivityGoldenLeagueMatch","ActivityGoldenLeagueMatch")},t.prototype.onClickIntroduceCallBack=function(){I.default.addPopView("BaseCtrl","ActivityGoldenLeagueIntroduceView","ActivityGoldenLeagueIntroduceView")},t.prototype.onRefreshRankEvent=function(e,t){var o=this._rankListDatas[t];e.getComponent("ActivityGoldenLeagueRanktem").show(o,t)},t.prototype.onFooterEvent=function(e,t){t.action&&this.pullRankDataInfo()},t.prototype.onReceiveGoldenLeagueWinNumPrize=function(e){var t=new _.C_Activity_ReceiveGoldenLeagueWinNumPrize;t.activityID=_.ACTIVITY_ID_ENUM.P_Activity_WuDaoHui,t.winNum=e,N.ClientNetwork.getInstance().Send(_.ACTIVITY_CLIENT_ENUM.P_Activity_ReceiveGoldenLeagueWinNumPrize,t)},t.prototype.getActivityEndTime=function(){if(this.checkIsOpen()){var e=h.default.getGameTime(),t=m.ActivityTableData.getById(_.ACTIVITY_ID_ENUM.P_Activity_WuDaoHui).param5.toString(),o=e.year+"-"+e.month+"-"+e.day+" "+t.slice(0,2)+":"+t.slice(2,4)+":00";return Math.floor(this.getTargetTime(o)/1e3)}return 0},n([R(cc.Label)],t.prototype,"openTimeLab",void 0),n([R(cc.Node)],t.prototype,"myRankInfoNode",void 0),n([R(cc.Node)],t.prototype,"rankListNode",void 0),n([R(cc.Node)],t.prototype,"rewardListNode",void 0),n([R(cc.Node)],t.prototype,"LoseNodeArr",void 0),n([R(cc.Node)],t.prototype,"rewardNodeArr",void 0),n([R(cc.Node)],t.prototype,"spineNode",void 0),n([R(cc.Prefab)],t.prototype,"rankItemPrefab",void 0),n([R(cc.Prefab)],t.prototype,"rewardItemPrefab",void 0),n([R(cc.Node)],t.prototype,"matchBtnNode",void 0),n([R(S.default)],t.prototype,"layout",void 0),n([l.Register_Class,P],t)}(c.default);o.default=L,cc._RF.pop()},{"../../../load":"load","../../Global/GameGlobal":"GameGlobal","../../StaticData/ActivityTableData":"ActivityTableData","../../StaticData/GoldenLeagueRankListTableData":"GoldenLeagueRankListTableData","../../StaticData/GoldenLeagueRewardTableData":"GoldenLeagueRewardTableData","../../common/NetworkProtocolCommon":"NetworkProtocolCommon","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/base/GameView":"GameView","../../modules/cores/UISuperLayout":"UISuperLayout","../../modules/manager/LoadResManager":"LoadResManager","../../network/ClientNetwork":"ClientNetwork","../../network/protocol/ActivityProtocols":"ActivityProtocols","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/ConfigUtils":"ConfigUtils","../../utils/GamePlatform":"GamePlatform","../../utils/GameTools":"GameTools","../../utils/LogUtil":"LogUtil","./ActivityModule":"ActivityModule"}],ActivityMainView:[function(e,t,o){"use strict";cc._RF.push(t,"22f24N2zH5MAJxGjH19xB85","ActivityMainView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../utils/LogUtil"),c=e("../../network/protocol/ActivityProtocols"),l=e("../../modules/base/Decorators"),d=e("../../common/PlayerModule"),u=e("../../modules/manager/LoadResManager"),h=e("../../utils/GameTools"),p=e("../../network/ClientNetwork"),f=e("../../StaticData/ActivityTableData"),g=e("./ActivityModule"),m=e("../../modules/base/GameView"),_=e("../../common/CommandValue"),y=cc._decorator,v=y.ccclass,C=y.property,S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ScrollViewNode=null,t.ScrollViewItemPrefab=null,t.activityIdArray=[{activityId:c.ACTIVITY_ID_ENUM.P_Activity_WuDaoHui,activityOpenCb:function(){m.default.addPopView("BaseCtrl","ActivityGoldenLeagueView","ActivityGoldenLeagueView")}},{activityId:c.ACTIVITY_ID_ENUM.P_Activity_ChickenDinner,activityOpenCb:function(){m.default.addPopView("BaseCtrl","ChickenDinnerMainView","ChickenDinnerMainView")}},{activityId:c.ACTIVITY_ID_ENUM.P_Activity_Navigation,activityOpenCb:function(){m.default.addPopView("BaseCtrl","NavigationMainView","NavigationMainView")}},{activityId:c.ACTIVITY_ID_ENUM.P_Activity_WeekCooperationRelive,activityOpenCb:function(){m.default.addPopView("BaseCtrl","WeekCooperationReliveMainView","WeekCooperationReliveMainView"),t.closeView()}}],t}return a(t,e),t.path=function(){return"ui/activity/prefab/ActivityMain"},t.prototype.onLoad=function(){var e=this;u.default.loadPrefab("ui/CommonPrefab/TopView").then(function(t){t.parent=e.node,t.getChildByName("goldDiamondContent").active=!1,t.getComponent("TopView").bindExitEvent(function(){e.closeView()})}).catch(function(e){s.default.info(e)}),this.initListenMessageEvent();var t=new c.C_Activity_GetGreatSailingData;t.activityID=c.ACTIVITY_ID_ENUM.P_Activity_Navigation,p.ClientNetwork.getInstance().Send(c.ACTIVITY_CLIENT_ENUM.P_Activity_GetGreatSailingData,t)},t.prototype.start=function(){this.initActivityListInfo()},t.prototype.initActivityListInfo=function(){for(var e=function(e){var t=!1;return d.default.getActivityData().forEach(function(o){o.activityID==e&&(t=o.isRuning)}),t},t=0;t<this.activityIdArray.length;t++){var o=this.activityIdArray[t].activityId,i=e.call(this,o),a=d.default.checkModulerOnOffState(_.ModulerViewOnOff.ChickenDinnerView),n=d.default.checkModulerOnOffState(_.ModulerViewOnOff.NavigationView);o==c.ACTIVITY_ID_ENUM.P_Activity_ChickenDinner&&(i=a),o==c.ACTIVITY_ID_ENUM.P_Activity_Navigation&&(i=n),o==c.ACTIVITY_ID_ENUM.P_Activity_WeekCooperationRelive&&(i=g.default.getWeekCooperationIsOpen()),i&&(this.createActivityItemNode(o).parent=this.ScrollViewNode.content)}this.ScrollViewNode.scrollToLeft(0)},t.prototype.createActivityItemNode=function(e){var t=this,o=cc.instantiate(this.ScrollViewItemPrefab);o.getChildByName("joinBtn").activityId=e,o.name="activity"+e,o.getChildByName("conditionLayout").children[0].active=!0,o.getChildByName("conditionLayout").children[1].active=!1,h.default.registerTouchEvent(o.getChildByName("joinBtn"),function(e){t.activityIdArray.forEach(function(t){t.activityId==e.target.activityId&&t.activityOpenCb()})});var i=f.ActivityTableData.getById(e);if(u.default.loadSpriteFrame("ui/activity/image/activityMain/activity_"+e).then(function(e){o.getComponent(cc.Sprite).spriteFrame=e}),i){o.getChildByName("nameLab").getComponent(cc.Label).string=i.name;var a=i.extranceUrl.split("|");o.getChildByName("openTimeLab").getComponent(cc.Label).string=a[0],o.getChildByName("conditionLayout").children[2].getComponent(cc.Label).string=a[1]}else 9999==e&&o.children.forEach(function(e){e.active=!1});var n=g.default.checkActivityIsOpen(e);if(o.getChildByName("hongdi").active=1==n,e==c.ACTIVITY_ID_ENUM.P_Activity_ChickenDinner){var r=g.default.getChickenDinnerData(),s=i.param3-r.count;s=s<0?0:s,o.getChildByName("countLab").getComponent(cc.Label).string="\u6b21\u6570\uff1a"+s+"/"+i.param3,0==r.status&&(o.getChildByName("hongdi").active=!1)}else if(e==c.ACTIVITY_ID_ENUM.P_Activity_Navigation){var l=g.default.getGreatSailingData();l&&(o.getChildByName("countLab").getComponent(cc.Label).string="\u6b21\u6570\uff1a"+(i.param3-l.failCount)+"/"+i.param3,i.param3-l.failCount==0&&(o.getChildByName("hongdi").active=!1))}else if(e==c.ACTIVITY_ID_ENUM.P_Activity_WeekCooperationRelive){o.getChildByName("conditionLayout").children[0].active=!1,o.getChildByName("conditionLayout").children[1].active=!0;var d=g.default.getWeekCooperationData();if(d){var p=i.param3-d.failcount;p=p<0?0:p,o.getChildByName("countLab").getComponent(cc.Label).string="\u6b21\u6570\uff1a"+p+"/"+(i.param3+d.reliveNum),0==p&&(o.getChildByName("hongdi").active=!1)}}return o},t.prototype.refreshChickenDinnerNum=function(){var e=f.ActivityTableData.getById(c.ACTIVITY_ID_ENUM.P_Activity_ChickenDinner),t=g.default.getChickenDinnerData(),o=this.ScrollViewNode.content.getChildByName("activity"+c.ACTIVITY_ID_ENUM.P_Activity_ChickenDinner);if(o){var i=e.param3-t.count;i=i<0?0:i,o.getChildByName("countLab").getComponent(cc.Label).string="\u6b21\u6570\uff1a"+i+"/"+e.param3,0==t.status&&(o.getChildByName("hongdi").active=!1)}},t.prototype.refreshNavigationJoinNum=function(e){var t=f.ActivityTableData.getById(c.ACTIVITY_ID_ENUM.P_Activity_Navigation),o=this.ScrollViewNode.content.getChildByName("activity"+c.ACTIVITY_ID_ENUM.P_Activity_Navigation);o&&(o.getChildByName("countLab").getComponent(cc.Label).string="\u6b21\u6570\uff1a"+(t.param3-e.failCount)+"/"+t.param3,t.param3-e.failCount==0&&(o.getChildByName("hongdi").active=!1))},t.prototype.initListenMessageEvent=function(){var e=this;p.ClientNetwork.getInstance().listenProtocol(c.ACTIVITY_CLIENT_ENUM.P_Activity_SyncGreatSailingData,function(t){t.resetPos();var o=new c.S_Activity_SyncGreatSailingData;o.read(t)&&0==o.error&&o.activityID==c.ACTIVITY_ID_ENUM.P_Activity_Navigation&&(g.default.setGreatSailingData(o),e.refreshNavigationJoinNum(o))},this)},n([C(cc.ScrollView)],t.prototype,"ScrollViewNode",void 0),n([C(cc.Prefab)],t.prototype,"ScrollViewItemPrefab",void 0),n([l.Register_Class,v],t)}(r.default);o.default=S,cc._RF.pop()},{"../../StaticData/ActivityTableData":"ActivityTableData","../../common/CommandValue":"CommandValue","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/base/GameView":"GameView","../../modules/manager/LoadResManager":"LoadResManager","../../network/ClientNetwork":"ClientNetwork","../../network/protocol/ActivityProtocols":"ActivityProtocols","../../utils/GameTools":"GameTools","../../utils/LogUtil":"LogUtil","./ActivityModule":"ActivityModule"}],ActivityModule:[function(e,t,o){"use strict";cc._RF.push(t,"647fb4YshNGBoXKe37RROgQ","ActivityModule"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../common/PlayerModule"),a=e("../../StaticData/ActivityTableData"),n=e("../../common/PlayerModule"),r=e("../../StaticData/GreatSailingTableData"),s=e("../../utils/GameTools"),c=e("../../network/protocol/ActivityProtocols"),l=e("../../network/protocol/TypeProtocols"),d=e("../../StaticData/RoyaleRoomTableData"),u=e("../../utils/GameUtils"),h=e("../../StaticData/RoyaleBattlePassTableData"),p=e("../../network/protocol/ActivityProtocols"),f=function(){function e(){this.bClickChickenDinner=!1,this.bClickGoldenLeague=!1,this._chickenDinnerData=null,this._chickenDinnerResultData=null,this._battleCards=[],this._tGreatSailingData=null,this.m_oWeekCooperationData=new c.S_Activity_SyncWeekCooperationData}return e.instance=function(){return this._instance||(this._instance=new this),this._instance},e.prototype.checkActivityIsOpen=function(e){var t=a.ActivityTableData.getById(e),o=i.default.getServersTime(),n=new Date(1e3*o),r=(n.getSeconds(),n.getMinutes(),n.getHours(),n.getDay()),c=n.getDate(),l=n.getFullYear(),d=n.getMonth()+1;if(t.param2<0||r==t.param2){if(t.param4<=0&&t.param5<=0)return!0;var u=l+"-"+d+"-"+c+" "+t.param4.toString().slice(0,-2)+":"+t.param4.toString().slice(-2)+":00",h=s.default.timeToTimestamp(u),p=l+"-"+d+"-"+c+" "+t.param5.toString().slice(0,-2)+":"+t.param5.toString().slice(-2)+":00",f=s.default.timeToTimestamp(p);if(o>=h&&o<=f)return!0}return!1},e.prototype.checkOpen=function(e){var t=!1;return i.default.getActivityData().forEach(function(o){o.activityID==e&&(t=o.isRuning)}),t},e.prototype.getTargetTime=function(e){var t=e.split(" ")[0],o=e.split(" ")[1],i=new Date;return i.setFullYear(t.split("-")[0]),i.setMonth(t.split("-")[1]-1),i.setDate(t.split("-")[2]),i.setHours(o.split(":")[0]),i.setMinutes(o.split(":")[1]),i.setSeconds(o.split(":")[2]),i.getTime()},Object.defineProperty(e.prototype,"ClickChickenDinnerState",{get:function(){return this.bClickChickenDinner},set:function(e){this.bClickChickenDinner=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ClickGoldenLeagueState",{get:function(){return this.bClickGoldenLeague},set:function(e){this.bClickGoldenLeague=e},enumerable:!1,configurable:!0}),e.prototype.setChickenDinnerData=function(e){this._chickenDinnerData=e},e.prototype.getChickenDinnerData=function(){return this._chickenDinnerData},e.prototype.checkReceiveSociatyBoxPrize=function(){var e=this,t=[],o=Number(u.getConfigIntValue("royale_battlepass_coin_itemid")),a=i.default.getItemCountByBag(o),n=[];return h.RoyaleBattlePassTableData.getDataMap().forEach(function(e){n.push(e)}),n.forEach(function(o){var n=0,r=e.checkBoxReceiveState(o.id,1);0!=r&&r||a>=o.coinNum&&(n=1);var s,c=0,d=e.checkBoxReceiveState(o.id,2);0!=d&&d||a>=o.coinNum&&1==i.default.getRoleAttrValByKey(l.ROLE_ATTR_VALUES.ROLE_ATTR_ROYALE_BATTLEPASS)&&(c=1),1==n&&((s=new p.T_Activity_RoyaleGetBoxsReward).index=o.id,s.type=1,t.push(s)),1==c&&((s=new p.T_Activity_RoyaleGetBoxsReward).index=o.id,s.type=2,t.push(s))}),t},e.prototype.checkBoxReceiveState=function(e,t){if(!this._chickenDinnerData)return!1;var o=this._chickenDinnerData.normalPrize;return 2==t&&(o=this._chickenDinnerData.superprize),!!o.has(e)&&o.get(e)},e.prototype.setChickenDinnerResultData=function(e){this._chickenDinnerResultData=e},e.prototype.getChickenDinnerResultData=function(){return this._chickenDinnerResultData},e.prototype.getCurShowEquipIdByDate=function(){var e=0,t=i.default.getServersTime(),o=new Date(1e3*t).getDay();return d.RoyaleRoomTableData.getDataMap().forEach(function(t){t.weekday==o&&(e=t.equipId)}),e},e.prototype.getChickenDinneBattleMapIdByDate=function(){var e=0,t=i.default.getServersTime(),o=new Date(1e3*t).getDay();return d.RoyaleRoomTableData.getDataMap().forEach(function(t){t.weekday==o&&(e=t.id)}),e},e.prototype.setNavigationBattleCardGroupId=function(e){var t=this;this._battleCards=[];var o=r.GreatSailingTableData.getById(e).cardGroup;o&&o.length>0&&o.forEach(function(e,o){var i=new n.HeroCarModule;i.heroId=e,i.heroLevel=t.getHeroCardLevel(e),t._battleCards[o]=i})},e.prototype.getNavigationBattleCards=function(){return this._battleCards},e.prototype.getHeroCardLevel=function(e){var t=1;return i.default.getHeroCarData().forEach(function(o){o&&1==o.bHeroLock&&o.heroId==e&&(t=o.heroLevel)}),t},e.prototype.setGreatSailingData=function(e){this._tGreatSailingData=e},e.prototype.getGreatSailingData=function(){return this._tGreatSailingData||null},e.prototype.syncWeekCooperationData=function(e){this.m_oWeekCooperationData=e},e.prototype.getWeekCooperationData=function(){return this.m_oWeekCooperationData},e.prototype.getWeekCooperationJoinCount=function(){return this.m_oWeekCooperationData.failcount},e.prototype.getWeekCooperationIsOpen=function(){return this.m_oWeekCooperationData.isOpen},e.prototype.checkIsAssistFightingState=function(){return a.ActivityTableData.getById(c.ACTIVITY_ID_ENUM.P_Activity_WeekCooperationRelive).param3+this.m_oWeekCooperationData.reliveNum-this.m_oWeekCooperationData.failcount<=0},e.prototype.isChickenDinnerMatching=function(){var e=this.getChickenDinnerData();return!!(e&&e.status>=l.EATCHICKEN_STAGE.EATCHICKEN_STAGE_ASSEMBLE)&&(console.log("isChickenDinnerMatching sta="+e.status),!0)},e}();o.default=f.instance(),cc._RF.pop()},{"../../StaticData/ActivityTableData":"ActivityTableData","../../StaticData/GreatSailingTableData":"GreatSailingTableData","../../StaticData/RoyaleBattlePassTableData":"RoyaleBattlePassTableData","../../StaticData/RoyaleRoomTableData":"RoyaleRoomTableData","../../common/PlayerModule":"PlayerModule","../../network/protocol/ActivityProtocols":"ActivityProtocols","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils"}],ActivityProtocols:[function(e,t,o){"use strict";cc._RF.push(t,"2eb2aTA+ddC64+FwR4g6fNL","ActivityProtocols"),e("DataViewRW");var i=e("ObjCollection"),a=e("long"),n=e("./BaseProtocols").T_Reward;(function(e){e[e.P_Activity_FristRecharge=1]="P_Activity_FristRecharge",e[e.P_Activity_Box1=11]="P_Activity_Box1",e[e.P_Activity_Box2=12]="P_Activity_Box2",e[e.P_Activity_Box3=13]="P_Activity_Box3",e[e.P_Activity_WuDaoHui=2e3]="P_Activity_WuDaoHui",e[e.P_Activity_ChickenDinner=3e3]="P_Activity_ChickenDinner",e[e.P_Activity_SociatyWar=4e3]="P_Activity_SociatyWar",e[e.P_Activity_Navigation=5e3]="P_Activity_Navigation",e[e.P_Activity_SkyCastle=6e3]="P_Activity_SkyCastle",e[e.P_Activity_WeekCooperationRelive=7e3]="P_Activity_WeekCooperationRelive",e[e.P_Activity_LimitTimeRecharge=8e3]="P_Activity_LimitTimeRecharge",e[e.P_Activity_LimitTimeChicken=8100]="P_Activity_LimitTimeChicken",e[e.P_Activity_Anniversary=9e3]="P_Activity_Anniversary",e[e.P_Activity_ReturnBack=9100]="P_Activity_ReturnBack",e[e.P_Activity_FogHidden=1e4]="P_Activity_FogHidden",e[e.P_Activity_Machinarium=11e3]="P_Activity_Machinarium"})(o.ACTIVITY_ID_ENUM||(o.ACTIVITY_ID_ENUM={})),function(e){e[e.P_Activity_Begin=4e6]="P_Activity_Begin",e[e.P_Activity_SynAllActivityData=4000001]="P_Activity_SynAllActivityData",e[e.P_Activity_SynActivityData=4000002]="P_Activity_SynActivityData",e[e.P_Activity_CloseActivity=4000003]="P_Activity_CloseActivity",e[e.P_Activity_GetExcLuckDrawData=4000004]="P_Activity_GetExcLuckDrawData",e[e.P_Activity_LuckDraw=4000005]="P_Activity_LuckDraw",e[e.P_Activity_ReceiveLuckDrawAdditionalPrize=4000006]="P_Activity_ReceiveLuckDrawAdditionalPrize",e[e.P_Activity_IntoRandomArena=4000007]="P_Activity_IntoRandomArena",e[e.P_Activity_GetRandomArenaData=4000008]="P_Activity_GetRandomArenaData",e[e.P_Activity_GetRandomArenaPositionHero=4000009]="P_Activity_GetRandomArenaPositionHero",e[e.P_Activity_ChooseRandomArenaHero=4000010]="P_Activity_ChooseRandomArenaHero",e[e.P_Activity_UpdateRandomArenaHero=4000011]="P_Activity_UpdateRandomArenaHero",e[e.P_Activity_ReceiveRandomArenaReward=4000012]="P_Activity_ReceiveRandomArenaReward",e[e.P_Activity_ReceiveRandomArenaSingleReward=4000013]="P_Activity_ReceiveRandomArenaSingleReward",e[e.P_Activity_GetDayPrizeData=4000014]="P_Activity_GetDayPrizeData",e[e.P_Activity_ReceiveDayPrize=4000015]="P_Activity_ReceiveDayPrize",e[e.P_Activity_GetGoldenLeagueData=4000016]="P_Activity_GetGoldenLeagueData",e[e.P_Activity_GetRechargeData=4000017]="P_Activity_GetRechargeData",e[e.P_Activity_RechargeReceivePrize=4000018]="P_Activity_RechargeReceivePrize",e[e.P_Activity_GetCooperationData=4000019]="P_Activity_GetCooperationData",e[e.P_Activity_ReceiveCooperationChallengeReward=4000020]="P_Activity_ReceiveCooperationChallengeReward",e[e.P_Activity_ReceiveCooperationCumulativeLayersReward=4000021]="P_Activity_ReceiveCooperationCumulativeLayersReward",e[e.P_Activity_BuyCooperationNum=4000022]="P_Activity_BuyCooperationNum",e[e.P_Activity_AddCooperationNum=4000023]="P_Activity_AddCooperationNum",e[e.P_Activity_GetRandomPrizeData=4000024]="P_Activity_GetRandomPrizeData",e[e.P_Activity_RandomPrize=4000025]="P_Activity_RandomPrize",e[e.P_Activity_GetDayRechargeData=4000026]="P_Activity_GetDayRechargeData",e[e.P_Activity_ReceiveFinishPrize=4000027]="P_Activity_ReceiveFinishPrize",e[e.P_Activity_ReceiveDayRechargePrize=4000028]="P_Activity_ReceiveDayRechargePrize",e[e.P_Activity_GetRechargeRandomChooseData=4000029]="P_Activity_GetRechargeRandomChooseData",e[e.P_Activity_RechargeRandomChoosePrize=4000030]="P_Activity_RechargeRandomChoosePrize",e[e.P_Activity_ReceiveGoldenLeagueDayPrize=4000031]="P_Activity_ReceiveGoldenLeagueDayPrize",e[e.P_Activity_GetTotalRechargeData=4000032]="P_Activity_GetTotalRechargeData",e[e.P_Activity_ReceiveTotalRechargePrize=4000033]="P_Activity_ReceiveTotalRechargePrize",e[e.P_Activity_SyncMirrorArenaData=4000034]="P_Activity_SyncMirrorArenaData",e[e.P_Activity_ReceiveMirrorArenaFightPrize=4000035]="P_Activity_ReceiveMirrorArenaFightPrize",e[e.P_Activity_GetCoinRechargeData=4000036]="P_Activity_GetCoinRechargeData",e[e.P_Activity_ReceiveCoinRechargePrize=4000037]="P_Activity_ReceiveCoinRechargePrize",e[e.P_Activity_SyncTotalGivePrize=4000038]="P_Activity_SyncTotalGivePrize",e[e.P_Activity_ReceiveTotalGivePrize=4000039]="P_Activity_ReceiveTotalGivePrize",e[e.P_Activity_SyncLimitChallengeData=4000040]="P_Activity_SyncLimitChallengeData",e[e.P_Activity_ReceiveLimitChallengePrize=4000041]="P_Activity_ReceiveLimitChallengePrize",e[e.P_Activity_ResetLimitChallengeFail=4000042]="P_Activity_ResetLimitChallengeFail",e[e.P_Activity_ResetLimitChallengeWin=4000043]="P_Activity_ResetLimitChallengeWin",e[e.P_Activity_UpLimitChallengeHero=4000044]="P_Activity_UpLimitChallengeHero",e[e.P_Activity_ReceiveGoldenLeagueWinNumPrize=4000045]="P_Activity_ReceiveGoldenLeagueWinNumPrize",e[e.P_Activity_GetEatChickenData=4000046]="P_Activity_GetEatChickenData",e[e.P_Activity_SyncEatChickenData=4000047]="P_Activity_SyncEatChickenData",e[e.P_Activity_ReceiveSociatyWarWinNumPrize=4000048]="P_Activity_ReceiveSociatyWarWinNumPrize",e[e.P_Activity_GetSociatyWarData=4000049]="P_Activity_GetSociatyWarData",e[e.P_Activity_SyncSociatyWarData=4000050]="P_Activity_SyncSociatyWarData",e[e.P_Activity_SociatyWarRelive=4000051]="P_Activity_SociatyWarRelive",e[e.P_Activity_GetGreatSailingData=4000052]="P_Activity_GetGreatSailingData",e[e.P_Activity_SyncGreatSailingData=4000053]="P_Activity_SyncGreatSailingData",e[e.P_Activity_GreatSailingRelive=4000054]="P_Activity_GreatSailingRelive",e[e.P_Activity_GreatSailingRefleshCard=4000055]="P_Activity_GreatSailingRefleshCard",e[e.P_Activity_GetSkyCastleData=4000056]="P_Activity_GetSkyCastleData",e[e.P_Activity_SyncSkyCastleData=4000057]="P_Activity_SyncSkyCastleData",e[e.P_Activity_ReceiveSkyCastlePrize=4000058]="P_Activity_ReceiveSkyCastlePrize",e[e.P_Activity_CastleSkyGetBoxsReward=4000059]="P_Activity_CastleSkyGetBoxsReward",e[e.P_Activity_SyncWeekCooperationData=4000060]="P_Activity_SyncWeekCooperationData",e[e.P_Activity_WeekCooperationRelive=4000061]="P_Activity_WeekCooperationRelive",e[e.P_Activity_RoyaleGetBoxsReward=4000062]="P_Activity_RoyaleGetBoxsReward",e[e.P_Activity_SyncAnniversaryTrialData=4000063]="P_Activity_SyncAnniversaryTrialData",e[e.P_Activity_AnniversaryTrialGetBoxsReward=4000064]="P_Activity_AnniversaryTrialGetBoxsReward",e[e.P_Activity_SyncReturnBackData=4000065]="P_Activity_SyncReturnBackData",e[e.P_Activity_ReturnBackHelpNew=4000066]="P_Activity_ReturnBackHelpNew",e[e.P_Activity_SyncFogHiddenData=4000067]="P_Activity_SyncFogHiddenData",e[e.P_Activity_FogHiddenGetBoxsReward=4000068]="P_Activity_FogHiddenGetBoxsReward",e[e.P_Activity_SyncMachinariumData=4000069]="P_Activity_SyncMachinariumData",e[e.P_Activity_MachinariumGetBattlePassReward=4000070]="P_Activity_MachinariumGetBattlePassReward"}(o.ACTIVITY_CLIENT_ENUM||(o.ACTIVITY_CLIENT_ENUM={}));var r=function(){function e(){this.isRuning=!1,this.activityID=0,this.beginTime=0,this.endTime=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<13||(this.isRuning=e.getBool(),this.activityID=e.getInt32(),this.beginTime=e.getInt32(),this.endTime=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setBool(this.isRuning),e.setInt32(this.activityID),e.setInt32(this.beginTime),e.setInt32(this.endTime)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Activity_Data=r;var s=function(){function e(){this.activityID=0,this.roleID=a.fromValue(0)}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<12||(this.activityID=e.getInt32(),this.roleID=e.getLong(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.activityID),e.setLong(this.roleID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Activity_Role_Data=s;var c=function(){function e(){this.activityData=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();if(e.getLen()-e.getPos()<17*t)return!1;this.activityData.clear();for(var o=0;o<t;++o){var i;i=e.getInt32();var a=new r;if(!a.read(e))return!1;this.activityData.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setUint32(this.activityData.size),this.activityData.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Activity_SynAllActivityData=c;var l=function(){function e(){this.data=new r}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<13||!this.data.read(e))},e.prototype.writeNoEnd=function(e){this.data.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Activity_SynActivityData=l;var d=function(){function e(){this.activityID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.activityID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.activityID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Activity_CloseActivity=d;var u=function(){function e(){this.activityID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.activityID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.activityID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Activity_GetExcLuckDrawData=u;var h=function(){function e(){this.errorcode=0,this.activityID=0,this.luckDrawAdditionDayNum=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<12||(this.errorcode=e.getInt32(),this.activityID=e.getInt32(),this.luckDrawAdditionDayNum=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setInt32(this.activityID),e.setInt32(this.luckDrawAdditionDayNum)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Activity_GetExcLuckDrawData=h;var p=function(){function e(){this.activityID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.activityID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.activityID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Activity_LuckDraw=p;var f=function(){function e(){this.errorcode=0,this.activityID=0,this.rewards=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<12)return!1;this.errorcode=e.getInt32(),this.activityID=e.getInt32();var t=e.getUint32();this.rewards=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.rewards.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setInt32(this.activityID),e.setUint32(this.rewards.length),this.rewards.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Activity_LuckDraw=f;var g=function(){function e(){this.activityID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.activityID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.activityID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Activity_ReceiveLuckDrawAdditionalPrize=g;var m=function(){function e(){this.errorcode=0,this.activityID=0,this.rewards=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<12)return!1;this.errorcode=e.getInt32(),this.activityID=e.getInt32();var t=e.getUint32();this.rewards=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.rewards.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setInt32(this.activityID),e.setUint32(this.rewards.length),this.rewards.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Activity_ReceiveLuckDrawAdditionalPrize=m;var _=function(){function e(){this.activityID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.activityID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.activityID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Activity_IntoRandomArena=_;var y=function(){function e(){this.error=0,this.activityID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.error=e.getInt32(),this.activityID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.error),e.setInt32(this.activityID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Activity_IntoRandomArena=y;var v=function(){function e(){this.heroid=0,this.level=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.heroid=e.getInt32(),this.level=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.heroid),e.setInt32(this.level)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Activity_RandomArenaData_Hero_Data=v;var C=function(){function e(){this.isTicket=!1,this.isReward=!1,this.selectHeroID=[],this.winNum=0,this.failNum=0,this.reward=new i.ObjMap,this.dayNum=0}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<6)return!1;this.isTicket=e.getBool(),this.isReward=e.getBool();var t=e.getUint32();if(e.getLen()-e.getPos()<8*t)return!1;this.selectHeroID=[];for(var o=0;o<t;++o){var i=new v;if(!i.read(e))return!1;this.selectHeroID.push(i)}if(e.getLen()-e.getPos()<12)return!1;this.winNum=e.getInt32(),this.failNum=e.getInt32();var a=e.getUint32();if(e.getLen()-e.getPos()<5*a)return!1;this.reward.clear();for(var n=0;n<a;++n){var r,s;r=e.getInt32(),s=e.getBool(),this.reward.set(r,s)}return!(e.getLen()-e.getPos()<4||(this.dayNum=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setBool(this.isTicket),e.setBool(this.isReward),e.setUint32(this.selectHeroID.length),this.selectHeroID.forEach(function(t){t.writeNoEnd(e)}),e.setInt32(this.winNum),e.setInt32(this.failNum),e.setUint32(this.reward.size),this.reward.forEach(function(t,o){e.setInt32(o),e.setBool(t)}),e.setInt32(this.dayNum)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Activity_RandomArenaData_Role_Data=C;var S=function(){function e(){this.activityID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.activityID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.activityID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Activity_GetRandomArenaData=S;var T=function(){function e(){this.error=0,this.activityID=0,this.randomeArenaData=new C}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.error=e.getInt32(),this.activityID=e.getInt32(),!this.randomeArenaData.read(e)))},e.prototype.writeNoEnd=function(e){e.setInt32(this.error),e.setInt32(this.activityID),this.randomeArenaData.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Activity_GetRandomArenaData=T;var I=function(){function e(){this.activityID=0,this.position=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.activityID=e.getInt32(),this.position=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.activityID),e.setInt32(this.position)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Activity_GetRandomArenaPositionHero=I;var N=function(){function e(){this.error=0,this.activityID=0,this.heroVec=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<12)return!1;this.error=e.getInt32(),this.activityID=e.getInt32();var t=e.getUint32();if(e.getLen()-e.getPos()<8*t)return!1;this.heroVec=[];for(var o=0;o<t;++o){var i=new v;if(!i.read(e))return!1;this.heroVec.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.error),e.setInt32(this.activityID),e.setUint32(this.heroVec.length),this.heroVec.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Activity_GetRandomArenaPositionHero=N;var b=function(){function e(){this.activityID=0,this.heroID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.activityID=e.getInt32(),this.heroID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.activityID),e.setInt32(this.heroID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Activity_ChooseRandomArenaHero=b;var w=function(){function e(){this.error=0,this.activityID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.error=e.getInt32(),this.activityID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.error),e.setInt32(this.activityID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Activity_ChooseRandomArenaHero=w;var E=function(){function e(){this.error=0,this.activityID=0,this.heroID=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<12)return!1;this.error=e.getInt32(),this.activityID=e.getInt32();var t=e.getUint32();if(e.getLen()-e.getPos()<8*t)return!1;this.heroID=[];for(var o=0;o<t;++o){var i=new v;if(!i.read(e))return!1;this.heroID.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.error),e.setInt32(this.activityID),e.setUint32(this.heroID.length),this.heroID.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Activity_UpdateRandomArenaHero=E;var P=function(){function e(){this.activityID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.activityID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.activityID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Activity_ReceiveRandomArenaReward=P;var R=function(){function e(){this.error=0,this.activityID=0,this.rewards=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<12)return!1;this.error=e.getInt32(),this.activityID=e.getInt32();var t=e.getUint32();this.rewards=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.rewards.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.error),e.setInt32(this.activityID),e.setUint32(this.rewards.length),this.rewards.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Activity_ReceiveRandomArenaReward=R;var L=function(){function e(){this.activityID=0,this.num=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.activityID=e.getInt32(),this.num=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.activityID),e.setInt32(this.num)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Activity_ReceiveRandomArenaSingleReward=L;var A=function(){function e(){this.error=0,this.activityID=0,this.num=0,this.rewards=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<16)return!1;this.error=e.getInt32(),this.activityID=e.getInt32(),this.num=e.getInt32();var t=e.getUint32();this.rewards=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.rewards.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.error),e.setInt32(this.activityID),e.setInt32(this.num),e.setUint32(this.rewards.length),this.rewards.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Activity_ReceiveRandomArenaSingleReward=A;var D=function(){function e(){this.activityID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.activityID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.activityID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Activity_GetDayPrizeData=D;var M=function(){function e(){this.activityID=0,this.isOpen=!1,this.dayPrizeNum=0,this.totalDay=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<13||(this.activityID=e.getInt32(),this.isOpen=e.getBool(),this.dayPrizeNum=e.getInt32(),this.totalDay=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.activityID),e.setBool(this.isOpen),e.setInt32(this.dayPrizeNum),e.setInt32(this.totalDay)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Activity_GetDayPrizeData=M;var B=function(){function e(){this.activityID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.activityID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.activityID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Activity_ReceiveDayPrize=B;var k=function(){function e(){this.activityID=0,this.errorcode=0,this.rewards=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<12)return!1;this.activityID=e.getInt32(),this.errorcode=e.getInt32();var t=e.getUint32();this.rewards=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.rewards.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.activityID),e.setInt32(this.errorcode),e.setUint32(this.rewards.length),this.rewards.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Activity_ReceiveDayPrize=k;var G=function(){function e(){this.activityID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.activityID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.activityID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Activity_GetGoldenLeagueData=G;var O=function(){function e(){this.isReceive=!1}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<1||(this.isReceive=e.getBool(),0))},e.prototype.writeNoEnd=function(e){e.setBool(this.isReceive)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Activity_Role_GoldenLeague_WinNum_Data=O;var H=function(){function e(){this.error=0,this.activityID=0,this.failCount=0,this.isOpen=!1,this.score=0,this.stage=0,this.dayFailNum=0,this.dayFirstSuccessState=0,this.dayMatchNum=0,this.winNum=0,this.prize=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<41)return!1;this.error=e.getInt32(),this.activityID=e.getInt32(),this.failCount=e.getInt32(),this.isOpen=e.getBool(),this.score=e.getInt32(),this.stage=e.getInt32(),this.dayFailNum=e.getInt32(),this.dayFirstSuccessState=e.getInt32(),this.dayMatchNum=e.getInt32(),this.winNum=e.getInt32();var t=e.getUint32();if(e.getLen()-e.getPos()<5*t)return!1;this.prize.clear();for(var o=0;o<t;++o){var i;i=e.getInt32();var a=new O;if(!a.read(e))return!1;this.prize.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.error),e.setInt32(this.activityID),e.setInt32(this.failCount),e.setBool(this.isOpen),e.setInt32(this.score),e.setInt32(this.stage),e.setInt32(this.dayFailNum),e.setInt32(this.dayFirstSuccessState),e.setInt32(this.dayMatchNum),e.setInt32(this.winNum),e.setUint32(this.prize.size),this.prize.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Activity_GetGoldenLeagueData=H;var V=function(){function e(){this.activityID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.activityID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.activityID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Activity_GetRechargeData=V;var F=function(){function e(){this.isReceive=!1,this.rechargeNum=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<5||(this.isReceive=e.getBool(),this.rechargeNum=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setBool(this.isReceive),e.setInt32(this.rechargeNum)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Activity_Role_Recharge_Gear_Data=F;var U=function(){function e(){this.gears=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();if(e.getLen()-e.getPos()<9*t)return!1;this.gears.clear();for(var o=0;o<t;++o){var i;i=e.getInt32();var a=new F;if(!a.read(e))return!1;this.gears.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setUint32(this.gears.size),this.gears.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Activity_Role_Recharge_Data=U;var x=function(){function e(){this.activityID=0,this._data=new U}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.activityID=e.getInt32(),!this._data.read(e)))},e.prototype.writeNoEnd=function(e){e.setInt32(this.activityID),this._data.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Activity_GetRechargeData=x;var Y=function(){function e(){this.activityID=0,this.gearID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.activityID=e.getInt32(),this.gearID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.activityID),e.setInt32(this.gearID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Activity_RechargeReceivePrize=Y;var j=function(){function e(){this.errorcode=0,this.activityID=0,this.gearID=0,this.rewards=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<16)return!1;this.errorcode=e.getInt32(),this.activityID=e.getInt32(),this.gearID=e.getInt32();var t=e.getUint32();this.rewards=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.rewards.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setInt32(this.activityID),e.setInt32(this.gearID),e.setUint32(this.rewards.length),this.rewards.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Activity_RechargeReceivePrize=j;var W=function(){function e(){this.isReceive=!1}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<1||(this.isReceive=e.getBool(),0))},e.prototype.writeNoEnd=function(e){e.setBool(this.isReceive)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Activity_Role_Cooperation_Receive_Data=W;var z=function(){function e(){this.cooperationLeftNum=0,this.cooperationWatchAdNum=0,this.cooperationBuyNum=0,this.cooperationNum=0,this.maxRound=0,this.roundReward=new i.ObjMap,this.cumulativeReward=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<24)return!1;this.cooperationLeftNum=e.getInt32(),this.cooperationWatchAdNum=e.getInt32(),this.cooperationBuyNum=e.getInt32(),this.cooperationNum=e.getInt32(),this.maxRound=e.getInt32();var t=e.getUint32();if(e.getLen()-e.getPos()<5*t)return!1;this.roundReward.clear();for(var o=0;o<t;++o){var i;i=e.getInt32();var a=new W;if(!a.read(e))return!1;this.roundReward.set(i,a)}if(e.getLen()-e.getPos()<4)return!1;var n=e.getUint32();if(e.getLen()-e.getPos()<5*n)return!1;this.cumulativeReward.clear();for(var r=0;r<n;++r){var s;s=e.getInt32();var c=new W;if(!c.read(e))return!1;this.cumulativeReward.set(s,c)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.cooperationLeftNum),e.setInt32(this.cooperationWatchAdNum),e.setInt32(this.cooperationBuyNum),e.setInt32(this.cooperationNum),e.setInt32(this.maxRound),e.setUint32(this.roundReward.size),this.roundReward.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)}),e.setUint32(this.cumulativeReward.size),this.cumulativeReward.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Activity_CooperationData_Role_Data=z;var K=function(){function e(){this.activityID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.activityID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.activityID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Activity_GetCooperationData=K;var q=function(){function e(){this.errorcode=0,this.activityID=0,this.buffID=[],this.bufftime=0,this.cooperationData=new z}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<12)return!1;this.errorcode=e.getInt32(),this.activityID=e.getInt32();var t=e.getUint32();if(e.getLen()-e.getPos()<4*t)return!1;this.buffID=[];for(var o=0;o<t;++o){var i;i=e.getInt32(),this.buffID.push(i)}return!(e.getLen()-e.getPos()<4||(this.bufftime=e.getInt32(),!this.cooperationData.read(e)))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setInt32(this.activityID),e.setUint32(this.buffID.length),this.buffID.forEach(function(t){e.setInt32(t)}),e.setInt32(this.bufftime),this.cooperationData.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Activity_GetCooperationData=q;var Q=function(){function e(){this.activityID=0,this.rewardID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.activityID=e.getInt32(),this.rewardID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.activityID),e.setInt32(this.rewardID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Activity_ReceiveCooperationChallengeReward=Q;var X=function(){function e(){this.errorcode=0,this.activityID=0,this.rewardID=0,this.rewards=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<16)return!1;this.errorcode=e.getInt32(),this.activityID=e.getInt32(),this.rewardID=e.getInt32();var t=e.getUint32();this.rewards=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.rewards.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setInt32(this.activityID),e.setInt32(this.rewardID),e.setUint32(this.rewards.length),this.rewards.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Activity_ReceiveCooperationChallengeReward=X;var J=function(){function e(){this.activityID=0,this.rewardID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.activityID=e.getInt32(),this.rewardID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.activityID),e.setInt32(this.rewardID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Activity_ReceiveCooperationCumulativeLayersReward=J;var Z=function(){function e(){this.errorcode=0,this.activityID=0,this.rewardID=0,this.rewards=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<16)return!1;this.errorcode=e.getInt32(),this.activityID=e.getInt32(),this.rewardID=e.getInt32();var t=e.getUint32();this.rewards=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.rewards.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setInt32(this.activityID),e.setInt32(this.rewardID),e.setUint32(this.rewards.length),this.rewards.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Activity_ReceiveCooperationCumulativeLayersReward=Z;var $=function(){function e(){this.activityID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.activityID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.activityID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Activity_BuyCooperationNum=$;var ee=function(){function e(){this.errorcode=0,this.activityID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.errorcode=e.getInt32(),this.activityID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setInt32(this.activityID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Activity_BuyCooperationNum=ee;var te=function(){function e(){this.activityID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.activityID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.activityID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Activity_AddCooperationNum=te;var oe=function(){function e(){this.errorcode=0,this.activityID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.errorcode=e.getInt32(),this.activityID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setInt32(this.activityID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Activity_AddCooperationNum=oe;var ie=function(){function e(){this.activityID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.activityID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.activityID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Activity_GetRandomPrizeData=ie;var ae=function(){function e(){this.rechargeNum=0,this.prizeNum=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.rechargeNum=e.getInt32(),this.prizeNum=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.rechargeNum),e.setInt32(this.prizeNum)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Activity_Role_RandomPrizeData=ae;var ne=function(){function e(){this.activityID=0,this._data=new ae}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<12||(this.activityID=e.getInt32(),!this._data.read(e)))},e.prototype.writeNoEnd=function(e){e.setInt32(this.activityID),this._data.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Activity_GetRandomPrizeData=ne;var re=function(){function e(){this.activityID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.activityID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.activityID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Activity_RandomPrize=re;var se=function(){function e(){this.errorcode=0,this.activityID=0,this.rewards=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<12)return!1;this.errorcode=e.getInt32(),this.activityID=e.getInt32();var t=e.getUint32();this.rewards=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.rewards.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setInt32(this.activityID),e.setUint32(this.rewards.length),this.rewards.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Activity_RandomPrize=se;var ce=function(){function e(){this.rechargenum=0,this.isReceive=!1}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<5||(this.rechargenum=e.getInt32(),this.isReceive=e.getBool(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.rechargenum),e.setBool(this.isReceive)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Activity_DayRecharge=ce;var le=function(){function e(){this.isFinishPrize=!1,this.dayRecharge=new i.ObjMap,this.dayRechargeNum=0}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<5)return!1;this.isFinishPrize=e.getBool();var t=e.getUint32();if(e.getLen()-e.getPos()<9*t)return!1;this.dayRecharge.clear();for(var o=0;o<t;++o){var i;i=e.getInt32();var a=new ce;if(!a.read(e))return!1;this.dayRecharge.set(i,a)}return!(e.getLen()-e.getPos()<4||(this.dayRechargeNum=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setBool(this.isFinishPrize),e.setUint32(this.dayRecharge.size),this.dayRecharge.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)}),e.setInt32(this.dayRechargeNum)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Activity_DayRechargeData=le;var de=function(){function e(){this.activityID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.activityID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.activityID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Activity_GetDayRechargeData=de;var ue=function(){function e(){this.errorcode=0,this.activityID=0,this.data=new le}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.errorcode=e.getInt32(),this.activityID=e.getInt32(),!this.data.read(e)))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setInt32(this.activityID),this.data.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Activity_GetDayRechargeData=ue;var he=function(){function e(){this.activityID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.activityID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.activityID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Activity_ReceiveFinishPrize=he;var pe=function(){function e(){this.errorcode=0,this.activityID=0,this.rewards=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<12)return!1;this.errorcode=e.getInt32(),this.activityID=e.getInt32();var t=e.getUint32();this.rewards=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.rewards.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setInt32(this.activityID),e.setUint32(this.rewards.length),this.rewards.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Activity_ReceiveFinishPrize=pe;var fe=function(){function e(){this.activityID=0,this.dayID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.activityID=e.getInt32(),this.dayID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.activityID),e.setInt32(this.dayID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Activity_ReceiveDayRechargePrize=fe;var ge=function(){function e(){this.errorcode=0,this.activityID=0,this.dayID=0,this.rewards=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<16)return!1;this.errorcode=e.getInt32(),this.activityID=e.getInt32(),this.dayID=e.getInt32();var t=e.getUint32();this.rewards=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.rewards.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setInt32(this.activityID),e.setInt32(this.dayID),e.setUint32(this.rewards.length),this.rewards.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Activity_ReceiveDayRechargePrize=ge;var me=function(){function e(){this.activityID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.activityID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.activityID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Activity_GetRechargeRandomChooseData=me;var _e=function(){function e(){this.bReceive=!1}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<1||(this.bReceive=e.getBool(),0))},e.prototype.writeNoEnd=function(e){e.setBool(this.bReceive)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_RechargeRandomChoose_Position_Data=_e;var ye=function(){function e(){this.positions=new i.ObjMap,this.prizeNum=0}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();if(e.getLen()-e.getPos()<5*t)return!1;this.positions.clear();for(var o=0;o<t;++o){var i;i=e.getInt32();var a=new _e;if(!a.read(e))return!1;this.positions.set(i,a)}return!(e.getLen()-e.getPos()<4||(this.prizeNum=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setUint32(this.positions.size),this.positions.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)}),e.setInt32(this.prizeNum)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_RechargeRandomChoose_Data=ye;var ve=function(){function e(){this.activityID=0,this._data=new ye}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.activityID=e.getInt32(),!this._data.read(e)))},e.prototype.writeNoEnd=function(e){e.setInt32(this.activityID),this._data.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Activity_GetRechargeRandomChooseData=ve;var Ce=function(){function e(){this.activityID=0,this.positionIndex=0,this.rewards=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<12)return!1;this.activityID=e.getInt32(),this.positionIndex=e.getInt32();var t=e.getUint32();this.rewards=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.rewards.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.activityID),e.setInt32(this.positionIndex),e.setUint32(this.rewards.length),this.rewards.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Activity_RechargeRandomChoosePrize=Ce;var Se=function(){function e(){this.activityID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.activityID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.activityID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Activity_ReceiveGoldenLeagueDayPrize=Se;var Te=function(){function e(){this.errorcode=0,this.activityID=0,this.rewards=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<12)return!1;this.errorcode=e.getInt32(),this.activityID=e.getInt32();var t=e.getUint32();this.rewards=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.rewards.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setInt32(this.activityID),e.setUint32(this.rewards.length),this.rewards.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Activity_ReceiveGoldenLeagueDayPrize=Te;var Ie=function(){function e(){this.isReceive=!1}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<1||(this.isReceive=e.getBool(),0))},e.prototype.writeNoEnd=function(e){e.setBool(this.isReceive)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Activity_TotalRecharge=Ie;var Ne=function(){function e(){this.rechargeNum=0,this.rechargeData=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.rechargeNum=e.getInt32();var t=e.getUint32();if(e.getLen()-e.getPos()<5*t)return!1;this.rechargeData.clear();for(var o=0;o<t;++o){var i;i=e.getInt32();var a=new Ie;if(!a.read(e))return!1;this.rechargeData.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.rechargeNum),e.setUint32(this.rechargeData.size),this.rechargeData.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Activity_GetTotalRechargeData=Ne;var be=function(){function e(){this.activityID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.activityID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.activityID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Activity_GetTotalRechargeData=be;var we=function(){function e(){this.errorcode=0,this.activityID=0,this._data=new Ne}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.errorcode=e.getInt32(),this.activityID=e.getInt32(),!this._data.read(e)))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setInt32(this.activityID),this._data.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Activity_GetTotalRechargeData=we;var Ee=function(){function e(){this.activityID=0,this.id=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.activityID=e.getInt32(),this.id=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.activityID),e.setInt32(this.id)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Activity_ReceiveTotalRechargePrize=Ee;var Pe=function(){function e(){this.errorcode=0,this.activityID=0,this.rewards=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<12)return!1;this.errorcode=e.getInt32(),this.activityID=e.getInt32();var t=e.getUint32();this.rewards=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.rewards.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setInt32(this.activityID),e.setUint32(this.rewards.length),this.rewards.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Activity_ReceiveTotalRechargePrize=Pe;var Re=function(){function e(){this.activityID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.activityID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.activityID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Activity_SyncMirrorArenaData=Re;var Le=function(){function e(){this.errorcode=0,this.activityID=0,this.winNum=0,this.isEnter=!1,this.isReceive=!1}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<14||(this.errorcode=e.getInt32(),this.activityID=e.getInt32(),this.winNum=e.getInt32(),this.isEnter=e.getBool(),this.isReceive=e.getBool(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setInt32(this.activityID),e.setInt32(this.winNum),e.setBool(this.isEnter),e.setBool(this.isReceive)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Activity_SyncMirrorArenaData=Le;var Ae=function(){function e(){this.activityID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.activityID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.activityID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Activity_ReceiveMirrorArenaFightPrize=Ae;var De=function(){function e(){this.errorcode=0,this.activityID=0,this.rewards=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<12)return!1;this.errorcode=e.getInt32(),this.activityID=e.getInt32();var t=e.getUint32();this.rewards=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.rewards.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setInt32(this.activityID),e.setUint32(this.rewards.length),this.rewards.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Activity_ReceiveMirrorArenaFightPrize=De;var Me=function(){function e(){this.positionID=0,this.coinFinishNum=0,this.islock=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<12||(this.positionID=e.getInt32(),this.coinFinishNum=e.getInt32(),this.islock=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.positionID),e.setInt32(this.coinFinishNum),e.setInt32(this.islock)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Activity_CoinRechargeData=Me;var Be=function(){function e(){this.activityID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.activityID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.activityID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Activity_GetCoinRechargeData=Be;var ke=function(){function e(){this.errorcode=0,this.activityID=0,this.data=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<12)return!1;this.errorcode=e.getInt32(),this.activityID=e.getInt32();var t=e.getUint32();if(e.getLen()-e.getPos()<16*t)return!1;this.data.clear();for(var o=0;o<t;++o){var i;i=e.getInt32();var a=new Me;if(!a.read(e))return!1;this.data.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setInt32(this.activityID),e.setUint32(this.data.size),this.data.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Activity_GetCoinRechargeData=ke;var Ge=function(){function e(){this.activityID=0,this.positionID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.activityID=e.getInt32(),this.positionID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.activityID),e.setInt32(this.positionID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Activity_ReceiveCoinRechargePrize=Ge;var Oe=function(){function e(){this.errorcode=0,this.activityID=0,this.positionID=0,this.rewards=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<16)return!1;this.errorcode=e.getInt32(),this.activityID=e.getInt32(),this.positionID=e.getInt32();var t=e.getUint32();this.rewards=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.rewards.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setInt32(this.activityID),e.setInt32(this.positionID),e.setUint32(this.rewards.length),this.rewards.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Activity_ReceiveCoinRechargePrize=Oe;var He=function(){function e(){this.activityID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.activityID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.activityID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Activity_SyncTotalGivePrize=He;var Ve=function(){function e(){this.errorcode=0,this.activityID=0,this.num=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<12||(this.errorcode=e.getInt32(),this.activityID=e.getInt32(),this.num=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setInt32(this.activityID),e.setInt32(this.num)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Activity_SyncTotalGivePrize=Ve;var Fe=function(){function e(){this.activityID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.activityID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.activityID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Activity_ReceiveTotalGivePrize=Fe;var Ue=function(){function e(){this.errorcode=0,this.activityID=0,this.rewards=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<12)return!1;this.errorcode=e.getInt32(),this.activityID=e.getInt32();var t=e.getUint32();this.rewards=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.rewards.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setInt32(this.activityID),e.setUint32(this.rewards.length),this.rewards.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Activity_ReceiveTotalGivePrize=Ue;var xe=function(){function e(){this.activityID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.activityID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.activityID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Activity_SyncLimitChallengeData=xe;var Ye=function(){function e(){this.errorcode=0,this.activityID=0,this.isJoin=!1,this.winNum=0,this.failNum=0,this.prize=new i.ObjMap,this.heroMap=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<21)return!1;this.errorcode=e.getInt32(),this.activityID=e.getInt32(),this.isJoin=e.getBool(),this.winNum=e.getInt32(),this.failNum=e.getInt32();var t=e.getUint32();if(e.getLen()-e.getPos()<5*t)return!1;this.prize.clear();for(var o=0;o<t;++o){var i,a;i=e.getInt32(),a=e.getBool(),this.prize.set(i,a)}if(e.getLen()-e.getPos()<4)return!1;var n=e.getUint32();this.heroMap.clear();for(var r=0;r<n;++r){var s;s=e.getInt32();var c=new T_HeroAbstract;if(!c.read(e))return!1;this.heroMap.set(s,c)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setInt32(this.activityID),e.setBool(this.isJoin),e.setInt32(this.winNum),e.setInt32(this.failNum),e.setUint32(this.prize.size),this.prize.forEach(function(t,o){e.setInt32(o),e.setBool(t)}),e.setUint32(this.heroMap.size),this.heroMap.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Activity_SyncLimitChallengeData=Ye;var je=function(){function e(){this.activityID=0,this.prizeIndex=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.activityID=e.getInt32(),this.prizeIndex=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.activityID),e.setInt32(this.prizeIndex)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Activity_ReceiveLimitChallengePrize=je;var We=function(){function e(){this.errorcode=0,this.activityID=0,this.rewards=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<12)return!1;this.errorcode=e.getInt32(),this.activityID=e.getInt32();var t=e.getUint32();this.rewards=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.rewards.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setInt32(this.activityID),e.setUint32(this.rewards.length),this.rewards.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Activity_ReceiveLimitChallengePrize=We;var ze=function(){function e(){this.activityID=0,this.num=0,this.isAD=!1}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<9||(this.activityID=e.getInt32(),this.num=e.getInt32(),this.isAD=e.getBool(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.activityID),e.setInt32(this.num),e.setBool(this.isAD)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Activity_ResetLimitChallengeFail=ze;var Ke=function(){function e(){this.errorcode=0,this.activityID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.errorcode=e.getInt32(),this.activityID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setInt32(this.activityID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Activity_ResetLimitChallengeFail=Ke;var qe=function(){function e(){this.activityID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.activityID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.activityID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Activity_ResetLimitChallengeWin=qe;var Qe=function(){function e(){this.errorcode=0,this.activityID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.errorcode=e.getInt32(),this.activityID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setInt32(this.activityID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Activity_ResetLimitChallengeWin=Qe;var Xe=function(){function e(){this.activityID=0,this.index=0,this.itemUUID=a.fromValue(0)}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<16||(this.activityID=e.getInt32(),this.index=e.getInt32(),this.itemUUID=e.getLong(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.activityID),e.setInt32(this.index),e.setLong(this.itemUUID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Activity_UpLimitChallengeHero=Xe;var Je=function(){function e(){this.errorcode=0,this.activityID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.errorcode=e.getInt32(),this.activityID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setInt32(this.activityID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Activity_UpLimitChallengeHero=Je;var Ze=function(){function e(){this.activityID=0,this.winNum=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.activityID=e.getInt32(),this.winNum=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.activityID),e.setInt32(this.winNum)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Activity_ReceiveGoldenLeagueWinNumPrize=Ze;var $e=function(){function e(){this.errorcode=0,this.activityID=0,this.winNum=0,this.rewards=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<16)return!1;this.errorcode=e.getInt32(),this.activityID=e.getInt32(),this.winNum=e.getInt32();var t=e.getUint32();this.rewards=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.rewards.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setInt32(this.activityID),e.setInt32(this.winNum),e.setUint32(this.rewards.length),this.rewards.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Activity_ReceiveGoldenLeagueWinNumPrize=$e;var et=function(){function e(){this.activityID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.activityID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.activityID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Activity_GetEatChickenData=et;var tt=function(){function e(){this.error=0,this.activityID=0,this.status=!1,this.count=0,this.remainingNum=0,this.assembleNum=0,this.isLive=!0,this.rank=0,this.normalPrize=new i.ObjMap,this.superprize=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<33)return!1;this.error=e.getInt32(),this.activityID=e.getInt32(),this.status=e.getInt32(),this.count=e.getInt32(),this.remainingNum=e.getInt32(),this.assembleNum=e.getInt32(),this.isLive=e.getBool(),this.rank=e.getInt32();var t=e.getUint32();if(e.getLen()-e.getPos()<5*t)return!1;this.normalPrize.clear();for(var o=0;o<t;++o){var i,a;i=e.getInt32(),a=e.getBool(),this.normalPrize.set(i,a)}if(e.getLen()-e.getPos()<4)return!1;var n=e.getUint32();if(e.getLen()-e.getPos()<5*n)return!1;this.superprize.clear();for(var r=0;r<n;++r){var s,c;s=e.getInt32(),c=e.getBool(),this.superprize.set(s,c)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.error),e.setInt32(this.activityID),e.setInt32(this.status),e.setInt32(this.count),e.setInt32(this.remainingNum),e.setInt32(this.assembleNum),e.setBool(this.isLive),e.setInt32(this.rank),e.setUint32(this.normalPrize.size),this.normalPrize.forEach(function(t,o){e.setInt32(o),e.setBool(t)}),e.setUint32(this.superprize.size),this.superprize.forEach(function(t,o){e.setInt32(o),e.setBool(t)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Activity_SyncEatChickenData=tt;var ot=function(){function e(){this.activityID=0,this.sociatyWarSroce=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.activityID=e.getInt32(),this.sociatyWarSroce=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.activityID),e.setInt32(this.sociatyWarSroce)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Activity_ReceiveSociatyWarWinNumPrize=ot;var it=function(){function e(){this.errorcode=0,this.activityID=0,this.sociatyWarSroce=0,this.rewards=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<16)return!1;this.errorcode=e.getInt32(),this.activityID=e.getInt32(),this.sociatyWarSroce=e.getInt32();var t=e.getUint32();this.rewards=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.rewards.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setInt32(this.activityID),e.setInt32(this.sociatyWarSroce),e.setUint32(this.rewards.length),this.rewards.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Activity_ReceiveSociatyWarWinNumPrize=it;var at=function(){function e(){this.activityID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.activityID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.activityID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Activity_GetSociatyWarData=at;var nt=function(){function e(){this.error=0,this.activityID=0,this.failCount=0,this.isOpen=!1,this.score=0,this.dayFailNum=0,this.dayMatchNum=0,this.continuousWinNum=0,this.continuousFailNum=0,this.winNum=0,this.reliveNum=0,this.maxContinuousWinNum=0,this.prizeReward=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<49)return!1;this.error=e.getInt32(),this.activityID=e.getInt32(),this.failCount=e.getInt32(),this.isOpen=e.getBool(),this.score=e.getInt32(),this.dayFailNum=e.getInt32(),this.dayMatchNum=e.getInt32(),this.continuousWinNum=e.getInt32(),this.continuousFailNum=e.getInt32(),this.winNum=e.getInt32(),this.reliveNum=e.getInt32(),this.maxContinuousWinNum=e.getInt32();var t=e.getUint32();if(e.getLen()-e.getPos()<5*t)return!1;this.prizeReward.clear();for(var o=0;o<t;++o){var i,a;i=e.getInt32(),a=e.getBool(),this.prizeReward.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.error),e.setInt32(this.activityID),e.setInt32(this.failCount),e.setBool(this.isOpen),e.setInt32(this.score),e.setInt32(this.dayFailNum),e.setInt32(this.dayMatchNum),e.setInt32(this.continuousWinNum),e.setInt32(this.continuousFailNum),e.setInt32(this.winNum),e.setInt32(this.reliveNum),e.setInt32(this.maxContinuousWinNum),e.setUint32(this.prizeReward.size),this.prizeReward.forEach(function(t,o){e.setInt32(o),e.setBool(t)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Activity_SyncSociatyWarData=nt;var rt=function(){function e(){this.reliveNum=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.reliveNum=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.reliveNum)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Activity_SociatyWarRelive=rt;var st=function(){function e(){this.errorcode=-1,this.reliveNum=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.errorcode=e.getInt32(),this.reliveNum=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setInt32(this.reliveNum)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Activity_SociatyWarRelive=st;var ct=function(){function e(){this.activityID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.activityID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.activityID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Activity_GetGreatSailingData=ct;var lt=function(){function e(){this.error=0,this.activityID=0,this.failCount=0,this.isOpen=!1,this.historyMaxScore=0,this.todayScore=0,this.dayFailNum=0,this.dayMatchNum=0,this.continuousWinNum=0,this.continuousFailNum=0,this.winNum=0,this.reliveNum=0,this.maxContinuousWinNum=0,this.cardId=0,this.prizeReward=new i.ObjMap,this.refleshCardNum=0}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<57)return!1;this.error=e.getInt32(),this.activityID=e.getInt32(),this.failCount=e.getInt32(),this.isOpen=e.getBool(),this.historyMaxScore=e.getInt32(),this.todayScore=e.getInt32(),this.dayFailNum=e.getInt32(),this.dayMatchNum=e.getInt32(),this.continuousWinNum=e.getInt32(),this.continuousFailNum=e.getInt32(),this.winNum=e.getInt32(),this.reliveNum=e.getInt32(),this.maxContinuousWinNum=e.getInt32(),this.cardId=e.getInt32();var t=e.getUint32();if(e.getLen()-e.getPos()<5*t)return!1;this.prizeReward.clear();for(var o=0;o<t;++o){var i,a;i=e.getInt32(),a=e.getBool(),this.prizeReward.set(i,a)}return!(e.getLen()-e.getPos()<4||(this.refleshCardNum=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.error),e.setInt32(this.activityID),e.setInt32(this.failCount),e.setBool(this.isOpen),e.setInt32(this.historyMaxScore),e.setInt32(this.todayScore),e.setInt32(this.dayFailNum),e.setInt32(this.dayMatchNum),e.setInt32(this.continuousWinNum),e.setInt32(this.continuousFailNum),e.setInt32(this.winNum),e.setInt32(this.reliveNum),e.setInt32(this.maxContinuousWinNum),e.setInt32(this.cardId),e.setUint32(this.prizeReward.size),this.prizeReward.forEach(function(t,o){e.setInt32(o),e.setBool(t)}),e.setInt32(this.refleshCardNum)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Activity_SyncGreatSailingData=lt;var dt=function(){function e(){this.reliveNum=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.reliveNum=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.reliveNum)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Activity_GreatSailingRelive=dt;var ut=function(){function e(){this.errorcode=-1,this.reliveNum=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.errorcode=e.getInt32(),this.reliveNum=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setInt32(this.reliveNum)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Activity_GreatSailingRelive=ut;var ht=function(){function e(){this.refleshCardNum=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.refleshCardNum=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.refleshCardNum)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Activity_GreatSailingRefleshCard=ht;var pt=function(){function e(){this.activityID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.activityID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.activityID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Activity_GetSkyCastleData=pt;var ft=function(){function e(){this.error=0,this.activityID=0,this.isOpen=!0,this.castleSkyType=0,this.failcount=0,this.score=0,this.dayFailNum=0,this.dayMatchNum=0,this.continuousWinNum=0,this.continuousFailNum=0,this.winNum=0,this.reliveNum=0,this.maxContinuousWinNum=0,this.refleshRobotId=0,this.prize=new i.ObjMap,this.normalPrize=new i.ObjMap,this.superprize=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<57)return!1;this.error=e.getInt32(),this.activityID=e.getInt32(),this.isOpen=e.getBool(),this.castleSkyType=e.getInt32(),this.failcount=e.getInt32(),this.score=e.getInt32(),this.dayFailNum=e.getInt32(),this.dayMatchNum=e.getInt32(),this.continuousWinNum=e.getInt32(),this.continuousFailNum=e.getInt32(),this.winNum=e.getInt32(),this.reliveNum=e.getInt32(),this.maxContinuousWinNum=e.getInt32(),this.refleshRobotId=e.getInt32();var t=e.getUint32();if(e.getLen()-e.getPos()<5*t)return!1;this.prize.clear();for(var o=0;o<t;++o){var i,a;i=e.getInt32(),a=e.getBool(),this.prize.set(i,a)}if(e.getLen()-e.getPos()<4)return!1;var n=e.getUint32();if(e.getLen()-e.getPos()<5*n)return!1;this.normalPrize.clear();for(var r=0;r<n;++r){var s,c;s=e.getInt32(),c=e.getBool(),this.normalPrize.set(s,c)}if(e.getLen()-e.getPos()<4)return!1;var l=e.getUint32();if(e.getLen()-e.getPos()<5*l)return!1;this.superprize.clear();for(var d=0;d<l;++d){var u,h;u=e.getInt32(),h=e.getBool(),this.superprize.set(u,h)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.error),e.setInt32(this.activityID),e.setBool(this.isOpen),e.setInt32(this.castleSkyType),e.setInt32(this.failcount),e.setInt32(this.score),e.setInt32(this.dayFailNum),e.setInt32(this.dayMatchNum),e.setInt32(this.continuousWinNum),e.setInt32(this.continuousFailNum),e.setInt32(this.winNum),e.setInt32(this.reliveNum),e.setInt32(this.maxContinuousWinNum),e.setInt32(this.refleshRobotId),e.setUint32(this.prize.size),this.prize.forEach(function(t,o){e.setInt32(o),e.setBool(t)}),e.setUint32(this.normalPrize.size),this.normalPrize.forEach(function(t,o){e.setInt32(o),e.setBool(t)}),e.setUint32(this.superprize.size),this.superprize.forEach(function(t,o){e.setInt32(o),e.setBool(t)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Activity_SyncSkyCastleData=ft;var gt=function(){function e(){this.activityID=0,this.castleSkyType=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.activityID=e.getInt32(),this.castleSkyType=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.activityID),e.setInt32(this.castleSkyType)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Activity_ReceiveSkyCastlePrize=gt;var mt=function(){function e(){this.error=0,this.activityID=0,this.castleSkyType=0,this.rewards=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<16)return!1;this.error=e.getInt32(),this.activityID=e.getInt32(),this.castleSkyType=e.getInt32();var t=e.getUint32();this.rewards=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.rewards.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.error),e.setInt32(this.activityID),e.setInt32(this.castleSkyType),e.setUint32(this.rewards.length),this.rewards.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Activity_ReceiveSkyCastlePrize=mt;var _t=function(){function e(){this.index=0,this.type=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.index=e.getInt32(),this.type=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.index),e.setInt32(this.type)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Activity_CastleSkyGetBoxsData=_t;var yt=function(){function e(){this.getRewardsVec=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();if(e.getLen()-e.getPos()<8*t)return!1;this.getRewardsVec=[];for(var o=0;o<t;++o){var i=new _t;if(!i.read(e))return!1;this.getRewardsVec.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setUint32(this.getRewardsVec.length),this.getRewardsVec.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Activity_CastleSkyGetBoxsReward=yt;var vt=function(){function e(){this.errorcode=-1,this.rewards=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.errorcode=e.getInt32();var t=e.getUint32();this.rewards=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.rewards.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setUint32(this.rewards.length),this.rewards.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Activity_CastleSkyGetBoxsReward=vt;var Ct=function(){function e(){this.error=0,this.activityID=0,this.isOpen=!0,this.failcount=0,this.score=0,this.historyMaxScore=0,this.dayFailNum=0,this.dayMatchNum=0,this.continuousWinNum=0,this.continuousFailNum=0,this.winNum=0,this.reliveNum=0,this.maxContinuousWinNum=0,this.refleshRobotId=0,this.prize=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<57)return!1;this.error=e.getInt32(),this.activityID=e.getInt32(),this.isOpen=e.getBool(),this.failcount=e.getInt32(),this.score=e.getInt32(),this.historyMaxScore=e.getInt32(),this.dayFailNum=e.getInt32(),this.dayMatchNum=e.getInt32(),this.continuousWinNum=e.getInt32(),this.continuousFailNum=e.getInt32(),this.winNum=e.getInt32(),this.reliveNum=e.getInt32(),this.maxContinuousWinNum=e.getInt32(),this.refleshRobotId=e.getInt32();var t=e.getUint32();if(e.getLen()-e.getPos()<5*t)return!1;this.prize.clear();for(var o=0;o<t;++o){var i,a;i=e.getInt32(),a=e.getBool(),this.prize.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.error),e.setInt32(this.activityID),e.setBool(this.isOpen),e.setInt32(this.failcount),e.setInt32(this.score),e.setInt32(this.historyMaxScore),e.setInt32(this.dayFailNum),e.setInt32(this.dayMatchNum),e.setInt32(this.continuousWinNum),e.setInt32(this.continuousFailNum),e.setInt32(this.winNum),e.setInt32(this.reliveNum),e.setInt32(this.maxContinuousWinNum),e.setInt32(this.refleshRobotId),e.setUint32(this.prize.size),this.prize.forEach(function(t,o){e.setInt32(o),e.setBool(t)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Activity_SyncWeekCooperationData=Ct;var St=function(){function e(){this.reliveNum=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.reliveNum=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.reliveNum)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Activity_WeekCooperationRelive=St;var Tt=function(){function e(){this.errorcode=-1,this.reliveNum=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.errorcode=e.getInt32(),this.reliveNum=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setInt32(this.reliveNum)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Activity_WeekCooperationRelive=Tt;var It=function(){function e(){this.index=0,this.type=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.index=e.getInt32(),this.type=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.index),e.setInt32(this.type)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Activity_RoyaleGetBoxsReward=It;var Nt=function(){function e(){this.getRewardsVec=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();if(e.getLen()-e.getPos()<8*t)return!1;this.getRewardsVec=[];for(var o=0;o<t;++o){var i=new It;if(!i.read(e))return!1;this.getRewardsVec.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setUint32(this.getRewardsVec.length),this.getRewardsVec.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Activity_RoyaleGetBoxsReward=Nt;var bt=function(){function e(){this.errorcode=-1,this.rewards=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.errorcode=e.getInt32();var t=e.getUint32();this.rewards=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.rewards.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setUint32(this.rewards.length),this.rewards.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Activity_RoyaleGetBoxsReward=bt;var wt=function(){function e(){this.error=0,this.activityID=0,this.isOpen=!0,this.failcount=0,this.score=0,this.dayFailNum=0,this.dayMatchNum=0,this.continuousWinNum=0,this.continuousFailNum=0,this.winNum=0,this.reliveNum=0,this.maxContinuousWinNum=0,this.refleshRobotId=0,this.prize=new i.ObjMap,this.normalPrize=new i.ObjMap,this.superprize=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<53)return!1;this.error=e.getInt32(),this.activityID=e.getInt32(),this.isOpen=e.getBool(),this.failcount=e.getInt32(),this.score=e.getInt32(),this.dayFailNum=e.getInt32(),this.dayMatchNum=e.getInt32(),this.continuousWinNum=e.getInt32(),this.continuousFailNum=e.getInt32(),this.winNum=e.getInt32(),this.reliveNum=e.getInt32(),this.maxContinuousWinNum=e.getInt32(),this.refleshRobotId=e.getInt32();var t=e.getUint32();if(e.getLen()-e.getPos()<5*t)return!1;this.prize.clear();for(var o=0;o<t;++o){var i,a;i=e.getInt32(),a=e.getBool(),this.prize.set(i,a)}if(e.getLen()-e.getPos()<4)return!1;var n=e.getUint32();if(e.getLen()-e.getPos()<5*n)return!1;this.normalPrize.clear();for(var r=0;r<n;++r){var s,c;s=e.getInt32(),c=e.getBool(),this.normalPrize.set(s,c)}if(e.getLen()-e.getPos()<4)return!1;var l=e.getUint32();if(e.getLen()-e.getPos()<5*l)return!1;this.superprize.clear();for(var d=0;d<l;++d){var u,h;u=e.getInt32(),h=e.getBool(),this.superprize.set(u,h)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.error),e.setInt32(this.activityID),e.setBool(this.isOpen),e.setInt32(this.failcount),e.setInt32(this.score),e.setInt32(this.dayFailNum),e.setInt32(this.dayMatchNum),e.setInt32(this.continuousWinNum),e.setInt32(this.continuousFailNum),e.setInt32(this.winNum),e.setInt32(this.reliveNum),e.setInt32(this.maxContinuousWinNum),e.setInt32(this.refleshRobotId),e.setUint32(this.prize.size),this.prize.forEach(function(t,o){e.setInt32(o),e.setBool(t)}),e.setUint32(this.normalPrize.size),this.normalPrize.forEach(function(t,o){e.setInt32(o),e.setBool(t)}),e.setUint32(this.superprize.size),this.superprize.forEach(function(t,o){e.setInt32(o),e.setBool(t)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Activity_SyncAnniversaryTrialData=wt;var Et=function(){function e(){this.index=0,this.type=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.index=e.getInt32(),this.type=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.index),e.setInt32(this.type)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Activity_AnniversaryTrialGetBoxsData=Et;var Pt=function(){function e(){this.getRewardsVec=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();if(e.getLen()-e.getPos()<8*t)return!1;this.getRewardsVec=[];for(var o=0;o<t;++o){var i=new Et;if(!i.read(e))return!1;this.getRewardsVec.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setUint32(this.getRewardsVec.length),this.getRewardsVec.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Activity_AnniversaryTrialGetBoxsReward=Pt;var Rt=function(){function e(){this.errorcode=-1,this.rewards=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.errorcode=e.getInt32();var t=e.getUint32();this.rewards=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.rewards.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setUint32(this.rewards.length),this.rewards.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Activity_AnniversaryTrialGetBoxsReward=Rt;var Lt=function(){function e(){this.error=0,this.activityID=0,this.isOpen=!0,this.isCheck=!1,this.isReturnBackRole=!1,this.isHelp=!1,this.rechargeNum=0,this.newServerGroupId=0,this.extendMap=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<24)return!1;this.error=e.getInt32(),this.activityID=e.getInt32(),this.isOpen=e.getBool(),this.isCheck=e.getBool(),this.isReturnBackRole=e.getBool(),this.isHelp=e.getBool(),this.rechargeNum=e.getInt32(),this.newServerGroupId=e.getInt32();var t=e.getUint32();if(e.getLen()-e.getPos()<8*t)return!1;this.extendMap.clear();for(var o=0;o<t;++o){var i,a;i=e.getInt32(),a=e.getInt32(),this.extendMap.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.error),e.setInt32(this.activityID),e.setBool(this.isOpen),e.setBool(this.isCheck),e.setBool(this.isReturnBackRole),e.setBool(this.isHelp),e.setInt32(this.rechargeNum),e.setInt32(this.newServerGroupId),e.setUint32(this.extendMap.size),this.extendMap.forEach(function(t,o){e.setInt32(o),e.setInt32(t)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Activity_SyncReturnBackData=Lt;var At=function(){function e(){this.newServerGroupId=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.newServerGroupId=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.newServerGroupId)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Activity_ReturnBackHelpNew=At;var Dt=function(){function e(){this.errorcode=-1,this.rewards=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.errorcode=e.getInt32();var t=e.getUint32();this.rewards=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.rewards.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setUint32(this.rewards.length),this.rewards.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Activity_ReturnBackHelpNew=Dt;var Mt=function(){function e(){this.error=0,this.activityID=0,this.isOpen=!0,this.failcount=0,this.score=0,this.dayFailNum=0,this.dayMatchNum=0,this.continuousWinNum=0,this.continuousFailNum=0,this.winNum=0,this.reliveNum=0,this.maxContinuousWinNum=0,this.refleshId=0,this.prize=new i.ObjMap,this.normalPrize=new i.ObjMap,this.superprize=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<53)return!1;this.error=e.getInt32(),this.activityID=e.getInt32(),this.isOpen=e.getBool(),this.failcount=e.getInt32(),this.score=e.getInt32(),this.dayFailNum=e.getInt32(),this.dayMatchNum=e.getInt32(),this.continuousWinNum=e.getInt32(),this.continuousFailNum=e.getInt32(),this.winNum=e.getInt32(),this.reliveNum=e.getInt32(),this.maxContinuousWinNum=e.getInt32(),this.refleshId=e.getInt32();var t=e.getUint32();if(e.getLen()-e.getPos()<5*t)return!1;this.prize.clear();for(var o=0;o<t;++o){var i,a;i=e.getInt32(),a=e.getBool(),this.prize.set(i,a)}if(e.getLen()-e.getPos()<4)return!1;var n=e.getUint32();if(e.getLen()-e.getPos()<5*n)return!1;this.normalPrize.clear();for(var r=0;r<n;++r){var s,c;s=e.getInt32(),c=e.getBool(),this.normalPrize.set(s,c)}if(e.getLen()-e.getPos()<4)return!1;var l=e.getUint32();if(e.getLen()-e.getPos()<5*l)return!1;this.superprize.clear();for(var d=0;d<l;++d){var u,h;u=e.getInt32(),h=e.getBool(),this.superprize.set(u,h)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.error),e.setInt32(this.activityID),e.setBool(this.isOpen),e.setInt32(this.failcount),e.setInt32(this.score),e.setInt32(this.dayFailNum),e.setInt32(this.dayMatchNum),e.setInt32(this.continuousWinNum),e.setInt32(this.continuousFailNum),e.setInt32(this.winNum),e.setInt32(this.reliveNum),e.setInt32(this.maxContinuousWinNum),e.setInt32(this.refleshId),e.setUint32(this.prize.size),this.prize.forEach(function(t,o){e.setInt32(o),e.setBool(t)}),e.setUint32(this.normalPrize.size),this.normalPrize.forEach(function(t,o){e.setInt32(o),e.setBool(t)}),e.setUint32(this.superprize.size),this.superprize.forEach(function(t,o){e.setInt32(o),e.setBool(t)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Activity_SyncFogHiddenData=Mt;var Bt=function(){function e(){this.index=0,this.type=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.index=e.getInt32(),this.type=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.index),e.setInt32(this.type)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Activity_FogHiddenGetBoxsData=Bt;var kt=function(){function e(){this.getRewardsVec=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();if(e.getLen()-e.getPos()<8*t)return!1;this.getRewardsVec=[];for(var o=0;o<t;++o){var i=new Bt;if(!i.read(e))return!1;this.getRewardsVec.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setUint32(this.getRewardsVec.length),this.getRewardsVec.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Activity_FogHiddenGetBoxsReward=kt;var Gt=function(){function e(){this.errorcode=-1,this.rewards=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.errorcode=e.getInt32();var t=e.getUint32();this.rewards=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.rewards.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setUint32(this.rewards.length),this.rewards.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Activity_FogHiddenGetBoxsReward=Gt;var Ot=function(){function e(){this.error=0,this.activityID=0,this.isOpen=!0,this.failcount=0,this.score=0,this.dayFailNum=0,this.dayMatchNum=0,this.continuousWinNum=0,this.continuousFailNum=0,this.winNum=0,this.reliveNum=0,this.maxContinuousWinNum=0,this.refleshId=0,this.dayMaxRound=0,this.prize=new i.ObjMap,this.normalPrize=new i.ObjMap,this.superprize=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<57)return!1;this.error=e.getInt32(),this.activityID=e.getInt32(),this.isOpen=e.getBool(),this.failcount=e.getInt32(),this.score=e.getInt32(),this.dayFailNum=e.getInt32(),this.dayMatchNum=e.getInt32(),this.continuousWinNum=e.getInt32(),this.continuousFailNum=e.getInt32(),this.winNum=e.getInt32(),this.reliveNum=e.getInt32(),this.maxContinuousWinNum=e.getInt32(),this.refleshId=e.getInt32(),this.dayMaxRound=e.getInt32();var t=e.getUint32();if(e.getLen()-e.getPos()<5*t)return!1;this.prize.clear();for(var o=0;o<t;++o){var i,a;i=e.getInt32(),a=e.getBool(),this.prize.set(i,a)}if(e.getLen()-e.getPos()<4)return!1;var n=e.getUint32();if(e.getLen()-e.getPos()<5*n)return!1;this.normalPrize.clear();for(var r=0;r<n;++r){var s,c;s=e.getInt32(),c=e.getBool(),this.normalPrize.set(s,c)}if(e.getLen()-e.getPos()<4)return!1;var l=e.getUint32();if(e.getLen()-e.getPos()<5*l)return!1;this.superprize.clear();for(var d=0;d<l;++d){var u,h;u=e.getInt32(),h=e.getBool(),this.superprize.set(u,h)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.error),e.setInt32(this.activityID),e.setBool(this.isOpen),e.setInt32(this.failcount),e.setInt32(this.score),e.setInt32(this.dayFailNum),e.setInt32(this.dayMatchNum),e.setInt32(this.continuousWinNum),e.setInt32(this.continuousFailNum),e.setInt32(this.winNum),e.setInt32(this.reliveNum),e.setInt32(this.maxContinuousWinNum),e.setInt32(this.refleshId),e.setInt32(this.dayMaxRound),e.setUint32(this.prize.size),this.prize.forEach(function(t,o){e.setInt32(o),e.setBool(t)}),e.setUint32(this.normalPrize.size),this.normalPrize.forEach(function(t,o){e.setInt32(o),e.setBool(t)}),e.setUint32(this.superprize.size),this.superprize.forEach(function(t,o){e.setInt32(o),e.setBool(t)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Activity_SyncMachinariumData=Ot;var Ht=function(){function e(){this.index=0,this.type=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.index=e.getInt32(),this.type=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.index),e.setInt32(this.type)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Activity_MachinariumGetBattlePassRewardData=Ht;var Vt=function(){function e(){this.getRewardsVec=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();if(e.getLen()-e.getPos()<8*t)return!1;this.getRewardsVec=[];for(var o=0;o<t;++o){var i=new Ht;if(!i.read(e))return!1;this.getRewardsVec.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setUint32(this.getRewardsVec.length),this.getRewardsVec.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Activity_MachinariumGetBattlePassReward=Vt;var Ft=function(){function e(){this.errorcode=-1,this.rewards=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.errorcode=e.getInt32();var t=e.getUint32();this.rewards=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.rewards.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setUint32(this.rewards.length),this.rewards.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Activity_MachinariumGetBattlePassReward=Ft,cc._RF.pop()},{"./BaseProtocols":"BaseProtocols",DataViewRW:"DataViewRW",ObjCollection:"ObjCollection",long:"long"}],ActivityTableData:[function(e,t,o){"use strict";cc._RF.push(t,"d2e50KZkqhB1oclxuLOE2cP","ActivityTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.ActivityTableData=void 0;var i=e("../TableReader"),a=e("./BaseTableData"),n=function(){function e(){this.id=0,this.group=0,this.type=0,this.clearItem=new Array,this.condCreateTimeBegin=0,this.condCreateTimeEnd=0,this.condCreateDayBegin=0,this.condCreateDayEnd=0,this.condMaxScore=0,this.condOwnedItem=new Array,this.condNotOwnedItem=new Array,this.condSDKBaseMessage=new Array,this.excLuckDrawCost=new Array,this.excLuckDrawRegisterDay=0,this.excLuckDrawNeed=new Array,this.excLuckDrawAppointNum=0,this.excLuckDrawPrizeID=0,this.excLuckDrawAppointPrizeID=0,this.excLuckDrawAdditionalPrizeID=0,this.excLuckDrawAdditionalDayNum=0,this.randomArenaFirstCost=new Array,this.randomArenaSecondCost=new Array,this.param1=0,this.param2=0,this.param3=0,this.param4=0,this.param5=0,this.param6=0,this.param7=0,this.param8=0,this.param9=0,this.paramVec1=new Array,this.finishPrize=new Array,this.clearTaskID=new Array,this.banpick=0,this.battleArrayGroup=0,this.activityTypeClient=0,this.activityDeadline=0,this.activityText="",this.order=0,this.name="",this.extranceUrl=""}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.group=e.getNumber(),this.type=e.getNumber();for(var o=e.getString(),n=new i.TableReader(o);n.getPos()<n.getLen();){var r=void 0;r=n.getNumber(),this.clearItem.push(r)}this.condCreateTimeBegin=e.getNumber(),this.condCreateTimeEnd=e.getNumber(),this.condCreateDayBegin=e.getNumber(),this.condCreateDayEnd=e.getNumber(),this.condMaxScore=e.getNumber(),o=e.getString();for(var s=new i.TableReader(o);s.getPos()<s.getLen();)(r=new a.DropItem).readOriginal(s),this.condOwnedItem.push(r);o=e.getString();for(var c=new i.TableReader(o);c.getPos()<c.getLen();)(r=new a.DropItem).readOriginal(c),this.condNotOwnedItem.push(r);o=e.getString();for(var l=new i.TableReader(o);l.getPos()<l.getLen();)(r=new a.SDKBaseData).readOriginal(l),this.condSDKBaseMessage.push(r);o=e.getString();for(var d=new i.TableReader(o);d.getPos()<d.getLen();)(r=new a.DropItem).readOriginal(d),this.excLuckDrawCost.push(r);this.excLuckDrawRegisterDay=e.getNumber(),o=e.getString();for(var u=new i.TableReader(o);u.getPos()<u.getLen();)(r=new a.DropItem).readOriginal(u),this.excLuckDrawNeed.push(r);this.excLuckDrawAppointNum=e.getNumber(),this.excLuckDrawPrizeID=e.getNumber(),this.excLuckDrawAppointPrizeID=e.getNumber(),this.excLuckDrawAdditionalPrizeID=e.getNumber(),this.excLuckDrawAdditionalDayNum=e.getNumber(),o=e.getString();for(var h=new i.TableReader(o);h.getPos()<h.getLen();)(r=new a.DropItem).readOriginal(h),this.randomArenaFirstCost.push(r);o=e.getString();for(var p=new i.TableReader(o);p.getPos()<p.getLen();)(r=new a.DropItem).readOriginal(p),this.randomArenaSecondCost.push(r);this.param1=e.getNumber(),this.param2=e.getNumber(),this.param3=e.getNumber(),this.param4=e.getNumber(),this.param5=e.getNumber(),this.param6=e.getNumber(),this.param7=e.getNumber(),this.param8=e.getNumber(),this.param9=e.getNumber(),o=e.getString();for(var f=new i.TableReader(o);f.getPos()<f.getLen();)r=void 0,r=f.getNumber(),this.paramVec1.push(r);o=e.getString();for(var g=new i.TableReader(o);g.getPos()<g.getLen();)(r=new a.DropItem).readOriginal(g),this.finishPrize.push(r);o=e.getString();for(var m=new i.TableReader(o);m.getPos()<m.getLen();)r=void 0,r=m.getNumber(),this.clearTaskID.push(r);this.banpick=e.getNumber(),this.battleArrayGroup=e.getNumber(),this.activityTypeClient=e.getNumber(),this.activityDeadline=e.getNumber(),this.activityText=e.getString(),this.order=e.getNumber(),this.name=e.getString(),this.extranceUrl=e.getString()},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"ActivityTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.ActivityTableData=n,cc._RF.pop()},{"../TableReader":"TableReader","./BaseTableData":"BaseTableData"}],AdJumpTipView:[function(e,t,o){"use strict";cc._RF.push(t,"67c99PZSclP3p8Lm5c2uHYI","AdJumpTipView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=e("../../utils/RewardedVideoAd"),l=cc._decorator,d=l.ccclass,u=l.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.label=null,t.adCardItemId=1010,t.initData=null,t}return a(t,e),t.path=function(){return"ui/advertising_gifts/prefab/AdJumpTip"},t.prototype.onLoad=function(){this.btn_confirm=this.node.getChildByName("btnconfirm")},t.prototype.start=function(){var e=c.default.getAdCardNum();this.label.string=e.toString()},t.prototype.init=function(e){this.initData=e.data,this.m_cb=e.callBack},t.prototype.onClickSure=function(){this.btn_confirm&&(this.btn_confirm.getComponent(cc.Button).interactable=!1),this.m_cb&&this.m_cb(),this.closeView()},t.prototype.costAdCard=function(){},t.prototype.onClickCancel=function(){c.default.createVideo2(this.initData),this.closeView()},n([u(cc.Label)],t.prototype,"label",void 0),n([s.Register_Class,d],t)}(r.default);o.default=h,cc._RF.pop()},{"../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../utils/RewardedVideoAd":"RewardedVideoAd"}],AdapterComponent:[function(e,t,o){"use strict";cc._RF.push(t,"1ba0btnB3pIBLJN+jjj75oO","AdapterComponent");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,s=(r.property,r.ccclass),c=r.executionOrder,l=r.requireComponent,d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.onLoad=function(){this._adapter()},t.prototype._adapter=function(){var e=cc.view.getVisibleSize(),t=cc.view.getDesignResolutionSize(),o=cc.find("Canvas").getComponent(cc.Canvas),i=e.width/e.height,a=t.width/t.height;a>i?(o.fitWidth=!0,o.fitHeight=!1):a<=i&&(o.fitHeight=!0,o.fitWidth=!1)},n([s,c(-100),l(cc.Canvas)],t)}(cc.Component);o.default=d,cc._RF.pop()},{}],AddCoopCountAdvertiseByQQ:[function(e,t,o){"use strict";cc._RF.push(t,"0fdc902CqZEKLnbQsZFcS8X","AddCoopCountAdvertiseByQQ");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../modules/base/BaseView"),s=e("../modules/base/Decorators"),c=e("../network/ClientNetwork"),l=e("../modules/base/GameView"),d=e("../Global/GameGlobal"),u=e("../utils/RewardedVideoUnitIdConst"),h=e("../network/protocol/RoleProtocols"),p=e("../common/NetworkProtocolCommon"),f=e("../StaticData/CostGetTableData"),g=e("../common/PlayerModule"),m=cc._decorator,_=m.ccclass,y=(m.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.path=function(){return"ui/CommonPrefab/qqGameAdvertise"},t.prototype.start=function(){var e=this;c.ClientNetwork.getInstance().listenProtocol(h.ROLE_CLIENT_ENUM.P_Role_Add_Fight_Cooperation_Num,function(t){t.resetPos();var o=new h.S_Role_Add_Fight_Cooperation_Num;if(o.read(t))if(0===o.errorcode){p.default.callRoleCostGet(1004),e.closeView();var i=l.default.getViewByName("MainSceneView");i&&i.view&&(i.view.onRefreshCoopTimes(),i.view.onClientTaskAddAdvert(u.RewardedVideoClientIdConst.Coop_Add_Count))}else d.G.StringManager.PopString("S_Role_Add_Fight_Cooperation_Num Error "+o.errorcode)},this)},t.prototype.onLookVideoCallBack=function(){var e=f.CostGetTableData.getById(1004).cost[0].itemNum;if(g.default.getGoldNum()>=Number(e)){var t=new h.C_Role_Add_Fight_Cooperation_Num;c.ClientNetwork.getInstance().Send(h.ROLE_CLIENT_ENUM.P_Role_Add_Fight_Cooperation_Num,t)}else d.G.StringManager.PopString("\u91d1\u5e01\u4e0d\u8db3\uff01")},t.prototype.onDestroy=function(){c.ClientNetwork.getInstance().removeMessageTarget(this)},n([s.Register_Class,_],t)}(r.default));o.default=y,cc._RF.pop()},{"../Global/GameGlobal":"GameGlobal","../StaticData/CostGetTableData":"CostGetTableData","../common/NetworkProtocolCommon":"NetworkProtocolCommon","../common/PlayerModule":"PlayerModule","../modules/base/BaseView":"BaseView","../modules/base/Decorators":"Decorators","../modules/base/GameView":"GameView","../network/ClientNetwork":"ClientNetwork","../network/protocol/RoleProtocols":"RoleProtocols","../utils/RewardedVideoUnitIdConst":"RewardedVideoUnitIdConst"}],AddCoopCountAdvertise:[function(e,t,o){"use strict";cc._RF.push(t,"5b912ZTe05Kz4B98PxEPQwU","AddCoopCountAdvertise");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../modules/base/BaseView"),s=e("../modules/base/Decorators"),c=e("../network/ClientNetwork"),l=e("../modules/base/GameView"),d=e("../utils/RewardedVideoUnitIdConst"),u=e("../utils/RewardedVideoAd"),h=e("../network/protocol/RoleProtocols"),p=e("../utils/GameUtils"),f=e("../utils/GamePlatform"),g=e("../utils/ByteDanceMiniGameUtils"),m=e("../Global/GameGlobal"),_=cc._decorator,y=_.ccclass,v=_.property,C=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.countLab=null,t}return a(t,e),t.path=function(){return"ui/CommonPrefab/Advertise"},t.prototype.start=function(){var e=this;c.ClientNetwork.getInstance().listenProtocol(h.ROLE_CLIENT_ENUM.P_Role_Add_Fight_Cooperation_Num,function(t){t.resetPos();var o=new h.S_Role_Add_Fight_Cooperation_Num;if(o.read(t))if(0===o.errorcode){e.closeView();var i=l.default.getViewByName("MainSceneView");i&&i.view&&(i.view.onRefreshCoopTimes(),i.view.onClientTaskAddAdvert(d.RewardedVideoClientIdConst.Coop_Add_Count))}else m.G.StringManager.PopString("S_Role_Add_Fight_Cooperation_Num Error "+o.errorcode)},this),this.countLab.string=p.getConfigIntValue("match_cooperation_day_add_num"),this.changeAdButtonSkins()},t.prototype.onLookVideoCallBack=function(){u.default.createVideo({name:"coop_add_count",adUnitId:d.RewardedVideoUnitIdConst.CoopAddCount,advertID:d.RewardedVideoClientIdConst.Coop_Add_Count,finishCb:function(){var e=new h.C_Role_Add_Fight_Cooperation_Num;c.ClientNetwork.getInstance().Send(h.ROLE_CLIENT_ENUM.P_Role_Add_Fight_Cooperation_Num,e)}})},t.prototype.changeAdButtonSkins=function(){f.GamePlatform.isByteDanceMiniGame()&&g.default.getInstance().changeSkinOfAdButton(this.node.getChildByName("tongzhi").getChildByName("go"),"advertise")},t.prototype.onDestroy=function(){c.ClientNetwork.getInstance().removeMessageTarget(this)},n([v(cc.Label)],t.prototype,"countLab",void 0),n([s.Register_Class,y],t)}(r.default);o.default=C,cc._RF.pop()},{"../Global/GameGlobal":"GameGlobal","../modules/base/BaseView":"BaseView","../modules/base/Decorators":"Decorators","../modules/base/GameView":"GameView","../network/ClientNetwork":"ClientNetwork","../network/protocol/RoleProtocols":"RoleProtocols","../utils/ByteDanceMiniGameUtils":"ByteDanceMiniGameUtils","../utils/GamePlatform":"GamePlatform","../utils/GameUtils":"GameUtils","../utils/RewardedVideoAd":"RewardedVideoAd","../utils/RewardedVideoUnitIdConst":"RewardedVideoUnitIdConst"}],AdvertisingBoxPreview:[function(e,t,o){"use strict";cc._RF.push(t,"8f3d310R/NPt7+kpnD11Aij","AdvertisingBoxPreview");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=cc._decorator,l=c.ccclass,d=c.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.m_arrLabel=[],t}return a(t,e),t.path=function(){return"ui/advertising_gifts/prefab/AdvertisingBox"},t.prototype.init=function(e){var t=this;e.strScop&&e.strScop.forEach(function(e,o){t.m_arrLabel[o].string="x"+e})},n([d(cc.Label)],t.prototype,"m_arrLabel",void 0),n([s.Register_Class,l],t)}(r.default);o.default=u,cc._RF.pop()},{"../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators"}],AdvertisingGiftsGuangGaoView:[function(e,t,o){"use strict";cc._RF.push(t,"1c082Fx1HlKE65Q5RCnfrzw","AdvertisingGiftsGuangGaoView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../common/PlayerModule"),s=e("../../Global/GameGlobal"),c=e("../../modules/base/GameView"),l=e("../../network/ClientNetwork"),d=e("../../network/LocalMessage"),u=e("../../network/protocol/RoleProtocols"),h=e("../../network/protocol/TypeProtocols"),p=e("../../StaticData/TaskTableData"),f=e("../../utils/ConfigUtils"),g=e("../../utils/GameTools"),m=e("../../utils/GameUtils"),_=e("../../utils/ResourcesManager"),y=function(){this.id=0,this.state=0,this.count=0},v=cc._decorator,C=v.ccclass,S=v.property,T=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.bg=null,t.bar=null,t.funcBtnLabel=null,t.funcBtn=null,t.process=null,t.prePageBtn=null,t.nextPageBtn=null,t.heroNode=null,t.heroName=null,t.heroSpine=null,t.heroProSprite=null,t.heroProfIcon=null,t.heroProf=null,t.heroDesc=null,t.heroTeDian1=null,t.heroTeDian2=null,t.itemNode=null,t.itemIcon=null,t.itemName=null,t.itemDesc=null,t.allTasks=new Array,t.curIndex=0,t}var o;return a(t,e),o=t,t.prototype.onLoad=function(){},t.prototype.init=function(){l.ClientNetwork.getInstance().listenLocalMessage(d.LOCAL_MESSAGE.LocalMsg_RefreshTask,function(){this.initData(),this.getShowIndex(),this.refreshData()}.bind(this),this),l.ClientNetwork.getInstance().listenProtocol(u.ROLE_CLIENT_ENUM.P_Role_TakeTask,function(e){e.resetPos();var t=new u.S_Role_TakeTask;if(t.read(e)){if(0!=t.errorcode)return void s.G.StringManager.PopString("S_Role_TakeTask Error "+t.errorcode);var o=c.default.getViewByName("ReceiveRewardView");o&&o.view&&(o.view.node.active=!1,o.view.closeView()),c.default.addPopView("BaseCtrl","AcquirePopupView","AcquirePopupView",{items:t.prize})}else cc.log("\u8bfb\u53d6\u5931\u8d25")},this),this.initData(),this.getShowIndex(),this.refreshData()},t.prototype.initData=function(){var e=this;this.allTasks.splice(0,this.allTasks.length);var t=r.default.getRoleTaskData();p.TaskTableData.getDataMap().forEach(function(i){if(62==i.clientType){var a=t.tasks.get(i.id),n=new y;n.id=i.id,a&&(n.count=a.taskCount,a.taskState==h.TASK_STATE.TASK_STATE_EXECUTING?n.state=n.count>=o.getTaskNeedCount(i.id)?1:0:a.taskState==h.TASK_STATE.TASK_STATE_FINISH&&(n.state=2)),e.allTasks.push(n)}})},t.prototype.getShowIndex=function(){this.curIndex=0;for(var e=0;e<this.allTasks.length;++e){var t=this.allTasks[e];if(t.state==h.TASK_STATE.TASK_STATE_EXECUTING||t.state==h.TASK_STATE.TASK_STATE_FINISH){this.curIndex=e;break}}},t.allFinish=function(){var e=r.default.getRoleTaskData(),t=!0;return p.TaskTableData.getDataMap().forEach(function(o){62==o.clientType&&e.tasks.get(o.id).taskState!=h.TASK_STATE.TASK_STATE_FINISH&&(t=!1)}),t},t.getTaskNeedCount=function(e){var t=p.TaskTableData.getById(e);return t?t.finishCount:99999999},t.prototype.onDestroy=function(){l.ClientNetwork.getInstance().removeMessageTarget(this)},t.prototype.takeGiftBtnClick=function(){var e=new u.C_Role_TakeTask;e.taskID=this.allTasks[this.curIndex].id,l.ClientNetwork.getInstance().Send(u.ROLE_CLIENT_ENUM.P_Role_TakeTask,e)},t.prototype.prePageClick=function(){this.curIndex<=0||(this.curIndex--,this.refreshData())},t.prototype.nextPageClick=function(){this.curIndex>=this.allTasks.length-1||(this.curIndex++,this.refreshData())},t.guanggaoRedPoint=function(){var e=!1,t=r.default.getRoleTaskData();return p.TaskTableData.getDataMap().forEach(function(i){if(62==i.clientType){var a=t.tasks.get(i.id);a&&a.taskState==h.TASK_STATE.TASK_STATE_EXECUTING&&a.taskCount>=o.getTaskNeedCount(i.id)&&(e=!0)}}),e},t.prototype.refreshData=function(){var e=this.allTasks[this.curIndex],t=this.getRewardId(),i=f.default.getInstance().getItemByID(t);if(i){2==i.type?(this.heroNode.active=!0,this.itemNode.active=!1,this.refreshHeroData(t)):3==i.type&&(this.heroNode.active=!1,this.itemNode.active=!0,this.refreshItemData(t));var a=o.getTaskNeedCount(e.id);a>0&&(this.process.string=e.count+"/"+a,this.bar.progress=e.count/a),0==e.state?(this.funcBtnLabel.string="\u524d\u5f80\u89c2\u770b",this.funcBtn.interactable=!0,g.default.setNodeBright(this.funcBtn.node,!0)):1==e.state?(this.funcBtnLabel.string="\u9886\u53d6",this.funcBtn.interactable=!0,g.default.setNodeBright(this.funcBtn.node,!0)):2==e.state&&(this.funcBtnLabel.string="\u5df2\u9886\u53d6",this.funcBtn.interactable=!1,g.default.setNodeBright(this.funcBtn.node,!1)),g.default.setNodeBright(this.prePageBtn,this.curIndex>0),g.default.setNodeBright(this.nextPageBtn,this.curIndex<this.allTasks.length-1)}},t.prototype.refreshHeroData=function(e){var t=this,o=f.default.getInstance().getHeroConfig(e);if(o){var i=this.allTasks[this.curIndex],a=p.TaskTableData.getById(i.id);if(a){this.heroName.string=o.name,this.heroDesc.string=o.hero_desc,this.heroProf.string=["\u6218\u58eb","\u730e\u4eba","\u6cd5\u5e08","\u7267\u5e08","\u53ec\u5524","\u7cbe\u7075","\u718a\u732b","\u5de5\u7a0b","\u672f\u58eb"][o.occupation-1],this.heroTeDian1.string=s.G.StringManager.getWorldString(a.info),this.heroTeDian2.string=s.G.StringManager.getWorldString(a.info2),_.default.loadSprite("ui/bag/img/"+["zhanshi","lieshou","fashi","mushi","zhaohuan","jingling","xiongmao","gongcheng","renzhe"][o.occupation-1],this.heroProSprite,function(){}),_.default.loadSprite("ui/bag/img/prof"+o.hero_color,this.heroProfIcon,function(){});var n=o.hero_color;3==n?m.setTexture(this.bg,"ui/advertising_gifts/image/hero2"):4==n&&m.setTexture(this.bg,"ui/advertising_gifts/image/hero1");var r=o.npc_id,c=f.default.getInstance().getNpcTemplateConfig(r,1).res_id,l=f.default.getInstance().getResConfig(c).uiScale;_.default.loadSpine(f.default.getInstance().getResConfig(c).animation,function(e){cc.isValid(t,!0)&&(t.heroSpine.removeAllChildren(),e.parent=t.heroSpine,e.scale=.6*e.scale*l/100,e.getComponent(sp.Skeleton).setAnimation(0,"idle",!0))})}}},t.prototype.refreshItemData=function(e){var t=f.default.getInstance().getItemByID(e);t&&(this.itemName.string=t.name,this.itemDesc.string=t.desc,m.setTexture(this.itemIcon,t.big_icon),m.setTexture(this.bg,"ui/advertising_gifts/image/hero1"))},t.prototype.getRewardId=function(){var e=this.allTasks[this.curIndex],t=p.TaskTableData.getById(e.id);if(!t)return 0;var o=f.default.getInstance().getDorpItemsByID(t.prizeID).dropRandom.split("|");if(o.length>0){var i=o[0].split("#");if(i.length>0)return i[0]}return 0},t.prototype.clickFuncBtn=function(){var e=this.allTasks[this.curIndex];if(0==e.state){this.node.active=!1;var t=c.default.getViewByName("AdvertisingGiftsMainView");t&&t.view&&t.view.closeView(),c.default.addPopView("BaseCtrl","AdvertisingOriginView","AdvertisingOriginView")}else if(1==e.state){var o=new u.C_Role_TakeTask;o.taskID=e.id,l.ClientNetwork.getInstance().Send(u.ROLE_CLIENT_ENUM.P_Role_TakeTask,o)}},t.haveGuangGaoTask=function(){var e=r.default.getRoleTaskData(),t=!1;return p.TaskTableData.getDataMap().forEach(function(o){if(62==o.clientType){var i=e.tasks.get(o.id);i&&i.taskState==h.TASK_STATE.TASK_STATE_EXECUTING&&(t=!0)}}),t},n([S(cc.Sprite)],t.prototype,"bg",void 0),n([S(cc.ProgressBar)],t.prototype,"bar",void 0),n([S(cc.Label)],t.prototype,"funcBtnLabel",void 0),n([S(cc.Button)],t.prototype,"funcBtn",void 0),n([S(cc.Label)],t.prototype,"process",void 0),n([S(cc.Node)],t.prototype,"prePageBtn",void 0),n([S(cc.Node)],t.prototype,"nextPageBtn",void 0),n([S(cc.Node)],t.prototype,"heroNode",void 0),n([S(cc.Label)],t.prototype,"heroName",void 0),n([S(cc.Node)],t.prototype,"heroSpine",void 0),n([S(cc.Sprite)],t.prototype,"heroProSprite",void 0),n([S(cc.Sprite)],t.prototype,"heroProfIcon",void 0),n([S(cc.Label)],t.prototype,"heroProf",void 0),n([S(cc.Label)],t.prototype,"heroDesc",void 0),n([S(cc.Label)],t.prototype,"heroTeDian1",void 0),n([S(cc.Label)],t.prototype,"heroTeDian2",void 0),n([S(cc.Node)],t.prototype,"itemNode",void 0),n([S(cc.Sprite)],t.prototype,"itemIcon",void 0),n([S(cc.Label)],t.prototype,"itemName",void 0),n([S(cc.Label)],t.prototype,"itemDesc",void 0),o=n([C],t)}(cc.Component);o.default=T,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/TaskTableData":"TaskTableData","../../common/PlayerModule":"PlayerModule","../../modules/base/GameView":"GameView","../../network/ClientNetwork":"ClientNetwork","../../network/LocalMessage":"LocalMessage","../../network/protocol/RoleProtocols":"RoleProtocols","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/ConfigUtils":"ConfigUtils","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils","../../utils/ResourcesManager":"ResourcesManager"}],AdvertisingGiftsMainView:[function(e,t,o){"use strict";cc._RF.push(t,"6475eM5FdNGKauzKjW4eQZ0","AdvertisingGiftsMainView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../common/PlayerModule"),s=e("../../modules/base/BaseView"),c=e("../../modules/base/Decorators"),l=e("../../modules/manager/LoadResManager"),d=e("../../network/ClientNetwork"),u=e("../../network/LocalMessage"),h=e("./AdvertisingGiftsGuangGaoView"),p=e("./AdvertisingGiftsMengXinView"),f=cc._decorator,g=f.ccclass,m=f.property,_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.mengxinMenu=null,t.qiriMenu=null,t.guanggaoMenu=null,t.contentNode=null,t._type=-1,t}return a(t,e),t.path=function(){return"ui/advertising_gifts/prefab/AdvertisingGiftsMain"},t.prototype.onDestroy=function(){},t.prototype.onLoad=function(){},t.prototype.start=function(){},t.prototype.init=function(){this.initMenu(),this.chooseDefault(),this.refreshMenuRedPoint(),d.ClientNetwork.getInstance().listenLocalMessage(u.LOCAL_MESSAGE.LocalMsg_RefreshTask,function(){p.default.haveMengXinTask()?this.refreshMenuRedPoint():this.closeView()}.bind(this),this)},t.prototype.chooseDefault=function(){var e=null,t=0;this.mengxinMenu.active?(e=this.mengxinMenu,t=0):this.qiriMenu.active?(e=this.qiriMenu,t=1):this.guanggaoMenu.active&&(e=this.guanggaoMenu,t=2);var o=e.getComponent(cc.Toggle);o&&(o.check(),this.clickMenuBtn(null,t))},t.prototype.initMenu=function(){this.mengxinMenu.active=p.default.haveMengXinTask(),this.qiriMenu.active=!0,this.guanggaoMenu.active=h.default.haveGuangGaoTask()},t.prototype.refreshMenuRedPoint=function(){var e=this.mengxinMenu.getChildByName("redPoint"),t=this.qiriMenu.getChildByName("redPoint"),o=this.guanggaoMenu.getChildByName("redPoint");e.active=this.mengxinMenu.active&&0!=this._type&&p.default.mengxinRedPoint(),t.active=1!=this._type&&this.qiriRedPoint(),o.active=this.guanggaoMenu.active&&2!=this._type&&h.default.guanggaoRedPoint()},t.prototype.qiriRedPoint=function(){return r.default.getWatchadboxData().watchADNum>=10&&0==r.default.getWatchadboxData().isReceive},t.prototype.clickMenuBtn=function(e,t){var o=Number(t);this._type!=o&&(this._type=o,this.refreshContent(),this.refreshMenuRedPoint())},t.prototype.refreshContent=function(){var e="",t="";switch(this._type){case 0:e="ui/advertising_gifts/prefab/AdvertisingGiftsMengXin",t="AdvertisingGiftsMengXinView";break;case 1:e="ui/advertising_gifts/prefab/AdvertisingGifts",t="AdvertisingGiftsView";break;case 2:e="ui/advertising_gifts/prefab/AdvertisingGiftsGuangGao",t="AdvertisingGiftsGuangGaoView"}if(!(e.length<=0)){var o=this;l.default.loadPrefab(e).then(function(e){if(cc.isValid(o)&&e){o.contentNode.destroyAllChildren(),e.parent=o.contentNode;var i=e.getComponent(t);i&&i.init()}})}},n([m(cc.Node)],t.prototype,"mengxinMenu",void 0),n([m(cc.Node)],t.prototype,"qiriMenu",void 0),n([m(cc.Node)],t.prototype,"guanggaoMenu",void 0),n([m(cc.Node)],t.prototype,"contentNode",void 0),n([c.Register_Class,g],t)}(s.default);o.default=_,cc._RF.pop()},{"../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/manager/LoadResManager":"LoadResManager","../../network/ClientNetwork":"ClientNetwork","../../network/LocalMessage":"LocalMessage","./AdvertisingGiftsGuangGaoView":"AdvertisingGiftsGuangGaoView","./AdvertisingGiftsMengXinView":"AdvertisingGiftsMengXinView"}],AdvertisingGiftsMengXinView:[function(e,t,o){"use strict";cc._RF.push(t,"873aaNk/NBHaKLhNHUd7D8u","AdvertisingGiftsMengXinView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../common/PlayerModule"),s=e("../../Global/GameGlobal"),c=e("../../modules/base/Decorators"),l=e("../../modules/base/GameView"),d=e("../../network/ClientNetwork"),u=e("../../network/LocalMessage"),h=e("../../network/protocol/RoleProtocols"),p=e("../../network/protocol/TypeProtocols"),f=e("../../StaticData/TaskTableData"),g=e("../../utils/ByteDanceMiniGameUtils"),m=e("../../utils/ConfigUtils"),_=e("../../utils/GamePlatform"),y=e("../../utils/GameTools"),v=e("../../utils/RewardedVideoAd"),C=e("../../utils/RewardedVideoUnitIdConst"),S=e("../../utils/TimeOffSetManager"),T=function(){this.id=0,this.takeTime=0,this.finishCount=0},I=cc._decorator,N=I.ccclass,b=I.property,w=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.timeLabel=null,t.takeBtn=null,t.gifts=null,t._refreshTaskId=0,t}var o;return a(t,e),o=t,t.prototype.onLoad=function(){d.ClientNetwork.getInstance().listenLocalMessage(u.LOCAL_MESSAGE.LocalMsg_RefreshTask,function(){if(o.initData(),this.setCountDown(),this.refreshReward(),o.curmengxinTaskInfo.finishCount>=1){var e=new h.C_Role_TakeTask;e.taskID=o.curmengxinTaskInfo.id,d.ClientNetwork.getInstance().Send(h.ROLE_CLIENT_ENUM.P_Role_TakeTask,e)}}.bind(this),this),d.ClientNetwork.getInstance().listenProtocol(h.ROLE_CLIENT_ENUM.P_Role_TakeTask,function(e){e.resetPos();var t=new h.S_Role_TakeTask;if(t.read(e)){if(0!=t.errorcode)return void s.G.StringManager.PopString("S_Role_TakeTask Error "+t.errorcode);var o=l.default.getViewByName("ReceiveRewardView");o&&o.view&&(o.view.node.active=!1,o.view.closeView()),l.default.addPopView("BaseCtrl","AcquirePopupView","AcquirePopupView",{items:t.prize})}else cc.log("\u8bfb\u53d6\u5931\u8d25")},this),this.changeAdButtonSkins()},t.prototype.start=function(){},t.prototype.init=function(){if(o.initData(),this.setCountDown(),this.refreshReward(),o.curmengxinTaskInfo.finishCount>=1){var e=new h.C_Role_TakeTask;e.taskID=o.curmengxinTaskInfo.id,d.ClientNetwork.getInstance().Send(h.ROLE_CLIENT_ENUM.P_Role_TakeTask,e)}},t.initData=function(){var e=r.default.getRoleTaskData(),t=!1;e.tasks.forEach(function(e){var i=f.TaskTableData.getById(e.taskID);if(i)return t||61!=i.clientType||e.taskState!=p.TASK_STATE.TASK_STATE_EXECUTING?void 0:(o.curmengxinTaskInfo.id=e.taskID,o.curmengxinTaskInfo.takeTime=e.taskCDTime,o.curmengxinTaskInfo.finishCount=e.taskCount,void(t=!0))})},t.haveMengXinTask=function(){var e=r.default.getRoleTaskData(),t=!1;return e.tasks.forEach(function(e){var o=f.TaskTableData.getById(e.taskID);o&&61==o.clientType&&e.taskState==p.TASK_STATE.TASK_STATE_EXECUTING&&(t=!0)}),t},t.prototype.setCountDown=function(){o.getleftTime()>0?this.schedule(this.refreshTimeCountDown,.1):this.unschedule(this.refreshTimeCountDown),this.refreshTimeCountDown()},t.prototype.refreshTimeCountDown=function(){var e=o.getleftTime();e<=0?(this.timeLabel.string="\u5728\u7ebf 00:00 \u540e\u9886\u53d6",this.unschedule(this.refreshTimeCountDown)):this.timeLabel.string=e>=3600?"\u5728\u7ebf "+S.TimeOffSetManager.getSecondStr(e)+" \u540e\u9886\u53d6":"\u5728\u7ebf "+S.TimeOffSetManager.getSecondStr2(e)+" \u540e\u9886\u53d6",y.default.setNodeBright(this.takeBtn.node,e<=0)},t.prototype.refreshReward=function(){var e=this;if(this._refreshTaskId!=o.curmengxinTaskInfo.id){this._refreshTaskId=o.curmengxinTaskInfo.id,this.gifts.node.destroyAllChildren();var t=f.TaskTableData.getById(o.curmengxinTaskInfo.id);if(t){var i=m.default.getInstance().getDorpItemsByID(t.prizeID);if(i){var a=i.dropRandom.split("|"),n=a.length,r=this;for(var s in a){var c=a[s].split("#");c.length>=2&&y.default.createNormalItems(c[0],c[1],this.gifts.node,function(t){cc.isValid(r,!0)&&(t.scale=.8,--n<=0&&(e._refreshTaskId=0))})}}}}},t.getleftTime=function(){var e=S.TimeOffSetManager.getServerUTCSecond();return o.curmengxinTaskInfo.takeTime-e},t.prototype.clickTakeBtn=function(){if(o.getleftTime()>0)s.G.StringManager.PopString(s.G.StringManager.getString("MENGXIN_CAN_NOT_TAKE"));else{var e=f.TaskTableData.getById(o.curmengxinTaskInfo.id);if(e){var t=e.finishParam1;v.default.createVideo({name:"task_mengxin_gift",adUnitId:C.RewardedVideoUnitIdConst.TaskFreeBox,advertID:C.RewardedVideoClientIdConst.Task_Free_Box,finishCb:function(){var e=l.default.getViewByName("MainSceneView");e&&e.view&&e.view.onClientTaskAddAdvert(t)}})}}},t.mengxinRedPoint=function(){return o.getleftTime()<=0},t.prototype.changeAdButtonSkins=function(){_.GamePlatform.isByteDanceMiniGame()&&g.default.getInstance().changeSkinOfAdButton(this.node.getChildByName("takeBtn"),"advertise")},t.curmengxinTaskInfo=new T,n([b(cc.Label)],t.prototype,"timeLabel",void 0),n([b(cc.Button)],t.prototype,"takeBtn",void 0),n([b(cc.Layout)],t.prototype,"gifts",void 0),o=n([c.Register_Class,N],t)}(cc.Component);o.default=w,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/TaskTableData":"TaskTableData","../../common/PlayerModule":"PlayerModule","../../modules/base/Decorators":"Decorators","../../modules/base/GameView":"GameView","../../network/ClientNetwork":"ClientNetwork","../../network/LocalMessage":"LocalMessage","../../network/protocol/RoleProtocols":"RoleProtocols","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/ByteDanceMiniGameUtils":"ByteDanceMiniGameUtils","../../utils/ConfigUtils":"ConfigUtils","../../utils/GamePlatform":"GamePlatform","../../utils/GameTools":"GameTools","../../utils/RewardedVideoAd":"RewardedVideoAd","../../utils/RewardedVideoUnitIdConst":"RewardedVideoUnitIdConst","../../utils/TimeOffSetManager":"TimeOffSetManager"}],AdvertisingGiftsView:[function(e,t,o){"use strict";cc._RF.push(t,"5cc00+UjWdHB5lKY47IZX7A","AdvertisingGiftsView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/GameView"),s=e("../../utils/GameTools"),c=e("../../common/PlayerModule"),l=e("../../StaticData/TotalWatchADBoxTableData"),d=e("../../network/ClientNetwork"),u=e("../../network/protocol/RoleProtocols"),h=cc._decorator,p=h.ccclass,f=h.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.gotoOriginNode=null,t.drawBoxNode=null,t.advertisingProgressBar=null,t}return a(t,e),t.prototype.onLoad=function(){var e=this;d.ClientNetwork.getInstance().listenProtocol(u.ROLE_CLIENT_ENUM.P_Role_TotalWatchADBoxReceivePrize,function(t){t.resetPos();var o=new u.S_Role_TotalWatchADBoxReceivePrize;if(o.read(t)&&0===o.errorcode&&o.prize.length>0){r.default.addPopView("BaseCtrl","AcquirePopupView","AcquirePopupView",{items:o.prize}),e.drawBoxNode.getComponent(cc.Animation).play("boxnormal"),e.drawBoxNode.getChildByName("ReceivedSprite").active=!0,e.drawBoxNode.off(cc.Node.EventType.TOUCH_START),e.drawBoxNode.off(cc.Node.EventType.TOUCH_MOVE),e.drawBoxNode.off(cc.Node.EventType.TOUCH_END),e.drawBoxNode.off(cc.Node.EventType.TOUCH_CANCEL),e._curDayNode.getChildByName("CompleteNode").active=!0,c.default.getWatchadboxData().isReceive=!0;var i=r.default.getViewByName("MainSceneView");i&&i.view&&i.view.onAdvertisingGiftsRedPoint()}},this)},t.prototype.start=function(){var e=this;s.default.registerTouchEvent(this.gotoOriginNode,function(){e.node.active=!1;var t=r.default.getViewByName("AdvertisingGiftsMainView");t&&t.view&&t.view.closeView(),r.default.addPopView("BaseCtrl","AdvertisingOriginView","AdvertisingOriginView")})},t.prototype.init=function(){var e=c.default.getWatchadboxData();this.setDayInfo(e),this.setProgressInfo(e),this.onRegisterBoxClick(e)},t.prototype.onRegisterBoxClick=function(e){for(var t=function(t){var i=o.node.getChildByName("BoxNode"+t),a=o.getWatchBoxCfgByDay(e.watchADIndex,t+1);a.strScope&&s.default.registerTouchEvent(i,function(){r.default.addPopView("BaseCtrl","AdvertisingBoxPreview","AdvertisingBoxPreview",{strScop:a.strScope})})},o=this,i=0;i<7;i++)t(i)},t.prototype.setDayInfo=function(e){for(var t=0;t<7;t++){var o=this.node.getChildByName("BoxNode"+t);o.getComponent(cc.Sprite).enabled=!1,t+1<=e.watchADDay&&(o.getChildByName("CompleteNode").active=!0,t+1==e.watchADDay&&(o.getComponent(cc.Sprite).enabled=!0,this._curDayNode=o,o.getChildByName("CompleteNode").active=e.isReceive))}},t.prototype.setProgressInfo=function(e){var t=this.getWatchBoxCfgByDay(e.watchADIndex,e.watchADDay);this.advertisingProgressBar.progress=e.watchADNum/t.time,e.watchADNum>=t.time&&0==e.isReceive?(this.drawBoxNode.getComponent(cc.Animation).play("boxshake"),s.default.registerTouchEvent(this.drawBoxNode,function(){var e=new u.C_Role_TotalWatchADBoxReceivePrize;e.isPrize=!0,e.isExtra=!1,d.ClientNetwork.getInstance().Send(u.ROLE_CLIENT_ENUM.P_Role_TotalWatchADBoxReceivePrize,e)})):this.drawBoxNode.getComponent(cc.Animation).play("boxnormal"),1==e.isReceive?this.drawBoxNode.getChildByName("ReceivedSprite").active=!0:this.drawBoxNode.getChildByName("ReceivedSprite").active=!1},t.prototype.getWatchBoxCfgByDay=function(e,t){var o=l.TotalWatchADBoxTableData.getDataMap(),i=null;return o.forEach(function(o){o.index==e&&o.day==t&&(i=o)}),i},t.prototype.onDestroy=function(){d.ClientNetwork.getInstance().removeMessageTarget(this)},n([f(cc.Node)],t.prototype,"gotoOriginNode",void 0),n([f(cc.Node)],t.prototype,"drawBoxNode",void 0),n([f(cc.ProgressBar)],t.prototype,"advertisingProgressBar",void 0),n([p],t)}(cc.Component);o.default=g,cc._RF.pop()},{"../../StaticData/TotalWatchADBoxTableData":"TotalWatchADBoxTableData","../../common/PlayerModule":"PlayerModule","../../modules/base/GameView":"GameView","../../network/ClientNetwork":"ClientNetwork","../../network/protocol/RoleProtocols":"RoleProtocols","../../utils/GameTools":"GameTools"}],AdvertisingOriginView:[function(e,t,o){"use strict";cc._RF.push(t,"f0eb3FGDWNCsYBCJQWmNo4s","AdvertisingOriginView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r,s=e("../../Global/GameGlobal"),c=e("../../common/CombatModule"),l=e("../../modules/base/BaseView"),d=e("../../utils/GameTools"),u=e("../../StaticData/TaskTableData"),h=e("../../modules/base/GameView"),p=e("../../common/PlayerModule"),f=e("../../modules/base/Decorators"),g=e("../../network/protocol/TypeProtocols"),m=e("../../utils/GameUtils"),_=e("../sociaty/SociatyModel");(function(e){e[e.SOLO_Type=1]="SOLO_Type",e[e.COOP_Type=2]="COOP_Type",e[e.TASK_TYPE=3]="TASK_TYPE",e[e.SHOP_TYPE=4]="SHOP_TYPE",e[e.SOCIATY_DONATE=6]="SOCIATY_DONATE"})(r||(r={}));var y=cc._decorator,v=y.ccclass,C=y.property,S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.taskItemPrefabNode=null,t.taskScrollView=null,t}return a(t,e),t.path=function(){return"ui/advertising_gifts/prefab/AdvertisingOrigin"},t.prototype.init=function(){var e=this,t=Array.from(p.default.getRoleTaskData().tasks.values()),o=[];t.forEach(function(e){var t=u.TaskTableData.getById(e.taskID);t.type==g.TASK_TYPE.TASK_TYPE_COUNT_ADVERT&&t.jumpType>0&&o.push(e)}),o.sort(function(e,t){var o=u.TaskTableData.getById(e.taskID),i=u.TaskTableData.getById(t.taskID);return o.order-i.order}),o.forEach(function(t){var o=u.TaskTableData.getById(t.taskID),i=cc.instantiate(e.taskItemPrefabNode);i.active=!0,i.parent=e.taskScrollView.content,i.getChildByName("task_desc").getComponent(cc.Label).string=s.G.StringManager.getWorldString(o.info);var a=t.taskCount;if(101==t.taskID&&p.default.getRoleTaskData().extra.taskgroup.size>0){var n=p.default.getRoleTaskData().extra.taskgroup.get(3).boxs.size;t.taskCount!=n&&(a=n)}i.getChildByName("task_progressBar").getComponent(cc.ProgressBar).progress=a/o.finishCount,i.getChildByName("task_progressBar").getChildByName("num").getComponent(cc.Label).string=a+"/"+o.finishCount;var l=i.getChildByName("goto");l.jumpType=o.jumpType,d.default.registerTouchEvent(l,function(t){switch(e.closeView(),t.target.jumpType){case r.SOLO_Type:h.default.addPopView("BaseCtrl","BattleRoomMainView","BattleRoomMainView",{CombatType:c.CombatType.SOLO});break;case r.COOP_Type:if(p.default.getRoleInfoData().cooperationDayLeftNum<=0)return p.default.getRoleInfoData().cooperationDayWatchAdNum<Number(m.getConfigIntValue("match_cooperation_day_add_num"))?h.default.addPopView("BaseCtrl","AddCoopCountAdvertise","AddCoopCountAdvertise"):s.G.StringManager.PopStringOnce(s.G.StringManager.getString("COOP_TIMES_NOTENOUGH"));h.default.addPopView("BaseCtrl","BattleRoomMainView","BattleRoomMainView",{CombatType:c.CombatType.COOP});break;case r.TASK_TYPE:h.default.addPopView("BaseCtrl","TaskView","TaskView");break;case r.SHOP_TYPE:h.default.addPopView("ShopMainCtrl","ShopMainView","ShopMainView");break;case r.SOCIATY_DONATE:var o=_.default.instance().SociatyPlayerData;if(o.sociatyID.length<=0||0==Number(o.sociatyID))return s.G.StringManager.PopString(s.G.StringManager.getString("JUMP_SOCIATY_ERROR_TEXT"));h.default.addPopView("BaseCtrl","SociatyMainView","SociatyMainView")}}),a>=o.finishCount&&(l.active=!1,i.getChildByName("finish").active=!0)})},n([C(cc.Node)],t.prototype,"taskItemPrefabNode",void 0),n([C(cc.ScrollView)],t.prototype,"taskScrollView",void 0),n([f.Register_Class,v],t)}(l.default);o.default=S,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/TaskTableData":"TaskTableData","../../common/CombatModule":"CombatModule","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/base/GameView":"GameView","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils","../sociaty/SociatyModel":"SociatyModel"}],AnniversaryBattlePassBuyView:[function(e,t,o){"use strict";cc._RF.push(t,"b28463dCmpGXLHXlq4Yknix","AnniversaryBattlePassBuyView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=e("../../StaticData/CostGetTableData"),l=e("../../Global/GameGlobal"),d=e("../../common/NetworkProtocolCommon"),u=e("../../common/PlayerModule"),h=cc._decorator,p=h.ccclass,f=h.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.m_costLab=null,t.m_getLab=null,t}return a(t,e),t.path=function(){return"ui/anniversary/prefab/AnniversaryBattlePassBuyView"},t.prototype.start=function(){var e=c.CostGetTableData.getById(6),t=l.G.StringManager.m_pDict.COMMON_COSTGET_LAB.split("|")[0],o=l.G.StringManager.formatStr(t,[e.cost[0].itemNum]);this.m_costLab.string=o;var i=l.G.StringManager.m_pDict.COMMON_COSTGET_LAB.split("|")[1],a=l.G.StringManager.formatStr(i,[e.get[0].itemNum]);this.m_getLab.string=a},t.prototype.onClickConfirmCallBack=function(){if(u.default.diamondNum<c.CostGetTableData.getById(6).cost[0].itemNum)return l.G.StringManager.PopWorldString("common_prompt_diamond_insufficient");d.default.callRoleCostGet(6)},n([f(cc.Label)],t.prototype,"m_costLab",void 0),n([f(cc.Label)],t.prototype,"m_getLab",void 0),n([s.Register_Class,p],t)}(r.default);o.default=g,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/CostGetTableData":"CostGetTableData","../../common/NetworkProtocolCommon":"NetworkProtocolCommon","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators"}],AnniversaryBattlePassItem:[function(e,t,o){"use strict";cc._RF.push(t,"a65c4m6b9lLgJemwmEn5Rgq","AnniversaryBattlePassItem");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/manager/LoadResManager"),s=e("../../utils/GameTools"),c=e("../../modules/base/GameView"),l=e("../../Global/GameGlobal"),d=e("../../network/protocol/TypeProtocols"),u=e("../../common/PlayerModule"),h=e("../../utils/ConfigUtils"),p=e("../../view/anniversary/AnniversaryModule"),f=e("../../network/protocol/ActivityProtocols"),g=e("../../network/ClientNetwork"),m=cc._decorator.ccclass,_=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.show=function(e,t){this.initCoinInfo(e,t),this.initFreeBoxInof(e,t),this.initLuxuryBoxInfo(e,t)},t.prototype.initLuxuryBoxInfo=function(e,t){var o=this,i=this.node.getChildByName("ExtraRewardsNode");i.reawds=e.extraPrize,i.coinNum=e.coinNum,i.id=e.id,r.default.loadSpriteFrame(e.extraItemIcon).then(function(t){cc.isValid(o.node)&&(i.getChildByName("ExtraRewardsIcon").scale=i.getChildByName("ExtraRewardsIcon").scale*e.extraItemScale/100,i.getChildByName("ExtraRewardsIcon").getComponent(cc.Sprite).spriteFrame=t)}).catch(function(e){cc.error(e)}),i.getChildByName("ExtraRewardsName").getComponent(cc.Label).string=e.extraItemName;var a=this.checkLuxuryRewardLockState();i.getChildByName("suo").active=!a,0==a&&s.default.registerTouchEvent(i.getChildByName("suo"),function(){l.G.StringManager.PopString(l.G.StringManager.getString("ANNIVERSARY_BATTLEPASS_SUO"))});var n=0,h=t;1==this.checkBoxReceiveState(e.id,2)?n=2:h>=e.coinNum&&1==a&&(n=1),2==n?(s.default.setNodeBright(i,!1),this.node.getChildByName("waifaguang").active=!1):this.node.getChildByName("waifaguang").active=1==n,i.receiveState=n,s.default.registerTouchEvent(i,function(e){var t=e.target;if(t.reawds)if(t.reawds.length>1)c.default.addPopView("BaseCtrl","BattlePassRewardPreview","BattlePassRewardPreview",{cb:function(){if(1!=u.default.getRoleAttrValByKey(d.ROLE_ATTR_VALUES.ROLE_ATTR_ANNIVERSARY_BATTLEPASS))return l.G.StringManager.PopString(l.G.StringManager.getString("ANNIVERSARY_BATTLEPASS_SUO"));var e=new f.T_Activity_AnniversaryTrialGetBoxsData;e.index=t.id,e.type=2;var o=new f.C_Activity_AnniversaryTrialGetBoxsReward;o.getRewardsVec=[e],g.ClientNetwork.getInstance().Send(f.ACTIVITY_CLIENT_ENUM.P_Activity_AnniversaryTrialGetBoxsReward,o)},rewards:t.reawds,rewardState:t.receiveState});else{if(2==t.receiveState)return l.G.StringManager.PopString(l.G.StringManager.getWorldString("common_prompt_receive_over"));if(1==t.receiveState){if(1!=u.default.getRoleAttrValByKey(d.ROLE_ATTR_VALUES.ROLE_ATTR_ANNIVERSARY_BATTLEPASS))return l.G.StringManager.PopString(l.G.StringManager.getString("ANNIVERSARY_BATTLEPASS_SUO"));var i=new f.T_Activity_AnniversaryTrialGetBoxsData;i.index=t.id,i.type=2;var a=new f.C_Activity_AnniversaryTrialGetBoxsReward;a.getRewardsVec=[i],g.ClientNetwork.getInstance().Send(f.ACTIVITY_CLIENT_ENUM.P_Activity_AnniversaryTrialGetBoxsReward,a)}else o.checkRewardIsHero(t.reawds[0])&&c.default.addPopView("BaseCtrl","DrawNewHeroCardView","DrawNewHeroCardView",{heroId:t.reawds[0].itemID,bShowNew:!0,bAction:!0})}})},t.prototype.initCoinInfo=function(e){var t=this;this.node.getChildByName("CoinBg").getChildByName("CoinNum").getComponent(cc.Label).string=e.coinNum.toString(),0>=e.coinNum&&r.default.loadSpriteFrame("ui/battle_pass/res/bei1").then(function(e){cc.isValid(t.node)&&(t.node.getChildByName("CoinBg").getComponent(cc.Sprite).spriteFrame=e)})},t.prototype.initFreeBoxInof=function(e,t){var o=this,i=this.node.getChildByName("RewardsNode");i.reawds=e.prize,i.coinNum=e.coinNum,i.id=e.id,r.default.loadSpriteFrame(e.itemIcon).then(function(t){cc.isValid(o.node)&&(i.getChildByName("RewardsIcon").scale=i.getChildByName("RewardsIcon").scale*e.itemScale/100,i.getChildByName("RewardsIcon").getComponent(cc.Sprite).spriteFrame=t)}).catch(function(e){cc.error(e)}),i.getChildByName("RewardsName").getComponent(cc.Label).string=e.itemName;var a=0,n=t;1==this.checkBoxReceiveState(e.id,1)?a=2:n>=e.coinNum&&(a=1),2==a?(s.default.setNodeBright(i,!1),this.node.getChildByName("waifaguangReward").active=!1):this.node.getChildByName("waifaguangReward").active=1==a,i.receiveState=a,s.default.registerTouchEvent(i,function(e){var t=e.target;if(t.reawds.length>1)c.default.addPopView("BaseCtrl","BattlePassRewardPreview","BattlePassRewardPreview",{cb:function(){var e=new f.T_Activity_AnniversaryTrialGetBoxsData;e.index=t.id,e.type=1;var o=new f.C_Activity_AnniversaryTrialGetBoxsReward;o.getRewardsVec=[e],g.ClientNetwork.getInstance().Send(f.ACTIVITY_CLIENT_ENUM.P_Activity_AnniversaryTrialGetBoxsReward,o)},rewards:t.reawds,rewardState:t.receiveState});else{if(2==t.receiveState)return l.G.StringManager.PopString(l.G.StringManager.getWorldString("common_prompt_receive_over"));if(1==t.receiveState){var i=new f.T_Activity_AnniversaryTrialGetBoxsData;i.index=t.id,i.type=1;var a=new f.C_Activity_AnniversaryTrialGetBoxsReward;a.getRewardsVec=[i],g.ClientNetwork.getInstance().Send(f.ACTIVITY_CLIENT_ENUM.P_Activity_AnniversaryTrialGetBoxsReward,a)}else o.checkRewardIsHero(t.reawds[0])&&c.default.addPopView("BaseCtrl","DrawNewHeroCardView","DrawNewHeroCardView",{heroId:t.reawds[0].itemID,bShowNew:!0,bAction:!0})}})},t.prototype.checkLuxuryRewardLockState=function(){var e=!1;return 1==u.default.getRoleAttrValByKey(d.ROLE_ATTR_VALUES.ROLE_ATTR_ANNIVERSARY_BATTLEPASS)&&(e=!0),e},t.prototype.checkBoxReceiveState=function(e,t){var o=p.default.Instance.AnniversaryBoxData().normalPrize;return 2==t&&(o=p.default.Instance.AnniversaryBoxData().superprize),!!o.has(e)&&o.get(e)},t.prototype.checkRewardIsHero=function(e){return!!h.default.getInstance().data["StaticData/HeroTableData"].hasOwnProperty(e.itemID)},n([m],t)}(cc.Component);o.default=_,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../common/PlayerModule":"PlayerModule","../../modules/base/GameView":"GameView","../../modules/manager/LoadResManager":"LoadResManager","../../network/ClientNetwork":"ClientNetwork","../../network/protocol/ActivityProtocols":"ActivityProtocols","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/ConfigUtils":"ConfigUtils","../../utils/GameTools":"GameTools","../../view/anniversary/AnniversaryModule":"AnniversaryModule"}],AnniversaryBattlePassTableData:[function(e,t,o){"use strict";cc._RF.push(t,"e361cdLhJ5D4oCN0NIKmbv1","AnniversaryBattlePassTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.AnniversaryBattlePassTableData=void 0;var i=e("../TableReader"),a=e("./BaseTableData"),n=function(){function e(){this.id=0,this.coinNum=0,this.itemName="",this.itemIcon="",this.itemScale=0,this.extraItemName="",this.extraItemIcon="",this.extraItemScale=0,this.prize=new Array,this.extraPrize=new Array,this.pointX=0}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.coinNum=e.getNumber(),this.itemName=e.getString(),this.itemIcon=e.getString(),this.itemScale=e.getNumber(),this.extraItemName=e.getString(),this.extraItemIcon=e.getString(),this.extraItemScale=e.getNumber();for(var o=e.getString(),n=new i.TableReader(o);n.getPos()<n.getLen();)(s=new a.ItemInfo).readOriginal(n),this.prize.push(s);o=e.getString();for(var r=new i.TableReader(o);r.getPos()<r.getLen();){var s;(s=new a.ItemInfo).readOriginal(r),this.extraPrize.push(s)}this.pointX=e.getNumber()},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"AnniversaryBattlePassTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.AnniversaryBattlePassTableData=n,cc._RF.pop()},{"../TableReader":"TableReader","./BaseTableData":"BaseTableData"}],AnniversaryBattlePassView:[function(e,t,o){"use strict";cc._RF.push(t,"c8245uXAvRCma8E7g8Bo/Vn","AnniversaryBattlePassView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../StaticData/AnniversaryBattlePassTableData"),s=e("../../common/PlayerModule"),c=e("../../modules/base/GameView"),l=e("../../view/anniversary/AnniversaryModule"),d=e("../../Global/GameGlobal"),u=e("../../common/EventConst"),h=e("../../modules/manager/EventManager"),p=e("../../utils/GameUtils"),f=e("../../network/protocol/TypeProtocols"),g=e("../../network/protocol/RoleProtocols"),m=e("../../network/ClientNetwork"),_=e("../../modules/base/BaseView"),y=e("../../modules/base/Decorators"),v=e("../../StaticData/ActivityTableData"),C=e("../../network/protocol/RechargeProtocols"),S=e("../../network/protocol/ActivityProtocols"),T=e("../../StaticData/RechargeTableData"),I=e("../../utils/GameTools"),N=cc._decorator,b=N.ccclass,w=N.property,E=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.itemPrefab=null,t.ScrollView=null,t.progressBarNode=null,t.curTrophyNode=null,t.curGetWayLab=null,t._scrollViewChildNode=[],t._curSeasonData=[],t._boxItemSpacing=300,t.m_ItemId=1022,t.m_itemNum=0,t.rewardCount=0,t.nSeasonLeftTime=0,t}return a(t,e),t.path=function(){return"ui/anniversary/prefab/AnniversaryBattlePass"},t.prototype.onLoad=function(){var e=this;this.m_ItemId=Number(p.getConfigIntValue("anniversary_battlepass_coin_itemid")),m.ClientNetwork.getInstance().listenProtocol(g.ROLE_CLIENT_ENUM.P_Role_Get_Item_Num,function(t){t.resetPos();var o=new g.S_Role_Get_Item_Num;o.read(t)&&0===o.errorcode&&o.itemId==e.m_ItemId&&(e.m_itemNum=o.itemNum,e.initBoxInfo())},this),m.ClientNetwork.getInstance().listenProtocol(S.ACTIVITY_CLIENT_ENUM.P_Activity_AnniversaryTrialGetBoxsReward,function(t){t.resetPos();var o=new S.S_Activity_AnniversaryTrialGetBoxsReward;o.read(t)&&(0==o.errorcode&&o.rewards.length>0&&(e.initBoxInfo(),e.showRewards(o.rewards),h.default.Instance.emit(u.default.RefreshAnniversaryBoxRedpoint)),0!=o.errorcode&&d.G.StringManager.PopString("S_Activity_AnniversaryTrialGetBoxsReward ERROR "+o.errorcode))},this),m.ClientNetwork.getInstance().listenProtocol(C.RECHARGE_CLIENT_ENUM.P_Recharge_Role_Recharge,function(){console.log("P_Recharge_Role_Recharge===================="),e.initBoxInfo(),1==s.default.getRoleAttrValByKey(f.ROLE_ATTR_VALUES.ROLE_ATTR_ANNIVERSARY_BATTLEPASS)&&(e.node.getChildByName("BuyButton").active=!1)},this)},t.prototype.start=function(){var e=this,t=new g.C_Role_Get_Item_Num;t.itemId=this.m_ItemId,m.ClientNetwork.getInstance().Send(g.ROLE_CLIENT_ENUM.P_Role_Get_Item_Num,t),r.AnniversaryBattlePassTableData.getDataMap().forEach(function(t){e._curSeasonData.push(t)});var o=Number(p.getConfigIntValue("anniversary_battlepass_rechargeid")),i=T.RechargeTableData.getById(o),a=I.default.getRechargeMoneyByPlatform(i)/100;this.node.getChildByName("BuyButton").getChildByName("label").getComponent(cc.Label).string="\uffe5"+a;var n=this._curSeasonData;this.progressBarNode.width=n[n.length-1].pointX,this.ScrollView.content.width=this.progressBarNode.width+n[0].pointX-this.itemPrefab.width/2+100,1==s.default.getRoleAttrValByKey(f.ROLE_ATTR_VALUES.ROLE_ATTR_ANNIVERSARY_BATTLEPASS)&&(this.node.getChildByName("BuyButton").active=!1)},t.prototype.initCurGetWayInfo=function(){this.curGetWayLab.string=s.default.getRoleAttrValByKey(f.ROLE_ATTR_VALUES.ROLE_ATTR_ANNIVERSARY_BOX_COIN_NUM)+"/"+p.getConfigIntValue("anniversary_battlepass_coin_limited")},t.prototype.initBoxProgress=function(){var e=null;this.curTrophyNode.x=5;var t,o=this._curSeasonData,i=0,a=this.m_itemNum;if(o.forEach(function(t,o){a>=t.coinNum&&(e=t,i=o)}),e)if(t=o[i+1]){var n=a-e.coinNum,r=t.coinNum-e.coinNum,s=(t.pointX-e.pointX)*(n/r),c=e.pointX+s;this.curTrophyNode.x=c,isNaN(this.curTrophyNode.x)&&(this.curTrophyNode.x=5),this.progressBarNode.getChildByName("bar").width=c}else this.progressBarNode.getChildByName("bar").width=this.progressBarNode.width,this.curTrophyNode.x=this.progressBarNode.width-5;else(t=o[i])?(n=a,r=t.coinNum,c=s=t.pointX*(n/r),this.curTrophyNode.x=c,isNaN(this.curTrophyNode.x)&&(this.curTrophyNode.x=5),this.progressBarNode.getChildByName("bar").width=c):(this.progressBarNode.getChildByName("bar").width=this.progressBarNode.width,this.curTrophyNode.x=this.progressBarNode.width-5);this.curTrophyNode.getChildByName("CoinLabel").getComponent(cc.Label).string=a.toString()},t.prototype.onRefreshSociatySeasonEndTime=function(){var e=this.node.getChildByName("sociatyEndTimeLab").getComponent(cc.Label),t=v.ActivityTableData.getById(S.ACTIVITY_ID_ENUM.P_Activity_Anniversary),o=s.default.getServersTime(),i=t.param9-o;if(i<=0)return e.node.active=!1,void this.unschedule(this.onRefreshSociatySeasonEndTime);e.string="\u8ddd\u79bb\u6d3b\u52a8\u7ed3\u675f\u8fd8\u6709:"+function(e){var t=e%864e5/36e5,o=e%36e5/6e4,i=e%6e4/1e3;return parseInt((e/864e5).toString())+" \u5929 "+parseInt(t.toString())+" \u5c0f\u65f6 "+parseInt(o.toString())+" \u5206\u949f "+parseInt(i.toString())+" \u79d2 "}.call(this,1e3*i),0==e.node.active&&(e.node.active=!0)},t.prototype.initBoxInfo=function(){var e=this;this._scrollViewChildNode.forEach(function(e){e.destroy()}),this._scrollViewChildNode=[];var t=c.default.getViewByName("BattlePassRewardPreview");t&&t.view&&(t.view.node.active=!1,t.view.closeView());var o=this._curSeasonData,i=o.length,a=0;this.schedule(function(){var t=cc.instantiate(e.itemPrefab);t.parent=e.progressBarNode,t.getComponent("AnniversaryBattlePassItem").show(o[a],e.m_itemNum),t.x=o[a].pointX,t.y=-50,t.active=!0,e._scrollViewChildNode.push(t),e.curTrophyNode.setSiblingIndex(99),a++},0,i-1,0);var n=l.default.Instance.checkReceiveSociatyBoxPrize();this.node.getChildByName("DrawButton").getComponent(cc.Button).interactable=n.length>0,this.node.getChildByName("DrawButton").getComponent(cc.Button).enableAutoGrayEffect=!(n.length>0),this.initBoxProgress(),this.onScrollToPoint(),this.initCurGetWayInfo()},t.prototype.showRewards=function(e){var t=this,o=function(){var e=t.tRewards.slice(6*t.rewardCount,6*(t.rewardCount+1));e.length>0&&c.default.addPopView("BaseCtrl","AcquirePopupView","AcquirePopupView",{items:e,closeCb:function(){t.rewardCount++,o.call(t)}})};this.rewardCount=0,this.tRewards=e,o.call(this)},t.prototype.onTotalGetRewardCallBack=function(){var e=l.default.Instance.checkReceiveSociatyBoxPrize();if(e.length<=0)return d.G.StringManager.PopString(d.G.StringManager.getWorldString("common_prompt_not_rewards"));var t=new S.C_Activity_AnniversaryTrialGetBoxsReward;t.getRewardsVec=e,m.ClientNetwork.getInstance().Send(S.ACTIVITY_CLIENT_ENUM.P_Activity_AnniversaryTrialGetBoxsReward,t)},t.prototype.onBuyBattlePass=function(){var e={rechargeID:Number(p.getConfigIntValue("anniversary_battlepass_rechargeid")),rechargeNum:1};this.sendEvent("SendProtocolRecharge",e)},t.prototype.onScrollToPoint=function(){for(var e=!1,t=this.m_itemNum,o=0,i=this._curSeasonData.length;o<i;o++){var a=(_=this._curSeasonData[o]).coinNum,n=_.id;if(a){var r=this.m_itemNum,c=0,d=l.default.Instance.checkBoxReceiveState(n,1);0!=d&&d||r>=a&&(c=1);var u=0,h=l.default.Instance.checkBoxReceiveState(n,2);if(0!=h&&h||r>=a&&1==s.default.getRoleAttrValByKey(f.ROLE_ATTR_VALUES.ROLE_ATTR_ANNIVERSARY_BATTLEPASS)&&(u=1),1==c||1==u){var p=this.ScrollView.getMaxScrollOffset(),g=_.pointX>p.x?p.x:_.pointX;this.ScrollView.setContentPosition(cc.v2(-g+this.itemPrefab.width,0)),e=!0;break}}}if(0==e){var m=null;for(o=0,i=this._curSeasonData.length;o<i;o++){var _;(_=this._curSeasonData[o]).coinNum&&t>=_.coinNum&&(m=_)}m&&(p=this.ScrollView.getMaxScrollOffset(),g=m.pointX>p.x?p.x:m.pointX,this.ScrollView.setContentPosition(cc.v2(-g+this.itemPrefab.width-180,0)))}},t.prototype.onClickAddCallBack=function(){c.default.addPopView("BaseCtrl","AnniversaryBattlePassBuyView","AnniversaryBattlePassBuyView")},t.prototype.onCloseView=function(){this.closeView()},t.prototype.onHelpCallBack=function(){c.default.addPopView("BaseCtrl","AnniversaryBoxIntroduceView","AnniversaryBoxIntroduceView")},t.prototype.update_pass_currency=function(){if(this.node){var e=new g.C_Role_Get_Item_Num;e.itemId=this.m_ItemId,m.ClientNetwork.getInstance().Send(g.ROLE_CLIENT_ENUM.P_Role_Get_Item_Num,e);var t=c.default.getViewByName("AnniversaryBattlePassBuyView");t&&t.view&&t.view.closeView()}},t.prototype.onDestroy=function(){},n([w(cc.Node)],t.prototype,"itemPrefab",void 0),n([w(cc.ScrollView)],t.prototype,"ScrollView",void 0),n([w(cc.Node)],t.prototype,"progressBarNode",void 0),n([w(cc.Node)],t.prototype,"curTrophyNode",void 0),n([w(cc.Label)],t.prototype,"curGetWayLab",void 0),n([y.Register_Class,b],t)}(_.default);o.default=E,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/ActivityTableData":"ActivityTableData","../../StaticData/AnniversaryBattlePassTableData":"AnniversaryBattlePassTableData","../../StaticData/RechargeTableData":"RechargeTableData","../../common/EventConst":"EventConst","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/base/GameView":"GameView","../../modules/manager/EventManager":"EventManager","../../network/ClientNetwork":"ClientNetwork","../../network/protocol/ActivityProtocols":"ActivityProtocols","../../network/protocol/RechargeProtocols":"RechargeProtocols","../../network/protocol/RoleProtocols":"RoleProtocols","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils","../../view/anniversary/AnniversaryModule":"AnniversaryModule"}],AnniversaryBoxIntroduceView:[function(e,t,o){"use strict";cc._RF.push(t,"a830fvhp7VK5Lek8OWG1sP5","AnniversaryBoxIntroduceView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=cc._decorator,l=c.ccclass,d=(c.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.path=function(){return"ui/anniversary/prefab/AnniversaryBoxIntroduce"},n([s.Register_Class,l],t)}(r.default));o.default=d,cc._RF.pop()},{"../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators"}],AnniversaryCardTableData:[function(e,t,o){"use strict";cc._RF.push(t,"9ccdeKPlANErZb+igOJICZo","AnniversaryCardTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.AnniversaryCardTableData=void 0;var i=e("../TableReader"),a=function(){function e(){this.id=0,this.cardGroup=new Array,this.weight=0}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber();for(var o=e.getString(),a=new i.TableReader(o);a.getPos()<a.getLen();){var n;n=a.getNumber(),this.cardGroup.push(n)}this.weight=e.getNumber()},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"AnniversaryCardTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.AnniversaryCardTableData=a,cc._RF.pop()},{"../TableReader":"TableReader"}],AnniversaryCtrl:[function(e,t,o){"use strict";cc._RF.push(t,"199b4xNhApHVqSa1YBPVzmn","AnniversaryCtrl");var i=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var a=e("../../network/ClientNetwork"),n=e("../../Global/GameGlobal"),r=e("./AnniversaryModule"),s=e("../../network/protocol/ActivityProtocols"),c=e("../../network/protocol/RoleProtocols"),l=e("../../common/EventConst"),d=e("../../modules/manager/EventManager"),u=e("../../network/LocalMessage"),h=e("../../modules/base/GameView"),p=cc._decorator.ccclass,f=function(){function e(){}return e.registerAnniversaryProtocol=function(){a.ClientNetwork.getInstance().listenProtocol(s.ACTIVITY_CLIENT_ENUM.P_Activity_SyncAnniversaryTrialData,this.syncAnniversaryData,this),a.ClientNetwork.getInstance().listenProtocol(s.ACTIVITY_CLIENT_ENUM.P_Activity_SyncReturnBackData,this.syncReturnBackData,this),a.ClientNetwork.getInstance().listenProtocol(s.ACTIVITY_CLIENT_ENUM.P_Activity_ReturnBackHelpNew,this.syncReturnBackHelpNewData,this),a.ClientNetwork.getInstance().listenProtocol(c.ROLE_CLIENT_ENUM.P_Role_SetSelfSelect,this.syncRoleSetSelfSelect,this),a.ClientNetwork.getInstance().listenProtocol(c.ROLE_CLIENT_ENUM.P_Role_TakeTask,this.syncGetTaskRewardsData,this),a.ClientNetwork.getInstance().listenLocalMessage(u.LOCAL_MESSAGE.LocalMsg_SyncCostGet,function(){d.default.Instance.emit(l.default.ReturnBackRechargeSuccess),d.default.Instance.emit(l.default.RefreshAnniversaryReturnBackRedpoint)},this),a.ClientNetwork.getInstance().listenLocalMessage(u.LOCAL_MESSAGE.LocalMsg_RechargeSuccess,function(){d.default.Instance.emit(l.default.ReturnBackRechargeSuccess)},this)},e.syncAnniversaryData=function(e){e.resetPos();var t=new s.S_Activity_SyncAnniversaryTrialData;t.read(e)&&(0==t.error?r.default.Instance.syncAnniversaryData(t):n.G.StringManager.PopString("\u540c\u6b65\u5468\u5e74\u5e86\u6570\u636e\u9519\u8bef Error "+t.error))},e.syncReturnBackData=function(e){e.resetPos();var t=new s.S_Activity_SyncReturnBackData;t.read(e)&&(0==t.error?r.default.Instance.syncReturnBackData(t):n.G.StringManager.PopString("\u540c\u6b65\u5468\u56de\u6d41\u6d3b\u52a8\u6570\u636e\u9519\u8bef Error "+t.error))},e.callReturnBackHelpNew=function(){var e=new s.C_Activity_ReturnBackHelpNew;e.newServerGroupId=r.default.Instance.getHelpNewServerGroupId(),a.ClientNetwork.getInstance().Send(s.ACTIVITY_CLIENT_ENUM.P_Activity_ReturnBackHelpNew,e)},e.syncReturnBackHelpNewData=function(e){e.resetPos();var t=new s.S_Activity_ReturnBackHelpNew;t.read(e)&&(0==t.errorcode?(d.default.Instance.emit(l.default.SyncActivityReturnBackHelpNew),n.G.StringManager.PopString("\u52a9\u529b\u6210\u529f")):n.G.StringManager.PopString("\u52a9\u529b\u5931\u8d25 Error "+t.errorcode))},e.callRoleSetSelfSelect=function(e){var t=new c.C_Role_SetSelfSelect;t.type=e.type,t.selectItemId=e.selectItemId,a.ClientNetwork.getInstance().Send(c.ROLE_CLIENT_ENUM.P_Role_SetSelfSelect,t)},e.syncRoleSetSelfSelect=function(e){e.resetPos();var t=new c.S_Role_SetSelfSelect;t.read(e)&&(0==t.errorcode?d.default.Instance.emit(l.default.AnniversaryReturnBackSelectCard):2==t.errorcode?n.G.StringManager.PopString("\u5df2\u9009\u62e9\u8be5\u9053\u5177"):n.G.StringManager.PopString("\u81ea\u9009\u5361\u9519\u8bef Error "+t.errorcode))},e.callGetTaskRewards=function(e){var t=new c.C_Role_TakeTask;t.taskID=e,a.ClientNetwork.getInstance().Send(c.ROLE_CLIENT_ENUM.P_Role_TakeTask,t)},e.syncGetTaskRewardsData=function(e){e.resetPos();var t=new c.S_Role_TakeTask;if(t.read(e)){if(0!=t.errorcode)return n.G.StringManager.PopString("\u9886\u53d6\u5956\u52b1\u5931\u8d25 Error "+t.errorcode);h.default.addPopView("BaseCtrl","AcquirePopupView","AcquirePopupView",{items:t.prize}),d.default.Instance.emit(l.default.SyncActivityReturnBackWinTaskData)}},i([p],e)}();o.default=f,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../common/EventConst":"EventConst","../../modules/base/GameView":"GameView","../../modules/manager/EventManager":"EventManager","../../network/ClientNetwork":"ClientNetwork","../../network/LocalMessage":"LocalMessage","../../network/protocol/ActivityProtocols":"ActivityProtocols","../../network/protocol/RoleProtocols":"RoleProtocols","./AnniversaryModule":"AnniversaryModule"}],AnniversaryIntroduceView:[function(e,t,o){"use strict";cc._RF.push(t,"9e01eGjADtHHZ+EMepn1v1S","AnniversaryIntroduceView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=cc._decorator,l=c.ccclass,d=(c.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.path=function(){return"ui/anniversary/prefab/AnniversaryIntroduce"},n([s.Register_Class,l],t)}(r.default));o.default=d,cc._RF.pop()},{"../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators"}],AnniversaryMainView:[function(e,t,o){"use strict";cc._RF.push(t,"91b35FhSA1Os67Q1CTxR56e","AnniversaryMainView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=e("../../modules/base/GameView"),l=e("../../common/CombatModule"),d=e("../../common/PlayerModule"),u=e("../../Global/GameGlobal"),h=e("../../network/protocol/TypeProtocols"),p=e("../../StaticData/ActivityTableData"),f=e("../../network/protocol/ActivityProtocols"),g=e("./AnniversaryModule"),m=e("../../StaticData/AnniversaryCardTableData"),_=e("../../utils/GameTools"),y=e("../../StaticData/HeroSkinTableData"),v=e("../heroCardBag/HeroSkinUtils"),C=e("../../common/EventConst"),S=e("../../modules/manager/EventManager"),T=e("../../utils/GameUtils"),I=e("../../common/CommandValue"),N=e("../../utils/GamePlatform"),b=cc._decorator,w=b.ccclass,E=b.property,P=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.m_CardLayout=null,t.m_TimeLab=null,t.m_MatchCountLab=null,t.m_ReturnBackNode=null,t.m_WinTaskRedpointNode=null,t.m_ReturnBackRedpointNode=null,t.m_BoxRedpointNode=null,t.m_TotalCupNumLab=null,t.m_BigBlueTipLab=null,t}return a(t,e),t.path=function(){return"ui/anniversary/prefab/AnniversaryMain"},t.prototype.onLoad=function(){S.default.Instance.on(C.default.RefreshAnniversaryWinTaskRedpoint,this.onRefreshWinTaskRedpoint,this),S.default.Instance.on(C.default.RefreshAnniversaryReturnBackRedpoint,this.onRefreshReturnBackRedpoint,this),S.default.Instance.on(C.default.RefreshAnniversaryBoxRedpoint,this.showBoxRedPoint,this),S.default.Instance.on(C.default.SyncActivityReturnBackOffState,this.syncReturnBackState,this)},t.prototype.start=function(){this.initAnniversaryCardGroup(),this.onRefreshAnniversaryEndTime(),this.schedule(this.onRefreshAnniversaryEndTime,1);var e=p.ActivityTableData.getById(f.ACTIVITY_ID_ENUM.P_Activity_Anniversary);this.m_MatchCountLab.string=(e.param3-g.default.Instance.getAnniversaryMatchCount()).toString(),this.m_ReturnBackNode.active=g.default.Instance.checkReturnBackOpenState();var t=d.default.getRoleAttrValByKey(h.ROLE_ATTR_VALUES.ROLE_ATTR_CREATETIME),o=d.default.getServersTime2();if(1==this.m_ReturnBackNode.active){var i=o-t;Math.floor(i/86400)<p.ActivityTableData.getById(f.ACTIVITY_ID_ENUM.P_Activity_ReturnBack).param2&&(this.m_ReturnBackNode.active=!1)}this.showBoxRedPoint(),this.m_TotalCupNumLab.string=d.default.getRoleAttrValByKey(h.ROLE_ATTR_VALUES.ROLE_ATTR_ANNIVERSARY_TRIAL_SCORE),S.default.Instance.emit(C.default.RefreshAnniversaryReturnBackRedpoint),S.default.Instance.emit(C.default.RefreshAnniversaryWinTaskRedpoint),T.setLocalData("SaveAnniversaryRedFlag","1")},t.prototype.refresBigBlueTime=function(){if("bigBlue"==N.GamePlatform.getMiYaVideoTypeNoSet()){var e=d.default.getServersTime(),t=g.default.Instance.getAnniversaryTime();if(!t||t.length<=0)return;if(e>=t[0]&&e<=t[1]){var o=p.ActivityTableData.getById(f.ACTIVITY_ID_ENUM.P_Activity_Anniversary),i=o.param4.toString().slice(0,-2),a=o.param5.toString().slice(0,-2),n=new Date(1e3*e);if(n.getHours()>=Number(i)&&n.getHours()<Number(a))this.m_BigBlueTipLab.node.active=!1,this.m_MatchCountLab.node.parent.active=!0;else{var r="\u6bcf\u65e5"+i+"\u70b9\u81f3"+a+"\u70b9\u5f00\u542f\u5339\u914d";this.m_BigBlueTipLab.string=r,this.m_BigBlueTipLab.node.active=!0,this.m_MatchCountLab.node.parent.active=!1}}}else this.m_BigBlueTipLab.node.active=!1},t.prototype.syncReturnBackState=function(){var e=d.default.checkModulerOnOffState(I.ModulerViewOnOff.AnniversaryReturnBack);if(0==e){var t=c.default.getViewByName("AnniversaryReturnBackView");t&&t.view&&t.view.closeView()}if(0==g.default.Instance.getReturnBackOpenState())return this.m_ReturnBackNode.active=!1;this.m_ReturnBackNode.active=e;var o=d.default.getRoleAttrValByKey(h.ROLE_ATTR_VALUES.ROLE_ATTR_CREATETIME),i=d.default.getServersTime2();if(1==this.m_ReturnBackNode.active){var a=i-o;Math.floor(a/86400)<p.ActivityTableData.getById(f.ACTIVITY_ID_ENUM.P_Activity_ReturnBack).param2&&(this.m_ReturnBackNode.active=!1)}},t.prototype.showBoxRedPoint=function(){var e;e=g.default.Instance.checkBoxRedPoint(),this.m_BoxRedpointNode.active=e},t.prototype.initAnniversaryCardGroup=function(){var e,t=this;this.m_CardLayout.node.destroyAllChildren();var o=g.default.Instance.getAnniversaryCardGroupId(),i=null===(e=m.AnniversaryCardTableData.getById(o))||void 0===e?void 0:e.cardGroup;i&&i.length>0&&i.forEach(function(e){var o=v.default.Instance.getCurSkinIdByHeroUUID(null,e);if(o>0){var i=y.HeroSkinTableData.getById(o);null!=i&&(e=i.itemId)}_.default.createNormalItems(e,1,t.m_CardLayout.node,function(e){e.scale=.55,e.getChildByName("num").active=!1})})},t.prototype.onRefreshAnniversaryEndTime=function(){var e=this.m_TimeLab,t=d.default.getServersTime(),o=g.default.Instance.getAnniversaryTime();if(!o||o.length<=0)return e.string="\u6d3b\u52a8\u5df2\u7ed3\u675f";var i=o[1]-t;if(i<=0)return this.unschedule(this.onRefreshAnniversaryEndTime),e.string="\u6d3b\u52a8\u5df2\u7ed3\u675f";e.string=u.G.StringManager.getString("ROYALE_ACTIVITY_END_TIME_TIP")+function(e){var t=e%864e5/36e5,o=e%36e5/6e4,a=e%6e4/1e3;return i>=86400?parseInt((e/864e5).toString())+" \u5929 "+parseInt(t.toString())+" \u5c0f\u65f6 "+parseInt(o.toString())+" \u5206 ":i>=3600?parseInt(t.toString())+" \u5c0f\u65f6 "+parseInt(o.toString())+" \u5206 "+parseInt(a.toString())+" \u79d2 ":i>=60?parseInt(o.toString())+" \u5206 "+parseInt(a.toString())+" \u79d2 ":parseInt(a.toString())+" \u79d2 "}.call(this,1e3*i),this.refresBigBlueTime()},t.prototype.onRefreshWinTaskRedpoint=function(){this.m_WinTaskRedpointNode.active=g.default.Instance.checkWinTaskRewards()},t.prototype.onRefreshReturnBackRedpoint=function(){var e=!1;if(1==g.default.Instance.checkReturnBackOpenState()){var t=d.default.getCostGetDataByID(103);(!t||t<=0)&&(e=!0)}this.m_ReturnBackRedpointNode.active=e},t.prototype.onClickRankCallBack=function(){c.default.addPopView("BaseCtrl","AnniversaryRankView","AnniversaryRankView")},t.prototype.checkActivityIsEnd=function(){var e=d.default.getServersTime(),t=g.default.Instance.getAnniversaryTime();if(!t||t.length<=0)return!0;if("bigBlue"==N.GamePlatform.getMiYaVideoTypeNoSet()&&e>=t[0]&&e<=t[1]){var o=p.ActivityTableData.getById(f.ACTIVITY_ID_ENUM.P_Activity_Anniversary),i=o.param4.toString().slice(0,-2),a=o.param5.toString().slice(0,-2),n=new Date(1e3*e);if(!(n.getHours()>=Number(i)&&n.getHours()<Number(a))){var r="\u6bcf\u65e5"+i+"\u70b9\u81f3"+a+"\u70b9\u5f00\u542f\u5339\u914d";return u.G.StringManager.PopString(r),!0}}return t[1]-e<=0||0==g.default.Instance.checkAnniversaryOpenState()},t.prototype.onClickMatchCallBack=function(){var e=p.ActivityTableData.getById(f.ACTIVITY_ID_ENUM.P_Activity_Anniversary);if(d.default.getRoleAttrValByKey(h.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE)<e.param1)return u.G.StringManager.PopString(u.G.StringManager.getString("ANNIVERSARY_BATTLE_TIPS",e.param1));if(g.default.Instance.getAnniversaryMatchCount()>=e.param3)return u.G.StringManager.PopWorldString("goldLeague_word_19");if(1==this.checkActivityIsEnd()){if("bigBlue"==N.GamePlatform.getMiYaVideoTypeNoSet())return;return u.G.StringManager.PopString(u.G.StringManager.getString("ANNIVERSARY_BATTLE_TIPS1"))}c.default.addPopView("BaseCtrl","MatchMainView","MatchMainView",{ntype:l.CombatType.SOLO})},t.prototype.onClickWinTaskCallBack=function(){if("bigBlue"!=N.GamePlatform.getMiYaVideoTypeNoSet()&&1==this.checkActivityIsEnd())return u.G.StringManager.PopString(u.G.StringManager.getString("ANNIVERSARY_BATTLE_TIPS1"));c.default.addPopView("BaseCtrl","AnniversaryWinTaskView","AnniversaryWinTaskView")},t.prototype.onClickRegressionGiftCallBack=function(){if("bigBlue"!=N.GamePlatform.getMiYaVideoTypeNoSet()&&1==this.checkActivityIsEnd())return u.G.StringManager.PopString(u.G.StringManager.getString("ANNIVERSARY_BATTLE_TIPS1"));c.default.addPopView("ShopMainCtrl","AnniversaryReturnBackView","AnniversaryReturnBackView")},t.prototype.onClickHelpExplainCallBack=function(){c.default.addPopView("BaseCtrl","AnniversaryIntroduceView","AnniversaryIntroduceView")},t.prototype.onClickOpenBoxView=function(){if("bigBlue"!=N.GamePlatform.getMiYaVideoTypeNoSet()&&1==this.checkActivityIsEnd())return u.G.StringManager.PopString(u.G.StringManager.getString("ANNIVERSARY_BATTLE_TIPS1"));c.default.addPopView("ShopMainCtrl","AnniversaryBattlePassView","AnniversaryBattlePassView")},t.prototype.onClickShopCallBack=function(){if("bigBlue"!=N.GamePlatform.getMiYaVideoTypeNoSet()&&1==this.checkActivityIsEnd())return u.G.StringManager.PopString(u.G.StringManager.getString("ANNIVERSARY_BATTLE_TIPS1"));c.default.addPopView("BaseCtrl","AnniversaryShopView","AnniversaryShopView")},t.prototype.onClickRechargeCallBack=function(){if("bigBlue"!=N.GamePlatform.getMiYaVideoTypeNoSet()&&1==this.checkActivityIsEnd())return u.G.StringManager.PopString(u.G.StringManager.getString("ANNIVERSARY_BATTLE_TIPS1"));c.default.addPopView("ShopMainCtrl","AnniversaryRechargeView","AnniversaryRechargeView")},t.prototype.onCloseViewCallBack=function(){S.default.Instance.emit(C.default.RefreshAnniversaryMainRedpoint),this.closeView()},t.prototype.onDestroy=function(){S.default.Instance.off(this,C.default.RefreshAnniversaryWinTaskRedpoint),S.default.Instance.off(this,C.default.RefreshAnniversaryReturnBackRedpoint),S.default.Instance.off(this,C.default.RefreshAnniversaryBoxRedpoint)},n([E(cc.Layout)],t.prototype,"m_CardLayout",void 0),n([E(cc.Label)],t.prototype,"m_TimeLab",void 0),n([E(cc.Label)],t.prototype,"m_MatchCountLab",void 0),n([E(cc.Node)],t.prototype,"m_ReturnBackNode",void 0),n([E(cc.Node)],t.prototype,"m_WinTaskRedpointNode",void 0),n([E(cc.Node)],t.prototype,"m_ReturnBackRedpointNode",void 0),n([E(cc.Node)],t.prototype,"m_BoxRedpointNode",void 0),n([E(cc.Label)],t.prototype,"m_TotalCupNumLab",void 0),n([E(cc.Label)],t.prototype,"m_BigBlueTipLab",void 0),n([s.Register_Class,w],t)}(r.default);o.default=P,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/ActivityTableData":"ActivityTableData","../../StaticData/AnniversaryCardTableData":"AnniversaryCardTableData","../../StaticData/HeroSkinTableData":"HeroSkinTableData","../../common/CombatModule":"CombatModule","../../common/CommandValue":"CommandValue","../../common/EventConst":"EventConst","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/base/GameView":"GameView","../../modules/manager/EventManager":"EventManager","../../network/protocol/ActivityProtocols":"ActivityProtocols","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/GamePlatform":"GamePlatform","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils","../heroCardBag/HeroSkinUtils":"HeroSkinUtils","./AnniversaryModule":"AnniversaryModule"}],AnniversaryModule:[function(e,t,o){"use strict";cc._RF.push(t,"d17fd/R+9pIvpvMeNs1fVM2","AnniversaryModule");var i=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var a=e("../../network/protocol/ActivityProtocols"),n=e("../../StaticData/ActivityTableData"),r=e("../../common/PlayerModule"),s=e("../../StaticData/AnniversaryCardTableData"),c=e("../../common/PlayerModule"),l=e("../../StaticData/AnniversaryBattlePassTableData"),d=e("../../utils/GameUtils"),u=e("../../network/protocol/TypeProtocols"),h=e("../../network/protocol/ActivityProtocols"),p=e("../../StaticData/TaskTableData"),f=e("../../utils/GameUtils"),g=e("../../common/CommandValue"),m=e("../../utils/GamePlatform"),_=cc._decorator.ccclass,y=function(){function e(){this.m_tAnniversaryData=null,this.m_tReturnBackData=null}var t;return t=e,Object.defineProperty(e,"Instance",{get:function(){return null==t._instance&&(t._instance=new t),t._instance},enumerable:!1,configurable:!0}),e.prototype.syncAnniversaryData=function(e){this.m_tAnniversaryData=e},e.prototype.AnniversaryBoxData=function(){return this.m_tAnniversaryData},e.prototype.checkAnniversaryOpenState=function(){if(0==r.default.checkModulerOnOffState(g.ModulerViewOnOff.Anniversary))return console.log("checkAnniversaryOpenState1"),!1;if(!this.m_tAnniversaryData)return console.log("checkAnniversaryOpenState2"),!1;if(console.log("checkAnniversaryOpenState3"),"bigBlue"==m.GamePlatform.getMiYaVideoTypeNoSet()){var e=this.getAnniversaryTime();if(r.default.getServersTime()-e[1]<0)return!0}return this.m_tAnniversaryData.isOpen},e.prototype.getAnniversaryMatchCount=function(){return this.m_tAnniversaryData?this.m_tAnniversaryData.dayMatchNum:0},e.prototype.checkAnniversaryRedpointState=function(){if(0==this.checkAnniversaryOpenState())return!1;var e=n.ActivityTableData.getById(a.ACTIVITY_ID_ENUM.P_Activity_Anniversary);if(this.m_tAnniversaryData.isOpen&&this.m_tAnniversaryData.dayMatchNum<e.param3){var t=f.getLocalData("SaveAnniversaryRedFlag");if(t&&"0"==t)return!0}if(1==this.checkWinTaskRewards())return!0;if(1==this.checkReturnBackOpenState()){var o=r.default.getCostGetDataByID(103);if(!o||o<=0)return!0}return 1==this.checkBoxRedPoint()},e.prototype.checkBoxRedPoint=function(){if(0==this.m_tAnniversaryData.isOpen)return!1;var e=this.checkReceiveSociatyBoxPrize();return!!e&&e.length>0},e.prototype.checkWinTaskRewards=function(){var e=!1;return r.default.getRoleTaskData().tasks.forEach(function(t){var o=p.TaskTableData.getById(t.taskID);o&&o.clientType==u.TASK_CLIENT_TYPE.TASK_CLIENT_TYPE_ACHIEVEMENT_ANNIVERSARY_BATTLE&&t.taskState==u.TASK_STATE.TASK_STATE_EXECUTING&&t.taskCount>=o.finishCount&&(e=!0)}),e},e.prototype.getAnniversaryMaxScore=function(){return this.m_tAnniversaryData?this.m_tAnniversaryData.score:0},e.prototype.getAnniversaryCardGroupId=function(){return this.m_tAnniversaryData?this.m_tAnniversaryData.refleshRobotId:0},e.prototype.getAnniversaryTime=function(){var e=new Array,t=n.ActivityTableData.getById(a.ACTIVITY_ID_ENUM.P_Activity_Anniversary);return e.push(t.param8),e.push(t.param9),e},e.prototype.getAnniversaryBattleCards=function(){var e=this;if(this.getAnniversaryCardGroupId()<=0)return[];var t=function(e){var t=1;return r.default.getHeroCarData().forEach(function(o){o&&1==o.bHeroLock&&o.heroId==e&&(t=o.heroLevel)}),t},o=[],i=s.AnniversaryCardTableData.getById(this.getAnniversaryCardGroupId()).cardGroup;return i&&i.length>0&&i.forEach(function(i,a){var n=new c.HeroCarModule;n.heroId=i,n.heroLevel=t.call(e,i),o[a]=n}),o},e.prototype.checkReceiveSociatyBoxPrize=function(){var e=this,t=[],o=Number(d.getConfigIntValue("anniversary_battlepass_coin_itemid")),i=r.default.getItemCountByBag(o),a=[];return l.AnniversaryBattlePassTableData.getDataMap().forEach(function(e){a.push(e)}),a.forEach(function(o){var a=0,n=e.checkBoxReceiveState(o.id,1);0!=n&&n||i>=o.coinNum&&(a=1);var s,c=0,l=e.checkBoxReceiveState(o.id,2);0!=l&&l||i>=o.coinNum&&1==r.default.getRoleAttrValByKey(u.ROLE_ATTR_VALUES.ROLE_ATTR_ANNIVERSARY_BATTLEPASS)&&(c=1),1==a&&((s=new h.T_Activity_AnniversaryTrialGetBoxsData).index=o.id,s.type=1,t.push(s)),1==c&&((s=new h.T_Activity_AnniversaryTrialGetBoxsData).index=o.id,s.type=2,t.push(s))}),t},e.prototype.checkBoxReceiveState=function(e,t){if(!this.m_tAnniversaryData)return!1;var o=this.m_tAnniversaryData.normalPrize;return 2==t&&(o=this.m_tAnniversaryData.superprize),!!o.has(e)&&o.get(e)},e.prototype.syncReturnBackData=function(e){this.m_tReturnBackData=e},e.prototype.checkReturnBackOpenState=function(){return 0!=r.default.checkModulerOnOffState(g.ModulerViewOnOff.AnniversaryReturnBack)&&!!this.m_tReturnBackData&&this.m_tReturnBackData.isOpen},e.prototype.getReturnBackOpenState=function(){return!!this.m_tReturnBackData&&this.m_tReturnBackData.isOpen},e.prototype.getHelpNewServerGroupId=function(){return this.m_tReturnBackData?this.m_tReturnBackData.newServerGroupId:0},e.prototype.getHelpNewServerRechargeNum=function(){return this.m_tReturnBackData?this.m_tReturnBackData.rechargeNum:0},e.prototype.getHelpNewServerIsHelpState=function(){return!!this.m_tReturnBackData&&this.m_tReturnBackData.isHelp},e._instance=null,t=i([_],e)}();o.default=y,cc._RF.pop()},{"../../StaticData/ActivityTableData":"ActivityTableData","../../StaticData/AnniversaryBattlePassTableData":"AnniversaryBattlePassTableData","../../StaticData/AnniversaryCardTableData":"AnniversaryCardTableData","../../StaticData/TaskTableData":"TaskTableData","../../common/CommandValue":"CommandValue","../../common/PlayerModule":"PlayerModule","../../network/protocol/ActivityProtocols":"ActivityProtocols","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/GamePlatform":"GamePlatform","../../utils/GameUtils":"GameUtils"}],AnniversaryRankListTableData:[function(e,t,o){"use strict";cc._RF.push(t,"47bc2H3AbpKZoszsBR5JuW7","AnniversaryRankListTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.AnniversaryRankListTableData=void 0;var i=e("../TableReader"),a=e("./BaseTableData"),n=function(){function e(){this.id=0,this.rankMin=0,this.rankMax=0,this.seasonId=0,this.mailid=0,this.prize=new Array}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.rankMin=e.getNumber(),this.rankMax=e.getNumber(),this.seasonId=e.getNumber(),this.mailid=e.getNumber();for(var o=e.getString(),n=new i.TableReader(o);n.getPos()<n.getLen();){var r=new a.DropItem;r.readOriginal(n),this.prize.push(r)}},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"AnniversaryRankListTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.AnniversaryRankListTableData=n,cc._RF.pop()},{"../TableReader":"TableReader","./BaseTableData":"BaseTableData"}],AnniversaryRankView:[function(e,t,o){"use strict";cc._RF.push(t,"a0684cVh8tLFq+i2IXOPIZj","AnniversaryRankView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=e("../../utils/List"),l=e("../../utils/GameTools"),d=e("../../network/protocol/TypeProtocols"),u=e("../../common/PlayerModule"),h=e("../../StaticData/AnniversaryRankListTableData"),p=e("./AnniversaryModule"),f=e("../../Global/GameGlobal"),g=e("../../StaticData/TaskTableData"),m=e("../../utils/ConfigUtils"),_=e("../../utils/ResourcesManager"),y=e("./AnniversaryCtrl"),v=e("../../common/EventConst"),C=e("../../modules/manager/EventManager"),S=e("../../network/protocol/TypeProtocols"),T=cc._decorator,I=T.ccclass,N=T.property,b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.rankListPanelNode=null,t.myRankInfoNode=null,t.rewardListPanelNode=null,t.winTaskListPanelNode=null,t.rewardItemPrefab=null,t.m_taskItemNode=null,t.m_WinTaskRewardRedpointNode=null,t.m_taskScrollView=null,t.m_tRankListData=[],t.m_nRankPageIdx=1,t.m_nRankMaxPage=0,t}return a(t,e),t.path=function(){return"ui/anniversary/prefab/AnniversaryRankMain"},t.prototype.start=function(){this.callAnniversaryRank(),this.initAnniversaryRewards(),this.rankListPanelNode.node.on("bounce-bottom",this.onScrollBottom,this),this.initAnniversaryWinTaskList(),C.default.Instance.on(v.default.SyncActivityReturnBackWinTaskData,this.initAnniversaryWinTaskList,this)},t.prototype.onScrollBottom=function(){this.m_nRankPageIdx>=this.m_nRankMaxPage||(this.m_nRankPageIdx++,this.callAnniversaryRank())},t.prototype.callAnniversaryRank=function(){var e=this,t=l.default.getDevelopRankListUrl();t+="?",t+="ranktype="+d.RANKLIST_TYPE.RANKLIST_TYPE_ANNIVERSARY_TRIAL,t+="&roleid="+u.default.uuidTransformRoieId(),t+="&page="+this.m_nRankPageIdx;var o=new XMLHttpRequest;o.onreadystatechange=function(){if(4==o.readyState&&o.status>=200&&o.status<400){var t=o.responseText.toString();t=(t=(t=t.replace('"','"')).replace("\ufeff","")).replace(" ","");var i=JSON.parse(t),a=i.page;e.m_nRankMaxPage=i.maxpage,Number(i.ranktype)==d.RANKLIST_TYPE.RANKLIST_TYPE_ANNIVERSARY_TRIAL&&Number(a)==e.m_nRankPageIdx&&e.resolvingAnniversaryRankData(i)}},o.timeout=3e3,o.ontimeout=function(){cc.isValid(e)&&f.G.StringManager.PopString("\u6392\u884c\u699c\u8bf7\u6c42\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\uff01")},o.onerror=function(){cc.isValid(e)&&f.G.StringManager.PopString("\u6392\u884c\u699c\u8bf7\u6c42\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\uff01")},o.open("GET",t,!0),o.send()},t.prototype.onRefreshRankEvent=function(e,t){var o=this.m_tRankListData[t];e.getComponent("RankListItem").initData(d.RANKLIST_TYPE.RANKLIST_TYPE_ANNIVERSARY_TRIAL,t+1,o)},t.prototype.resolvingAnniversaryRankData=function(e){1==Number(e.page)&&(this.m_tRankListData=[]);var t=this.myRankInfoNode.getChildByName("my_rank_num").getComponent(cc.Label),o=this.myRankInfoNode.getChildByName("my_score_label").getComponent(cc.Label),i=this.myRankInfoNode.getChildByName("my_win_label").children[0].getComponent(cc.Label),a=0,n=0;if("playerrank"in e&&(t.string=e.playerrank,"playerdata"in e)){var r=JSON.parse(e.playerdata);a=r.score,n=r.winrate}if(0==Number(a)&&(a=u.default.getRoleAttrValByKey(S.ROLE_ATTR_VALUES.ROLE_ATTR_ANNIVERSARY_TRIAL_SCORE)),0==n){var s=u.default.getRoleInfoData(),c=0,l=0;s.fightData.typeData.get(S.FIGHT_TYPE.FIGHT_TYPE_ANNIVERSARY_TRIAL)&&(c=s.fightData.typeData.get(S.FIGHT_TYPE.FIGHT_TYPE_ANNIVERSARY_TRIAL).totalWinNum,l=s.fightData.typeData.get(S.FIGHT_TYPE.FIGHT_TYPE_ANNIVERSARY_TRIAL).totalLostNum+c),l>0&&(n=Math.floor(c/l*100))}if(o.string=a.toString(),i.string=n.toString()+"%","ranklist"in e){var d=e.ranklist;for(var h in d)Object.prototype.hasOwnProperty.call(d,h)&&this.m_tRankListData.push(d[h])}this.rankListPanelNode.numItems=this.m_tRankListData.length},t.prototype.initAnniversaryRewards=function(){var e=this,t=[];h.AnniversaryRankListTableData.getDataMap().forEach(function(e){t.push(e)}),t.forEach(function(t,o){var i=cc.instantiate(e.rewardItemPrefab);i.parent=e.rewardListPanelNode.getComponent(cc.ScrollView).content,i.getComponent("ActivityGoldenLeagueRewardtem").show(t,o),i.scale=.97})},t.prototype.initAnniversaryWinTaskList=function(){var e=this;this.m_taskScrollView.content.destroyAllChildren();var t=new Array;u.default.getRoleTaskData().tasks.forEach(function(e){var o=g.TaskTableData.getById(e.taskID);o&&o.clientType==d.TASK_CLIENT_TYPE.TASK_CLIENT_TYPE_ACHIEVEMENT_ANNIVERSARY_BATTLE&&t.push(e)}),t.forEach(function(t){e.createTaskItemInfo(t)}),C.default.Instance.emit(v.default.RefreshAnniversaryWinTaskRedpoint),this.m_WinTaskRewardRedpointNode.active=p.default.Instance.checkWinTaskRewards()},t.prototype.createTaskItemInfo=function(e){var t=cc.instantiate(this.m_taskItemNode);t.parent=this.m_taskScrollView.content,t.active=!0;var o=g.TaskTableData.getById(e.taskID);t.getChildByName("task_progress").getChildByName("task_desc").getComponent(cc.Label).string=f.G.StringManager.getWorldString(o.info2,o.info3);var i=t.getChildByName("rewardNode"),a=m.default.getInstance().getDorpItemsByID(o.prizeID).dropRandom.split("|");for(var n in a){var r=a[n].split("#"),s=r[0],c=m.default.getInstance().getItemByID(s).icon;_.default.loadSprite(c,i.getComponent(cc.Sprite)),i.children[0].getComponent(cc.Label).string=r[1]}var u=t.getChildByName("task_progress").getChildByName("task_progressBar");u.getComponent(cc.ProgressBar).progress=e.taskCount/o.finishCount,u.getComponent(cc.ProgressBar).progress>=1?u.getChildByName("num").getComponent(cc.Label).string=o.finishCount+"/"+o.finishCount:u.getChildByName("num").getComponent(cc.Label).string=e.taskCount+"/"+o.finishCount,e.taskState==d.TASK_STATE.TASK_STATE_FINISH?(t.getChildByName("finishNode").active=!0,u.getComponent(cc.ProgressBar).progress=1,u.getChildByName("num").getComponent(cc.Label).string=o.finishCount+"/"+o.finishCount):u.getComponent(cc.ProgressBar).progress>=1?t.getChildByName("receiveBtn").active=!0:t.getChildByName("noFinishLab").active=!0,t.getChildByName("receiveBtn").TaskId=e.taskID,l.default.registerTouchEvent(t.getChildByName("receiveBtn"),function(e){y.default.callGetTaskRewards(e.target.TaskId)})},t.prototype.onClickRankCallBack=function(e){1!=this.rankListPanelNode.node.active&&(this.rankListPanelNode.node.active=!0,this.rewardListPanelNode.active=!1,this.myRankInfoNode.active=!0,this.winTaskListPanelNode.active=!1,e.target.parent.children.forEach(function(e){e.getChildByName("lab").color=(new cc.Color).fromHEX("FFFF90")}),e.target.getChildByName("lab").color=cc.Color.WHITE)},t.prototype.onClickRewardCallBack=function(e){1!=this.rewardListPanelNode.active&&(this.rankListPanelNode.node.active=!1,this.rewardListPanelNode.active=!0,this.myRankInfoNode.active=!1,this.winTaskListPanelNode.active=!1,e.target.parent.children.forEach(function(e){e.getChildByName("lab").color=(new cc.Color).fromHEX("FFFF90")}),e.target.getChildByName("lab").color=cc.Color.WHITE)},t.prototype.onClickWinTaskRewardCallBack=function(e){1!=this.winTaskListPanelNode.active&&(this.rankListPanelNode.node.active=!1,this.winTaskListPanelNode.active=!0,this.myRankInfoNode.active=!1,this.rewardListPanelNode.active=!1,e.target.parent.children.forEach(function(e){e.getChildByName("lab").color=(new cc.Color).fromHEX("FFFF90")}),e.target.getChildByName("lab").color=cc.Color.WHITE)},t.prototype.onDestroy=function(){C.default.Instance.off(this,v.default.SyncActivityReturnBackWinTaskData)},n([N(c.default)],t.prototype,"rankListPanelNode",void 0),n([N(cc.Node)],t.prototype,"myRankInfoNode",void 0),n([N(cc.Node)],t.prototype,"rewardListPanelNode",void 0),n([N(cc.Node)],t.prototype,"winTaskListPanelNode",void 0),n([N(cc.Prefab)],t.prototype,"rewardItemPrefab",void 0),n([N(cc.Node)],t.prototype,"m_taskItemNode",void 0),n([N(cc.Node)],t.prototype,"m_WinTaskRewardRedpointNode",void 0),n([N(cc.ScrollView)],t.prototype,"m_taskScrollView",void 0),n([s.Register_Class,I],t)}(r.default);o.default=b,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/AnniversaryRankListTableData":"AnniversaryRankListTableData","../../StaticData/TaskTableData":"TaskTableData","../../common/EventConst":"EventConst","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/manager/EventManager":"EventManager","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/ConfigUtils":"ConfigUtils","../../utils/GameTools":"GameTools","../../utils/List":"List","../../utils/ResourcesManager":"ResourcesManager","./AnniversaryCtrl":"AnniversaryCtrl","./AnniversaryModule":"AnniversaryModule"}],AnniversaryRechargeView:[function(e,t,o){"use strict";cc._RF.push(t,"4124exGHRpB/pZm9+YrU2gQ","AnniversaryRechargeView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../common/PlayerModule"),s=e("../../Global/GameGlobal"),c=e("../../modules/base/BaseView"),l=e("../../modules/base/Decorators"),d=e("../../modules/base/GameView"),u=e("../../network/ClientNetwork"),h=e("../../network/protocol/RechargeProtocols"),p=e("../../network/protocol/RoleProtocols"),f=e("../../StaticData/LuckyGiftSelectTableData"),g=e("../../StaticData/RechargeTableData"),m=e("../../utils/ConfigUtils"),_=e("../../utils/GameTools"),y=e("../../utils/GameUtils"),v=cc._decorator,C=v.ccclass,S=v.property,T=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.m_btn_buy=null,t.m_btn_buy2=null,t.m_btn_buy3=null,t.m_box1=null,t.m_box2=null,t.m_box3=null,t.rechargeId_buy1=0,t.rechargeId_buy2=0,t.rechargeId_buy3=0,t.select_index=0,t}return a(t,e),t.path=function(){return"ui/anniversary/prefab/AnniversaryRecharge"},t.prototype.onLoad=function(){},t.prototype.start=function(){var e=this;u.ClientNetwork.getInstance().listenProtocol(h.RECHARGE_CLIENT_ENUM.P_Recharge_Role_Recharge,function(){e.initBuyViewDay1(),e.initBuyViewDay2(),e.initBuyViewDay3()},this),u.ClientNetwork.getInstance().listenProtocol(p.ROLE_CLIENT_ENUM.P_Role_SetSelfSelect,function(){1==e.select_index?e.initBuyViewDay1():2==e.select_index?e.initBuyViewDay2():e.initBuyViewDay3()},this),this.initBuyViewDay1(),this.initBuyViewDay2(),this.initBuyViewDay3();for(var t=function(t){_.default.registerTouchEvent(o.node.getChildByName("newBoxRechargeNode").getChildByName("box"+t).getChildByName("select"),function(){var o=32+t,i=r.default.getRoleRechargeData().get(o),a=g.RechargeTableData.getById(o);if(i&&i.dayNum>a.limitMaxDayNum)return s.G.StringManager.PopString("\u60a8\u5df2\u8d2d\u4e70\u8fc7\u8be5\u793c\u5305\uff0c\u65e0\u6cd5\u9009\u62e9");var n=y.getConfigIntValue("battlePass_choose_gold"),c=f.LuckyGiftSelectTableData.getById(Number(n)).prize;c=y.clone(c),e.select_index=t,c.forEach(function(e){var t=Number(y.getConfigIntValue("SelfSelect_"+o));e.itemNum=null!=t?t:1});for(var l=c.length-1;l>=0;l--)2!=m.default.getInstance().getItemByID(c[l].itemID).type&&c.splice(l,1);d.default.addPopView("BaseCtrl","LuckyGiftSelectRewardView","LuckyGiftSelectRewardView",{tRewards:c,index:o,isEveryDayReacharge:!1,parent:e,callBack:function(e,t){if(0!=e){var o=new p.C_Role_SetSelfSelect;o.type=t,o.selectItemId=e,u.ClientNetwork.getInstance().Send(p.ROLE_CLIENT_ENUM.P_Role_SetSelfSelect,o)}else s.G.StringManager.PopString("\u672a\u9009\u62e9\u91d1\u5361")}})})},o=this,i=1;i<4;i++)t(i)},t.prototype.initBuyViewDay1=function(){var e=this;this.m_box1.getChildByName("boxReward").removeAllChildren();var t=g.RechargeTableData.getById(33);if(null!=t){t.prize.forEach(function(t){var o=m.default.getInstance().getDorpItemsByID(t.dropID);if(o)for(var i=o.dropRandom.split("|"),a=function(t){var o=i[t].split("#"),a=o[0],n=o[1]!=o[2]?"x"+o[1]+"~"+o[2]:"x"+o[1];_.default.createNormalItemsWithNames(a,-1,e.m_box1.getChildByName("boxReward"),function(e){e.getChildByName("txt_name").getComponent(cc.Label).string=n,e.scale=.8})},n=0;n<i.length;n++)a(n)});var o=_.default.getRechargeMoneyByPlatform(t)/100;this.rechargeId_buy1=33;var i=r.default.getRoleRechargeData().get(this.rechargeId_buy1);null!=i&&i.dayNum>t.limitMaxDayNum?(this.m_btn_buy.getComponent(cc.Button).interactable=!1,this.m_btn_buy.getChildByName("label").getComponent(cc.Label).string=s.G.StringManager.getWorldString("word_yishouwan")):(this.m_btn_buy.getComponent(cc.Button).interactable=!0,this.m_btn_buy.getChildByName("label").getComponent(cc.Label).string=s.G.StringManager.getString("SUPER_SALE_MONEY",o));var a=t.limitMaxNum;if(a<=0)this.node.getChildByName("newBoxRechargeNode").getChildByName("limit1").active=!1;else{var n=null!=i?i.totalNum:0;this.node.getChildByName("newBoxRechargeNode").getChildByName("limit1").active=!0,this.node.getChildByName("newBoxRechargeNode").getChildByName("limit1").getChildByName("label_limit").getComponent(cc.Label).string=s.G.StringManager.getWorldString("word_xiangou")+a+"\u6b21("+n+"/"+a+")"}var c=r.default.getRoleInfoData().selfSelectMap.get(33);if(null==c||c<=0)this.node.getChildByName("newBoxRechargeNode").getChildByName("box1").getChildByName("select").getChildByName("player").active=!0,this.node.getChildByName("newBoxRechargeNode").getChildByName("box1").getChildByName("select").getChildByName("changeIcon").active=!1,this.node.getChildByName("newBoxRechargeNode").getChildByName("box1").getChildByName("select").getChildByName("txt").getComponent(cc.Label).string="";else{this.node.getChildByName("newBoxRechargeNode").getChildByName("box1").getChildByName("select").getChildByName("player").active=!1,this.node.getChildByName("newBoxRechargeNode").getChildByName("box1").getChildByName("select").getChildByName("changeIcon").active=!0;var l=m.default.getInstance().getItemByID(c);y.setTexture(this.node.getChildByName("newBoxRechargeNode").getChildByName("box1").getChildByName("select").getChildByName("headframe").getComponent(cc.Sprite),l.icon);var d=y.getConfigIntValue("SelfSelect_33");this.node.getChildByName("newBoxRechargeNode").getChildByName("box1").getChildByName("select").getChildByName("txt").getComponent(cc.Label).string="x"+d}}},t.prototype.showSecectRwd=function(e,t){if(0!=e){var o=e;if(o<=0)this.node.getChildByName("newBoxRechargeNode").getChildByName("box"+t).getChildByName("select").getChildByName("player").active=!0,this.node.getChildByName("newBoxRechargeNode").getChildByName("box"+t).getChildByName("select").getChildByName("changeIcon").active=!1,this.node.getChildByName("newBoxRechargeNode").getChildByName("box"+t).getChildByName("select").getChildByName("txt").getComponent(cc.Label).string="";else{this.node.getChildByName("newBoxRechargeNode").getChildByName("box"+t).getChildByName("select").getChildByName("player").active=!1,this.node.getChildByName("newBoxRechargeNode").getChildByName("box"+t).getChildByName("select").getChildByName("changeIcon").active=!0;var i=m.default.getInstance().getItemByID(o);y.setTexture(this.node.getChildByName("newBoxRechargeNode").getChildByName("box"+t).getChildByName("select").getChildByName("headframe").getComponent(cc.Sprite),i.icon);var a=y.getConfigIntValue("skyCastle_select_recharge_rewardNum");this.node.getChildByName("newBoxRechargeNode").getChildByName("box"+t).getChildByName("select").getChildByName("txt").getComponent(cc.Label).string="x"+a}}},t.prototype.initBuyViewDay2=function(){var e=this;this.m_box2.getChildByName("boxReward").removeAllChildren();var t=g.RechargeTableData.getById(34);if(null!=t){t.prize.forEach(function(t){var o=m.default.getInstance().getDorpItemsByID(t.dropID);if(o)for(var i=o.dropRandom.split("|"),a=function(t){var o=i[t].split("#"),a=o[0],n=o[1]!=o[2]?"x"+o[1]+"~"+o[2]:"x"+o[1];_.default.createNormalItemsWithNames(a,-1,e.m_box2.getChildByName("boxReward"),function(e){e.getChildByName("txt_name").getComponent(cc.Label).string=n,e.scale=.8})},n=0;n<i.length;n++)a(n)});var o=_.default.getRechargeMoneyByPlatform(t)/100;this.rechargeId_buy2=34;var i=r.default.getRoleRechargeData().get(this.rechargeId_buy2);null!=i&&i.dayNum>t.limitMaxDayNum?(this.m_btn_buy2.getComponent(cc.Button).interactable=!1,this.m_btn_buy2.getChildByName("label").getComponent(cc.Label).string=s.G.StringManager.getWorldString("word_yishouwan")):(this.m_btn_buy2.getComponent(cc.Button).interactable=!0,this.m_btn_buy2.getChildByName("label").getComponent(cc.Label).string=s.G.StringManager.getString("SUPER_SALE_MONEY",o));var a=t.limitMaxNum;if(a<=0)this.node.getChildByName("newBoxRechargeNode").getChildByName("limit2").active=!1;else{var n=null!=i?i.totalNum:0;this.node.getChildByName("newBoxRechargeNode").getChildByName("limit2").active=!0,this.node.getChildByName("newBoxRechargeNode").getChildByName("limit2").getChildByName("label_limit").getComponent(cc.Label).string=s.G.StringManager.getWorldString("word_xiangou")+a+"\u6b21("+n+"/"+a+")"}var c=r.default.getRoleInfoData().selfSelectMap.get(34);if(null==c||c<=0)this.node.getChildByName("newBoxRechargeNode").getChildByName("box2").getChildByName("select").getChildByName("player").active=!0,this.node.getChildByName("newBoxRechargeNode").getChildByName("box2").getChildByName("select").getChildByName("changeIcon").active=!1,this.node.getChildByName("newBoxRechargeNode").getChildByName("box2").getChildByName("select").getChildByName("txt").getComponent(cc.Label).string="";else{this.node.getChildByName("newBoxRechargeNode").getChildByName("box2").getChildByName("select").getChildByName("player").active=!1,this.node.getChildByName("newBoxRechargeNode").getChildByName("box2").getChildByName("select").getChildByName("changeIcon").active=!0;var l=m.default.getInstance().getItemByID(c);y.setTexture(this.node.getChildByName("newBoxRechargeNode").getChildByName("box2").getChildByName("select").getChildByName("headframe").getComponent(cc.Sprite),l.icon);var d=y.getConfigIntValue("SelfSelect_34");this.node.getChildByName("newBoxRechargeNode").getChildByName("box2").getChildByName("select").getChildByName("txt").getComponent(cc.Label).string="x"+d}}},t.prototype.initBuyViewDay3=function(){var e=this;this.m_box3.getChildByName("boxReward").removeAllChildren();var t=g.RechargeTableData.getById(35);if(null!=t){t.prize.forEach(function(t){var o=m.default.getInstance().getDorpItemsByID(t.dropID);if(o)for(var i=o.dropRandom.split("|"),a=function(t){var o=i[t].split("#"),a=o[0],n=o[1]!=o[2]?"x"+o[1]+"~"+o[2]:"x"+o[1];_.default.createNormalItemsWithNames(a,-1,e.m_box3.getChildByName("boxReward"),function(e){e.getChildByName("txt_name").getComponent(cc.Label).string=n,e.scale=.8})},n=0;n<i.length;n++)a(n)});var o=_.default.getRechargeMoneyByPlatform(t)/100;this.rechargeId_buy3=35;var i=r.default.getRoleRechargeData().get(this.rechargeId_buy3);null!=i&&i.dayNum>t.limitMaxDayNum?(this.m_btn_buy3.getComponent(cc.Button).interactable=!1,this.m_btn_buy3.getChildByName("label").getComponent(cc.Label).string=s.G.StringManager.getWorldString("word_yishouwan")):(this.m_btn_buy3.getComponent(cc.Button).interactable=!0,this.m_btn_buy3.getChildByName("label").getComponent(cc.Label).string=s.G.StringManager.getString("SUPER_SALE_MONEY",o));var a=t.limitMaxNum;if(a<=0)this.node.getChildByName("newBoxRechargeNode").getChildByName("limit3").active=!1;else{var n=null!=i?i.totalNum:0;this.node.getChildByName("newBoxRechargeNode").getChildByName("limit3").active=!0,this.node.getChildByName("newBoxRechargeNode").getChildByName("limit3").getChildByName("label_limit").getComponent(cc.Label).string="\u9650\u8d2d"+a+"\u6b21("+n+"/"+a+")"}var c=r.default.getRoleInfoData().selfSelectMap.get(35);if(null==c||c<=0)this.node.getChildByName("newBoxRechargeNode").getChildByName("box3").getChildByName("select").getChildByName("player").active=!0,this.node.getChildByName("newBoxRechargeNode").getChildByName("box3").getChildByName("select").getChildByName("changeIcon").active=!1,this.node.getChildByName("newBoxRechargeNode").getChildByName("box3").getChildByName("select").getChildByName("txt").getComponent(cc.Label).string="";else{this.node.getChildByName("newBoxRechargeNode").getChildByName("box3").getChildByName("select").getChildByName("player").active=!1,this.node.getChildByName("newBoxRechargeNode").getChildByName("box3").getChildByName("select").getChildByName("changeIcon").active=!0;var l=m.default.getInstance().getItemByID(c);y.setTexture(this.node.getChildByName("newBoxRechargeNode").getChildByName("box3").getChildByName("select").getChildByName("headframe").getComponent(cc.Sprite),l.icon);var d=y.getConfigIntValue("SelfSelect_35");this.node.getChildByName("newBoxRechargeNode").getChildByName("box3").getChildByName("select").getChildByName("txt").getComponent(cc.Label).string="x"+d}}},t.prototype.onClickBuy=function(){var e=this,t=this.rechargeId_buy1,o=(r.default.getRoleRechargeData().get(t),r.default.getRoleInfoData().selfSelectMap.get(t));if(null==o||o<=0)return s.G.StringManager.PopString(s.G.StringManager.getString("BATTLEPASS_SELECT_GOLD_TIP"));var i=function(){var o={rechargeID:t,rechargeNum:1};e.sendEvent("SendProtocolRecharge",o)};d.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:s.G.StringManager.getString("BUY_EVERYDAYRECHARGE_LASTDAY"),confirmCb:function(){i.call(e)}})},t.prototype.onClickBuy2=function(){var e=this,t=this.rechargeId_buy2,o=(r.default.getRoleRechargeData().get(t),r.default.getRoleInfoData().selfSelectMap.get(t));if(null==o||o<=0)return s.G.StringManager.PopString(s.G.StringManager.getString("BATTLEPASS_SELECT_GOLD_TIP"));var i=function(){var o={rechargeID:t,rechargeNum:1};e.sendEvent("SendProtocolRecharge",o)};d.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:s.G.StringManager.getString("BUY_EVERYDAYRECHARGE_LASTDAY"),confirmCb:function(){i.call(e)}})},t.prototype.onClickBuy3=function(){var e=this,t=this.rechargeId_buy3,o=(r.default.getRoleRechargeData().get(t),r.default.getRoleInfoData().selfSelectMap.get(t));if(null==o||o<=0)return s.G.StringManager.PopString(s.G.StringManager.getString("BATTLEPASS_SELECT_GOLD_TIP"));var i=function(){var o={rechargeID:t,rechargeNum:1};e.sendEvent("SendProtocolRecharge",o)};d.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:s.G.StringManager.getString("BUY_EVERYDAYRECHARGE_LASTDAY"),confirmCb:function(){i.call(e)}})},n([S(cc.Node)],t.prototype,"m_btn_buy",void 0),n([S(cc.Node)],t.prototype,"m_btn_buy2",void 0),n([S(cc.Node)],t.prototype,"m_btn_buy3",void 0),n([S(cc.Node)],t.prototype,"m_box1",void 0),n([S(cc.Node)],t.prototype,"m_box2",void 0),n([S(cc.Node)],t.prototype,"m_box3",void 0),n([l.Register_Class,C],t)}(c.default);o.default=T,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/LuckyGiftSelectTableData":"LuckyGiftSelectTableData","../../StaticData/RechargeTableData":"RechargeTableData","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/base/GameView":"GameView","../../network/ClientNetwork":"ClientNetwork","../../network/protocol/RechargeProtocols":"RechargeProtocols","../../network/protocol/RoleProtocols":"RoleProtocols","../../utils/ConfigUtils":"ConfigUtils","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils"}],AnniversaryReturnBackView:[function(e,t,o){"use strict";cc._RF.push(t,"668a6S6OWFKFI3o6dCjWRx7","AnniversaryReturnBackView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=e("../../StaticData/ActivityTableData"),l=e("../../network/protocol/ActivityProtocols"),d=e("../../common/PlayerModule"),u=e("../../StaticData/CostGetTableData"),h=e("../../StaticData/RechargeTableData"),p=e("../../utils/GameTools"),f=e("../../utils/GameUtils"),g=e("../../utils/ConfigUtils"),m=e("../../utils/GameUtils"),_=e("../../Global/GameGlobal"),y=e("../../common/NetworkProtocolCommon"),v=e("../../modules/base/GameView"),C=e("../../StaticData/LuckyGiftSelectTableData"),S=e("./AnniversaryCtrl"),T=e("../../common/EventConst"),I=e("../../modules/manager/EventManager"),N=e("../../utils/TimeOffSetManager"),b=e("./AnniversaryModule"),w=e("../../utils/GameUtils"),E=e("../../utils/GamePlatform"),P=cc._decorator,R=P.ccclass,L=P.property,A=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.m_RewardNode=null,t.m_SellOutNode=null,t.m_RechargeBtnNode=null,t.m_SelectCardNode=null,t.m_RechargeLeftTimeLab=null,t.m_ToggleContainerNode=null,t.m_GiftViewNode=null,t.m_HelpNewViewNode=null,t.m_FreeTitleNode=null,t.m_RechargeTitleNode=null,t.m_HelpNewServerNameLab=null,t.m_HelpNewDiamondLab=null,t.m_HelpNewTipLayout=null,t.m_HelpNewBtnNode=null,t.m_CurRechargeId=-1,t.nCostGetId=103,t}return a(t,e),t.path=function(){return"ui/anniversary/prefab/AnniversaryReturnBack"},t.prototype.onLoad=function(){I.default.Instance.on(T.default.AnniversaryReturnBackSelectCard,this.refreshSelectCard,this),I.default.Instance.on(T.default.ReturnBackRechargeSuccess,this.initReturnBackGift,this),I.default.Instance.on(T.default.SyncActivityReturnBackHelpNew,this.initReturnBackHelpNew,this)},t.prototype.start=function(){this.initReturnBackGift(),this.initReturnBackHelpNew(),this.unschedule(this.refreshReturnBackGiftLeftTime),this.schedule(this.refreshReturnBackGiftLeftTime,1),this.refreshReturnBackGiftLeftTime()},t.prototype.initReturnBackGift=function(){var e=this;this.m_CurRechargeId=-1;var t=c.ActivityTableData.getById(l.ACTIVITY_ID_ENUM.P_Activity_ReturnBack).paramVec1,o=new Map;if(t.forEach(function(t){if(0===t){var i=d.default.getCostGetDataByID(e.nCostGetId);if(!i||i<=0){var a=u.CostGetTableData.getById(e.nCostGetId);o.set(t,{itemId:a.get[0].itemID,itemCount:a.get[0].itemNum})}}else{var n=d.default.getRoleRechargeData().get(t);if(!n||n.totalNum<=0){var r=h.RechargeTableData.getById(t);o.set(t,{itemId:r.prize[0].dropID,itemCount:r.prize[0].dropNum})}}}),o.size<=0)return this.m_CurRechargeId<0&&(this.m_ToggleContainerNode.children.forEach(function(e){e.getComponent(cc.Toggle).isChecked=!1}),this.m_ToggleContainerNode.children[0].active=!1,this.m_ToggleContainerNode.children[1].getComponent(cc.Toggle).isChecked=!0,this.m_GiftViewNode.active=!1,this.m_HelpNewViewNode.active=!0),this.m_RechargeBtnNode.active=!1,this.m_SellOutNode.active=!0;this.m_RechargeBtnNode.active=!0,this.m_SellOutNode.active=!1,this.m_RewardNode.destroyAllChildren();var i=o.keys().next().value;if(o.has(i)){var a=o.get(i);0==i?(this.m_FreeTitleNode.active=!0,this.m_RechargeTitleNode.active=!1,this.m_RechargeBtnNode.children[1].getComponent(cc.Label).string="\u514d\u8d39",u.CostGetTableData.getById(this.nCostGetId).get.forEach(function(t,o){p.default.createNormalItems(t.itemID,t.itemNum,e.m_RewardNode,function(e){e.scale=.8,e.name="RewardsItemNode"+o,e.x=0==o?-95:95})})):(this.m_FreeTitleNode.active=!1,this.m_RechargeTitleNode.active=!0,p.default.createNormalItems(a.itemId,a.itemCount,this.m_RewardNode,function(e){e.scale=.8,e.name="RewardsItemNode",e.x=95}),this.m_RechargeBtnNode.children[1].getComponent(cc.Label).string="\uffe5"+(p.default.getRechargeMoneyByPlatform(h.RechargeTableData.getById(i))/100).toString())}p.default.registerTouchEvent(this.m_SelectCardNode,function(){var t=d.default.getRoleRechargeData().get(i);if(t&&t.dayNum>0)return _.G.StringManager.PopString("\u60a8\u5df2\u8d2d\u4e70\u8fc7\u8be5\u793c\u5305\uff0c\u65e0\u6cd5\u9009\u62e9");var o=C.LuckyGiftSelectTableData.getById(Number(m.getConfigIntValue("battlePass_choose_gold"))).prize;(o=w.clone(o)).forEach(function(e){var t=Number(m.getConfigIntValue("SelfSelect_"+i));e.itemNum=null!=t?t:1});for(var a=o.length-1;a>=0;a--)2!=g.default.getInstance().getItemByID(o[a].itemID).type&&o.splice(a,1);v.default.addPopView("BaseCtrl","LuckyGiftSelectRewardView","LuckyGiftSelectRewardView",{tRewards:o,index:i,isEveryDayReacharge:!1,parent:e,callBack:function(e){0!=e?S.default.callRoleSetSelfSelect({type:i,selectItemId:e}):_.G.StringManager.PopString("\u672a\u9009\u62e9\u91d1\u5361")}})}),this.m_CurRechargeId=i,this.refreshSelectCard()},t.prototype.onClickRechargeCallBack=function(){var e=this;if(this.m_CurRechargeId<0)return _.G.StringManager.PopString("\u6570\u636e\u9519\u8bef\uff01");if(0==this.m_CurRechargeId){if("\u6d3b\u52a8\u5df2\u7ed3\u675f"==this.m_RechargeLeftTimeLab.getComponent(cc.Label).string)return _.G.StringManager.PopString("\u6d3b\u52a8\u5df2\u7ed3\u675f\uff01");y.default.callRoleCostGet(this.nCostGetId)}else{var t=d.default.getRoleRechargeData().get(this.m_CurRechargeId);if(t&&t.totalNum>0)return _.G.StringManager.PopString("\u60a8\u5df2\u8d2d\u4e70\u8fc7\u8be5\u793c\u5305\uff0c\u65e0\u6cd5\u7ee7\u7eed\u8d2d\u4e70\uff01");var o=d.default.getRoleInfoData().selfSelectMap.get(this.m_CurRechargeId);if(null==o||o<=0)return _.G.StringManager.PopString(_.G.StringManager.getString("BATTLEPASS_SELECT_GOLD_TIP"));v.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:_.G.StringManager.getString("BUY_EVERYDAYRECHARGE_LASTDAY"),confirmCb:function(){var t={rechargeID:e.m_CurRechargeId,rechargeNum:1};e.sendEvent("SendProtocolRecharge",t)}})}},t.prototype.refreshSelectCard=function(){var e;if(this.m_CurRechargeId<=0)return this.m_SelectCardNode.active=!1;this.m_SelectCardNode.active=!0;var t=d.default.getRoleInfoData().selfSelectMap.get(this.m_CurRechargeId);if(null==t||t<=0)this.m_SelectCardNode.getChildByName("player").active=!0,this.m_SelectCardNode.getChildByName("changeIcon").active=!1,this.m_SelectCardNode.getChildByName("txt").getComponent(cc.Label).string="";else{this.m_SelectCardNode.getChildByName("player").active=!1,this.m_SelectCardNode.getChildByName("changeIcon").active=!0;var o=g.default.getInstance().getItemByID(t);f.setTexture(this.m_SelectCardNode.getChildByName("headframe").getComponent(cc.Sprite),o.icon);var i=Number(m.getConfigIntValue("SelfSelect_"+this.m_CurRechargeId));this.m_SelectCardNode.getChildByName("txt").getComponent(cc.Label).string=null!==(e=""+i)&&void 0!==e?e:""}},t.prototype.refreshReturnBackGiftLeftTime=function(){var e=c.ActivityTableData.getById(l.ACTIVITY_ID_ENUM.P_Activity_ReturnBack).param8,t=c.ActivityTableData.getById(l.ACTIVITY_ID_ENUM.P_Activity_ReturnBack).param9,o=d.default.getServersTime();this.m_RechargeLeftTimeLab.getComponent(cc.Label).string="\u5269\u4f59\u65f6\u95f4\uff1a"+N.TimeOffSetManager.formaterWithOutSecond2(t-o),(t-o<=0||e>o||0==b.default.Instance.checkReturnBackOpenState())&&(this.unschedule(this.refreshReturnBackGiftLeftTime),this.m_RechargeLeftTimeLab.getComponent(cc.Label).string="\u6d3b\u52a8\u5df2\u7ed3\u675f")},t.prototype.onClickGiftTabCallBack=function(e){this.m_ToggleContainerNode.children.forEach(function(e){e.getComponent(cc.Toggle).isChecked=!1}),e.target.getComponent(cc.Toggle).isChecked=!0,this.m_GiftViewNode.active=!0,this.m_HelpNewViewNode.active=!1},t.prototype.onClickHelpNewTabCallBack=function(e){this.m_ToggleContainerNode.children.forEach(function(e){e.getComponent(cc.Toggle).isChecked=!1}),e.target.getComponent(cc.Toggle).isChecked=!0,this.m_GiftViewNode.active=!1,this.m_HelpNewViewNode.active=!0},t.prototype.initReturnBackHelpNew=function(){var e=b.default.Instance.getHelpNewServerGroupId();if(e>0){"bigBlue"==E.GamePlatform.getMiYaVideoTypeNoSet()?this.m_HelpNewServerNameLab.string="[S"+e+"]"+m.getConfigIntValue("help_servergroup_name_bigBlue"):this.m_HelpNewServerNameLab.string="[S"+e+"]"+m.getConfigIntValue("help_servergroup_name"),this.m_HelpNewDiamondLab.string=_.G.StringManager.getString("ANNIVERSARY_RETURNBACKHELPNEW_TIPS",b.default.Instance.getHelpNewServerRechargeNum()/100*Number(m.getConfigIntValue("help_recharge_diamond_rate"))),this.m_HelpNewTipLayout.children.forEach(function(t,o){switch(o){case 0:t.getComponent(cc.Label).string=_.G.StringManager.getString("ANNIVERSARY_RETURNBACKHELPNEW_TIPS"+o,e);break;case 1:t.getComponent(cc.Label).string=_.G.StringManager.getString("ANNIVERSARY_RETURNBACKHELPNEW_TIPS"+o,Number(m.getConfigIntValue("help_recharge_diamond_rate")));break;case 2:t.getComponent(cc.Label).string=_.G.StringManager.getString("ANNIVERSARY_RETURNBACKHELPNEW_TIPS"+o,e)}});var t=b.default.Instance.getHelpNewServerIsHelpState();this.m_HelpNewBtnNode.children[1].getComponent(cc.Label).string=1==t?"\u5df2\u52a9\u529b":"\u52a9\u529b\u65b0\u533a",p.default.setNodeBright(this.m_HelpNewBtnNode,!t)}},t.prototype.onClickHelpNewCallBack=function(){return 1==b.default.Instance.getHelpNewServerIsHelpState()?_.G.StringManager.PopString("\u5df2\u52a9\u529b\uff01"):b.default.Instance.getHelpNewServerRechargeNum()<=0?_.G.StringManager.PopString("\u6ca1\u6709\u53ef\u52a9\u529b\u7684\u5956\u52b1\uff01"):void S.default.callReturnBackHelpNew()},t.prototype.onDestroy=function(){I.default.Instance.off(this,T.default.AnniversaryReturnBackSelectCard),I.default.Instance.off(this,T.default.ReturnBackRechargeSuccess),I.default.Instance.off(this,T.default.SyncActivityReturnBackHelpNew)},n([L(cc.Node)],t.prototype,"m_RewardNode",void 0),n([L(cc.Node)],t.prototype,"m_SellOutNode",void 0),n([L(cc.Node)],t.prototype,"m_RechargeBtnNode",void 0),n([L(cc.Node)],t.prototype,"m_SelectCardNode",void 0),n([L(cc.Node)],t.prototype,"m_RechargeLeftTimeLab",void 0),n([L(cc.Node)],t.prototype,"m_ToggleContainerNode",void 0),n([L(cc.Node)],t.prototype,"m_GiftViewNode",void 0),n([L(cc.Node)],t.prototype,"m_HelpNewViewNode",void 0),n([L(cc.Node)],t.prototype,"m_FreeTitleNode",void 0),n([L(cc.Node)],t.prototype,"m_RechargeTitleNode",void 0),n([L(cc.Label)],t.prototype,"m_HelpNewServerNameLab",void 0),n([L(cc.Label)],t.prototype,"m_HelpNewDiamondLab",void 0),n([L(cc.Node)],t.prototype,"m_HelpNewTipLayout",void 0),n([L(cc.Node)],t.prototype,"m_HelpNewBtnNode",void 0),n([s.Register_Class,R],t)}(r.default);o.default=A,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/ActivityTableData":"ActivityTableData","../../StaticData/CostGetTableData":"CostGetTableData","../../StaticData/LuckyGiftSelectTableData":"LuckyGiftSelectTableData","../../StaticData/RechargeTableData":"RechargeTableData","../../common/EventConst":"EventConst","../../common/NetworkProtocolCommon":"NetworkProtocolCommon","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/base/GameView":"GameView","../../modules/manager/EventManager":"EventManager","../../network/protocol/ActivityProtocols":"ActivityProtocols","../../utils/ConfigUtils":"ConfigUtils","../../utils/GamePlatform":"GamePlatform","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils","../../utils/TimeOffSetManager":"TimeOffSetManager","./AnniversaryCtrl":"AnniversaryCtrl","./AnniversaryModule":"AnniversaryModule"}],AnniversaryShopView:[function(e,t,o){"use strict";cc._RF.push(t,"6e188f1T1NMFrOsbvYwpz+o","AnniversaryShopView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=e("../../network/protocol/RoleProtocols"),l=e("../../network/ClientNetwork"),d=e("../../Global/GameGlobal"),u=e("../../modules/base/GameView"),h=e("../../common/PlayerModule"),p=cc._decorator,f=p.ccclass,g=p.property,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.m_MoneyCountLabel=null,t.m_ShopItemLayout=null,t.m_ShopItemPrefab=null,t.m_nGetRandShopId=8,t.m_consumeItemId=1023,t}return a(t,e),t.path=function(){return"ui/anniversary/prefab/AnniversaryShop"},t.prototype.start=function(){var e=this,t=new c.C_Role_GetRandShop;t.shopID=this.m_nGetRandShopId,l.ClientNetwork.getInstance().Send(c.ROLE_CLIENT_ENUM.P_Role_GetRandShop,t),l.ClientNetwork.getInstance().listenProtocol(c.ROLE_CLIENT_ENUM.P_Role_SynRandShopData,function(t){t.resetPos();var o=new c.S_Role_SynRandShopData;o.read(t)&&o.shopID===e.m_nGetRandShopId&&e.initShopListInfo(o.shopData)},this),l.ClientNetwork.getInstance().listenProtocol(c.ROLE_CLIENT_ENUM.P_Role_RandShopBuy,function(t){t.resetPos();var o=new c.S_Role_RandShopBuy;if(o.read(t))if(0===o.errorcode&&o.prize.length>0){u.default.addPopView("BaseCtrl","AcquirePopupView","AcquirePopupView",{items:o.prize});var i=u.default.getViewByName("ShopConfirmBuy");i&&i.view&&(i.view.node.active=!1,i.view.closeView()),e.m_MoneyCountLabel.string=h.default.getItemCountByBag(e.m_consumeItemId)}else d.G.StringManager.PopString("S_Role_RandShopBuy ERROR  "+o.errorcode)},this)},t.prototype.initShopListInfo=function(e){var t=this;this.m_ShopItemLayout.node.destroyAllChildren(),this.scheduleOnce(function(){e.positions.forEach(function(e,o){var i=cc.instantiate(t.m_ShopItemPrefab);i.parent=t.m_ShopItemLayout.node,i.getComponent("NavigationShopItem").init(e,o,t.callRoleRandShopBuy),i.scale=.8})}),this.m_MoneyCountLabel.string=h.default.getItemCountByBag(this.m_consumeItemId)},t.prototype.callRoleRandShopBuy=function(e){var t=new c.C_Role_RandShopBuy;t.shopID=8,t.shopPosition=e.shopPosition,t.shopItemID=e.shopItemID,l.ClientNetwork.getInstance().Send(c.ROLE_CLIENT_ENUM.P_Role_RandShopBuy,t)},n([g(cc.Label)],t.prototype,"m_MoneyCountLabel",void 0),n([g(cc.Layout)],t.prototype,"m_ShopItemLayout",void 0),n([g(cc.Prefab)],t.prototype,"m_ShopItemPrefab",void 0),n([s.Register_Class,f],t)}(r.default);o.default=m,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/base/GameView":"GameView","../../network/ClientNetwork":"ClientNetwork","../../network/protocol/RoleProtocols":"RoleProtocols"}],AnnouncementView:[function(e,t,o){"use strict";cc._RF.push(t,"700cbdVWY5NMYLkSwGoa4cC","AnnouncementView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../Global/GameGlobal"),s=e("../../modules/base/BaseView"),c=e("../../utils/GameTools"),l=e("../../modules/base/Decorators"),d=e("../../utils/GamePlatform"),u=e("../../../load"),h=e("../../modules/base/GameView"),p=cc._decorator,f=p.ccclass,g=p.property,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.titleScroll=null,t.contentLab=null,t.titlePrefab=null,t.textPrefab=null,t.selectOne=!1,t}return a(t,e),t.path=function(){return"ui/announcement/announcement_main"},t.prototype.onLoad=function(){var e=this,t=r.G.StringManager.getString("Announcement_URL");(d.GamePlatform.isWechat()||d.GamePlatform.isQQMiniGame()||d.GamePlatform.isByteDanceMiniGame()||d.GamePlatform.isKuaishouMiniGame())&&(t=u.getSubmitReviewState()?r.G.StringManager.getString("Announcement_URL"):r.G.StringManager.getString("Announcement_URL_MOBILE")),(d.GamePlatform.getMiYa()||d.GamePlatform.isQQGameRoom())&&(t=r.G.StringManager.getString("Announcement_URL_MOBILE")),"testUpdate"==d.GamePlatform.getMiYaVideoTypeNoSet()&&(t=r.G.StringManager.getString("Announcement_URL")),"bigBlue"==d.GamePlatform.getMiYaVideoTypeNoSet()&&(t=r.G.StringManager.getString("Announcement_URL_MOBILE_BIGBLUE"));var o=new XMLHttpRequest;o.onload=function(){console.log("load finish!")},o.onerror=function(e){console.log("load error! ",e)},o.onreadystatechange=function(){4==o.readyState&&o.status>=200&&o.status<400&&e.onShowAnnouncement(o.responseText)},t+="?"+Math.random(),o.open("GET",t,!0),o.send()},t.prototype.onShowAnnouncement=function(e){var t=this,o=JSON.parse(e),i=[];for(var a in o){var n={};n[a]=o[a],i.push(n)}this.titleScroll.getComponent(cc.ScrollView).content.height=(this.titlePrefab.height+this.titleScroll.getComponent(cc.ScrollView).content.getComponent(cc.Layout).spacingY)*i.length,c.default.startFraming(i.length,function(e){var o="type"+(e+1),a=i[e][o];if(!(String(a.exclude).indexOf("douyin")>-1&&d.GamePlatform.isByteDanceMiniGame()||String(a.exclude).indexOf("kuaishou")>-1&&d.GamePlatform.isKuaishouMiniGame()||String(a.exclude).indexOf("qqmini")>-1&&d.GamePlatform.isQQMiniGame()||String(a.exclude).indexOf("qqhall")>-1&&d.GamePlatform.isQQGameRoom()||String(a.exclude).indexOf("5plus7")>-1&&d.GamePlatform.Is5Add7SmallBag())){var n=cc.instantiate(t.titlePrefab);n.parent=t.titleScroll.getComponent(cc.ScrollView).content,n.active=!0,n.getChildByName("title").getComponent(cc.Label).string=a.title,n.content=a.content,n.key=o,n.getChildByName("redpoint").active=t.checkNewNoticeRedpoint(a,o),c.default.registerTouchEvent(n,function(e){t.ononTitleClickCallBack(e)}),0==t.selectOne&&(t.selectOne=!0,n.getChildByName("chose").active=!0,t.touchLeftNodeCallBack(n))}})},t.prototype.checkNewNoticeRedpoint=function(e,t){var o=c.default.getData("GameNoticeData");return!(!o||o.length<=0||(o=JSON.parse(o))[t]&&(o[t].content==e.content||(o[t].isNew=!0,0)))},t.prototype.touchLeftNodeCallBack=function(e){this.unschedule(this.callback1);var t=c.default.getData("GameNoticeData");e.getChildByName("chose").active=!0,e.getChildByName("redpoint").active=!1;var o=e.content.split("\n"),i=o.length,a=0;this.callback1=function(){var e=cc.instantiate(this.textPrefab);e.active=!0,e.parent=this.node.getChildByName("content_list").getComponent(cc.ScrollView).content,e.getComponent(cc.Label).string=o[a],a++},this.schedule(this.callback1,0,i-1,0);var n=40*o.length+50;this.node.getChildByName("content_list").getComponent(cc.ScrollView).content.height=n,this.node.getChildByName("content_list").getComponent(cc.ScrollView).scrollToTop(),!t||t.length<=0||(t=JSON.parse(t))[e.key]&&(t[e.key].content=e.content,t[e.key].isNew=!1,c.default.storageData("GameNoticeData",JSON.stringify(t)))},t.prototype.ononTitleClickCallBack=function(e){var t=this;this.titleScroll.getComponent(cc.ScrollView).content.children.forEach(function(o){o.getChildByName("chose").active=!1,e.target.key==o.key&&(t.node.getChildByName("content_list").getComponent(cc.ScrollView).content.removeAllChildren(),t.touchLeftNodeCallBack(o))})},t.prototype.onDestroy=function(){var e=h.default.getViewByName("MainSceneView");e&&e.view&&e.view.onGameNoticeRedpoint(),this.unscheduleAllCallbacks(),this.selectOne=!1},n([g(cc.Node)],t.prototype,"titleScroll",void 0),n([g(cc.Label)],t.prototype,"contentLab",void 0),n([g(cc.Node)],t.prototype,"titlePrefab",void 0),n([g(cc.Node)],t.prototype,"textPrefab",void 0),n([l.Register_Class,f],t)}(s.default);o.default=m,cc._RF.pop()},{"../../../load":"load","../../Global/GameGlobal":"GameGlobal","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/base/GameView":"GameView","../../utils/GamePlatform":"GamePlatform","../../utils/GameTools":"GameTools"}],AssistBattleView:[function(e,t,o){"use strict";cc._RF.push(t,"4756ca/NuNKkrI5RDybbaTH","AssistBattleView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../modules/base/BaseView"),s=e("../modules/base/Decorators"),c=e("../network/ClientNetwork"),l=e("../network/protocol/MatchProtocols"),d=e("../network/protocol/TypeProtocols"),u=e("../utils/GameUtils"),h=e("../Global/GameGlobal"),p=e("../modules/base/GameView"),f=e("../utils/GamePlatform"),g=e("./activity/ActivityModule"),m=e("../common/NetworkProtocolCommon"),_=cc._decorator,y=_.ccclass,v=_.property,C=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.m_titleLab=null,t.m_tipsLab=null,t.m_strEditRoom="",t}return a(t,e),t.path=function(){return"ui/mainScene/AssistBattleNode"},t.prototype.onLoad=function(){var e=this;c.ClientNetwork.getInstance().listenProtocol(l.MATCH_CLIENT_ENUM.P_Match_Duel_Fight,function(t){t.resetPos();var o=new l.S_Match_Duel_Fight;o.read(t)&&0!=o.errorcode&&(9===o.errorcode?h.G.StringManager.PopStringOnce(h.G.StringManager.getString("COOP_TIMES_NOTENOUGH")):13===o.errorcode?h.G.StringManager.PopStringOnce(h.G.StringManager.getString("MATCH_ROOM_FAIL_HAVE")):18===o.errorcode?h.G.StringManager.PopWorldString(h.G.StringManager.getWorldString("sky_battle_score_limit_tip2")):19===o.errorcode?h.G.StringManager.PopString(h.G.StringManager.getString("MACHINERYCITY_TIP4")):8089===o.errorcode?(e.closeView(),p.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:h.G.StringManager.getString("BATTLE_VERSION_NOT_MATCH"),confirmCb:function(){f.GamePlatform.isWechat()?wx.exitMiniProgram():f.GamePlatform.isQQMiniGame()&&qq.exitMiniProgram()}})):h.G.StringManager.PopStringOnce(h.G.StringManager.getString("MATCH_ROOM_FAIL")))}.bind(this),this)},t.prototype.init=function(e){e&&(this.m_fightType=e.fightType,this.m_titleLab.string=e.title,this.m_tipsLab.string=e.tips)},t.prototype.onRoomIdEditDidEnded=function(e){this.m_strEditRoom=e.string},t.prototype.onClickJoin=function(){if(!(this.m_strEditRoom.length<=0||this.m_fightType!=d.FIGHT_TYPE.FIGHT_TYPE_COOPERATION&&this.m_fightType!=d.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE&&this.m_fightType!=d.FIGHT_TYPE.FIGHT_TYPE_FOG_HIDDEN&&this.m_fightType!=d.FIGHT_TYPE.FIGHT_TYPE_MACHINARIUM&&this.m_fightType!=d.FIGHT_TYPE.FIGHT_TYPE_WEEK_COOPERATION)){if(g.default.isChickenDinnerMatching())return h.G.StringManager.PopString(h.G.StringManager.getString("CHICKENDINNER_MATCHING")),m.default.callRoleClientLog("CHICKENDINNER_MATCHING5"),void console.log("isChickenDinnerMatching code=5");var e=new l.C_Match_Duel_Fight;e.fightType=this.m_fightType,e.useRoom=0,""!=this.m_strEditRoom&&(e.roomID=this.m_strEditRoom),e.params.push(u.getConfigVersion()),c.ClientNetwork.getInstance().Send(l.MATCH_CLIENT_ENUM.P_Match_Duel_Fight,e)}},t.prototype.onDestroy=function(){c.ClientNetwork.getInstance().removeMessageTarget(this)},n([v(cc.Label)],t.prototype,"m_titleLab",void 0),n([v(cc.Label)],t.prototype,"m_tipsLab",void 0),n([s.Register_Class,y],t)}(r.default);o.default=C,cc._RF.pop()},{"../Global/GameGlobal":"GameGlobal","../common/NetworkProtocolCommon":"NetworkProtocolCommon","../modules/base/BaseView":"BaseView","../modules/base/Decorators":"Decorators","../modules/base/GameView":"GameView","../network/ClientNetwork":"ClientNetwork","../network/protocol/MatchProtocols":"MatchProtocols","../network/protocol/TypeProtocols":"TypeProtocols","../utils/GamePlatform":"GamePlatform","../utils/GameUtils":"GameUtils","./activity/ActivityModule":"ActivityModule"}],BaseCtrl:[function(e,t,o){"use strict";cc._RF.push(t,"185238W7eNBwYpPMLbQrKkA","BaseCtrl");var i=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var a=e("../manager/ModelManager"),n=e("../manager/NotificationManager"),r=e("./Decorators"),s=function(){function e(){this.cName="",this.data=null}return e.prototype.init=function(){},e.prototype.onAppera=function(){},e.prototype.onDisappera=function(){},e.prototype.destroy=function(){},e.prototype.onDidAppera=function(){},e.prototype.beforeInit=function(){},e.prototype.afterInit=function(){},e.prototype.onGameShow=function(){},e.prototype.onGameHide=function(){},e.prototype.__init__=function(){this.beforeInit()},e.prototype.__initWithData__=function(e){this.data=e,this.init(e)},e.prototype.__destroy__=function(){this.view.__onClose__(),this.destroy()},e.prototype.__onAppera__=function(){this.onAppera()},e.prototype.__onDisappera__=function(){this.onDisappera()},e.prototype.bindEvent=function(e,t,o){this.view.__bindEvent__(e,t,o)},e.prototype.on=function(e,t,o){n.default.on(e,t,o)},e.prototype.off=function(e,t){n.default.off(e,t)},e.prototype.getModel=function(e){return a.default.getModel(e)},i([r.Register_Class2("BaseCtrl")],e)}();o.default=s,cc._RF.pop()},{"../manager/ModelManager":"ModelManager","../manager/NotificationManager":"NotificationManager","./Decorators":"Decorators"}],BaseModel:[function(e,t,o){"use strict";cc._RF.push(t,"098d1vPBZxKXYnYAgPIb395","BaseModel");var i=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var a=e("../manager/NotificationManager"),n=e("./Decorators"),r=function(){function e(){this.isDestroy=null}return e.prototype.isVaild=function(){return!this.isDestroy},e.prototype.__init__=function(){this.isDestroy=!1,this.init()},e.prototype.__uninit__=function(){this.isDestroy=!0,this.uninit()},e.prototype.dealData=function(){},e.prototype.emit=function(e,t){a.default.emit(e,t)},i([n.Register_Class2("BaseModel")],e)}();o.default=r,cc._RF.pop()},{"../manager/NotificationManager":"NotificationManager","./Decorators":"Decorators"}],BaseProtocols:[function(e,t,o){"use strict";cc._RF.push(t,"0b78cUNsKdE3Z7evcU5dlel","BaseProtocols"),e("DataViewRW");var i=e("ObjCollection"),a=e("long"),n=function(){function e(){this.dropType=0,this.dropID=0,this.dropNum=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<12||(this.dropType=e.getInt32(),this.dropID=e.getInt32(),this.dropNum=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.dropType),e.setInt32(this.dropID),e.setInt32(this.dropNum)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Reward=n;var r=function(){function e(){this.type=0,this.value=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.type=e.getInt32(),this.value=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.type),e.setInt32(this.value)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Attr=r;var s=function(){function e(){this.paramMult=0,this.paramAbs=0,this.paramAttribute=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<12||(this.paramMult=e.getFloat32(),this.paramAbs=e.getFloat32(),this.paramAttribute=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setFloat32(this.paramMult),e.setFloat32(this.paramAbs),e.setInt32(this.paramAttribute)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_SkillParamStruct=s;var c=function(){function e(){this.heroUUID=a.fromValue(0),this.heroID=0,this.heroLevel=0,this.attr=[],this.skinId=0}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<20)return!1;this.heroUUID=e.getLong(),this.heroID=e.getInt32(),this.heroLevel=e.getInt32();var t=e.getUint32();if(e.getLen()-e.getPos()<8*t)return!1;this.attr=[];for(var o=0;o<t;++o){var i=new r;if(!i.read(e))return!1;this.attr.push(i)}return!(e.getLen()-e.getPos()<4||(this.skinId=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setLong(this.heroUUID),e.setInt32(this.heroID),e.setInt32(this.heroLevel),e.setUint32(this.attr.length),this.attr.forEach(function(t){t.writeNoEnd(e)}),e.setInt32(this.skinId)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_HeroAbstract=c;var l=function(){function e(){this.itemID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.itemID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.itemID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_RuneAbstract=l;var d=function(){function e(){this.expressionUUID=a.fromValue(0),this.expressionID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<12||(this.expressionUUID=e.getLong(),this.expressionID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setLong(this.expressionUUID),e.setInt32(this.expressionID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_ExpressionAbstract=d;var u=function(){function e(){this.maxRound=0,this.winNum=0,this.lostNum=0,this.seriesWinNum=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<16||(this.maxRound=e.getInt32(),this.winNum=e.getInt32(),this.lostNum=e.getInt32(),this.seriesWinNum=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.maxRound),e.setInt32(this.winNum),e.setInt32(this.lostNum),e.setInt32(this.seriesWinNum)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_RoleFightTypeAbstract=u;var h=function(){function e(){this.level=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.level=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.level)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_FinalRuneAbstract=h;var p=function(){function e(){this.seasonID=0,this.beginTime=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.seasonID=e.getInt32(),this.beginTime=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.seasonID),e.setInt32(this.beginTime)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Fight_SeasonData=p;var f=function(){function e(){this.roleID=a.fromValue(0),this.showID="",this.bRobot=!1,this.aiid=0,this.loginSDKType=0,this.loginClientType=0,this.loginSystematic=0,this.nickName="",this.headID=0,this.headUrl="",this.headFrameID=0,this.mapSkinID=0,this.autoExpressionID=0,this.score=0,this.maxScore=0,this.maxSeasonScore=0,this.encourageNum=0,this.extraCooperation=0,this.level=1,this.levelExp=0,this.sociatyID="",this.sociatyName="",this.sociatyFlag=0,this.sociatyJob=0,this.sociatyLevel=0,this.fightType=new i.ObjMap,this.heros=new i.ObjMap,this.expressions=new i.ObjMap,this.runes=new i.ObjMap,this.finalrunes=new i.ObjMap,this.fightSeasonData=new i.ObjMap,this.petId=0,this.qqHallVipInfo=[],this.qqMiniGiftGetMap=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<12)return!1;this.roleID=e.getLong();var t=e.getUint32();if(e.getLen()-e.getPos()<t)return!1;if(this.showID=e.getString(t),e.getLen()-e.getPos()<21)return!1;this.bRobot=e.getBool(),this.aiid=e.getInt32(),this.loginSDKType=e.getInt32(),this.loginClientType=e.getInt32(),this.loginSystematic=e.getInt32();var o=e.getUint32();if(e.getLen()-e.getPos()<o)return!1;if(this.nickName=e.getString(o),e.getLen()-e.getPos()<8)return!1;this.headID=e.getInt32();var i=e.getUint32();if(e.getLen()-e.getPos()<i)return!1;if(this.headUrl=e.getString(i),e.getLen()-e.getPos()<44)return!1;this.headFrameID=e.getInt32(),this.mapSkinID=e.getInt32(),this.autoExpressionID=e.getInt32(),this.score=e.getInt32(),this.maxScore=e.getInt32(),this.maxSeasonScore=e.getInt32(),this.encourageNum=e.getInt32(),this.extraCooperation=e.getInt32(),this.level=e.getInt32(),this.levelExp=e.getInt32();var a=e.getUint32();if(e.getLen()-e.getPos()<a)return!1;if(this.sociatyID=e.getString(a),e.getLen()-e.getPos()<4)return!1;var n=e.getUint32();if(e.getLen()-e.getPos()<n)return!1;if(this.sociatyName=e.getString(n),e.getLen()-e.getPos()<16)return!1;this.sociatyFlag=e.getInt32(),this.sociatyJob=e.getInt32(),this.sociatyLevel=e.getInt32();var r=e.getUint32();if(e.getLen()-e.getPos()<20*r)return!1;this.fightType.clear();for(var s=0;s<r;++s){var f;f=e.getInt32();var g=new u;if(!g.read(e))return!1;this.fightType.set(f,g)}if(e.getLen()-e.getPos()<4)return!1;var m=e.getUint32();this.heros.clear();for(var _=0;_<m;++_){var y;y=e.getInt32();var v=new c;if(!v.read(e))return!1;this.heros.set(y,v)}if(e.getLen()-e.getPos()<4)return!1;var C=e.getUint32();if(e.getLen()-e.getPos()<16*C)return!1;this.expressions.clear();for(var S=0;S<C;++S){var T;T=e.getInt32();var I=new d;if(!I.read(e))return!1;this.expressions.set(T,I)}if(e.getLen()-e.getPos()<4)return!1;var N=e.getUint32();if(e.getLen()-e.getPos()<8*N)return!1;this.runes.clear();for(var b=0;b<N;++b){var w;w=e.getInt32();var E=new l;if(!E.read(e))return!1;this.runes.set(w,E)}if(e.getLen()-e.getPos()<4)return!1;var P=e.getUint32();if(e.getLen()-e.getPos()<8*P)return!1;this.finalrunes.clear();for(var R=0;R<P;++R){var L;L=e.getInt32();var A=new h;if(!A.read(e))return!1;this.finalrunes.set(L,A)}if(e.getLen()-e.getPos()<4)return!1;var D=e.getUint32();if(e.getLen()-e.getPos()<12*D)return!1;this.fightSeasonData.clear();for(var M=0;M<D;++M){var B;B=e.getInt32();var k=new p;if(!k.read(e))return!1;this.fightSeasonData.set(B,k)}if(e.getLen()-e.getPos()<8)return!1;this.petId=e.getInt32();var G=e.getUint32();if(e.getLen()-e.getPos()<4*G)return!1;this.qqHallVipInfo=[];for(var O=0;O<G;++O){var H;H=e.getInt32(),this.qqHallVipInfo.push(H)}if(e.getLen()-e.getPos()<4)return!1;var V=e.getUint32();if(e.getLen()-e.getPos()<8*V)return!1;this.qqMiniGiftGetMap.clear();for(var F=0;F<V;++F){var U,x;U=e.getInt32(),x=e.getInt32(),this.qqMiniGiftGetMap.set(U,x)}return!0},e.prototype.writeNoEnd=function(e){e.setLong(this.roleID),e.setString(this.showID),e.setBool(this.bRobot),e.setInt32(this.aiid),e.setInt32(this.loginSDKType),e.setInt32(this.loginClientType),e.setInt32(this.loginSystematic),e.setString(this.nickName),e.setInt32(this.headID),e.setString(this.headUrl),e.setInt32(this.headFrameID),e.setInt32(this.mapSkinID),e.setInt32(this.autoExpressionID),e.setInt32(this.score),e.setInt32(this.maxScore),e.setInt32(this.maxSeasonScore),e.setInt32(this.encourageNum),e.setInt32(this.extraCooperation),e.setInt32(this.level),e.setInt32(this.levelExp),e.setString(this.sociatyID),e.setString(this.sociatyName),e.setInt32(this.sociatyFlag),e.setInt32(this.sociatyJob),e.setInt32(this.sociatyLevel),e.setUint32(this.fightType.size),this.fightType.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)}),e.setUint32(this.heros.size),this.heros.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)}),e.setUint32(this.expressions.size),this.expressions.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)}),e.setUint32(this.runes.size),this.runes.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)}),e.setUint32(this.finalrunes.size),this.finalrunes.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)}),e.setUint32(this.fightSeasonData.size),this.fightSeasonData.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)}),e.setInt32(this.petId),e.setUint32(this.qqHallVipInfo.length),this.qqHallVipInfo.forEach(function(t){e.setInt32(t)}),e.setUint32(this.qqMiniGiftGetMap.size),this.qqMiniGiftGetMap.forEach(function(t,o){e.setInt32(o),e.setInt32(t)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_RoleAbstract=f;var g=function(){function e(){this.heroID=0,this.heroLevel=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.heroID=e.getInt32(),this.heroLevel=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.heroID),e.setInt32(this.heroLevel)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_HeroShow=g;var m=function(){function e(){this.roleID=a.fromValue(0),this.showID="",this.bRobot=!1,this.nickName="",this.headID=0,this.headUrl="",this.headFrameID=0,this.level=1,this.score=0,this.maxScore=0,this.battleWinNum=0,this.battleLostNum=0,this.cooperationMaxRound=0,this.sociatyName="",this.heros=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<12)return!1;this.roleID=e.getLong();var t=e.getUint32();if(e.getLen()-e.getPos()<t)return!1;if(this.showID=e.getString(t),e.getLen()-e.getPos()<5)return!1;this.bRobot=e.getBool();var o=e.getUint32();if(e.getLen()-e.getPos()<o)return!1;if(this.nickName=e.getString(o),e.getLen()-e.getPos()<8)return!1;this.headID=e.getInt32();var i=e.getUint32();if(e.getLen()-e.getPos()<i)return!1;if(this.headUrl=e.getString(i),e.getLen()-e.getPos()<32)return!1;this.headFrameID=e.getInt32(),this.level=e.getInt32(),this.score=e.getInt32(),this.maxScore=e.getInt32(),this.battleWinNum=e.getInt32(),this.battleLostNum=e.getInt32(),this.cooperationMaxRound=e.getInt32();var a=e.getUint32();if(e.getLen()-e.getPos()<a)return!1;if(this.sociatyName=e.getString(a),e.getLen()-e.getPos()<4)return!1;var n=e.getUint32();if(e.getLen()-e.getPos()<12*n)return!1;this.heros.clear();for(var r=0;r<n;++r){var s;s=e.getInt32();var c=new g;if(!c.read(e))return!1;this.heros.set(s,c)}return!0},e.prototype.writeNoEnd=function(e){e.setLong(this.roleID),e.setString(this.showID),e.setBool(this.bRobot),e.setString(this.nickName),e.setInt32(this.headID),e.setString(this.headUrl),e.setInt32(this.headFrameID),e.setInt32(this.level),e.setInt32(this.score),e.setInt32(this.maxScore),e.setInt32(this.battleWinNum),e.setInt32(this.battleLostNum),e.setInt32(this.cooperationMaxRound),e.setString(this.sociatyName),e.setUint32(this.heros.size),this.heros.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_RoleShow=m;var _=function(){function e(){this.heroID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.heroID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.heroID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Chat_HeroData=_;var y=function(){function e(){this.channel=0,this.showChannel=[],this.chatTime=0,this.roleID=a.fromValue(0),this.showID="",this.nickName="",this.headID=0,this.headUrl="",this.headFrameID=0,this.level=1,this.score=0,this.receiveRoleID=a.fromValue(0),this.chatType=0,this.chatText="",this.chatParam=0,this.isLiveState=0,this.sociatyName="",this.sociatyJob=0,this.heros=new i.ObjMap,this.qqHallVipInfo=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.channel=e.getInt32();var t=e.getUint32();if(e.getLen()-e.getPos()<4*t)return!1;this.showChannel=[];for(var o=0;o<t;++o){var i;i=e.getInt32(),this.showChannel.push(i)}if(e.getLen()-e.getPos()<16)return!1;this.chatTime=e.getInt32(),this.roleID=e.getLong();var a=e.getUint32();if(e.getLen()-e.getPos()<a)return!1;if(this.showID=e.getString(a),e.getLen()-e.getPos()<4)return!1;var n=e.getUint32();if(e.getLen()-e.getPos()<n)return!1;if(this.nickName=e.getString(n),e.getLen()-e.getPos()<8)return!1;this.headID=e.getInt32();var r=e.getUint32();if(e.getLen()-e.getPos()<r)return!1;if(this.headUrl=e.getString(r),e.getLen()-e.getPos()<28)return!1;this.headFrameID=e.getInt32(),this.level=e.getInt32(),this.score=e.getInt32(),this.receiveRoleID=e.getLong(),this.chatType=e.getInt32();var s=e.getUint32();if(e.getLen()-e.getPos()<s)return!1;if(this.chatText=e.getString(s),e.getLen()-e.getPos()<12)return!1;this.chatParam=e.getInt32(),this.isLiveState=e.getInt32();var c=e.getUint32();if(e.getLen()-e.getPos()<c)return!1;if(this.sociatyName=e.getString(c),e.getLen()-e.getPos()<8)return!1;this.sociatyJob=e.getInt32();var l=e.getUint32();if(e.getLen()-e.getPos()<8*l)return!1;this.heros.clear();for(var d=0;d<l;++d){var u;u=e.getInt32();var h=new _;if(!h.read(e))return!1;this.heros.set(u,h)}if(e.getLen()-e.getPos()<4)return!1;var p=e.getUint32();if(e.getLen()-e.getPos()<4*p)return!1;this.qqHallVipInfo=[];for(var f=0;f<p;++f){var g;g=e.getInt32(),this.qqHallVipInfo.push(g)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.channel),e.setUint32(this.showChannel.length),this.showChannel.forEach(function(t){e.setInt32(t)}),e.setInt32(this.chatTime),e.setLong(this.roleID),e.setString(this.showID),e.setString(this.nickName),e.setInt32(this.headID),e.setString(this.headUrl),e.setInt32(this.headFrameID),e.setInt32(this.level),e.setInt32(this.score),e.setLong(this.receiveRoleID),e.setInt32(this.chatType),e.setString(this.chatText),e.setInt32(this.chatParam),e.setInt32(this.isLiveState),e.setString(this.sociatyName),e.setInt32(this.sociatyJob),e.setUint32(this.heros.size),this.heros.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)}),e.setUint32(this.qqHallVipInfo.length),this.qqHallVipInfo.forEach(function(t){e.setInt32(t)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Chat_Data=y;var v=function(){function e(){this.buildNum=0,this.mixNum=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.buildNum=e.getInt32(),this.mixNum=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.buildNum),e.setInt32(this.mixNum)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Fight_Role_Detail_Info_HeroMixLevelData=v;var C=function(){function e(){this.heroID=0,this.maxFightLevel=0,this.mixLevel=new i.ObjMap,this.damageTotal=a.fromValue(0),this.maxDamage=0,this.cardLevel=0,this.healTotal=a.fromValue(0)}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<12)return!1;this.heroID=e.getInt32(),this.maxFightLevel=e.getInt32();var t=e.getUint32();if(e.getLen()-e.getPos()<12*t)return!1;this.mixLevel.clear();for(var o=0;o<t;++o){var i;i=e.getInt32();var a=new v;if(!a.read(e))return!1;this.mixLevel.set(i,a)}return!(e.getLen()-e.getPos()<24||(this.damageTotal=e.getLong(),this.maxDamage=e.getInt32(),this.cardLevel=e.getInt32(),this.healTotal=e.getLong(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.heroID),e.setInt32(this.maxFightLevel),e.setUint32(this.mixLevel.size),this.mixLevel.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)}),e.setLong(this.damageTotal),e.setInt32(this.maxDamage),e.setInt32(this.cardLevel),e.setLong(this.healTotal)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Fight_Role_Detail_Info_Heros=C;var S=function(){function e(){this.deathNum=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.deathNum=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.deathNum)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Fight_Role_Detail_Info_Monsters=S;var T=function(){function e(){this.heroID=0,this.level=0,this.starLevel=0,this.skinId=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<16||(this.heroID=e.getInt32(),this.level=e.getInt32(),this.starLevel=e.getInt32(),this.skinId=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.heroID),e.setInt32(this.level),e.setInt32(this.starLevel),e.setInt32(this.skinId)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Fight_Statistic_Team_Hero_Info=T;var I=function(){function e(){this.totalDamage=a.fromValue(0),this.totalHeal=a.fromValue(0),this.maxDamage=a.fromValue(0),this.heroId=0,this.cumulativeSp=0,this.cumulativeRef=0,this.team=[],this.carLevel=0,this.otherInfo=""}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<40)return!1;this.totalDamage=e.getLong(),this.totalHeal=e.getLong(),this.maxDamage=e.getLong(),this.heroId=e.getInt32(),this.cumulativeSp=e.getInt32(),this.cumulativeRef=e.getInt32();var t=e.getUint32();if(e.getLen()-e.getPos()<16*t)return!1;this.team=[];for(var o=0;o<t;++o){var i=new T;if(!i.read(e))return!1;this.team.push(i)}if(e.getLen()-e.getPos()<8)return!1;this.carLevel=e.getInt32();var a=e.getUint32();return!(e.getLen()-e.getPos()<a||(this.otherInfo=e.getString(a),0))},e.prototype.writeNoEnd=function(e){e.setLong(this.totalDamage),e.setLong(this.totalHeal),e.setLong(this.maxDamage),e.setInt32(this.heroId),e.setInt32(this.cumulativeSp),e.setInt32(this.cumulativeRef),e.setUint32(this.team.length),this.team.forEach(function(t){t.writeNoEnd(e)}),e.setInt32(this.carLevel),e.setString(this.otherInfo)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Fight_Statistic_info=I;var N=function(){function e(){this.roleID=a.fromValue(0),this.round=0,this.roleAbstract=new f,this.maxSp=0,this.cumulativeSp=0,this.lastMonsterTime=0,this.heros=new i.ObjMap,this.typeMonster=new i.ObjMap,this.statisticInfo=new I}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<12)return!1;if(this.roleID=e.getLong(),this.round=e.getInt32(),!this.roleAbstract.read(e))return!1;if(e.getLen()-e.getPos()<16)return!1;this.maxSp=e.getInt32(),this.cumulativeSp=e.getInt32(),this.lastMonsterTime=e.getInt32();var t=e.getUint32();this.heros.clear();for(var o=0;o<t;++o){var i;i=e.getLong();var a=new C;if(!a.read(e))return!1;this.heros.set(i,a)}if(e.getLen()-e.getPos()<4)return!1;var n=e.getUint32();if(e.getLen()-e.getPos()<8*n)return!1;this.typeMonster.clear();for(var r=0;r<n;++r){var s;s=e.getInt32();var c=new S;if(!c.read(e))return!1;this.typeMonster.set(s,c)}return!!this.statisticInfo.read(e)},e.prototype.writeNoEnd=function(e){e.setLong(this.roleID),e.setInt32(this.round),this.roleAbstract.writeNoEnd(e),e.setInt32(this.maxSp),e.setInt32(this.cumulativeSp),e.setInt32(this.lastMonsterTime),e.setUint32(this.heros.size),this.heros.forEach(function(t,o){e.setLong(o),t.writeNoEnd(e)}),e.setUint32(this.typeMonster.size),this.typeMonster.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)}),this.statisticInfo.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Fight_Role_Detail_Info=N;var b=function(){function e(){this.isWin=!1,this.giveupVsRobot=0,this.fightType=0,this.fightModule=0,this.fightRoleInfo=new i.ObjMap,this.params=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<17)return!1;this.isWin=e.getBool(),this.giveupVsRobot=e.getInt32(),this.fightType=e.getInt32(),this.fightModule=e.getInt32();var t=e.getUint32();this.fightRoleInfo.clear();for(var o=0;o<t;++o){var i;i=e.getLong();var a=new N;if(!a.read(e))return!1;this.fightRoleInfo.set(i,a)}if(e.getLen()-e.getPos()<4)return!1;var n=e.getUint32();if(e.getLen()-e.getPos()<4*n)return!1;this.params=[];for(var r=0;r<n;++r){var s;s=e.getInt32(),this.params.push(s)}return!0},e.prototype.writeNoEnd=function(e){e.setBool(this.isWin),e.setInt32(this.giveupVsRobot),e.setInt32(this.fightType),e.setInt32(this.fightModule),e.setUint32(this.fightRoleInfo.size),this.fightRoleInfo.forEach(function(t,o){e.setLong(o),t.writeNoEnd(e)}),e.setUint32(this.params.length),this.params.forEach(function(t){e.setInt32(t)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Fight_Detail_Info=b;var w=function(){function e(){this.scriptID=0,this.buffId=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.scriptID=e.getInt32();var t=e.getUint32();if(e.getLen()-e.getPos()<4*t)return!1;this.buffId=[];for(var o=0;o<t;++o){var i;i=e.getInt32(),this.buffId.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.scriptID),e.setUint32(this.buffId.length),this.buffId.forEach(function(t){e.setInt32(t)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Fight_Activity_Cooperation=w;var E=function(){function e(){this.cooperationData=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();this.cooperationData.clear();for(var o=0;o<t;++o){var i;i=e.getInt32();var a=new w;if(!a.read(e))return!1;this.cooperationData.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setUint32(this.cooperationData.size),this.cooperationData.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Fight_Extra_Data=E;var P=function(){function e(){this.sendName="",this.headID=0,this.headFrameID=0,this.score=0,this.headurl="",this.level=0}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();if(e.getLen()-e.getPos()<t)return!1;if(this.sendName=e.getString(t),e.getLen()-e.getPos()<16)return!1;this.headID=e.getInt32(),this.headFrameID=e.getInt32(),this.score=e.getInt32();var o=e.getUint32();return!(e.getLen()-e.getPos()<o||(this.headurl=e.getString(o),e.getLen()-e.getPos()<4||(this.level=e.getInt32(),0)))},e.prototype.writeNoEnd=function(e){e.setString(this.sendName),e.setInt32(this.headID),e.setInt32(this.headFrameID),e.setInt32(this.score),e.setString(this.headurl),e.setInt32(this.level)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_GameNotice_Info_Data=P;var R=function(){function e(){this.type=0,this.str=""}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.type=e.getInt32();var t=e.getUint32();return!(e.getLen()-e.getPos()<t||(this.str=e.getString(t),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.type),e.setString(this.str)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_GameNotice_Param=R;var L=function(){function e(){this.params=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();this.params=[];for(var o=0;o<t;++o){var i=new R;if(!i.read(e))return!1;this.params.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setUint32(this.params.length),this.params.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_GameNotice_Param_Data=L;var A=function(){function e(){this.noticeID=0,this.noticeMsg="",this.info=new P,this.param=new L}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.noticeID=e.getInt32();var t=e.getUint32();return!(e.getLen()-e.getPos()<t||(this.noticeMsg=e.getString(t),!this.info.read(e)||!this.param.read(e)))},e.prototype.writeNoEnd=function(e){e.setInt32(this.noticeID),e.setString(this.noticeMsg),this.info.writeNoEnd(e),this.param.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_GameNotice_Data=A;var D=function(){function e(){this.roleId=a.fromValue(0),this.name="",this.openid="",this.headUrl="",this.title=0,this.isLive=0,this.weixinopenid="",this.groupId=0,this.number=0}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<12)return!1;this.roleId=e.getLong();var t=e.getUint32();if(e.getLen()-e.getPos()<t)return!1;if(this.name=e.getString(t),e.getLen()-e.getPos()<4)return!1;var o=e.getUint32();if(e.getLen()-e.getPos()<o)return!1;if(this.openid=e.getString(o),e.getLen()-e.getPos()<4)return!1;var i=e.getUint32();if(e.getLen()-e.getPos()<i)return!1;if(this.headUrl=e.getString(i),e.getLen()-e.getPos()<12)return!1;this.title=e.getInt32(),this.isLive=e.getInt32();var a=e.getUint32();return!(e.getLen()-e.getPos()<a||(this.weixinopenid=e.getString(a),e.getLen()-e.getPos()<8||(this.groupId=e.getInt32(),this.number=e.getInt32(),0)))},e.prototype.writeNoEnd=function(e){e.setLong(this.roleId),e.setString(this.name),e.setString(this.openid),e.setString(this.headUrl),e.setInt32(this.title),e.setInt32(this.isLive),e.setString(this.weixinopenid),e.setInt32(this.groupId),e.setInt32(this.number)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Anchor_Info=D;var M=function(){function e(){this.proficiency=0,this.worldRank=0,this.localRank=0,this.ipName="",this.shareData=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<16)return!1;this.proficiency=e.getInt32(),this.worldRank=e.getInt32(),this.localRank=e.getInt32();var t=e.getUint32();if(e.getLen()-e.getPos()<t)return!1;if(this.ipName=e.getString(t),e.getLen()-e.getPos()<4)return!1;var o=e.getUint32();if(e.getLen()-e.getPos()<8*o)return!1;this.shareData.clear();for(var i=0;i<o;++i){var a,n;a=e.getInt32(),n=e.getInt32(),this.shareData.set(a,n)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.proficiency),e.setInt32(this.worldRank),e.setInt32(this.localRank),e.setString(this.ipName),e.setUint32(this.shareData.size),this.shareData.forEach(function(t,o){e.setInt32(o),e.setInt32(t)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_ProficiencyInfo=M;var B=function(){function e(){this.proficiencyInfoMap=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();this.proficiencyInfoMap.clear();for(var o=0;o<t;++o){var i;i=e.getInt32();var a=new M;if(!a.read(e))return!1;this.proficiencyInfoMap.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setUint32(this.proficiencyInfoMap.size),this.proficiencyInfoMap.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_RoleProficiency=B,cc._RF.pop()},{DataViewRW:"DataViewRW",ObjCollection:"ObjCollection",long:"long"}],BaseScene:[function(e,t,o){"use strict";cc._RF.push(t,"824eaQM08BJIZEaw5MOOqaI","BaseScene");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator.ccclass,s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.__onCloseAllPopView__=function(){this.onCloseAllPopView()},t.prototype.onCloseAllPopView=function(){},t.prototype.__onAppera__=function(e){this.onAppera(e)},t.prototype.onAppera=function(){},t.prototype.resumeAudio=function(){},t.prototype.backEvent=function(){return!1},t.lastSceneName="",t.lastViewName="",t.params=null,t.scene=null,t.curSceneName="",t.curViewName="",t.webviewIsSHow=!1,t.loginIsShow=!1,t.shopIsShow=!1,n([r],t)}(cc.Component);o.default=s,cc._RF.pop()},{}],BaseSingle:[function(e,t,o){"use strict";cc._RF.push(t,"eba4fbnN3xA5bhik8Ppl7LA","BaseSingle"),Object.defineProperty(o,"__esModule",{value:!0}),o.SingleFactory=o.BaseSingle=void 0;o.BaseSingle=function(){};var i=function(){function e(){}return e.getInstance=function(t){if(!t._instance){var o=new t;return t._instance=o,o.onCreate(),e._instanceList.set(t,o),o}return t._instance},e.clear=function(e){e._instance&&(e._instance.onDestroy(),e._instance=null)},e.clearAll=function(){for(var t=e._instanceList.keys(),o=0,i=Array.from(t);o<i.length;o++){var a=i[o];e._instanceList.get(a).onDestroy(),e._instanceList.delete(a)}},e._instanceList=new Map,e}();o.SingleFactory=i,cc._RF.pop()},{}],BaseTableData:[function(e,t,o){"use strict";cc._RF.push(t,"205159YrMdJu6Gt5/pwAHIW","BaseTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.SeasonItem=o.SDKBaseData=o.SkillParamStruct=o.RobotWeightGroupData=o.MatchSeriesWinRobot=o.AttrData=o.ItemInfo=o.DropItem=void 0;var i=function(){function e(){this.dropType=0,this.dropID=0,this.dropNum=0}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.dropType=e.getNumber(),this.dropID=e.getNumber(),this.dropNum=e.getNumber()},e}();o.DropItem=i;var a=function(){function e(){this.itemID=0,this.itemNum=0}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.itemID=e.getNumber(),this.itemNum=e.getNumber()},e}();o.ItemInfo=a;var n=function(){function e(){this.type=0,this.value=0}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.type=e.getNumber(),this.value=e.getNumber()},e}();o.AttrData=n;var r=function(){function e(){this.seriesWinNum=0,this.robotWeightGroupId=0}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.seriesWinNum=e.getNumber(),this.robotWeightGroupId=e.getNumber()},e}();o.MatchSeriesWinRobot=r;var s=function(){function e(){this.robotGroupId=0,this.weight=0}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.robotGroupId=e.getNumber(),this.weight=e.getNumber()},e}();o.RobotWeightGroupData=s;var c=function(){function e(){this.paramMult=0,this.paramAbs=0,this.paramAttribute=0}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.paramMult=e.getNumber(),this.paramAbs=e.getNumber(),this.paramAttribute=e.getNumber()},e}();o.SkillParamStruct=c;var l=function(){function e(){this.sdkType=0,this.sdkId=0}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.sdkType=e.getNumber(),this.sdkId=e.getNumber()},e}();o.SDKBaseData=l;var d=function(){function e(){this.itemID=0,this.itemNum=0,this.season=0}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.itemID=e.getNumber(),this.itemNum=e.getNumber(),this.season=e.getNumber()},e}();o.SeasonItem=d,cc._RF.pop()},{}],BaseView:[function(e,t,o){"use strict";cc._RF.push(t,"2dc99Hd8NpO6KOyF0yDIZgo","BaseView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0}),o.ViewAdapterType=o.ViewAnimaType=void 0;var r,s,c=e("../manager/LoadResManager"),l=e("../manager/ViewManager"),d=e("../../utils/LogUtil"),u=e("./Decorators"),h=e("../../utils/GameUtils"),p=e("../../utils/GamePlatform"),f=cc._decorator,g=f.ccclass,m=f.property,_=function(){function e(){this._eventList=[]}return e.prototype.on=function(e,t,o){for(var i=new y(e,t,o),a=0,n=this._eventList;a<n.length;a++)if(n[a].equals(i))return void d.default.log("\u4e8b\u4ef6["+e+"]\u5df2\u5b58\u5728\uff01");this._eventList.push(i)},e.prototype.emit=function(e,t){for(var o=0,i=this._eventList;o<i.length;o++){var a=i[o];if(a.name===e){a.cb&&a.cb.call(a.target,t);break}}},e.prototype.remove=function(e){for(var t=0;t<this._eventList.length;t++)if(e===this._eventList[t].name)return this._eventList.splice(t,1),!0;return!1},e.prototype.destroy=function(){this._eventList=[]},e}(),y=function(){function e(e,t,o){this.name=e,this.cb=t,this.target=o}return e.prototype.equals=function(e){return this.name===e.name},e}();(function(e){e[e.NONE=0]="NONE",e[e.SCALE_POP=1]="SCALE_POP",e[e.SCENE=2]="SCENE",e[e.CUSTOM=3]="CUSTOM"})(r=o.ViewAnimaType||(o.ViewAnimaType={})),function(e){e[e.L_TYPE=0]="L_TYPE",e[e.S_TYPE=1]="S_TYPE",e[e.N_TYPE=2]="N_TYPE"}(s=o.ViewAdapterType||(o.ViewAdapterType={}));var v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.pfb=null,t.isSetNodeFullSize=!0,t.isAnima=!1,t.isSetBackground=!1,t.backgroundImage=null,t._maskNode=null,t}var o;return a(t,e),o=t,t.prototype.isVaild=function(){return!!(this&&cc.isValid(this)&&this.node&&this.node.isValid)},t.getMaskNode=function(){var e=this,t=new cc.Node;if(t.name="block input event node",t.width=cc.winSize.width,t.height=cc.winSize.height,t.addComponent(cc.BlockInputEvents),t.zIndex=-1,this.isAddMaskSprite()){var o=t.addComponent(cc.Sprite);t.color=cc.color(0,0,0),t.opacity=135,t.x=t.y=0,o.sizeMode=cc.Sprite.SizeMode.CUSTOM,c.default.loadSpriteFrame("ui/common_res/sprite_splash").then(function(t){cc.isValid(e)?o.spriteFrame=t:console.log(" load sprite_splash error ")}).catch(function(e){cc.error(e)})}return this.onCreateMaskNode(t)},t.prototype.createBackgroundNode=function(){if(!1===this.isSetBackground)return null;var e=new cc.Node;e.name="backgroundNode";var t=e.addComponent(cc.Sprite);return e.x=e.y=0,t.spriteFrame=this.backgroundImage,e},Object.defineProperty(t.prototype,"maskNode",{get:function(){return this._maskNode},set:function(e){this._maskNode&&this._maskNode.isValid&&(this._maskNode.destroy(),this._maskNode=null),this._maskNode=e},enumerable:!1,configurable:!0}),t.prototype.setNodeFullSize=function(){if(d.default.log("BaseView:setNodeFullSize",cc.winSize.width,cc.winSize.height),this.node.width=cc.winSize.width,this.node.height=cc.winSize.height,!0===this.isSetBackground){var e=this.createBackgroundNode();if(e){e.parent=this.node,e.setSiblingIndex(0);var t=cc.view.getVisibleSize(),o={width:1280,height:720},i=t.width/o.width,a=t.height/o.height;e.setScale(i,a)}}},t.prototype.backgroundFitScreen=function(e,t){var o=cc.view.getDesignResolutionSize(),i=e.width/o.width,a=e.height/o.height;if(t){var n=e.height/t.height;i>a&&(n=e.width/t.width,t.width*=n)}},t.prototype.__init__=function(e){var t=this;if(this._eventList=new _,"MainSceneView"==this.node.name)if(window.requestAnimationFrame)var o=window.requestAnimationFrame(function(){t.isSetNodeFullSize&&t.setNodeFullSize(),t.adapterUI(),t.init(e),window.cancelAnimationFrame(o)});else setTimeout(function(){t.isSetNodeFullSize&&t.setNodeFullSize(),t.adapterUI(),t.init(e)},200);else this.isSetNodeFullSize&&this.setNodeFullSize(),this.adapterUI(),this.init(e)},t.prototype.adapterUI=function(){var e=this,t=cc.find("UI_Root",this.node);if(t){var i=h.getSafeArea(),a=i.width,n=i.height;i.width<i.height&&(i.width=n,i.height=a);var r=cc.winSize,c=2*i.x+i.width-r.width,l=o.getAdapterUINodeNameList(),u=[],f=function(e){if(e){var t=e.getComponent(cc.Widget);t&&u.push(t)}};if(!l||l.length<=0)for(var g=0,m=t.childrenCount;g<m;g++)f(t.children[g]);else for(g=0,m=l.length;g<m;g++){var _=l[g];f(cc.find(_,t))}var y=function(t,o,i){void 0===i&&(i=!0),u.forEach(function(a){a&&(o&&o(a),i&&!e.onAdapterUINode(t,a)&&(cc.sys.platform!=cc.sys.WECHAT_GAME?(a.isAlignLeft&&a.left>0&&(a.left=25),a.isAlignRight&&a.right>0&&(a.right=25),a.isAlignTop&&a.top>0&&(a.top=10),a.isAlignBottom&&a.bottom>0&&(a.bottom=5),a.updateAlignment()):cc.sys.platform==cc.sys.WECHAT_GAME&&p.GamePlatform.isQQMiniGame&&a.updateAlignment()))})};if(i.width<r.width&&(0!=i.x&&c<=10&&c>=0||"iOS"==cc.sys.os))t.width=i.width,t.height=r.height,y(s.L_TYPE,function(e){e.left=0,e.right>=0&&(e.right=0)});else if(i.width<r.width&&(i.x+i.width==r.width||0==i.x)){var v=0;0==i.x?(v=-(r.width-i.width)/2,y(s.S_TYPE,function(e){e.right>=0&&(e.right=0)},!1)):(v=i.x/2,y(s.S_TYPE,function(e){e.left=0},!1)),t.x=v,t.width=i.width,t.height=i.height,y(s.S_TYPE,null),d.default.info("adapter screen s")}else t.width=t.parent.width,t.height=t.parent.height,y(s.N_TYPE,null),d.default.info("adapter screen n, w="+t.width+",h="+t.height)}else d.default.info("view dont adapter, dont find UI Root")},t.prototype.init=function(){},t.prototype.initUIData=function(){},t.prototype.customAnima=function(e){e&&e()},t.prototype.__viewAnimaHandler__=function(){this.isAnima&&(this.node.scale=0,this.node.opacity=0,cc.tween(this.node).to(.15,{scale:1.2,opacity:255}).to(.1,{scale:1}).call(function(){}).start())},t.prototype.sendEvent=function(e,t){this._eventList.emit(e,t)},t.prototype.__bindEvent__=function(e,t,o){this._eventList.on(e,t,o)},t.prototype.closeView=function(e){var t=this;if(void 0===e&&(e=!0),0==e){var o=this.maskNode;return o&&(o.active=!1),void(this.node.active=!1)}this.isAnima?cc.tween(this.node).to(.1,{scale:1.2}).to(.2,{scale:0,opacity:0}).call(function(){t.onReleaseAsset()||t.defaultReleaseAsset(),l.default.__closeView__(t)}).start():(this.onReleaseAsset()||this.defaultReleaseAsset(),l.default.__closeView__(this))},t.prototype.closeAllPopView=function(){l.default.__closeAllPopView__()},t.prototype.__onClose__=function(){cc.isValid(this)&&(this.maskNode&&this.maskNode.isValid&&(this.maskNode.destroy(),this.maskNode=null),this._eventList&&this._eventList.destroy(),this.onClose(),this.node&&cc.isValid(this.node)&&this.node.destroy())},t.prototype.onClose=function(){},t.prototype.onOpenAnimaComplete=function(){},t.prototype.onOpenAnimaBefore=function(){},t.path=function(){return""},t.anima=function(){return r.NONE},t.isOnlyOne=function(){return!0},t.isAddPreFixPfbPath=function(){return!0},t.isAddMaskSprite=function(){return!0},t.onCreateMaskNode=function(e){return e},t.getAdapterUINodeNameList=function(){return[]},t.prototype.resumeAudio=function(){},t.prototype.backEvent=function(){return!1},t.prototype.onAdapterUINode=function(){return!1},t.prototype.onStopAllSound=function(){return!0},t.prototype.onReleaseAsset=function(){return!1},t.prototype.defaultReleaseAsset=function(){this.pfb&&(d.default.info("release asset ==> ",this.pfb.name),cc.assetManager.releaseAsset(this.pfb),this.pfb=null)},n([m({displayName:"\u586b\u5145\u5230\u5c4f\u5e55\u5c3a\u5bf8",tooltip:"\u8282\u70b9size\u5145\u6ee1\u5c4f\u5e55"})],t.prototype,"isSetNodeFullSize",void 0),n([m({displayName:"\u5f39\u7a97\u52a8\u4f5c"})],t.prototype,"isAnima",void 0),n([m({displayName:"\u8bbe\u7f6e\u80cc\u666f\u56fe",tooltip:"\u8bbe\u7f6eUI\u80cc\u666f\u56fe"})],t.prototype,"isSetBackground",void 0),n([m({displayName:"\u80cc\u666f\u56fe",type:cc.SpriteFrame,tooltip:"\u80cc\u666f\u56fe",visible:function(){return!0===this.isSetBackground}})],t.prototype,"backgroundImage",void 0),o=n([g,u.Register_Class2("BaseView")],t)}(cc.Component);o.default=v,cc._RF.pop()},{"../../utils/GamePlatform":"GamePlatform","../../utils/GameUtils":"GameUtils","../../utils/LogUtil":"LogUtil","../manager/LoadResManager":"LoadResManager","../manager/ViewManager":"ViewManager","./Decorators":"Decorators"}],BatchModel:[function(e,t,o){"use strict";cc._RF.push(t,"8863eRH2LBLPLGqMPffJ2bx","BatchModel"),o.__esModule=!0,o.default=void 0;var i=S(e("../utils/ConfigUtils")),a=S(e("../utils/Tools")),n=S(e("./CombatManager")),r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=C();if(t&&t.has(e))return t.get(e);var o={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var n=i?Object.getOwnPropertyDescriptor(e,a):null;n&&(n.get||n.set)?Object.defineProperty(o,a,n):o[a]=e[a]}return o.default=e,t&&t.set(e,o),o}(e("../common/CombatModule")),s=e("../network/protocol/RoleProtocols"),c=e("../network/ClientNetwork"),l=e("../utils/GamePlatform"),d=e("../network/LocalMessage"),u=e("../network/FightNetwork"),h=e("../utils/ConstValue"),p=S(e("../common/PlayerModule")),f=e("../utils/GameUtils"),g=e("../network/protocol/FightProtocols"),m=e("../modules/manager/cheat/SafeNumber"),_=S(e("../utils/Debug")),y=e("../network/protocol/TypeProtocols"),v=e("../Global/GameGlobal");function C(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return C=function(){return e},e}function S(e){return e&&e.__esModule?e:{default:e}}e("../network/protocol/DataViewRW"),e("../utils/TimeOffSetManager");var T=function(){function e(){this.mapTemplateId=0,this.mapInstanceId=0,this.index=new m.SafeNumber(0),this.deltaTime=0,this.indexTip=new m.SafeNumber(1),this.bDelayTime=!1,this.randBosses=[],this.nBatchDelayTime=0,this.keyBatchIndex=[]}var t=e.prototype;return t.onDestroy=function(){u.FightNetwork.getInstance().removeMessageTarget(this)},t.init=function(e,t,o,i){void 0===o&&(o=0),void 0===i&&(i=1),n.default.getInstance().isPvP()||(this.controller=e,this.mapTemplateId=t,this.index.value=o,this.indexTip.value=i,this.lastTime=0,this.surplusMemCount=0,this.isLastBatch=!1,this.isWin=!1,this.npcId=0,this.bossId=0,this.initRandBossIdArray(),this.initKeyBatchArray(o),this.onlistenProtocol())},t.initRandBossIdArray=function(){var e=this.indexTip.value/10,t=r.default.matchReconnectData,o=i.default.getInstance().getNavigationBatchRandBossCfg();for(var a in r.default.matchType==y.FIGHT_TYPE.FIGHT_TYPE_COOPERATION?o=i.default.getInstance().getBatchRandBossCfg():r.default.matchType==y.FIGHT_TYPE.FIGHT_TYPE_WEEK_COOPERATION?o=i.default.getInstance().getWeekCoopBatchRandBossCfg():r.default.matchType==y.FIGHT_TYPE.FIGHT_TYPE_FOG_HIDDEN?o=i.default.getInstance().getFogHiddenBatchRandBossCfg():r.default.matchType==y.FIGHT_TYPE.FIGHT_TYPE_MACHINARIUM&&(o=i.default.getInstance().getMachineryCityBatchRandBossCfg()),o){var n=o[a=parseInt(a)].boss_list.split("|")[r.default.coopBossIdIndexs[a-1]-1];if(null!=t){if(e<=a){if((this.indexTip.value>=260||r.default.matchType==y.FIGHT_TYPE.FIGHT_TYPE_WEEK_COOPERATION||r.default.matchType==y.FIGHT_TYPE.FIGHT_TYPE_MACHINARIUM)&&e==a)continue;this.randBosses.push(n)}}else this.randBosses.push(n)}if(null!=t){var s=Math.ceil(this.indexTip.value/10),c=r.default.getBatchMonsterId();c||(c=h.COOP_BATCH_ID);var l=i.default.Instance.getBatchConfig(c,this.index.value);r.default.matchType==y.FIGHT_TYPE.FIGHT_TYPE_WEEK_COOPERATION?l=i.default.Instance.getWeekCoopBatchConfig(c,this.index.value):r.default.matchType==y.FIGHT_TYPE.FIGHT_TYPE_MACHINARIUM&&(l=i.default.Instance.getMachineryCityBatchConfig(c,this.index.value));var d=!1;if(!l||1!==l.isBoss&&2!==l.isBoss||(d=!0),1==d){var u=0,p=this.randBosses[0].split("#"),f=Number(p[0]),g=Number(p[1]),m=Number(p[2]);if(f>0){var _=i.default.getInstance().getNpcTemplateConfig(f,m);this.bossConf=_;var v=_.hp;if(_.type==h.NPC_TYPE.Car)u+=v*g;else{var C=i.default.getInstance().getNavigationStarParam(10*s);r.default.matchType==y.FIGHT_TYPE.FIGHT_TYPE_COOPERATION?C=i.default.getInstance().getStarParam(10*s):r.default.matchType==y.FIGHT_TYPE.FIGHT_TYPE_WEEK_COOPERATION?C=i.default.getInstance().getWeekCoopStarParam(10*s):r.default.matchType==y.FIGHT_TYPE.FIGHT_TYPE_FOG_HIDDEN?C=i.default.getInstance().getFogHiddenStarParam(this.index.value):r.default.matchType==y.FIGHT_TYPE.FIGHT_TYPE_MACHINARIUM&&(C=i.default.getInstance().getMachineryCityStarParam(10*s)),C&&(u+=.01*v*C.starParam_hp_coop*g)}}this.totalBossHp=u,this.bossId=1e4*this.indexTip.value+10*this.index.value+1,r.default.matchType==y.FIGHT_TYPE.FIGHT_TYPE_FOG_HIDDEN&&(this.bossId=f),this.randBosses.splice(0,1)}else this.totalBossHp=this.getNextBossTotalHp(!0)}else this.totalBossHp=this.getNextBossTotalHp()},t.calcTotalHp=function(){this.totalHp=0;for(var e=1;e<500;e++){var t=this.getBatchTotalHp(e);if(t<0)break;this.totalHp=this.totalHp+t}this.curHp=this.totalHp},t.addDamage=function(e){this.curHp=this.curHp-e},t.getTotalHp=function(){return this.totalHp},t.getCurHp=function(){return this.curHp},t.getBatchTotalHp=function(e){var t=i.default.getInstance().getBatchConfig(this.mapTemplateId,e);if(r.default.matchType==y.FIGHT_TYPE.FIGHT_TYPE_WEEK_COOPERATION?t=i.default.getInstance().getWeekCoopBatchConfig(this.mapTemplateId,e):r.default.matchType==y.FIGHT_TYPE.FIGHT_TYPE_MACHINARIUM&&(t=i.default.getInstance().getMachineryCityBatchConfig(this.mapTemplateId,e)),!t)return-1;var o=0,a=t.npc_list.split("|");for(var e in a){var n=a[e].split("#"),s=Number(n[0]),c=Number(n[1]),l=Number(n[2]);s<=0||s>0&&(o+=i.default.getInstance().getNpcTemplateConfig(s,c).hp*l)}var d=t.carId.split("#"),u=Number(d[0]);if(c=Number(d[1]),u>0){var h=i.default.getInstance().getCarConfig(u).npc_id;o+=i.default.getInstance().getNpcTemplateConfig(h,c).hp}return o},t.getTotalBossHp=function(){return this.totalBossHp},t.getBossConf=function(){return this.bossConf},t.getNextBossTotalHp=function(e){void 0===e&&(e=!1);var t=0;if(this.randBosses.length>=1&&this.randBosses[0]){var o=this.randBosses[0].split("#"),a=Number(o[0]),n=Number(o[1]),s=Number(o[2]);if(a>0){var c=i.default.getInstance().getNpcTemplateConfig(a,s),l=i.default.getInstance().getResConfig(c.res_id);l&&cc.resources.preload(l.animation,sp.SkeletonData,function(e){e&&_.default.error("getNextBossTotalHp load err errff:"+e.message)}),this.bossConf=c;var d=c.hp;if(c.type==h.NPC_TYPE.Car)t+=d*n;else{var u=this.indexTip.value;e?(u>=260||r.default.matchType==y.FIGHT_TYPE.FIGHT_TYPE_WEEK_COOPERATION||r.default.matchType==y.FIGHT_TYPE.FIGHT_TYPE_MACHINARIUM)&&u%10==0&&(u+=10):(u=this.indexTip.value+1,this.indexTip.value%10<10&&(u=this.indexTip.value+2),r.default.matchType==y.FIGHT_TYPE.FIGHT_TYPE_FOG_HIDDEN&&(u=this.indexTip.value));var p=i.default.getInstance().getNavigationStarParam(10*Math.ceil(u/10));r.default.matchType==y.FIGHT_TYPE.FIGHT_TYPE_COOPERATION?p=i.default.getInstance().getStarParam(10*Math.ceil(u/10)):r.default.matchType==y.FIGHT_TYPE.FIGHT_TYPE_WEEK_COOPERATION?p=i.default.getInstance().getWeekCoopStarParam(10*Math.ceil(u/10)):r.default.matchType==y.FIGHT_TYPE.FIGHT_TYPE_FOG_HIDDEN?p=i.default.getInstance().getFogHiddenStarParam(u):r.default.matchType==y.FIGHT_TYPE.FIGHT_TYPE_MACHINARIUM&&(p=i.default.getInstance().getMachineryCityStarParam(10*Math.ceil(u/10))),t+=.01*d*p.starParam_hp_coop*n}}}return t},t.getCurIndex=function(){return this.index.value},t.getIndexTip=function(){return this.indexTip.value},t.getSurplusMemCnt=function(){return this.surplusMemCount},t.getMemCnt=function(){return 1},t.setNpcStartId=function(){this.npcId=1e4*this.indexTip.value+10*this.index.value},t.update=function(e){if(n.default.getInstance().gameState!=h.Game_State.End)if(this.isLastBatch)0==this.checkCamp2Exist()&&this.onAllNpcDie();else if(1!=this.bDelayTime)if(this.lastTime<0){n.default.getInstance().isCoop()&&(this.nBatchDelayTime=this.nBatchDelayTime+1e3*e);var t=!1;if(n.default.getInstance().isCoop())if(-1==this.lastTime){var o=Number((0,f.getConfigIntValue)("battle_batch_overtime")),a=Number((0,f.getConfigIntValue)("battle_batch_navigation_overtime"));r.default.matchType==y.FIGHT_TYPE.FIGHT_TYPE_BATTLE_GREAT_SAILING&&(o=a),(0==this.checkCamp2Exist()||this.nBatchDelayTime>o)&&(t=!0)}else-2==this.lastTime&&0==this.checkCamp2Exist()&&(t=!0);else 0==this.checkCamp2Exist()&&(t=!0);if(1==t){this.onAllNpcDie();var s=i.default.Instance.getBatchConfig(r.default.getBatchMonsterId(),this.index.value);if(r.default.matchType==y.FIGHT_TYPE.FIGHT_TYPE_WEEK_COOPERATION?s=i.default.getInstance().getWeekCoopBatchConfig(r.default.getBatchMonsterId(),this.index.value):r.default.matchType==y.FIGHT_TYPE.FIGHT_TYPE_MACHINARIUM&&(s=i.default.getInstance().getMachineryCityBatchConfig(r.default.getBatchMonsterId(),this.index.value)),r.default.matchType==y.FIGHT_TYPE.FIGHT_TYPE_FOG_HIDDEN&&s){var c=i.default.getInstance().getFogHiddenBatchRandBossCfg()[1].boss_list.split("|")[0].split("#"),l=Number(c[0]);if(l&&l>0&&n.default.getInstance().lockStepManager){var p=n.default.getInstance().lockStepManager.getMosterBlood(l);null!=p&&null!=p&&p.curBlood<=0&&(this.bossId=-1,u.FightNetwork.getInstance().pushLocalMessage(d.LOCAL_MESSAGE.LocalMsg_CoopBossDead,0))}return}!s||1!==s.isBoss&&2!==s.isBoss||(this.totalBossHp=this.getNextBossTotalHp(),this.bossId=-1,u.FightNetwork.getInstance().pushLocalMessage(d.LOCAL_MESSAGE.LocalMsg_CoopBossDead,this.totalBossHp))}}else this.deltaTime=this.deltaTime+1e3*e,this.deltaTime>this.lastTime&&(1==this.bDanger?this.showBossEffect():(this.loadNextBatch(),this.deltaTime=0))},t.checkCamp2Exist=function(){var e=this.controller.aiCampID?this.controller.aiCampID+1:h.PLAYER_CAMP.opponents,t=(this.controller.aiCampID?this.controller.aiCampID:h.PLAYER_CAMP.myPlayer,n.default.getInstance().getNpcList()),o=0;for(var i in t){var a=t[i];a&&(a.isDead()||a.camp!=e||(o+=1))}return o},t.showBossEffect=function(){this.bDelayTime=!0;var e=this,t=0;this.lastTime<0&&(t=1.5),1==this.bDanger&&this.controller.getSelfCombatModel().camp==h.PLAYER_CAMP.myPlayer&&(a.default.playEffect("combat/effect/qiangdilaixi/qiangdilaixi",this.controller.controller.node,cc.v2(0,0),1.1),t=2),this.controller.controller.scheduleOnce(function(){e.loadNextBatch(),e.bDelayTime=!1,e.deltaTime=0,e.nBatchDelayTime=0},t)},t.onAllNpcDie=function(){if(l.GamePlatform.isWechat()&&wx.triggerGC(),this.isLastBatch){this.controller.aiCampID?this.controller.aiCampID:h.PLAYER_CAMP.myPlayer;var e=r.default.getMatchBattleInfo();if(e&&1==e.bRobot)n.default.getInstance().onGameEnd(!0);else{var t=n.default.getInstance().getSelfCar();if(t){var o=new g.T_Blood_Struct;o.dropBlood=r.default.matchType==y.FIGHT_TYPE.FIGHT_TYPE_FOG_HIDDEN?0:t.maxHp,o.maxBlood=t.getMaxHp(),o.type=t.npcType,t.dropBloodMap.set(p.default.UUID,o)}var i=n.default.getInstance().getCarByCamp(h.PLAYER_CAMP.coopPlayer);if(i){var a=new g.T_Blood_Struct;a.dropBlood=r.default.matchType==y.FIGHT_TYPE.FIGHT_TYPE_FOG_HIDDEN?0:i.maxHp,a.maxBlood=i.getMaxHp(),a.type=i.npcType,i.dropBloodMap.set(p.default.UUID,a)}this.isWin=!0}}else(1==this.bDanger||this.lastTime<0)&&(this.showBossEffect(),this.lastTime<0)&&this.getIndexTip()},t.loadNextBatch=function(){this.index.value=this.index.value+1;var e=r.default.getBatchMonsterId();e||(e=h.COOP_BATCH_ID);var t=i.default.Instance.getBatchConfig(e,this.index.value);if(r.default.matchType==y.FIGHT_TYPE.FIGHT_TYPE_WEEK_COOPERATION?t=i.default.Instance.getWeekCoopBatchConfig(e,this.index.value):r.default.matchType==y.FIGHT_TYPE.FIGHT_TYPE_MACHINARIUM&&(t=i.default.Instance.getMachineryCityBatchConfig(e,this.index.value)),t){this.indexTip.value==t.index_tip&&r.default.matchType!=y.FIGHT_TYPE.FIGHT_TYPE_FOG_HIDDEN||(p.default.checkModulerOnOffState(32)&&this.indexTip.value>269&&this.indexTip.value%10==0&&(console.log("loadNextBatch checkTableMemorySync"),v.G.CheatTables.checkTableMemorySync()),n.default.getInstance().reqFightResult(!1,!0),this.sendKeyBatchToServer()),this.indexTip.value=t.index_tip,this.setNpcStartId(),this.surplusMemCount=t.renshu;var o=t.npc_list.split("|"),a=[];for(var s in o){var c=o[s].split("#");a.push(c)}var l=i.default.getInstance().getNavigationStarParam(this.indexTip.value);r.default.matchType==y.FIGHT_TYPE.FIGHT_TYPE_COOPERATION?l=i.default.getInstance().getStarParam(this.indexTip.value):r.default.matchType==y.FIGHT_TYPE.FIGHT_TYPE_WEEK_COOPERATION?l=i.default.getInstance().getWeekCoopStarParam(this.indexTip.value):r.default.matchType==y.FIGHT_TYPE.FIGHT_TYPE_FOG_HIDDEN?l=i.default.getInstance().getFogHiddenStarParam(this.indexTip.value):r.default.matchType==y.FIGHT_TYPE.FIGHT_TYPE_MACHINARIUM&&(l=i.default.getInstance().getMachineryCityStarParam(this.indexTip.value));var d=.01*l.starParam_att,u=.01*l.starParam_hp;r.default.getCombatType()==r.CombatType.COOP&&(d=.01*l.starParam_att_coop,u=.01*l.starParam_hp_coop);var f=this.controller.aiCampID?this.controller.aiCampID+1:h.PLAYER_CAMP.opponents;if(1===t.isBoss||2===t.isBoss){this.resetCarTmpHp();var g=10*Math.ceil(this.indexTip.value/10);this.indexTip.value<g&&(d=.01*(l=r.default.matchType==y.FIGHT_TYPE.FIGHT_TYPE_COOPERATION?i.default.getInstance().getStarParam(g):r.default.matchType==y.FIGHT_TYPE.FIGHT_TYPE_WEEK_COOPERATION?i.default.getInstance().getWeekCoopStarParam(g):r.default.matchType==y.FIGHT_TYPE.FIGHT_TYPE_FOG_HIDDEN?i.default.getInstance().getFogHiddenStarParam(this.indexTip.value):r.default.matchType==y.FIGHT_TYPE.FIGHT_TYPE_MACHINARIUM?i.default.getInstance().getMachineryCityStarParam(g):i.default.getInstance().getNavigationStarParam(g)).starParam_att_coop,u=.01*l.starParam_hp_coop);for(var m=this.randBosses.splice(0,1)[0].split("#"),_=Number(m[0]),C=Number(m[1]),S=Number(m[2]),T=0,I=0,N=0;N<C;N++){if(this.bossId=this.genId(),2===t.isBoss){var b=i.default.getInstance().getCarConfig(_);b&&n.default.getInstance().summonCoopBossCar(this.bossId,_,b.bind_hero_list)}else r.default.matchType==y.FIGHT_TYPE.FIGHT_TYPE_FOG_HIDDEN&&(this.bossId=_),this.controller.summon(_,S,f,I,T,!1,d,u,this.bossId);T+=50,I+=50}}else for(var s in a)for(c=a[s],_=Number(c[0]),S=1,C=Number(c[1]),T=Number(c[2]),I=0,N=0;N<C;N++)this.controller.summon(_,S,f,I,T,!1,d,u,this.genId()),T+=50,I+=50;this.lastTime=t.time,this.bDanger=t.danger}else this.isLastBatch=!0},t.genId=function(){return this.npcId=this.npcId+1,this.npcId},t.noticeServerNextBatch=function(){if(r.default.getCombatType()==r.CombatType.COOP){var e=new s.C_Role_UpdateChapter;e.chapterId=r.default.getBattleMapId(),e.chapterProgress=this.indexTip.value,c.ClientNetwork.getInstance().Send(s.ROLE_CLIENT_ENUM.P_Role_UpdateChapter,e)}},t.checkKeyBatchOnOff=function(){return p.default.checkModulerOnOffState(48)&&(r.default.matchType==y.FIGHT_TYPE.FIGHT_TYPE_WEEK_COOPERATION||r.default.matchType==y.FIGHT_TYPE.FIGHT_TYPE_COOPERATION||r.default.matchType==y.FIGHT_TYPE.FIGHT_TYPE_MACHINARIUM)},t.initKeyBatchArray=function(e){if(this.checkKeyBatchOnOff())for(var t=1;t<=e;t++)this.keyBatchIndex[t]=!0},t.sendKeyBatchToServer=function(){if(this.checkKeyBatchOnOff()){var e=Number((0,f.getConfigIntValue)("check_key_batch_start_Index"));if(r.default.matchType==y.FIGHT_TYPE.FIGHT_TYPE_COOPERATION?e=Number((0,f.getConfigIntValue)("check_key_coop_batch_start_Index")):r.default.matchType==y.FIGHT_TYPE.FIGHT_TYPE_MACHINARIUM&&(e=Number((0,f.getConfigIntValue)("Machinarium_check_key_batch_start_Index"))),e-=1,this.getIndexTip()>=e&&this.getIndexTip()%10==e%10&&r.default.getCombatType()==r.CombatType.COOP){var t=new g.C_Fight_Key_Batch_Sync;t.roleId=p.default.UUID,t.curIndex=this.getCurIndex(),u.FightNetwork.getInstance().Send(g.FIGHT_CLIENT_ENUM.P_Fight_Key_Batch_Sync,t),this.keyBatchIndex[this.getCurIndex()]=!0,console.log("sendKeyBatchToServer succsee")}}},t.onlistenProtocol=function(){var e=this;if(r.default.getCombatType()==r.CombatType.COOP){if(!this.checkKeyBatchOnOff())return;u.FightNetwork.getInstance().listenProtocol(g.FIGHT_CLIENT_ENUM.P_Fight_Key_Batch_Sync,function(t){t.resetPos();var o=new g.S_Fight_Key_Batch_Sync;if(o.read(t)&&!o.roleId.equals(p.default.UUID)&&!e.keyBatchIndex[o.curIndex]){var i=Number((0,f.getConfigIntValue)("check_key_batch_delay_time"));n.default.getInstance().getController().delayEvent(function(){e.keyBatchIndex[o.curIndex]||(0,f.isReplaced)(h.PLAYER_CAMP.coopPlayer)||(console.log("sendKeyBatchToServer P_Fight_Key_Batch_Sync succsee"),u.FightNetwork.getInstance().Disconnect())},i)}}.bind(this),this)}},t.resetCarTmpHp=function(){var e=n.default.getInstance().getSelfCar();e&&(e.carTmpHp=e.hp);var t=n.default.getInstance().getCarByCamp(h.PLAYER_CAMP.coopPlayer);t&&(t.carTmpHp=t.hp)},e}();o.default=T,t.exports=o.default,cc._RF.pop()},{"../Global/GameGlobal":"GameGlobal","../common/CombatModule":"CombatModule","../common/PlayerModule":"PlayerModule","../modules/manager/cheat/SafeNumber":"SafeNumber","../network/ClientNetwork":"ClientNetwork","../network/FightNetwork":"FightNetwork","../network/LocalMessage":"LocalMessage","../network/protocol/DataViewRW":"DataViewRW","../network/protocol/FightProtocols":"FightProtocols","../network/protocol/RoleProtocols":"RoleProtocols","../network/protocol/TypeProtocols":"TypeProtocols","../utils/ConfigUtils":"ConfigUtils","../utils/ConstValue":"ConstValue","../utils/Debug":"Debug","../utils/GamePlatform":"GamePlatform","../utils/GameUtils":"GameUtils","../utils/TimeOffSetManager":"TimeOffSetManager","../utils/Tools":"Tools","./CombatManager":"CombatManager"}],BatchRandBossTableData:[function(e,t,o){"use strict";cc._RF.push(t,"02930fvkCpJoJVdwV7VI+za","BatchRandBossTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.BatchRandBossTableData=void 0;var i=e("../TableReader"),a=function(){function e(){this.id=0,this.boss_list="",this.level=0}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.boss_list=e.getString(),this.level=e.getNumber()},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"BatchRandBossTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.BatchRandBossTableData=a,cc._RF.pop()},{"../TableReader":"TableReader"}],BattleCardInfo:[function(e,t,o){"use strict";cc._RF.push(t,"446e4gKHgtJNJStxvXXc+VA","BattleCardInfo");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../combat/CombatManager"),s=e("../../utils/GameUtils"),c=e("../../utils/ConfigUtils"),l=e("../../utils/Tools"),d=e("../../utils/ResourcesManager"),u=e("../../modules/base/BaseView"),h=e("../../modules/base/Decorators"),p=e("../../utils/GameTools"),f=e("../../utils/ConstValue"),g=e("../../common/PlayerModule"),m=e("../../Global/GameGlobal"),_=e("../../common/CombatModule"),y=e("../../StaticData/HeroSkinTableData"),v=cc._decorator,C=v.ccclass,S=v.property,T=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.cardsAttrfab=null,t.deleteNode=null,t._bLongTouch=!1,t._coldDown=0,t}return a(t,e),t.path=function(){return"ui/heroCardBag/prefab/battle_card_info"},t.prototype.onLoad=function(){var e=this;this._viewNode=this.node.getChildByName("CardInfoBg"),this._closeNode=this._viewNode.getChildByName("close"),p.default.registerTouchEvent(this._closeNode,function(){e.closeView()}),p.default.registerTouchEvent(this.deleteNode,function(){e.onDeleteCallBack()})},t.prototype.init=function(e){var t=this;if(this.m_data=e,this._heroCfg=c.default.getInstance().getHeroConfig(e.nHeroId),this._heroCfg){if(e.longTouchpre){var o=g.default.getHeroCarData(),i=0;o[e.nHeroId]&&(i=o[e.nHeroId].heroLevel);var a=c.default.getInstance().getNpcTemplateConfig(this._heroCfg.npc_id,i);this._heroData={star:1,level:i,attack:(a.attack*(1+.001*a.attack_inc)).toFixed(0),attackSpeed:a.attack_speed,id:e.nHeroId},this._bLongTouch=e.longTouchpre,this.deleteNode.active=!1}else this._heroData=r.getInstance().getCarByCamp(e.camp).getHeroObjByHeroID(e.nHeroId),r.getInstance().getSelfCar().camp===e.camp&&(this.deleteNode.active=!1,this._coldDown=e.coldDowm,this._coldDown<=0?this.deleteNode.active=!0:this.schedule(function(){t._coldDown-=.1,t._coldDown<=0&&(t.deleteNode.active=!0,t.unscheduleAllCallbacks())},.1));if(this._heroData){if(r.getInstance().getSelfCar().camp===e.camp){if(this._coldDown<=0&&(this.deleteNode.active=!0),!e.longTouchpre){var n=Math.floor(this._heroData.getSellMoreMoney(this._heroData.star,1));this.deleteNode.getChildByName("d_Num").getComponent(cc.Label).string=n.toString()}}else this.deleteNode.active=!1;this.initHeroCardInfo(),e.longTouchpre&&(this.deleteNode.active=!1)}else this.closeView()}else this.closeView()},t.prototype.initHeroCardInfo=function(){var e="ui/cardpic_l/"+this._heroCfg.image,t=_.default.getHeroSkinId(r.getInstance().getSelfCar().camp===this.m_data.camp,this.m_data.nHeroId);if(t>0){var o=y.HeroSkinTableData.getById(t);e=c.default.getInstance().data["StaticData/ItemTableData"][o.itemId].icon}var i=this._viewNode.getChildByName("H_Image");s.setTexture(i.getComponent(cc.Sprite),e);var a=this._viewNode.getChildByName("HeroBg");s.setTexture(a.getComponent(cc.Sprite),"ui/bag/img/"+this._heroCfg.hero_color),a.getChildByName("HeroName").getComponent(cc.Label).string=this._heroCfg.name,a.getChildByName("level_bg").getChildByName("HeroLevel").getComponent(cc.Label).string=this._heroData.level;var n=a.getChildByName("ProfNode");d.default.loadSprite("ui/bag/img/prof"+this._heroCfg.hero_color,n.getComponent(cc.Sprite),function(e){e.addRef()}),d.default.loadSprite("ui/bag/img/"+["zhanshi","lieshou","fashi","mushi","zhaohuan","jingling","xiongmao","gongcheng","renzhe"][this._heroCfg.occupation-1],n.getChildByName("ProSprite").getComponent(cc.Sprite),function(e){e.addRef()}),d.default.loadSprite("ui/bag/img/"+this._heroCfg.hero_color+"b",a.getChildByName("level_bg").getComponent(cc.Sprite),function(e){e.addRef()});var l=a.getChildByName("starLayout");s.setTexture(l.children[1].getComponent(cc.Sprite),"ui/star/"+this._heroData.star),this.initHeroCardAttr()},t.prototype.getNpcTemplateId=function(){var e=this._heroCfg.npc_id,t=_.default.getHeroSkinId(r.getInstance().getSelfCar().camp===this.m_data.camp,this.m_data.nHeroId);return t>0&&(e=1e4*t+this._heroData.id),e},t.prototype.initHeroCardAttr=function(){var e=this._viewNode.getChildByName("cardAttrLayout");e.removeAllChildren();var t=this._heroCfg.occupation,o=this.getNpcTemplateId(),i=c.default.getInstance().getNpcTemplateConfig(o,this._heroData.level),a=i.carhp,n=c.default.getInstance().getSkillConfig(i.skill_id),r=0,s=0;this._bLongTouch?(r=this._heroData.attack,s=this._heroData.attackSpeed):(r=this._heroData.getAttack(),s=this._heroData.getAttackSpeed());var l,d=n.cd/(1+.001*s)/1e3;d<.01&&(d=.01),l=d<.1?d.toFixed(3)+"\u79d2/\u6b21":d.toFixed(2)+"\u79d2/\u6b21";for(var u=[r,f.cardProfDesc[t],l,a],h=0;h<u.length;h++){var p=cc.instantiate(this.cardsAttrfab);p&&(this.setCarAttrInfo(u[h],p,h),e.addChild(p))}this.initHeroCardSkill(),this._viewNode.getChildByName("Skill1").getChildByName("Skill_Desc1").getComponent(cc.Label).string=n.skill_desc},t.prototype.setCarAttrInfo=function(e,t,o){if(3==o)return t.getChildByName("iconBg").active=!0,t.getChildByName("iconBg").scale=1.2,t.getChildByName("icon").scale=1.2,d.default.loadSprite("ui/bag/img/prof"+this._heroCfg.hero_color,t.getChildByName("iconBg").getComponent(cc.Sprite)),d.default.loadSprite("ui/bag/img/"+["zhanshi","lieshou","fashi","mushi","zhaohuan","jingling","xiongmao","gongcheng","renzhe"][this._heroCfg.occupation-1],t.getChildByName("icon").getComponent(cc.Sprite)),t.getChildByName("type").getComponent(cc.Label).string="\u804c\u4e1a\u7c7b\u578b",void(t.getChildByName("num").getComponent(cc.Label).string=["\u6218\u58eb","\u730e\u4eba","\u6cd5\u5e08","\u7267\u5e08","\u53ec\u5524","\u7cbe\u7075","\u718a\u732b","\u5de5\u7a0b","\u672f\u58eb"][this._heroCfg.occupation-1]);var i="ui/card_attricon/"+(o+1),a=t.getChildByName("icon").getComponent(cc.Sprite);s.setTexture(a,i),t.getChildByName("type").getComponent(cc.Label).string=f.cardDescArry[o],t.getChildByName("num").getComponent(cc.Label).string=e,t.getChildByName("iconBg").active=!1,t.getChildByName("icon").scale=1},t.prototype.initHeroCardSkill=function(){var e=this,t=this._viewNode.getChildByName("Skill2").getChildByName("Skill_Desc2");t.getComponent(cc.Label).string=this._heroCfg.passive_desc;var o=this._viewNode.getChildByName("Skill3").getChildByName("Skill_Desc3");o.getComponent(cc.Label).string=this._heroCfg.passive_desc2;for(var i=c.default.getInstance().getHeroTalentTableDataCfg(),a=[],n=0,r=Object.keys(i);n<r.length;n++){var s=r[n];i.hasOwnProperty(s)&&i[s].heroId==this._heroData.id&&a.push(i[s])}a.forEach(function(i){Number(e._heroData.level)>=i.level&&(t.getComponent(cc.Label).string=i.passiveSkilldesc,o.getComponent(cc.Label).string=i.maxPassiveSkilldesc)})},t.prototype.onDeleteCallBack=function(){r.getInstance().gameState!=f.Game_State.Reconnect?(1==r.getInstance().getSelfCombatModel().reqSellHero(this._heroCfg.id)&&((r.getInstance().isCoop()&&s.isRobot(f.PLAYER_CAMP.coopPlayer)||r.getInstance().isPvP()&&s.isRobot(f.PLAYER_CAMP.opponents))&&cc.director.emit("Event_SellHero",f.PLAYER_CAMP.myPlayer,this._heroCfg.id),l.playEffect("combat/effect/jinbi/jinbi",this.node.parent,cc.v2(0,0)),this.closeView()),r.getInstance().getSelfCombatModel().sendHeroSellToServer(this._heroCfg.id)):m.G.StringManager.PopStringOnce(m.G.StringManager.getString("RECONNECT_RESUME"))},n([S(cc.Prefab)],t.prototype,"cardsAttrfab",void 0),n([S(cc.Node)],t.prototype,"deleteNode",void 0),n([h.Register_Class,C],t)}(u.default);o.default=T,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/HeroSkinTableData":"HeroSkinTableData","../../combat/CombatManager":"CombatManager","../../common/CombatModule":"CombatModule","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../utils/ConfigUtils":"ConfigUtils","../../utils/ConstValue":"ConstValue","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils","../../utils/ResourcesManager":"ResourcesManager","../../utils/Tools":"Tools"}],BattleDetailsView:[function(e,t,o){"use strict";cc._RF.push(t,"9f6fdfVmOxIJJBAJEQB53D7","BattleDetailsView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../network/protocol/TypeProtocols"),s=e("../../StaticData/HeroSkinTableData"),c=e("../../utils/ConstValue"),l=e("../../utils/GameTools"),d=e("../../utils/GameUtils"),u=e("../../utils/ResourcesManager"),h=cc._decorator,p=h.ccclass,f=h.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.pvpTitle=null,t.pvpWin=null,t.pvpFail=null,t.coopTitle=null,t.progresses=null,t.coopProgresses=null,t.labels=null,t.myHero=null,t.otherHero=null,t.myTeam=null,t.otherTeam=null,t._bWin=!1,t}return a(t,e),t.prototype.onLoad=function(){this.pvpWin.active=!1},t.prototype.onEnable=function(){},t.prototype.onDestroy=function(){},t.prototype.start=function(){},t.prototype.setData=function(e){d.backgroundFitScreen(this.node,this.node.getChildByName("mask")),this.node.setPosition(0,0);var t=0,o=0,i=0,a=0,n=0,l=0,u=0,h=0,p=0,f=0;e.type==r.FIGHT_TYPE.FIGHT_TYPE_COOPERATION||e.type==r.FIGHT_TYPE.FIGHT_TYPE_FOG_HIDDEN||e.type==r.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE||e.type==r.FIGHT_TYPE.FIGHT_TYPE_WEEK_COOPERATION||e.type==r.FIGHT_TYPE.FIGHT_TYPE_MACHINARIUM?this.coopTitle.active=!0:e.win?this.pvpWin.active=!0:this.pvpFail.active=!0;var g=this.labels.getChildByName("myName").getComponent(cc.Label),m=this.labels.getChildByName("totalDamage").getChildByName("left").getComponent(cc.Label),_=this.labels.getChildByName("maxDamage").getChildByName("left").getComponent(cc.Label),y=this.labels.getChildByName("totalHeal").getChildByName("left").getComponent(cc.Label),v=this.labels.getChildByName("totalSliver").getChildByName("left").getComponent(cc.Label),C=this.labels.getChildByName("totalRefresh").getChildByName("left").getComponent(cc.Label);g&&(g.string=e.myName),t=Number(e.myTotalHarm),m&&(m.string=t.toString()),o=Number(e.myMaxHarm),_.string=o.toString();var S=Number(e.myMaxHarmHero),T=e.myTeam;for(var I in T)T[I]&&T[I].heroID==S&&T[I].skinId>0&&(S=s.HeroSkinTableData.getById(T[I].skinId).itemId);d.setIconByItemId(S,this.myHero.getComponent(cc.Sprite)),i=Number(e.myTotalHeal),y.string=i.toString(),a=Number(e.myTotalSp),v.string=a.toString(),(n=Number(e.myTotalRef))<0&&(n=0),C.string=n.toString(),this.createTeamHeroHead(e.myTeam,c.PLAYER_CAMP.myPlayer);var N=this.labels.getChildByName("otherName").getComponent(cc.Label),b=this.labels.getChildByName("totalDamage").getChildByName("right").getComponent(cc.Label),w=this.labels.getChildByName("maxDamage").getChildByName("right").getComponent(cc.Label),E=this.labels.getChildByName("totalHeal").getChildByName("right").getComponent(cc.Label),P=this.labels.getChildByName("totalSliver").getChildByName("right").getComponent(cc.Label),R=this.labels.getChildByName("totalRefresh").getChildByName("right").getComponent(cc.Label);N&&(N.string=e.otherName),l=Number(e.otherTotalHarm),m&&(b.string=l.toString()),u=Number(e.otherMaxHarm),w.string=u.toString();var L=Number(e.otherMaxHarmHero),A=e.otherTeam;for(var I in A)A[I]&&A[I].heroID==L&&A[I].skinId>0&&(L=s.HeroSkinTableData.getById(A[I].skinId).itemId);d.setIconByItemId(L,this.otherHero.getComponent(cc.Sprite)),h=Number(e.otherTotalHeal),E.string=h.toString(),p=Number(e.otherTotalSp),P.string=p.toString(),(f=Number(e.otherTotalRef))<0&&(f=0),R.string=f.toString();var D=this.progresses,M=c.PLAYER_CAMP.opponents;e.type!=r.FIGHT_TYPE.FIGHT_TYPE_COOPERATION&&e.type!=r.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE&&e.type!=r.FIGHT_TYPE.FIGHT_TYPE_WEEK_COOPERATION&&e.type!=r.FIGHT_TYPE.FIGHT_TYPE_MACHINARIUM||(this.progresses.active=!1,this.coopProgresses.active=!0,D=this.coopProgresses,M=c.PLAYER_CAMP.coopPlayer);var B=D.getChildByName("totalDamage").getComponent(cc.ProgressBar),k=D.getChildByName("maxDamage").getComponent(cc.ProgressBar),G=D.getChildByName("totalHeal").getComponent(cc.ProgressBar),O=D.getChildByName("totalSliver").getComponent(cc.ProgressBar),H=D.getChildByName("totalRefresh").getComponent(cc.ProgressBar);B.progress=t+l==0?.5:t/(t+l),k.progress=o+u==0?.5:o/(o+u),G.progress=i+h==0?.5:i/(i+h),O.progress=a/(a+p),H.progress=n+f==0?.5:n/(n+f),this.createTeamHeroHead(e.otherTeam,M)},t.prototype.createTeamHeroHead=function(e,t){var o=this.myTeam.getComponent(cc.Layout);t!=c.PLAYER_CAMP.myPlayer&&(o=this.otherTeam.getComponent(cc.Layout));var i=function(t){if(!e[t])return{value:void 0};var i=e[t].heroID;e[t].skinId>0&&(i=s.HeroSkinTableData.getById(e[t].skinId).itemId),l.default.createNormalItems(i,e[t].level,o.node,function(o){o.getChildByName("num").active=!1,o.scale=.45;var i=new cc.Node;i.parent=o,i.x=0,i.y=-56,i.scale=1.1,i.addComponent(cc.Sprite),u.default.loadSprite("ui/star/"+e[t].starLevel,i.getComponent(cc.Sprite),function(e){i&&cc.isValid(i)&&(i.getComponent(cc.Sprite).spriteFrame=e)})})};for(var a in e){var n=i(a);if("object"==typeof n)return n.value}},t.prototype.onClose=function(){this.node.removeFromParent()},n([f(cc.Node)],t.prototype,"pvpTitle",void 0),n([f(cc.Node)],t.prototype,"pvpWin",void 0),n([f(cc.Node)],t.prototype,"pvpFail",void 0),n([f(cc.Node)],t.prototype,"coopTitle",void 0),n([f(cc.Node)],t.prototype,"progresses",void 0),n([f(cc.Node)],t.prototype,"coopProgresses",void 0),n([f(cc.Node)],t.prototype,"labels",void 0),n([f(cc.Node)],t.prototype,"myHero",void 0),n([f(cc.Node)],t.prototype,"otherHero",void 0),n([f(cc.Node)],t.prototype,"myTeam",void 0),n([f(cc.Node)],t.prototype,"otherTeam",void 0),n([p],t)}(cc.Component);o.default=g,cc._RF.pop()},{"../../StaticData/HeroSkinTableData":"HeroSkinTableData","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/ConstValue":"ConstValue","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils","../../utils/ResourcesManager":"ResourcesManager"}],BattleGuideCfg:[function(e,t,o){"use strict";cc._RF.push(t,"06df7Inq7NCXI2iA9RgraGZ","BattleGuideCfg"),Object.defineProperty(o,"__esModule",{value:!0}),o.task=void 0;var i=e("../GuideCommand"),a=e("../GuideController"),n=e("./GuideConst"),r=e("../../../combat/CombatManager"),s=e("../../../modules/base/GameView");o.task={name:"\u6218\u6597\u5f15\u5bfc\u914d\u7f6e",steps:[{desc:"\u5bf9\u8bdd1",command:{cmd:i.Command.None,args:1e3}},{desc:"\u5bf9\u8bdd4",onStart:function(e){e()},command:{cmd:i.Command.Dialogue,args:["0",!0]},onEnd:function(e){e(),a.default.Instance.onSendSetGuide(n.default.BattleGuide.guideId)}},{desc:"\u5bf9\u8bdd1",command:[{cmd:i.Command.Dialogue,args:["1",!0]},{cmd:i.Command.Click,args:"GameScene>Down>Down>FightCardView>FCVLayout>card0"}],delayTime:.5,delayClick:0},{desc:"\u5bf9\u8bdd4",onStart:function(e){e()},command:[{cmd:i.Command.Dialogue,args:["2",!0]},{cmd:i.Command.Click,args:"GameScene>Down>Down>car"}],onEnd:function(e){e()},delayTime:4,delayClick:0},{desc:"\u5bf9\u8bdd4",onStart:function(e){e()},command:[{cmd:i.Command.Dialogue,args:["4",!0]},{cmd:i.Command.Click,args:"GameScene>Down>Down>Random"}],onEnd:function(e){e()},delayTime:3,delayClick:0},{desc:"\u5bf9\u8bdd4",onStart:function(e){e()},command:[{cmd:i.Command.Dialogue,args:["3",!0]},{cmd:i.Command.Click,args:"GameScene>Down>Down>FightCardView>FCVLayout>card1"}],onEnd:function(e){e()},delayTime:2,delayClick:0},{desc:"\u5bf9\u8bdd4",onStart:function(e){e()},command:[{cmd:i.Command.Dialogue,args:["11",!0]},{cmd:i.Command.Click,args:"GameScene>Down>Down>Random"}],onEnd:function(e){e()},delayTime:2,delayClick:0},{desc:"\u5bf9\u8bdd4",onStart:function(e){e()},command:[{cmd:i.Command.Dialogue,args:["5",!0]},{cmd:i.Command.Click,args:"GameScene>Down>Down>FightCardView>FCVLayout>card0"}],onEnd:function(e){e()},delayTime:2,delayClick:0},{desc:"\u5bf9\u8bdd4",onStart:function(e){e()},command:[{cmd:i.Command.Dialogue,args:["7",!0]}],onEnd:function(e){e()},delayTime:1,delayClick:0},{desc:"\u7ed3\u675f\u5bf9\u8bdd",onStart:function(e){e()},condition:function(){var e=s.default.getViewByName("BattleCardInfo");e&&e.view&&e.view.closeView();var t=r.getInstance().getSelfCar().getHeroList();return!(!t[1]||10!=t[1].heroTemplateId)},command:[{cmd:i.Command.Dialogue,args:["6",!0]},{cmd:i.Command.Click,args:"GameScene>guideHeroClickNode"}],onEnd:function(e){e()},delayTime:10,delayClick:1}]},cc._RF.pop()},{"../../../combat/CombatManager":"CombatManager","../../../modules/base/GameView":"GameView","../GuideCommand":"GuideCommand","../GuideController":"GuideController","./GuideConst":"GuideConst"}],BattleMap112:[function(e,t,o){"use strict";cc._RF.push(t,"f9f46hwF3lCPajUhZIeHq1B","BattleMap112");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,s=r.ccclass,c=r.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.speed=0,t.bgArr=[],t.curBg=null,t.nextBg=null,t.curIndex=0,t.xy="x",t.wh="w",t}return a(t,e),t.prototype.start=function(){0!=this.bgArr.length&&(1==this.bgArr.length&&(this.bgArr[1]=cc.instantiate(this.bgArr[0]),this.bgArr[0].parent.addChild(this.bgArr[1])),this.xy="x",this.wh="width",this.curBg=this.bgArr[this.curIndex],this.nextBg=this.bgArr[this.curIndex+1],this.setBgPosition())},t.prototype.setBgPosition=function(){this.bgArr[this.curIndex][this.xy]=0,this.bgArr[this.curIndex+1][this.xy]=this.curBg[this.wh]/2+this.nextBg[this.wh]/2},t.prototype.update=function(){this.bgMove()},t.prototype.bgMove=function(){this.curBg[this.xy]-=this.speed,this.nextBg[this.xy]-=this.speed,this.curBg[this.xy]<=-this.curBg[this.wh]&&(this.curBg=this.nextBg,this.nextBg=this.bgArr[this.curIndex++%this.bgArr.length],this.nextBg[this.xy]=this.curBg[this.xy]+this.curBg[this.wh]/2+this.nextBg[this.wh]/2)},n([c({displayName:"\u64ad\u653e\u901f\u5ea6"})],t.prototype,"speed",void 0),n([c({displayName:"\u80cc\u666f\u56fe",type:cc.Node})],t.prototype,"bgArr",void 0),n([s],t)}(cc.Component);o.default=l,cc._RF.pop()},{}],BattlePassIntroduceView:[function(e,t,o){"use strict";cc._RF.push(t,"73629uVoZ5EYZy7gPfmfmmA","BattlePassIntroduceView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=cc._decorator,l=c.ccclass,d=(c.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.path=function(){return"ui/battle_pass/prefab/BattlePassIntroduceView"},n([s.Register_Class,l],t)}(r.default));o.default=d,cc._RF.pop()},{"../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators"}],BattlePassRewardPreview:[function(e,t,o){"use strict";cc._RF.push(t,"a37e18xOg9Gc7TtDVNzd4A/","BattlePassRewardPreview");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../utils/GameTools"),c=e("../../modules/base/Decorators"),l=cc._decorator,d=l.ccclass,u=l.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ScrollView=null,t.RewardNode=null,t._drawCb=null,t}return a(t,e),t.path=function(){return"ui/battle_pass/prefab/BattlePassRewardsPreview"},t.prototype.init=function(e){var t=this;this.RewardNode.getChildByName("lab").active=!1,this.RewardNode.getChildByName("lab1").active=!1,0===e.rewardState?this.RewardNode.active=!1:1===e.rewardState?(this.RewardNode.active=!0,this.RewardNode.getChildByName("lab").active=!0,e.cb&&(this._drawCb=e.cb)):(this.RewardNode.active=!0,this.RewardNode.getComponent(cc.Button).interactable=!1,this.RewardNode.getComponent(cc.Button).enableAutoGrayEffect=!0,this.RewardNode.getChildByName("lab1").active=!0),e.rewards.length>3&&(this.ScrollView.content.getComponent(cc.Layout).spacingX=25),e.rewards.forEach(function(e){s.default.createNormalItems(e.itemID,e.itemNum,t.ScrollView.content,function(e){e.getChildByName("name").active=!0})})},t.prototype.onRewardCallBacks=function(){this._drawCb&&this._drawCb()},n([u(cc.ScrollView)],t.prototype,"ScrollView",void 0),n([u(cc.Node)],t.prototype,"RewardNode",void 0),n([c.Register_Class,d],t)}(r.default);o.default=h,cc._RF.pop()},{"../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../utils/GameTools":"GameTools"}],BattlePassSelectView:[function(e,t,o){"use strict";cc._RF.push(t,"32a55VBwghKT4jWCeVsCnik","BattlePassSelectView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../Global/GameGlobal"),s=e("../../modules/base/BaseView"),c=e("../../modules/base/Decorators"),l=e("../../modules/base/GameView"),d=e("../../network/ClientNetwork"),u=e("../../network/LocalMessage"),h=e("../../StaticData/RechargeTableData"),p=e("../../utils/GamePlatform"),f=e("../../utils/GameTools"),g=e("../../utils/GameUtils"),m=cc._decorator,_=m.ccclass,y=m.property,v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.m_btn_buy=null,t.m_btn_buyRich=null,t}return a(t,e),t.path=function(){return"ui/battle_pass/prefab/BattlePassSelect"},t.prototype.onLoad=function(){},t.prototype.start=function(){var e=this;d.ClientNetwork.getInstance().listenLocalMessage(u.LOCAL_MESSAGE.LocalMsg_RechargeSuccess,function(){e.closeView()},this);var t=f.default.getRechargeMoneyByPlatform(h.RechargeTableData.getById(Number(g.getConfigIntValue("battle_pass_rechargeid"))))/100;this.m_btn_buy.getChildByName("lab").getComponent(cc.Label).string=r.G.StringManager.getString("SUPER_SALE_MONEY",t);var o=f.default.getRechargeMoneyByPlatform(h.RechargeTableData.getById(Number(g.getConfigIntValue("battle_pass_rich_rechargeid"))))/100;this.m_btn_buyRich.getChildByName("lab").getComponent(cc.Label).string=r.G.StringManager.getString("SUPER_SALE_MONEY",o);var i=parseInt(g.getConfigIntValue("battle_pass_rich_rechargeid")),a=h.RechargeTableData.getById(i).prize,n=this.node.getChildByName("reward");n.removeAllChildren();var s=0;a.forEach(function(e){1010==e.dropID&&p.GamePlatform.isQQGameRoom()||f.default.createNormalItemsWithNames(e.dropID,e.dropNum,n,function(e){e.scaleX=e.scaleY=s>0?.7:1,s++})}),this.node.getChildByName("btn_help").on(cc.Node.EventType.TOUCH_END,function(){e.node.getChildByName("tips").active=!0}),this.node.getChildByName("tips").getChildByName("clickNode").on(cc.Node.EventType.TOUCH_END,function(){e.node.getChildByName("tips").active=!1})},t.prototype.init=function(){},t.prototype.addItemNameLabel=function(){var e=new cc.Node;e.addComponent(cc.Label),e.getComponent(cc.Label)},t.prototype.onBuy=function(){var e=this,t=function(){var t={rechargeID:Number(g.getConfigIntValue("battle_pass_rechargeid")),rechargeNum:1};e.sendEvent("SendProtocolRecharge",t)};l.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:"\u8d2d\u4e70\u8c6a\u534e\u7248\u540e\uff0c\u5c06\u5931\u53bb\u8d2d\u4e70\u8c6a\u534e\u5178\u85cf\u7248\u7684\u673a\u4f1a\uff0c\u662f\u5426\u786e\u8ba4\u8d2d\u4e70\u8c6a\u534e\u7248\uff1f",confirmCb:function(){t.call(e)}})},t.prototype.onBuyRich=function(){var e={rechargeID:Number(g.getConfigIntValue("battle_pass_rich_rechargeid")),rechargeNum:1};this.sendEvent("SendProtocolRecharge",e)},t.prototype.onHelp=function(){},t.prototype.onDestroy=function(){},n([y(cc.Node)],t.prototype,"m_btn_buy",void 0),n([y(cc.Node)],t.prototype,"m_btn_buyRich",void 0),n([c.Register_Class,_],t)}(s.default);o.default=v,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/RechargeTableData":"RechargeTableData","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/base/GameView":"GameView","../../network/ClientNetwork":"ClientNetwork","../../network/LocalMessage":"LocalMessage","../../utils/GamePlatform":"GamePlatform","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils"}],BattlePassTableData:[function(e,t,o){"use strict";cc._RF.push(t,"c7843myRkhAZIZZPMhVtuDv","BattlePassTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.BattlePassTableData=void 0;var i=e("../TableReader"),a=e("./BaseTableData"),n=function(){function e(){this.id=0,this.seasonId=0,this.coinNum=0,this.itemName="",this.itemIcon="",this.itemScale=0,this.extraItemName="",this.extraItemIcon="",this.extraItemScale=0,this.pointX=0,this.prize=new Array,this.extraPrize=new Array,this.heroId=0,this.heroNpcScale=0}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.seasonId=e.getNumber(),this.coinNum=e.getNumber(),this.itemName=e.getString(),this.itemIcon=e.getString(),this.itemScale=e.getNumber(),this.extraItemName=e.getString(),this.extraItemIcon=e.getString(),this.extraItemScale=e.getNumber(),this.pointX=e.getNumber();for(var o=e.getString(),n=new i.TableReader(o);n.getPos()<n.getLen();)(s=new a.ItemInfo).readOriginal(n),this.prize.push(s);o=e.getString();for(var r=new i.TableReader(o);r.getPos()<r.getLen();){var s;(s=new a.ItemInfo).readOriginal(r),this.extraPrize.push(s)}this.heroId=e.getNumber(),this.heroNpcScale=e.getNumber()},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"BattlePassTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.BattlePassTableData=n,cc._RF.pop()},{"../TableReader":"TableReader","./BaseTableData":"BaseTableData"}],BattlePassView:[function(e,t,o){"use strict";cc._RF.push(t,"12487/8rYVJYbtM33mkPUeN","BattlePassView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/manager/LoadResManager"),c=e("../../utils/LogUtil"),l=e("../../Global/GameGlobal"),d=e("../../common/PlayerModule"),u=e("../../modules/base/Decorators"),h=e("../../StaticData/RechargeTableData"),p=e("../../utils/GameUtils"),f=e("../../StaticData/BattlePassTableData"),g=e("../../network/protocol/TypeProtocols"),m=e("../../utils/GameTools"),_=e("../../modules/base/GameView"),y=e("../../utils/ConfigUtils"),v=e("../../network/ClientNetwork"),C=e("../../StaticData/StringValueTableData"),S=e("../../network/LocalMessage"),T=e("../../StaticData/CostGetTableData"),I=e("../../common/NetworkProtocolCommon"),N=e("../../StaticData/LuckyGiftSelectTableData"),b=e("../../network/protocol/RoleProtocols"),w=cc._decorator,E=w.ccclass,P=w.property,R=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.itemPrefab=null,t.ScrollView=null,t.progressBarNode=null,t.buyBtnNode=null,t.curTrophyNode=null,t.propUpNode=null,t.m_select_node=null,t._scrollViewChildNode=[],t.rewardCount=0,t._curSeasonData=[],t.m_seasonId_buyRich=20,t.m_saveSelectHeroId=0,t}return a(t,e),t.path=function(){return"ui/battle_pass/prefab/BattlePass"},t.prototype.onLoad=function(){var e=this,t=d.default.getRoleAttrValByKey(g.ROLE_ATTR_VALUES.ROLE_ATTR_BATTLE_PASS),o=d.default.getRoleAttrValByKey(g.ROLE_ATTR_VALUES.ROLE_ATTR_BATTLEPASS_SELECT);if(t&&t>0&&(!o||o<=0)){var i=[],a=N.LuckyGiftSelectTableData.getById(Number(p.getConfigIntValue("battlePass_choose"))).prize,n=d.default.getCurSeasonData();a.forEach(function(e){2==y.default.getInstance().getItemByID(e.itemID).type&&n.seasonID>=e.season&&i.push(e)}),d.default.setRoleAttrValByKey(g.ROLE_ATTR_VALUES.ROLE_ATTR_BATTLEPASS_SELECT,i[0].itemID)}s.default.loadPrefab("ui/CommonPrefab/TopView").then(function(t){t.parent=e.node,t.getChildByName("goldDiamondContent").active=!1,t.getComponent("TopView").bindExitEvent(function(){e.closeView();var t=_.default.getViewByName("MainSceneView");t&&t.view&&t.view.onBattlePassRedPoint()})}).catch(function(e){c.default.info(e)}),this.ScrollView.node.active=!1,v.ClientNetwork.getInstance().listenProtocol(b.ROLE_CLIENT_ENUM.P_Role_BattlePass_Select,function(t){t.resetPos();var o=new b.S_ROle_BattlePass_Select;o.read(t)&&0===o.errorcode&&e.onRefreshSelectCardInfo()},this),v.ClientNetwork.getInstance().listenProtocol(b.ROLE_CLIENT_ENUM.P_Role_BattlePass_GetReward,function(t){t.resetPos();var o=new b.S_Role_BattlePass_GetReward;if(o.read(t))if(0===o.errorcode){var i=_.default.getViewByName("BattlePassRewardPreview");i&&i.view&&(i.view.node.active=!1,i.view.closeView()),d.default.getCurSeasonData()||c.default.log("\u6ca1\u6709\u8d5b\u5b63\u6570\u636e"),e.rewardCount=0,e.tRewards=o.prize,e.onShowPopupRewards();for(var a=0,n=e._scrollViewChildNode.length;a<n;a++)if(e._scrollViewChildNode[a].isValid){var r=e._scrollViewChildNode[a].getChildByName("RewardsNode"),s=e._scrollViewChildNode[a].getChildByName("ExtraRewardsNode"),u=e.checkReceiveState(r.coinNum,!0),h=e.checkReceiveState(s.coinNum,!1);2==u?(m.default.setNodeBright(r,!1),e._scrollViewChildNode[a].getChildByName("waifaguangReward").active=!1):e._scrollViewChildNode[a].getChildByName("waifaguangReward").active=1==u,2==h?(m.default.setNodeBright(s,!1,!1),s.children.forEach(function(e){m.default.setNodeBright(e,!1,!1)}),s.getChildByName("ExtraRewardsIcon")&&s.getChildByName("ExtraRewardsIcon").children.forEach(function(e){1==e.active&&cc.tween(e).delay(.2).call(function(){e.getComponent(sp.Skeleton).setAnimation(0,"idle2",!0)}).start()}),e._scrollViewChildNode[a].getChildByName("waifaguang").active=!1):e._scrollViewChildNode[a].getChildByName("waifaguang").active=1==h,s.receiveState=h}e.onRefreshTotalBtnState()}else c.default.info(o),3==o.errorcode&&l.G.StringManager.PopString(C.StringValueTableData.getById(15).string_value)},this),v.ClientNetwork.getInstance().listenLocalMessage(S.LOCAL_MESSAGE.LocalMsg_RechargeSuccess,function(){if(cc.isValid(e)){e.buyBtnNode.active=!1,e.scheduleOnce(function(){var t=d.default.getRoleAttrValByKey(g.ROLE_ATTR_VALUES.ROLE_ATTR_BATTLE_PASS);if(t&&t>0)try{e.m_select_node.parent.getChildByName("ChangeBtnNode").active=!1}catch(o){}},.5);for(var t=function(t){if(e._scrollViewChildNode[t].isValid){var o=e._scrollViewChildNode[t].getChildByName("ExtraRewardsNode");o.getChildByName("suo").active=!1,o.active=!0,e._scrollViewChildNode[t].getChildByName("SceleBtnNode").active=!1,e._scrollViewChildNode[t].getChildByName("SelectHeroNode").active=!1;var i=d.default.getRoleAttrValByKey(g.ROLE_ATTR_VALUES.ROLE_ATTR_BATTLEPASS_SELECT);1==e.checkPurpleHero(o.reawds[0].itemID)&&i&&i>0&&s.default.loadSpriteFrame("ui/battle_pass/res/battlePass_"+i).then(function(i){cc.isValid(e._scrollViewChildNode[t])&&(o.getChildByName("ExtraRewardsIcon").getComponent(cc.Sprite).spriteFrame=i)});var a=d.default.getRoleAttrValByKey(g.ROLE_ATTR_VALUES.ROLE_ATTR_BATTLEPASS_SELECT_GOLD);1==e.checkIsGoldCard(o.reawds[0].itemID)&&a&&a>0&&s.default.loadSpriteFrame("ui/battle_pass/res/battlePass_"+a).then(function(i){cc.isValid(e._scrollViewChildNode[t])&&(o.getChildByName("ExtraRewardsIcon").getComponent(cc.Sprite).spriteFrame=i)})}},o=0,i=e._scrollViewChildNode.length;o<i;o++)t(o);setTimeout(function(){for(var t=0,o=e._scrollViewChildNode.length;t<o;t++)if(e._scrollViewChildNode[t].isValid){var i=e._scrollViewChildNode[t].getChildByName("ExtraRewardsNode"),a=e.checkReceiveState(i.coinNum,!1);2==a?(m.default.setNodeBright(i,!1,!1),i.children.forEach(function(e){m.default.setNodeBright(e,!1,!1)}),i.getChildByName("ExtraRewardsIcon")&&i.getChildByName("ExtraRewardsIcon").children.forEach(function(e){1==e.active&&cc.tween(e).delay(.2).call(function(){e.getComponent(sp.Skeleton).setAnimation(0,"idle2",!0)}).start()}),e._scrollViewChildNode[t].getChildByName("waifaguang").active=!1):e._scrollViewChildNode[t].getChildByName("waifaguang").active=1==a,i.receiveState=a}e.onRefreshTotalBtnState()},500)}},this);var r=d.default.getCurSeasonData();r||c.default.log("\u6ca1\u6709\u8d5b\u5b63\u6570\u636e"),f.BattlePassTableData.getDataMap().forEach(function(t){r.seasonID==t.seasonId&&e._curSeasonData.push(t)})},t.prototype.start=function(){var e=this;this.ScrollView.node.active=!1;var t=this._curSeasonData;this.progressBarNode.width=t[t.length-1].pointX,this.ScrollView.content.width=55+this.progressBarNode.width+this.node.getChildByName("LeftNode").width+this.itemPrefab.width/2,this.initLaissezPasserItem(),this.scheduleOnce(function(){e.onScrollToPoint(),e.ScrollView.node.active=!0},.1),this.node.getChildByName("TopCoinNode").getChildByName("titleTimeLab").getComponent(cc.Label).string=d.default.getItemCountByBag(Number(p.getConfigIntValue("battle_pass_currency"))),m.default.registerTouchEvent(this.node.getChildByName("TopCoinNode1"),function(){e.propUpNode.active=!e.propUpNode.active}),m.default.registerTouchEvent(this.node.getChildByName("TopCoinNode"),function(){_.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{view:"BattlePassView",confirmCb:function(){if(d.default.diamondNum<Number(T.CostGetTableData.getById(1).cost[0].itemNum))return l.G.StringManager.PopString("\u5269\u4f59\u94bb\u77f3\u4e0d\u8db3\uff01");I.default.callRoleCostGet(T.CostGetTableData.getById(1).id)}})}),this.refreshGoldAnimation(),this.onRefreshTotalBtnState(),this.onSetShowProgress()},t.prototype.init=function(){this.onRefreshSeasonEndTime(),this.schedule(this.onRefreshSeasonEndTime,30),this.ScrollView.node.active=!1,this.ScrollView.node.width=this.node.width,this.ScrollView.node.getChildByName("view").width=this.node.width,this.ScrollView.node.x=-this.node.width/2,this.node.getChildByName("vVsibleNode").width=this.node.width,this.onShowActivateState()},t.prototype.onScrollToPoint=function(){for(var e=!1,t=d.default.getItemCountByBag(Number(p.getConfigIntValue("battle_pass_currency"))),o=0,i=this._curSeasonData.length;o<i;o++){var a=(u=this._curSeasonData[o]).coinNum;if(a){var n=this.checkReceiveState(a,!0),r=this.checkReceiveState(a,!1);if(1==n||1==r){var s=this.ScrollView.getMaxScrollOffset(),c=u.pointX>s.x?s.x:u.pointX;this.ScrollView.setContentPosition(cc.v2(-c+this.itemPrefab.width,0)),e=!0;break}}}if(0==e){var l=null;for(o=0,i=this._curSeasonData.length;o<i;o++){var u;(u=this._curSeasonData[o]).coinNum&&t>=u.coinNum&&(l=u)}l&&(s=this.ScrollView.getMaxScrollOffset(),c=l.pointX>s.x?s.x:l.pointX,this.ScrollView.setContentPosition(cc.v2(-c+this.itemPrefab.width,0)))}},t.prototype.onScrollViewCallBack=function(){for(var e=this.node.getChildByName("vVsibleNode").getBoundingBoxToWorld(),t=0,o=this._scrollViewChildNode.length;t<o;t++){var i=1==this._scrollViewChildNode[t].getBoundingBoxToWorld().intersects(e)?255:0;this._scrollViewChildNode[t].isValid&&this._scrollViewChildNode[t].opacity!=i&&(this._scrollViewChildNode[t].opacity=i)}},t.prototype.onRefreshTotalBtnState=function(){var e=this,t=[];this._curSeasonData.forEach(function(o){var i,a=e.checkReceiveState(o.coinNum,!0),n=e.checkReceiveState(o.coinNum,!1);1==a&&((i=new b.T_BattlePassData).index=o.coinNum,i.type=1,t.push(i)),1==n&&((i=new b.T_BattlePassData).index=o.coinNum,i.type=2,t.push(i))}),t.length<=0?(this.node.getChildByName("DrawButton").getComponent(cc.Button).interactable=!1,this.node.getChildByName("DrawButton").getComponent(cc.Button).enableAutoGrayEffect=!0):(this.node.getChildByName("DrawButton").getComponent(cc.Button).interactable=!0,this.node.getChildByName("DrawButton").getComponent(cc.Button).enableAutoGrayEffect=!1)},t.prototype.onShowActivateState=function(){var e=d.default.getRoleAttrValByKey(g.ROLE_ATTR_VALUES.ROLE_ATTR_BATTLE_PASS);if(e&&0!=e)this.buyBtnNode.active=!1;else{this.buyBtnNode.active=!0;var t=d.default.getCurSeasonData();if(!t)return l.G.StringManager.PopString("\u5f53\u524d\u8d5b\u5b63\u6570\u636e\u5f02\u5e38");if(t.seasonID<this.m_seasonId_buyRich){var o=m.default.getRechargeMoneyByPlatform(h.RechargeTableData.getById(Number(p.getConfigIntValue("battle_pass_rechargeid"))))/100;this.buyBtnNode.getChildByName("Background").getChildByName("Label").getComponent(cc.Label).string=l.G.StringManager.getString("SUPER_SALE_MONEY",o)}else this.buyBtnNode.getChildByName("Background").getChildByName("Label").getComponent(cc.Label).string=l.G.StringManager.getString("BATTLEPASS_OPENBUY")}},t.prototype.onSetShowProgress=function(){var e=null;this.curTrophyNode.x=10;var t=this._curSeasonData,o=0,i=d.default.getItemCountByBag(Number(p.getConfigIntValue("battle_pass_currency")));if(t.forEach(function(t,a){i>=t.coinNum&&(e=t,o=a)}),e){var a=t[o+1];if(a){var n=i-e.coinNum,r=a.coinNum-e.coinNum,s=(a.pointX-e.pointX)*(n/r),c=e.pointX+s;this.curTrophyNode.x=c,isNaN(this.curTrophyNode.x)&&(this.curTrophyNode.x=10),this.progressBarNode.getChildByName("bar").width=c}else this.progressBarNode.getChildByName("bar").width=this.progressBarNode.width,this.curTrophyNode.x=this.progressBarNode.width-10}this.curTrophyNode.getChildByName("CoinLabel").getComponent(cc.Label).string=i.toString()},t.prototype.initLaissezPasserItem=function(){var e=this,t=this._curSeasonData,o=t.length,i=0;this.schedule(function(){e.onCreateLaissezPasserItem(t[i]),e.curTrophyNode.setSiblingIndex(99),i++},0,o-1,0)},t.prototype.onCreateLaissezPasserItem=function(e){var t=this,o=cc.instantiate(this.itemPrefab);o.parent=this.progressBarNode,o.x=e.pointX,o.active=!0,o.coinNum=e.coinNum,this._scrollViewChildNode.push(o);var i=o.getChildByName("RewardsNode");i.reawds=e.prize,i.coinNum=e.coinNum,s.default.loadSpriteFrame(e.itemIcon).then(function(t){cc.isValid(o)&&(i.getChildByName("RewardsIcon").scale=i.getChildByName("RewardsIcon").scale*e.itemScale/100,i.getChildByName("RewardsIcon").getComponent(cc.Sprite).spriteFrame=t)}).catch(function(e){cc.error(e)}),i.getChildByName("RewardsName").getComponent(cc.Label).string=e.itemName;var a=this.checkReceiveState(e.coinNum,!0);2==a?(m.default.setNodeBright(i,!1),o.getChildByName("waifaguangReward").active=!1):o.getChildByName("waifaguangReward").active=1==a,i.receiveState=a,m.default.registerTouchEvent(i,function(e){var o=e.target;if(o.reawds.length>1)_.default.addPopView("BaseCtrl","BattlePassRewardPreview","BattlePassRewardPreview",{cb:function(){var e=new b.T_BattlePassData;e.index=o.coinNum,e.type=1,t.onRequestBattlePassGetReward([e])},rewards:o.reawds,rewardState:o.receiveState});else{if(2==o.receiveState)return l.G.StringManager.PopString(C.StringValueTableData.getById(15).string_value);if(1==o.receiveState){var i=new b.T_BattlePassData;i.index=o.coinNum,i.type=1,t.onRequestBattlePassGetReward([i])}else t.checkRewardIsHero(o.reawds[0])&&_.default.addPopView("BaseCtrl","DrawNewHeroCardView","DrawNewHeroCardView",{heroId:o.reawds[0].itemID,bShowNew:!0,bAction:!0})}}),o.getChildByName("CoinBg").getChildByName("CoinNum").getComponent(cc.Label).string=e.coinNum.toString(),d.default.getItemCountByBag(Number(p.getConfigIntValue("battle_pass_currency")))>=e.coinNum&&s.default.loadSpriteFrame("ui/battle_pass/res/bei1").then(function(e){cc.isValid(o)&&(o.getChildByName("CoinBg").getComponent(cc.Sprite).spriteFrame=e)});var n=o.getChildByName("ExtraRewardsNode");n.reawds=e.extraPrize,n.coinNum=e.coinNum,n.getChildByName("ExtraRewardsIcon").scale=n.getChildByName("ExtraRewardsIcon").scale*e.extraItemScale/100;var r=e.extraItemIcon.split("/");n.getChildByName("ExtraRewardsIcon").children[0].active=!1,n.getChildByName("ExtraRewardsIcon").children[1].active=!1,"baoxiang2"!=r[r.length-1]&&"baoxiang1"!=r[r.length-1]||("baoxiang2"==r[r.length-1]?(n.getChildByName("ExtraRewardsIcon").children[1].active=!0,n.getChildByName("ExtraRewardsIcon").children[1].getComponent(sp.Skeleton).setAnimation(0,"idle",!0)):(n.getChildByName("ExtraRewardsIcon").children[0].active=!0,n.getChildByName("ExtraRewardsIcon").children[0].getComponent(sp.Skeleton).setAnimation(0,"idle",!0))),n.getChildByName("ExtraRewardsName").getComponent(cc.Label).string=e.extraItemName;var c=this.checkReceiveState(e.coinNum,!1);2==c?(m.default.setNodeBright(n,!1,!1),n.children.forEach(function(e){m.default.setNodeBright(e,!1,!1)}),n.getChildByName("ExtraRewardsIcon")&&n.getChildByName("ExtraRewardsIcon").children.forEach(function(e){1==e.active&&cc.tween(e).delay(.2).call(function(){e.getComponent(sp.Skeleton).setAnimation(0,"idle2",!0)}).start()}),o.getChildByName("waifaguang").active=!1):o.getChildByName("waifaguang").active=1==c,n.receiveState=c;var u=d.default.getRoleAttrValByKey(g.ROLE_ATTR_VALUES.ROLE_ATTR_BATTLE_PASS);u&&0!=u?n.getChildByName("suo").active=!1:(n.getChildByName("suo").active=!0,m.default.registerTouchEvent(n.getChildByName("suo"),function(){l.G.StringManager.PopString("\u5f00\u901a\u8c6a\u534e\u7248\u540e\u53ef\u89e3\u9501")})),m.default.registerTouchEvent(n,function(e){var o=e.target;if(o.reawds)if(o.reawds.length>1)_.default.addPopView("BaseCtrl","BattlePassRewardPreview","BattlePassRewardPreview",{cb:function(){var e=d.default.getRoleAttrValByKey(g.ROLE_ATTR_VALUES.ROLE_ATTR_BATTLE_PASS);if(!e||0==e)return l.G.StringManager.PopString("\u672a\u6fc0\u6d3b");var i=new b.T_BattlePassData;i.index=o.coinNum,i.type=2,t.onRequestBattlePassGetReward([i])},rewards:o.reawds,rewardState:o.receiveState});else{if(2==o.receiveState)return l.G.StringManager.PopString(C.StringValueTableData.getById(15).string_value);if(1==o.receiveState){var i=d.default.getRoleAttrValByKey(g.ROLE_ATTR_VALUES.ROLE_ATTR_BATTLE_PASS);if(!i||0==i)return;var a=new b.T_BattlePassData;a.index=o.coinNum,a.type=2,t.onRequestBattlePassGetReward([a])}else{var n=t.checkPurpleHero(o.reawds[0].itemID),r=d.default.getRoleAttrValByKey(g.ROLE_ATTR_VALUES.ROLE_ATTR_BATTLEPASS_SELECT),s=t.checkIsGoldCard(o.reawds[0].itemID),c=d.default.getRoleAttrValByKey(g.ROLE_ATTR_VALUES.ROLE_ATTR_BATTLEPASS_SELECT_GOLD);t.checkRewardIsHero(o.reawds[0])&&(1==n&&r>0?_.default.addPopView("BaseCtrl","DrawNewHeroCardView","DrawNewHeroCardView",{heroId:r,bShowNew:!0,bAction:!0}):1==s&&c>0?_.default.addPopView("BaseCtrl","DrawNewHeroCardView","DrawNewHeroCardView",{heroId:c,bShowNew:!0,bAction:!0}):_.default.addPopView("BaseCtrl","DrawNewHeroCardView","DrawNewHeroCardView",{heroId:o.reawds[0].itemID,bShowNew:!0,bAction:!0}))}}}),this.extraStateInfo(o,e.extraItemIcon)},t.prototype.extraStateInfo=function(e,t){void 0===t&&(t="");var o=e.getChildByName("SceleBtnNode"),i=e.getChildByName("SelectHeroNode"),a=e.getChildByName("ExtraRewardsNode"),n=d.default.getCurSeasonData();if(n){if(1==this.checkIsGoldCard(a.reawds[0].itemID))return this.showExtraGoldCard(e,t);if(n.seasonID<Number(p.getConfigIntValue("battlePass_choose_begin")))o.active=!1,i.active=!1,s.default.loadSpriteFrame(t).then(function(e){cc.isValid(a)&&(a.getChildByName("ExtraRewardsIcon").getComponent(cc.Sprite).spriteFrame=e)});else{var r=d.default.getRoleAttrValByKey(g.ROLE_ATTR_VALUES.ROLE_ATTR_BATTLE_PASS),c=d.default.getRoleAttrValByKey(g.ROLE_ATTR_VALUES.ROLE_ATTR_BATTLEPASS_SELECT);if(o.itemId=a.reawds[0].itemID,i.children[0].itemId=a.reawds[0].itemID,s.default.loadSpriteFrame("ui/battle_pass/res/zixuan").then(function(e){cc.isValid(o)&&(o.getComponent(cc.Sprite).spriteFrame=e)}),r&&0!=r)if(o.active=!1,i.active=!1,a.active=!0,1==this.checkPurpleHero(a.reawds[0].itemID)){if(!c||c<=0)return;s.default.loadSpriteFrame("ui/battle_pass/res/battlePass_"+c).then(function(e){cc.isValid(a)&&(a.getChildByName("ExtraRewardsIcon").getComponent(cc.Sprite).spriteFrame=e)}),l=y.default.getInstance().getItemByID(c),a.getChildByName("ExtraRewardsName").getComponent(cc.Label).string=l.name+"X"+a.reawds[0].itemNum,i.getChildByName("SelectCardName").getComponent(cc.Label).string=l.name+"X"+a.reawds[0].itemNum}else s.default.loadSpriteFrame(t).then(function(e){cc.isValid(a)&&(a.getChildByName("ExtraRewardsIcon").getComponent(cc.Sprite).spriteFrame=e)});else if(1==this.checkPurpleHero(a.reawds[0].itemID))if(0==c)a.active=!1,o.active=!0,i.active=!1;else{a.active=!1,o.active=!1,i.active=!0,s.default.loadSpriteFrame("ui/battle_pass/res/battlePass_"+c).then(function(e){cc.isValid(i)&&(i.getComponent(cc.Sprite).spriteFrame=e)});var l=y.default.getInstance().getItemByID(c);a.getChildByName("ExtraRewardsName").getComponent(cc.Label).string=l.name+"X"+a.reawds[0].itemNum,i.getChildByName("SelectCardName").getComponent(cc.Label).string=l.name+"X"+a.reawds[0].itemNum}else a.active=!0,o.active=!1,i.active=!1,s.default.loadSpriteFrame(t).then(function(e){cc.isValid(a)&&(a.getChildByName("ExtraRewardsIcon").getComponent(cc.Sprite).spriteFrame=e)})}}},t.prototype.showExtraGoldCard=function(e,t){void 0===t&&(t="");var o=d.default.getCurSeasonData();if(o){var i=e.getChildByName("SceleBtnNode"),a=e.getChildByName("SelectHeroNode"),n=e.getChildByName("ExtraRewardsNode");if(o.seasonID<Number(p.getConfigIntValue("battlePass_gold_choose_begin")))i.active=!1,a.active=!1,s.default.loadSpriteFrame(t).then(function(e){cc.isValid(n)&&(n.getChildByName("ExtraRewardsIcon").getComponent(cc.Sprite).spriteFrame=e)});else{var r=d.default.getRoleAttrValByKey(g.ROLE_ATTR_VALUES.ROLE_ATTR_BATTLE_PASS),c=d.default.getRoleAttrValByKey(g.ROLE_ATTR_VALUES.ROLE_ATTR_BATTLEPASS_SELECT_GOLD);if(i.itemId=n.reawds[0].itemID,a.children[0].itemId=n.reawds[0].itemID,this.m_select_node.itemId=n.reawds[0].itemID,this.m_select_node.parent.getChildByName("ChangeBtnNode").itemId=n.reawds[0].itemID,s.default.loadSpriteFrame("ui/battle_pass/res/jinxuan").then(function(e){cc.isValid(i)&&(i.getComponent(cc.Sprite).spriteFrame=e)}),r&&0!=r)if(i.active=!1,a.active=!1,n.active=!0,1==this.checkIsGoldCard(n.reawds[0].itemID)){if(!c||c<=0)return;s.default.loadSpriteFrame("ui/battle_pass/res/battlePass_"+c).then(function(e){cc.isValid(n)&&(n.getChildByName("ExtraRewardsIcon").getComponent(cc.Sprite).spriteFrame=e)}),l=y.default.getInstance().getItemByID(c),n.getChildByName("ExtraRewardsName").getComponent(cc.Label).string=l.name+"X"+n.reawds[0].itemNum,a.getChildByName("SelectCardName").getComponent(cc.Label).string=l.name+"X"+n.reawds[0].itemNum}else s.default.loadSpriteFrame(t).then(function(e){cc.isValid(n)&&(n.getChildByName("ExtraRewardsIcon").getComponent(cc.Sprite).spriteFrame=e)});else if(1==this.checkIsGoldCard(n.reawds[0].itemID))if(0==c)n.active=!1,i.active=!0,a.active=!1;else{n.active=!1,i.active=!1,a.active=!0,s.default.loadSpriteFrame("ui/battle_pass/res/battlePass_"+c).then(function(e){cc.isValid(a)&&(a.getComponent(cc.Sprite).spriteFrame=e)});var l=y.default.getInstance().getItemByID(c);n.getChildByName("ExtraRewardsName").getComponent(cc.Label).string=l.name+"X"+n.reawds[0].itemNum,a.getChildByName("SelectCardName").getComponent(cc.Label).string=l.name+"X"+n.reawds[0].itemNum}else n.active=!0,i.active=!1,a.active=!1,s.default.loadSpriteFrame(t).then(function(e){cc.isValid(n)&&(n.getChildByName("ExtraRewardsIcon").getComponent(cc.Sprite).spriteFrame=e)})}}},t.prototype.checkRewardIsHero=function(e){return!!y.default.getInstance().data["StaticData/HeroTableData"].hasOwnProperty(e.itemID)},t.prototype.checkReceiveState=function(e,t){if(0==t){var o=d.default.getRoleAttrValByKey(g.ROLE_ATTR_VALUES.ROLE_ATTR_BATTLE_PASS);if(!o||0==o)return 0}var i=1;d.default.getItemCountByBag(Number(p.getConfigIntValue("battle_pass_currency")))<e&&(i=0);var a=d.default.getCurSeasonData();return a||(i=0),(t?a.foreverScorePrize:a.scorePrize).forEach(function(t,o){o==e&&t.isPrize&&(i=2)}),i},t.prototype.onRefreshSeasonEndTime=function(){var e=this.node.getChildByName("titleTimeLab").getComponent(cc.Label),t=d.default.getCurSeasonData();if(t||c.default.log("\u6ca1\u6709\u8d5b\u5b63\u6570\u636e"),t.seasonID<=0)return c.default.log("\u6ca1\u6709\u8d5b\u5b63\u6570\u636e");var o=d.default.getServersTime(),i=t.seasonEndTime-o;if(i<=0)return e.node.active=!1,void this.unschedule(this.onRefreshSeasonEndTime);e.string=l.G.StringManager.getString("SEASON_END")+function(e){var t=e%864e5/36e5,o=e%36e5/6e4;return parseInt((e/864e5).toString())+" \u5929 "+parseInt(t.toString())+" \u5c0f\u65f6 "+parseInt(o.toString())+" \u5206\u949f "}.call(this,1e3*i)},t.prototype.openBuyRichView=function(){_.default.addPopView("ShopMainCtrl","BattlePassSelectView","BattlePassSelectView")},t.prototype.onBuyCallBack=function(){var e=this,t=d.default.getCurSeasonData();if(!t)return l.G.StringManager.PopString("\u5f53\u524d\u8d5b\u5b63\u6570\u636e\u5f02\u5e38");var o=function(){if(t.seasonID<e.m_seasonId_buyRich){var o={rechargeID:Number(p.getConfigIntValue("battle_pass_rechargeid")),rechargeNum:1};e.sendEvent("SendProtocolRecharge",o)}else e.openBuyRichView()};if(t.seasonID<Number(p.getConfigIntValue("battlePass_choose_begin")))return o.call(this);if(d.default.getRoleAttrValByKey(g.ROLE_ATTR_VALUES.ROLE_ATTR_BATTLEPASS_SELECT)<=0)return l.G.StringManager.PopString(l.G.StringManager.getString("EVERYDAY_RECHARGE"));var i=d.default.getRoleAttrValByKey(g.ROLE_ATTR_VALUES.ROLE_ATTR_BATTLEPASS_SELECT_GOLD);if(t.seasonID>=Number(p.getConfigIntValue("battlePass_gold_choose_begin"))&&i<=0)return l.G.StringManager.PopString(l.G.StringManager.getString("BATTLEPASS_SELECT_GOLD_TIP"));_.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:l.G.StringManager.getString("BUY_BATTLEPASS_TIP"),confirmCb:function(){o.call(e)}})},t.prototype.onRequestBattlePassGetReward=function(e){var t=new b.C_Role_BattlePass_GetReward;t.getRewards=e,v.ClientNetwork.getInstance().Send(b.ROLE_CLIENT_ENUM.P_Role_BattlePass_GetReward,t)},t.prototype.onTotalGetRewardCallBack=function(){var e=this,t=[];if(this._curSeasonData.forEach(function(o){var i,a=e.checkReceiveState(o.coinNum,!0),n=e.checkReceiveState(o.coinNum,!1);1==a&&((i=new b.T_BattlePassData).index=o.coinNum,i.type=1,t.push(i)),1==n&&((i=new b.T_BattlePassData).index=o.coinNum,i.type=2,t.push(i))}),t.length<=0)return l.G.StringManager.PopString(C.StringValueTableData.getById(10).string_value);this.onRequestBattlePassGetReward(t)},t.prototype.onShowPopupRewards=function(){var e=this,t=this.tRewards.slice(6*this.rewardCount,6*(this.rewardCount+1));t.length>0&&_.default.addPopView("BaseCtrl","AcquirePopupView","AcquirePopupView",{items:t,closeCb:function(){e.rewardCount++,e.onShowPopupRewards()}})},t.prototype.onHelpCallBack=function(){_.default.addPopView("BaseCtrl","BattlePassIntroduceView","BattlePassIntroduceView")},t.prototype.update_pass_currency=function(){if(this.node){this.node.getChildByName("TopCoinNode").getChildByName("titleTimeLab").getComponent(cc.Label).string=d.default.getItemCountByBag(Number(p.getConfigIntValue("battle_pass_currency"))),this.onSetShowProgress(),this.onRefreshTotalBtnState();for(var e=0,t=this._scrollViewChildNode.length;e<t;e++)if(this._scrollViewChildNode[e].isValid){var o=this._scrollViewChildNode[e].getChildByName("RewardsNode"),i=this._scrollViewChildNode[e].getChildByName("ExtraRewardsNode"),a=this.checkReceiveState(o.coinNum,!0),n=this.checkReceiveState(i.coinNum,!1);2==a?(m.default.setNodeBright(o,!1),this._scrollViewChildNode[e].getChildByName("waifaguangReward").active=!1):this._scrollViewChildNode[e].getChildByName("waifaguangReward").active=1==a,2==n?(m.default.setNodeBright(i,!1,!1),i.children.forEach(function(e){m.default.setNodeBright(e,!1,!1)}),i.getChildByName("ExtraRewardsIcon")&&i.getChildByName("ExtraRewardsIcon").children.forEach(function(e){1==e.active&&cc.tween(e).delay(.2).call(function(){e.getComponent(sp.Skeleton).setAnimation(0,"idle2",!0)}).start()}),this._scrollViewChildNode[e].getChildByName("waifaguang").active=!1):this._scrollViewChildNode[e].getChildByName("waifaguang").active=1==n,o.receiveState=a,i.receiveState=n}}},t.prototype.checkPurpleHero=function(e){var t=y.default.getInstance().getItemByID(e);return 2==t.type&&3==t.quality},t.prototype.onClickSelectCallback=function(e){var t=this,o=e.target.itemId,i=!0;1==this.checkPurpleHero(o)&&(i=!1);var a=[],n=N.LuckyGiftSelectTableData.getById(Number(p.getConfigIntValue("battlePass_choose"))).prize;1==i&&(n=N.LuckyGiftSelectTableData.getById(Number(p.getConfigIntValue("battlePass_choose_gold"))).prize);var r=d.default.getCurSeasonData();n.forEach(function(e){2==y.default.getInstance().getItemByID(e.itemID).type&&r.seasonID>=e.season&&a.push(e)}),_.default.addPopView("BaseCtrl","SelectHeroCardRewardView","SelectHeroCardRewardView",{rewards:a,selectId:1==i?d.default.getRoleAttrValByKey(g.ROLE_ATTR_VALUES.ROLE_ATTR_BATTLEPASS_SELECT_GOLD):d.default.getRoleAttrValByKey(g.ROLE_ATTR_VALUES.ROLE_ATTR_BATTLEPASS_SELECT),cb:function(e){t.onRequestSelectHeroCardId(e)}})},t.prototype.onRefreshSelectCardInfo=function(){var e=!0;if(1==this.checkPurpleHero(this.m_saveSelectHeroId)&&(e=!1),0==e){if((r=d.default.getRoleAttrValByKey(g.ROLE_ATTR_VALUES.ROLE_ATTR_BATTLEPASS_SELECT))<=0)return;for(var t=0,o=this._scrollViewChildNode.length;t<o;t++)if(this._scrollViewChildNode[t].isValid){var i=this._scrollViewChildNode[t].getChildByName("SelectHeroNode"),a=this._scrollViewChildNode[t].getChildByName("ExtraRewardsNode");if(1==this.checkPurpleHero(a.reawds[0].itemID)){this.extraStateInfo(this._scrollViewChildNode[t]);var n=y.default.getInstance().getItemByID(r);a.getChildByName("ExtraRewardsName").getComponent(cc.Label).string=n.name+"X"+a.reawds[0].itemNum,i.getChildByName("SelectCardName").getComponent(cc.Label).string=n.name+"X"+a.reawds[0].itemNum}}}else{var r;if((r=d.default.getRoleAttrValByKey(g.ROLE_ATTR_VALUES.ROLE_ATTR_BATTLEPASS_SELECT_GOLD))<=0)return;for(t=0,o=this._scrollViewChildNode.length;t<o;t++)this._scrollViewChildNode[t].isValid&&(i=this._scrollViewChildNode[t].getChildByName("SelectHeroNode"),a=this._scrollViewChildNode[t].getChildByName("ExtraRewardsNode"),1==this.checkIsGoldCard(a.reawds[0].itemID)&&(this.showExtraGoldCard(this._scrollViewChildNode[t]),n=y.default.getInstance().getItemByID(r),a.getChildByName("ExtraRewardsName").getComponent(cc.Label).string=n.name+"X"+a.reawds[0].itemNum,i.getChildByName("SelectCardName").getComponent(cc.Label).string=n.name+"X"+a.reawds[0].itemNum));this.refreshGoldAnimation()}},t.prototype.onRequestSelectHeroCardId=function(e){var t=new b.C_ROle_BattlePass_Select;t.selectId=e,v.ClientNetwork.getInstance().Send(b.ROLE_CLIENT_ENUM.P_Role_BattlePass_Select,t),this.m_saveSelectHeroId=e},t.prototype.checkIsGoldCard=function(e){var t=y.default.getInstance().getItemByID(e);return 2==t.type&&4==t.quality},t.prototype.refreshGoldAnimation=function(){var e=this,t=0,o=d.default.getCurSeasonData();if(o){if((t=o.seasonID<Number(p.getConfigIntValue("battlePass_gold_choose_begin"))?this._curSeasonData[0].heroId:d.default.getRoleAttrValByKey(g.ROLE_ATTR_VALUES.ROLE_ATTR_BATTLEPASS_SELECT_GOLD))<=0)return this.m_select_node.active=!0;this.m_select_node.parent.getChildByName("jinsejiahaodizuo").active=!0,this.m_select_node.parent.getChildByName("ChangeBtnNode").active=!1,this.node.getChildByName("LeftNode").getChildByName("GoldAnimationNode")&&this.node.getChildByName("LeftNode").getChildByName("GoldAnimationNode").destroy();var i=y.default.getInstance().getHeroConfig(t),a=y.default.getInstance().getNpcTemplateConfig(i.npc_id,1).res_id,n=y.default.getInstance().getResConfig(a).uiScale;s.default.loadSpineNode(y.default.getInstance().getResConfig(a).animation).then(function(t){t.parent=e.node.getChildByName("LeftNode"),t.getComponent(sp.Skeleton).setAnimation(0,"idle",!0),o.seasonID<Number(p.getConfigIntValue("battlePass_gold_choose_begin"))?t.scale=.01*e._curSeasonData[0].heroNpcScale:t.scale=t.scale*(n-15)/100,t.x=-10,t.y=-110,t.name="GoldAnimationNode"}).catch(function(e){c.default.info(e)}),this.m_select_node.active=!1,this.m_select_node.parent.getChildByName("jinsejiahaodizuo").active=!1,o.seasonID<Number(p.getConfigIntValue("battlePass_gold_choose_begin"))?this.m_select_node.parent.getChildByName("ChangeBtnNode").active=!1:this.m_select_node.parent.getChildByName("ChangeBtnNode").active=!0,this.m_select_node.parent.getChildByName("ChangeBtnNode").itemId=this.m_select_node.itemId,this.m_select_node.parent.getChildByName("ChangeBtnNode").zIndex=9;var r=d.default.getRoleAttrValByKey(g.ROLE_ATTR_VALUES.ROLE_ATTR_BATTLE_PASS);r&&r>0&&(this.m_select_node.parent.getChildByName("ChangeBtnNode").active=!1)}},t.prototype.onDestroy=function(){v.ClientNetwork.getInstance().removeMessageTarget(this)},n([P(cc.Node)],t.prototype,"itemPrefab",void 0),n([P(cc.ScrollView)],t.prototype,"ScrollView",void 0),n([P(cc.Node)],t.prototype,"progressBarNode",void 0),n([P(cc.Node)],t.prototype,"buyBtnNode",void 0),n([P(cc.Node)],t.prototype,"curTrophyNode",void 0),n([P(cc.Node)],t.prototype,"propUpNode",void 0),n([P(cc.Node)],t.prototype,"m_select_node",void 0),n([u.Register_Class,E],t)}(r.default);o.default=R,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/BattlePassTableData":"BattlePassTableData","../../StaticData/CostGetTableData":"CostGetTableData","../../StaticData/LuckyGiftSelectTableData":"LuckyGiftSelectTableData","../../StaticData/RechargeTableData":"RechargeTableData","../../StaticData/StringValueTableData":"StringValueTableData","../../common/NetworkProtocolCommon":"NetworkProtocolCommon","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/base/GameView":"GameView","../../modules/manager/LoadResManager":"LoadResManager","../../network/ClientNetwork":"ClientNetwork","../../network/LocalMessage":"LocalMessage","../../network/protocol/RoleProtocols":"RoleProtocols","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/ConfigUtils":"ConfigUtils","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils","../../utils/LogUtil":"LogUtil"}],BattleRoomMainView:[function(e,t,o){"use strict";cc._RF.push(t,"2da19Y5vYRGTK7AlaxTupYm","BattleRoomMainView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/GameView"),s=e("../../modules/base/BaseView"),c=e("../../modules/base/Decorators"),l=e("../../common/PlayerModule"),d=e("../../utils/GameUtils"),u=e("../../utils/GameTools"),h=e("../../Global/GameGlobal"),p=e("../../common/CombatModule"),f=e("../../network/ClientNetwork"),g=e("../../network/protocol/MatchProtocols"),m=e("../../network/protocol/TypeProtocols"),_=e("../../network/protocol/ChatProtocols"),y=e("../../network/protocol/long"),v=e("../../network/protocol/BaseProtocols"),C=e("../../utils/GamePlatform"),S=e("../../utils/WechatUtils"),T=e("../../utils/QQMiniGameUtils"),I=e("../../utils/ByteDanceMiniGameUtils"),N=e("../../utils/QQGameHallUtils"),b=e("../../utils/KSMinigameUtils"),w=e("../skyCastle/SkyCastleModule"),E=e("../../StaticData/ChatChannelTableData"),P=e("../../utils/ResourcesManager"),R=e("../../StaticData/ActivityTableData"),L=e("../../network/protocol/ActivityProtocols"),A=e("../../common/EventConst"),D=e("../../modules/manager/EventManager"),M=e("../../common/CommandValue"),B=e("../activity/ActivityModule"),k=e("../../common/NetworkProtocolCommon"),G=e("../heroCardBag/HeroSkinUtils"),O=e("../../StaticData/HeroSkinTableData"),H=e("../machineryCityActivity/MachineryCityModel"),V=cc._decorator,F=V.ccclass,U=V.property,x=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.m_layoutFightGroup=null,t.m_nodeFightHeros=null,t.m_nodeWithFriend=null,t.m_nodeCreateRoom=null,t.m_labelRoomID=null,t.m_nodeJoinRoom=null,t.m_soloTitle=null,t.m_coopTitle=null,t.m_chatNode=null,t.m_btn_coopSweep=null,t.m_skyTitleNode=null,t.m_weekCoopTitleNode=null,t.m_FogHiddenTitleNode=null,t.m_MachineryCityTitleNode=null,t.m_JoinRoomTipLab=null,t.m_pFightHeros=null,t.m_nCurCombatType=p.CombatType.DUEL,t.m_strEditRoom="",t}return a(t,e),t.path=function(){return"ui/match/matchMain"},t.prototype.onLoad=function(){var e=this;if(C.GamePlatform.getMiYa()||C.GamePlatform.isByteDanceMiniGame()||C.GamePlatform.isQQGameRoom()||C.GamePlatform.isQQMiniGame()||C.GamePlatform.IsSmallBag()||C.GamePlatform.IsH5SmallBag()||C.GamePlatform.IsMiYaIosH5()||C.GamePlatform.isKuaishouMiniGame()){var t=this.node.getChildByName("step3-1").getChildByName("btn_wechat"),o=this.node.getChildByName("step3-1").getChildByName("btn_chat");t.active=!1,o.setPosition(0,-120)}f.ClientNetwork.getInstance().listenProtocol(g.MATCH_CLIENT_ENUM.P_Match_Duel_Fight,function(t){t.resetPos();var o=new g.S_Match_Duel_Fight;if(o.read(t)){if(0!=o.errorcode)return void(9===o.errorcode?h.G.StringManager.PopStringOnce(h.G.StringManager.getString("COOP_TIMES_NOTENOUGH")):13===o.errorcode?h.G.StringManager.PopStringOnce(h.G.StringManager.getString("MATCH_ROOM_FAIL_HAVE")):18===o.errorcode?h.G.StringManager.PopWorldString(h.G.StringManager.getWorldString("sky_battle_score_limit_tip2")):19===o.errorcode?h.G.StringManager.PopString(h.G.StringManager.getString("MACHINERYCITY_TIP4")):8089===o.errorcode?(e.closeView(),r.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:h.G.StringManager.getString("BATTLE_VERSION_NOT_MATCH"),confirmCb:function(){C.GamePlatform.isWechat()?wx.exitMiniProgram():C.GamePlatform.isQQMiniGame()&&qq.exitMiniProgram()}})):h.G.StringManager.PopStringOnce(h.G.StringManager.getString("MATCH_ROOM_FAIL")));e.m_nodeWithFriend.active=!1,e.m_nodeCreateRoom.active=!0,e.m_nodeJoinRoom.active=!1,e.m_labelRoomID.string=o.roomID;var i=r.default.getViewByName("SkyCastleArenaView");i&&i.view&&(i.view.setChatViewVisible(!1),P.default.loadSprite("ui/skyCastleActivity/image/chatbg",e.m_chatNode.getChildByName("msgNode").getComponent(cc.Sprite)),e.m_chatNode.y=-310,e.m_chatNode.x=-15);var a=r.default.getViewByName("WeekCooperationReliveMainView");a&&a.view&&(a.view.setChatViewVisible(!1),e.m_chatNode.y=-150,e.m_chatNode.x=545,e.m_chatNode.parent=e.node,e.m_chatNode.getChildByName("msgNode").width=300,e.m_chatNode.getChildByName("msgNode").getChildByName("label_chat").width=210,e.m_chatNode.getChildByName("msgNode").getChildByName("label_chat").x=-290);var n=r.default.getViewNodeByName("FogHiddenMainView");n&&(n.getComponent("FogHiddenMainView").setChatViewVisible(!1),e.m_chatNode.y=-208);var s=r.default.getViewNodeByName("MachineryCityMainView");s&&(P.default.loadSprite("ui/machineryCityActivity/image/chat_bg",e.m_chatNode.getChildByName("msgNode").getComponent(cc.Sprite)),e.m_chatNode.y=-208,s.getComponent("MachineryCityMainView").setChatViewVisible(!1)),e.m_chatNode.active=!0;var c=r.default.getViewByName("MainSceneView");c&&c.view&&(c.view.onSetChatBtnNodeActive(!1),c.view._chatNode.parent=this.node)}}.bind(this),this)},t.prototype.start=function(){this.m_btn_coopSweep.active=!1,this.onCheckCoopSweepShow()},t.prototype.onDestroy=function(){if(""!=this.m_labelRoomID.string){var e=new g.C_Match_Duel_Cancel;e.roomID=this.m_labelRoomID.string,e.longRoomID=this.m_labelRoomID.string,f.ClientNetwork.getInstance().Send(g.MATCH_CLIENT_ENUM.P_Match_Duel_Cancel,e)}},t.prototype.init=function(e){var t=this;if(this.m_nCurCombatType=e.CombatType,r.default.getViewNodeByName("MachineryCityMainView")){var o=H.default.Instance.getTodayFightCards();o&&o.length>0&&o.forEach(function(e){var o=e,i=G.default.Instance.getCurSkinIdByHeroUUID(null,e);i>0&&(o=O.HeroSkinTableData.getById(i).itemId),u.default.createNormalItems(o,1,t.m_layoutFightGroup.node,function(e){e.getChildByName("num").active=!1})})}else for(var i in this.m_pFightHeros=l.default.getBattleHeroCarData(l.default.fightHeroArrayIndex),this.m_pFightHeros)if(this.m_pFightHeros[i]){var a=this.m_pFightHeros[i]._heroId,n=G.default.Instance.getCurSkinIdByHeroUUID(null,a);n>0&&(a=O.HeroSkinTableData.getById(n).itemId),u.default.createNormalItems(a,this.m_pFightHeros[i]._heroLevel,this.m_layoutFightGroup.node,function(e){e.getChildByName("num").active=!1})}if(this.m_nCurCombatType==p.CombatType.COOP){this.m_weekCoopTitleNode.active=!1,this.m_coopTitle.active=!0,this.m_FogHiddenTitleNode.active=!1,this.m_MachineryCityTitleNode.active=!1;var s=r.default.getViewByName("SkyCastleArenaView");if(s&&s.view){this.m_skyTitleNode.children.forEach(function(e){e.active=!1});var c=w.default.Instance.getCurCastleSkyType();c<0&&(c=0),c>=m.SKYCASTLE_TYPE.SKYCASTLE_TYPE_NIGHTMARE?this.m_skyTitleNode.children[c-1].active=!0:this.m_skyTitleNode.children[c].active=!0}var d=r.default.getViewByName("WeekCooperationReliveMainView");d&&d.view&&(this.m_coopTitle.active=!1,this.m_weekCoopTitleNode.active=!0),r.default.getViewNodeByName("FogHiddenMainView")&&(this.m_FogHiddenTitleNode.active=!0,this.m_coopTitle.active=!1,this.m_weekCoopTitleNode.active=!1),r.default.getViewNodeByName("MachineryCityMainView")&&(this.m_coopTitle.active=!1,this.m_weekCoopTitleNode.active=!1,this.m_MachineryCityTitleNode.active=!0)}else this.m_soloTitle.active=!0},t.prototype.onClickClose=function(){var e=new g.C_Match_Duel_Cancel;""!=this.m_labelRoomID.string&&(e.roomID=this.m_labelRoomID.string,e.longRoomID=this.m_labelRoomID.string),f.ClientNetwork.getInstance().Send(g.MATCH_CLIENT_ENUM.P_Match_Duel_Cancel,e),this.m_labelRoomID.string="",this.m_chatNode.active=!1;var t=r.default.getViewNodeByName("MachineryCityMainView"),o=r.default.getViewNodeByName("FogHiddenMainView"),i=r.default.getViewByName("WeekCooperationReliveMainView"),a=r.default.getViewByName("SkyCastleArenaView");a&&a.view?a.view.setChatViewVisible(!0):i&&i.view?i.view.setChatViewVisible(!0):o?o.getComponent("FogHiddenMainView").setChatViewVisible(!0):t&&t.getComponent("MachineryCityMainView").setChatViewVisible(!0),this.closeView()},t.prototype.onClickQuickMatch=function(){var e=this;this.m_nCurCombatType==p.CombatType.SOLO&&l.default.getRoleAttrValByKey(m.ROLE_ATTR_VALUES.ROLE_ATTR_DAY_BATTLE_NUM)>=Number(d.getConfigIntValue("battle_num_day"))?r.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:h.G.StringManager.getString("QUICK_MATCH_LIMIT_TIP",Number(d.getConfigIntValue("battle_num_day"))),confirmCb:function(){e.onClickClose(),r.default.addPopView("BaseCtrl","MatchMainView","MatchMainView",{ntype:e.m_nCurCombatType})},cancelCb:function(){}}):(this.onClickClose(),r.default.addPopView("BaseCtrl","MatchMainView","MatchMainView",{ntype:this.m_nCurCombatType}))},t.prototype.onClickWithFriend=function(){this.m_nodeFightHeros.active=!1,this.m_nodeWithFriend.active=!0;var e=this.m_nodeWithFriend.getChildByName("desc");if(this.m_nCurCombatType==p.CombatType.COOP){e.getChildByName("pvp2").active=!1,e.getChildByName("ppve2").active=!0,e.getChildByName("skyLab").active=!1,e.getChildByName("weekCooperationLab").active=!1,e.getChildByName("FogHiddenLab").active=!1,e.getChildByName("MachineryCityLab").active=!1;var t=r.default.getViewByName("SkyCastleArenaView");t&&t.view&&(e.getChildByName("ppve2").active=!1,e.getChildByName("skyLab").active=!0);var o=r.default.getViewByName("WeekCooperationReliveMainView");o&&o.view&&(e.getChildByName("ppve2").active=!1,e.getChildByName("weekCooperationLab").active=!0),r.default.getViewNodeByName("FogHiddenMainView")&&(e.getChildByName("ppve2").active=!1,e.getChildByName("FogHiddenLab").active=!0),r.default.getViewNodeByName("MachineryCityMainView")&&(e.getChildByName("ppve2").active=!1,e.getChildByName("MachineryCityLab").active=!0)}else e.getChildByName("pvp2").active=!0,e.getChildByName("ppve2").active=!1,e.getChildByName("skyLab").active=!1,e.getChildByName("weekCooperationLab").active=!1,e.getChildByName("MachineryCityLab").active=!1},t.prototype.onClickCreateRoom=function(){if(B.default.isChickenDinnerMatching())return h.G.StringManager.PopString(h.G.StringManager.getString("CHICKENDINNER_MATCHING")),k.default.callRoleClientLog("CHICKENDINNER_MATCHING7"),void console.log("isChickenDinnerMatching code=7");var e=new g.C_Match_Duel_Fight;if(this.m_nCurCombatType==p.CombatType.SOLO)e.fightType=m.FIGHT_TYPE.FIGHT_TYPE_DUEL_BATTLE;else if(this.m_nCurCombatType==p.CombatType.COOP){e.fightType=m.FIGHT_TYPE.FIGHT_TYPE_COOPERATION;var t=r.default.getViewByName("SkyCastleArenaView");t&&t.view&&(e.fightType=m.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE);var o=r.default.getViewByName("WeekCooperationReliveMainView");o&&o.view&&(e.fightType=m.FIGHT_TYPE.FIGHT_TYPE_WEEK_COOPERATION),r.default.getViewNodeByName("FogHiddenMainView")&&(e.fightType=m.FIGHT_TYPE.FIGHT_TYPE_FOG_HIDDEN),r.default.getViewNodeByName("MachineryCityMainView")&&(e.fightType=m.FIGHT_TYPE.FIGHT_TYPE_MACHINARIUM)}e.useRoom=0,e.params.push(d.getConfigVersion()),f.ClientNetwork.getInstance().Send(g.MATCH_CLIENT_ENUM.P_Match_Duel_Fight,e)},t.prototype.onClickSendToWechat=function(){if(C.GamePlatform.isWechat()){var e="battle=";if(this.m_nCurCombatType==p.CombatType.SOLO)e+=m.FIGHT_TYPE.FIGHT_TYPE_DUEL_BATTLE;else if(this.m_nCurCombatType==p.CombatType.COOP){var t=r.default.getViewNodeByName("MachineryCityMainView"),o=r.default.getViewByName("SkyCastleArenaView"),i=r.default.getViewByName("WeekCooperationReliveMainView"),a=r.default.getViewNodeByName("FogHiddenMainView");o&&o.view?e+=m.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE:i&&i.view?e+=m.FIGHT_TYPE.FIGHT_TYPE_WEEK_COOPERATION:e+=a?m.FIGHT_TYPE.FIGHT_TYPE_FOG_HIDDEN:t?m.FIGHT_TYPE.FIGHT_TYPE_MACHINARIUM:m.FIGHT_TYPE.FIGHT_TYPE_COOPERATION}e+="."+this.m_labelRoomID.string,console.log("onClickSendToWechat query:"+e);var n=h.G.StringManager.getString("INVITE_BATTLE_TIP");S.WechatUtils.getInstance().inviteFriend(n,"2DC1rbGjRzmIjqMbqJXuvA==","https://tfjl-1300944069.file.myqcloud.com/invite.png",e,S.ShareType.BattleRoom)}else C.GamePlatform.isQQMiniGame()?(e="battle=",this.m_nCurCombatType==p.CombatType.SOLO?e+=m.FIGHT_TYPE.FIGHT_TYPE_DUEL_BATTLE:this.m_nCurCombatType==p.CombatType.COOP&&(t=r.default.getViewNodeByName("MachineryCityMainView"),o=r.default.getViewByName("SkyCastleArenaView"),i=r.default.getViewByName("WeekCooperationReliveMainView"),a=r.default.getViewNodeByName("FogHiddenMainView"),o&&o.view?e+=m.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE:i&&i.view?e+=m.FIGHT_TYPE.FIGHT_TYPE_WEEK_COOPERATION:e+=a?m.FIGHT_TYPE.FIGHT_TYPE_FOG_HIDDEN:t?m.FIGHT_TYPE.FIGHT_TYPE_MACHINARIUM:m.FIGHT_TYPE.FIGHT_TYPE_COOPERATION),e+="."+this.m_labelRoomID.string,console.log("onClickSendToQQ query:"+e),n=h.G.StringManager.getString("INVITE_BATTLE_TIP"),T.QQMiniGameUtils.getInstance().inviteFriend(n,"2DC1rbGjRzmIjqMbqJXuvA==","https://tfjl-1300944069.file.myqcloud.com/invite.png",e,S.ShareType.BattleRoom)):C.GamePlatform.isByteDanceMiniGame()?(e="battle=",this.m_nCurCombatType==p.CombatType.SOLO?e+=m.FIGHT_TYPE.FIGHT_TYPE_DUEL_BATTLE:this.m_nCurCombatType==p.CombatType.COOP&&(t=r.default.getViewNodeByName("MachineryCityMainView"),o=r.default.getViewByName("SkyCastleArenaView"),i=r.default.getViewByName("WeekCooperationReliveMainView"),a=r.default.getViewNodeByName("FogHiddenMainView"),o&&o.view?e+=m.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE:i&&i.view?e+=m.FIGHT_TYPE.FIGHT_TYPE_WEEK_COOPERATION:e+=a?m.FIGHT_TYPE.FIGHT_TYPE_FOG_HIDDEN:t?m.FIGHT_TYPE.FIGHT_TYPE_MACHINARIUM:m.FIGHT_TYPE.FIGHT_TYPE_COOPERATION),e+="."+this.m_labelRoomID.string,console.log("onClickSendToWechat query:"+e),n=h.G.StringManager.getString("INVITE_BATTLE_TIP"),I.default.getInstance().inviteFriend(n,"2DC1rbGjRzmIjqMbqJXuvA==","https://tfjl-1300944069.file.myqcloud.com/invite.png",e,S.ShareType.BattleRoom)):C.GamePlatform.isQQGameRoom()?(e="battle=",this.m_nCurCombatType==p.CombatType.SOLO?e+=m.FIGHT_TYPE.FIGHT_TYPE_DUEL_BATTLE:this.m_nCurCombatType==p.CombatType.COOP&&(t=r.default.getViewNodeByName("MachineryCityMainView"),o=r.default.getViewByName("SkyCastleArenaView"),i=r.default.getViewByName("WeekCooperationReliveMainView"),a=r.default.getViewNodeByName("FogHiddenMainView"),o&&o.view?e+=m.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE:i&&i.view?e+=m.FIGHT_TYPE.FIGHT_TYPE_WEEK_COOPERATION:e+=a?m.FIGHT_TYPE.FIGHT_TYPE_FOG_HIDDEN:t?m.FIGHT_TYPE.FIGHT_TYPE_MACHINARIUM:m.FIGHT_TYPE.FIGHT_TYPE_COOPERATION),e+="."+this.m_labelRoomID.string,console.log("onClickSendToWechat query:"+e),n=h.G.StringManager.getString("INVITE_BATTLE_TIP"),N.QQGameHallUtils.getInstance().inviteFriend(n,"2DC1rbGjRzmIjqMbqJXuvA==","https://tfjl-1300944069.file.myqcloud.com/invite.png",e,S.ShareType.BattleRoom)):C.GamePlatform.isKuaishouMiniGame()&&(e="battle=",this.m_nCurCombatType==p.CombatType.SOLO?e+=m.FIGHT_TYPE.FIGHT_TYPE_DUEL_BATTLE:this.m_nCurCombatType==p.CombatType.COOP&&(t=r.default.getViewNodeByName("MachineryCityMainView"),o=r.default.getViewByName("SkyCastleArenaView"),i=r.default.getViewByName("WeekCooperationReliveMainView"),a=r.default.getViewNodeByName("FogHiddenMainView"),o&&o.view?e+=m.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE:i&&i.view?e+=m.FIGHT_TYPE.FIGHT_TYPE_WEEK_COOPERATION:e+=a?m.FIGHT_TYPE.FIGHT_TYPE_FOG_HIDDEN:t?m.FIGHT_TYPE.FIGHT_TYPE_MACHINARIUM:m.FIGHT_TYPE.FIGHT_TYPE_COOPERATION),e+="."+this.m_labelRoomID.string,console.log("onClickSendToKSMinigame query:"+e),n=h.G.StringManager.getString("INVITE_BATTLE_TIP"),b.KSMinigameUtils.getInstance().inviteFriend(n,"2DC1rbGjRzmIjqMbqJXuvA==","https://tfjl-1300944069.file.myqcloud.com/invite.png",e,S.ShareType.BattleRoom))},t.prototype.onClickShareToChat=function(){var e=this;if(l.default.getRoleAttrValByKey(m.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE)<=E.ChatChannelTableData.getById(1).conditionMaxScore)return h.G.StringManager.PopString(h.G.StringManager.getString("CHAT_SYSTEM_CONDITION_TIP",E.ChatChannelTableData.getById(1).conditionMaxScore));var t=this.node.getChildByName("step3-1");if(!cc.find("btn_chat/time",t).getComponent(cc.Label).node.active){var o=new _.C_Chat_Client,i=r.default.getViewNodeByName("MachineryCityMainView"),a=r.default.getViewByName("SkyCastleArenaView"),n=r.default.getViewByName("WeekCooperationReliveMainView"),s=r.default.getViewNodeByName("FogHiddenMainView");if(a&&a.view){var c=w.default.Instance.getCurCastleSkyType();if(c<0)return h.G.StringManager.PopString("\u5206\u4eab\u623f\u95f4\u51fa\u9519\uff01");o.channel=c+m.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_SKYCASTLE_EASY}else n&&n.view?o.channel=m.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_WEEK_COOPERATION:s?o.channel+=m.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_ACTIVITY:i?o.channel+=m.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_ACTIVITY:o.channel=m.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_SYSTEM;if(o.isSendSelf=!1,o.receiveRoleID=y.fromNumber(0),o.chatType=m.TYPE_CHAT.TYPE_CHAT_ROOMFIGHT,o.chatText=this.m_labelRoomID.string,o.chatParam=0,o.isLiveState=0,this.m_nCurCombatType==p.CombatType.COOP){for(var d in this.m_pFightHeros=l.default.getBattleHeroCarData(l.default.fightHeroArrayIndex),this.m_pFightHeros)if(this.m_pFightHeros[d]){var g=new v.T_Chat_HeroData;g.heroID=this.m_pFightHeros[d]._heroId,o.heros.set(Number(d),g)}if(i){var C=H.default.Instance.getTodayFightCards();C&&C.length>0&&C.forEach(function(e){var t=new v.T_Chat_HeroData;t.heroID=e,o.heros.set(o.heros.size+1,t)})}}if(f.ClientNetwork.getInstance().Send(_.CHAT_CLIENT_ENUM.P_Chat_Client,o)){var S=this.node.getChildByName("step3-1"),T=cc.find("btn_chat/tip",S).getComponent(cc.Label);T.node.active=!1;var I=cc.find("btn_chat/time",S).getComponent(cc.Label),N=I.string;I.node.active=!0,u.default.setNodeBright(cc.find("btn_chat",S),!1),this.schedule(function(){var t=Number(I.string)-1;I.string=String(t),t<=0&&(u.default.setNodeBright(cc.find("btn_chat",S),!0),T.node.active=!0,I.string=N,I.node.active=!1,e.unscheduleAllCallbacks())},1,10)}}},t.prototype.onClickJoinRoom=function(){this.m_nodeWithFriend.active=!1,this.m_nodeJoinRoom.active=!0},t.prototype.onRoomIdEditDidEnded=function(e){this.m_strEditRoom=e.string},t.prototype.onClickJoin=function(){var e=this;if(this.m_nCurCombatType==p.CombatType.COOP){var t=r.default.getViewByName("SkyCastleArenaView");if(t&&t.view){var o=(a=R.ActivityTableData.getById(L.ACTIVITY_ID_ENUM.P_Activity_SkyCastle)).param1;return l.default.getRoleAttrValByKey(m.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE)<o?h.G.StringManager.PopWorldString(h.G.StringManager.getWorldString("sky_battle_score_limit_tip",o)):this.callJoinRoom()}var i=r.default.getViewByName("WeekCooperationReliveMainView");if(i&&i.view)return l.default.getRoleAttrValByKey(m.ROLE_ATTR_VALUES.ROLE_ATTR_WEEK_COOPERATION)<=0?h.G.StringManager.PopWorldString(h.G.StringManager.getWorldString("weekCooperationRelive_tip1",d.getConfigIntValue("week_cooperation_need_wave"))):0==B.default.getWeekCooperationIsOpen()?h.G.StringManager.PopWorldString(h.G.StringManager.getWorldString("weekCooperationRelive_tip2")):this.callJoinRoom();if(r.default.getViewNodeByName("FogHiddenMainView"))return o=(a=R.ActivityTableData.getById(L.ACTIVITY_ID_ENUM.P_Activity_FogHidden)).param1,l.default.getRoleAttrValByKey(m.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE)<o?h.G.StringManager.PopString(h.G.StringManager.getString("FOG_HIDDEN_ACTIVITY_TIPS1",o)):this.callJoinRoom();if(r.default.getViewNodeByName("MachineryCityMainView")){var a=R.ActivityTableData.getById(L.ACTIVITY_ID_ENUM.P_Activity_Machinarium);return l.default.getRoleAttrValByKey(m.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE)<a.param1?h.G.StringManager.PopString(h.G.StringManager.getString("FOG_HIDDEN_ACTIVITY_TIPS1",a.param1)):a.param7>0&&H.default.Instance.getTodayFightFailCount()>=a.param3+a.param7?h.G.StringManager.PopWorldString("common_fight_over"):0==H.default.Instance.getMachineryCityIsOpen()?h.G.StringManager.PopString(h.G.StringManager.getString("MACHINERYCITY_TIP1")):this.callJoinRoom()}}this.m_nCurCombatType==p.CombatType.COOP&&l.default.getRoleInfoData().cooperationDayLeftNum<=0?r.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:h.G.StringManager.getString("COOP_BATTLE_OVER_TIPS"),confirmCb:function(){e.callJoinRoom()}}):this.callJoinRoom()},t.prototype.callJoinRoom=function(){if(""!=this.m_strEditRoom){if(B.default.isChickenDinnerMatching())return h.G.StringManager.PopString(h.G.StringManager.getString("CHICKENDINNER_MATCHING")),void k.default.callRoleClientLog("CHICKENDINNER_MATCHING");var e=new g.C_Match_Duel_Fight;if(this.m_nCurCombatType==p.CombatType.SOLO)e.fightType=m.FIGHT_TYPE.FIGHT_TYPE_DUEL_BATTLE;else if(this.m_nCurCombatType==p.CombatType.COOP){e.fightType=m.FIGHT_TYPE.FIGHT_TYPE_COOPERATION;var t=r.default.getViewByName("SkyCastleArenaView");t&&t.view&&(e.fightType=m.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE);var o=r.default.getViewByName("WeekCooperationReliveMainView");o&&o.view&&(e.fightType=m.FIGHT_TYPE.FIGHT_TYPE_WEEK_COOPERATION),r.default.getViewNodeByName("FogHiddenMainView")&&(e.fightType=m.FIGHT_TYPE.FIGHT_TYPE_FOG_HIDDEN),r.default.getViewNodeByName("MachineryCityMainView")&&(e.fightType=m.FIGHT_TYPE.FIGHT_TYPE_MACHINARIUM)}e.useRoom=0,e.params.push(d.getConfigVersion()),""!=this.m_strEditRoom&&(e.roomID=this.m_strEditRoom),f.ClientNetwork.getInstance().Send(g.MATCH_CLIENT_ENUM.P_Match_Duel_Fight,e)}else h.G.StringManager.PopStringOnce(h.G.StringManager.getString("MATCH_ROOM_ID_NULL"))},t.prototype.onSetChatMsg=function(e){if(e.length<=0)return this.m_chatNode.getChildByName("msgNode").active=!1;var t=this.m_chatNode.getChildByName("msgNode"),o=t.getChildByName("label_chat"),i=t.getChildByName("label_chatDotLab");o.getComponent(cc.Label).string=e,i.active=!1,e.length>9&&(i.active=!0),t.active=!0},t.prototype.onSetChatRedpoint=function(e){this.m_chatNode.getChildByName("msgNode").parent.children[1].children[0].active=e},t.prototype.onClickChatBtnCallBack=function(){var e=r.default.getViewByName("WeekCooperationReliveMainView");1==this.checkInActivityView()?D.default.Instance.emit(A.default.SyncChatViewChange,[M.ChatViewVisible.Popup,m.CHAT_CHANNEL_GROUP_TYPE.CHAT_CHANNEL_ACTICITY_GROUP]):e&&e.view?D.default.Instance.emit(A.default.SyncChatViewChange,[M.ChatViewVisible.Popup,m.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_WEEK_COOPERATION]):D.default.Instance.emit(A.default.SyncChatViewChange,M.ChatViewVisible.Popup)},t.prototype.onCheckCoopSweepShow=function(){var e=r.default.getViewByName("SkyCastleArenaView");if(!(e&&e.view||r.default.getViewNodeByName("FogHiddenMainView"))){var t=r.default.getViewByName("WeekCooperationReliveMainView");t&&t.view||r.default.getViewNodeByName("MachineryCityMainView")||this.m_nCurCombatType!=p.CombatType.COOP||(l.default.getRoleInfoData().cooperationDayNum,this.m_btn_coopSweep.active=!0)}},t.prototype.onClickCoopSweep=function(){this.closeView(),r.default.addPopView("BaseCtrl","SweepMainView","SweepMainView")},t.prototype.checkInActivityView=function(){var e=r.default.getViewByName("SkyCastleArenaView");if(e&&e.view)return!0;if(r.default.getViewNodeByName("FogHiddenMainView"))return!0;var t=r.default.getViewNodeByName("MachineryCityMainView");return!(!t||!t.getComponent("MachineryCityMainView"))},n([U(cc.Layout)],t.prototype,"m_layoutFightGroup",void 0),n([U(cc.Node)],t.prototype,"m_nodeFightHeros",void 0),n([U(cc.Node)],t.prototype,"m_nodeWithFriend",void 0),n([U(cc.Node)],t.prototype,"m_nodeCreateRoom",void 0),n([U(cc.Label)],t.prototype,"m_labelRoomID",void 0),n([U(cc.Node)],t.prototype,"m_nodeJoinRoom",void 0),n([U(cc.Node)],t.prototype,"m_soloTitle",void 0),n([U(cc.Node)],t.prototype,"m_coopTitle",void 0),n([U(cc.Node)],t.prototype,"m_chatNode",void 0),n([U(cc.Node)],t.prototype,"m_btn_coopSweep",void 0),n([U(cc.Node)],t.prototype,"m_skyTitleNode",void 0),n([U(cc.Node)],t.prototype,"m_weekCoopTitleNode",void 0),n([U(cc.Node)],t.prototype,"m_FogHiddenTitleNode",void 0),n([U(cc.Node)],t.prototype,"m_MachineryCityTitleNode",void 0),n([U(cc.Label)],t.prototype,"m_JoinRoomTipLab",void 0),n([c.Register_Class,F],t)}(s.default);o.default=x,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/ActivityTableData":"ActivityTableData","../../StaticData/ChatChannelTableData":"ChatChannelTableData","../../StaticData/HeroSkinTableData":"HeroSkinTableData","../../common/CombatModule":"CombatModule","../../common/CommandValue":"CommandValue","../../common/EventConst":"EventConst","../../common/NetworkProtocolCommon":"NetworkProtocolCommon","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/base/GameView":"GameView","../../modules/manager/EventManager":"EventManager","../../network/ClientNetwork":"ClientNetwork","../../network/protocol/ActivityProtocols":"ActivityProtocols","../../network/protocol/BaseProtocols":"BaseProtocols","../../network/protocol/ChatProtocols":"ChatProtocols","../../network/protocol/MatchProtocols":"MatchProtocols","../../network/protocol/TypeProtocols":"TypeProtocols","../../network/protocol/long":"long","../../utils/ByteDanceMiniGameUtils":"ByteDanceMiniGameUtils","../../utils/GamePlatform":"GamePlatform","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils","../../utils/KSMinigameUtils":"KSMinigameUtils","../../utils/QQGameHallUtils":"QQGameHallUtils","../../utils/QQMiniGameUtils":"QQMiniGameUtils","../../utils/ResourcesManager":"ResourcesManager","../../utils/WechatUtils":"WechatUtils","../activity/ActivityModule":"ActivityModule","../heroCardBag/HeroSkinUtils":"HeroSkinUtils","../machineryCityActivity/MachineryCityModel":"MachineryCityModel","../skyCastle/SkyCastleModule":"SkyCastleModule"}],BattleSecondGuideCfg:[function(e,t,o){"use strict";cc._RF.push(t,"40522vDSEVNdaGI0G/w8Cxm","BattleSecondGuideCfg"),Object.defineProperty(o,"__esModule",{value:!0}),o.task=void 0;var i=e("../GuideCommand"),a=e("../../../common/PlayerModule"),n=e("../../../network/protocol/TypeProtocols"),r=e("./GuideConst");o.task={name:"\u7b2c\u4e8c\u573a\u6218\u6597\u5f15\u5bfc\u914d\u7f6e",guideId:r.default.BattleSecondGuide.guideId,steps:[{command:{cmd:i.Command.None,args:900}},{command:[{cmd:i.Command.Dialogue,args:["12",!0]},{cmd:i.Command.Click,args:"GameScene>Down>Down>FightCardView>FCVLayout>card0"}],delayTime:0,delayClick:0},{command:{cmd:i.Command.Click,args:"GameScene>Down>Down>car"},delayTime:1},{command:{cmd:i.Command.Click,args:"GameScene>Down>Down>Random"},delayTime:1},{command:[{cmd:i.Command.Dialogue,args:["13",!0]},{cmd:i.Command.Click,args:"GameScene>Down>Down>FightCardView>FCVLayout>card0"}],delayTime:1,delayClick:0},{command:{cmd:i.Command.Click,args:"GameScene>Down>Down>car"},delayTime:1},{command:{cmd:i.Command.Click,args:"GameScene>Down>Down>Random"},delayTime:1},{command:[{cmd:i.Command.Dialogue,args:["14",!0]},{cmd:i.Command.Click,args:"GameScene>Down>Down>FightCardView>FCVLayout>card0"}],delayTime:1,delayClick:0},{command:{cmd:i.Command.Dialogue,args:["15",!0]},delayTime:1},{command:[{cmd:i.Command.Dialogue,args:["16",!0]},{cmd:i.Command.Click,args:"GameScene>Blood>FightTopView>leftNode>LeftPassiveLayoutNode"}],delayTime:1,bSendGuideEnd:!0}],condition:function(){return a.default.getRoleAttrValByKey(n.ROLE_ATTR_VALUES.ROLE_ATTR_GUIDE)+1==r.default.BattleSecondGuide.guideId}},cc._RF.pop()},{"../../../common/PlayerModule":"PlayerModule","../../../network/protocol/TypeProtocols":"TypeProtocols","../GuideCommand":"GuideCommand","./GuideConst":"GuideConst"}],BattleThreeGuideCfg:[function(e,t,o){"use strict";cc._RF.push(t,"5824eBMfDBNeLYC0l41T3b9","BattleThreeGuideCfg"),Object.defineProperty(o,"__esModule",{value:!0}),o.task=void 0,o.task={},cc._RF.pop()},{}],BuffObj:[function(e,t,o){"use strict";cc._RF.push(t,"d7fd2/gamNNU71Ycv7eGAeB","BuffObj"),o.__esModule=!0,o.default=void 0;var i=f(e("../../utils/ConfigUtils")),a=e("../../utils/ConstValue"),n=e("../../utils/GameUtils"),r=f(e("../../utils/Tools")),s=f(e("../CombatManager")),c=f(e("./FlyingObj")),l=f(e("../../utils/ResourcesManager")),d=f(e("../../common/PlayerModule")),u=e("../../common/CommandValue"),h=e("../../network/protocol/TypeProtocols"),p=e("../../modules/manager/cheat/SafeNumber");function f(e){return e&&e.__esModule?e:{default:e}}function g(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var m=function(){function e(){this.safeIntervalTime=new p.SafeNumber(0),this.safeLastTime=new p.SafeNumber(0),this.safeValidTime=new p.SafeNumber(0),this.safeModValue=new p.SafeNumber(0),this._ReleaseTarget=null,this._HitTarget=null,this._BuffCfg=null,this._Activate=null,this._LastTime=0,this.uId=r.default.getInstance().genId(),this._continueIntervalTime=0,this._npcState=null,this.validTime=0,this._heroShow=0,this._modValue=0}var t,o,f=e.prototype;return f.init=function(e,t,o){if(this.templateId=e,this._Activate=!0,this._LastTime=0,this.node=new cc.Node,this.node.parent=t,this.node.x=o.x||0,this._BuffCfg=i.default.Instance.getBuffConfig(e),1==this._BuffCfg.pos?this.node.y=o.y+this._HitTarget.height:this.node.y=0,this._heroShow=this._BuffCfg.hero_show,this.adjustBuffPos(),this.loadBuffRes(this._BuffCfg.res,this._BuffCfg.actionname),0==this._BuffCfg.intervalTime)this.onAdd();else if(1==this._HitTarget.immunity_state&&this._BuffCfg&&this._BuffCfg.debuf_type&&this._BuffCfg.debuf_type>0)return void(this._BuffCfg.validTime<36e6&&this.onRemove());this.node.scale=this.node.scale*this._BuffCfg.scale/100,this.validTime=this._BuffCfg.validTime,this._BuffCfg.type!=a.Buff_Type.XuanYun&&this._BuffCfg.type!=a.Buff_Type.frozen||this.HitTarget&&(this.validTime=this._BuffCfg.validTime*Math.max(0,1-this.HitTarget.attr[a.Npc_Attr_Type.toughness_inc]/a.AttrParam))},f.loadBuffRes=function(e,t){if((0!=(0,n.getBattleEffectOnOff)()||!this._HitTarget||this.HitTarget.isCar()||this.HitTarget.isHero())&&!(1==this._HitTarget.immunity_state&&this._BuffCfg&&this._BuffCfg.debuf_type&&this._BuffCfg.debuf_type>0)&&""!=e&&(!this._HitTarget||!(this._HitTarget.isHero()&&0==this._heroShow||this._HitTarget.isCar()&&1==this._heroShow||!this._HitTarget.isCar()&&2==this._heroShow))&&(this._BuffCfg.type!=a.Buff_Type.Extra_Sliver_Invalid||!this.HitTarget||this.HitTarget.isCar())){var o=this;cc.resources.load(e,sp.SkeletonData,function(i,a){if(i)cc.log("load err errff");else if(0!=o.node.active){var n=o.node.getComponent(sp.Skeleton);n||(n=o.node.addComponent(sp.Skeleton)),n.skeletonData=a,n.setSkin("default"),t?n.setAnimation(0,t,!0):n.setAnimation(0,"idle",!0),n.enableBatch=!0,d.default.checkModulerOnOffState(u.ModulerViewOnOff.LoadSceneReleaseAsset)&&(l.default.pushReleaseAssets(1,{path:e,resType:cc.SpriteFrame}),l.default.pushReleaseAssets(1,{path:e,resType:cc.Texture2D}),l.default.pushReleaseAssets(1,{path:e,resType:sp.SkeletonData}))}})}},f.showBuffRes=function(e){var t=this.node.getComponent(sp.Skeleton);t&&t.node.active!=e?(t.node.active=e,e&&this.HitTarget&&this.HitTarget.node&&!this.node.parent&&(this.node.parent=this.HitTarget.node)):!t&&e&&this._BuffCfg&&this._BuffCfg.debuf_type&&this._BuffCfg.debuf_type>0&&this._BuffCfg.validTime>=36e6&&this.loadBuffRes(this._BuffCfg.res,this._BuffCfg.actionname)},f.adjustBuffPos=function(){s.default.getInstance().isCoop()&&this._HitTarget&&this._HitTarget.isCar()&&this._HitTarget.model&&(this._HitTarget.model.templateId==a.CAR_TEMPLATE_ID.coop_back?this._heroShow=1:this._HitTarget.model.templateId==a.CAR_TEMPLATE_ID.coop_front&&(1==this._HitTarget.model.level?this.node.x=80:this.node.x=-40))},f.onUpdate=function(e){if(this._BuffCfg){if(0==this._Activate)return!1;this._BuffCfg.type!=a.Buff_Type.Sliver_Curse&&this._BuffCfg.type!=a.Buff_Type.Extra_Sliver_Invalid||this.showBuffRes(!this._HitTarget.immunity_state),this._continueIntervalTime=this._continueIntervalTime+1e3*e,this._BuffCfg.intervalTime>0&&this._continueIntervalTime>=this._BuffCfg.intervalTime&&(this.onAdd(),this._continueIntervalTime=0),this._LastTime=this._LastTime+1e3*e,this._LastTime>=this.validTime&&(this.onRemove(),this._Activate=!1,this._LastTime=0)}},f.onAdd=function(){if(1==this._HitTarget.immunity_state&&this._BuffCfg&&this._BuffCfg.debuf_type&&this._BuffCfg.debuf_type>0)this._BuffCfg.validTime<36e6&&this.onRemove();else switch(this._BuffCfg.type){case a.Buff_Type.WuDi:this._HitTarget.wudi_state=!0;break;case a.Buff_Type.XuanYun:this.HitTarget&&this.HitTarget.attr[a.Npc_Attr_Type.toughness_inc]<a.AttrParam&&(this._HitTarget.xuanyun_state=!0,this._HitTarget.spineNode&&this._HitTarget.spineNode.setAnimation(0,"idle",!0));break;case a.Buff_Type.SlowSpeed:this._HitTarget.slowFactor(this._BuffCfg.value/100);break;case a.Buff_Type.TempChangeAtt:this._HitTarget.modAttr(this._BuffCfg.property_id,this._BuffCfg.value);break;case a.Buff_Type.ChangeAtt:this._BuffCfg.property_id==a.Npc_Attr_Type.curHp?this.attackTarget(-1*this._BuffCfg.value):this._HitTarget.modAttr(this._BuffCfg.property_id,this._BuffCfg.value);break;case a.Buff_Type.ChangeAttPercent:this._BuffCfg.property_id==a.Npc_Attr_Type.curHp?this._HitTarget&&this.attackTarget(Math.floor(-1*this._HitTarget.getMaxHp()*this._BuffCfg.value/100)):this._HitTarget.modAttr(this._BuffCfg.property_id,this._HitTarget.getAttrValue(this._BuffCfg.property_id)*this._BuffCfg.value/100);break;case a.Buff_Type.AddMoney:if((g=s.default.getInstance().getPlayerModelByCamp(this._HitTarget.camp))&&g.addMoney(this._BuffCfg.value,h.SP_CHANGE_TYPE.SP_CHANGE_TYPE_ADD_THIEF),s.default.getInstance().isCoop()){var e=s.default.getInstance().getCoopPlayerByCamp(this._HitTarget.camp);e&&e.addMoney(this._BuffCfg.value,h.SP_CHANGE_TYPE.SP_CHANGE_TYPE_ADD_THIEF)}break;case a.Buff_Type.immunity:this._HitTarget.immunity_state=!0,this._HitTarget.removeAllDebuff(!0);break;case a.Buff_Type.immunitySeveral:this._HitTarget.immunity_several_state=!0;break;case a.Buff_Type.frozen:this._HitTarget.frozen_state=!0;break;case a.Buff_Type.changeDamageRatio:this._HitTarget.modDamageRatio(this._BuffCfg.value);break;case a.Buff_Type.countBehit:this.ReleaseTarget&&this._HitTarget.modBehitCount(this.ReleaseTarget.getOwnerId()+(0,n.getRoleIdentity)(this.ReleaseTarget.camp));break;case a.Buff_Type.Magic_Dot:if(this._HitTarget){var t=-1*(1-Math.min(.99,.052*this._HitTarget.getMagicDef()/(.9+.048*Math.abs(this._HitTarget.getMagicDef()))))*this._HitTarget.getMaxHp()*this._BuffCfg.value/100;this.attackTarget(Math.floor(t))}break;case a.Buff_Type.Physic_Dot:if(this._HitTarget){var o=-1*(1-Math.min(.99,.052*this._HitTarget.getPhyDef()/(.9+.048*Math.abs(this._HitTarget.getPhyDef()))))*this._HitTarget.getMaxHp()*this._BuffCfg.value/100;this.attackTarget(Math.floor(o))}break;case a.Buff_Type.True_Damage_Dot:if(this._HitTarget){var i=-1*this._HitTarget.getMaxHp()*this._BuffCfg.value/100;this.attackTarget(Math.floor(i))}break;case a.Buff_Type.True_Damage:this._HitTarget&&(this._HitTarget.trueDamage_state=!0,this._HitTarget.modTrueDamagePERC(this._BuffCfg.value));break;case a.Buff_Type.Pure_Damage_Dot:if(this._HitTarget){var r=-1*(1-this._HitTarget.getPureDamageDesc())*this._HitTarget.getMaxHp()*this._BuffCfg.value/100;this.attackTarget(Math.floor(r))}break;case a.Buff_Type.Equip_Invalid:this.setEquipInvalid(!0);break;case a.Buff_Type.Die_Boom:break;case a.Buff_Type.Sliver_Curse:this.setTargetSliverCurseState(!0);break;case a.Buff_Type.TempChangeAttrProfNum:var c=this._BuffCfg.value*this.countSameProfNum();this._HitTarget.modAttr(this._BuffCfg.property_id,c),this._modValue=c;break;case a.Buff_Type.Hero_Time_Bomb:if(this._ReleaseTarget&&this._HitTarget&&(s.default.getInstance().getCarByCamp(this._HitTarget.camp).recvDamage(this._BuffCfg.value,!1,0,this._ReleaseTarget,cc.v2(0,0)),s.default.getInstance().isCoop())){var l=s.default.getInstance().getCoopCarByCamp(this._HitTarget.camp);l&&l.recvDamage(this._BuffCfg.value,!1,0,this._ReleaseTarget,cc.v2(0,0))}break;case a.Buff_Type.Extra_Sliver_Invalid:case a.Buff_Type.Sell_Sliver_Invalid:this.setSliverInvalid(!0);break;case a.Buff_Type.Story_State:s.default.getInstance().setStoryState(!0);break;case a.Buff_Type.TempChangeAttrByAttr:var d=0,u=s.default.getInstance().getCoopCarByCamp(this._HitTarget.camp);if(s.default.getInstance().isCoop()&&(0,n.getRoleIdentity)(this._HitTarget.camp)==a.PLAYER_IDENTITY.home&&(u=s.default.getInstance().getCoopCarByCamp(this._HitTarget.camp)),u&&(d=u.attr[Number(this._BuffCfg.dependent_property_id)]),d>0){var p=this._BuffCfg.value*d;this._HitTarget.modAttr(this._BuffCfg.property_id,p),this._modValue=p}break;case a.Buff_Type.AddPercentCurMoney:if(g=s.default.getInstance().getPlayerModelByCamp(this._HitTarget.camp)){var f=this._BuffCfg.value/a.AttrParam*g.getCurMoney();g.addMoney(f,h.SP_CHANGE_TYPE.SP_CHANGE_TYPE_ADD_THIEF)}break;case a.Buff_Type.AddSameProfNumMoney:var g,m=this.countSameProfNum();if(g=s.default.getInstance().getPlayerModelByCamp(this._HitTarget.camp)){var _=this._BuffCfg.value*m;if(g.addMoney(_,h.SP_CHANGE_TYPE.SP_CHANGE_TYPE_ADD_THIEF),s.default.getInstance().isCoop()){var y=s.default.getInstance().getCoopPlayerByCamp(this._HitTarget.camp);y&&y.addMoney(_,h.SP_CHANGE_TYPE.SP_CHANGE_TYPE_ADD_THIEF)}}}},f.onRemove=function(e){if(void 0===e&&(e=!1),1==this._HitTarget.immunity_state&&!e&&this._BuffCfg&&this._BuffCfg.debuf_type&&this._BuffCfg.debuf_type>0){if(this._HitTarget.onBuffRemoved(this.uId),this.node&&cc.isValid(this.node)){var t=this.node.getComponent(sp.Skeleton);t&&t.node.removeFromParent(),this.node.destroy()}}else{switch(this._BuffCfg.type){case a.Buff_Type.WuDi:this._HitTarget.getBuffCountByType(a.Buff_Type.WuDi)<=1&&(this._HitTarget.wudi_state=!1);break;case a.Buff_Type.XuanYun:this.HitTarget&&this._HitTarget.getBuffCountByType(a.Buff_Type.XuanYun)<=1&&this._HitTarget.xuanyun_state&&(this._HitTarget.xuanyun_state=!1,this._HitTarget.restoreState());break;case a.Buff_Type.SlowSpeed:this._HitTarget.slowFactor(this._BuffCfg.value/100*-1);break;case a.Buff_Type.TempChangeAtt:this._HitTarget.modAttr(this._BuffCfg.property_id,-1*this._BuffCfg.value);break;case a.Buff_Type.ChangeAtt:break;case a.Buff_Type.immunity:this._HitTarget.getBuffCountByType(a.Buff_Type.immunity)<=1&&(this._HitTarget.immunity_state=!1,this._HitTarget.restoreAllDebuff());break;case a.Buff_Type.immunitySeveral:this._HitTarget.getBuffCountByType(a.Buff_Type.immunitySeveral)<=1&&(this._HitTarget.immunity_several_state=!1);break;case a.Buff_Type.frozen:this._HitTarget.getBuffCountByType(a.Buff_Type.frozen)<=1&&(this._HitTarget.frozen_state=!1);break;case a.Buff_Type.changeDamageRatio:this._HitTarget.modDamageRatio(-1*this._BuffCfg.value);break;case a.Buff_Type.countBehit:this._HitTarget.clearBehitCount();break;case a.Buff_Type.True_Damage:this._HitTarget&&this._HitTarget.getBuffCountByType(a.Buff_Type.trueDamage_state)<=1&&(this._HitTarget.trueDamage_state=!1,this._HitTarget.modTrueDamagePERC(-this._BuffCfg.value));break;case a.Buff_Type.Equip_Invalid:this.setEquipInvalid(!1);break;case a.Buff_Type.Die_Boom:this._HitTarget.isCar()||s.default.getInstance().gameState!=a.Game_State.Fighting||this.emitFlyingObj(19,this._ReleaseTarget,this._HitTarget,cc.Vec2(0,0),1,!1);break;case a.Buff_Type.Sliver_Curse:this._HitTarget.getBuffCountByType(a.Buff_Type.Sliver_Curse)<=1&&this.setTargetSliverCurseState(!1);break;case a.Buff_Type.TempChangeAttrProfNum:var o=-1*this._modValue;this._HitTarget.modAttr(this._BuffCfg.property_id,o),this._modValue=0;break;case a.Buff_Type.Extra_Sliver_Invalid:case a.Buff_Type.Sell_Sliver_Invalid:this.setSliverInvalid(!1);break;case a.Buff_Type.Story_State:s.default.getInstance().setStoryState(!1);break;case a.Buff_Type.TempChangeAttrByAttr:var i=-1*this._modValue;this._HitTarget.modAttr(this._BuffCfg.property_id,i),this._modValue=0}if((!e||e&&this.validTime<36e6)&&this._HitTarget.onBuffRemoved(this.uId),this.node&&cc.isValid(this.node)){var n=this.node.getComponent(sp.Skeleton);n&&n.node.removeFromParent(),(!e||e&&this.validTime<36e6)&&this.node.destroy()}}},f.attackTarget=function(e){var t=!1;if(e<0&&(t=!0,e=Math.abs(e)),this._HitTarget.recvDamage(e,t,0,this._ReleaseTarget,cc.v2(0,0)),this._HitTarget&&this._HitTarget.isDead()&&this._HitTarget.state!=a.NPC_STATE.Dead&&this._ReleaseTarget){var o=s.default.getInstance().getPlayerModelByCamp(this._ReleaseTarget.getCamp());if(o&&(o.addMoney(this._HitTarget.dropMoney),s.default.getInstance().isCoop())){var i=s.default.getInstance().getCoopPlayerByCamp(o.camp);i&&i.addMoney(this._HitTarget.dropMoney)}}},f.setEquipInvalid=function(e){if(this.HitTarget&&this.HitTarget.isCar()){var t=s.default.getInstance().getPlayerModelByCamp(this.HitTarget.camp);if(t&&t.setEquipInvaild(e),s.default.getInstance().isCoop()){var o=s.default.getInstance().getCoopPlayerByCamp(this.HitTarget.camp);o&&o.setEquipInvaild(e)}}},f.setSliverInvalid=function(e){if(this.HitTarget&&this.HitTarget.isCar()){var t=s.default.getInstance().getPlayerModelByCamp(this.HitTarget.camp);if(t&&(this._BuffCfg.type==a.Buff_Type.Extra_Sliver_Invalid?t.setSliverInvalid(e):t.setSellSliverInvalid(e)),s.default.getInstance().isCoop()){var o=s.default.getInstance().getCoopPlayerByCamp(this.HitTarget.camp);o&&(this._BuffCfg.type==a.Buff_Type.Extra_Sliver_Invalid?o.setSliverInvalid(e):o.setSellSliverInvalid(e))}}},f.emitFlyingObj=function(e,t,o,i,n,l){if(o||1!=l){var d=r.default.getInstance().genId(),u=new c.default;u.init(d,e,t,o,s.default.getInstance().mapNode,i,n),this._BuffCfg.type==a.Buff_Type.Die_Boom&&(u.attr[a.Npc_Attr_Type.attack]=this._BuffCfg.value),s.default.getInstance().flyingObjList[d]=u}},f.setTargetSliverCurseState=function(e){if(this.HitTarget){var t=s.default.getInstance().getCarByCamp(this.HitTarget.camp);if(t&&t.setSliverCurseState(e),s.default.getInstance().isCoop()){var o=s.default.getInstance().getCoopCarByCamp(a.PLAYER_CAMP.coopPlayer);o&&o.setSliverCurseState(e)}}},f.sliverCurseEffect=function(e){if(this._HitTarget){var t=.052*this._HitTarget.getPhyDef()/(.9+.048*Math.abs(this._HitTarget.getPhyDef())),o=this._HitTarget.getMaxHp(),i=e*(1-t)*-1*o*this._BuffCfg.value/100;if(s.default.getInstance().isCoop()){var a=s.default.getInstance().getCoopCarByCamp(this._HitTarget.camp);a&&(i=e*(1-t)*-1*(o+=a.getMaxHp())*this._BuffCfg.value/100,a.recvDamage(Math.floor(i),!1,0,this._ReleaseTarget,cc.v2(0,0)))}this.attackTarget(Math.floor(i))}},f.countSameProfNum=function(){if(this._HitTarget){var e=s.default.getInstance().getCarByCamp(this._HitTarget.camp);if(e){var t=new Set;if(e.getSameProfNum(this._HitTarget.occupation,t),s.default.getInstance().isCoop()){var o=s.default.getInstance().getCoopCarByCamp(this._HitTarget.camp);o&&o.getSameProfNum(this._HitTarget.occupation,t)}return t.size>1?t.size:1}}return 1},t=e,(o=[{key:"ReleaseTarget",set:function(e){this._ReleaseTarget=e},get:function(){return this._ReleaseTarget}},{key:"HitTarget",set:function(e){this._HitTarget=e,this._npcState=this._HitTarget.state},get:function(){return this._HitTarget}},{key:"_continueIntervalTime",get:function(){return this.safeIntervalTime.value},set:function(e){this.safeIntervalTime.value=e}},{key:"_LastTime",get:function(){return this.safeLastTime.value},set:function(e){this.safeLastTime.value=e}},{key:"validTime",get:function(){return this.safeValidTime.value},set:function(e){this.safeValidTime.value=e}},{key:"modValue",get:function(){return this.safeModValue.value},set:function(e){this.safeModValue.value=e}}])&&g(t.prototype,o),e}();o.default=m,t.exports=o.default,cc._RF.pop()},{"../../common/CommandValue":"CommandValue","../../common/PlayerModule":"PlayerModule","../../modules/manager/cheat/SafeNumber":"SafeNumber","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/ConfigUtils":"ConfigUtils","../../utils/ConstValue":"ConstValue","../../utils/GameUtils":"GameUtils","../../utils/ResourcesManager":"ResourcesManager","../../utils/Tools":"Tools","../CombatManager":"CombatManager","./FlyingObj":"FlyingObj"}],ButtonSafe:[function(e,t,o){"use strict";cc._RF.push(t,"a12aeaaX2NKHJYeNJ+bG1IW","ButtonSafe");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,s=r.ccclass,c=r.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.safeTime=.5,t}return a(t,e),t.prototype.start=function(){var e=this,t=this.getComponent(cc.Button);t&&(this.clickEvents=t.clickEvents,this.node.on("click",function(){t.clickEvents=[],e.scheduleOnce(function(){t.clickEvents=e.clickEvents},e.safeTime)},this))},n([c({displayName:"\u6309\u94ae\u4fdd\u62a4\u65f6\u95f4\uff0c\u6307\u5b9a\u95f4\u9694\u5185\u53ea\u80fd\u70b9\u51fb\u4e00\u6b21"})],t.prototype,"safeTime",void 0),n([s],t)}(cc.Component);o.default=l,cc._RF.pop()},{}],ByteDanceMiniGameUtils:[function(e,t,o){"use strict";cc._RF.push(t,"8adc6PEjjhOQYTTYgyKfLz+","ByteDanceMiniGameUtils"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../load"),a=e("../common/NetworkProtocolCommon"),n=e("../Global/GameGlobal"),r=e("../model/ServerAddrInfo"),s=e("../network/ClientNetwork"),c=e("../network/LocalMessage"),l=e("../network/protocol/MatchProtocols"),d=e("../network/protocol/RoleProtocols"),u=e("../StaticData/RechargeTableData"),h=e("../TalkingDataAPI"),p=e("./GamePlatform"),f=e("./GameUtils"),g=e("./LogUtil"),m=e("./subUtils/TypeDef"),_=cc._decorator,y=(_.ccclass,_.property,function(){function e(){this.m_nPlatformOS=1,this.m_strEncryptedData="",this.m_strIv="",this.m_weichatLoginData=null,this.m_gameClubBtn=null,this.m_syncLiveTime=null,this.m_bFeishuConversion=!1,this.m_click_auth=!1,this.m_gameRecorderManager=null,this.m_isRecording=!1,this.m_lastVideoPath="",this.m_videoRecordStartTime=0,this.m_videoRecordEndTime=0}return e.getInstance=function(){return this.Instance||(this.Instance=new e),this.Instance},e.prototype.getWechatLoginData=function(){return this.m_weichatLoginData},e.prototype.getWechatOS=function(){return this.m_nPlatformOS},e.prototype.requestByteDanceServer=function(){var e="https://mszcs1.gameserver.iplay11g.com/gmsys/weblogic/webc/bytedanceloginbygroup.php";!0===i.getSubmitReviewState()&&(e="https://mszctest.gameserver.iplay11g.com/gmsys/weblogic/webc/bytedanceloginbygroup.php");var t=this;tt.request({url:e,data:{accountname:this.m_weichatLoginData.accountname,open_id:this.m_weichatLoginData.openid,systematic:t.m_nPlatformOS,session_key:this.m_weichatLoginData.session_key,ver:i.wechatminiLoaclGameVer,groupid:m.GlobalVar.getServerGroup().toString()},success:function(e){if(e){var o=JSON.stringify(e.data);console.log("requestByteDanceServer res.data="+o),t.m_weichatLoginData.sign=e.data.sign,s.ClientNetwork.getInstance().pushLocalMessage(c.LOCAL_MESSAGE.LocalMsg_GetServerAddr,e.data)}else s.ClientNetwork.getInstance().pushLocalMessage(c.LOCAL_MESSAGE.LocalMsg_GetServerAddr,{error:-2})},fail:function(e){console.log("requestByteDanceServer failed1"+e),s.ClientNetwork.getInstance().pushLocalMessage(c.LOCAL_MESSAGE.LocalMsg_GetServerAddr,{error:-2})}})},e.prototype.userLogin=function(){console.log("ByteDanceMIniGameUtils, userLogin!");var e=this;tt.checkSession({success:function(){console.log("checkSession");try{e.onLogin()}catch(t){console.log("AccountScene onLoginRet fail"),e.onLogin()}},fail:function(){e.onLogin()}})},e.prototype.getLaunchOptionsSync=function(){var e=tt.getLaunchOptionsSync();console.log("ByteDanceMiniGameUtils, getLaunchOptionsSync=",e),this.m_scene=e.scene;var t=e.query;this.m_adid=this.getQueryValueByKey("adid",t),this.m_creativeid=this.getQueryValueByKey("creativeid",t),this.m_creativetype=this.getQueryValueByKey("creativetype",t),this.m_clickid=this.getQueryValueByKey("clickid",t),console.log("ByteDanceMiniGameUtils, adid="+this.m_adid+", creativeid="+this.m_creativeid+", creativetype="+this.m_creativetype+", clickid="+this.m_clickid+", scene="+this.m_scene)},e.prototype.getQueryValueByKey=function(e,t){return null==t?"":t[e]},e.prototype.onLogin=function(){console.log("ByteDanceMIniGameUtils, onLogin!");var t=this;cc.sys.os==cc.sys.OS_IOS?this.m_nPlatformOS=2:cc.sys.os==cc.sys.OS_WINDOWS&&(this.m_nPlatformOS=3),this.getLaunchOptionsSync();var o=r.ServerAddrInfo.getInstance().getServerListUrl();console.log("ByteDanceMIniGameUtils, onLogin url="+o),tt.login({force:!1,success:function(a){g.default.log("onLogin tt.login success",a),(a.code||a.anonymous_code)&&(console.log("tt.login=",t.m_nPlatformOS,a.coce,a.anonymous_code),tt.request({url:o,data:{jscode:a.code,anonymous_code:a.anonymousCode,systematic:t.m_nPlatformOS,ver:i.wechatminiLoaclGameVer},success:function(o){if(g.default.log("onLogin code2Session callback succ!",o),o){var i=JSON.stringify(o.data);console.log("servergroup qqgetserverlist res.data="+i),t.m_weichatLoginData=o.data.data,t.openid=t.m_weichatLoginData.openid;var a=JSON.stringify(o.data.servers);console.log("servergroup qqgetserverlist servers="+a),r.ServerAddrInfo.getInstance().initServerList(o.data.servers),s.ClientNetwork.getInstance().pushLocalMessage(c.LOCAL_MESSAGE.LocalMsg_SDK_LoginRet,{error:0}),e.getInstance().reportLaunch()}else s.ClientNetwork.getInstance().pushLocalMessage(c.LOCAL_MESSAGE.LocalMsg_SDK_LoginRet,{error:-2})},fail:function(e){g.default.log("onLogin failed1",e),s.ClientNetwork.getInstance().pushLocalMessage(c.LOCAL_MESSAGE.LocalMsg_SDK_LoginRet,{error:-2})}}))},fail:function(e){g.default.log("onLogin tt.login failed",e),s.ClientNetwork.getInstance().pushLocalMessage(c.LOCAL_MESSAGE.LocalMsg_SDK_LoginRet,{error:-2})}})},e.prototype.getUserInfo=function(){g.default.log("ByteDanceMIniGameUtils, getUserInfo!");var e=this;tt.getUserInfo({success:function(t){console.log("ByteDanceMIniGameUtils, getUserInfo SUCC! res=",t),e.storageUserInfo(t),e.m_strEncryptedData=t.encryptedData,e.m_strIv=t.iv,e.userLogin()},fail:function(){console.log("getUserInfo fail")}})},e.prototype.storageUserInfo=function(e){var t=e.userInfo;console.log("getUserInfo success="+t.nickName+","+t.avatarUrl),tt.setStorage({key:"wxNickName",data:t.nickName}),tt.setStorage({key:"wxImage",data:t.avatarUrl}),tt.setStorage({key:"wxSex",data:t.gender}),tt.setStorage({key:"wxAuth",data:!0})},e.prototype.userInfoSetInSQL=function(e){tt.getStorage({key:"third_Session",success:function(t){tt.request({url:"Our Server ApiUrl",data:{third_Session:t.data,nickName:e.nickName,avatarUrl:e.avatarUrl,gender:e.gender,province:e.province,city:e.city,country:e.country},success:function(){}})}})},e.prototype.userAuth=function(e,t){void 0===e&&(e=null),void 0===t&&(t=null);var o=this,i=tt.getSystemInfoSync(),a=i.screenWidth,n=i.screenHeight;tt.getSetting({success:function(i){if(console.log(i.authSetting),i.authSetting["scope.userInfo"])console.log("\u7528\u6237\u5df2\u6388\u6743"),e&&e();else{console.log("\u7528\u6237\u672a\u6388\u6743");var r=tt.createUserInfoButton({type:"text",text:"",style:{left:0,top:0,width:a,height:n,backgroundColor:"#00000000",color:"#000000",fontSize:0,textAlign:"center",lineHeight:n}});r.offTap(function(){console.log("\u7528\u6237\u6388\u6743:offTap",i)}),r.onTap(function(i){o.m_click_auth||(o.m_click_auth=!0,setTimeout(function(){o.m_click_auth=!1},1e3),i.userInfo?(console.log("\u7528\u6237\u6388\u6743:",i),o.storageUserInfo(i),e&&e(),r.destroy()):(console.log("\u7528\u6237\u62d2\u7edd\u6388\u6743:",i),t&&t(),r.destroy()))})}}})},e.prototype.noticeServerPay=function(){},e.prototype.pay=function(t,o,a){console.log("rechargeId="+t+", rechargeInfo="+a),console.log("GlobalVar.getZoneId()="+m.GlobalVar.getZoneId());var n=u.RechargeTableData.getById(t);if(n){if(console.log("buyQuantity="+n.money),e.getInstance().reportOrder_initiation(t,n.money),cc.sys.os==cc.sys.OS_ANDROID||cc.sys.os==cc.sys.OS_WINDOWS)cc.sys.os,cc.sys.OS_WINDOWS,f.setLocalData("userPayRechargeInfo",a),console.log("pay prepare="+f.getLocalData("userPayRechargeInfo","")),tt.requestGamePayment({mode:"game",env:0,currencyType:"CNY",platform:"android",buyQuantity:Math.floor(n.money/10),zoneId:"1",customId:a,extraInfo:n.money.toString(),success:function(){console.log("bytedance\u652f\u4ed8\u6210\u529f"),e.getInstance().reportOrder_complete(t,n.money)},fail:function(o){var i=o.errMsg,a=o.errCode;console.log("bytedance\u652f\u4ed8\u5931\u8d25",i,a),f.setLocalData("userPayRechargeInfo",""),console.log("pay fail"+f.getLocalData("userPayRechargeInfo","")),e.getInstance().reportOrder_cancel(t,n.money)}});else if(cc.sys.os==cc.sys.OS_IOS){var r="https://mszcs1.gameserver.iplay11g.com/gmsys/weblogic/web/bytedanceprepay_ios.php";i.getSubmitReviewState()&&(r="https://mszctest.gameserver.iplay11g.com/gmsys/weblogic/web/bytedanceprepay_ios.php");var s=a,c=n.money;tt.request({url:r,data:{bill_no:s,bill_money:c},success:function(o){console.log("bytedance, pay, bytedanceprepay_ios SUCC=",o);var i=(new DOMParser).parseFromString(o.data,"text/xml"),a=i.getElementsByTagName("mweb_url")[0].childNodes[0].nodeValue;console.log("return_code=",i.getElementsByTagName("return_code")[0].childNodes[0].nodeValue),console.log("return_msg=",i.getElementsByTagName("return_msg")[0].childNodes[0].nodeValue),console.log("prepay_id=",i.getElementsByTagName("prepay_id")[0].childNodes[0].nodeValue),console.log("mweb_url=",a);var r={url:a,referer:"https://mszctest.gameserver.iplay11g.com/third/recharge2.html"+("?orderid="+t+"&money="+n.money+"&openid="+e.Instance.openid+"&appid="+e.APPID_DOUYIN+"&appname="+e.APPNAME_DOUYIN+"&eventname=order_complete&os=ios"),success:function(e){console.log("open Webview success!",e)},fail:function(o){console.log("open Webview fail!",o),e.getInstance().reportOrder_cancel(t,n.money)}};tt.openWebview(r)},fail:function(o){console.log("bytedance, pay, bytedanceprepay_ios FAIL=",o),e.getInstance().reportOrder_cancel(t,n.money)}})}}else f.MESSAGETIPS("RECHARGE_ID_NOTEXIST")},e.prototype.inviteFriend=function(e,t,o,i,a,r){if(void 0===r&&(r=null),!n.G.UIManager.isFinghtingScene()){tt.shareAppMessage({title:e,imageUrlId:t,imageUrl:o,query:i});var c=new d.C_Role_ClientFinishShare;c.shareID=a,c.is_share=0,s.ClientNetwork.getInstance().Send(d.ROLE_CLIENT_ENUM.P_Role_ClientFinishShare,c),setTimeout(function(){r&&r()},500)}},e.prototype.checkInviteInfo=function(e){if(p.GamePlatform.isByteDanceMiniGame()){var t;for(var o in(t=e||tt.getLaunchOptionsSync()).query){if("battle"==o){var i=t.query.battle;if(i){console.log("checkInviteInfo battleInfo"+i);var r=i.split(".");if((c=new l.C_Match_Duel_Fight).fightType=Number(r[0]),c.useRoom=0,c.roomID=r[1],C.default.isChickenDinnerMatching())return n.G.StringManager.PopString(n.G.StringManager.getString("CHICKENDINNER_MATCHING")),a.default.callRoleClientLog("CHICKENDINNER_MATCHING1"),void console.log("isChickenDinnerMatching code=1");s.ClientNetwork.getInstance().Send(l.MATCH_CLIENT_ENUM.P_Match_Duel_Fight,c,!1)}}if("invite"==o){var c,u=t.query.invite;u&&(console.log("checkInviteInfo inviteInfo"+u),(c=new d.C_Role_ShareBindMaster).masterID=u,s.ClientNetwork.getInstance().Send(d.ROLE_CLIENT_ENUM.P_Role_ShareBindMaster,c,!1))}}}},e.prototype.getChannelID=function(){var e=tt.getLaunchOptionsSync();g.default.log("ByteDanceMIniGameUtils, getChannelID(), tt.getLaunchOptionsSync=",e);var t=e.query,o=(t.gdt_vid,t.weixinadinfo),i=t.channel,a=t.ad_id,n=t.unit_id;if(a)return Number(a)%1e9;if(n)return Number(n);var r=0;return o&&o.split("."),i?(r=Number(i),tt.setStorage({key:"wxaid",data:r}),r):(console.log("getChannelID "+JSON.stringify(e)),5e4)},e.prototype.onCreatGameClubBtn=function(e){if(!this.m_gameClubBtn){var t=tt.getSystemInfoSync(),o=e.getBoundingBoxToWorld(),i=cc.size(e.width+10,e.height+10),a=cc.view.getFrameSize(),n=cc.director.getWinSize(),r=o.x/n.width*a.width+t.safeArea.left+2*t.statusBarHeight,s=(n.height-o.y-i.height)/n.height*a.height,c=i.width/n.width*a.width,l=i.height/n.height*a.height;this.m_gameClubBtn=tt.createGameClubButton({type:"text",text:"",style:{left:r,top:s,width:c,height:l,lineHeight:0,backgroundColor:"",color:"#3296fa",textAlign:"center",fontSize:16,borderRadius:4}})}},e.prototype.wxReportAnalytics=function(e,t){p.GamePlatform.isQQMiniGame()&&tt.reportAnalytics(e,t)},e.prototype.wxOpenChannelsLive=function(){tt.openChannelsLive?tt.openChannelsLive({finderUserName:"sphKR1PR00Z3jIQ",success:function(e){console.log("\u6253\u5f00\u89c6\u9891\u53f7\u76f4\u64ad\u6210\u529f  ",e)},fail:function(e){console.log("\u6253\u5f00\u89c6\u9891\u53f7\u76f4\u64ad\u5931\u8d25 ",e)},complete:function(e){console.log("\u6253\u5f00\u89c6\u9891\u53f7\u76f4\u64ad\u8c03\u7528\u7ed3\u675f\u7684\u56de\u8c03\u51fd\u6570",e)}}):tt.showModal({title:"\u63d0\u793a",content:"\u5f53\u524d\u5fae\u4fe1\u7248\u672c\u8fc7\u4f4e\uff0c\u65e0\u6cd5\u4f7f\u7528\u8be5\u529f\u80fd\uff0c\u8bf7\u5347\u7ea7\u5230\u6700\u65b0\u5fae\u4fe1\u7248\u672c\u540e\u91cd\u8bd5\u3002"})},e.prototype.wxOnGameLiveStateChange=function(){},e.prototype.wxGetUserRecentGameLiveInfo=function(){},e.prototype.wxSyncLiveTimeUpdate=function(){},e.prototype.wxOffGameLiveStateChange=function(){},e.prototype.wxGetGameLiveState=function(){return!1},e.prototype.wxOpenChannelsLiveCollection=function(){tt.openChannelsLiveCollection?tt.openChannelsLiveCollection({openIds:["odsRR5Ew66DsDUAorrT1Ygq3kNzU","odsRR5LjOn0uTKVnZp6m6HsSXVlo","odsRR5LjOn0uTKVnZp6m6HsSXVlo","odsRR5Dad9eLrm4wydhun9EyxWD0"]}):tt.showModal({title:"\u63d0\u793a",content:"\u5f53\u524d\u5fae\u4fe1\u7248\u672c\u8fc7\u4f4e\uff0c\u65e0\u6cd5\u4f7f\u7528\u8be5\u529f\u80fd\uff0c\u8bf7\u5347\u7ea7\u5230\u6700\u65b0\u5fae\u4fe1\u7248\u672c\u540e\u91cd\u8bd5\u3002"})},e.prototype.getGameLiveFeedId=function(){var e=f.getLocalData("GameLiveFeedId");return e.length<=0?null:e},e.prototype.setSameLiveFeedId=function(e){f.setLocalData("GameLiveFeedId",e)},e.prototype.onSendUcConversionInfo=function(e,t){var o=this;if(tt.getStorageSync("uc_trackid"))tt.getStorage({key:"uc_trackid",success:function(i){console.log(i.data),o.onSyncUcreturnback(i.data,e,t)}});else{var i=function(){var e=tt.getLaunchOptionsSync().query;return e.uctrackid?(console.log("\u6253\u5370\u53c2\u6570",e.uctrackid),e.uctrackid):null}.call(this);if(!i)return h.TalkingDataAPI.event("ucNoTrackid"),a.default.callRoleClientLog("ucNoTrackid"),void console.log("not get ucNoTrackid!");tt.setStorage({key:"uc_trackid",data:i,success:function(){o.onSyncUcreturnback(i,e,t)}})}},e.prototype.onSyncUcreturnback=function(e,t,o){console.log("\u6253\u5370\u53c2\u6570Uc  ",e,t,o),e&&(o=o||"1",tt.request({url:"https://mszctest.gameserver.iplay11g.com/gmsys/weblogic/webc/ucreturnback.php",data:{type:t,money:o},success:function(e){console.log("onSendUC success",e.data),h.TalkingDataAPI.event("onSendUC.success",{code:e.data}),a.default.callRoleClientLog(e.data)},fail:function(e){console.log("onSendUC failed1"+e),h.TalkingDataAPI.event("onSendUC.failed",{code:e}),a.default.callRoleClientLog("onSendUC.failed")}}))},e.prototype.onSendBiliConversionInfo=function(e,t){var o=this;if(tt.getStorageSync("bili_trackid"))tt.getStorage({key:"bili_trackid",success:function(i){console.log(i.data),o.onSyncBilireturnback(i.data,e,t)}});else{var i=function(){var e=tt.getLaunchOptionsSync().query;return e.trackid?(console.log("\u6253\u5370\u53c2\u6570",e.trackid),e.trackid):null}.call(this);if(!i)return h.TalkingDataAPI.event("biliNoTrackid"),a.default.callRoleClientLog("biliNoTrackid"),void console.log("not get biliNoTrackid!");tt.setStorage({key:"bili_trackid",data:i,success:function(){o.onSyncBilireturnback(i,e,t)}})}},e.prototype.onSyncBilireturnback=function(e,t,o){console.log("\u6253\u5370\u53c2\u6570B\u7ad9  ",e,t,o),e&&(o=o||1,tt.request({url:"https://mszcs1.gameserver.iplay11g.com/gmsys/weblogic/webc/bilibilireturnback.php",data:{conv_type:t,track_id:e,conv_value:o},success:function(e){console.log("onSendBili success",e.data),h.TalkingDataAPI.event("onSendBili.success",{code:e.data}),a.default.callRoleClientLog(e.data)},fail:function(e){console.log("onSendBili failed1"+e),h.TalkingDataAPI.event("onSendBili.failed",{code:e}),a.default.callRoleClientLog("onSendBili.failed")}}))},e.prototype.onSendFeishuConversionInfo=function(e,t){var o=this;if(tt.getStorageSync("feishu_clue_token"))tt.getStorage({key:"feishu_clue_token",success:function(i){console.log(i.data),o.onSyncFeishureturnback(i.data,e,t)}});else{var i=function(){var e=tt.getLaunchOptionsSync().query;return e.clue_token?e.clue_token:null}.call(this);if(!i)return h.TalkingDataAPI.event("feishuNoClueToken"),a.default.callRoleClientLog("feishuNoClueToken"),console.log("not get clue_token!");tt.setStorage({key:"feishu_clue_token",data:i,success:function(){o.onSyncFeishureturnback(i,e,t)}})}},e.prototype.onSyncFeishureturnback=function(e,t,o){console.log("\u6253\u5370\u53c2\u6570\u6296\u97f3  ",e,this.m_weichatLoginData.accountname,this.m_weichatLoginData.openid),e&&(o=o||0,tt.request({url:"https://mszctest.gameserver.iplay11g.com/gmsys/weblogic/webc/feishureturnback.php",data:{clue_token:e,union_id:this.m_weichatLoginData.accountname,open_id:this.m_weichatLoginData.openid,event_type:t,props:{pay_amount:o}},success:function(e){console.log("onSendFeishu success",e.data),h.TalkingDataAPI.event("onSendFeishu.success",{code:e.data}),a.default.callRoleClientLog(e.data)},fail:function(e){console.log("onSendFeishu failed1"+e),h.TalkingDataAPI.event("onSendFeishu.failed",{code:e}),a.default.callRoleClientLog("onSendFeishu.failed")}}))},e.prototype.shareRenderTexture=function(){},e.prototype.startVideoRecording=function(){console.log("\u6296\u97f3\u5f55\u5c4fstartVideoRecording####################");var e=this;null==this.m_gameRecorderManager&&(this.m_gameRecorderManager=tt.getGameRecorderManager(),this.m_gameRecorderManager.onStart(function(){console.log("onStart \u5f55\u5c4f\u5f00\u59cb"),e.m_isRecording=!0}),this.m_gameRecorderManager.onInterruptionBegin(function(){console.log("onInterruptionBegin \u76d1\u542c\u5f55\u5c4f\u4e2d\u65ad\u5f00\u59cb\u4e8b\u4ef6\u3002"),e.m_gameRecorderManager.pause()}),this.m_gameRecorderManager.onInterruptionEnd(function(){console.log("onInterruptionEnd \u76d1\u542c\u5f55\u5c4f\u4e2d\u65ad\u7ed3\u675f\u3002"),e.m_gameRecorderManager.resume()}),this.m_gameRecorderManager.onStop(function(t){e.m_isRecording=!1,e.m_lastVideoPath=t.videoPath,console.log("onStop \u5f55\u5c4f\u505c\u6b62",e.m_lastVideoPath)}),this.m_gameRecorderManager.onError(function(t){e.m_isRecording=!1,console.log("onError \u5f55\u5c4f\u9519\u8bef",t)}),this.m_gameRecorderManager.onPause(function(){console.log("onPause \u5f55\u5c4f\u6682\u505c")})),this.m_isRecording&&(this.m_isRecording=!1,this.m_gameRecorderManager.stop());try{this.m_videoRecordStartTime=(new Date).getTime(),this.m_gameRecorderManager.start({duration:15,isMarkOpen:!0,locLeft:0,locTop:0})}catch(t){console.log("\u5f55\u5c4f\u5f00\u59cberror\uff1a",t)}},e.prototype.stopVideoRecording=function(){console.log("stopVideoRecording \u5f55\u5c4f\u505c\u6b62####################"),null!=this.m_gameRecorderManager?(this.m_videoRecordEndTime=(new Date).getTime(),this.m_gameRecorderManager.stop()):console.log("this.m_gameRecorderManager == null\uff0c\u5f55\u5c4fstop fail")},e.prototype.shareVideoRecording=function(){if(console.log("shareVideoRecording \u5206\u4eab\u5f55\u5c4f, time=",this.m_videoRecordEndTime-this.m_videoRecordStartTime,", videoPath=",this.m_lastVideoPath),this.m_videoRecordEndTime-this.m_videoRecordStartTime<=4e3)n.G.StringManager.PopStringOnce("\u5f55\u5c4f\u5c0f\u4e8e3s\uff0c\u65e0\u6cd5\u5206\u4eab");else{var e;e=""==this.m_lastVideoPath||null==this.m_gameRecorderManager?{title:n.G.StringManager.getString("INVITE_BATTLE_TIP"),desc:"\u6211\u5728\u3010\u5854\u9632\u7cbe\u7075\u3011\u5c0f\u6e38\u620f\u4e2d\u7b49\u4f60",imageUrl:"https://tfjl-1300944069.file.myqcloud.com/invite.png",query:"",success:function(){console.log("\u5206\u4eab\u6210\u529f")},fail:function(){console.log("\u5206\u4eab\u5931\u8d25")}}:{title:"\u4e00\u8d77\u6765\u73a9\u5854\u9632\u7cbe\u7075\u554a",channel:"video",extra:{videoPath:this.m_lastVideoPath,videoTopics:["\u5854\u9632\u7cbe\u7075","\u5854\u9632\u81ea\u8d70\u68cb"],hashtag_list:["\u5854\u9632\u7cbe\u7075","\u5854\u9632\u81ea\u8d70\u68cb"],videoTag:"\u5854\u9632\u81ea\u8d70\u68cb",video_title:"\u6211\u5728\u3010\u5854\u9632\u7cbe\u7075\u3011\u5c0f\u6e38\u620f\u4e2d\u7684\u89c6\u9891"},success:function(){n.G.StringManager.PopStringOnce("\u6210\u529f\u5206\u4eab\u89c6\u9891\u5230\u6296\u97f3")},fail:function(e){console.log("fail \u5206\u4eab\u9519\u8bef=",e)}},tt.shareAppMessage(e)}},e.prototype.createKefuBtn=function(){var e=tt.createContactButton({type:"image",image:"douyinkefu.png",text:"",style:{left:10,top:60,width:40,height:30,lineHeight:40,backgroundColor:"#00ffff00",textAlign:"center",fontSize:16,borderRadius:4,borderColor:"#0000ff00",borderWidth:2,textColor:"#cccccc"},success:function(e){console.log("create success",e)},fail:function(e){console.log("create fail",e)},complete:function(e){console.log("create complete",e)}});e.onTap(function(){console.log("\u70b9\u51fb\u5ba2\u670d\u6309\u94ae")}),this.kefuBtn=e},e.prototype.destroyKefuBtn=function(){null!=this.kefuBtn&&this.kefuBtn.destroy()},e.prototype.changeSkinOfAdButton=function(e,t){if(null!=e){var o=e.getComponent(cc.Sprite);null!=o&&f.setTexture(o,"douyin/"+t)}},e.prototype.getTimeStamp=function(){return v.default.getServersTime2()},e.prototype.reportLaunch=function(){if(0!=p.GamePlatform.isByteDanceMiniGame()){var t={event_name:"launch",timestamp:e.Instance.getTimeStamp(),param:{open_id:e.Instance.openid}};null!=this.m_clickid&&this.m_clickid.length>0&&(t.param.click_id=this.m_clickid),null!=this.m_adid&&this.m_adid.length>0&&(t.param.ad_id=this.m_adid),null!=this.m_creativeid&&this.m_creativeid.length>0&&(t.param.creative_id=this.m_creativeid),null!=this.m_creativetype&&this.m_creativetype.length>0&&(t.param.creative_type=this.m_creativetype),null!=this.m_scene&&this.m_scene.length>0&&(t.param.scene=this.m_scene),this.doReprot(t)}},e.prototype.reportAd_click=function(){if(0!=p.GamePlatform.isByteDanceMiniGame()){var t={event_name:"advertisement_click",timestamp:e.Instance.getTimeStamp(),param:{open_id:e.Instance.openid}};this.doReprot(t)}},e.prototype.reportAd_complete=function(){if(0!=p.GamePlatform.isByteDanceMiniGame()){var t={event_name:"advertisement_complete",timestamp:e.Instance.getTimeStamp(),param:{open_id:e.Instance.openid}};this.doReprot(t)}},e.prototype.reportAd_close=function(){if(0!=p.GamePlatform.isByteDanceMiniGame()){var t={event_name:"advertisement_close",timestamp:e.Instance.getTimeStamp(),param:{open_id:e.Instance.openid}};this.doReprot(t)}},e.prototype.reportOrder_initiation=function(t,o){if(0!=p.GamePlatform.isByteDanceMiniGame()){var i={event_name:"order_initiation",timestamp:e.Instance.getTimeStamp(),param:{open_id:e.Instance.openid,order_id:t,amount:o}};this.doReprot(i)}},e.prototype.reportOrder_complete=function(t,o){if(0!=p.GamePlatform.isByteDanceMiniGame()){var i={event_name:"order_complete",timestamp:e.Instance.getTimeStamp(),param:{open_id:e.Instance.openid,order_id:t,amount:o}};this.doReprot(i)}},e.prototype.reportOrder_cancel=function(t,o){if(0!=p.GamePlatform.isByteDanceMiniGame()){var i={event_name:"order_cancel",timestamp:e.Instance.getTimeStamp(),param:{open_id:e.Instance.openid,order_id:t,amoun:o}};this.doReprot(i)}},e.prototype.doReprot=function(t){var o={magic_tag:"ss_app_log",header:{game_id:e.APPID_DOUYIN,game_name:e.APPNAME_DOUYIN,os:2==this.m_nPlatformOS?"ios":"android"},events:[t]};console.log("\u6296\u97f3\u4e0a\u62a5, params=",o);var i=JSON.stringify(o);console.log("\u6296\u97f3\u4e0a\u62a5, value=",i);var a=new XMLHttpRequest;a.onload=function(){console.log("\u6296\u97f3\u4e0a\u62a5, onload!")},a.onreadystatechange=function(){if(console.log("\u6296\u97f3\u4e0a\u62a5, onreadystatechange, readyState="+a.readyState+", status="+a.status),4==a.readyState&&console.log("\u6296\u97f3\u4e0a\u62a5, onreadystatechange, http=",a),4==a.readyState&&a.status>=200&&a.status<400){var e=JSON.parse(a.responseText);console.log("\u6296\u97f3\u4e0a\u62a5, response=",e)}},a.onerror=function(){console.log("\u6296\u97f3\u4e0a\u62a5, onerror!")},a.open("POST","https://ohayoo.cn/game_sdk/log/h5",!0),a.setRequestHeader("content-type","application/json; charset=utf-8"),a.send(i)},e.prototype.addToDesktop=function(){if(0!=p.GamePlatform.isByteDanceMiniGame()){console.log("addToDesktop, tt.onTouchEnd");try{console.log("addToDesktop, tt.canIUse=",tt.canIUse("addShortcut")),tt.addShortcut({success:function(){console.log("\u6dfb\u52a0\u684c\u9762\u6210\u529f"),a.default.callAddShortcutTask()},fail:function(e){console.log("\u6dfb\u52a0\u684c\u9762\u5931\u8d25",e.errMsg)}})}catch(e){}}},e.Instance=null,e.SDK_TYPE=14,e.JING_FEN_ID=60113,e.APPID_DOUYIN="tt3683403ea9bde84002",e.APPNAME_DOUYIN="tafangjingling",e}());o.default=y;var v=e("../common/PlayerModule"),C=e("../view/activity/ActivityModule");cc._RF.pop()},{"../../load":"load","../Global/GameGlobal":"GameGlobal","../StaticData/RechargeTableData":"RechargeTableData","../TalkingDataAPI":"TalkingDataAPI","../common/NetworkProtocolCommon":"NetworkProtocolCommon","../common/PlayerModule":"PlayerModule","../model/ServerAddrInfo":"ServerAddrInfo","../network/ClientNetwork":"ClientNetwork","../network/LocalMessage":"LocalMessage","../network/protocol/MatchProtocols":"MatchProtocols","../network/protocol/RoleProtocols":"RoleProtocols","../view/activity/ActivityModule":"ActivityModule","./GamePlatform":"GamePlatform","./GameUtils":"GameUtils","./LogUtil":"LogUtil","./subUtils/TypeDef":"TypeDef"}],CDKEYView:[function(e,t,o){"use strict";cc._RF.push(t,"fa303k74dVHkpYQs7rTN87b","CDKEYView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../modules/base/BaseView"),s=e("../network/ClientNetwork"),c=e("../network/protocol/RoleProtocols"),l=e("../modules/base/Decorators"),d=e("../modules/base/GameView"),u=e("../Global/GameGlobal"),h=cc._decorator,p=h.ccclass,f=h.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.editBoxNode=null,t._editboxString="",t.rewardCount=0,t}return a(t,e),t.path=function(){return"ui/playerInfo/CDKEY"},t.prototype.start=function(){s.ClientNetwork.getInstance().listenProtocol(c.ROLE_CLIENT_ENUM.P_Role_GetCDKReward,function(e){e.resetPos();var t=new c.S_Role_GetCDKReward;if(t.read(e))if(0==t.errorcode)this.editBoxNode.getComponent(cc.EditBox).string="",this._editboxString="",t.prize.length>0&&(this.tRewards=t.prize,this.rewardCount=0,this.onShowRewards());else switch(t.errorcode){case-6:u.G.StringManager.PopString("\u65e0\u6548\u7684\u5151\u6362\u7801\u7ec4!");break;case-5:u.G.StringManager.PopString("\u67e5\u8be2\u6570\u636e\u5e93\u5931\u8d25!");break;case-4:u.G.StringManager.PopString("\u5151\u6362\u7801\u5df2\u88ab\u4f7f\u7528!");break;case-2:u.G.StringManager.PopString("\u8fde\u63a5\u6570\u636e\u5e93\u5931\u8d25!");break;case 4:u.G.StringManager.PopString("\u5151\u6362\u7801\u6709\u6548\uff0c\u4f46\u672a\u5230\u5f00\u59cb\u65f6\u95f4");break;case 5:u.G.StringManager.PopString("\u5151\u6362\u7801\u5df2\u8fc7\u671f");break;case 6:u.G.StringManager.PopString("sdktype\u9519\u8bef");break;case 7:u.G.StringManager.PopString("sdkid\u9519\u8bef");break;case 8:u.G.StringManager.PopString("\u8be5\u5151\u6362\u7801\u5df2\u8fbe\u4f7f\u7528\u6b21\u6570\u4e0a\u9650\uff0c\u65e0\u6cd5\u4f7f\u7528");break;case 9:u.G.StringManager.PopString("\u5df2\u7ecf\u4f7f\u7528\u8fc7\u540c\u7c7b\u578b\u5151\u6362\u7801");break;case 10:u.G.StringManager.PopString("\u957f\u5ea6\u4e0d\u5bf9\uff0c\u9700\u89816~18\u4f4d");break;case 14:u.G.StringManager.PopString("\u6b64\u5151\u6362\u7801\u65e0\u5956\u52b1");break;default:u.G.StringManager.PopString("\u5151\u6362\u7801\u9519\u8bef  "+t.errorcode)}},this)},t.prototype.onEditingReturnCallBack=function(e){e.string.length<=0||(this._editboxString=e.string)},t.prototype.onClickExchangeCallBack=function(){if(this._editboxString.length<=0)return u.G.StringManager.PopString("\u8bf7\u8f93\u5165\u793c\u5305\u5151\u6362\u7801");var e=new c.C_Role_GetCDKReward;e.cdkstr=this._editboxString,s.ClientNetwork.getInstance().Send(c.ROLE_CLIENT_ENUM.P_Role_GetCDKReward,e)},t.prototype.onShowRewards=function(){var e=this,t=this.tRewards.slice(6*this.rewardCount,6*(this.rewardCount+1));t.length>0&&d.default.addPopView("BaseCtrl","AcquirePopupView","AcquirePopupView",{items:t,closeCb:function(){e.rewardCount++,e.onShowRewards()}})},n([f(cc.Node)],t.prototype,"editBoxNode",void 0),n([l.Register_Class,p],t)}(r.default);o.default=g,cc._RF.pop()},{"../Global/GameGlobal":"GameGlobal","../modules/base/BaseView":"BaseView","../modules/base/Decorators":"Decorators","../modules/base/GameView":"GameView","../network/ClientNetwork":"ClientNetwork","../network/protocol/RoleProtocols":"RoleProtocols"}],CarObj:[function(e,t,o){"use strict";cc._RF.push(t,"6cd88Ab06dB7LRt/YXaytdF","CarObj"),o.__esModule=!0,o.default=void 0;var i=e("../../StaticData/SoloSilverTableData"),a=e("../../TableReader"),n=E(e("../../utils/ConfigUtils")),r=e("../../utils/ConstValue"),s=E(e("../../utils/Debug")),c=E(e("../../utils/Tools")),l=E(e("../CombatManager")),d=E(e("../logic/AI")),u=E(e("../logic/CarSummon")),h=E(e("./HeroObj")),p=E(e("./NpcObj")),f=E(e("../../common/CombatModule")),g=e("../../network/ClientNetwork"),m=e("../../network/LocalMessage"),_=E(e("../../modules/manager/EventManager")),y=E(e("../../common/EventConst")),v=e("../../StaticData/RobotTableData"),C=e("../../network/protocol/FightProtocols"),S=E(e("../../common/PlayerModule")),T=(E(e("../../utils/GameTools")),e("../../utils/GameUtils")),I=e("../../network/protocol/TypeProtocols"),N=E(e("../../utils/ResourcesManager")),b=E(e("../../common/NetworkProtocolCommon")),w=e("../../modules/manager/cheat/SafeNumber");function E(e){return e&&e.__esModule?e:{default:e}}function P(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var R=e("../../utils/ConstValue"),L=R.Game_State,A=R.Enum_Elf_Card,D=function(e){var t,o;function p(){var t;return(t=e.call(this)||this).preNode=null,t.heroList={},t.summonList={},t.curHeroPos=0,t.model=null,t.addMoneyInterval=0,t.addMoney=0,t.cd=0,t.pAI=null,t.m_nAddSliverId=1,t.m_nAddSliverTotalTime=0,t.bIsSyncCarLvUp=!1,t.carSummonIndex=1,t.carSummonLastTime=0,t.carSummonBatchIndex=1,t.carSummonDelayTime=0,t.npcIdOffset=0,t.aiInfo=null,t.carTemplateID=r.CAR_TEMPLATE_ID.pvp,t.tbSlot={},t._carTmpHp=new w.SafeNumber(0),t}o=e,(t=p).prototype=Object.create(o.prototype),t.prototype.constructor=t,t.__proto__=o;var E,R,D=p.prototype;return D.destroy=function(){for(var t in this.heroList)if(t<90){var o=this.heroList[t];o&&o.destroy(),this.heroList[t]=null}for(var i in this.heroList=null,this.tbSlot)this.tbSlot[i]=null;for(var a in this.tbSlot=null,this.summonList)this.summonList[a].unbind(),this.summonList[a]=null;this.summonList=null,this.pAI&&this.pAI.unbind(),this.pAI=null,this.model=null,e.prototype.destroy.call(this)},D.init=function(t,o,s){var c=this;this.model=t;var d=n.default.getInstance().getCarConfig(t.templateId);if(d){this.carTemplateID=t.templateId;var u=d.npc_id+this.npcIdOffset;if(e.prototype.init.call(this,t.id,u,t.level,o,s),this.hurtEffect1=d.hurt_effect_1,this.hurtEffect2=d.hurt_effect_2,(l.default.getInstance().isPvP()||l.default.getInstance().isCoop()&&f.default.matchType==I.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE&&this.model.templateId==r.CAR_TEMPLATE_ID.coop_front)&&((0,a.PreLoadCsvSync)(i.SoloSilverTableData.getFilename()).then(function(){c.addMoneyInterval=i.SoloSilverTableData.getById(c.m_nAddSliverId).nTimeInterval,c.addMoney=i.SoloSilverTableData.getById(c.m_nAddSliverId).nSilverNum}),this.initBindSummon()),this.cd=this.addMoneyInterval,this.aiId=d.ai,this.aiId>0?this.bAI=!0:this.bAI=!1,this.isUpgrading=!1,l.default.getInstance().gameState!=L.Reconnect){var h=new C.T_Blood_Struct;if(h.dropBlood=0,h.maxBlood=this.getMaxHp(),h.type=this.npcType,h.heroId=u,h.extraDropMoney=0,this.camp===r.PLAYER_CAMP.myPlayer)this.dropBloodMap.set(S.default.UUID,h);else if(this.camp!=r.PLAYER_CAMP.opponentsCoop){var p=f.default.getMatchBattleInfo(!1);this.dropBloodMap.set(p.roleID,h)}}}},D.setNpcIdOffset=function(e){l.default.getInstance().isCoop()&&!l.default.getInstance().isSkyCastle()&&this.camp==r.PLAYER_CAMP.opponents||(this.npcIdOffset=e)},D.setAutoAI=function(e,t){this.bAI=e,this.aiId=t,this.aiId<=0&&(this.bAI=!1)},D.setSummonIndex=function(e){this.carSummonIndex=e},D.setSummonLastTime=function(e){this.carSummonLastTime=e},D.setSummonBatchIndex=function(e){this.carSummonBatchIndex=e},D.setSummonDelayTIme=function(e){this.carSummonDelayTime=e},D.onLoadRes=function(t){var o=this;if(e.prototype.onLoadRes.call(this,t),this.generateProtectSlots(),this.generateAllNodes(),this.initSlot(),this.initHero(),this.destroyPreNode(),this.initBindHero(),this.node.name="car"+this.camp,(this.level<=1||f.default.matchType==I.FIGHT_TYPE.FIGHT_TYPE_BATTLE_EAT_CHICKEN&&6==this.level||f.default.matchType==I.FIGHT_TYPE.FIGHT_TYPE_COOPERATION&&this.camp==r.PLAYER_CAMP.opponents&&6==this.level)&&cc.director.emit("Event_SummonNpc",this.camp,this.id),1==this.bAI&&!this.pAI){this.pAI=new d.default,this.pAI.init(v.RobotTableData.getById(this.aiId).aiid,this);var i=v.RobotTableData.getById(this.aiId),a=n.default.getInstance().getNpcTemplateConfig(this.templateId,this.model.level),s=(0,T.clone)(a);if(s.hp=i.carUpHp||0,l.default.getInstance().isCoop()){var c=(0,T.getRoleIdentity)(this.camp);if(c==r.PLAYER_IDENTITY.home)s.hp=0;else if(c==r.PLAYER_CAMP.opponentsCoop)s.hp=0;else{var u=n.default.getInstance().getCarConfig(this.model.templateId);if(u&&(s.hp=i.carUpHp+this.getHeroCardHp()+u.ini_hp),l.default.getInstance().isSkyCastle()&&this.camp==r.PLAYER_CAMP.opponents){var h=function(e){var t=0,o=f.default.getMatchBattleAIInfo(e);return o&&o.heros.forEach(function(e){var o=n.default.getInstance().getHeroConfig(e.heroID),i=n.default.getInstance().getNpcTemplateConfig(o.npc_id,e.heroLevel);t+=i.carhp}),t};s.hp=i.carUpHp,s.hp+=h(r.PLAYER_CAMP.opponents),s.hp+=h(r.PLAYER_CAMP.opponentsCoop);var p=f.default.getMatchBattleAIInfo(r.PLAYER_CAMP.opponentsCoop);if(p){var g=v.RobotTableData.getById(p.aiid);g&&(s.hp+=g.carUpHp)}}}}this.setAttr(s),this.onBorn()}l.default.getInstance().getController().appearanceCard.forEach(function(e){e&&cc.isValid(e)&&(e.destroy(),e=null)}),l.default.getInstance().getController().onLoadResComplete(),l.default.getInstance().isCoop()&&f.default.matchType==I.FIGHT_TYPE.FIGHT_TYPE_BATTLE_GREAT_SAILING&&(this.width=0,N.default.loadSpine("ui/ui_effects/zhanche_shuihua",function(e){e.parent=o.node,e.getComponent(sp.Skeleton).setAnimation(0,"idle",!0),e.y=0}))},D.generateAllNodes=function(){var e=this.node.getComponent(sp.Skeleton);this.model&&this.model.templateId==r.CAR_TEMPLATE_ID.coop_front&&this.model.level>=2&&(35==e.node.x?e.node.x+=65:-35==e.node.x&&(e.node.x-=65)),e.attachUtil.generateAllAttachedNodes()},D.generateProtectSlots=function(){var e=[];e[1]=cc.v2(35,100),e[2]=cc.v2(-90,100),e[3]=cc.v2(35,330),e[4]=cc.v2(-90,330),e[5]=cc.v2(35,550),e[6]=cc.v2(-90,550),e[7]=cc.v2(35,100),e[8]=cc.v2(-90,100),e[9]=cc.v2(35,330),e[10]=cc.v2(-90,330),e[11]=cc.v2(35,550),e[12]=cc.v2(225,330);var t=0;if(l.default.getInstance().isCoop()&&f.default.matchType!=I.FIGHT_TYPE.FIGHT_TYPE_BATTLE_GREAT_SAILING){var o=0;t=-200,this.carTemplateID==r.CAR_TEMPLATE_ID.coop_front&&(t=150,1==this.level&&(o+=50)),this.level<=2?e[12]=cc.v2(o,350):this.level<=4?e[12]=cc.v2(o,570):e[12]=cc.v2(o,790)}else e[12]=cc.v2(225,330);for(var i=this.node.getComponent(sp.Skeleton),a=1;a<=12;a++){var n=new cc.Node;n.parent=this.node;var s=0;i&&this.carTemplateID==r.CAR_TEMPLATE_ID.coop_front&&this.level>=2&&(35==i.node.x?s=65:-35==i.node.x&&(s=-65)),n.x=e[a].x+s+t,n.y=e[a].y,this.tbSlot&&(this.tbSlot[a]=n,a<7&&(this.tbSlot[a].zIndex=10-a))}},D.initSlot=function(){if(this.model){var e=n.default.getInstance().getCarConfig(this.model.templateId);if(e){var t={};t[1]=cc.find(e.slot_1,this.node),t[2]=cc.find(e.slot_2,this.node),t[3]=cc.find(e.slot_3,this.node),t[4]=cc.find(e.slot_4,this.node),t[5]=cc.find(e.slot_5,this.node),t[6]=cc.find(e.slot_6,this.node),t[7]=cc.find(e.slot_7,this.node),t[8]=cc.find(e.slot_8,this.node),t[9]=cc.find(e.slot_9,this.node),t[10]=cc.find(e.slot_10,this.node),t[11]=cc.find(e.slot_11,this.node),t[12]=cc.find(e.slot_12,this.node);for(var o=1;o<=12;o++)t[o]&&(this.tbSlot[o]=t[o]);for(var i=1;i<7;i++)this.tbSlot[i].zIndex=10-i}}},D.initHero=function(){for(var e in this.heroList){var t=this.heroList[e];t&&(t.node.parent=this.tbSlot[e])}},D.addBuffToTargetProfHero=function(e,t){if(0!=t)for(var o in this.heroList){var i=this.heroList[o];i&&i.occupation==e&&i.addBuff(t)}},D.addBuffToTargetHero=function(e,t){if(0!=t)for(var o in this.heroList){var i=this.heroList[o];i&&i.id==e&&i.addBuff(t)}},D.addBuffToAllHero=function(e){if(0!=e)for(var t in this.heroList){var o=this.heroList[t];o&&o.addBuff(e)}},D.modAttrToTargetProfHero=function(e,t,o){if(0!=t&&0!=o)for(var i in this.heroList){var a=this.heroList[i];a&&a.occupation==e&&a.modAttr(t,o)}},D.modAttrToTargetHero=function(e,t,o){if(0!=t&&0!=o)for(var i in this.heroList){var a=this.heroList[i];a&&a.id==e&&a.modAttr(t,o)}},D.modAttrToAllHero=function(e,t){if(0!=e&&0!=t)for(var o in this.heroList){var i=this.heroList[o];i&&i.modAttr(e,t)}},D.removeBuffFromAllHero=function(e){if(0!=e)for(var t in this.heroList){var o=this.heroList[t];o&&o.removeBuffByTemplateId(e)}},D.removeBuffFromTargetProfHero=function(e,t){if(0!=t)for(var o in this.heroList){var i=this.heroList[o];i&&e==i.occupation&&i.removeBuffByTemplateId(t)}},D.getHeroObjById=function(e){for(var t in this.heroList){var o=this.heroList[t];if(o&&o.id==e)return o}return null},D.getHeroProfNum=function(e,t){for(var o in this.heroList){var i=this.heroList[o];if(i){e==i.occupation&&t.add(i.heroTemplateId);for(var a=i.getProfMinusNum();a>0;)t.add(9990+a),a--}}},D.getSameProfNum=function(e,t){for(var o in this.heroList){var i=this.heroList[o];i&&e==i.occupation&&t.add(i.heroTemplateId)}},D.destroyPreNode=function(){this.preNode&&(this.preNode.destroy(),this.preNode=null)},D.initBindHero=function(){for(var e=1;e<=this.level;e++)this.createBindHeroAtLevel(e);for(e=12;e<12+this.model.heroNum-this.getHeroNum();e++)this.createBindHeroAtLevel(e)},D.setBossCarHeroReconnectInfo=function(){var e=f.default.matchReconnectData;if(l.default.getInstance().gameState==L.Reconnect&&null!=e){var t=null,o=r.PLAYER_CAMP.opponents+1;for(var i in e.playerInfo)if(e.playerInfo[i].roleIdentity==o){t=e.playerInfo[i];break}if(t)for(var a in t.heroVector){var s=t.heroVector[a].level,d=t.heroVector[a].heroID,u=t.heroVector[a].starLevel,h=t.heroVector[a].heroPos,p=t.heroVector[a].attr,g=t.heroVector[a].skillVector,m=t.heroVector[a].buffVector;if(s>0){var _=n.default.getInstance().getHeroConfig(d);this.model.tbBindHeroInfo[h]={templateId:d,pos:h,level:s,npcTemplateId:_.npc_id,starLevel:u,attr:p,skill:g,buff:m},this.model.tbHeroList[d]={id:c.default.getInstance().genId(),templateId:d,starLevel:u,pos:h,npcTemplateId:_.npc_id,level:s},this.model.tbHeroPosInfo[h]=d,this.model.heroNum=this.model.heroNum+1}}}},D.setReconnectData=function(){f.default.matchType==I.FIGHT_TYPE.FIGHT_TYPE_COOPERATION&&this.camp==r.PLAYER_CAMP.opponents&&this.setBossCarHeroReconnectInfo();for(var e=1;e<=this.level;e++)this.setHeroReconnectData(e);for(e=12;e<=12+this.model.heroNum-this.getHeroNum();e++)this.setHeroReconnectData(e)},D.setHeroReconnectData=function(e){var t=this.model.getBindHeroInfoByLevel(e);if(t&&t.attr){var o=this.heroList[e];if(o){for(var i in o.setCastSkillCount(t.attr.pop()),o.summonMonsterCount=t.attr.pop(),t.skill)if(t.skill[i])for(var a in o.pSkillObjList)o.pSkillObjList[a].templateId==t.skill[i].skillID&&(o.pSkillObjList[a].deltaTime=t.skill[i].cdtime,o.pSkillObjList[a].randomSeed&&o.pSkillObjList[a].randomSeed.RandomSeed(o.getCastSkillCount()));for(var n in o.removeAllBuff(),t.buff)if(t.buff[n]){var s=t.buff[n],c=null;if(0!=s.sourceGid)c=l.default.getInstance().getNpcList()[s.sourceGid];else if(0!=s.towerData.heroID){var d=l.default.getInstance().getNpcList()[s.towerData.roleIdentity];d&&(c=d.getHeroObjByHeroID(s.towerData.heroID))}for(var u in o.addBuff(t.buff[n].buffID,c),o.buffList)o.buffList[u].templateId==t.buff[n].buffID&&(o.buffList[u]._LastTime=t.buff[n].lifetime,o.buffList[u]._continueIntervalTime=t.buff[n].continueIntervalTime)}if(57==t.templateId){var h=r.PLAYER_CAMP.opponents;l.default.getInstance().isCoop()&&(h=r.PLAYER_CAMP.coopPlayer);var p=function(e,t){var o=l.default.getInstance().getPlayerModelByCamp(e);o&&o.setChangeSpritRS(t)},f=function(e,t){var o=l.default.getInstance().getPlayerModelByCamp(e);o&&o.setBossChangeSpritRS(t)};l.default.getInstance().isCoop()?this.camp==r.PLAYER_CAMP.opponentsCoop||this.camp==r.PLAYER_CAMP.opponents?(f(r.PLAYER_CAMP.coopPlayer,t.templateId),f(r.PLAYER_CAMP.myPlayer,t.templateId)):this.camp!=r.PLAYER_CAMP.coopPlayer&&this.camp!=r.PLAYER_CAMP.myPlayer||(p(r.PLAYER_CAMP.opponents,t.templateId),p(r.PLAYER_CAMP.opponentsCoop,t.templateId)):l.default.getInstance().getPlayerModelByCamp(h).setChangeSpritRS(o.getCastSkillCount())}o.cloneAttr(t)}this.model.setBindHeroInfoByLevel(e)}},D.createBindHeroAtLevel=function(e){if(this.model){var t=this.model.getBindHeroInfoByLevel(e);if(t){var o=this.addHero(t);o&&o.star>=r.HeroMaxLevel&&(o.initMaxLvPassiveSkill(t.templateId),cc.director.emit("Event_changeHero",this.camp,o.heroTemplateId),_.default.Instance.emit(y.default.BattleChangeHero,this.camp))}}},D.initBindSummon=function(){var e=0;if(f.default.matchType==I.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE?this.model.templateId==r.CAR_TEMPLATE_ID.coop_front&&(e=this.camp==r.PLAYER_CAMP.myPlayer||this.camp==r.PLAYER_CAMP.coopPlayer?Number(f.default.getCarSummonId(r.PLAYER_CAMP.myPlayer)):Number(f.default.getCarSummonId(r.PLAYER_CAMP.opponents))):e=Number(f.default.getCarSummonId(this.camp)),e>0){var t=new u.default;t.init(e,this.camp,this.campParam,this.carSummonIndex,this.carSummonLastTime,this.carSummonBatchIndex,this.carSummonDelayTime),this.summonList[t.getSummonId()]=t}},D.refreshLevel=function(e){this.playLevelUpEffect(e),cc.director.emit("Npc_LevelUp",1)},D.playLevelUpEffect=function(t){var o=this;cc.resources.load("combat/effect/shengji_zhanchang/shengji_zhanchang",sp.SkeletonData,function(i,a){if(i)return s.default.error("load err errff "+i.meaage),void e.prototype.refreshLevel.call(o,t);cc.isValid(o,!0)&&cc.isValid(o.node,!0)&&o.onLoadLevelUpEf(a,t)})},D.onLoadLevelUpEf=function(t,o){var i=this,a=new cc.Node;a.parent=this.node,a.x=0,a.y=200;var n=a.addComponent(sp.Skeleton);n.skeletonData=t,n.setSkin("default"),n.setAnimation(0,"idle",!0),n.setCompleteListener(function(t){"idle"===(t.animation?t.animation.name:"")&&(a.destroy(),e.prototype.refreshLevel.call(i,o),i.isUpgrading=!1)})},D.onHurt=function(e,t,o,i,a,n){if(this.state!=r.NPC_STATE.Dead){""!=e.behitRes&&c.default.playEffect(e.behitRes,this.node,cc.v2(s,this.height),e.behitScale),this.createPopFont(t,o,i,n);var s=0;if(l.default.getInstance().isCoop()&&!o){s=100;var d=l.default.getInstance().getCoopCarByCamp(this.camp);d&&d.chgState(r.NPC_STATE.Behit)}o||(this.isDead()?this.toDie():this.chgState(r.NPC_STATE.Behit))}},D.chkPlayEffect=function(){var e=this.lastHp,t=this.hp,o=this.maxHp;t<.25*o?e>=.25*t&&this.playEffect():t<.5*o?e>=.5*o&&this.playEffect():t<.75*o&&e>=.75*o&&this.playEffect()},D.playEffect=function(){var e=c.default.rand(0,this.getLevel());this.loadEffect(e,this.hurtEffect1),this.loadEffect(e,this.hurtEffect2)},D.loadEffect=function(e,t){var o=this;cc.resources.load(t,function(i,a){if(i)s.default.error("load res: "+t+"failed");else{var n=cc.instantiate(a);n.x=0,n.y=0,o.tbSlot&&(n.parent=o.tbSlot[e]),n.getComponent(sp.Skeleton).setAnimation(0,"idle",!0)}})},D.getHeroObj=function(e){for(var t in this.heroList){var o=this.heroList[t];if(o&&o.templateId==e)return o}return null},D.getHeroObjByHeroID=function(e){for(var t in this.heroList){var o=this.heroList[t];if(o&&o.heroTemplateId==e)return o}return null},D.addHero=function(e){var t=new h.default;if(t.setCamp(this.getCamp()),this.tbSlot||(b.default.callRoleClientLog("addHero slotErr"),this.generateProtectSlots()),t.init(e.templateId,e.npcTemplateId,e.level,this.tbSlot[e.pos],cc.v2(0,0),e.templateId,e.starLevel),t.setHeroPos(e.pos),e.pos<100&&(this.heroList[e.pos]=t),t.node.name="HeroNode",2==n.default.getInstance().getHeroConfig(e.templateId).hero_type)return t;if(cc.director.emit("Event_AddHero",this.camp,t.id),cc.director.emit("Event_changeHero",this.camp,t.heroTemplateId),_.default.Instance.emit(y.default.BattleChangeHero,this.camp),Object.keys(this.heroList).length<=1&&this.getCamp()===r.PLAYER_CAMP.myPlayer&&!l.default.getInstance().getController().node.getChildByName("guideHeroClickNode")){var o=new cc.Node("guideHeroClickNode");o.parent=l.default.getInstance().getController().node,o.width=100,o.height=100;var i=t.node.parent.convertToWorldSpaceAR(cc.v2(0,0));i=o.parent.convertToNodeSpaceAR(i),o.x=i.x,o.y=i.y+30}return t},D.refreshHeroInfo=function(e,t,o){var i=e.starLevel,a=e.pos,n=e.templateId;if(1==i)this.addHero(e);else{var r=this.heroList[a];r&&(c.default.playEffect("combat/effect/shengji/shengji",r.node,cc.v2(0,0)),r.refreshStar(i,n),t&&r.initMaxLvPassiveSkill(e.templateId),cc.director.emit("Event_changeHero",this.camp,r.heroTemplateId),_.default.Instance.emit(y.default.BattleChangeHero,this.camp))}o&&o==A.guangElf||g.ClientNetwork.getInstance().pushLocalMessage(m.LOCAL_MESSAGE.LocalMsg_BuyFightCard,this.camp)},D.refreshFallHeroInfo=function(e){if(e){var t=this.heroList[e.pos];if(t){if(c.default.playEffect("combat/effect/shengji/shibai",t.node,cc.v2(0,0)),t.refreshStar(e.starLevel,e.templateId),t.maxPassiveSkillObjList){for(var o in t.maxPassiveSkillObjList)t.maxPassiveSkillObjList[o]&&(t.maxPassiveSkillObjList[o].unbind(),t.maxPassiveSkillObjList[o]=null);t.maxPassiveSkillObjList=[]}(!t.pPassiveSkillObjList||t.pPassiveSkillObjList.length<=0)&&t.initPassiveSkills(),cc.director.emit("Event_changeHero",this.camp,t.heroTemplateId),_.default.Instance.emit(y.default.BattleChangeHero,this.camp)}}},D.getHeroList=function(){return this.heroList},D.playUpFailEffect=function(e){if(e){var t=this.heroList[e.pos];t&&c.default.playEffect("combat/effect/shengji/shibai",t.node,cc.v2(0,0))}},D.canWalk=function(){return!1},D.update=function(t){if(this.state!=r.NPC_STATE.Dead){for(var o in this.heroList){var a=this.heroList[o];a&&a.update(t)}for(var n in this.summonList)this.summonList[n]&&this.summonList[n].update(t);this.addMoney>0&&(this.cd=this.cd-1e3*t,this.cd<=0&&(l.default.getInstance().getPlayerModelByCamp(this.camp).addMoney(this.addMoney),this.m_nAddSliverTotalTime+=this.addMoneyInterval,l.default.getInstance().isPvP()&&i.SoloSilverTableData.getById(this.m_nAddSliverId).nTimeMax<=this.m_nAddSliverTotalTime&&(this.m_nAddSliverId+=1,this.addMoneyInterval=i.SoloSilverTableData.getById(this.m_nAddSliverId).nTimeInterval,this.addMoney=i.SoloSilverTableData.getById(this.m_nAddSliverId).nSilverNum),this.cd=this.addMoneyInterval)),e.prototype.update.call(this,t),this.bAI&&this.pAI&&this.pAI.update(t)}else this.onDie()},D.deleteHero=function(e){var t=this.heroList[e];if(t){var o=t.heroTemplateId;t.destroy(),this.heroList[e]=null,cc.director.emit("Event_changeHero",this.camp,o),_.default.Instance.emit(y.default.BattleChangeHero,this.camp)}},D.addBuff=function(t,o){e.prototype.addBuff.call(this,t,o);var i=n.default.Instance.getBuffConfig(Number(t));if(!i||i.type!=r.Buff_Type.AddMoney&&i.type!=r.Buff_Type.Equip_Invalid&&i.type!=r.Buff_Type.Sliver_Curse&&i.type!=r.Buff_Type.Extra_Sliver_Invalid)for(var a in this.heroList){var s=this.heroList[a];s&&s.addBuff(t,o)}},D.removeBuffById=function(t,o){void 0===o&&(o=!1),e.prototype.removeBuffById.call(this,t,o);var i=n.default.Instance.getBuffConfig(Number(t));if(!i||i.type!=r.Buff_Type.AddMoney)for(var a in this.heroList){var s=this.heroList[a];s&&s.removeBuffById(t,o)}},D.removeBuffByTemplateId=function(t){for(var o in e.prototype.removeBuffByTemplateId.call(this,t),this.heroList){var i=this.heroList[o];i&&i.removeBuffByTemplateId(t)}},D.toDie=function(){this.chgState(r.NPC_STATE.Dead)},D.onDie=function(){(l.default.getInstance().gameState==L.End||l.default.getInstance().isCoop()&&(this.camp==r.PLAYER_CAMP.opponents||this.camp==r.PLAYER_CAMP.opponentsCoop))&&(l.default.getInstance().deleteCardByCamp(this.camp),e.prototype.onDie.call(this))},D.getCarUpgradeState=function(){return this.isUpgrading},D.setCarUpgradeState=function(e){this.isUpgrading=e},D.getRandHero=function(e){var t=0;for(var o in this.heroList){var i=this.heroList[o];if(i&&++t==e)return i}return null},D.getHeroByAttrTypeMax=function(e){if(Object.keys(this.heroList).length<=0)return null;var t=0,o=null;for(var i in this.heroList){var a=this.heroList[i];if(a){var n=0;e==r.Npc_Attr_Type.attack&&(n=Number(a.getAttack())),n>t&&(t=n,o=a)}}return o},D.getHeroByLvType=function(e,t){if(Object.keys(this.heroList).length<=0)return null;var o=0;t==r.SKILL_SEARCH_CONDITION.GTRLvOne&&(o=1);var i=0;for(var a in this.heroList){var n=this.heroList[a];if(n){var s=this.model.tbHeroList[n.heroTemplateId];if(n&&s&&s.starLevel>o&&++i==e)return n}}return null},D.getHeroByExProfType=function(e,t){if(Object.keys(this.heroList).length<=0)return null;var o=0;for(var i in this.heroList){var a=this.heroList[i];if(a&&a.occupation==t&&++o==e)return a}return null},D.getRandExcludeHero=function(e,t){var o=0;for(var i in this.heroList){var a=this.heroList[i];if(a&&a.heroTemplateId!=t&&++o==e)return a}return null},D.getExcludeHeroByAttrTypeMax=function(e,t){if(Object.keys(this.heroList).length<=0)return null;var o=0,i=null;for(var a in this.heroList){var n=this.heroList[a];if(n&&n.heroTemplateId!=t){var s=0;e==r.Npc_Attr_Type.attack&&(s=Number(n.getAttack())),s>o&&(o=s,i=n)}}return i},D.addAllHeroPSkill=function(e){if(Object.keys(this.heroList).length<=0)return null;for(var t in this.heroList){var o=this.heroList[t];o&&o.addPassiveSkill(e)}},D.removeAllHeroPSkill=function(e){if(Object.keys(this.heroList).length<=0)return null;for(var t in this.heroList){var o=this.heroList[t];o&&o.removePassiveSkill(e)}},D.checkAllIsSameProf=function(e){var t=!0;for(var o in this.heroList)if(this.heroList[o]&&prof!=e)return!1;return t},D.getHeroNum=function(){var e=0;for(var t in this.heroList)this.heroList[t]&&e++;return e},D.getEngineerNum=function(){var e=0;for(var t in this.heroList){var o=this.heroList[t];o&&o.occupation==r.HERO_PROF_TYPE.Engineer&&e++}return e},D.getHeroLvNum=function(e){var t=0;e==r.SKILL_SEARCH_CONDITION.GTRLvOne&&(t=1);var o=0;for(var i in this.heroList){var a=this.heroList[i];if(a){var n=this.model.tbHeroList[a.heroTemplateId];a&&n&&n.starLevel>t&&o++}}return o},D.getHeroExcludeProfNum=function(e){var t=0;for(var o in this.heroList){var i=this.heroList[o];i&&i.occupation==e&&t++}return t},D.getHeroExcludeMaxAttackNum=function(e){var t=0;for(var o in this.heroList){var i=this.heroList[o];i&&(Number(i.getAttack())<e||1==this.getHeroNum())&&t++}return t},D.getHeroExcludeMaxAttack=function(e,t){if(Object.keys(this.heroList).length<=0)return null;var o=0;for(var i in this.heroList){var a=this.heroList[i];if(a&&(Number(a.getAttack())<t||1==this.getHeroNum())&&++o==e)return a}return null},D.getFallStarHerosNum=function(e){var t=0;for(var o in this.heroList)if(o<90){var i=this.heroList[o];i&&(e||i.star>1&&i.star<4)&&t++}return t},D.getAllHeroSkillID=function(e){for(var t in this.heroList){var o=this.heroList[t];if(o){var i=o.skillIdList.split("|");for(var a in i)e.push(i[a])}}},E=p,(R=[{key:"carTmpHp",get:function(){return this._carTmpHp.value},set:function(e){this._carTmpHp.value=e}}])&&P(E.prototype,R),p}(p.default);o.default=D,t.exports=o.default,cc._RF.pop()},{"../../StaticData/RobotTableData":"RobotTableData","../../StaticData/SoloSilverTableData":"SoloSilverTableData","../../TableReader":"TableReader","../../common/CombatModule":"CombatModule","../../common/EventConst":"EventConst","../../common/NetworkProtocolCommon":"NetworkProtocolCommon","../../common/PlayerModule":"PlayerModule","../../modules/manager/EventManager":"EventManager","../../modules/manager/cheat/SafeNumber":"SafeNumber","../../network/ClientNetwork":"ClientNetwork","../../network/LocalMessage":"LocalMessage","../../network/protocol/FightProtocols":"FightProtocols","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/ConfigUtils":"ConfigUtils","../../utils/ConstValue":"ConstValue","../../utils/Debug":"Debug","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils","../../utils/ResourcesManager":"ResourcesManager","../../utils/Tools":"Tools","../CombatManager":"CombatManager","../logic/AI":"AI","../logic/CarSummon":"CarSummon","./HeroObj":"HeroObj","./NpcObj":"NpcObj"}],CarSkinUtils:[function(e,t,o){"use strict";cc._RF.push(t,"5b1f7Koj25DJplQMCijPnEc","CarSkinUtils"),Object.defineProperty(o,"__esModule",{value:!0}),o.CarLvData=void 0;var i=e("../../common/PlayerModule"),a=e("../../network/protocol/TypeProtocols"),n=e("../../StaticData/CarTalentTableData"),r=e("../../utils/ConfigUtils"),s=e("../../utils/GameUtils"),c=function(){this.level=1,this.needItemNum=1,this.needItemNum_nextLv=1};o.CarLvData=c;var l=function(){function e(){this.default_main="combat/animation/car/che",this.default_enter="animation_car/enter_che2/che",this.default_enter_coop="animation_car/enter_che1/che"}return Object.defineProperty(e,"Instance",{get:function(){return null==e.g_instance&&(e.g_instance=new e),e.g_instance},enumerable:!1,configurable:!0}),e.prototype.getCurrSkinId=function(){var t=i.default.getRoleAttrValByKey(a.ROLE_ATTR_VALUES.ROLE_ATTR_CARSKINID);return t<=0&&(t=e.CAR_DEFAULT_SKIN_ID),t},e.prototype.getLevelById=function(e){var t=s.getItemTotalNumByItemId(e);console.log("CarSkinUtils, getLevelById, id="+e+", itemNum="+t);var o=this.getCarLvByCarItemNum(e,t);return null!=o&&o.level>0?o.level:1},e.prototype.getCarSpineUrl=function(t,o){void 0===o&&(o=-1),o<0?o=this.getCurrSkinId():0==o&&(o=e.CAR_DEFAULT_SKIN_ID);var i=this.getSkinNameById(o),a="";return t==e.TYPE_MAIN?a=o==e.CAR_DEFAULT_SKIN_ID?"combat/animation/car/che":"carSkins/"+i+"/main/che":t==e.TYPE_ENTER?a=o==e.CAR_DEFAULT_SKIN_ID?this.default_enter:"carSkins/"+i+"/enter/che":t==e.TYPE_COOP_ENTER?a=this.default_enter_coop:t==e.TYPE_BOOM&&(a=o==e.CAR_DEFAULT_SKIN_ID?"combat/animation/che/che1_baozha":"carSkins/"+i+"/boom/che1_baozha"),a},e.prototype.getCarTalentTableData=function(e,t){void 0===t&&(t=1),console.log("CarSkinUtil, getCarTalentTableData, carId="+e+", lv="+t);var o=null;return n.CarTalentTableData.getDataMap().forEach(function(i){e==i.CarId&&t==i.level&&(o=i)}),o},e.prototype.getCarNameByPassiveId=function(e){var t="\u6218\u8f66";return n.CarTalentTableData.getDataMap().forEach(function(o){if(o.skillIdList.split(",").indexOf(e.toString())>-1){var i=o.CarId,a=r.default.getInstance().getItemByID(i);a&&(t=a.name)}}),t},e.prototype.getCarLvByCarItemNum=function(t,o){var i=new c;if(t==e.CAR_DEFAULT_SKIN_ID)return i.level=1,i;if(o<=0)return i.level=0,i;if(o<e.SHOW_PROGRESS_LEVEL)return i.level=o,i.needItemNum=o,i.needItemNum_nextLv=o+1,i;var a=parseInt(s.getConfigIntValue("car_skin_level_max"));if(o>=this.getCarTalentTableData(t,a).needCarItemNum)return i.level=a,i.needItemNum=this.getCarTalentTableData(t,a).needCarItemNum,i.needItemNum_nextLv=this.getCarTalentTableData(t,a).needCarItemNum,i;for(var n=1,r=1,l=e.SHOW_PROGRESS_LEVEL;l<=a;l++)if(n=this.getCarTalentTableData(t,l).needCarItemNum,r=l>=a?this.getCarTalentTableData(t,a).needCarItemNum:this.getCarTalentTableData(t,l+1).needCarItemNum,o>=n&&o<r)return i.level=l,i.needItemNum=n,i.needItemNum_nextLv=r,i;return null},e.prototype.getSkinNameById=function(e){return 802==e?"gold":803==e?"flower":804==e?"indian":805==e?"tree":806==e?"sky":807==e?"ice":808==e?"fish":809==e?"ironCar":""},e.prototype.getCarTableDataResIdOffset=function(e){return 802==e?9:803==e?13:804==e?17:805==e?21:806==e?25:807==e?29:808==e?33:809==e?37:0},e.CAR_DEFAULT_SKIN_ID=801,e.CAR_SKIN_ITEMTYPE=11,e.SHOW_PROGRESS_LEVEL=10,e.TYPE_MAIN="main",e.TYPE_ENTER="enter",e.TYPE_COMBAT="combat",e.TYPE_COOP="coop",e.TYPE_COOP_ENTER="coop_enter",e.TYPE_BOOM="boom",e}();o.default=l,cc._RF.pop()},{"../../StaticData/CarTalentTableData":"CarTalentTableData","../../common/PlayerModule":"PlayerModule","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/ConfigUtils":"ConfigUtils","../../utils/GameUtils":"GameUtils"}],CarSummonTableData:[function(e,t,o){"use strict";cc._RF.push(t,"ccb6cQe5aJLL4ohkHJCi3z3","CarSummonTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.CarSummonTableData=o.NPCLIST=void 0;var i=e("../TableReader"),a=function(){function e(){this.npcId=0,this.npcNum=0,this.npcPos=0}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.npcId=e.getNumber(),this.npcNum=e.getNumber(),this.npcPos=e.getNumber()},e}();o.NPCLIST=a;var n=function(){function e(){this.id=0,this.index=0,this.npcList=new Array,this.time=0,this.timeadd=0,this.batchIndex=0,this.offsetX=0,this.offSetY=0,this.endtime=0}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.index=e.getNumber();for(var o=e.getString(),n=new i.TableReader(o);n.getPos()<n.getLen();){var r=new a;r.readOriginal(n),this.npcList.push(r)}this.time=e.getNumber(),this.timeadd=e.getNumber(),this.batchIndex=e.getNumber(),this.offsetX=e.getNumber(),this.offSetY=e.getNumber(),this.endtime=e.getNumber()},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"CarSummonTableData"},e.prototype.isAutoId=function(){return!0},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.CarSummonTableData=n,cc._RF.pop()},{"../TableReader":"TableReader"}],CarSummon:[function(e,t,o){"use strict";cc._RF.push(t,"dd851omvoFNvIXrwzRQdOEM","CarSummon"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../network/FightNetwork"),a=e("../../network/LocalMessage"),n=e("../CombatManager"),r=e("../../utils/ConfigUtils"),s=e("../../utils/ConstValue"),c=e("../../controller/Guide/GuideController"),l=e("../../common/CombatModule"),d=e("../../utils/GamePlatform"),u=e("../../utils/GameUtils"),h=e("../../network/protocol/TypeProtocols"),p=e("../../common/PlayerModule"),f=e("../../common/CommandValue"),g=e("../../common/NetworkProtocolCommon"),m=function(){function e(){this.summonId=0,this.camp=0,this.campParam=0,this.isLastBatch=!1,this.lastTime=0,this.cd=0,this.index=0,this.summonList=[],this.bDelayTime=!1,this.npcId=0,this.delayLoadTime=0,this.nBatchIndex=0}return e.prototype.getSummonId=function(){return this.summonId},e.prototype.unbind=function(){this.summonList=null,i.FightNetwork.getInstance().removeMessageTarget(this)},e.prototype.init=function(e,t,o,n,s,c,l){void 0===n&&(n=0),void 0===s&&(s=0),void 0===c&&(c=0),void 0===l&&(l=0);var d=this;this.summonId=e,this.camp=t,this.campParam=o,this.index=n,this.lastTime=s,this.nBatchIndex=c,this.delayLoadTime=l,this.initNpcStartId();var u=r.default.getInstance().getCarSummonCfg();for(var h in u){var p=u[h];p.id==e&&(d.summonList[p.index]=p)}i.FightNetwork.getInstance().listenLocalMessage(a.LOCAL_MESSAGE.LocalMsg_PvpBossRefresh,function(){d.summonBoss()}.bind(this),this)},e.prototype.checkBatchIndexDistance=function(){var e=0,t=n.default.getInstance().carList;for(var o in t)if(t[o]){var i=t[o].summonList;for(var a in i)if(i[a]&&this.camp!=i[a].camp){e=this.nBatchIndex-i[a].nBatchIndex;break}}return Math.abs(e)>=1},e.prototype.getEnemyLastTime=function(){var e=0,t=n.default.getInstance().carList;for(var o in t)if(t[o]){var i=t[o].summonList;for(var a in i)if(i[a]&&this.camp!=i[a].camp){e=i[a].lastTime;break}}return e},e.prototype.update=function(e){if(c.default.Instance.getGuideStatus()&&c.default.guideIndex<=3)return!1;if(n.default.getInstance().gameState==s.Game_State.Fighting&&1!=this.isLastBatch&&1!=this.bDelayTime){if(this.lastTime<0){var t=!1;if(-1==this.lastTime&&0===this.checkSelfCampNpcDie())t=!0;else if(-2==this.lastTime&&0==this.checkHaveNpcExist()){var o=p.default.checkModulerOnOffState(f.ModulerViewOnOff.checkBatchIndex),i=this.getEnemyLastTime();o&&-2==i?t=!0:(console.log("checkBatchIndexDistance"),0==this.checkBatchIndexDistance()&&(t=!0))}return(!0===t||this.delayLoadTime>this.summonList[this.index].endtime)&&(this.onAllNpcDie(),this.delayLoadTime=0),void(this.delayLoadTime+=1e3*e)}this.cd=this.cd+1e3*e,this.cd>this.lastTime&&this.loadNextBatch()}},e.prototype.checkSelfCampNpcDie=function(){var e=n.default.getInstance().getNpcList(),t=0;for(var o in e){var i=e[o];i&&!i.isDead()&&i.isMonster()&&i.camp===this.camp&&(t+=1)}return t},e.prototype.checkEnemyCampNpcCount=function(){var e=n.default.getInstance().getNpcList(),t=0;for(var o in e){var i=e[o];i&&!i.isDead()&&i.isMonster()&&i.camp===this.camp&&(t+=1)}return t},e.prototype.checkHaveNpcExist=function(){var e=n.default.getInstance().getNpcList(),t=0;for(var o in e){var i=e[o];i&&!i.isDead()&&i.isNpc()&&!i.isSummoned()&&(t+=1)}return t},e.prototype.delayTime=function(){this.bDelayTime=!0;var e=this;n.default.getInstance().getController().scheduleOnce(function(){e.loadNextBatch(),e.bDelayTime=!1,e.cd=0,e.delayLoadTime=0},-1==this.lastTime?.1:1)},e.prototype.onAllNpcDie=function(){d.GamePlatform.isWechat()?wx.triggerGC():d.GamePlatform.isQQMiniGame()&&qq.triggerGC(),this.lastTime<0&&(this.delayTime(),this.nBatchIndex)},e.prototype.genId=function(){return this.npcId=this.npcId+1,this.npcId},e.prototype.initNpcStartId=function(){var e=u.getRoleIdentity(this.camp);this.npcId=1e4*this.nBatchIndex+1e3*e+this.index},e.prototype.loadNextBatch=function(){if(n.default.getInstance().gameState==s.Game_State.Fighting&&null!=this.summonList)if(this.summonList.length<=this.index)this.isLastBatch=!0;else{this.index=this.index+1,this.cd=0;var e=this.summonList[this.index];if(e){this.nBatchIndex!=e.batchIndex&&(this.camp==s.PLAYER_CAMP.myPlayer||l.default.matchType==h.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE&&this.camp==s.PLAYER_CAMP.coopPlayer)&&n.default.getInstance().reqFightResult(!1,!0),this.nBatchIndex=e.batchIndex,this.initNpcStartId();var t=r.default.getInstance().getStarParam(e.batchIndex),o=.01*t.starParam_att,i=.01*t.starParam_hp,a=e.npcList.split("|");for(var c in a){var d=a[c].split("#");if(3==d.length)for(var u=parseInt(d[0]),p=parseInt(d[1]),f=parseInt(d[2]),g=e.offsetX,m=0;m<p;m++)n.default.getInstance().summon(u,1,this.camp,g,f,!1,o,i,this.genId()),f+=50,g+=50*this.campParam}this.lastTime=e.time,this.checkEnemyCampNpcCount()<=6&&(this.lastTime=e.timeadd),this.lastTime<0&&this.resetCarTmpHp()}else this.isLastBatch=!0}},e.prototype.summonBoss=function(){var e=Number(u.getConfigIntValue("pvp_boss_id")),t=Number(u.getConfigIntValue("pvp_boss_star"));if(l.default.matchType==h.FIGHT_TYPE.FIGHT_TYPE_BATTLE_EAT_CHICKEN&&(e=Number(u.getConfigIntValue("pvp_boss_id_eatchicken")),t=Number(u.getConfigIntValue("pvp_boss_star_eatchicken"))),e&&t){g.default.callRoleClientLog("summonBoss");var o,i=r.default.getInstance().getStarParam(t),a=.01*i.starParam_att,c=.01*i.starParam_hp,d=9990001+1e3*u.getRoleIdentity(this.camp);o=this.camp==s.PLAYER_CAMP.myPlayer||n.default.getInstance().isCoop()&&l.default.matchType==h.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE&&u.getRoleIdentity(this.camp)==s.PLAYER_IDENTITY.away?175:-175,n.default.getInstance().summon(e,1,this.camp,o,0,!1,a,c,d)}},e.prototype.resetCarTmpHp=function(){var e=n.default.getInstance().getCarByCamp(this.camp);e&&(e.carTmpHp=e.hp)},e}();o.default=m,cc._RF.pop()},{"../../common/CombatModule":"CombatModule","../../common/CommandValue":"CommandValue","../../common/NetworkProtocolCommon":"NetworkProtocolCommon","../../common/PlayerModule":"PlayerModule","../../controller/Guide/GuideController":"GuideController","../../network/FightNetwork":"FightNetwork","../../network/LocalMessage":"LocalMessage","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/ConfigUtils":"ConfigUtils","../../utils/ConstValue":"ConstValue","../../utils/GamePlatform":"GamePlatform","../../utils/GameUtils":"GameUtils","../CombatManager":"CombatManager"}],CarTalentTableData:[function(e,t,o){"use strict";cc._RF.push(t,"c154cygjcxPwKvo2NXMygA8","CarTalentTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.CarTalentTableData=void 0;var i=e("../TableReader"),a=function(){function e(){this.id=0,this.CarId=0,this.level=0,this.describe="",this.skillIdList="",this.EffectType="",this.needCarItemNum=0,this.extraParam="",this.extraParam2="",this.extraParam3=""}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.CarId=e.getNumber(),this.level=e.getNumber(),this.describe=e.getString(),this.skillIdList=e.getString(),this.EffectType=e.getString(),this.needCarItemNum=e.getNumber(),this.extraParam=e.getString(),this.extraParam2=e.getString(),this.extraParam3=e.getString()},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"CarTalentTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.CarTalentTableData=a,cc._RF.pop()},{"../TableReader":"TableReader"}],CardItemView:[function(e,t){"use strict";cc._RF.push(t,"0eeb3pfp6dHzafucoRJ7SoQ","CardItemView");var o=y(e("../combat/CombatManager")),i=y(e("../utils/ConfigUtils")),a=y(e("../utils/Tools")),n=y(e("../modules/base/GameView")),r=y(e("../common/PlayerModule")),s=y(e("../controller/Guide/GuideController")),c=e("../Global/GameGlobal"),l=e("../network/protocol/TypeProtocols"),d=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=_();if(t&&t.has(e))return t.get(e);var o={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var n=i?Object.getOwnPropertyDescriptor(e,a):null;n&&(n.get||n.set)?Object.defineProperty(o,a,n):o[a]=e[a]}return o.default=e,t&&t.set(e,o),o}(e("../common/CombatModule")),u=e("../network/protocol/FightProtocols"),h=e("../network/FightNetwork"),p=e("../utils/ConstValue"),f=e("../modules/manager/cheat/SafeNumber"),g=y(e("./heroCardBag/HeroSkinUtils")),m=e("../StaticData/HeroSkinTableData");function _(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return _=function(){return e},e}function y(e){return e&&e.__esModule?e:{default:e}}cc.Class({extends:cc.Component,properties:{constNum:cc.Label,heroImage:cc.Sprite,heroBg:cc.Sprite,heroEff:cc.Node,heroStrokeEff:cc.Node,recommendSprite:cc.Node,id:{visible:!1,get:function(){return this._id.value},set:function(e){this._id.value=e}}},onLoad:function(){this._id=new f.SafeNumber(0),this.touchFlag=!1,this.touchStartTime=null,this.bClicked=new f.SafeNumber(0),this.node.on(cc.Node.EventType.TOUCH_START,function(){this.touchFlag=!0,this.touchStartTime=new Date},this),this.node.on(cc.Node.EventType.TOUCH_END,function(){this.touchFlag=!1,this.touchStartTime=null;var e=n.default.getViewByName("BattleCardInfo");if(e&&e.view)return!0;this.onClickCard()},this)},touchHold:function(){this.touchFlag&&null!=this.touchStartTime&&(new Date).getTime()-this.touchStartTime.getTime()>300&&(this.touchFlag=!1,this.id&&!s.default._Instance.getGuideStatus()&&n.default.addPopView("BaseCtrl","BattleCardInfo","BattleCardInfo",{nHeroId:this.id,camp:p.PLAYER_CAMP.myPlayer,longTouchpre:!0}))},setId:function(e,t,o,n,r,s){if(this.id=o,this.game=e,this.playerCombatModel=t,this.controller=r,n){this.node.scale=1.5,cc.tween(this.node).to(.2,{scale:1}).start(),this.heroEff.active=!0,this.spineNode=this.heroEff.getComponent(sp.Skeleton),this.spineNode.setAnimation(0,"idle",!1),this.heroStrokeEff.active=!0,this.strokeSpineNode=this.heroStrokeEff.getComponent(sp.Skeleton);var c=this.strokeSpineNode.setAnimation(0,"idle",s),l=this;c&&this.strokeSpineNode.setCompleteListener(function(){l.heroStrokeEff.active=s}),a.default.playBtnAudioMusic("combat/audio/effect/cardrefresh",!1,1),2==i.default.getInstance().getHeroConfig(this.id).hero_type&&(this.heroStrokeEff.active=!1)}else this.heroEff.active=!1,this.node.scale=1;var d=i.default.getInstance().getHeroConfig(this.id);if(d){var u="ui/cardpic/"+d.image,h=g.default.Instance.getCurSkinIdByHeroUUID(null,this.id);if(h>0){var p=m.HeroSkinTableData.getById(h),f=i.default.getInstance().data["StaticData/ItemTableData"][p.itemId];u=String(f.icon).replace("cardpic_l","cardpic")}this.constNum.string="";var _=this;cc.resources.load(u,cc.SpriteFrame,function(e,t){_._replaceSpriteFrame=t,_.heroImage.spriteFrame=_._replaceSpriteFrame})}this.onShowRecommend()},setGameModel:function(e){this._gameModel=e},brodcastSpiritEvent:function(){this.onCheckCardIsSpirit()&&cc.director.emit("Event_SummonSpirit",this.id,p.PLAYER_CAMP.myPlayer)},onClickCard:function(){var e=this;if(o.default.getInstance().gameState!=p.Game_State.Reconnect){if(1!=this.bClicked.value){this.bClicked.value=1;var t=o.default.getInstance().getSelfCombatModel().reqHeroLevelUp(this.id);if(1==t){var i=o.default.getInstance().getSelfCombatModel().nHeroLvUpAdditionParam;i?(o.default.getInstance().getSelfCombatModel().sendHeroLvUpToServer(this.id,i,0,0),o.default.getInstance().getSelfCombatModel().nHeroLvUpAdditionParam=null):o.default.getInstance().getSelfCombatModel().sendHeroLvUpToServer(this.id,0,0,0),this.sendCardClearToServer(),this.removeSelf(!0,function(){e.brodcastSpiritEvent()}),this.game.refColor()}else-4==t?(this.sendCardClearToServer(),this.removeSelf(!0,function(){e.brodcastSpiritEvent()}),this.game.refColor(),this.id!=p.Enum_Elf_Card.guangElf&&this.id!=p.Enum_Elf_Card.anElf&&this.id!=p.Enum_Elf_Card.tuElf||o.default.getInstance().getSelfCombatModel().sendHeroLvUpToServer(this.id,0,1,0)):-5==t?(this.sendCardClearToServer(),this.removeSelf(!0,function(){}),this.game.refColor(),this.onCheckCardIsSpirit()&&o.default.getInstance().getSelfCombatModel().sendHeroLvUpToServer(this.id+p.Enum_Elf_Card.fireworkElf,0,0,0)):-2==t?(c.G.StringManager.PopString(c.G.StringManager.getString("CAR_NOT_POS")),this.bClicked.value=0):-1==t?this.removeSelf(!0,function(){}):-6==t?(c.G.StringManager.PopString(c.G.StringManager.getString("EGINEER_POS_BEUSED")),this.bClicked.value=0):this.bClicked.value=0}}else c.G.StringManager.PopStringOnce(c.G.StringManager.getString("RECONNECT_RESUME"))},onCheckCardIsUsed:function(e){return 1==e||-4==e},onCheckCardIsSpirit:function(){return 2==i.default.getInstance().getHeroConfig(this.id).hero_type},refColor:function(){var e=i.default.getInstance().getHeroConfig(this.id);if(e){var t=o.default.getInstance().getSelfCombatModel().getHeroLevel(this.id),a=e.starSellPrice.split("|")[t];this.playerCombatModel.getCurMoney()<a?(this.constNum.node.color=cc.Color.RED,this.constNum.string=a):(this.constNum.node.color=cc.Color.WHITE,this.constNum.string=a)}},stopAction:function(e,t){e==this.id&&(this.heroEff.active=!t)},update:function(){this.touchFlag&&this.touchHold()},removeSelf:function(e,t){var o=this;e?cc.tween(this.node).to(.1,{scale:1.5}).to(.1,{scale:0},{easing:"fade"}).call(function(){o.node.active=!1,t&&t.call(o)}).start():(this.bClicked.value=1,cc.tween(this.node).to(.2,{scale:0},{easing:"fade"}).call(function(){o.node.active=!1}).start())},onShowRecommend:function(){if(!(o.default.getInstance().isCoop()||r.default.getRoleAttrValByKey(l.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE)>500)){var e=function(e){var t=o.default.getInstance().getSelfCar();for(var a in t.heroList){var n=t.heroList[a];if(n){var r=i.default.getInstance().getHeroConfig(n.heroTemplateId);if(r.relationNum>0)for(var s=r.relationHeroId.split("|"),c=0;c<s.length;c++)if(Number(s[c])==e)return n}}return null}.call(this,this.id);if(e){var t=i.default.getInstance().getHeroConfig(e.heroTemplateId);(function(e){for(var t=0,i=o.default.getInstance().getSelfCar(),a=e.split("|"),n=0;n<a.length;n++)for(var r in i.heroList){var s=i.heroList[r];if(s&&s.heroTemplateId==Number(a[n])){t++;break}}return t}).call(this,t.relationHeroId)>=t.relationNum||1!=function(e){var t=o.default.getInstance().getSelfCar();for(var i in t.heroList){var a=t.heroList[i];if(a&&a.heroTemplateId==e)return!0}return!1}.call(this,this.id)&&(this.recommendSprite.active=!0)}}},cancelClickEvent:function(){this.node.hasEventListener(cc.Node.EventType.TOUCH_START)&&this.node.off(cc.Node.EventType.TOUCH_START),this.node.hasEventListener(cc.Node.EventType.TOUCH_MOVE)&&this.node.off(cc.Node.EventType.TOUCH_MOVE),this.node.hasEventListener(cc.Node.EventType.TOUCH_END)&&this.node.off(cc.Node.EventType.TOUCH_END),this.node.hasEventListener(cc.Node.EventType.TOUCH_CANCEL)&&this.node.off(cc.Node.EventType.TOUCH_CANCEL)},sendCardClearToServer:function(){if(d.default.getCombatType()!=d.CombatType.PVE){var e=new u.C_Fight_Refresh_Card_Count_SYNC;e.roleID=r.default.UUID,e.refreshNum=o.default.getInstance().getSelfCombatModel().getCarRefreshCount()-1,e.cardIdVec=[],o.default.getInstance().getSelfCombatModel().setCardIdVec(e.cardIdVec),h.FightNetwork.getInstance().Send(u.FIGHT_CLIENT_ENUM.P_Fight_Refresh_Card_Count_SYNC,e)}}}),cc._RF.pop()},{"../Global/GameGlobal":"GameGlobal","../StaticData/HeroSkinTableData":"HeroSkinTableData","../combat/CombatManager":"CombatManager","../common/CombatModule":"CombatModule","../common/PlayerModule":"PlayerModule","../controller/Guide/GuideController":"GuideController","../modules/base/GameView":"GameView","../modules/manager/cheat/SafeNumber":"SafeNumber","../network/FightNetwork":"FightNetwork","../network/protocol/FightProtocols":"FightProtocols","../network/protocol/TypeProtocols":"TypeProtocols","../utils/ConfigUtils":"ConfigUtils","../utils/ConstValue":"ConstValue","../utils/Tools":"Tools","./heroCardBag/HeroSkinUtils":"HeroSkinUtils"}],CardModel:[function(e,t,o){"use strict";cc._RF.push(t,"07571/Fv7VKC7axt031nV1z","CardModel"),o.__esModule=!0,o.default=void 0;var i,a=(i=e("../utils/ConfigUtils"))&&i.__esModule?i:{default:i},n=e("../utils/ConstValue"),r=function(){function e(){this.templateId=0,this.level=0,this.num=0,this.isFightCard=!1,this.attrInfo=[0,0,0,0,0],this.isCarHp=0,this.upRes=0,this.bLocked=0}var t=e.prototype;return t.init=function(e,t,o,i){if(a.default.getInstance().getHeroConfig(e)){var r=a.default.getInstance().getHeroConfig(e).npc_id,s=a.default.getInstance().getNpcTemplateConfig(r,t);this.templateId=e,this.level=t,this.num=o,this.isFightCard=i;var c=s.skill_id,l=n.cardProfDesc;return this.attrInfo[0]=s.attack,this.attrInfo[1]=l[a.default.getInstance().getHeroConfig(e).occupation],this.attrInfo[2]=a.default.getInstance().getSkillConfig(c).cd/1e3+"\u79d2/\u6b21",this.attrInfo[3]=a.default.getInstance().getHeroConfig(e).up_res,this.upRes=s.up_res,this.bLocked=a.default.getInstance().getHeroConfig(this.templateId).unrock,this.hero_color=a.default.getInstance().getHeroConfig(e).hero_color,!0}return!1},t.syncCardInfo=function(e,t,o){this.level=e,this.num=t,this.isFightCard=o;var i=a.default.getInstance().getHeroConfig(this.templateId).npc_id,r=a.default.getInstance().getNpcTemplateConfig(i,e),s=a.default.getInstance().getHeroConfig(this.templateId);this.templateId=i;var c=r.skill_id,l=n.cardProfDesc;this.attrInfo[0]=r.attack,this.attrInfo[1]=l[s.prof-1],this.attrInfo[2]=a.default.getInstance().getSkillConfig(c).cd/1e3+"\u79d2/\u6b21",this.attrInfo[3]=s.up_res,this.upRes=r.up_res,this.bLocked=a.default.getInstance().getHeroConfig(this.templateId).unrock},t.setIsFightCard=function(e){this.isFightCard=e},t.addLevel=function(){this.level=this.level+1},t.getLevel=function(){return this.level},t.getIsFightCard=function(){return this.isFightCard},e}();o.default=r,t.exports=o.default,cc._RF.pop()},{"../utils/ConfigUtils":"ConfigUtils","../utils/ConstValue":"ConstValue"}],CardUpgrade:[function(e,t,o){"use strict";cc._RF.push(t,"bb17eG5w6xKwbUZ9c2GMHRe","CardUpgrade");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../utils/ConfigUtils"),s=e("../../common/PlayerModule"),c=e("../../utils/ResourcesManager"),l=e("../../modules/base/BaseView"),d=e("../../modules/base/Decorators"),u=e("../../StaticData/SoundTableData"),h=e("../../utils/Tools"),p=e("./HeroSkinUtils"),f=cc._decorator,g=f.ccclass,m=f.property,_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.upgradeTalentNode=null,t.unlockTalentNode=null,t.id=0,t}return a(t,e),t.path=function(){return"ui/heroCardBag/prefab/card_succeed"},t.prototype.start=function(){var e=u.SoundTableData.getById(4).res;h.playAudioEffect(e)},t.prototype.init=function(e){var t=this,o=s.default.getHeroCarData();this.id=e.id;var i=r.default.getInstance().getHeroConfig(this.id);this.node.getChildByName("name").getComponent(cc.Label).string=i.name;var a=o[this.id].heroLevel,n=r.default.getInstance().getHeroConfig(this.id).npc_id,l=r.default.getInstance().getNpcTemplateConfig(n,a),d=l.up_res.split("|")[0].split("#"),u=s.default.getItemCountByBag(Number(d[0])),h=Number(d[1]);this.node.getChildByName("level_bg").getChildByName("level").getComponent(cc.Label).string=a;var f=this.node.getChildByName("ProfNode");c.default.loadSprite("ui/bag/img/prof"+i.hero_color,f.getComponent(cc.Sprite),function(e){e.addRef()}),c.default.loadSprite("ui/bag/img/"+["zhanshi","lieshou","fashi","mushi","zhaohuan","jingling","xiongmao","gongcheng","renzhe"][i.occupation-1],f.getChildByName("ProSprite").getComponent(cc.Sprite),function(e){e.addRef()}),c.default.loadSprite("ui/bag/img/bar"+i.hero_color,this.node.getChildByName("pro_bar").getChildByName("bar").getComponent(cc.Sprite),function(e){e.addRef()}),c.default.loadSprite("ui/bag/img/"+i.hero_color+"b",this.node.getChildByName("level_bg").getComponent(cc.Sprite),function(e){e.addRef()});var g=l.res_id,m=p.default.Instance.getCurSkinIdByHeroUUID(null,this.id);if(m>0){var _=p.default.Instance.getNpcTemplateId(this.id,m);g=r.default.getInstance().getNpcTemplateConfig(_,a).res_id}var y=r.default.getInstance().getResConfig(g).uiScale;c.default.loadSpine(r.default.getInstance().getResConfig(g).animation,function(e){if(!cc.isValid(t.node))return e.destroy();e.parent=t.node.getChildByName("hero"),e.scale=e.scale*(y-10)/100,e.getComponent(sp.Skeleton).setAnimation(0,"idle",!0)});var v=this.node.getChildByName("pro_bar").getComponent(cc.ProgressBar),C=this.node.getChildByName("number").getComponent(cc.Label);v.progress=u/h,C.string=u+"/"+h;var S=r.default.getInstance().getNpcTemplateConfig(n,a-1);if(S){var T=this.node.getChildByName("hp").getChildByName("hp_old"),I=this.node.getChildByName("hp").getChildByName("hp_add"),N=l.carhp-S.carhp;T.getComponent(cc.Label).string=S.carhp+"",I.getComponent(cc.Label).string="+  "+N;var b=this.node.getChildByName("attack").getChildByName("attack_old"),w=this.node.getChildByName("attack").getChildByName("attack_add");b.getComponent(cc.Label).string=S.attack,w.getComponent(cc.Label).string="+  "+(l.attack-S.attack)}for(var E=r.default.getInstance().getHeroTalentTableDataCfg(),P=[],R=0,L=Object.keys(E);R<L.length;R++){var A=L[R];E.hasOwnProperty(A)&&E[A].heroId==this.id&&P.push(E[A])}var D=!1,M=null,B=null;P.forEach(function(e,t){a>=e.level&&(a==e.level&&(D=!0),M=e,P[t+1]&&(B=P[t+1]))});var k="",G=null;if(D)k="ui/bag/img/"+i.hero_color+"b",this.unlockTalentNode.active=!0,G=this.unlockTalentNode,this.unlockTalentNode.getChildByName("lvup_Desc").getComponent(cc.RichText).string="<outline color=black width=2> <color=#F5E6AB>"+M.name+"\uff1a</c><color=#22FF29>"+M.describe+"</color>",G.getChildByName("levelbg").getChildByName("Hero_level").getComponent(cc.Label).string=M.level;else{if(M&&!B)return;M||B||(B=P[0]),G=this.upgradeTalentNode,this.upgradeTalentNode.active=!0,k="ui/bag/img/0b",this.upgradeTalentNode.getChildByName("lvup_Desc").getComponent(cc.RichText).string="<outline color=black width=2> <color=#F5E6AB>"+B.name+"\uff1a</c><color=#FFFFFF>"+B.describe+"</color>",G.getChildByName("levelbg").getChildByName("Hero_level").getComponent(cc.Label).string=B.level}c.default.loadSprite(k,G.getChildByName("levelbg").getComponent(cc.Sprite),function(e){e.addRef()}),this.node.on(cc.Node.EventType.TOUCH_END,function(){t.closeView()})},n([m(cc.Node)],t.prototype,"upgradeTalentNode",void 0),n([m(cc.Node)],t.prototype,"unlockTalentNode",void 0),n([d.Register_Class,g],t)}(l.default);o.default=_,cc._RF.pop()},{"../../StaticData/SoundTableData":"SoundTableData","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../utils/ConfigUtils":"ConfigUtils","../../utils/ResourcesManager":"ResourcesManager","../../utils/Tools":"Tools","./HeroSkinUtils":"HeroSkinUtils"}],CardView:[function(e,t,o){"use strict";cc._RF.push(t,"a532eMD/CRMs7nKYOTcnEYg","CardView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../utils/GameUtils"),s=e("../../utils/ConfigUtils"),c=e("../../common/PlayerModule"),l=e("../../Global/GameGlobal"),d=e("../../utils/ResourcesManager"),u=e("../../network/ClientNetwork"),h=e("../../modules/base/GameView"),p=e("../../network/protocol/RoleProtocols"),f=e("../../common/CommandValue"),g=e("../../utils/GamePlatform"),m=e("../../StaticData/ProficiencyTableData"),_=e("../../utils/GameUtils"),y=e("./HeroSkinUtils"),v=e("../../StaticData/HeroSkinTableData"),C=e("../../network/LocalMessage"),S=cc._decorator.ccclass,T=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._heroId=0,t._playAct=!1,t._index=0,t}return a(t,e),t.prototype.start=function(){},t.prototype.init=function(e,t,o){var i=this;this._heroId=e,this._carBagView=t,this._playAct=!1,this._index=o,this.refreshHeroCardInfo(),this.node.on(cc.Node.EventType.TOUCH_END,this.onClickEvent,this),u.ClientNetwork.getInstance().listenLocalMessage(C.LOCAL_MESSAGE.LocalMsg_RefreshRedDot_heroSkin,function(){i.freshRedpoint()},this)},t.prototype.refreshHeroCardInfo=function(){var e=this,t=null;if(c.default.getHeroCarData().forEach(function(o){o.heroId==e._heroId&&(t=o)}),t){var o=s.default.getInstance().getHeroConfig(t.heroId),i="ui/cardpic_l/"+o.image;if(null!=t.heroUUId){var a=y.default.Instance.getCurSkinIdByHeroUUID(t.heroUUId,t.heroId);if(a>0){var n=v.HeroSkinTableData.getById(a),l=s.default.getInstance().data["StaticData/ItemTableData"][n.itemId];i=l.icon}}var u=this.node.getChildByName("hero");r.setTexture(u.getComponent(cc.Sprite),i,function(){d.default.pushReleaseAssets(0,{path:""+i,resType:cc.SpriteFrame})});var h=this.node.getChildByName("bg");r.setTexture(h.getComponent(cc.Sprite),"ui/bag/img/"+o.hero_color),r.setTexture(this.node.getChildByName("name").getComponent(cc.Sprite),"ui/heroName/"+o.nameIcon);var p=this.node.getChildByName("lock");p.active=!1;var f=this.node.getChildByName("unlock");f.active=!1;var g=this.node.getChildByName("ProfNode");if(d.default.loadSprite("ui/bag/img/prof"+o.hero_color,g.getComponent(cc.Sprite),function(e){e.addRef()}),d.default.loadSprite("ui/bag/img/"+["zhanshi","lieshou","fashi","mushi","zhaohuan","jingling","xiongmao","gongcheng","renzhe"][o.occupation-1],g.getChildByName("ProSprite").getComponent(cc.Sprite),function(e){e.addRef()}),0==t.bHeroLock)p.active=!0,this.node.getChildByName("redpoint").active=!1;else{f.active=!0,this.node.getChildByName("level").getComponent(cc.Label).string=t.heroLevel,d.default.loadSprite("ui/bag/img/"+o.hero_color+"b",f.getChildByName("level_bg").getComponent(cc.Sprite),function(e){e.addRef()});var m=s.default.getInstance().getNpcTemplateConfig(o.npc_id,t.heroLevel).up_res.split("|")[0].split("#"),_=c.default.getItemCountByBag(Number(m[0])),C=Number(m[1]),S=f.getChildByName("pro_bar").getComponent(cc.ProgressBar),T=this.node.getChildByName("number").getComponent(cc.Label);S.progress=_/C,T.string=_+"/"+C;var I=f.getChildByName("lvup");if(I.stopAllActions(),I.y=-108,S.progress>=1){d.default.loadSprite("ui/bag/img/lvup"+o.hero_color,I.getComponent(cc.Sprite),function(e){e.addRef()}),I.active=!0;var N=cc.moveBy(.5,cc.v2(0,10)),b=cc.moveBy(.5,cc.v2(0,-10));I.runAction(cc.sequence(N,b).repeatForever())}else I.active=!1;r.setTexture(f.getChildByName("pro_bar").getChildByName("bar").getComponent(cc.Sprite),"ui/bag/img/bar"+o.hero_color),this.node.getChildByName("redpoint").active=this.checkRedpoint(this._heroId)}!0===this._playAct?this.onPlayExchangeAct():(this.node.getComponent(cc.Animation).stop(),this.node.angle=0,this._playAct=!1)}},t.prototype.onPlayExchangeAct=function(){this.node.getComponent(cc.Animation).play(),this._playAct=!0},t.prototype.onClickEvent=function(){var e=this;if(!0===this._playAct){var t=c.default.getBattleHeroCarData(c.default.fightHeroArrayIndex),o=0;if(t.forEach(function(t){t.heroId==e._carBagView._changeHeroId&&(o=1)}),1===o)return l.G.StringManager.PopString(s.default.getInstance().getStringValueCfg(8).string_value);var i=0,a=c.default.getHeroCarData();a[this._carBagView._changeHeroId]&&(i=a[this._carBagView._changeHeroId].heroUUId);var n=new p.C_Role_BattleArrayUp;return n.arrayID=c.default.fightHeroArrayIndex+1,n.arrayIndex=this._index,n.itemUUID=i,void u.ClientNetwork.getInstance().Send(p.ROLE_CLIENT_ENUM.P_Role_BattleArrayUp,n)}h.default.addPopView("BaseCtrl","HeroCardInfoView","HeroCardInfoView",{cardBag:this._carBagView,id:this._heroId})},t.prototype.freshRedpoint=function(){this.node.getChildByName("redpoint").active=this.checkRedpoint(this._heroId)},t.prototype.checkRedpoint=function(e){var t=this.checkIsShare(e),o=y.default.Instance.getHeroSkinRedPointBy(!1,this._heroId);return t||o},t.prototype.checkIsShare=function(e){if(0==c.default.checkModulerOnOffState(f.ModulerViewOnOff.ProficiencyShare))return!1;if(g.GamePlatform.isWechat()){var t=c.default.getHeroProficiencyDataById(e);if(t){var o=0;if(m.ProficiencyTableData.getDataMap().forEach(function(e){t.proficiency>=e.minProficiency&&t.proficiency<=e.maxProficiency&&(o=e.id)}),o>=Number(_.getConfigIntValue("proficiency_share_level_num")))return 1!=t.shareData.has(o)||1!=t.shareData.get(o)}}return!1},t.prototype.onDestroy=function(){this.node.off(cc.Node.EventType.TOUCH_END,this.onClickEvent,this)},n([S],t)}(cc.Component);o.default=T,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/HeroSkinTableData":"HeroSkinTableData","../../StaticData/ProficiencyTableData":"ProficiencyTableData","../../common/CommandValue":"CommandValue","../../common/PlayerModule":"PlayerModule","../../modules/base/GameView":"GameView","../../network/ClientNetwork":"ClientNetwork","../../network/LocalMessage":"LocalMessage","../../network/protocol/RoleProtocols":"RoleProtocols","../../utils/ConfigUtils":"ConfigUtils","../../utils/GamePlatform":"GamePlatform","../../utils/GameUtils":"GameUtils","../../utils/ResourcesManager":"ResourcesManager","./HeroSkinUtils":"HeroSkinUtils"}],CastleSkyBoxTableData:[function(e,t,o){"use strict";cc._RF.push(t,"b19b2RbdX1Gqrpj5lcGJnGb","CastleSkyBoxTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.CastleSkyBoxTableData=void 0;var i=e("../TableReader"),a=e("./BaseTableData"),n=function(){function e(){this.id=0,this.coinNum=0,this.itemName="",this.itemIcon="",this.itemScale=0,this.extraItemName="",this.extraItemIcon="",this.extraItemScale=0,this.prize=new Array,this.extraPrize=new Array,this.pointX=0}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.coinNum=e.getNumber(),this.itemName=e.getString(),this.itemIcon=e.getString(),this.itemScale=e.getNumber(),this.extraItemName=e.getString(),this.extraItemIcon=e.getString(),this.extraItemScale=e.getNumber();for(var o=e.getString(),n=new i.TableReader(o);n.getPos()<n.getLen();)(s=new a.ItemInfo).readOriginal(n),this.prize.push(s);o=e.getString();for(var r=new i.TableReader(o);r.getPos()<r.getLen();){var s;(s=new a.ItemInfo).readOriginal(r),this.extraPrize.push(s)}this.pointX=e.getNumber()},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"CastleSkyBoxTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.CastleSkyBoxTableData=n,cc._RF.pop()},{"../TableReader":"TableReader","./BaseTableData":"BaseTableData"}],ChangeCarSkinView:[function(e,t,o){"use strict";cc._RF.push(t,"a59dd9vGItJ+4C/07niG05s","ChangeCarSkinView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../common/PlayerModule"),s=e("../../Global/GameGlobal"),c=e("../../modules/base/BaseView"),l=e("../../modules/base/Decorators"),d=e("../../modules/base/GameView"),u=e("../../modules/manager/LoadResManager"),h=e("../../network/ClientNetwork"),p=e("../../network/LocalMessage"),f=e("../../network/protocol/RoleProtocols"),g=e("../../network/protocol/TypeProtocols"),m=e("../../utils/ConfigUtils"),_=e("../../utils/GameTools"),y=e("../../utils/GameUtils"),v=e("../../utils/LogUtil"),C=e("../../utils/ResourcesManager"),S=e("./CarSkinUtils"),T=cc._decorator,I=T.ccclass,N=T.property,b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.scroll=null,t.listItemPrefab=null,t.scroll2=null,t.listItemPrefab2=null,t.viewNode=null,t.txt_name=null,t.txt_effect=null,t.carSpineNode=null,t.carBg=null,t.levelNode=null,t.m_currentItemNode=null,t.m_currentCarId=0,t.m_tipBtn=null,t.m_tipPanel=null,t}return a(t,e),t.path=function(){return"ui/mainScene/ChangeCarSkin"},t.prototype.onLoad=function(){console.log("\u5f53\u524d\u6218\u8f66\u76ae\u80a4id="+r.default.getRoleAttrValByKey(g.ROLE_ATTR_VALUES.ROLE_ATTR_CARSKINID))},t.prototype.start=function(){var t=this;h.ClientNetwork.getInstance().listenProtocol(f.ROLE_CLIENT_ENUM.P_Role_Car_Skin_Change,function(o){o.resetPos();var i=new f.S_Role_Car_Skin_Change;i.read(o)&&0==i.errorcode&&(h.ClientNetwork.getInstance().pushLocalMessage(p.LOCAL_MESSAGE.LocalMsg_Fresh_Car_Skin),e.prototype.closeView.call(t))},this),this.initList2(),r.default.setCarSkinRed(!1),h.ClientNetwork.getInstance().pushLocalMessage(p.LOCAL_MESSAGE.LocalMsg_RefreshRedDot_carSkin),this.m_tipBtn=this.node.getChildByName("TipsButton"),this.m_tipPanel=this.node.getChildByName("tips"),this.m_tipPanel.active=!1,this.m_tipBtn.on(cc.Node.EventType.TOUCH_END,function(){t.m_tipPanel.active=!0}),this.m_tipPanel.getChildByName("clickNode").on(cc.Node.EventType.TOUCH_END,function(){t.m_tipPanel.active=!1})},t.prototype.initList2=function(){var e=this;this.scroll2.content.removeAllChildren();var t=[],o=m.default.getInstance().data["StaticData/ItemTableData"];for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&o[i].type===S.default.CAR_SKIN_ITEMTYPE&&t.push(o[i]);var a=[];r.default.getRoleBagItems().forEach(function(e){null!=e&&m.default.getInstance().getItemByID(e.itemId).type===S.default.CAR_SKIN_ITEMTYPE&&a.push(e)});var n=function(e){var t=null;return a.forEach(function(o){o.itemId===e&&(t=o)}),t};t.forEach(function(t){var o=n.call(e,t.id);o?(t.bHave=1,t.itemUUID=o.itemUUID):t.bHave=0}),t.forEach(function(t){var o=e.createMapItemNode2(t);o.parent=e.scroll2.content;var i=S.default.Instance.getCurrSkinId();t.id==i&&(e.m_currentCarId=i,e.selectListItem(o),e.changeSkinTo2(i))})},t.prototype.createMapItemNode2=function(e){var t=this,o=cc.instantiate(this.listItemPrefab2);o.active=!0,o.getChildByName("check").active=!1,o.id=e.id;var i="carSkins/item_"+e.id;return u.default.loadSpriteFrame(i).then(function(t){o.getComponent(cc.Sprite).spriteFrame=t,1==e.bHave||e.id==S.default.CAR_DEFAULT_SKIN_ID?(S.default.Instance.getCurrSkinId(),e.id):_.default.setNodeBright(o,!1)}).catch(function(e){v.default.info(e)}),o.on(cc.Node.EventType.TOUCH_END,function(e){t.m_currentCarId=e.target.id,console.log("\u70b9\u51fb\u4e86\u6218\u8f66\u56fe\u6807\uff0cid="+t.m_currentCarId),t.changeSkinTo2(t.m_currentCarId),t.selectListItem(e.target)}),o},t.prototype.selectListItem=function(e){this.m_currentItemNode&&(this.m_currentItemNode.getChildByName("check").active=!1),this.m_currentItemNode=e,this.m_currentItemNode.getChildByName("check").active=!0},t.prototype.showLvProgress=function(e){var t=y.getItemTotalNumByItemId(e);if(e==S.default.CAR_DEFAULT_SKIN_ID||t<S.default.SHOW_PROGRESS_LEVEL)this.levelNode.active=!1;else{var o=S.default.Instance.getCarLvByCarItemNum(e,t);if(null==o)return this.levelNode.active=!1,void console.log("ChangeCarSkinView, showLvProgress, carLvData == null");this.levelNode.active=!0,this.levelNode.getChildByName("levelbg").getChildByName("txt_level").getComponent(cc.Label).string=o.level+"",this.levelNode.getChildByName("ProgressBar").getComponent(cc.ProgressBar).progress=(t-o.needItemNum)/(o.needItemNum_nextLv-o.needItemNum);var i=parseInt(y.getConfigIntValue("car_skin_level_max"));o.level>=i?this.levelNode.getChildByName("ProgressBar").getChildByName("txt_number").getComponent(cc.Label).string="\u5df2\u6ee1\u7ea7":this.levelNode.getChildByName("ProgressBar").getChildByName("txt_number").getComponent(cc.Label).string=t-o.needItemNum+"/"+(o.needItemNum_nextLv-o.needItemNum)}},t.prototype.changeSkinTo2=function(e){var t=this,o=e,i="carSkins/BG_"+o;u.default.loadSpriteFrame(i).then(function(e){t.carBg.getComponent(cc.Sprite).spriteFrame=e});var a=m.default.getInstance().getItemByID(o),n=S.default.Instance.getLevelById(o);n<=0&&(n=1);var r=S.default.Instance.getCarTalentTableData(o,n);o==S.default.CAR_DEFAULT_SKIN_ID?(this.txt_name.string=a.name+" Lv1",this.txt_effect.string="\u7279\u6027\uff1a\u65e0"):(this.txt_name.string=a.name+" Lv"+n,null!=r&&(this.txt_effect.string=r.describe));var c=S.default.Instance.getCarSpineUrl(S.default.TYPE_MAIN,o);C.default.loadSpine(c,function(e,o){o&&(t.carSpineNode.scale=.3,t.carSpineNode.getComponent(sp.Skeleton).skeletonData=o,t.carSpineNode.getComponent(sp.Skeleton).setAnimation(0,"walk",!0))}),o!=S.default.CAR_DEFAULT_SKIN_ID&&y.getItemTotalNumByItemId(o)<=0&&s.G.StringManager.PopString(a.desc),this.showLvProgress(e)},t.prototype.callChangeSkin=function(e){console.log("callChangeSkin, changeSkinTo\u8bf7\u6c42\u66f4\u6362\u6218\u8f66\u76ae\u80a4, id="+e);var t=new f.C_Role_Car_Skin_Change;t.skinId=e,h.ClientNetwork.getInstance().Send(f.ROLE_CLIENT_ENUM.P_Role_Car_Skin_Change,t)},t.prototype.closeView=function(){var t=this;if(this.m_currentCarId!=S.default.Instance.getCurrSkinId())if(this.m_currentCarId!=S.default.CAR_DEFAULT_SKIN_ID&&y.getItemTotalNumByItemId(this.m_currentCarId)<=0)e.prototype.closeView.call(this);else{var o=m.default.getInstance().getItemByID(this.m_currentCarId),i=this;d.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:"\u662f\u5426\u5c06\u6218\u8f66\u66f4\u6362\u6210 "+o.name+"\uff1f",confirmCb:function(){i.callChangeSkin(i.m_currentCarId)},cancelCb:function(){e.prototype.closeView.call(t)}})}else e.prototype.closeView.call(this)},n([N(cc.ScrollView)],t.prototype,"scroll",void 0),n([N(cc.Node)],t.prototype,"listItemPrefab",void 0),n([N(cc.ScrollView)],t.prototype,"scroll2",void 0),n([N(cc.Node)],t.prototype,"listItemPrefab2",void 0),n([N(cc.Node)],t.prototype,"viewNode",void 0),n([N(cc.Label)],t.prototype,"txt_name",void 0),n([N(cc.Label)],t.prototype,"txt_effect",void 0),n([N(cc.Node)],t.prototype,"carSpineNode",void 0),n([N(cc.Node)],t.prototype,"carBg",void 0),n([N(cc.Node)],t.prototype,"levelNode",void 0),n([l.Register_Class,I],t)}(c.default);o.default=b,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/base/GameView":"GameView","../../modules/manager/LoadResManager":"LoadResManager","../../network/ClientNetwork":"ClientNetwork","../../network/LocalMessage":"LocalMessage","../../network/protocol/RoleProtocols":"RoleProtocols","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/ConfigUtils":"ConfigUtils","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils","../../utils/LogUtil":"LogUtil","../../utils/ResourcesManager":"ResourcesManager","./CarSkinUtils":"CarSkinUtils"}],ChannelsLiveIntroduceView:[function(e,t,o){"use strict";cc._RF.push(t,"f44a68tx/hHI4Fyv5dg8l1d","ChannelsLiveIntroduceView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=cc._decorator,l=c.ccclass,d=(c.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.path=function(){return"ui/channelsLive/ChannelsLiveHelp"},n([s.Register_Class,l],t)}(r.default));o.default=d,cc._RF.pop()},{"../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators"}],ChannelsLiveTaskItem:[function(e,t,o){"use strict";cc._RF.push(t,"680e0Ph205AF4He31yvROIG","ChannelsLiveTaskItem");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../StaticData/TaskTableData"),s=e("../../utils/ConfigUtils"),c=e("../../utils/ResourcesManager"),l=e("../../network/protocol/TypeProtocols"),d=e("../../utils/GameTools"),u=cc._decorator,h=u.ccclass,p=u.property,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.TaskProgressBar=null,t.TaskDescLab=null,t.ReceiveBtnNode=null,t.FinishNode=null,t.NoFinishLabNode=null,t.RewardNode=null,t}return a(t,e),t.prototype.init=function(e,t,o){var i=r.TaskTableData.getById(e.taskID);this.TaskDescLab.string=i.info2_ps;var a=s.default.getInstance().getDorpItemsByID(i.prizeID).dropRandom.split("|");for(var n in a){var u=a[n].split("#"),h=u[0];if(1==o)d.default.createNormalItems(u[0],u[1],this.node.getChildByName("ItemNode"),function(e){e.scale=.8}),this.RewardNode.active=!1,this.node.getChildByName("ItemNode").active=!0;else{var p=s.default.getInstance().getItemByID(h).icon;c.default.loadSprite(p,this.RewardNode.getComponent(cc.Sprite)),this.RewardNode.children[0].getComponent(cc.Label).string=u[1],this.RewardNode.active=!0,this.node.getChildByName("ItemNode").active=!1}}this.TaskProgressBar.progress=e.taskCount/i.finishCount,this.TaskProgressBar.progress>=1?this.TaskProgressBar.node.getChildByName("num").getComponent(cc.Label).string=i.finishCount+"/"+i.finishCount:this.TaskProgressBar.node.getChildByName("num").getComponent(cc.Label).string=e.taskCount+"/"+i.finishCount,e.taskState==l.TASK_STATE.TASK_STATE_FINISH?(this.FinishNode.active=!0,this.TaskProgressBar.progress=1,this.TaskProgressBar.node.getChildByName("num").getComponent(cc.Label).string=i.finishCount+"/"+i.finishCount):this.TaskProgressBar.progress>=1?this.ReceiveBtnNode.active=!0:this.NoFinishLabNode.active=!0,this._taskId=e.taskID,this._view=t},t.prototype.onReceiveBtnCallBack=function(){this._view.onReceiveTakeTask(this._taskId)},n([p(cc.ProgressBar)],t.prototype,"TaskProgressBar",void 0),n([p(cc.Label)],t.prototype,"TaskDescLab",void 0),n([p(cc.Node)],t.prototype,"ReceiveBtnNode",void 0),n([p(cc.Node)],t.prototype,"FinishNode",void 0),n([p(cc.Node)],t.prototype,"NoFinishLabNode",void 0),n([p(cc.Node)],t.prototype,"RewardNode",void 0),n([h],t)}(cc.Component);o.default=f,cc._RF.pop()},{"../../StaticData/TaskTableData":"TaskTableData","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/ConfigUtils":"ConfigUtils","../../utils/GameTools":"GameTools","../../utils/ResourcesManager":"ResourcesManager"}],ChannelsLiveView:[function(e,t,o){"use strict";cc._RF.push(t,"a0910wuXSRH55TV6dwKhaFe","ChannelsLiveView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r,s=e("../../Global/GameGlobal"),c=e("../../modules/base/BaseView"),l=e("../../modules/base/Decorators"),d=e("../../network/protocol/RoleProtocols"),u=e("../../common/PlayerModule"),h=e("../../StaticData/TaskTableData"),p=e("../../network/protocol/TypeProtocols"),f=e("../../utils/ConfigUtils"),g=e("../../utils/GameTools"),m=e("../../utils/WechatUtils"),_=e("../../network/ClientNetwork"),y=e("../../network/LocalMessage"),v=e("../../modules/base/GameView"),C=e("../../utils/GamePlatform"),S=e("../../utils/TimeOffSetManager");(function(e){e[e.NewBoy_tab=1]="NewBoy_tab",e[e.Anchorwoman_tab=2]="Anchorwoman_tab",e[e.ContinueRewards_tab=3]="ContinueRewards_tab",e[e.LiveHall_tab=4]="LiveHall_tab"})(r||(r={}));var T=cc._decorator,I=T.ccclass,N=T.property,b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.NewBoyChannelsNode=null,t.TaskScrollView=null,t.TaskItemPrefab=null,t.DayLiveTimeLab=null,t.LiveHallNode=null,t.taskRedpoint=[],t._curTouchTab=r.NewBoy_tab,t._bClickStartGameLive=!1,t._bClickReserveLive=!1,t._sNoticeId="",t._bIsEnabled=!1,t._bClickClose=!1,t}return a(t,e),t.path=function(){return"ui/channelsLive/ChannelsLiveMain"},t.prototype.onLoad=function(){var e=this;if(_.ClientNetwork.getInstance().listenLocalMessage(y.LOCAL_MESSAGE.LocalMsg_RefreshTask,function(){switch(e.initChannelsLiveCfgData(),e._curTouchTab){case r.NewBoy_tab:e.initFirstChannelsLiveInfo();break;case r.Anchorwoman_tab:e.initChannelsLiveTaskInfo(0);break;case r.ContinueRewards_tab:e.initChannelsLiveTaskInfo(1)}e.onRefreshTaskRedpoint(),e.scheduleOnce(function(){var t=Math.floor(u.default.getRoleAttrValByKey(p.ROLE_ATTR_VALUES.ROLE_ATTR_DAYLIVETIME)/60);e.DayLiveTimeLab.string=s.G.StringManager.getString("DAYLIVETIME_TEXT",t)},1)},this),_.ClientNetwork.getInstance().listenProtocol(d.ROLE_CLIENT_ENUM.P_Role_TakeTask,function(t){t.resetPos();var o=new d.S_Role_TakeTask;o.read(t)&&(0==o.errorcode?(o.prize.length>0&&v.default.addPopView("BaseCtrl","AcquirePopupView","AcquirePopupView",{items:o.prize}),e.onRefreshTaskRedpoint()):s.G.StringManager.PopString("S_Role_TakeTask Error "+o.errorcode))},this),C.GamePlatform.isWechat()){var t=this,o=function(){var i=wx.getSystemInfoSync();if("windows"!=i.platform&&"mac"!=i.platform&&0!=t.isVaild())if(1!=e._bClickClose){if(0!=t._bClickStartGameLive||0!=t._bClickReserveLive){if(1==t._bClickStartGameLive){if(t._bClickStartGameLive=!1,0==t._bIsEnabled)return;if(m.WechatUtils.getInstance().wxGetGameLiveState())return;wx.startGameLive?wx.startGameLive({}):wx.showModal({title:"\u63d0\u793a",content:"\u5f53\u524d\u5fae\u4fe1\u7248\u672c\u8fc7\u4f4e\uff0c\u65e0\u6cd5\u4f7f\u7528\u8be5\u529f\u80fd\uff0c\u8bf7\u5347\u7ea7\u5230\u6700\u65b0\u5fae\u4fe1\u7248\u672c\u540e\u91cd\u8bd5\u3002"})}1==t._bClickReserveLive&&(t._bClickReserveLive=!1,t._sNoticeId.length>0&&wx.reserveChannelsLive&&wx.reserveChannelsLive({noticeId:t._sNoticeId}))}}else wx.offTouchEnd(o)};wx.onTouchEnd(o),wx.checkGameLiveEnabled&&wx.checkGameLiveEnabled({success:function(t){e._bIsEnabled=t.isEnabled},fail:function(){}}),wx.getChannelsLiveInfo&&wx.getChannelsLiveInfo({finderUserName:"sphKR1PR00Z3jIQ",success:function(t){2==t.status?(e.LiveHallNode.getChildByName("ReservLiveBtn").active=!1,e.LiveHallNode.getChildByName("WatchLiveBtn").active=!0):t.status},fail:function(){}}),wx.getChannelsLiveNoticeInfo&&wx.getChannelsLiveNoticeInfo({finderUserName:"sphKR1PR00Z3jIQ",success:function(t){1==t.reservable?(e._sNoticeId=t.noticeId,e.LiveHallNode.getChildByName("ReservLiveBtn").active=!0,e.LiveHallNode.getChildByName("WatchLiveBtn").active=!1):t.status},fail:function(){}})}},t.prototype.start=function(){this.initChannelsLiveCfgData(),this._newBoyTaskCfgData[0]&&this._newBoyTaskCfgData[0].taskState==p.TASK_STATE.TASK_STATE_FINISH?(this.node.getChildByName("ToggleContainer").children[0].active=!1,this.node.getChildByName("ToggleContainer").children[3].getComponent(cc.Toggle).isChecked=!0,this.onClickLiveHallCallBack()):this.initFirstChannelsLiveInfo();var e=Math.floor(u.default.getRoleAttrValByKey(p.ROLE_ATTR_VALUES.ROLE_ATTR_DAYLIVETIME)/60);this.DayLiveTimeLab.string=s.G.StringManager.getString("DAYLIVETIME_TEXT",e),this.onRefreshTaskRedpoint(),this.initLiveCover("https://tfjl-1300944069.file.myqcloud.com/liveBg.png?"+S.TimeOffSetManager.getMilisecond())},t.prototype.initChannelsLiveCfgData=function(){var e=this;e._newBoyTaskCfgData=[],e._channelsLiveTaskCfgData=[],e._continueRewardsTaskCfgData=[],Array.from(u.default.getRoleTaskData().tasks.values()).forEach(function(t){var o=h.TaskTableData.getById(t.taskID);o.showType==p.TASK_SHOW_TYPE.ASK_CHANNELS_LIVE_NEW_REPORTED?e._newBoyTaskCfgData.push(t):o.showType==p.TASK_SHOW_TYPE.TASK_CHANNELS_LIVE?e._channelsLiveTaskCfgData.push(t):o.showType==p.TASK_SHOW_TYPE.TASK_CHANNELS_LIVE_REWARD&&e._continueRewardsTaskCfgData.push(t)})},t.prototype.initFirstChannelsLiveInfo=function(){var e=this,t=this.NewBoyChannelsNode.getChildByName("maskLyoutNode").getChildByName("rewardLayout");t.removeAllChildren(),this.scheduleOnce(function(){var o=h.TaskTableData.getById(e._newBoyTaskCfgData[0].taskID),i=f.default.getInstance().getDorpItemsByID(o.prizeID).dropRandom.split("|");for(var a in i){var n=i[a].split("#");g.default.createNormalItems(n[0],n[1],t)}},.1);var o=this.NewBoyChannelsNode.children[0],i=o.children[0];if(this._newBoyTaskCfgData[0].taskState==p.TASK_STATE.TASK_STATE_FINISH)i.children[1].active=!0,i.children[0].active=!1,o.getComponent(cc.Button).interactable=!1,o.getComponent(cc.Button).enableAutoGrayEffect=!0;else{var a=u.default.getRoleAttrValByKey(p.ROLE_ATTR_VALUES.ROLE_ATTR_DAYLIVETIME);Math.floor(a/60)>=10?(o.getComponent(cc.Button).interactable=!0,o.getComponent(cc.Button).enableAutoGrayEffect=!1):(o.getComponent(cc.Button).interactable=!1,o.getComponent(cc.Button).enableAutoGrayEffect=!0),i.children[1].active=!1,i.children[0].active=!0}},t.prototype.initLiveCover=function(e){var t=this;cc.assetManager.loadRemote(e,{ext:".png"},function(e,o){var i=t.LiveHallNode.getComponent(cc.Sprite);i&&(i.spriteFrame=new cc.SpriteFrame(o))})},t.prototype.isAchievementComplete=function(e){return e.taskState==p.TASK_STATE.TASK_STATE_EXECUTING&&h.TaskTableData.getById(e.taskID).finishCount<=e.taskCount?1:0},t.prototype.initChannelsLiveTaskInfo=function(e){this.TaskScrollView.content.childrenCount>0&&this.TaskScrollView.content.removeAllChildren();var t=this._channelsLiveTaskCfgData;1==e&&(t=this._continueRewardsTaskCfgData);var o=this;t.sort(function(e,t){return o.isAchievementComplete(t)-o.isAchievementComplete(e)||e.taskID-t.taskID});for(var i=0;i<t.length;i++){var a=cc.instantiate(this.TaskItemPrefab);a.parent=this.TaskScrollView.content,a.scale=.7,a.getComponent("ChannelsLiveTaskItem").init(t[i],this,e)}},t.prototype.onNewReportedCallBack=function(){r.NewBoy_tab!=this._curTouchTab&&(this._curTouchTab=r.NewBoy_tab,this.NewBoyChannelsNode.active=!0,this.TaskScrollView.node.active=!1,this.LiveHallNode.active=!1,this.initFirstChannelsLiveInfo())},t.prototype.onChannelsLiveTaskCallBack=function(){r.Anchorwoman_tab!=this._curTouchTab&&(this._curTouchTab=r.Anchorwoman_tab,this.NewBoyChannelsNode.active=!1,this.TaskScrollView.node.active=!0,this.LiveHallNode.active=!1,this.initChannelsLiveTaskInfo(0))},t.prototype.onContinueRewardsCallBack=function(){r.ContinueRewards_tab!=this._curTouchTab&&(this._curTouchTab=r.ContinueRewards_tab,this.NewBoyChannelsNode.active=!1,this.TaskScrollView.node.active=!0,this.LiveHallNode.active=!1,this.initChannelsLiveTaskInfo(1))},t.prototype.onClickLiveHallCallBack=function(){r.LiveHall_tab!=this._curTouchTab&&(this._curTouchTab=r.LiveHall_tab,this.NewBoyChannelsNode.active=!1,this.TaskScrollView.node.active=!1,this.LiveHallNode.active=!0)},t.prototype.onClickReserveChannelsLive=function(){C.GamePlatform.isWechat()&&(this._bClickReserveLive=!0)},t.prototype.onReceiveNewReportedCallBack=function(){this.onReceiveTakeTask(this._newBoyTaskCfgData[0].taskID)},t.prototype.onReceiveTakeTask=function(e){var t=new d.C_Role_TakeTask;t.taskID=e,_.ClientNetwork.getInstance().Send(d.ROLE_CLIENT_ENUM.P_Role_TakeTask,t)},t.prototype.onClickLivePlazaCallBack=function(){if(C.GamePlatform.isWechat()){var e=wx.getSystemInfoSync();if("windows"==e.platform||"mac"==e.platform)return;m.WechatUtils.getInstance().wxOpenChannelsLiveCollection()}},t.prototype.onClickLiveCallBack=function(){C.GamePlatform.isWechat()&&(this._bClickStartGameLive=!0)},t.prototype.onClickOpenChannelsLiveCallBack=function(){if(C.GamePlatform.isWechat()){var e=wx.getSystemInfoSync();if("windows"==e.platform||"mac"==e.platform)return;m.WechatUtils.getInstance().wxOpenChannelsLive()}},t.prototype.onClickClose=function(){if(C.GamePlatform.isWechat()){this._bClickClose=!0;var e=v.default.getViewByName("MainSceneView");e&&e.view&&e.view.onSyncChangeLiveTaskData()}this.closeView()},t.prototype.onClickHelpCallBack=function(){v.default.addPopView("BaseCtrl","ChannelsLiveIntroduceView","ChannelsLiveIntroduceView")},t.prototype.onRefreshTaskRedpoint=function(){var e=this;this.taskRedpoint[0].active=!1,this.taskRedpoint[1].active=!1,this._channelsLiveTaskCfgData.forEach(function(t){var o=h.TaskTableData.getById(t.taskID),i=t.taskCount/o.finishCount;t.taskState==p.TASK_STATE.TASK_STATE_EXECUTING&&i>=1&&(e.taskRedpoint[0].active=!0)}),this._continueRewardsTaskCfgData.forEach(function(t){var o=h.TaskTableData.getById(t.taskID),i=t.taskCount/o.finishCount;t.taskState==p.TASK_STATE.TASK_STATE_EXECUTING&&i>=1&&(e.taskRedpoint[1].active=!0)})},t.prototype.onDestroy=function(){_.ClientNetwork.getInstance().removeMessageTarget(this),_.ClientNetwork.getInstance().removeLocalMessage(y.LOCAL_MESSAGE.LocalMsg_RefreshTask,this)},n([N(cc.Node)],t.prototype,"NewBoyChannelsNode",void 0),n([N(cc.ScrollView)],t.prototype,"TaskScrollView",void 0),n([N(cc.Prefab)],t.prototype,"TaskItemPrefab",void 0),n([N(cc.Label)],t.prototype,"DayLiveTimeLab",void 0),n([N(cc.Node)],t.prototype,"LiveHallNode",void 0),n([N(cc.Node)],t.prototype,"taskRedpoint",void 0),n([l.Register_Class,I],t)}(c.default);o.default=b,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/TaskTableData":"TaskTableData","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/base/GameView":"GameView","../../network/ClientNetwork":"ClientNetwork","../../network/LocalMessage":"LocalMessage","../../network/protocol/RoleProtocols":"RoleProtocols","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/ConfigUtils":"ConfigUtils","../../utils/GamePlatform":"GamePlatform","../../utils/GameTools":"GameTools","../../utils/TimeOffSetManager":"TimeOffSetManager","../../utils/WechatUtils":"WechatUtils"}],ChatChannelTableData:[function(e,t,o){"use strict";cc._RF.push(t,"535d6FRfNdPV7YuAQtZRdDX","ChatChannelTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.ChatChannelTableData=void 0;var i=e("../TableReader"),a=e("./BaseTableData"),n=function(){function e(){this.id=0,this.isClient=!1,this.showChannel=new Array,this.cost=new Array,this.conditionMaxScore=0,this.cd=0,this.group=0}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.isClient=e.getBoolean();for(var o=e.getString(),n=new i.TableReader(o);n.getPos()<n.getLen();){var r=void 0;r=n.getNumber(),this.showChannel.push(r)}o=e.getString();for(var s=new i.TableReader(o);s.getPos()<s.getLen();)(r=new a.DropItem).readOriginal(s),this.cost.push(r);this.conditionMaxScore=e.getNumber(),this.cd=e.getNumber(),this.group=e.getNumber()},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"ChatChannelTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.ChatChannelTableData=n,cc._RF.pop()},{"../TableReader":"TableReader","./BaseTableData":"BaseTableData"}],ChatItem:[function(e,t,o){"use strict";cc._RF.push(t,"33a18Jetd5BXoen9s2ccYAo","ChatItem");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../common/PlayerModule"),s=e("../../utils/GameUtils"),c=e("../../modules/base/GameView"),l=e("../../Global/GameGlobal"),d=e("../../utils/GameTools"),u=e("../../common/CombatModule"),h=e("../../network/ClientNetwork"),p=e("../../network/protocol/TypeProtocols"),f=e("../../modules/manager/LoadResManager"),g=e("../../utils/GameUtils"),m=e("../../utils/ConfigUtils"),_=e("../../network/protocol/MatchProtocols"),y=e("../../utils/GamePlatform"),v=e("../../network/protocol/RoleProtocols"),C=e("../../utils/QQGameHallUtils"),S=e("../skyCastle/SkyCastleModule"),T=e("../../StaticData/ActivityTableData"),I=e("../../network/protocol/ActivityProtocols"),N=e("../../utils/UIManager"),b=e("../activity/ActivityModule"),w=e("../../common/NetworkProtocolCommon"),E=e("../fogHidden/FogHiddenModel"),P=e("../machineryCityActivity/MachineryCityModel"),R=e("../../utils/ResourcesManager"),L=cc._decorator,A=L.ccclass,D=L.property,M=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.other=null,t.self=null,t._strRoomId="",t._combatType=u.CombatType.SOLO,t.m_nChannel=p.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_SYSTEM,t}return a(t,e),t.prototype.show=function(e){var t;if(e){0==this.node.active&&(this.node.active=!0),e.channel!=p.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_WORLD&&e.channel!=p.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_SYSTEM&&e.channel!=p.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_ACTIVITY&&e.channel!=p.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_WEEK_COOPERATION||(e.bReadState||(e.bReadState=0),0==e.bReadState&&1==this.checkVisible()&&(e.bReadState=1));var o=!1;1==e.roleID.equals(r.default.UUID)&&(o=!0);var i=null;if(1==o)this.self.active=!0,this.other.active=!1,i=this.self;else{this.self.active=!1,this.other.active=!0;var a=(i=this.other).getChildByName("player");a.roleid=e.roleID,a.roleid=r.default.otherUUidTransformRoieId(e.roleID);var n=c.default.getViewByName("MainSceneView");n&&n.view?d.default.registerTouchEvent(a,function(e){n.view.onCallGetRoleSimpleInfo(e.target.roleid)}):d.default.registerTouchEvent(a,function(e){var t=new v.C_Role_GetRoleSimpleInfo;t.showID=e.target.roleid.toString(),h.ClientNetwork.getInstance().Send(v.ROLE_CLIENT_ENUM.P_Role_GetRoleSimpleInfo,t)})}s.setRemoteHeadIcon(e.headUrl,e.headID,i.getChildByName("player").getChildByName("icon").getComponent(cc.Sprite)),e.headFrameID<=0&&(e.headFrameID=200),f.default.loadSpriteFrame("ui/headFrame/frame_"+e.headFrameID).then(function(e){i&&cc.isValid(i)&&(i.getChildByName("player").getChildByName("frame").getComponent(cc.Sprite).spriteFrame=e)});var l=i.getChildByName("player").getChildByName("sociatyNameLyout");if(l.getChildByName("name").getComponent(cc.Label).string=e.nickName,e.sociatyName){var u=e.sociatyName.length>0?" ["+e.sociatyName+"]":"";l.getChildByName("txt_union_name").getComponent(cc.Label).string=u,l.getChildByName("img_job20").active=!1,l.getChildByName("img_job30").active=!1,e.sociatyJob==p.SOCIATY_JOB.SOCIATY_JOB_OFFICIAL&&(l.getChildByName("img_job20").active=!0),e.sociatyJob==p.SOCIATY_JOB.SOCIATY_JOB_PRESIDENT&&(l.getChildByName("img_job30").active=!0)}else l.getChildByName("img_job20").active=!1,l.getChildByName("img_job30").active=!1,l.getChildByName("txt_union_name").getComponent(cc.Label).string="";if(y.GamePlatform.isQQGameRoom()&&e.qqHallVipInfo){l.getChildByName("bluevip").active=!0;var g=e.qqHallVipInfo[0],_=e.qqHallVipInfo[1],S=e.qqHallVipInfo[2],T=e.qqHallVipInfo[3];C.QQGameHallUtils.setBlueIcon(l.getChildByName("bluevip").getChildByName("icon"),!1,g,_,S,T),C.QQGameHallUtils.setBlueIcon(l.getChildByName("bluevip").getChildByName("year"),!0,g,_)}else l.getChildByName("bluevip").active=!1;if(null===(t=this.label)||void 0===t||t.node.off(cc.Node.EventType.SIZE_CHANGED,this.onChangeSize,this),e.chatType==p.TYPE_CHAT.TYPE_CHAT_ROOMFIGHT)return this.node.height=165,this._strRoomId=e.chatText,this.setRoomInfo(e,i),this.onListenCloseFightRoom(),i.getChildByName("textMsgNode").active=!1,i.getChildByName("EmojiNode").active=!1,this.node.roomId=e.chatText,void(e.heros.size>10&&(this.node.height=305));if(e.chatType!=p.TYPE_CHAT.TYPE_CHAT_EXPRESSION){var I=i.getChildByName("textMsgNode");i.getChildByName("EmojiNode").active=!1,I.active=!0,i.getChildByName("machineryNode").active=!1,i.getChildByName("fogHiddenNode").active=!1,i.getChildByName("ppveNode").active=!1,i.getChildByName("pvpNode").active=!1,i.getChildByName("skyArenaNode").active=!1,i.getChildByName("weekCoopNode").active=!1,this.background=I.children[0],this.label=I.children[1].getComponent(cc.Label),this.label.node.on(cc.Node.EventType.SIZE_CHANGED,this.onChangeSize,this),this.label.overflow=cc.Label.Overflow.NONE,this.label.string=e.chatText,this.label._forceUpdateRenderData(),this.background.width=this.label.node.width+45,this.background.height=this.label.node.height+20,this.background.height>165&&(this.background.height=165),I.setContentSize(this.background.getContentSize()),this.node.height=this.background.height+65}else{this.node.height=135,i.getChildByName("textMsgNode").active=!1,i.getChildByName("EmojiNode").active=!0,i.getChildByName("ppveNode").active=!1,i.getChildByName("pvpNode").active=!1,i.getChildByName("skyArenaNode").active=!1,i.getChildByName("weekCoopNode").active=!1,i.getChildByName("fogHiddenNode").active=!1,i.getChildByName("machineryNode").active=!1;var N=m.default.getInstance().getItemByID(Number(e.chatText));i.getChildByName("EmojiNode").children[0].active=!1;var b=i.getChildByName("EmojiNode").children[1],w=m.default.getInstance().getResConfig(N.spineId).animation;cc.resources.load(w,sp.SkeletonData,function(e,t){e?console.log("load asset url:"+w+" faild!!!"):(b.getComponent(sp.Skeleton).skeletonData=t,b.getComponent(sp.Skeleton).setSkin("default"),b.getComponent(sp.Skeleton).setAnimation(0,"idle",!1))})}}},t.prototype.onChangeSize=function(){this.label.node.width>345&&(this.label.overflow=cc.Label.Overflow.RESIZE_HEIGHT,this.label.node.width=340,this.label._forceUpdateRenderData(),this.background.width=this.label.node.width+45,this.background.height=this.label.node.height+20,this.background.height>165&&(this.background.height=165),this.background.parent.setContentSize(this.background.getContentSize()),this.node.height=this.background.height+65)},t.prototype.setRoomInfo=function(e,t){if(e.heros.size>0)if(this._combatType=u.CombatType.COOP,e.channel==p.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_SKYCASTLE_EASY||e.channel==p.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_SKYCASTLE_HARD||e.channel==p.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_SKYCASTLE_NIGHTMARE){t.getChildByName("ppveNode").active=!1,t.getChildByName("pvpNode").active=!1;var o=t.getChildByName("skyArenaNode");o.getChildByName("btn_join2").getComponent(cc.Button).interactable=!0,o.getChildByName("btn_join2").getComponent(cc.Button).enableAutoGrayEffect=!1,o.getChildByName("btn_join2").getChildByName("txt_join2").active=!0,o.getChildByName("btn_join2").getChildByName("txt_na2").active=!1,o.active=!0,f.default.loadSpriteFrame("ui/mainScene/res/sky_"+e.channel).then(function(e){o&&cc.isValid(o)&&(o.children[0].getComponent(cc.Sprite).spriteFrame=e)})}else if(e.channel==p.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_WEEK_COOPERATION){t.getChildByName("machineryNode").active=!1,t.getChildByName("fogHiddenNode").active=!1,t.getChildByName("weekCoopNode").active=!0,t.getChildByName("ppveNode").active=!1,t.getChildByName("pvpNode").active=!1,t.getChildByName("skyArenaNode").active=!1;var i=t.getChildByName("weekCoopNode");i.getChildByName("btn_join2").getComponent(cc.Button).interactable=!0,i.getChildByName("btn_join2").getComponent(cc.Button).enableAutoGrayEffect=!1,i.getChildByName("btn_join2").getChildByName("txt_join2").active=!0,i.getChildByName("btn_join2").getChildByName("txt_na2").active=!1}else if(e.channel==p.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_ACTIVITY)if(t.getChildByName("fogHiddenNode").active=!0,t.getChildByName("weekCoopNode").active=!1,t.getChildByName("ppveNode").active=!1,t.getChildByName("pvpNode").active=!1,t.getChildByName("skyArenaNode").active=!1,c.default.getViewNodeByName("MachineryCityMainView")){t.getChildByName("fogHiddenNode").active=!1,t.getChildByName("machineryNode").active=!0;var a=t.getChildByName("machineryNode");a.getChildByName("btn_join2").getComponent(cc.Button).interactable=!0,a.getChildByName("btn_join2").getComponent(cc.Button).enableAutoGrayEffect=!1,a.getChildByName("btn_join2").getChildByName("txt_join2").active=!0,a.getChildByName("btn_join2").getChildByName("txt_na2").active=!1;var n=["ui/common_res/quality1","ui/common_res/quality2","ui/common_res/quality3","ui/common_res/quality4"];if(e.heros.size>10&&a.getChildByName("HeroLayout")){a.getChildByName("HeroLayout").active=!0;var r=new Array;e.heros.forEach(function(e,t){t>10&&r.push(e.heroID)}),r&&r.length>0&&r.forEach(function(e,t){var o=m.default.getInstance().getItemByID(e);if(o){var i=a.getChildByName("HeroLayout").children[t];i&&(R.default.loadSprite(n[o.quality-1],i.getComponent(cc.Sprite)),R.default.loadSprite(o.icon,i.children[0].getComponent(cc.Sprite)))}})}}else{t.getChildByName("fogHiddenNode").active=!0,t.getChildByName("machineryNode").active=!1;var s=t.getChildByName("fogHiddenNode");s.getChildByName("btn_join2").getComponent(cc.Button).interactable=!0,s.getChildByName("btn_join2").getComponent(cc.Button).enableAutoGrayEffect=!1,s.getChildByName("btn_join2").getChildByName("txt_join2").active=!0,s.getChildByName("btn_join2").getChildByName("txt_na2").active=!1}else{var l,d;(l=t.getChildByName("ppveNode")).active=!0,(d=t.getChildByName("pvpNode")).active=!1,l.getChildByName("btn_join2").getComponent(cc.Button).interactable=!0,l.getChildByName("btn_join2").getComponent(cc.Button).enableAutoGrayEffect=!1,l.getChildByName("btn_join2").getChildByName("txt_join2").active=!0,l.getChildByName("btn_join2").getChildByName("txt_na2").active=!1,t.getChildByName("skyArenaNode").active=!1,t.getChildByName("weekCoopNode").active=!1,t.getChildByName("fogHiddenNode").active=!1,t.getChildByName("machineryNode").active=!1}else this._combatType=u.CombatType.DUEL,(d=t.getChildByName("pvpNode")).active=!0,(l=t.getChildByName("ppveNode")).active=!1,d.getChildByName("btn_join1").getComponent(cc.Button).interactable=!0,d.getChildByName("btn_join1").getComponent(cc.Button).enableAutoGrayEffect=!1,d.getChildByName("btn_join1").getChildByName("txt_join1").active=!0,d.getChildByName("btn_join1").getChildByName("txt_na1").active=!1,t.getChildByName("skyArenaNode").active=!1,t.getChildByName("weekCoopNode").active=!1,t.getChildByName("fogHiddenNode").active=!1,t.getChildByName("machineryNode").active=!1;e.chatParam&&1==e.chatParam&&this.onRefreshRoomState(e),this.m_nChannel=e.channel},t.prototype.onRefreshRoomState=function(e){var t=null;if(t=1==this.self.active?this.self:this.other,this._combatType==u.CombatType.SOLO||this._combatType==u.CombatType.DUEL){var o=t.getChildByName("pvpNode"),i=cc.find("btn_join1/txt_join1",o).getComponent(cc.Label);cc.find("btn_join1/txt_na1",o).getComponent(cc.Label).node.active=!0,i.node.active=!1,o.getChildByName("btn_join1").getComponent(cc.Button).interactable=!1,o.getChildByName("btn_join1").getComponent(cc.Button).enableAutoGrayEffect=!0}else if(this._combatType==u.CombatType.COOP){var a=t.getChildByName("ppveNode");e&&(e.channel==p.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_SKYCASTLE_EASY||e.channel==p.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_SKYCASTLE_HARD||e.channel==p.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_SKYCASTLE_NIGHTMARE?a=t.getChildByName("skyArenaNode"):e.channel==p.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_WEEK_COOPERATION?a=t.getChildByName("weekCoopNode"):e.channel==p.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_ACTIVITY&&(a=c.default.getViewNodeByName("MachineryCityMainView")?t.getChildByName("machineryNode"):t.getChildByName("fogHiddenNode"))),i=cc.find("btn_join2/txt_join2",a).getComponent(cc.Label),cc.find("btn_join2/txt_na2",a).getComponent(cc.Label).node.active=!0,i.node.active=!1,a.getChildByName("btn_join2").getComponent(cc.Button).interactable=!1,a.getChildByName("btn_join2").getComponent(cc.Button).enableAutoGrayEffect=!0}},t.prototype.onListenCloseFightRoom=function(){},t.prototype.onClickJoinRoom=function(){var e=this;if(l.G.UIManager.getCurSceneName()!=N.SceneName.MainScene)return l.G.StringManager.PopWorldString("coop_join_room_tip");if(this.m_nChannel==p.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_SKYCASTLE_EASY||this.m_nChannel==p.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_SKYCASTLE_HARD||this.m_nChannel==p.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_SKYCASTLE_NIGHTMARE){if(0==S.default.Instance.checkSkyCastleOpenState())return l.G.StringManager.PopWorldString(l.G.StringManager.getWorldString("sky_battle_score_limit_tip4"));var t=(i=T.ActivityTableData.getById(I.ACTIVITY_ID_ENUM.P_Activity_SkyCastle)).param1;return r.default.getRoleAttrValByKey(p.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE)<t?l.G.StringManager.PopWorldString(l.G.StringManager.getWorldString("sky_battle_score_limit_tip",t)):S.default.Instance.getCurCastleSkyType()<0?l.G.StringManager.PopWorldString(l.G.StringManager.getWorldString("sky_battle_score_limit_tip3")):S.default.Instance.getCurCastleSkyType()+p.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_SKYCASTLE_EASY>=this.m_nChannel?S.default.Instance.getCurCastleSkyType()>=p.SKYCASTLE_TYPE.SKYCASTLE_TYPE_NIGHTMARE?void c.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:l.G.StringManager.getString("ASSISTBATTLE_SKY_TIP1"),confirmCb:function(){e.callJoinRoom()}},99):this.callJoinRoom():l.G.StringManager.PopWorldString(l.G.StringManager.getWorldString("sky_battle_score_limit_tip2"))}if(this.m_nChannel==p.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_WEEK_COOPERATION)return r.default.getRoleAttrValByKey(p.ROLE_ATTR_VALUES.ROLE_ATTR_WEEK_COOPERATION)<=0?l.G.StringManager.PopWorldString(l.G.StringManager.getWorldString("weekCooperationRelive_tip1",g.getConfigIntValue("week_cooperation_need_wave"))):0==b.default.getWeekCooperationIsOpen()?l.G.StringManager.PopWorldString(l.G.StringManager.getWorldString("weekCooperationRelive_tip2")):1==b.default.checkIsAssistFightingState()?void c.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:l.G.StringManager.getString("WEEKCOOP_BATTLE_OVER_TIPS"),confirmCb:function(){e.callJoinRoom()}}):this.callJoinRoom();if(this.m_nChannel==p.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_ACTIVITY){var o=c.default.getViewNodeByName("MachineryCityMainView");if(o&&o.getComponent("MachineryCityMainView")){if(0==P.default.Instance.getMachineryCityState())return;var i=T.ActivityTableData.getById(I.ACTIVITY_ID_ENUM.P_Activity_Machinarium);return P.default.Instance.getTodayFightFailCount()>=i.param3?c.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:l.G.StringManager.getString("MACHINERYCITY_TIP6"),confirmCb:function(){e.callJoinRoom()}}):this.callJoinRoom()}return t=(i=T.ActivityTableData.getById(I.ACTIVITY_ID_ENUM.P_Activity_FogHidden)).param1,r.default.getRoleAttrValByKey(p.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE)<t?l.G.StringManager.PopString(l.G.StringManager.getString("FOG_HIDDEN_ACTIVITY_TIPS1",t)):0==E.default.Instance.checkFogHiddenOpenState()?l.G.StringManager.PopString(l.G.StringManager.getString("FOG_HIDDEN_ACTIVITY_TIPS2")):E.default.Instance.getFogHiddenSurplusCount()<=0?void c.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:l.G.StringManager.getString("FOG_HIDDEN_ACTIVITY_TIPS3"),confirmCb:function(){e.callJoinRoom()}}):this.callJoinRoom()}if(this._combatType==u.CombatType.COOP){var a=Number(g.getConfigIntValue("coop_score_limit"));if(r.default.getRoleAttrValByKey(p.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE)<a)return l.G.StringManager.PopWorldString(l.G.StringManager.getWorldString("coop_score_limit_tip",a))}this._combatType==u.CombatType.COOP&&r.default.getRoleInfoData().cooperationDayLeftNum<=0?c.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:l.G.StringManager.getString("COOP_BATTLE_OVER_TIPS"),confirmCb:function(){e.callJoinRoom()}}):this.callJoinRoom()},t.prototype.callJoinRoom=function(){if(b.default.isChickenDinnerMatching())return l.G.StringManager.PopString(l.G.StringManager.getString("CHICKENDINNER_MATCHING")),w.default.callRoleClientLog("CHICKENDINNER_MATCHING9"),void console.log("isChickenDinnerMatching code=9");var e=new _.C_Match_Duel_Fight;if(this._combatType==u.CombatType.SOLO)e.fightType=p.FIGHT_TYPE.FIGHT_TYPE_BATTLE;else if(this._combatType==u.CombatType.COOP)if(this.m_nChannel==p.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_SKYCASTLE_EASY||this.m_nChannel==p.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_SKYCASTLE_HARD||this.m_nChannel==p.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_SKYCASTLE_NIGHTMARE)e.fightType=p.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE;else if(this.m_nChannel==p.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_WEEK_COOPERATION)e.fightType=p.FIGHT_TYPE.FIGHT_TYPE_WEEK_COOPERATION;else if(this.m_nChannel==p.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_ACTIVITY){var t=c.default.getViewNodeByName("MachineryCityMainView");e.fightType=t?p.FIGHT_TYPE.FIGHT_TYPE_MACHINARIUM:p.FIGHT_TYPE.FIGHT_TYPE_FOG_HIDDEN}else e.fightType=p.FIGHT_TYPE.FIGHT_TYPE_COOPERATION;else this._combatType==u.CombatType.DUEL&&(e.fightType=p.FIGHT_TYPE.FIGHT_TYPE_DUEL_BATTLE);e.useRoom=0,e.params.push(s.getConfigVersion()),""!=this._strRoomId&&(e.roomID=this._strRoomId),h.ClientNetwork.getInstance().Send(_.MATCH_CLIENT_ENUM.P_Match_Duel_Fight,e)},t.prototype.checkVisible=function(){return this.node.getBoundingBoxToWorld().intersects(this.node.parent.parent.parent.getBoundingBoxToWorld())},n([D(cc.Node)],t.prototype,"other",void 0),n([D(cc.Node)],t.prototype,"self",void 0),n([A],t)}(cc.Component);o.default=M,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/ActivityTableData":"ActivityTableData","../../common/CombatModule":"CombatModule","../../common/NetworkProtocolCommon":"NetworkProtocolCommon","../../common/PlayerModule":"PlayerModule","../../modules/base/GameView":"GameView","../../modules/manager/LoadResManager":"LoadResManager","../../network/ClientNetwork":"ClientNetwork","../../network/protocol/ActivityProtocols":"ActivityProtocols","../../network/protocol/MatchProtocols":"MatchProtocols","../../network/protocol/RoleProtocols":"RoleProtocols","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/ConfigUtils":"ConfigUtils","../../utils/GamePlatform":"GamePlatform","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils","../../utils/QQGameHallUtils":"QQGameHallUtils","../../utils/ResourcesManager":"ResourcesManager","../../utils/UIManager":"UIManager","../activity/ActivityModule":"ActivityModule","../fogHidden/FogHiddenModel":"FogHiddenModel","../machineryCityActivity/MachineryCityModel":"MachineryCityModel","../skyCastle/SkyCastleModule":"SkyCastleModule"}],ChatMainView:[function(e,t,o){"use strict";cc._RF.push(t,"4c226bZjc9EjYYBVlQuB5QG","ChatMainView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/GameView"),s=e("../../StaticData/ChatChannelTableData"),c=e("../../network/protocol/long"),l=e("../../network/ClientNetwork"),d=e("../../network/protocol/ChatProtocols"),u=e("../../common/PlayerModule"),h=e("../../network/protocol/TypeProtocols"),p=e("../../Global/GameGlobal"),f=e("../../utils/ConfigUtils"),g=e("../../StaticData/StringValueTableData"),m=e("../../utils/GamePlatform"),_=e("../../combat/CombatManager"),y=e("../../utils/ResourcesManager"),v=e("../../utils/GameUtils"),C=e("../../network/protocol/FriendProtocls"),S=e("../../utils/DalanReportUtils"),T=e("../../utils/QQGameHallUtils"),I=e("../../utils/KSMinigameUtils"),N=e("../../utils/GameTools"),b=e("../../utils/UIManager"),w=e("../../network/LocalMessage"),E=e("../../network/protocol/MatchProtocols"),P=e("../../common/EventConst"),R=e("../../modules/manager/EventManager"),L=e("../../common/CommandValue"),A=e("../../network/protocol/RoleProtocols"),D=e("../../common/CommandValue"),M=e("../sociaty/SociatyModel"),B=cc._decorator,k=B.ccclass,G=B.property,O=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.systemPanelNode=null,t.worldPanelNode=null,t.teamPanelNode=null,t.friendPanelNode=null,t.activityPanelNode=null,t.weekCoopPanelNode=null,t.SociatyChatPanelNode=null,t.editBoxNode=null,t.sendNode=null,t.friendSendBtnNode=null,t.teamSendBtnNode=null,t.systemSendBtnNode=null,t.activitySendBtnNode=null,t.weekCoopSendBtnNode=null,t.SociatyChatSendBtnNode=null,t.friendChatTipLab=null,t.emojiNode=null,t._editboxString="",t._curChatChannel=h.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_SYSTEM,t._sendCdTime=0,t.m_systemCd=0,t.m_disable_time=0,t.m_activityCd=0,t.m_weekCoopCd=0,t}return a(t,e),t.prototype.onLoad=function(){var e=this,t=new C.C_Friend_GetBlackList;l.ClientNetwork.getInstance().Send(C.FRIEND_CLIENT_ENUM.P_Friend_GetBlackList,t),this.initEmojiInfo(),this.schedule(function(){e.onCountdownSendTime()},1),this.onListenProtocolEvent()},t.prototype.onEnable=function(){if(!(this.m_disable_time<=0)){var e=u.default.getServersTime()-this.m_disable_time;this.m_systemCd>0&&(this.m_systemCd-=e,this.m_systemCd<=0&&(this.systemSendBtnNode.getChildByName("button").active=!0,this.systemSendBtnNode.getChildByName("cd").active=!1)),this._sendCdTime>0&&(this._sendCdTime-=e,this._sendCdTime<=0&&(this.sendNode.getChildByName("button").active=!0,this.sendNode.getChildByName("cd").active=!1)),this.m_activityCd>0&&(this.m_activityCd-=e,this.m_activityCd<=0&&(this.activitySendBtnNode.getChildByName("button").active=!0,this.activitySendBtnNode.getChildByName("cd").active=!1)),this.m_weekCoopCd>0&&(this.m_weekCoopCd-=e,this.m_weekCoopCd<=0&&(this.weekCoopSendBtnNode.getChildByName("button").active=!0,this.weekCoopSendBtnNode.getChildByName("cd").active=!1)),M.default.instance().SendChatCd>0&&(M.default.instance().SendChatCd-=e,M.default.instance().SendChatCd<=0&&(this.SociatyChatSendBtnNode.getChildByName("button").active=!0,this.SociatyChatSendBtnNode.getChildByName("cd").active=!1))}},t.prototype.onDisable=function(){this.m_disable_time=u.default.getServersTime()},t.prototype.onTouchEndCloseEmoji=function(e){this.emojiNode.getBoundingBoxToWorld().contains(e)||(this.emojiNode.active=!1)},t.prototype.initEmojiInfo=function(){var e=this,t=[],o=f.default.getInstance().data["StaticData/ItemTableData"];for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&6===o[i].type&&t.push(o[i]);for(var a=this.node.getChildByName("EmojiNode").getChildByName("EmojiLayout"),n=0;n<a.children.length;n++){var r=a.children[n];r.emojiId=t[n].id,y.default.loadSprite(t[n].icon,r.getComponent(cc.Sprite)),r.on(cc.Node.EventType.TOUCH_END,function(t){e._curChatChannel==h.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_WORLD||e._curChatChannel==h.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_SYSTEM||e._curChatChannel==h.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_ACTIVITY||e._curChatChannel==h.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_WEEK_COOPERATION||e._curChatChannel==h.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_SOCIATY?e.onSendCallEmoji(t.target.emojiId,c.fromNumber(0)):e._curChatChannel==h.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_TEAM?_.getInstance()&&_.getInstance().getController()&&_.getInstance().getController().fightCardViewScript&&_.getInstance().getController().fightCardViewScript.onCallFightExpression({type:2,contenId:0,msg:t.target.emojiId}):e.onSendCallEmoji(t.target.emojiId,e.friendPanelNode.getComponent("FriendChatPanel").selectFriendId)})}},t.prototype.setShowChannelTab=function(e){var t=this.node.getChildByName("ToggleContainer");t.children.forEach(function(e){e.active=!1}),e.forEach(function(e){t.getChildByName("channe_"+e).active=!0})},t.prototype.setChatChannel=function(e,t){void 0===t&&(t=null),this.weekCoopPanelNode.active=!1,this.activityPanelNode.active=!1,this.systemPanelNode.active=!1,this.friendPanelNode.active=!1,this.worldPanelNode.active=!1,this.teamPanelNode.active=!1,this.friendChatTipLab.active=!1,this.SociatyChatPanelNode.active=!1;var o=this.node.getChildByName("ToggleContainer");if(o.getChildByName("channe_"+e).getComponent(cc.Toggle).check(),o.getChildByName("channe_"+e).getComponent(cc.Toggle).isChecked=!0,o.children.forEach(function(t){t.name!="channe_"+e&&1==t.getComponent(cc.Toggle).isChecked&&(t.getComponent(cc.Toggle).uncheck(),t.getComponent(cc.Toggle).isChecked=!1)}),this.editBoxNode.getComponent(cc.EditBox).placeholderLabel.string="\u70b9\u51fb\u8f93\u5165\u5185\u5bb9",this.editBoxNode.getComponent(cc.EditBox).string="",this._editboxString="",this.teamSendBtnNode.active=!1,this.friendSendBtnNode.active=!1,this.sendNode.active=!1,this.systemSendBtnNode.active=!1,this.activitySendBtnNode.active=!1,this.weekCoopSendBtnNode.active=!1,this.SociatyChatSendBtnNode.active=!1,h.CHAT_CHANNEL_GROUP_TYPE.CHAT_CHANNEL_WORLD_GROUP===e){this.worldPanelNode.active=!0,this.sendNode.active=!0;var i=u.default.getWorldChatCount()-u.default.getRoleAttrValByKey(h.ROLE_ATTR_VALUES.ROLE_ATTR_DAY_WORLD_CHAT_NUM);(isNaN(i)||i<0)&&(i=0),this.editBoxNode.getComponent(cc.EditBox).placeholderLabel.string="\u4eca\u65e5\u5269\u4f59\u53ef\u53d1\u8a00\u6b21\u6570\uff1a"+i;var a=s.ChatChannelTableData.getById(e).conditionMaxScore;u.default.getRoleAttrValByKey(h.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE)<=a&&(this.editBoxNode.getComponent(cc.EditBox).placeholderLabel.string="\u8fbe\u5230"+a+"\u676f\u4ee5\u4e0a\u65b9\u53ef\u53d1\u8a00"),this.callChangeChatStatus(1)}else if(h.CHAT_CHANNEL_GROUP_TYPE.CHAT_CHANNEL_SYSTEM_GROUP===e)this.systemPanelNode.active=!0,this.systemSendBtnNode.active=!0,i=u.default.getSystemChatCount()-u.default.getRoleAttrValByKey(h.ROLE_ATTR_VALUES.ROLE_ATTR_DAY_LOCAL_CHAT_NUM),(isNaN(i)||i<0)&&(i=0),this.editBoxNode.getComponent(cc.EditBox).placeholderLabel.string="\u4eca\u65e5\u5269\u4f59\u53ef\u53d1\u8a00\u6b21\u6570\uff1a"+i,a=s.ChatChannelTableData.getById(e).conditionMaxScore,u.default.getRoleAttrValByKey(h.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE)<=a&&(this.editBoxNode.getComponent(cc.EditBox).placeholderLabel.string="\u8fbe\u5230"+a+"\u676f\u4ee5\u4e0a\u65b9\u53ef\u53d1\u8a00"),this.callChangeChatStatus(0);else if(h.CHAT_CHANNEL_GROUP_TYPE.CHAT_CHANNEL_PRIVATE_GROUP===e){var n=u.default.getPrivateChatSimData();if(t){var r=new d.T_Chat_PrivateChatSimData;r.nickName=t.nickName,r.headID=t.headID,r.headUrl=t.headUrl,r.headFrameID=t.headFrameID,r.noReadNum=0,n.set(t.roleID,r)}0==this.friendPanelNode.active&&(this.friendPanelNode.active=!0),t&&this.friendPanelNode.getComponent("FriendChatPanel").addChatTargetData(t),this.friendSendBtnNode.active=!0,n.size<=0&&(this.friendChatTipLab.active=!0),u.default.getRoleAttrValByKey(h.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE)<=Number(v.getConfigIntValue("chat_limit_cup_count"))&&(this.editBoxNode.getComponent(cc.EditBox).placeholderLabel.string="\u8fbe\u5230"+v.getConfigIntValue("chat_limit_cup_count")+"\u676f\u4ee5\u4e0a\u65b9\u53ef\u53d1\u8a00"),this.callChangeChatStatus(0)}else h.CHAT_CHANNEL_GROUP_TYPE.CHAT_CHANNEL_TEAM_GROUP===e?(this.teamPanelNode.active=!0,this.teamSendBtnNode.active=!0,this.callChangeChatStatus(0)):h.CHAT_CHANNEL_GROUP_TYPE.CHAT_CHANNEL_ACTICITY_GROUP==e?(this.activityPanelNode.active=!0,this.activitySendBtnNode.active=!0,i=u.default.getActivityChatCount()-u.default.getRoleAttrValByKey(h.ROLE_ATTR_VALUES.ROLE_ATTR_DAY_ACTIVITY_CHAT_NUM),(isNaN(i)||i<0)&&(i=0),this.editBoxNode.getComponent(cc.EditBox).placeholderLabel.string="\u4eca\u65e5\u5269\u4f59\u53ef\u53d1\u8a00\u6b21\u6570\uff1a"+i,a=s.ChatChannelTableData.getById(e).conditionMaxScore,u.default.getRoleAttrValByKey(h.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE)<=a&&(this.editBoxNode.getComponent(cc.EditBox).placeholderLabel.string="\u8fbe\u5230"+a+"\u676f\u4ee5\u4e0a\u65b9\u53ef\u53d1\u8a00")):h.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_WEEK_COOPERATION==e?(this.weekCoopPanelNode.active=!0,this.weekCoopSendBtnNode.active=!0,i=u.default.getWeekCoopChatCount()-u.default.getRoleAttrValByKey(h.ROLE_ATTR_VALUES.ROLE_ATTR_DAY_WEEK_COOPERATION_CHAT_NUM),(isNaN(i)||i<0)&&(i=0),this.editBoxNode.getComponent(cc.EditBox).placeholderLabel.string="\u4eca\u65e5\u5269\u4f59\u53ef\u53d1\u8a00\u6b21\u6570\uff1a"+i,a=s.ChatChannelTableData.getById(e).conditionMaxScore,u.default.getRoleAttrValByKey(h.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE)<=a&&(this.editBoxNode.getComponent(cc.EditBox).placeholderLabel.string="\u8fbe\u5230"+a+"\u676f\u4ee5\u4e0a\u65b9\u53ef\u53d1\u8a00")):h.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_SOCIATY==e&&(this.SociatyChatPanelNode.active=!0,this.SociatyChatSendBtnNode.active=!0);this._curChatChannel=e;var c=u.default.checkModulerOnOffState(D.ModulerViewOnOff.SystemAndFriendToFight);p.G.UIManager.getCurSceneName()!=b.SceneName.MainScene&&0==c&&(o.getChildByName("channe_1").active=!1,o.getChildByName("channe_2").active=!1,o.getChildByName("channe_3").active=!1,o.getChildByName("channe_9").active=!1,this.friendSendBtnNode.active=!1,this.sendNode.active=!1,this.systemSendBtnNode.active=!1,this.activitySendBtnNode.active=!1)},t.prototype.onCloseCallBack=function(){R.default.Instance.emit(P.default.SyncChatViewChange,L.ChatViewVisible.Retracting)},t.prototype.onClickToggleCallBack=function(e,t){this.setChatChannel(Number(t))},t.prototype.onSendCallEmoji=function(e,t){if(this._curChatChannel==h.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_WORLD){if(this._sendCdTime>0)return p.G.StringManager.PopString("\u8bf7\u4e0d\u8981\u8fde\u7eed\u53d1\u9001\u6d88\u606f\uff01");if(u.default.getRoleAttrValByKey(h.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE)<=s.ChatChannelTableData.getById(this._curChatChannel).conditionMaxScore)return p.G.StringManager.PopString(p.G.StringManager.getString("CHAT_CONDITION_TIP",s.ChatChannelTableData.getById(this._curChatChannel).conditionMaxScore));if(u.default.getRoleAttrValByKey(h.ROLE_ATTR_VALUES.ROLE_ATTR_DAY_WORLD_CHAT_NUM)>=u.default.getWorldChatCount())return p.G.StringManager.PopString(p.G.StringManager.getString("CHAT_WORLD_CONDITION_TIP1"));this.sendNode.getChildByName("button").active=!1,this._sendCdTime=s.ChatChannelTableData.getById(this._curChatChannel).cd}if(this._curChatChannel===h.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_PRIVATE&&u.default.getRoleAttrValByKey(h.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE)<=Number(v.getConfigIntValue("chat_limit_cup_count")))return p.G.StringManager.PopString(p.G.StringManager.getString("CHAT_CONDITION_TIP",Number(v.getConfigIntValue("chat_limit_cup_count"))));if(this._curChatChannel===h.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_SYSTEM){if(this.m_systemCd>0)return p.G.StringManager.PopString("\u8bf7\u4e0d\u8981\u8fde\u7eed\u53d1\u9001\u6d88\u606f\uff01");if(u.default.getRoleAttrValByKey(h.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE)<=s.ChatChannelTableData.getById(this._curChatChannel).conditionMaxScore)return p.G.StringManager.PopString(p.G.StringManager.getString("CHAT_CONDITION_TIP",s.ChatChannelTableData.getById(this._curChatChannel).conditionMaxScore));if(u.default.getRoleAttrValByKey(h.ROLE_ATTR_VALUES.ROLE_ATTR_DAY_LOCAL_CHAT_NUM)>=u.default.getSystemChatCount())return p.G.StringManager.PopString(p.G.StringManager.getString("CHAT_SYSTEM_CONDITION_TIP1"));this.systemSendBtnNode.getChildByName("button").active=!1,this.m_systemCd=s.ChatChannelTableData.getById(this._curChatChannel).cd}if(this._curChatChannel===h.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_ACTIVITY){if(this.m_activityCd>0)return p.G.StringManager.PopString("\u8bf7\u4e0d\u8981\u8fde\u7eed\u53d1\u9001\u6d88\u606f\uff01");if(u.default.getRoleAttrValByKey(h.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE)<=s.ChatChannelTableData.getById(this._curChatChannel).conditionMaxScore)return p.G.StringManager.PopString(p.G.StringManager.getString("CHAT_CONDITION_TIP",s.ChatChannelTableData.getById(this._curChatChannel).conditionMaxScore));if(u.default.getRoleAttrValByKey(h.ROLE_ATTR_VALUES.ROLE_ATTR_DAY_ACTIVITY_CHAT_NUM)>=u.default.getActivityChatCount())return p.G.StringManager.PopString(p.G.StringManager.getString("CHAT_ACTIVITY_CONDITION_TIP1"));this.activitySendBtnNode.getChildByName("button").active=!1,this.m_activityCd=s.ChatChannelTableData.getById(this._curChatChannel).cd}if(this._curChatChannel===h.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_WEEK_COOPERATION){if(this.m_weekCoopCd>0)return p.G.StringManager.PopString("\u8bf7\u4e0d\u8981\u8fde\u7eed\u53d1\u9001\u6d88\u606f\uff01");if(u.default.getRoleAttrValByKey(h.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE)<=s.ChatChannelTableData.getById(this._curChatChannel).conditionMaxScore)return p.G.StringManager.PopString(p.G.StringManager.getString("CHAT_CONDITION_TIP",s.ChatChannelTableData.getById(this._curChatChannel).conditionMaxScore));if(u.default.getRoleAttrValByKey(h.ROLE_ATTR_VALUES.ROLE_ATTR_DAY_WEEK_COOPERATION_CHAT_NUM)>=u.default.getWeekCoopChatCount())return p.G.StringManager.PopString(p.G.StringManager.getString("CHAT_WEEKCOOP_CONDITION_TIP1"));this.weekCoopSendBtnNode.getChildByName("button").active=!1,this.m_weekCoopCd=s.ChatChannelTableData.getById(this._curChatChannel).cd}if(this._curChatChannel===h.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_SOCIATY){if(M.default.instance().SendChatCd>0)return p.G.StringManager.PopWorldString("chat_cd");M.default.instance().SendChatCd=Number(v.getConfigIntValue("cd_union_chat")),this.SociatyChatSendBtnNode.getChildByName("button").active=!1}var o=new d.C_Chat_Client;o.channel=this._curChatChannel,o.isSendSelf=!1,o.receiveRoleID=t,o.chatType=h.TYPE_CHAT.TYPE_CHAT_EXPRESSION,o.chatText=e.toString(),o.chatParam=0,o.isLiveState=0,l.ClientNetwork.getInstance().Send(d.CHAT_CLIENT_ENUM.P_Chat_Client,o)},t.prototype.onSendBtnCallBack=function(){if(this._editboxString=this.editBoxNode.getComponent(cc.EditBox).string,this._editboxString.length<=0)return p.G.StringManager.PopString(g.StringValueTableData.getById(18).string_value);switch(this._curChatChannel){case h.CHAT_CHANNEL_GROUP_TYPE.CHAT_CHANNEL_SOCIATY_GROUP:case h.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_WEEK_COOPERATION:case h.CHAT_CHANNEL_GROUP_TYPE.CHAT_CHANNEL_ACTICITY_GROUP:case h.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_SYSTEM:case h.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_WORLD:if(m.GamePlatform.isQQGameRoom()){var e=this;T.QQGameHallUtils.Instance.chatFilterAsync(this._editboxString,T.QQGameHallUtils.CHAT_FILTER_SCENETYPE_MSG).then(function(t){console.log("\u804a\u5929\u654f\u611f\u8bcd\u8fd4\u56de\uff0c\u4e16\u754cresponse=",t),e.onSendChatMsg({channel:e._curChatChannel,receiveRoleID:c.fromNumber(0),chatType:1,msg:""==t?e._editboxString:t})})}else if(m.GamePlatform.isKuaishouMiniGame()){var t=this;I.KSMinigameUtils.Instance.chatFilterAsync(this._editboxString,I.KSMinigameUtils.CHAT_FILTER_SCENETYPE_MSG).then(function(e){1==e?p.G.StringManager.PopStringOnce("\u5185\u5bb9\u542b\u6709\u8fdd\u89c4\u5185\u5bb9"):t.onSendChatMsg({channel:t._curChatChannel,receiveRoleID:c.fromNumber(0),chatType:1,msg:t._editboxString})})}else this.onSendChatMsg({channel:this._curChatChannel,receiveRoleID:c.fromNumber(0),chatType:1,msg:this._editboxString});break;case h.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_TEAM:_.getInstance()&&_.getInstance().getController()&&_.getInstance().getController().fightCardViewScript&&_.getInstance().getController().fightCardViewScript.onCallFightExpression({type:1,contenId:0,msg:this._editboxString});break;case h.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_PRIVATE:if(m.GamePlatform.isQQGameRoom()){var o=this;T.QQGameHallUtils.Instance.chatFilterAsync(this._editboxString,T.QQGameHallUtils.CHAT_FILTER_SCENETYPE_MSG).then(function(e){console.log("\u804a\u5929\u654f\u611f\u8bcd\u8fd4\u56de\uff0c\u79c1\u804aresponse=",e),o.onSendChatMsg({channel:o._curChatChannel,receiveRoleID:o.friendPanelNode.getComponent("FriendChatPanel").selectFriendId,chatType:1,msg:""==e?o._editboxString:e})})}else if(m.GamePlatform.isKuaishouMiniGame()){var i=this;I.KSMinigameUtils.Instance.chatFilterAsync(this._editboxString,I.KSMinigameUtils.CHAT_FILTER_SCENETYPE_MSG).then(function(e){1==e?p.G.StringManager.PopStringOnce("\u5185\u5bb9\u542b\u6709\u8fdd\u89c4\u5185\u5bb9"):i.onSendChatMsg({channel:i._curChatChannel,receiveRoleID:i.friendPanelNode.getComponent("FriendChatPanel").selectFriendId,chatType:1,msg:i._editboxString})})}else this.onSendChatMsg({channel:this._curChatChannel,receiveRoleID:this.friendPanelNode.getComponent("FriendChatPanel").selectFriendId,chatType:1,msg:this._editboxString})}},t.prototype.doSendMsgToWorld=function(e){void 0===e&&(e=""),this.onSendChatMsg({channel:this._curChatChannel,receiveRoleID:c.fromNumber(0),chatType:1,msg:""==e?this._editboxString:e})},t.prototype.doSendMsgToPrivate=function(e){void 0===e&&(e=""),this.onSendChatMsg({channel:this._curChatChannel,receiveRoleID:this.friendPanelNode.getComponent("FriendChatPanel").selectFriendId,chatType:1,msg:""==e?this._editboxString:e})},t.prototype.onClickEmojiCallBack=function(){0==this.emojiNode.active?this.emojiNode.active=!0:this.emojiNode.active=!1},t.prototype.onEditingReturnCallBack=function(e){e.string.length<=0||(this._editboxString=e.string)},t.prototype.onSendChatMsg=function(e){if(e.msg.length<=0)return p.G.StringManager.PopString(g.StringValueTableData.getById(18).string_value);if(e.channel===h.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_PRIVATE){if(u.default.getRoleAttrValByKey(h.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE)<=Number(v.getConfigIntValue("chat_limit_cup_count")))return p.G.StringManager.PopString(p.G.StringManager.getString("CHAT_CONDITION_TIP",Number(v.getConfigIntValue("chat_limit_cup_count"))));if(u.default.getPrivateChatSimData().size<=0)return p.G.StringManager.PopString("\u6ca1\u6709\u9009\u62e9\u804a\u5929\u76ee\u6807\uff01");this.editBoxNode.getComponent(cc.EditBox).string="",this._editboxString=""}else if(e.channel===h.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_WORLD){if(u.default.getRoleAttrValByKey(h.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE)<=s.ChatChannelTableData.getById(this._curChatChannel).conditionMaxScore)return p.G.StringManager.PopString(p.G.StringManager.getString("CHAT_CONDITION_TIP",s.ChatChannelTableData.getById(this._curChatChannel).conditionMaxScore));if(u.default.getRoleAttrValByKey(h.ROLE_ATTR_VALUES.ROLE_ATTR_DAY_WORLD_CHAT_NUM)>=u.default.getWorldChatCount())return p.G.StringManager.PopString(p.G.StringManager.getString("CHAT_WORLD_CONDITION_TIP1"));var t=u.default.getWorldChatCount()-u.default.getRoleAttrValByKey(h.ROLE_ATTR_VALUES.ROLE_ATTR_DAY_WORLD_CHAT_NUM);(isNaN(t)||t<0)&&(t=0),this.editBoxNode.getComponent(cc.EditBox).placeholderLabel.string="\u4eca\u65e5\u5269\u4f59\u53ef\u53d1\u8a00\u6b21\u6570\uff1a"+t,this._editboxString=""}else if(e.channel===h.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_SYSTEM){if(u.default.getRoleAttrValByKey(h.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE)<=s.ChatChannelTableData.getById(this._curChatChannel).conditionMaxScore)return p.G.StringManager.PopString(p.G.StringManager.getString("CHAT_CONDITION_TIP",s.ChatChannelTableData.getById(this._curChatChannel).conditionMaxScore));if(u.default.getRoleAttrValByKey(h.ROLE_ATTR_VALUES.ROLE_ATTR_DAY_LOCAL_CHAT_NUM)>=u.default.getSystemChatCount())return p.G.StringManager.PopString(p.G.StringManager.getString("CHAT_SYSTEM_CONDITION_TIP1"));t=u.default.getSystemChatCount()-u.default.getRoleAttrValByKey(h.ROLE_ATTR_VALUES.ROLE_ATTR_DAY_LOCAL_CHAT_NUM),(isNaN(t)||t<0)&&(t=0),this.editBoxNode.getComponent(cc.EditBox).placeholderLabel.string="\u4eca\u65e5\u5269\u4f59\u53ef\u53d1\u8a00\u6b21\u6570\uff1a"+t,this._editboxString=""}else if(1==this.checkMsgIsActivityChannel(e.channel)){if(u.default.getRoleAttrValByKey(h.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE)<=s.ChatChannelTableData.getById(e.channel).conditionMaxScore)return p.G.StringManager.PopString(p.G.StringManager.getString("CHAT_CONDITION_TIP",s.ChatChannelTableData.getById(e.channel).conditionMaxScore));if(u.default.getRoleAttrValByKey(h.ROLE_ATTR_VALUES.ROLE_ATTR_DAY_ACTIVITY_CHAT_NUM)>=u.default.getActivityChatCount())return p.G.StringManager.PopString(p.G.StringManager.getString("CHAT_ACTIVITY_CONDITION_TIP1"));t=u.default.getActivityChatCount()-u.default.getRoleAttrValByKey(h.ROLE_ATTR_VALUES.ROLE_ATTR_DAY_ACTIVITY_CHAT_NUM),(isNaN(t)||t<0)&&(t=0),this.editBoxNode.getComponent(cc.EditBox).placeholderLabel.string="\u4eca\u65e5\u5269\u4f59\u53ef\u53d1\u8a00\u6b21\u6570\uff1a"+t,this._editboxString=""}else if(e.channel===h.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_WEEK_COOPERATION){if(u.default.getRoleAttrValByKey(h.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE)<=s.ChatChannelTableData.getById(e.channel).conditionMaxScore)return p.G.StringManager.PopString(p.G.StringManager.getString("CHAT_CONDITION_TIP",s.ChatChannelTableData.getById(e.channel).conditionMaxScore));if(u.default.getRoleAttrValByKey(h.ROLE_ATTR_VALUES.ROLE_ATTR_DAY_WEEK_COOPERATION_CHAT_NUM)>=u.default.getWeekCoopChatCount())return p.G.StringManager.PopString(p.G.StringManager.getString("CHAT_ACTIVITY_CONDITION_TIP1"));t=u.default.getWeekCoopChatCount()-u.default.getRoleAttrValByKey(h.ROLE_ATTR_VALUES.ROLE_ATTR_DAY_WEEK_COOPERATION_CHAT_NUM),(isNaN(t)||t<0)&&(t=0),this.editBoxNode.getComponent(cc.EditBox).placeholderLabel.string="\u4eca\u65e5\u5269\u4f59\u53ef\u53d1\u8a00\u6b21\u6570\uff1a"+t,this._editboxString=""}else e.channel===h.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_SOCIATY&&(this.editBoxNode.getComponent(cc.EditBox).string="",this._editboxString="");var o=new d.C_Chat_Client;if(o.channel=e.channel,o.isSendSelf=!1,o.receiveRoleID=e.receiveRoleID,o.chatType=e.chatType,o.chatText=e.msg,o.chatParam=0,o.isLiveState=0,l.ClientNetwork.getInstance().Send(d.CHAT_CLIENT_ENUM.P_Chat_Client,o),h.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_WORLD===this._curChatChannel?(this.sendNode.getChildByName("button").active=!1,this._sendCdTime=s.ChatChannelTableData.getById(this._curChatChannel).cd):h.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_SYSTEM===this._curChatChannel?(this.systemSendBtnNode.getChildByName("button").active=!1,this.m_systemCd=s.ChatChannelTableData.getById(this._curChatChannel).cd):h.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_ACTIVITY===e.channel?(this.activitySendBtnNode.getChildByName("button").active=!1,this.m_activityCd=s.ChatChannelTableData.getById(e.channel).cd):h.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_WEEK_COOPERATION===e.channel?(this.weekCoopSendBtnNode.getChildByName("button").active=!1,this.m_weekCoopCd=s.ChatChannelTableData.getById(e.channel).cd):h.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_SOCIATY===e.channel&&(M.default.instance().SendChatCd=Number(v.getConfigIntValue("cd_union_chat")),this.SociatyChatSendBtnNode.getChildByName("button").active=!1),"bigBlue"==m.GamePlatform.getMiYaVideoTypeNoSet()){var i=-1;e.channel==h.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_PRIVATE?i=S.DalanReportUtils.REPORT_CHAT_CHANNEL_PRIVATE:e.channel==h.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_WORLD&&(i=S.DalanReportUtils.REPORT_CHAT_CHANNEL_WORLD),i>=0&&S.DalanReportUtils.Instance.reprot_chat(i,e.msg)}},t.prototype.onCountdownSendTime=function(){this.m_systemCd>0&&(this.m_systemCd--,this.m_systemCd<10?this.systemSendBtnNode.getChildByName("cd").getComponent(cc.Label).string="0"+this.m_systemCd+"s":this.systemSendBtnNode.getChildByName("cd").getComponent(cc.Label).string=this.m_systemCd+"s",this.systemSendBtnNode.getChildByName("cd").active=!0,this.m_systemCd<=0&&(this.systemSendBtnNode.getChildByName("button").active=!0,this.systemSendBtnNode.getChildByName("cd").active=!1)),this._sendCdTime>0&&(this._sendCdTime--,this._sendCdTime<10?this.sendNode.getChildByName("cd").getComponent(cc.Label).string="0"+this._sendCdTime+"s":this.sendNode.getChildByName("cd").getComponent(cc.Label).string=this._sendCdTime+"s",this.sendNode.getChildByName("cd").active=!0,this._sendCdTime<=0&&(this.sendNode.getChildByName("button").active=!0,this.sendNode.getChildByName("cd").active=!1)),this.m_activityCd>0&&(this.m_activityCd--,this.m_activityCd<10?this.activitySendBtnNode.getChildByName("cd").getComponent(cc.Label).string="0"+this.m_activityCd+"s":this.activitySendBtnNode.getChildByName("cd").getComponent(cc.Label).string=this.m_activityCd+"s",this.activitySendBtnNode.getChildByName("cd").active=!0,this.m_activityCd<=0&&(this.activitySendBtnNode.getChildByName("button").active=!0,this.activitySendBtnNode.getChildByName("cd").active=!1)),this.m_weekCoopCd>0&&(this.m_weekCoopCd--,this.m_weekCoopCd<10?this.weekCoopSendBtnNode.getChildByName("cd").getComponent(cc.Label).string="0"+this.m_weekCoopCd+"s":this.weekCoopSendBtnNode.getChildByName("cd").getComponent(cc.Label).string=this.m_weekCoopCd+"s",this.weekCoopSendBtnNode.getChildByName("cd").active=!0,this.m_weekCoopCd<=0&&(this.weekCoopSendBtnNode.getChildByName("button").active=!0,this.weekCoopSendBtnNode.getChildByName("cd").active=!1)),M.default.instance().SendChatCd>0&&(M.default.instance().SendChatCd--,M.default.instance().SendChatCd<10?this.SociatyChatSendBtnNode.getChildByName("cd").getComponent(cc.Label).string="0"+M.default.instance().SendChatCd+"s":this.SociatyChatSendBtnNode.getChildByName("cd").getComponent(cc.Label).string=M.default.instance().SendChatCd+"s",this.SociatyChatSendBtnNode.getChildByName("cd").active=!0,M.default.instance().SendChatCd<=0&&(this.SociatyChatSendBtnNode.getChildByName("button").active=!0,this.SociatyChatSendBtnNode.getChildByName("cd").active=!1))},t.prototype.onListenProtocolEvent=function(){var e=this,t=this;l.ClientNetwork.getInstance().listenLocalMessage(w.LOCAL_MESSAGE.LocalMsg_SystemCallFriendAddBlack,function(e){t.callFriendAddBlackList(e[0].roleid,e[0].roleName,e[0].roleScore)},this),l.ClientNetwork.getInstance().listenProtocol(E.MATCH_CLIENT_ENUM.P_Match_Duel_Fight,function(e){e.resetPos();var t=new E.S_Match_Duel_Fight;t.read(e)&&0!=t.errorcode&&(9===t.errorcode?p.G.StringManager.PopStringOnce(p.G.StringManager.getString("COOP_TIMES_NOTENOUGH")):13===t.errorcode?p.G.StringManager.PopStringOnce(p.G.StringManager.getString("MATCH_ROOM_FAIL_HAVE")):18===t.errorcode?p.G.StringManager.PopWorldString(p.G.StringManager.getWorldString("sky_battle_score_limit_tip2")):19===t.errorcode?p.G.StringManager.PopString(p.G.StringManager.getString("MACHINERYCITY_TIP4")):8089===t.errorcode&&r.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:p.G.StringManager.getString("BATTLE_VERSION_NOT_MATCH"),confirmCb:function(){m.GamePlatform.isWechat()?wx.exitMiniProgram():m.GamePlatform.isQQMiniGame()&&qq.exitMiniProgram()}}))},this),l.ClientNetwork.getInstance().listenProtocol(d.CHAT_CLIENT_ENUM.P_Chat_Client,function(t){t.resetPos();var o=new d.S_Chat_Client;if(o.read(t))if(0===o.errorcode)if(e.editBoxNode.getComponent(cc.EditBox).string="",e._editboxString="",1==e.emojiNode.active&&(e.emojiNode.active=!1),e._curChatChannel==h.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_SYSTEM){var i=u.default.getSystemChatCount()-u.default.getRoleAttrValByKey(h.ROLE_ATTR_VALUES.ROLE_ATTR_DAY_LOCAL_CHAT_NUM);(isNaN(i)||i<0)&&(i=0),e.editBoxNode.getComponent(cc.EditBox).placeholderLabel.string="\u4eca\u65e5\u5269\u4f59\u53ef\u53d1\u8a00\u6b21\u6570\uff1a"+i;var a=s.ChatChannelTableData.getById(e._curChatChannel).conditionMaxScore;u.default.getRoleAttrValByKey(h.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE)<=a&&(e.editBoxNode.getComponent(cc.EditBox).placeholderLabel.string="\u8fbe\u5230"+a+"\u676f\u4ee5\u4e0a\u65b9\u53ef\u53d1\u8a00")}else e._curChatChannel==h.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_WORLD?(i=u.default.getWorldChatCount()-u.default.getRoleAttrValByKey(h.ROLE_ATTR_VALUES.ROLE_ATTR_DAY_WORLD_CHAT_NUM),(isNaN(i)||i<0)&&(i=0),e.editBoxNode.getComponent(cc.EditBox).placeholderLabel.string="\u4eca\u65e5\u5269\u4f59\u53ef\u53d1\u8a00\u6b21\u6570\uff1a"+i,a=s.ChatChannelTableData.getById(e._curChatChannel).conditionMaxScore,u.default.getRoleAttrValByKey(h.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE)<=a&&(e.editBoxNode.getComponent(cc.EditBox).placeholderLabel.string="\u8fbe\u5230"+a+"\u676f\u4ee5\u4e0a\u65b9\u53ef\u53d1\u8a00")):e._curChatChannel==h.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_ACTIVITY?(i=u.default.getActivityChatCount()-u.default.getRoleAttrValByKey(h.ROLE_ATTR_VALUES.ROLE_ATTR_DAY_ACTIVITY_CHAT_NUM),(isNaN(i)||i<0)&&(i=0),e.editBoxNode.getComponent(cc.EditBox).placeholderLabel.string="\u4eca\u65e5\u5269\u4f59\u53ef\u53d1\u8a00\u6b21\u6570\uff1a"+i,a=s.ChatChannelTableData.getById(e._curChatChannel).conditionMaxScore,u.default.getRoleAttrValByKey(h.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE)<=a&&(e.editBoxNode.getComponent(cc.EditBox).placeholderLabel.string="\u8fbe\u5230"+a+"\u676f\u4ee5\u4e0a\u65b9\u53ef\u53d1\u8a00")):e._curChatChannel==h.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_WEEK_COOPERATION&&(i=u.default.getWeekCoopChatCount()-u.default.getRoleAttrValByKey(h.ROLE_ATTR_VALUES.ROLE_ATTR_DAY_WEEK_COOPERATION_CHAT_NUM),(isNaN(i)||i<0)&&(i=0),e.editBoxNode.getComponent(cc.EditBox).placeholderLabel.string="\u4eca\u65e5\u5269\u4f59\u53ef\u53d1\u8a00\u6b21\u6570\uff1a"+i,a=s.ChatChannelTableData.getById(e._curChatChannel).conditionMaxScore,u.default.getRoleAttrValByKey(h.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE)<=a&&(e.editBoxNode.getComponent(cc.EditBox).placeholderLabel.string="\u8fbe\u5230"+a+"\u676f\u4ee5\u4e0a\u65b9\u53ef\u53d1\u8a00"));else switch(o.errorcode){case d.ErrorCode_Chat_Client.ErrorCode_Chat_Client_Failed:p.G.StringManager.PopString("\u53d1\u9001\u5931\u8d25");break;case d.ErrorCode_Chat_Client.ErrorCode_Chat_Client_ForbidChat:p.G.StringManager.PopString("\u60a8\u5df2\u88ab\u7981\u8a00");break;case d.ErrorCode_Chat_Client.ErrorCode_Chat_Client_LenError:p.G.StringManager.PopString("\u5185\u5bb9\u6587\u5b57\u8fc7\u957f");break;case d.ErrorCode_Chat_Client.ErrorCode_Chat_Client_HasFilterWords:p.G.StringManager.PopString(p.G.StringManager.getString("SEND_MESSAGE_FAIL"));break;default:p.G.StringManager.PopString("error "+o.errorcode.toString())}},this),l.ClientNetwork.getInstance().listenProtocol(C.FRIEND_CLIENT_ENUM.P_Friend_GetBlackList,function(e){e.resetPos();var t=new C.S_Friend_GetBlackList;t.read(e)&&0==t.errorcode&&u.default.setBlackFriendsData(t.blacklist)},this),l.ClientNetwork.getInstance().listenProtocol(d.CHAT_CLIENT_ENUM.P_Chat_ToClient,function(t){if(!m.GamePlatform.is_play_video){t.resetPos();var o=new d.S_Chat_ToClient;if(o.read(t)&&o._data){if(0==e.checkChannelVisible(o._data.channel))return;if(o._data.channel==h.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_WORLD){var i=u.default.getHistoryWorldChats(),a={};(y=u.default.getBlackFriendsData())&&y.size>=0&&(a=Array.from(y.keys()));for(var n=!1,s=0;s<a.length;s++)if(1==y.get(a[s]).base.roleID.equals(o._data.roleID)){n=!0;break}if(1==n)return void cc.log("\u9ed1\u540d\u5355\u6d88\u606f");var c=e.worldPanelNode.getComponent("WorldChatPanel");i.push(o._data),c.addMessage(i[i.length-1])}else if(o._data.channel==h.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_PRIVATE)if(1==e.friendPanelNode.active)e.friendPanelNode.getComponent("FriendChatPanel").addMessage(o._data),e.friendChatTipLab.active=!1;else{if(1==u.default.UUID.equals(o._data.roleID))return;var f,g=u.default.getPrivateChatSimData(),_=!1;g.forEach(function(e,t){1==t.equals(o._data.roleID)&&(_=!0)}),0==_?((f=new d.T_Chat_PrivateChatSimData).nickName=o._data.nickName,f.headID=o._data.headID,f.headUrl=o._data.headUrl,f.headFrameID=o._data.headFrameID,f.noReadNum=1,g.set(o._data.roleID,f)):(f=g.get(o._data.roleID))&&(f.noReadNum++,g.set(o._data.roleID,f)),e.friendChatTipLab.active=!1,(v=r.default.getViewByName("MainSceneView"))&&v.view&&v.view.onShowChatRedpoint(),p.G.UIManager.getCurSceneName()!=b.SceneName.MainScene&&l.ClientNetwork.getInstance().pushLocalMessage(w.LOCAL_MESSAGE.LocalMsg_RefreshCoopFriendChatRed)}else if(o._data.channel==h.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_SYSTEM){for(a={},(y=u.default.getBlackFriendsData())&&y.size>=0&&(a=Array.from(y.keys())),n=!1,s=0;s<a.length;s++)if(1==y.get(a[s]).base.roleID.equals(o._data.roleID)){n=!0;break}if(1==n)return;(v=r.default.getViewByName("MainSceneView"))&&v.view&&v.view.onShowNewMsg(o._data),e.systemPanelNode.getComponent("SystemChatPanel").addSystemChatMsg(o._data)}else if(1==e.checkMsgIsActivityChannel(o._data.channel)){for(a={},(y=u.default.getBlackFriendsData())&&y.size>=0&&(a=Array.from(y.keys())),n=!1,s=0;s<a.length;s++)if(1==y.get(a[s]).base.roleID.equals(o._data.roleID)){n=!0;break}if(1==n)return;(v=r.default.getViewByName("MainSceneView"))&&v.view&&v.view.onShowNewMsg(o._data),e.activityPanelNode.getComponent("ActivityChatPanel").addChatMsg(o._data)}else if(o._data.channel==h.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_WEEK_COOPERATION){var y,v;for(a={},(y=u.default.getBlackFriendsData())&&y.size>=0&&(a=Array.from(y.keys())),n=!1,s=0;s<a.length;s++)if(1==y.get(a[s]).base.roleID.equals(o._data.roleID)){n=!0;break}if(1==n)return;(v=r.default.getViewByName("MainSceneView"))&&v.view&&v.view.onShowNewMsg(o._data),e.weekCoopPanelNode.getComponent("WeekCooperationChatPanel").addChatMsg(o._data)}}}},this)},t.prototype.onClearEditBoxString=function(){this.editBoxNode.getComponent(cc.EditBox).string="",this._editboxString="",1==this.emojiNode.active&&(this.emojiNode.active=!1)},t.prototype.callFriendAddBlackList=function(e,t,o){cc.isValid(this.node)&&(this._curChatChannel!=h.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_SYSTEM&&this._curChatChannel!=h.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_ACTIVITY&&this._curChatChannel!=h.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_WEEK_COOPERATION||1!=this.node.active||N.default.callSystemAddBlackList(e,t,o))},t.prototype.checkChannelVisible=function(e){var t=!1,o=this.node.getChildByName("ToggleContainer");switch(e){case h.CHAT_CHANNEL_GROUP_TYPE.CHAT_CHANNEL_SYSTEM_GROUP:t=o.getChildByName("channe_"+h.CHAT_CHANNEL_GROUP_TYPE.CHAT_CHANNEL_SYSTEM_GROUP).active;break;case h.CHAT_CHANNEL_GROUP_TYPE.CHAT_CHANNEL_WORLD_GROUP:t=o.getChildByName("channe_"+h.CHAT_CHANNEL_GROUP_TYPE.CHAT_CHANNEL_WORLD_GROUP).active;break;case h.CHAT_CHANNEL_GROUP_TYPE.CHAT_CHANNEL_PRIVATE_GROUP:t=o.getChildByName("channe_"+h.CHAT_CHANNEL_GROUP_TYPE.CHAT_CHANNEL_PRIVATE_GROUP).active;break;case h.CHAT_CHANNEL_GROUP_TYPE.CHAT_CHANNEL_TEAM_GROUP:t=o.getChildByName("channe_"+h.CHAT_CHANNEL_GROUP_TYPE.CHAT_CHANNEL_TEAM_GROUP).active;break;case h.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_SKYCASTLE_EASY:case h.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_SKYCASTLE_HARD:case h.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_SKYCASTLE_NIGHTMARE:case h.CHAT_CHANNEL_GROUP_TYPE.CHAT_CHANNEL_ACTICITY_GROUP:t=o.getChildByName("channe_"+h.CHAT_CHANNEL_GROUP_TYPE.CHAT_CHANNEL_ACTICITY_GROUP).active;break;case h.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_WEEK_COOPERATION:t=o.getChildByName("channe_"+h.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_WEEK_COOPERATION).active}return t},t.prototype.hideAllChannelList=function(){this.systemPanelNode.active=!1,this.friendPanelNode.active=!1,this.worldPanelNode.active=!1,this.activityPanelNode.active=!1,this.weekCoopPanelNode.active=!1},t.prototype.callChangeChatStatus=function(e){var t=new A.C_Role_Chat_Status;t.chatStatus=e,l.ClientNetwork.getInstance().Send(A.ROLE_CLIENT_ENUM.P_Role_Chat_Status,t)},t.prototype.checkMsgIsActivityChannel=function(e){var t=0;return s.ChatChannelTableData.getDataMap().forEach(function(o){o.id==e&&(t=o.group)}),t==h.CHAT_CHANNEL_GROUP_TYPE.CHAT_CHANNEL_ACTICITY_GROUP},t.prototype.onDestroy=function(){l.ClientNetwork.getInstance().removeLocalMessage(w.LOCAL_MESSAGE.LocalMsg_SystemCallFriendAddBlack),l.ClientNetwork.getInstance().removeMessageTarget(this)},n([G(cc.Node)],t.prototype,"systemPanelNode",void 0),n([G(cc.Node)],t.prototype,"worldPanelNode",void 0),n([G(cc.Node)],t.prototype,"teamPanelNode",void 0),n([G(cc.Node)],t.prototype,"friendPanelNode",void 0),n([G(cc.Node)],t.prototype,"activityPanelNode",void 0),n([G(cc.Node)],t.prototype,"weekCoopPanelNode",void 0),n([G(cc.Node)],t.prototype,"SociatyChatPanelNode",void 0),n([G(cc.Node)],t.prototype,"editBoxNode",void 0),n([G(cc.Node)],t.prototype,"sendNode",void 0),n([G(cc.Node)],t.prototype,"friendSendBtnNode",void 0),n([G(cc.Node)],t.prototype,"teamSendBtnNode",void 0),n([G(cc.Node)],t.prototype,"systemSendBtnNode",void 0),n([G(cc.Node)],t.prototype,"activitySendBtnNode",void 0),n([G(cc.Node)],t.prototype,"weekCoopSendBtnNode",void 0),n([G(cc.Node)],t.prototype,"SociatyChatSendBtnNode",void 0),n([G(cc.Node)],t.prototype,"friendChatTipLab",void 0),n([G(cc.Node)],t.prototype,"emojiNode",void 0),n([k],t)}(cc.Component);o.default=O,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/ChatChannelTableData":"ChatChannelTableData","../../StaticData/StringValueTableData":"StringValueTableData","../../combat/CombatManager":"CombatManager","../../common/CommandValue":"CommandValue","../../common/EventConst":"EventConst","../../common/PlayerModule":"PlayerModule","../../modules/base/GameView":"GameView","../../modules/manager/EventManager":"EventManager","../../network/ClientNetwork":"ClientNetwork","../../network/LocalMessage":"LocalMessage","../../network/protocol/ChatProtocols":"ChatProtocols","../../network/protocol/FriendProtocls":"FriendProtocls","../../network/protocol/MatchProtocols":"MatchProtocols","../../network/protocol/RoleProtocols":"RoleProtocols","../../network/protocol/TypeProtocols":"TypeProtocols","../../network/protocol/long":"long","../../utils/ConfigUtils":"ConfigUtils","../../utils/DalanReportUtils":"DalanReportUtils","../../utils/GamePlatform":"GamePlatform","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils","../../utils/KSMinigameUtils":"KSMinigameUtils","../../utils/QQGameHallUtils":"QQGameHallUtils","../../utils/ResourcesManager":"ResourcesManager","../../utils/UIManager":"UIManager","../sociaty/SociatyModel":"SociatyModel"}],ChatProtocols:[function(e,t,o){"use strict";cc._RF.push(t,"50cdes7svtFHqpUJS/kpfBM","ChatProtocols"),e("DataViewRW");var i=e("ObjCollection"),a=e("long"),n=e("./BaseProtocols").T_Chat_Data,r=e("./BaseProtocols").T_Chat_HeroData;(function(e){e[e.P_Chat_Begin=6e6]="P_Chat_Begin",e[e.P_Chat_ToClient=6000001]="P_Chat_ToClient",e[e.P_Chat_Client=6000002]="P_Chat_Client",e[e.P_Chat_CloseFightRoom=6000003]="P_Chat_CloseFightRoom",e[e.P_Chat_SynPrivateChatSimData=6000004]="P_Chat_SynPrivateChatSimData",e[e.P_Chat_GetPrivateChatData=6000005]="P_Chat_GetPrivateChatData",e[e.P_Chat_SetPrivateChatRead=6000006]="P_Chat_SetPrivateChatRead",e[e.P_Chat_DeletePrivateChatData=6000007]="P_Chat_DeletePrivateChatData"})(o.CHAT_CLIENT_ENUM||(o.CHAT_CLIENT_ENUM={}));var s=function(){function e(){this._data=new n}return e.prototype.read=function(e){return!!this._data.read(e)},e.prototype.writeNoEnd=function(e){this._data.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Chat_ToClient=s;var c=function(){function e(){this.channel=0,this.isSendSelf=!1,this.receiveRoleID=a.fromValue(0),this.chatType=0,this.chatText="",this.chatParam=0,this.heros=new i.ObjMap,this.isLiveState=0}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<21)return!1;this.channel=e.getInt32(),this.isSendSelf=e.getBool(),this.receiveRoleID=e.getLong(),this.chatType=e.getInt32();var t=e.getUint32();if(e.getLen()-e.getPos()<t)return!1;if(this.chatText=e.getString(t),e.getLen()-e.getPos()<8)return!1;this.chatParam=e.getInt32();var o=e.getUint32();this.heros.clear();for(var i=0;i<o;++i){var a;a=e.getInt32();var n=new r;if(!n.read(e))return!1;this.heros.set(a,n)}return!(e.getLen()-e.getPos()<4||(this.isLiveState=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.channel),e.setBool(this.isSendSelf),e.setLong(this.receiveRoleID),e.setInt32(this.chatType),e.setString(this.chatText),e.setInt32(this.chatParam),e.setUint32(this.heros.size),this.heros.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)}),e.setInt32(this.isLiveState)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Chat_Client=c,function(e){e[e.ErrorCode_Chat_Client_Success=0]="ErrorCode_Chat_Client_Success",e[e.ErrorCode_Chat_Client_Failed=1]="ErrorCode_Chat_Client_Failed",e[e.ErrorCode_Chat_Client_NoRole=2]="ErrorCode_Chat_Client_NoRole",e[e.ErrorCode_Chat_Client_NoChannel=3]="ErrorCode_Chat_Client_NoChannel",e[e.ErrorCode_Chat_Client_NoChannelTable=4]="ErrorCode_Chat_Client_NoChannelTable",e[e.ErrorCode_Chat_Client_NoClientChannel=5]="ErrorCode_Chat_Client_NoClientChannel",e[e.ErrorCode_Chat_Client_NoCost=6]="ErrorCode_Chat_Client_NoCost",e[e.ErrorCode_Chat_Client_NoOpen=7]="ErrorCode_Chat_Client_NoOpen",e[e.ErrorCode_Chat_Client_HasFilterWords=8]="ErrorCode_Chat_Client_HasFilterWords",e[e.ErrorCode_Chat_Client_NoFriend=9]="ErrorCode_Chat_Client_NoFriend",e[e.ErrorCode_Chat_Client_NoReceiveRole=10]="ErrorCode_Chat_Client_NoReceiveRole",e[e.ErrorCode_Chat_Client_PlatformError=11]="ErrorCode_Chat_Client_PlatformError",e[e.ErrorCode_Chat_Client_SDKError=12]="ErrorCode_Chat_Client_SDKError",e[e.ErrorCode_Chat_Client_ChatTypeError=13]="ErrorCode_Chat_Client_ChatTypeError",e[e.ErrorCode_Chat_Client_ChatTypeFailed=14]="ErrorCode_Chat_Client_ChatTypeFailed",e[e.ErrorCode_Chat_Client_ForbidChat=15]="ErrorCode_Chat_Client_ForbidChat",e[e.ErrorCode_Chat_Client_LenError=16]="ErrorCode_Chat_Client_LenError",e[e.ErrorCode_Chat_Client_NoMaxScore=17]="ErrorCode_Chat_Client_NoMaxScore",e[e.ErrorCode_Chat_Client_LiveState=18]="ErrorCode_Chat_Client_LiveState"}(o.ErrorCode_Chat_Client||(o.ErrorCode_Chat_Client={}));var l=function(){function e(){this.errorcode=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Chat_Client=l;var d=function(){function e(){this.roomID=""}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();return!(e.getLen()-e.getPos()<t||(this.roomID=e.getString(t),0))},e.prototype.writeNoEnd=function(e){e.setString(this.roomID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Chat_CloseFightRoom=d;var u=function(){function e(){this.nickName="",this.headID=0,this.headUrl="",this.headFrameID=0,this.noReadNum=0}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();if(e.getLen()-e.getPos()<t)return!1;if(this.nickName=e.getString(t),e.getLen()-e.getPos()<8)return!1;this.headID=e.getInt32();var o=e.getUint32();return!(e.getLen()-e.getPos()<o||(this.headUrl=e.getString(o),e.getLen()-e.getPos()<8||(this.headFrameID=e.getInt32(),this.noReadNum=e.getInt32(),0)))},e.prototype.writeNoEnd=function(e){e.setString(this.nickName),e.setInt32(this.headID),e.setString(this.headUrl),e.setInt32(this.headFrameID),e.setInt32(this.noReadNum)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Chat_PrivateChatSimData=u;var h=function(){function e(){this.simData=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();this.simData.clear();for(var o=0;o<t;++o){var i;i=e.getLong();var a=new u;if(!a.read(e))return!1;this.simData.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setUint32(this.simData.size),this.simData.forEach(function(t,o){e.setLong(o),t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Chat_SynPrivateChatSimData=h;var p=function(){function e(){this.roleID=a.fromValue(0)}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.roleID=e.getLong(),0))},e.prototype.writeNoEnd=function(e){e.setLong(this.roleID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Chat_GetPrivateChatData=p;var f=function(){function e(){this.roleID=a.fromValue(0),this.chatData=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<12)return!1;this.roleID=e.getLong();var t=e.getUint32();this.chatData=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.chatData.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setLong(this.roleID),e.setUint32(this.chatData.length),this.chatData.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Chat_GetPrivateChatData=f;var g=function(){function e(){this.roleID=a.fromValue(0)}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.roleID=e.getLong(),0))},e.prototype.writeNoEnd=function(e){e.setLong(this.roleID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Chat_SetPrivateChatRead=g;var m=function(){function e(){this.roleID=a.fromValue(0)}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.roleID=e.getLong(),0))},e.prototype.writeNoEnd=function(e){e.setLong(this.roleID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Chat_DeletePrivateChatData=m;var _=function(){function e(){this.errorcode=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Chat_DeletePrivateChatData=_,cc._RF.pop()},{"./BaseProtocols":"BaseProtocols",DataViewRW:"DataViewRW",ObjCollection:"ObjCollection",long:"long"}],CheatManager:[function(e,t,o){"use strict";cc._RF.push(t,"73b88sGOTJGMrhn/ZbMq2Jv","CheatManager");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../base/BaseSingle"),s=e("./CheatValue"),c=cc._decorator,l=c.ccclass,d=(c.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.valueCom=null,t}return a(t,e),t.prototype.onCreate=function(){this.valueCom=new s.default},t.prototype.onDestroy=function(){},t.prototype.init=function(){},t.prototype.CheckTime=function(){},t.prototype.ProtectObj=function(e,t){this.valueCom.protectObj(e,t)},t.prototype.StopProtectObj=function(){this.valueCom.stopPretect()},n([l],t)}(r.BaseSingle));o.default=r.SingleFactory.getInstance(d),cc._RF.pop()},{"../../base/BaseSingle":"BaseSingle","./CheatValue":"CheatValue"}],CheatTables:[function(e,t,o){"use strict";cc._RF.push(t,"c0d08xxyj5I96Jik97RdD+F","CheatTables");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../../network/ClientNetwork"),s=e("../../../network/LocalMessage"),c=e("../../../utils/ConfigUtils"),l=e("../../../utils/GamePlatform"),d=e("../../../utils/GameUtils"),u=e("../../../combat/CombatManager"),h=e("../../../utils/ConstValue"),p=e("../../../utils/base64"),f=e("./SafeNumber"),g=e("../../../common/NetworkProtocolCommon"),m=e("../../../common/PlayerModule"),_=e("../../../network/protocol/RoleProtocols"),y=e("../../../network/protocol/TypeProtocols"),v=cc._decorator,C=v.ccclass,S=(v.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._infoMap=new Map,t._EncryptMap=new Map,t._report8090=!1,t}return a(t,e),t.prototype.onLoad=function(){r.ClientNetwork.getInstance().listenLocalMessage(s.LOCAL_MESSAGE.LocalMsg_ServerCheckTableMd5,function(e){var t=e[0],o=l.GamePlatform.safeJsonParse(t);if(o){var i=parseInt(o.result);console.log("checkTableFileChange server ret="+i),0!=i&&r.ClientNetwork.getInstance().pushLocalMessage(s.LOCAL_MESSAGE.LocalMsg_CheatTableFile)}},this)},t.prototype.begin=function(){var e=this;this._report8090=!1;var t=parseInt(d.getConfigIntValue("cheat_table_interval"));t||(t=13),this.scheduleOnce(function(){e.checkTableMemory(),e.scheduleOnce(function(){e.checkTableMemory(),e.unschedule(e.checkTableMemory),e.schedule(e.checkTableMemory,t)},3)},.01),this.scheduleOnce(this.checkTableFile,3),this.unschedule(this.checkCarMaxHp),this.schedule(this.checkCarMaxHp,60)},t.prototype.stop=function(){this.unscheduleAllCallbacks()},t.prototype.setObj=function(e,t){if(t&&e){var o=t.call(e),i=this.getBase64EncodeStr(o);i.length>0&&(this._infoMap.set(e,t),this._EncryptMap.set(e,i))}},t.prototype.checkTableFile=function(){l.GamePlatform.isQQMiniGame()?console.log("qqminigame no checktablefile"):this.checkTableFileChange(function(e){0!=e&&r.ClientNetwork.getInstance().pushLocalMessage(s.LOCAL_MESSAGE.LocalMsg_CheatTableFile)})},t.prototype.checkTableMemorySync=function(){var e=this,t=this;console.time("checkTableMemorySync");try{this._infoMap.forEach(function(o,i){var a=o.call(i),n=t._EncryptMap.get(i),c=e.getBase64DecodeStr(n);c.length<=0&&g.default.callRoleClientLog("reportCheatTable code=3"),(!a||a.length<=0)&&g.default.callRoleClientLog("reportCheatTable code=4"),c.length>0&&a.length>0&&c!=a&&(console.log("cheatTable failed "+a),r.ClientNetwork.getInstance().pushLocalMessage(s.LOCAL_MESSAGE.LocalMsg_CheatTable),t.reportCheatTable(c,a))})}catch(o){}console.timeEnd("checkTableMemorySync")},t.prototype.checkTableMemory=function(){var e=this,t=this,o=0;try{this._infoMap.forEach(function(i,a){e.scheduleOnce(function(){var o=i.call(a),n=t._EncryptMap.get(a),c=e.getBase64DecodeStr(n);c.length<=0&&g.default.callRoleClientLog("reportCheatTable code=1"),(!o||o.length<=0)&&g.default.callRoleClientLog("reportCheatTable code=2"),c.length>0&&o.length>0&&c!=o&&(console.log("cheatTable failed "+o),r.ClientNetwork.getInstance().pushLocalMessage(s.LOCAL_MESSAGE.LocalMsg_CheatTable),t.reportCheatTable(c,o))},.05*o),o++})}catch(i){}return!0},t.prototype.checkTableFileChange=function(e){var t=c.default.getInstance().getCheatMd5();if(!(t.length<=0)){var o=this,i="https://mszcs1.gameserver.iplay11g.com/gmsys/checktable.php",a="https://mszctest.gameserver.iplay11g.com/gmsys/checktable.php";if(a=l.GamePlatform.isWechat()||l.GamePlatform.isQQMiniGame()?i:l.GamePlatform.isAndroid()?i:(l.GamePlatform.isIOS(),i),a+="?ver="+d.getTableVersion(),a+="&key="+t,a+="&id="+m.default.uuidTransformRoieId(),console.log("checkTableFileChange url="+a+" md5="+t),m.default.checkModulerOnOffState(62)){var n=new _.C_Role_Call_Php;n.type=y.TYPE_CLIENT_CALL_PHP.CLIENT_CALL_PHP_CHECKTABLE,n.params.set("ver",d.getTableVersion()),n.params.set("key",t),n.params.set("id",m.default.uuidTransformRoieId()),r.ClientNetwork.getInstance().Send(_.ROLE_CLIENT_ENUM.P_Role_Call_Php,n),console.log("8091 use server")}else{console.log("8091 use client");try{var s=new XMLHttpRequest;s.onreadystatechange=function(){if(console.log("checkTableFileChange status="+s.status),4==s.readyState&&s.status>=200&&s.status<400){var t=s.responseText.toString();console.log("checkTableFileChange retTest="+t);var i=l.GamePlatform.safeJsonParse(t);if(i){var a=parseInt(i.result);e.call(o,a),console.log("checkTableFileChange ret="+a)}}},s.open("GET",a,!0),s.send()}catch(u){console.log("checkTableFileChange ")}}}},t.prototype.reportCheatTable=function(e,t){if(!this._report8090){this._report8090=!0;try{for(var o=0,i="",a="";o<e.length;++o)if(o<t.length&&e[o]!=t[o]){for(var n=o;n<50+o;++n)n<e.length&&n<t.length&&(i+=e[n],a+=t[n]);break}g.default.callRoleClientLog("reportCheatTable tableRightStr.len="+e.length+" tableWrongStr.len="+t.length+" pos="+o),g.default.callRoleClientLog("reportCheatTable rightStr="+i),g.default.callRoleClientLog("reportCheatTable wrongStr="+a)}catch(r){}}},t.prototype.checkCarMaxHp=function(){var e=u.getInstance().getCarByCamp(h.PLAYER_CAMP.coopPlayer),t=u.getInstance().getCarByCamp(h.PLAYER_CAMP.myPlayer),o=0,i=0;e&&(o+=e.getMaxHp(),i+=e.hp),t&&(o+=t.getMaxHp(),i+=t.hp);var a=new f.SafeNumber(parseInt(d.getConfigIntValue("max_car_hp_limit")));if(a||(a.value=5e7),o>=a.value||i>=a.value){r.ClientNetwork.getInstance().pushLocalMessage(s.LOCAL_MESSAGE.LocalMsg_Cheat8096);var n=[];n[0]="carMaxHp",n[1]=""+o,l.GamePlatform.reportWXLog(n)}},t.prototype.getBase64EncodeStr=function(e){var t="";try{t=(new p.Base64).encode(e)}catch(o){return t}return t},t.prototype.getBase64DecodeStr=function(e){var t="";try{t=(new p.Base64).decode(e)}catch(o){return t}return t},n([C],t)}(cc.Component));o.default=S,cc._RF.pop()},{"../../../combat/CombatManager":"CombatManager","../../../common/NetworkProtocolCommon":"NetworkProtocolCommon","../../../common/PlayerModule":"PlayerModule","../../../network/ClientNetwork":"ClientNetwork","../../../network/LocalMessage":"LocalMessage","../../../network/protocol/RoleProtocols":"RoleProtocols","../../../network/protocol/TypeProtocols":"TypeProtocols","../../../utils/ConfigUtils":"ConfigUtils","../../../utils/ConstValue":"ConstValue","../../../utils/GamePlatform":"GamePlatform","../../../utils/GameUtils":"GameUtils","../../../utils/base64":"base64","./SafeNumber":"SafeNumber"}],CheatValue:[function(e,t,o){"use strict";cc._RF.push(t,"27a3dLUA01Ex7utwkfAUFew","CheatValue");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../../network/ClientNetwork"),s=e("../../../network/LocalMessage"),c=cc._decorator,l=c.ccclass,d=(c.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._infoMap=new Map,t._EncryptMap=new Map,t._init=!1,t._stop=!1,t}return a(t,e),t.prototype.init=function(){this.schedule(this.checkCheat,2)},t.prototype.protectObj=function(e,t){if(!this._stop)if(this._init||(this.init(),this._init=!0),this.objCanProtect(e,t))try{var o=t.call(e),i=this.EncryptStr(o);i&&i.length>0&&(this._infoMap.set(e,t),this._EncryptMap.set(e,i))}catch(a){}else this.delObj(e)},t.prototype.stopPretect=function(){this._stop=!0,this._infoMap.clear(),this._EncryptMap.clear()},t.prototype.checkCheat=function(){var e=this,t=this;this._infoMap.forEach(function(o,i){t.objCanProtect(i,o)?e.checkObjCheat(i,o):e.delObj(i)})},t.prototype.checkObjCheat=function(e,t){try{if(!this.objCanProtect(e,t))return void this.delObj(e);var o=t.call(e),i=this.EncryptStr(o);if(i&&i.length>0){var a=this._EncryptMap.get(e);if(a&&a!=i)return console.log("cheatValue failed "+o),void r.ClientNetwork.getInstance().pushLocalMessage(s.LOCAL_MESSAGE.LocalMsg_CheatValue)}}catch(n){return}},t.prototype.objCanProtect=function(e,t){return!(!cc.isValid(e,!0)||!cc.isValid(t,!0)||e.bDestory||t.call(e).length<=0)},t.prototype.delObj=function(e){this._infoMap.delete(e),this._EncryptMap.delete(e)},t.prototype.EncryptStr=function(e){return e},n([l],t)}(cc.Component));o.default=d,cc._RF.pop()},{"../../../network/ClientNetwork":"ClientNetwork","../../../network/LocalMessage":"LocalMessage"}],CheckCRC:[function(e,t,o){"use strict";cc._RF.push(t,"9c70fOatfNBBZc6qJ/TbdjS","CheckCRC"),Object.defineProperty(o,"__esModule",{value:!0}),o.crc32_buf=void 0;var i=function(){for(var e=0,t=new Array(256),o=0;256!=o;++o)e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=o)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1,t[o]=e;return"undefined"!=typeof Int32Array?new Int32Array(t):t}();function a(e,t){for(var o=-1^t,a=e.length-7,n=0;n<a;)o=(o=(o=(o=(o=(o=(o=(o=o>>>8^i[255&(o^e[n++])])>>>8^i[255&(o^e[n++])])>>>8^i[255&(o^e[n++])])>>>8^i[255&(o^e[n++])])>>>8^i[255&(o^e[n++])])>>>8^i[255&(o^e[n++])])>>>8^i[255&(o^e[n++])])>>>8^i[255&(o^e[n++])];for(;n<a+7;)o=o>>>8^i[255&(o^e[n++])];return-1^o}o.crc32_buf=function(e,t){if(e.length>1e4)return a(e,t);for(var o=-1^t,n=e.length-3,r=0;r<n;)o=(o=(o=(o=o>>>8^i[255&(o^e[r++])])>>>8^i[255&(o^e[r++])])>>>8^i[255&(o^e[r++])])>>>8^i[255&(o^e[r++])];for(;r<n+3;)o=o>>>8^i[255&(o^e[r++])];return-1^o},cc._RF.pop()},{}],ChickenDinnerIntroduceView:[function(e,t,o){"use strict";cc._RF.push(t,"2f72a9PG0ZHioegLI+lCONg","ChickenDinnerIntroduceView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=cc._decorator.ccclass,l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.path=function(){return"ui/chickenDinner/ChickenDinnerIntroduce"},n([s.Register_Class,c],t)}(r.default);o.default=l,cc._RF.pop()},{"../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators"}],ChickenDinnerMainView:[function(e,t,o){"use strict";cc._RF.push(t,"c6483qHHVtGHYgsddrqLqnG","ChickenDinnerMainView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=e("../../common/PlayerModule"),l=e("../../Global/GameGlobal"),d=e("../activity/ActivityModule"),u=e("../../network/protocol/ActivityProtocols"),h=e("../../StaticData/ActivityTableData"),p=e("../../modules/base/GameView"),f=e("../../utils/GameTools"),g=e("../../network/protocol/TypeProtocols"),m=e("../../network/protocol/MatchProtocols"),_=e("../../network/ClientNetwork"),y=e("../../modules/manager/EventManager"),v=e("../../common/EventConst"),C=e("../../utils/GameUtils"),S=e("../../network/LocalMessage"),T=e("../../utils/List"),I=e("../../StaticData/RoyaleRankListTableData"),N=e("../../utils/ConfigUtils"),b=e("../../utils/ResourcesManager"),w=e("../../StaticData/RoyaleRangeTableData"),E=cc._decorator,P=E.ccclass,R=E.property,L=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.openTimeLab=null,t.panelArrNode=[],t.readyNode=null,t.rankListNode=null,t.rewardListNode=null,t.myRankInfoNode=null,t.rewardItemPrefab=null,t.list=null,t.m_SwordNode=null,t._matchState=0,t._remainingRefreshNode=[],t._rankListDatas=[],t._isRestTime=!1,t._joinBtnCd=0,t}return a(t,e),t.path=function(){return"ui/chickenDinner/ChickenDinnerMain"},t.prototype.onLoad=function(){this.callGetEatChickenData()},t.prototype.start=function(){var e=this;this.initRewardListInfo(),this.initListenMessage(),this.chickenDinnerChangeState(),y.default.Instance.on(v.default.ChickenDinnerSync,this.chickenDinnerChangeState,this),d.default.ClickChickenDinnerState=!0,this.scheduleOnce(function(){e.initChickenDinnerOpenState()})},t.prototype.onEnable=function(){var e=p.default.getViewByName("ActivityMainView");if(e&&e.view&&e.view.node){e.view.node.active=!1;var t=e.view.node.parent.getChildByName("UI_Mask_ActivityMainView");t&&(t.active=!1)}},t.prototype.onDisable=function(){var e=p.default.getViewByName("ActivityMainView");if(e&&e.view&&e.view.node){e.view.node.active=!0,e.view.refreshChickenDinnerNum();var t=e.view.node.parent.getChildByName("UI_Mask_ActivityMainView");t&&(t.active=!0)}},t.prototype.init=function(){this.onRefreshViewInfoState(),this.initShowSword()},t.prototype.initShowSword=function(){var e=d.default.getCurShowEquipIdByDate();if(e>0){var t=N.default.getInstance().getItemByID(e);b.default.loadSprite("ui/chickenDinner/image/"+e,this.m_SwordNode.children[0].getComponent(cc.Sprite)),b.default.loadSprite("ui/chickenDinner/image/"+t.name,this.m_SwordNode.children[1].getComponent(cc.Sprite))}},t.prototype.onClickSwordCallBack=function(){p.default.addPopView("BaseCtrl","ChickenDinnerSwordDetailedView","ChickenDinnerSwordDetailedView")},t.prototype.initChickenDinnerOpenState=function(){var e=h.ActivityTableData.getById(u.ACTIVITY_ID_ENUM.P_Activity_ChickenDinner),t=c.default.getGameTime(),o=e.param5.toString(),i=t.year+"-"+t.month+"-"+t.day+" "+o.slice(0,2)+":"+o.slice(2,4)+":00";this._endTime=Math.floor(d.default.getTargetTime(i)/1e3);var a=h.ActivityTableData.getById(u.ACTIVITY_ID_ENUM.P_Activity_ChickenDinner).extranceUrl.split("|")[0];return d.default.getChickenDinnerData(),this.openTimeLab.string=a},t.prototype.resetAllPanelInfoNode=function(){this.panelArrNode.forEach(function(e){e.active=!1})},t.prototype.GetAllCount=function(){var e=0;return 1==d.default.checkOpen(u.ACTIVITY_ID_ENUM.P_Activity_LimitTimeChicken)&&(e=h.ActivityTableData.getById(u.ACTIVITY_ID_ENUM.P_Activity_LimitTimeChicken).param3),e+h.ActivityTableData.getById(u.ACTIVITY_ID_ENUM.P_Activity_ChickenDinner).param3},t.prototype.initNoOpenInfo=function(){this.panelArrNode[0].active=!0;var e=d.default.getChickenDinnerData(),t=(h.ActivityTableData.getById(u.ACTIVITY_ID_ENUM.P_Activity_ChickenDinner),d.default.checkActivityIsOpen(u.ACTIVITY_ID_ENUM.P_Activity_ChickenDinner)),o=this.panelArrNode[0].children[0];e.status==g.EATCHICKEN_STAGE.EATCHICKEN_STAGE_NONE||0==t?(f.default.setNodeBright(o,!1),this.panelArrNode[0].children[2].active=!0,this.panelArrNode[0].children[3].active=!1):(f.default.setNodeBright(o,!0),this.panelArrNode[0].children[2].active=!1,this.panelArrNode[0].children[3].active=!0);var i=this.GetAllCount(),a=this.panelArrNode[0].children[1],n=i-e.count;n=n<0?0:n,a.getComponent(cc.Label).string="\u6b21\u6570\uff1a"+n+"/"+i},t.prototype.getPlayerHeroTotalHp=function(){var e=c.default.getHeroCarData(),t=0;e.forEach(function(e){if(1==e.bHeroLock){var o=N.default.getInstance().getHeroConfig(e.heroId).npc_id,i=N.default.getInstance().getNpcTemplateConfig(o,e.heroLevel).carhp;t+=i}});var o=N.default.getInstance().getCarConfig(1);return o&&(t+=o.ini_hp),t},t.prototype.findRoyaleRangeId=function(){var e=0,t=this.getPlayerHeroTotalHp();return w.RoyaleRangeTableData.getDataMap().forEach(function(o){t>=o.rangeMin&&t<=o.rangeMax&&(e=o.id)}),e},t.prototype.initRewardListInfo=function(){var e=this,t=[],o=this.findRoyaleRangeId();if(o<=0)return l.G.StringManager.PopString("\u6570\u636e\u9519\u8bef");I.RoyaleRankListTableData.getDataMap().forEach(function(e){e.rangeId==o&&t.push(e)}),t.forEach(function(t,o){var i=cc.instantiate(e.rewardItemPrefab);i.parent=e.rewardListNode.getComponent(cc.ScrollView).content,i.getComponent("ActivityGoldenLeagueRewardtem").show(t,o)})},t.prototype.initGatherNodeInfo=function(e){var t=Number(C.getConfigIntValue("chicken_max_role_num"));0==this.panelArrNode[1].active&&(this.panelArrNode[1].active=!0,this.panelArrNode[1].children[0].getComponent(cc.Label).string=l.G.StringManager.getString("CHICKENDINNER_TIP4",t),this.panelArrNode[1].children[1].active=!0);var o=e;this.panelArrNode[1].children[2].children[0].getComponent(cc.Label).string=o.toString(),o>=t&&this.initGatherReadyOver()},t.prototype.initGatherReadyOver=function(){var e=this;if(1!=this.readyNode.active){var t=p.default.getViewByName("ChickenDinnerIntroduceView");t&&t.view&&t.view.closeView();var o=p.default.getViewByName("PlayerInfoView");o&&o.view&&o.view.closeView();var i=p.default.getViewByName("PlayerHeadView");i&&i.view&&i.view.closeView();var a=p.default.getViewByName("ExchangeCodeView");a&&a.view&&a.view.closeView();var n=p.default.getViewByName("CDKEYView");n&&n.view&&n.view.closeView(),this.readyNode.active=!0;var r=3,s=this.readyNode.children[1].children[1];s.getComponent(cc.Label).string=r.toString(),this.schedule(function(){r--,s.getComponent(cc.Label).string=r.toString(),r<=0&&(e.readyNode.active=!1,e.node.getChildByName("ranshao").active=!0,e.node.getChildByName("ranshao").scaleX=e.node.getChildByName("backgroundNode").scaleX,e.initMatchPanelNode())},1,2,1)}},t.prototype.initMatchPanelNode=function(){var e=d.default.getChickenDinnerData();if(e.status!=g.EATCHICKEN_STAGE.EATCHICKEN_STAGE_MATCHING)return l.G.StringManager.PopString("\u5f53\u524d\u6d3b\u52a8\u72b6\u6001\u4e0d\u5728\u5339\u914d\u5185"+e.status);this.resetAllPanelInfoNode(),this.panelArrNode[2].active=!0;var t=this.panelArrNode[2];t.children[5].active=!1,t.children[4].getComponent(cc.Label).string=e.remainingNum,this._remainingRefreshNode.push(t.children[4]),this.callMatchFight()},t.prototype.initEliminatePanelNode=function(){var e=this.panelArrNode[4];e.active=!0;var t=d.default.getChickenDinnerData();e.children[1].children[0].getComponent(cc.Label).string=t.remainingNum,this._remainingRefreshNode.push(e.children[1].children[0])},t.prototype.initRestPanelNode=function(){var e=this;if(1!=this.panelArrNode[3].active){this.resetAllPanelInfoNode();var t=d.default.getChickenDinnerData(),o=this.panelArrNode[3];o.active=!0,o.children[4].getComponent(cc.Label).string=l.G.StringManager.getString("CHICKENDINNER_TIP9"),o.children[3].children[0].getComponent(cc.Label).string=t.remainingNum,this._remainingRefreshNode.push(o.children[3].children[0]);var i=10,a=o.children[0];a.getComponent(cc.Label).string=i+"M",this.schedule(function(){e._isRestTime=!0,i--,a.getComponent(cc.Label).string=i+"M",i<=0&&(o.active=!1,e._matchState=0,e.initMatchPanelNode())},1,9,1)}},t.prototype.initListenMessage=function(){var e=this;_.ClientNetwork.getInstance().listenLocalMessage(S.LOCAL_MESSAGE.LocalMsg_MatchSuccess,function(){var t=e.panelArrNode[2];t.children[1].active=!1,t.children[2].active=!1,t.children[5].active=!0,e._matchState=2},this),_.ClientNetwork.getInstance().listenLocalMessage(S.LOCAL_MESSAGE.LocalMsg_LoginFightServerSuccess,function(){var e=this;setTimeout(function(){e.closeView()},1e3)}.bind(this),this),_.ClientNetwork.getInstance().listenProtocol(m.MATCH_CLIENT_ENUM.P_Match_Fight,function(t){t.resetPos();var o=new m.S_Match_Fight;if(o.read(t)){var i=o.errorcode;8089==i?(e.unscheduleAllCallbacks(),p.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:l.G.StringManager.getString("BATTLE_VERSION_NOT_MATCH"),confirmCb:function(){e.callMatchChickenQuit()}})):0!=i&&l.G.StringManager.PopStringOnce(l.G.StringManager.getString("MATCH_ROOM_FAIL"))}},this),_.ClientNetwork.getInstance().listenProtocol(m.MATCH_CLIENT_ENUM.P_Match_Chicken_Jion,function(t){t.resetPos();var o=new m.S_Match_Chicken_Jion;o.read(t)&&0!=o.errorcode&&(-2==o.errorcode?l.G.StringManager.PopStringOnce("\u6d3b\u52a8\u672a\u5f00\u542f\uff01"):8089==o.errorcode?(e.unscheduleAllCallbacks(),p.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:l.G.StringManager.getString("BATTLE_VERSION_NOT_MATCH"),confirmCb:function(){e.callMatchChickenQuit()}})):l.G.StringManager.PopStringOnce("\u52a0\u5165\u8bd5\u70bc\u9519\u8bef "+o.errorcode))},this);var t=this;_.ClientNetwork.getInstance().listenProtocol(m.MATCH_CLIENT_ENUM.P_Match_Chicken_Quit,function(e){e.resetPos();var o=new m.S_Match_Chicken_Quit;if(o.read(e))if(0==o.errorcode){if(!cc.isValid(t.node))return;t.closeView()}else l.G.StringManager.PopStringOnce("\u9000\u51fa\u8bd5\u70bc\u9519\u8bef "+o.errorcode)},this),_.ClientNetwork.getInstance().listenProtocol(m.MATCH_CLIENT_ENUM.P_Match_Chicken_RankList,function(t){t.resetPos();var o=new m.S_Match_Chicken_RankList;o.read(t)&&o.ranklist.length>0&&(e._rankListDatas=o.ranklist,e.onRefreshSelfRankInfo(),e.list.numItems=e._rankListDatas.length)},this)},t.prototype.chickenDinnerChangeState=function(){this.onRefreshViewInfoState()},t.prototype.onRefreshViewInfoState=function(){var e=d.default.getChickenDinnerData();1==e.isLive?e.status==g.EATCHICKEN_STAGE.EATCHICKEN_STAGE_NONE||e.status==g.EATCHICKEN_STAGE.EATCHICKEN_STAGE_NORMAL?(this.resetAllPanelInfoNode(),this.initNoOpenInfo()):e.status==g.EATCHICKEN_STAGE.EATCHICKEN_STAGE_ASSEMBLE?(this.resetAllPanelInfoNode(),this.initGatherNodeInfo(e.assembleNum)):e.status==g.EATCHICKEN_STAGE.EATCHICKEN_STAGE_MATCHING?(1==this.panelArrNode[1].active||1==this.panelArrNode[3].active||1==this.panelArrNode[2].active||this.initRestPanelNode(),this._remainingRefreshNode.forEach(function(t){t.getComponent(cc.Label).string=e.remainingNum})):(e.status,g.EATCHICKEN_STAGE.EATCHICKEN_STAGE_FIGHT):e.status==g.EATCHICKEN_STAGE.EATCHICKEN_STAGE_NORMAL&&(this.resetAllPanelInfoNode(),1==Math.floor(e.rank%100)?this.chickenSuccessInfo():this.initEliminatePanelNode()),e.status==g.EATCHICKEN_STAGE.EATCHICKEN_STAGE_FIGHT&&(this._matchState=2),this.callChickenRankList(),e.status>=g.EATCHICKEN_STAGE.EATCHICKEN_STAGE_MATCHING?(1==this.readyNode.active?this.node.getChildByName("ranshao").active=!1:this.node.getChildByName("ranshao").active=!0,this.node.getChildByName("ranshao").scaleX=this.node.getChildByName("backgroundNode").scaleX):this.node.getChildByName("ranshao").active=!1},t.prototype.onRefreshRankEvent=function(e,t){var o=this._rankListDatas[t];e.getComponent("ChickenDinnerRanktem").show(o,t)},t.prototype.onRefreshSelfRankInfo=function(){var e=this,t=this.myRankInfoNode.getChildByName("my_rank_num").getComponent(cc.Label),o=this.myRankInfoNode.getChildByName("my_score_label").getComponent(cc.Label),i=function(){for(var t=null,o=0;o<e._rankListDatas.length;o++)if(1==c.default.UUID.equals(e._rankListDatas[o].roleId)){t=e._rankListDatas[o];break}return t}.call(this);i?(t.string=i.rank.toString(),o.string=i.killNum.toString()):(t.string=l.G.StringManager.getString("NO_RANK"),o.string="0")},t.prototype.onClickRankCallBack=function(){1!=this.rankListNode.active&&(this.rankListNode.active=!0,this.rewardListNode.active=!1,this.myRankInfoNode.active=!0)},t.prototype.onClickRewardCallBack=function(){1!=this.rewardListNode.active&&(this.rankListNode.active=!1,this.rewardListNode.active=!0,this.myRankInfoNode.active=!1,this.rewardListNode.getComponent(cc.ScrollView).scrollToTop())},t.prototype.onClickJoinCallBack=function(){var e=(new Date).getTime();if(e-this._joinBtnCd<3e3)return l.G.StringManager.PopWorldString("sociaty_auction_tip11");this._joinBtnCd=e;var t=d.default.getChickenDinnerData(),o=d.default.checkActivityIsOpen(u.ACTIVITY_ID_ENUM.P_Activity_ChickenDinner);if(t.status==g.EATCHICKEN_STAGE.EATCHICKEN_STAGE_NONE||0==o)return l.G.StringManager.PopStringOnce(l.G.StringManager.getString("WUDAOHUI_TIP1"));var i=h.ActivityTableData.getById(u.ACTIVITY_ID_ENUM.P_Activity_ChickenDinner);return c.default.getRoleAttrValByKey(g.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE)<i.param1?l.G.StringManager.PopStringOnce(l.G.StringManager.getString("WUDAOHUI_SCORE_TIP",i.param1)):t.count>=this.GetAllCount()?l.G.StringManager.PopStringOnce(l.G.StringManager.getWorldString("chaogong_today_num_is_complete")):void this.callMatchChickenJion()},t.prototype.callMatchChickenJion=function(){var e=new m.C_Match_Chicken_Jion;e.params.push(C.getConfigVersion()),_.ClientNetwork.getInstance().Send(m.MATCH_CLIENT_ENUM.P_Match_Chicken_Jion,e)},t.prototype.callMatchChickenQuit=function(){var e=new m.C_Match_Chicken_Quit;_.ClientNetwork.getInstance().Send(m.MATCH_CLIENT_ENUM.P_Match_Chicken_Quit,e)},t.prototype.callMatchFight=function(){var e=d.default.getChickenDinnerData();if(e.status!=g.EATCHICKEN_STAGE.EATCHICKEN_STAGE_MATCHING)return l.G.StringManager.PopString("\u5f53\u524d\u6d3b\u52a8\u72b6\u6001\u4e0d\u5728\u5339\u914d\u5185"+e.status);this.onBenginMatchCountdown();var t=new m.C_Match_Fight;t.fightType=g.FIGHT_TYPE.FIGHT_TYPE_BATTLE_EAT_CHICKEN,t.params.push(C.getConfigVersion()),_.ClientNetwork.getInstance().Send(m.MATCH_CLIENT_ENUM.P_Match_Fight,t)},t.prototype.onBenginMatchCountdown=function(){var e=this;this._isRestTime=!1;var t=0,o=this.panelArrNode[2];o.children[0].getComponent(cc.Label).string=t+"M",this.schedule(function(){0==e._matchState&&(t++,o.children[0].getComponent(cc.Label).string=t+"M")},1)},t.prototype.chickenSuccessInfo=function(){this.unscheduleAllCallbacks(),this.panelArrNode[5].active=!0,1==this.readyNode.active&&(this.readyNode.active=!1)},t.prototype.callChickenRankList=function(){var e=d.default.getChickenDinnerData();if(e.status!=g.EATCHICKEN_STAGE.EATCHICKEN_STAGE_NONE&&e.status!=g.EATCHICKEN_STAGE.EATCHICKEN_STAGE_FIGHT){var t=new m.C_Match_Chicken_RankList;_.ClientNetwork.getInstance().Send(m.MATCH_CLIENT_ENUM.P_Match_Chicken_RankList,t)}},t.prototype.callGetEatChickenData=function(){var e=new u.C_Activity_GetEatChickenData;e.activityID=u.ACTIVITY_ID_ENUM.P_Activity_ChickenDinner,_.ClientNetwork.getInstance().Send(u.ACTIVITY_CLIENT_ENUM.P_Activity_GetEatChickenData,e)},t.prototype.onClickQuitCallBack=function(){var e=this,t=d.default.getChickenDinnerData();if(t.status==g.EATCHICKEN_STAGE.EATCHICKEN_STAGE_FIGHT)return l.G.StringManager.PopString(l.G.StringManager.getString("CHICKENDINNER_TIP17"));if(t.status!=g.EATCHICKEN_STAGE.EATCHICKEN_STAGE_ASSEMBLE)if(t.status!=g.EATCHICKEN_STAGE.EATCHICKEN_STAGE_MATCHING){if(t.status==g.EATCHICKEN_STAGE.EATCHICKEN_STAGE_NORMAL&&0==t.isLive)return this.callMatchChickenQuit();this.closeView(),this.callMatchChickenQuit()}else 1==this.panelArrNode[4].active||1==this.panelArrNode[5].active?this.callMatchChickenQuit():p.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:l.G.StringManager.getString("CHICKENDINNER_TIP13"),confirmCb:function(){e.callMatchChickenQuit()}});else p.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:l.G.StringManager.getString("CHICKENDINNER_TIP12"),confirmCb:function(){e.callMatchChickenQuit()}})},t.prototype.onClickIntroduceCallBack=function(){p.default.addPopView("BaseCtrl","ChickenDinnerIntroduceView","ChickenDinnerIntroduceView")},t.prototype.onDestroy=function(){var e=new m.C_Match_Cacel;_.ClientNetwork.getInstance().Send(m.MATCH_CLIENT_ENUM.P_Match_Cancel,e),y.default.Instance.off(this,v.default.ChickenDinnerSync),_.ClientNetwork.getInstance().removeMessageTarget(this),this.unscheduleAllCallbacks()},n([R(cc.Label)],t.prototype,"openTimeLab",void 0),n([R(cc.Node)],t.prototype,"panelArrNode",void 0),n([R(cc.Node)],t.prototype,"readyNode",void 0),n([R(cc.Node)],t.prototype,"rankListNode",void 0),n([R(cc.Node)],t.prototype,"rewardListNode",void 0),n([R(cc.Node)],t.prototype,"myRankInfoNode",void 0),n([R(cc.Prefab)],t.prototype,"rewardItemPrefab",void 0),n([R(T.default)],t.prototype,"list",void 0),n([R(cc.Node)],t.prototype,"m_SwordNode",void 0),n([s.Register_Class,P],t)}(r.default);o.default=L,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/ActivityTableData":"ActivityTableData","../../StaticData/RoyaleRangeTableData":"RoyaleRangeTableData","../../StaticData/RoyaleRankListTableData":"RoyaleRankListTableData","../../common/EventConst":"EventConst","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/base/GameView":"GameView","../../modules/manager/EventManager":"EventManager","../../network/ClientNetwork":"ClientNetwork","../../network/LocalMessage":"LocalMessage","../../network/protocol/ActivityProtocols":"ActivityProtocols","../../network/protocol/MatchProtocols":"MatchProtocols","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/ConfigUtils":"ConfigUtils","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils","../../utils/List":"List","../../utils/ResourcesManager":"ResourcesManager","../activity/ActivityModule":"ActivityModule"}],ChickenDinnerRanktem:[function(e,t,o){"use strict";cc._RF.push(t,"a8397XD6mhBhKv9ViVZntf3","ChickenDinnerRanktem");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../utils/GameTools"),s=e("../../modules/base/GameView"),c=e("../../common/PlayerModule"),l=e("../../utils/GameUtils"),d=e("../../modules/manager/LoadResManager"),u=cc._decorator,h=u.ccclass,p=u.property,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.rankIconNodeArr=[],t.rankNumNode=null,t.playerHeadNode=null,t.playerNameLab=null,t.winCountLab=null,t.survivalNode=null,t.dieNode=null,t.sociatyNameLab=null,t}return a(t,e),t.prototype.show=function(e,t){var o=this,i=e;this.rankIconNodeArr.forEach(function(e){e.active=!1}),this.rankNumNode.active=!1,this.rankIconNodeArr[t]?this.rankIconNodeArr[t].active=!0:(this.rankNumNode.active=!0,this.rankNumNode.children[0].getComponent(cc.Label).string=(t+1).toString()),this.playerNameLab.string=i.roleName,l.setRemoteHeadIcon(i.headUrl,i.headID,this.playerHeadNode.getComponent(cc.Sprite));var a=i.headFrameID;(a<=0||a>=2e3)&&(a=200),d.default.loadSpriteFrame("ui/headFrame/frame_"+a).then(function(e){o.playerHeadNode&&(o.playerHeadNode.children[0].getComponent(cc.Sprite).spriteFrame=e)}),this.winCountLab.string="\u8fde\u6740\uff1a"+e.killNum,e.isLive?(this.dieNode.active=!1,this.survivalNode.active=!0):(this.dieNode.active=!0,this.survivalNode.active=!1),this.playerHeadNode.roleId=c.default.otherUUidTransformRoieId(i.roleId),r.default.registerTouchEvent(this.playerHeadNode,function(e){var t=s.default.getViewByName("MainSceneView");t&&t.view&&t.view.onCallGetRoleSimpleInfo(e.target.roleId)}),this.sociatyNameLab.string=e.sociatyName?e.sociatyName:""},n([p(cc.Node)],t.prototype,"rankIconNodeArr",void 0),n([p(cc.Node)],t.prototype,"rankNumNode",void 0),n([p(cc.Node)],t.prototype,"playerHeadNode",void 0),n([p(cc.Label)],t.prototype,"playerNameLab",void 0),n([p(cc.Label)],t.prototype,"winCountLab",void 0),n([p(cc.Node)],t.prototype,"survivalNode",void 0),n([p(cc.Node)],t.prototype,"dieNode",void 0),n([p(cc.Label)],t.prototype,"sociatyNameLab",void 0),n([h],t)}(cc.Component);o.default=f,cc._RF.pop()},{"../../common/PlayerModule":"PlayerModule","../../modules/base/GameView":"GameView","../../modules/manager/LoadResManager":"LoadResManager","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils"}],ChickenDinnerSettlementView:[function(e,t,o){"use strict";cc._RF.push(t,"3621dDP8TRCu5R9F8dxXXFu","ChickenDinnerSettlementView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=e("../../modules/base/GameView"),l=e("../activity/ActivityModule"),d=e("../../utils/GameTools"),u=e("../../network/ClientNetwork"),h=e("../../network/protocol/MatchProtocols"),p=e("../../network/protocol/MatchProtocols"),f=e("../../network/protocol/TypeProtocols"),g=cc._decorator,m=g.ccclass,_=g.property,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.rankLabel=null,t.killLabel=null,t.rewardLayout=null,t}return a(t,e),t.path=function(){return"ui/chickenDinner/ChickenDinnerSettlement"},t.prototype.onLoad=function(){this.node.getChildByName("winBg").active=!1,this.node.getChildByName("failBg").active=!1},t.prototype.start=function(){var e=this;this.schedule(function(){if(cc.isValid(e.node)){var t=e.node.parent.getChildByName("UI_Mask_ChickenDinnerSettlementView");t&&0==t.active&&(t.active=!0)}},.5);var t=l.default.getChickenDinnerResultData();if(t){var o=Math.floor(t.ranklistdata.rank%100);0==o&&(o=100),this.rankLabel.string=o.toString(),this.killLabel.string=t.ranklistdata.killNum,t.prizes.forEach(function(t){d.default.createNormalItems(t.dropID,t.dropNum,e.rewardLayout.node,function(e){e.scale=.8})})}this.scheduleOnce(function(){var t=l.default.getChickenDinnerData(),o=e.node;if(t.remainingNum<=0)o.getChildByName("leftBtnNode").active=!1,o.getChildByName("rightBtnNode").active=!1,o.getChildByName("confirmBtnNode").active=!0;else{o.getChildByName("leftBtnNode").active=!0,o.getChildByName("rightBtnNode").active=!0,o.getChildByName("confirmBtnNode").active=!1;var i=c.default.getViewByName("ChickenDinnerMainView");i&&i.view||(o.getChildByName("leftBtnNode").active=!1,o.getChildByName("rightBtnNode").active=!1,o.getChildByName("confirmBtnNode").active=!0)}},1),0==t.ranklistdata.isLive&&1==Math.floor(t.ranklistdata.rank%100)?(this.node.getChildByName("winBg").active=!0,this.node.getChildByName("winBg").getComponent(sp.Skeleton).setAnimation(0,"idle",!1)):this.node.getChildByName("failBg").active=!0,l.default.setChickenDinnerResultData(null)},t.prototype.onClickQuitCallBack=function(){var e=c.default.getViewByName("ChickenDinnerMainView");if(e&&e.view)e.view.callMatchChickenQuit();else{var t=l.default.getChickenDinnerData();if(t.status==f.EATCHICKEN_STAGE.EATCHICKEN_STAGE_NORMAL&&0==t.isLive){var o=new p.C_Match_Chicken_Quit;u.ClientNetwork.getInstance().Send(h.MATCH_CLIENT_ENUM.P_Match_Chicken_Quit,o)}}this.closeView()},t.prototype.onDestroy=function(){u.ClientNetwork.getInstance().removeMessageTarget(this)},n([_(cc.Label)],t.prototype,"rankLabel",void 0),n([_(cc.Label)],t.prototype,"killLabel",void 0),n([_(cc.Layout)],t.prototype,"rewardLayout",void 0),n([s.Register_Class,m],t)}(r.default);o.default=y,cc._RF.pop()},{"../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/base/GameView":"GameView","../../network/ClientNetwork":"ClientNetwork","../../network/protocol/MatchProtocols":"MatchProtocols","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/GameTools":"GameTools","../activity/ActivityModule":"ActivityModule"}],ChickenDinnerSwordDetailedView:[function(e,t,o){"use strict";cc._RF.push(t,"5bbccyylEBO7LlPZagtDoo7","ChickenDinnerSwordDetailedView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=e("../../StaticData/RoyaleRoomTableData"),l=e("../../utils/ConfigUtils"),d=e("../../utils/ResourcesManager"),u=e("../../common/PlayerModule"),h=cc._decorator,p=h.ccclass,f=h.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.m_swordItemNode=null,t.m_detailedLab=null,t.m_initialEffectLab=null,t.m_lastEffectLab=null,t.m_swordScrollView=null,t.m_t_dataText=["\u65e5","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d"],t.m_t_colour=["93DAFC","F98909","8BF9F7","CDADF7","ECC7A8","FFBe30","3AD9D7"],t}return a(t,e),t.path=function(){return"ui/chickenDinner/ChickenDinnerSwordDetailed"},t.prototype.start=function(){this.initSwordList()},t.prototype.initSwordList=function(){var e=this;c.RoyaleRoomTableData.getDataMap().forEach(function(t){var o=cc.instantiate(e.m_swordItemNode);o.active=!0,o.parent=e.m_swordScrollView.content,o.children[0].active=!1,o.equipId=t.equipId;var i=l.default.getInstance().getItemByID(t.equipId);d.default.loadSprite("ui/chickenDinner/image/sword_detailed/"+i.name,o.children[1].getComponent(cc.Sprite)),o.children[3].getComponent(cc.Label).string=i.name,o.children[3].color=(new cc.Color).fromHEX(e.m_t_colour[t.weekday]),o.children[2].getComponent(cc.Label).string="\u661f\u671f"+e.m_t_dataText[t.weekday];var a=u.default.getServersTime();new Date(1e3*a).getDay()==t.weekday&&(o.children[0].active=!0,e.initSwordInfo(t.equipId)),o.hasEventListener(cc.Node.EventType.TOUCH_START)&&o.off(cc.Node.EventType.TOUCH_START),o.on(cc.Node.EventType.TOUCH_START,function(t){e.onClickSwordCallBack(t)})});var t=u.default.getServersTime(),o=new Date(1e3*t);(o.getDay()>4||0==o.getDay())&&this.scheduleOnce(function(){e.m_swordScrollView.scrollToRight()},.2)},t.prototype.onClickSwordCallBack=function(e){this.m_swordScrollView.content.children.forEach(function(e){e.children[0].active=!1}),e.target.children[0].active=!0,this.initSwordInfo(e.target.equipId)},t.prototype.initSwordInfo=function(e){var t=null;if(c.RoyaleRoomTableData.getDataMap().forEach(function(o){o.equipId==e&&(t=o)}),!t)return console.log("\u88c5\u5907\u6570\u636e\u9519\u8bef");this.m_detailedLab.string=t.desc,this.m_initialEffectLab.string=t.initial_effect_desc,this.m_lastEffectLab.string=t.max_effect_desc},n([f(cc.Node)],t.prototype,"m_swordItemNode",void 0),n([f(cc.Label)],t.prototype,"m_detailedLab",void 0),n([f(cc.Label)],t.prototype,"m_initialEffectLab",void 0),n([f(cc.Label)],t.prototype,"m_lastEffectLab",void 0),n([f(cc.ScrollView)],t.prototype,"m_swordScrollView",void 0),n([s.Register_Class,p],t)}(r.default);o.default=g,cc._RF.pop()},{"../../StaticData/RoyaleRoomTableData":"RoyaleRoomTableData","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../utils/ConfigUtils":"ConfigUtils","../../utils/ResourcesManager":"ResourcesManager"}],ClientIntDataTableData:[function(e,t,o){"use strict";cc._RF.push(t,"d6b7ba/7hNH/pLNjL8n9SDW","ClientIntDataTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.ClientIntDataTableData=void 0;var i=e("../TableReader"),a=function(){function e(){this.id=0,this.info=""}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.info=e.getString()},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"ClientIntDataTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.ClientIntDataTableData=a,cc._RF.pop()},{"../TableReader":"TableReader"}],ClientNetwork:[function(e,t,o){"use strict";cc._RF.push(t,"2b2f2CAx6FBOIpfjjX/7HRV","ClientNetwork"),Object.defineProperty(o,"__esModule",{value:!0}),o.ClientNetwork=o.EXTRA_MSG=void 0;var i,a=e("../Global/GameGlobal"),n=e("./LocalMessage"),r=e("./protocol/DataViewRW"),s=e("./CheckCRC"),c=e("./protocol/long"),l=e("../utils/TimeOffSetManager"),d=e("./protocol/RoleProtocols"),u=e("./protocol/LoginProtocols"),h=e("./protocol/SociatyProtocols"),p=e("../utils/LogUtil");(function(e){e[e.EXTRA_MSG_NONE=0]="EXTRA_MSG_NONE",e[e.EXTRA_MSG_CONNCET_SUCCEED=1]="EXTRA_MSG_CONNCET_SUCCEED",e[e.EXTRA_MSG_CONNCET_FAILED=2]="EXTRA_MSG_CONNCET_FAILED",e[e.EXTRA_MSG_CLOSE=3]="EXTRA_MSG_CLOSE",e[e.EXTRA_MSG_PING_FAIL=4]="EXTRA_MSG_PING_FAIL"})(i=o.EXTRA_MSG||(o.EXTRA_MSG={}));var f=function(){function e(){this.m_Ws=null,this.m_PingHandle=null,this.m_SendPingTime=0,this.NCS_WORLD_PING=1001,this.m_Url=null,this.m_tagPtl=new Map,this.m_WaitingMsg=new Set,this.m_Seq=c.fromNumber(0),this.m_Key=0,this.m_msgQueue=new Map,this.maxSendLen=0,this.maxRecvLen=0}return e.prototype.getWebSocket=function(){return e.getInstance().m_Ws},e.getInstance=function(){return null===e.s_Ins&&(e.s_Ins=new e),e.s_Ins},e.prototype.Connect=function(e){return this.m_Url=e,this.Reconnect()},e.prototype.isConnected=function(){return!(!this.m_Ws||this.m_Ws.readyState!==WebSocket.OPEN)},e.prototype.Disconnect=function(){null!==this.m_Ws&&(this.m_Ws.close(),this.m_Ws=null)},e.prototype.Reconnect=function(){return null!==this.m_Url&&(this.Disconnect(),cc.sys.isNative&&this.m_Url.startsWith("wss")?this.m_Ws=new WebSocket(this.m_Url,[],this.getWssCacert()):this.m_Ws=new WebSocket(this.m_Url),this.m_Ws.binaryType="arraybuffer",this.m_Ws.onopen=this.onOpen.bind(this),this.m_Ws.onclose=this.onClose.bind(this),this.m_Ws.onerror=this.onError.bind(this),this.m_Ws.onmessage=this.onMessage.bind(this),!0)},e.prototype.ReconnectLater=function(e){var t=this;return void 0===e&&(e=3e3),null!==this.m_Url&&(setTimeout(function(){t.m_Ws.readyState!=WebSocket.OPEN&&t.Reconnect()},e),!0)},e.prototype.Send=function(e,t,o,i){if(void 0===o&&(o=!1),void 0===i&&(i=!1),!this.m_Ws||this.m_Ws.readyState!==WebSocket.OPEN)return i&&a.G.StringManager.PopString(a.G.StringManager.getString("CONNECT_NO_CLIENTNETWORK")),this.m_Ws?console.log("Send wrong clientnetworkstate ["+this.m_Ws.readyState+"]"):console.log("Send wrong clientnetworkstate [m_Ws null]"),!1;if(o&&(this.isTagPtl(e)&&this.m_WaitingMsg.add(""+e),a.G.UIManager.showWaitingLayer(a.G.UIManager.getCurSceneName())),e>=h.SOCIATY_CLIENT_ENUM.P_Sociaty_Begin&&e<=h.SOCIATY_CLIENT_ENUM.P_Sociaty_RoleFocus){if(this.m_msgQueue.size>0)return this.m_msgQueue.set(e,t),!1;this.m_msgQueue.set(e,t)}var n=new ArrayBuffer(1048576),c=new r.DataViewWriter(n);c.advance(8),t&&t.write(c),c.markEnd(),c.resetPos(),c.setInt32(c.getLen()+8+4),c.setInt32(e),c.resetPos(),c.advance(c.getLen()),this.m_Seq=this.m_Seq.add(1),c.setLong(this.m_Seq),c.markEnd();var l=s.crc32_buf(new Uint8Array(n,0,c.getLen()),0);c.setUint32(l),c.markEnd(),0!=this.m_Key&&new Uint8Array(n,8,c.getLen()-8).forEach(function(e,t,o){o[t]=e^this.m_Key}.bind(this)),this.m_Ws.send(c.getArrayBuffer());var d=c.getLen();return d>this.maxSendLen&&(this.maxSendLen=d,console.log("nettest game maxSend "+this.maxSendLen+" ptl "+e)),!0},e.prototype.listenProtocol=function(e,t,o){cc.director.on("msg_"+e,function(e,i){cc.isValid(o)?(e.resetPos(),t.call(o,e,i)):cc.director.targetOff(o)},o)},e.prototype.listenExtraMsg=function(e,t,o){cc.director.on("extra_"+e,function(e){cc.isValid(o)?t.call(o,e):cc.director.targetOff(o)},o)},e.prototype.listenLocalMessage=function(e,t,o,i){void 0===i&&(i=!1),i?cc.director.once("loacl_"+e,t,o):cc.director.on("loacl_"+e,t,o)},e.prototype.pushLocalMessage=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];cc.director.emit("loacl_"+String(e),t)},e.prototype.pushStringMessage=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];cc.director.emit("string_"+String(e),t)},e.prototype.listenStringMessage=function(e,t,o,i){void 0===i&&(i=!1),i?cc.director.once("string_"+e,t,o):cc.director.on("string_"+e,t,o)},e.prototype.removeMessageTarget=function(e){cc.director.targetOff(e)},e.prototype.unlistenProtocol=function(e){cc.director.off("msg_"+e)},e.prototype.unlistenLocalMessage=function(e,t,o){cc.director.off("loacl_"+e,t,o)},e.prototype.removeLocalMessage=function(e,t){cc.director.off("loacl_"+e,null,t)},e.prototype.onOpen=function(){this.m_SendPingTime=0,this.m_Seq=c.fromNumber(0),this.m_Key=0,this.m_Ws.readyState==WebSocket.OPEN&&(this.stopSendPing(),this.startSendPing(),cc.director.emit("extra_"+String(i.EXTRA_MSG_CONNCET_SUCCEED),i.EXTRA_MSG_CONNCET_SUCCEED))},e.prototype.onClose=function(e){p.default.log("onClose~~~~~"+e.reason),this.m_msgQueue.clear(),cc.director.emit("extra_"+String(i.EXTRA_MSG_CLOSE),e)},Object.defineProperty(e.prototype,"WaitingMsg",{get:function(){return this.m_WaitingMsg},enumerable:!1,configurable:!0}),e.prototype.startSendPing=function(){var e=this;null===this.m_PingHandle&&(this.m_PingHandle=setInterval(function(){e.SendPing()},3e4)),this.m_SendPingTime=0},e.prototype.stopSendPing=function(){null!==this.m_PingHandle&&(clearInterval(this.m_PingHandle),this.m_PingHandle=null)},e.prototype.SendPing=function(){var e=l.TimeOffSetManager.getServerUTCSecond();this.m_SendPingTime>0?e-this.m_SendPingTime>60&&cc.director.emit("extra_"+String(i.EXTRA_MSG_PING_FAIL),i.EXTRA_MSG_PING_FAIL):this.m_SendPingTime=e;var t=new u.C_Login_Ping;this.Send(u.LOGIN_CLIENT_ENUM.P_Login_Ping,t)},e.prototype.onError=function(){cc.log("onError~~~~~")},e.prototype.onMessage=function(t){var o=new r.DataViewReader(t.data);if(o.getLen()<8)return cc.error("msg len Error!!!"),void this.Disconnect();o.getUint32();var i=o.getUint32(),a=o.getLen()-8,s=new r.DataViewReader(o.getBuffer(),o.getOffset()+o.getPos(),a);cc.director.emit("msg_"+i,s,i),this.m_RecvCallback&&this.m_RecvCallback(i);var c=a;if(c>this.maxRecvLen&&(this.maxRecvLen=c,console.log("nettest game maxRecv "+this.maxRecvLen+" ptl "+i)),this.m_msgQueue.has(i)){this.m_msgQueue.delete(i);var l=this.m_msgQueue.keys().next().value;l&&this.m_msgQueue.has(l)&&this.SendSociatyMessage(l,this.m_msgQueue.get(l))}1==new Set([d.ROLE_CLIENT_ENUM.P_Role_Add_Fight_Cooperation_Num,d.ROLE_CLIENT_ENUM.P_Role_ReceiveFightWinExtra,d.ROLE_CLIENT_ENUM.P_Role_ReceiveFightLoserProtect,d.ROLE_CLIENT_ENUM.P_Role_TakeTask,d.ROLE_CLIENT_ENUM.P_Role_RandShopRefresh,d.ROLE_CLIENT_ENUM.P_Role_RandRechargeRefresh,d.ROLE_CLIENT_ENUM.P_Role_Cost_Get,h.SOCIATY_CLIENT_ENUM.P_Sociaty_RoleDonate,d.ROLE_CLIENT_ENUM.P_Role_TakeTaskBox]).has(i)&&e.getInstance().pushLocalMessage(n.LOCAL_MESSAGE.LocalMsg_JumpAdGetReward,s,i)},e.prototype.SendSociatyMessage=function(e,t){var o=new ArrayBuffer(1048576),i=new r.DataViewWriter(o);i.advance(8),t&&t.write(i),i.markEnd(),i.resetPos(),i.setInt32(i.getLen()+8+4),i.setInt32(e),i.resetPos(),i.advance(i.getLen()),this.m_Seq=this.m_Seq.add(1),i.setLong(this.m_Seq),i.markEnd();var a=s.crc32_buf(new Uint8Array(o,0,i.getLen()),0);i.setUint32(a),i.markEnd(),0!=this.m_Key&&new Uint8Array(o,8,i.getLen()-8).forEach(function(e,t,o){o[t]=e^this.m_Key}.bind(this)),this.m_Ws.send(i.getArrayBuffer());var n=i.getLen();return n>this.maxSendLen&&(this.maxSendLen=n,console.log("nettest game maxSend "+this.maxSendLen+" ptl "+e)),!0},Object.defineProperty(e.prototype,"RecvCallback",{set:function(e){this.m_RecvCallback=e},enumerable:!1,configurable:!0}),e.prototype.getWssCacert=function(){var e=cc.resources.getInfoWithPath("cacert").uuid;return cc.assetManager.utils.getUrlWithUuid(e,{isNative:!0,nativeExt:".pem"})},e.prototype.addTagPtl=function(e){this.m_tagPtl.set(e,1)},e.prototype.isTagPtl=function(e){return this.m_tagPtl.has(e)},e.prototype.setKey=function(e){this.m_Key=e},e.s_Ins=null,e}();o.ClientNetwork=f,cc._RF.pop()},{"../Global/GameGlobal":"GameGlobal","../utils/LogUtil":"LogUtil","../utils/TimeOffSetManager":"TimeOffSetManager","./CheckCRC":"CheckCRC","./LocalMessage":"LocalMessage","./protocol/DataViewRW":"DataViewRW","./protocol/LoginProtocols":"LoginProtocols","./protocol/RoleProtocols":"RoleProtocols","./protocol/SociatyProtocols":"SociatyProtocols","./protocol/long":"long"}],CombatManager:[function(e,t,o){"use strict";cc._RF.push(t,"93d9b0RO6BHzp52vXSYshNe","CombatManager"),o.__esModule=!0,o.default=void 0;var i=e("../network/protocol/FightProtocols"),a=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=k();if(t&&t.has(e))return t.get(e);var o={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var n=i?Object.getOwnPropertyDescriptor(e,a):null;n&&(n.get||n.set)?Object.defineProperty(o,a,n):o[a]=e[a]}return o.default=e,t&&t.set(e,o),o}(e("../common/CombatModule")),n=e("../Global/GameGlobal"),r=e("../network/ClientNetwork"),s=e("../network/FightNetwork"),c=B(e("../network/LockStepManager")),l=e("../network/protocol/BaseProtocols"),d=e("../network/protocol/TypeProtocols"),u=B(e("../utils/ConfigUtils")),h=B(e("../utils/Tools")),p=e("../utils/UIManager"),f=B(e("./BatchModel")),g=B(e("./FightResultView")),m=B(e("./PlayerCombatModel")),_=B(e("./unit/CarObj")),y=B(e("./unit/FlyingObj")),v=B(e("./unit/NpcObj")),C=B(e("./unit/ObstacleObj")),S=B(e("../common/PlayerModule")),T=B(e("../modules/base/GameView")),I=e("../utils/TimeOffSetManager"),N=e("../utils/GameUtils"),b=B(e("../modules/manager/LoadResManager")),w=(B(e("../modules/manager/cheat/CheatManager")),e("../utils/GamePlatform")),E=B(e("../utils/LogUtil")),P=B(e("../network/protocol/long")),R=B(e("../modules/manager/EventManager")),L=B(e("../common/EventConst")),A=B(e("../view/mainScene/CarSkinUtils")),D=B(e("../common/NetworkProtocolCommon")),M=(e("../modules/manager/cheat/SafeNumber"),B(e("../network/ReconnectLayer")));function B(e){return e&&e.__esModule?e:{default:e}}function k(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return k=function(){return e},e}var G=e("../utils/ConstValue"),O=G.Game_State,H=G.NPC_TYPE,V=G.NPC_STATE,F=G.Npc_Attr_Type,U=G.CAR_TEMPLATE_ID,x=G.PLAYER_IDENTITY,Y=G.PLAYER_CAMP,j=G.Car_Max_Level,W=function(){function e(){this.npcList={},this.flyingObjList={},this.carList={},this.obstacleList={},this.mapNode=null,this.campStartNode={},this.tbPlayerCombatModel={},this.cellNpcList=[],this.MaxStarHeroList={},this.gameState=O.Prepare,this.dropEquipTime=[],this.playerNpcNode=null,this.reconnectMsgList=[],this.storyState=!1,this.sendFightResultMsg=!1}e.getInstance=function(){if(!this.Instance){this.Instance=new e,cc.director.kSpeed=1;var t=cc.Director.prototype.calculateDeltaTime;cc.Director.prototype.calculateDeltaTime=function(e){t.call(this,e),this._deltaTime*=this.kSpeed}}return this.Instance};var t=e.prototype;return t.initMap=function(e,t,o,i,r,l,p){var g=this;this.exitMap(),n.G.CheatTables.begin(),this.sendFightResultMsg=!1,this.resetAllData(),this.mapNode=t,this.campStartNode[Y.myPlayer]=o,this.campStartNode[Y.opponents]=i,this.controller=r,this.enemyCarNode=l,this.coCarNode=p;var m=a.default.getMatchBattleInfo(!1);m&&(0==m.bRobot?(this.lockStepManager=new c.default,this.lockStepManager.init(),this.lockStepManager.resetFrameIndex()):s.FightNetwork.getInstance().Disconnect()),this.batchModel=new f.default;var _=2;this.isCoop()?(_=U.coop_back,a.default.matchRoleIdentity==x.away&&(_=U.coop_front,this.campStartNode[Y.myPlayer]=this.coCarNode,this.coCarNode=o),this.campStartNode[Y.coopPlayer]=p,a.default.matchType==d.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE&&(this.campStartNode[Y.opponentsCoop]=l)):a.default.getCombatType()!=a.CombatType.SOLO&&a.default.getCombatType()!=a.CombatType.DUEL||(_=U.pvp);var y=a.default.matchReconnectData;if(this.gameState==O.Reconnect&&null!=y){this.batchModel.init(this,e,y.waveTimelineIndex,y.wave),this.batchModel.npcId=y.bossIDIndex,this.batchModel.lastTime=y.battleState,-1==y.battleState?this.batchModel.nBatchDelayTime=y.sceneTime:-2==y.battleState||(this.batchModel.lastTime=y.sceneTime);var v=this.getReconnectPlayerInfo(y.playerInfo,a.default.matchRoleIdentity),C=1,T=1,I=0,b=0,w=0;v&&(C=v.carLevel,T=v.carSummonIndex%1e4,0==v.combosNum?(I=v.killValue,w=0):(I=v.combosNum,w=v.killValue),b=(v.carSummonIndex-T)/1e4),this.selfCombatModel=this.initPlayerCombatModel(Y.myPlayer,_,C);var E=this.getController().getMyPlayerSilver(),P=v.sp,R=Math.max(E,P);for(var L in console.log("silversync my="+E+", reco="+P+" use="+R),this.selfCombatModel.setMoney(R),this.getController().setMyPlayerSilver(0),this.selfCombatModel.setCarRefreshCount(v.spRand),this.selfCombatModel.combatStatistic.refreshTimes=v.spRand-1,this.selfCombatModel.setCardIdVec(v.cardIdVec),v.heroSummonedIdVec){var A=1e5*Math.round(v.heroSummonedIdVec[L]/1e5);this.selfCombatModel.carInfo.tbHeroSummonedNum[A]=v.heroSummonedIdVec[L]}if(v)for(var D in v.heroVector){var M=v.heroVector[D].level,B=v.heroVector[D].heroID,k=v.heroVector[D].starLevel,G=v.heroVector[D].heroPos,V=v.heroVector[D].attr,F=v.heroVector[D].skillVector,j=v.heroVector[D].buffVector;if(M>0){var W=u.default.getInstance().getHeroConfig(B);this.selfCombatModel.carInfo.tbBindHeroInfo[G]={templateId:B,pos:G,level:M,npcTemplateId:W.npc_id,starLevel:k,attr:V,skill:F,buff:j},this.selfCombatModel.carInfo.tbHeroList[B]={id:h.default.getInstance().genId(),templateId:B,starLevel:k,pos:G,npcTemplateId:W.npc_id,level:M},this.selfCombatModel.carInfo.tbHeroPosInfo[G]=B,this.selfCombatModel.carInfo.heroNum=this.selfCombatModel.carInfo.heroNum+1}}this.selfCarObj=this.createCar(this.selfCombatModel.carInfo,this.selfCombatModel.camp,this.campStartNode[1],T,I,b,w),this.selfCarObj.hp=v.hp,this.selfCarObj.tmpHp=v.hp,this.selfCarObj.carTmpHp=v.hp,this.selfCarObj.tmpMaxHp=v.maxHp,this.selfCarObj.maxHp=v.maxHp;var z=u.default.getInstance().getNavigationStarParam(b);a.default.matchType==d.FIGHT_TYPE.FIGHT_TYPE_COOPERATION?z=u.default.getInstance().getStarParam(b):a.default.matchType==d.FIGHT_TYPE.FIGHT_TYPE_WEEK_COOPERATION?z=u.default.getInstance().getWeekCoopStarParam(b):a.default.matchType==d.FIGHT_TYPE.FIGHT_TYPE_MACHINARIUM?z=u.default.getInstance().getMachineryCityStarParam(b):a.default.matchType==d.FIGHT_TYPE.FIGHT_TYPE_FOG_HIDDEN&&(z=u.default.getInstance().getFogHiddenStarParam(1));var K=1,q=1;this.isCoop()?(z&&(K=.01*(z=a.default.matchType==d.FIGHT_TYPE.FIGHT_TYPE_COOPERATION?u.default.getInstance().getStarParam(y.wave):a.default.matchType==d.FIGHT_TYPE.FIGHT_TYPE_WEEK_COOPERATION?u.default.getInstance().getWeekCoopStarParam(y.wave):a.default.matchType==d.FIGHT_TYPE.FIGHT_TYPE_FOG_HIDDEN?u.default.getInstance().getFogHiddenStarParam(1):a.default.matchType==d.FIGHT_TYPE.FIGHT_TYPE_MACHINARIUM?u.default.getInstance().getMachineryCityStarParam(y.wave):u.default.getInstance().getNavigationStarParam(y.wave)).starParam_att_coop,q=.01*z.starParam_hp_coop),this.initOtherPlayerCombatModel(Y.coopPlayer,U.coop_front,1),a.default.matchType==d.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE?(this.initPlayerCombatModel(Y.opponents,U.coop_front,1),this.initPlayerCombatModel(Y.opponentsCoop,U.coop_back,1)):this.initPlayerCombatModel(Y.opponents,U.pvp,6)):z&&(K=.01*z.starParam_att,q=.01*z.starParam_hp,this.initPlayerCombatModel(Y.opponents,U.pvp,1));var Q=y.monsters;for(var X in Q){var J=Q[X];if(J){var Z=J.id,$=J.gid,ee=J.speed,te=Number(J.distanceX),oe=Number(J.distanceY),ie=J.roleID.equals(S.default.UUID)?Y.myPlayer:Y.opponents;if(this.isCoop()){if(J.blood.type!=H.Car){var ae=a.default.getMatchBattleInfo(!1);J.roleID.equals(ae.roleID)?a.default.matchRoleIdentity==x.home?ie=Y.coopPlayer:a.default.matchRoleIdentity==x.away&&(ie=Y.myPlayer):ie=Y.opponents,this.summon(Z,ee,ie,te,oe,!1,K,q,$)}}else if(this.isPvP()&&ie==Y.opponents){te*=-1;var ne=Number((0,N.getConfigIntValue)("pvp_boss_id"));a.default.matchType==d.FIGHT_TYPE.FIGHT_TYPE_BATTLE_EAT_CHICKEN&&(ne=Number((0,N.getConfigIntValue)("pvp_boss_id_eatchicken"))),Z>600&&Z!=Number(ne)&&(Z=Number(Z)+100),J.blood.type!=H.Car&&this.summon(Number(Z),ee,ie,te,oe,!1,K,q,$)}}}y.reportData.fightRoleInfo.forEach(function(e,t){t.equals(S.default.UUID)&&(g.selfCombatModel.combatStatistic.slivers=e.cumulativeSp,g.selfCombatModel.combatStatistic.maxSlivers=e.maxSp,g.selfCombatModel.combatStatistic.heros=e.heros,g.selfCombatModel.combatStatistic.mosters=e.typeMonster)})}else this.gameState=O.Prepare,this.batchModel.init(this,e),this.selfCombatModel=this.initPlayerCombatModel(Y.myPlayer,_,1),this.selfCarObj=this.createCar(this.selfCombatModel.carInfo,this.selfCombatModel.camp,this.campStartNode[1]),this.isCoop()?(this.initOtherPlayerCombatModel(Y.coopPlayer,U.coop_front,1),a.default.matchType==d.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE?(this.initPlayerCombatModel(Y.opponents,U.coop_front,1),this.initPlayerCombatModel(Y.opponentsCoop,U.coop_back,1)):this.initPlayerCombatModel(Y.opponents,U.pvp,6)):this.initPlayerCombatModel(Y.opponents,U.pvp,1)},t.getReconnectPlayerInfo=function(e,t){for(var o in e)if(e[o].roleIdentity==t)return e[o];return null},t.resetAllData=function(){this.npcList={},this.flyingObjList={},this.carList={},this.obstacleList={},this.mapNode=null,this.campStartNode={},this.tbPlayerCombatModel={},this.cellNpcList=[],this.MaxStarHeroList={},h.default.getInstance().resetId(),this.lockStepManager&&(this.lockStepManager.onDestroy(),this.lockStepManager=null),this.batchModel&&this.batchModel.onDestroy(),this.batchModel=null,a.default.removeDropEquips(),this.reconnectMsgList=[],this.storyState=!1},t.exitMap=function(){n.G.CheatTables.stop(),this.removeAllPassiveEvent();try{for(var e in this.npcList)this.npcList[e]&&(this.npcList[e].destroy(),this.npcList[e]=null);for(var e in this.flyingObjList)this.flyingObjList[e]&&(this.flyingObjList[e].destroy(),this.flyingObjList[e]=null);for(var t in this.carList)this.carList[t]&&(this.carList[t].destroy(),this.carList[t]=null);for(var e in this.obstacleList)this.obstacleList[e]&&(this.obstacleList[e].destroy(),this.obstacleList[e]=null);for(var t in this.tbPlayerCombatModel)this.tbPlayerCombatModel[t]&&(this.tbPlayerCombatModel[t]=null)}catch(o){console.log("exitMap \u51fa\u9519\u4e86"+o)}this.npcList={},this.flyingObjList={},this.carList={},this.obstacleList={},this.MaxStarHeroList={},this.tbPlayerCombatModel={},h.default.getInstance().resetId(),this.lockStepManager&&(this.lockStepManager.onDestroy(),this.lockStepManager=null),this.batchModel&&this.batchModel.onDestroy(),this.batchModel=null,a.default.removeDropEquips(),this.reconnectMsgList=[],this.storyState=!1},t.getController=function(){return this.controller},t.getSelfCombatModel=function(){return this.selfCombatModel},t.getSelfCar=function(){return this.selfCarObj},t.deleteHero=function(e,t){this.selfCarObj.deleteHero(e,t)},t.beginGame=function(){this.controller.beginGame(),this.gameState=O.Fighting},t.restart=function(){this.batchModel.init(this,1),this.selfCombatModel.restart(),this.selfCarObj=this.createCar(this.selfCombatModel.carInfo,this.selfCombatModel.camp,this.campStartNode[1]),this.beginGame()},t.resetHeroState=function(){for(var e in this.getSelfCar().heroList){var t=this.getSelfCar().heroList[e];t&&(t.state=V.IDLE)}},t.initPlayerCombatModel=function(e,t,o){this.tbPlayerCombatModel[e]&&(this.tbPlayerCombatModel[e]=null),a.default.matchType==d.FIGHT_TYPE.FIGHT_TYPE_BATTLE_EAT_CHICKEN&&(o=6),a.default.matchType==d.FIGHT_TYPE.FIGHT_TYPE_BATTLE_GREAT_SAILING&&(t=U.pvp),this.tbPlayerCombatModel[e]=new m.default;var i=(0,N.getRoleIdentity)(e);return a.default.matchType==d.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE&&(e!=Y.opponents&&e!=Y.opponentsCoop||(i=e==Y.opponents?Y.opponents+1:Y.opponentsCoop)),this.tbPlayerCombatModel[e].initData(e,i,t,o),this.tbPlayerCombatModel[e]},t.initOtherPlayerCombatModel=function(e,t,o){this.isCoop()&&a.default.matchRoleIdentity==x.away&&(t=U.coop_back),this.initPlayerCombatModel(e,t,o)},t.getPlayerModelByCamp=function(e){return this.tbPlayerCombatModel[e]},t.getMyPlayerSilver=function(){var e=this.getPlayerModelByCamp(Y.myPlayer);return e?e.getCurMoney():0},t.createCar=function(e,t,o,i,n,r,s){var c=this;void 0===i&&(i=1),void 0===n&&(n=0),void 0===r&&(r=0),void 0===s&&(s=0);var l=new _.default;l.setCamp(t),l.initCampParam(),l.setSummonIndex(i),l.setSummonLastTime(n),l.setSummonBatchIndex(r),l.setSummonDelayTIme(s),l.setResInitCompleteFunc(function(){if(t==Y.myPlayer){var o=a.default.getPetId(!0),i=u.default.getInstance().getItemByID(o);i&&(0,N.showCombatPet)(l.node,i.spineId,(0,N.getSlotNameByCarLv)(e.level))}else{var n=a.default.getPetId(!1);if(!c.isCoop()||t!=Y.opponents&&t!=Y.opponentsCoop||(n=0),n){var r=u.default.getInstance().getItemByID(n);r&&(0,N.showCombatPet)(l.node,r.spineId,(0,N.getSlotNameByCarLv)(e.level))}}});var d=a.default.getCarSkinId(t);if(d>0&&d!=A.default.CAR_DEFAULT_SKIN_ID){var h=A.default.Instance.getCarTableDataResIdOffset(d);l.setNpcIdOffset(h)}return l.init(e,o,cc.v2(0,0)),this.npcList[e.id]=l,this.carList[t]=l,l},t.deleteCardByCamp=function(e){this.carList[e],delete this.carList[e]},t.getCarByCamp=function(e){return this.carList[e]},t.summon=function(e,t,o,i,n,r,s,c,l,d){void 0===l&&(l=0),void 0===d&&(d=0),i=i||0,n=n||0;var u=l=l||h.default.getInstance().genId();if(this.npcList[u])9991001!=u&&9992001!=u||D.default.callRoleClientLog("summonBoss id="+u+" wrong");else{var p=new v.default;if(s&&(p.starAttParam=s),c&&(p.starHpParam=c),this.isCoop()&&(a.default.matchRoleIdentity==x.home&&o==Y.myPlayer?o=Y.coopPlayer:a.default.matchRoleIdentity==x.away&&o==Y.coopPlayer&&(o=Y.myPlayer),this.isSkyCastle()&&o==Y.opponentsCoop&&(o=Y.opponents)),p.setCamp(o),p.initCampParam(),r&&o==Y.opponents?(516==e&&(i-=100),p.init(u,e,t,this.campStartNode[o],cc.v2(i,n))):o==Y.myPlayer||o==Y.coopPlayer?p.init(u,e,t,this.playerNpcNode,cc.v2(i,n)):p.init(u,e,t,this.campStartNode[o],cc.v2(i,n)),d&&p.modAttr(F.attack,Number(d)-p.attr[F.attack]),p.node&&cc.isValid(p.node)&&(p.node.zIndex=1e3),this.lockStepManager){var f=this.lockStepManager.getMosterBlood(l);f&&(p.hp=f.curBlood,p.tmpHp=f.curBlood,p.tmpMaxHp=f.maxBlood,p.maxHp=f.maxBlood,f.curBlood<=0&&p.state!=V.Dead&&(this.lockStepManager.addMoney(p.camp,f.extraDropMoney,p.dropMoney,p.isBoss()),cc.director.emit("Event_KillTarget",f.heroId,p.id)),p.onRefreshHpBar())}this.npcList[u]=p,cc.director.emit("Event_SummonNpc",o,p.id)}},t.summonCar=function(e,t,o,i){if(this.isCoop()||this.isPvP()){var n=null;if(this.isCoop()?t==Y.opponents?n=this.campStartNode[Y.opponents]:t==Y.opponentsCoop?n=this.campStartNode[Y.opponentsCoop]:(n=this.coCarNode,a.default.matchRoleIdentity==x.away&&U.coop_back):this.isPvP()&&(n=this.campStartNode[2]),n){var r=a.default.matchReconnectData,s=null;if(this.gameState==O.Reconnect&&null!=r){var c=a.default.matchRoleIdentity==x.home?x.away:x.home,l=null;if(!this.isCoop()||t!=Y.opponents&&t!=Y.opponentsCoop)l=this.getReconnectPlayerInfo(r.playerInfo,c);else{var p=t;this.isSkyCastle()&&p==Y.opponents&&(p=Y.opponents+1),l=this.getReconnectPlayerInfo(r.playerInfo,p)}var f=1,g=1,m=0,_=0,y=0,v=this.getPlayerModelByCamp(t);if(l){for(var C in f=l.carLevel,g=l.carSummonIndex%1e4,0==l.combosNum?(m=l.killValue,y=0):(m=l.combosNum,y=l.killValue),_=(l.carSummonIndex-g)/1e4,v.setMoney(l.sp),v.setCarRefreshCount(l.spRand),v.combatStatistic.refreshTimes=l.spRand-1,v.setCardIdVec(l.cardIdVec),v.carInfo.level=f,l.heroSummonedIdVec){var T=1e5*Math.round(l.heroSummonedIdVec[C]/1e5);v.carInfo.tbHeroSummonedNum[T]=l.heroSummonedIdVec[C]}for(var I in l.heroVector){o=l.heroVector[I].level;var b=l.heroVector[I].heroID,w=l.heroVector[I].starLevel,E=l.heroVector[I].heroPos,P=l.heroVector[I].attr,R=l.heroVector[I].skillVector,L=l.heroVector[I].buffVector;if(o>0){var A=u.default.getInstance().getHeroConfig(b);v.carInfo.tbBindHeroInfo[E]={templateId:b,pos:E,level:o,npcTemplateId:A.npc_id,starLevel:w,attr:P,skill:R,buff:L},v.carInfo.tbHeroList[b]={id:h.default.getInstance().genId(),templateId:b,starLevel:w,pos:E,npcTemplateId:A.npc_id,level:o},v.carInfo.tbHeroPosInfo[E]=b,v.carInfo.heroNum=v.carInfo.heroNum+1}}(s=this.createCar(v.carInfo,v.camp,n,g,m,_,y)).hp=l.hp,s.tmpHp=l.hp,s.carTmpHp=l.hp,s.maxHp=l.maxHp,s.tmpMaxHp=l.maxHp,s.aiInfo=l.aiInfo}var D=u.default.getInstance().getNavigationStarParam(_);a.default.matchType==d.FIGHT_TYPE.FIGHT_TYPE_COOPERATION?D=u.default.getInstance().getStarParam(_):a.default.matchType==d.FIGHT_TYPE.FIGHT_TYPE_WEEK_COOPERATION?D=u.default.getInstance().getWeekCoopStarParam(_):a.default.matchType==d.FIGHT_TYPE.FIGHT_TYPE_FOG_HIDDEN?D=u.default.getInstance().getFogHiddenStarParam(1):a.default.matchType==d.FIGHT_TYPE.FIGHT_TYPE_MACHINARIUM&&(D=u.default.getInstance().getMachineryCityStarParam(_));var M=1,B=1;this.isCoop()?D&&(M=.01*(D=a.default.matchType==d.FIGHT_TYPE.FIGHT_TYPE_COOPERATION?u.default.getInstance().getStarParam(r.wave):a.default.matchType==d.FIGHT_TYPE.FIGHT_TYPE_WEEK_COOPERATION?u.default.getInstance().getWeekCoopStarParam(r.wave):a.default.matchType==d.FIGHT_TYPE.FIGHT_TYPE_FOG_HIDDEN?u.default.getInstance().getFogHiddenStarParam(1):a.default.matchType==d.FIGHT_TYPE.FIGHT_TYPE_MACHINARIUM?u.default.getInstance().getMachineryCityStarParam(r.wave):u.default.getInstance().getNavigationStarParam(r.wave)).starParam_att_coop,B=.01*D.starParam_hp_coop):D&&(M=.01*D.starParam_att,B=.01*D.starParam_hp);var k=r.monsters;for(var G in k){var V=k[G];if(V&&!this.npcList[V.gid]){var F=V.id,j=V.gid,W=V.speed,z=Number(V.distanceX),K=Number(V.distanceY),q=V.roleID.equals(S.default.UUID)?Y.myPlayer:Y.opponents;if(this.isCoop()){var Q=a.default.getMatchBattleInfo(!1);V.roleID.equals(Q.roleID)?a.default.matchRoleIdentity==x.home?q=Y.coopPlayer:a.default.matchRoleIdentity==x.away&&(q=Y.myPlayer):q=Y.opponents}if(V.blood.type!=H.Car){z*=-1;var X=Number((0,N.getConfigIntValue)("pvp_boss_id"));a.default.matchType==d.FIGHT_TYPE.FIGHT_TYPE_BATTLE_EAT_CHICKEN&&(X=Number((0,N.getConfigIntValue)("pvp_boss_id_eatchicken"))),this.isPvP()&&F>600&&F!=X&&(F=Number(F)-100),this.summon(Number(F),W,q,z,K,!1,M,B,j)}else if(this.isCoop()&&V.blood.type==H.Car&&1!=j&&3!=j&&a.default.matchType==d.FIGHT_TYPE.FIGHT_TYPE_COOPERATION){var J=u.default.getInstance().getCarConfig(V.sp);J&&this.summonCoopBossCar(V.gid,V.sp,J.bind_hero_list)}}}r.reportData.fightRoleInfo.forEach(function(e,t){t.equals(S.default.UUID)||(v.combatStatistic.slivers=e.cumulativeSp,v.combatStatistic.maxSlivers=e.maxSp,v.combatStatistic.heros=e.heros,v.combatStatistic.mosters=e.typeMonster)})}else{var Z=this.getPlayerModelByCamp(t);s=this.createCar(Z.carInfo,Z.camp,n)}if(s)if(a.default.matchType!=d.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE||t!=Y.opponents&&t!=Y.opponentsCoop){var $=a.default.getMatchBattleInfo(!1);$?1==$.bRobot&&s.setAutoAI(i,$.aiid):s.setAutoAI(i,1)}else{var ee=1,te=a.default.getMatchBattleAIInfo(t);te&&(ee=te.aiid),Y.opponents,s.setAutoAI(i,ee)}}}else{var oe=this.getPlayerModelByCamp(t);(s=this.createCar(oe.carInfo,oe.camp,this.enemyCarNode)).setAutoAI(i,1)}},t.summonCoopBossCar=function(e,t,o){var i=this.getPlayerModelByCamp(Y.opponents);i.carInfo.id=e,i.carInfo.templateId=t;var a=o.split("|");for(var n in a){var r=a[n].split("#"),s=Number(r[0]),c=Number(r[1]),l=Number(r[2]),d=Number(r[3]);if(s>0){var h=u.default.getInstance().getHeroConfig(c);i.carInfo.tbBindHeroInfo[s]={templateId:c,pos:d,level:1,npcTemplateId:h.npc_id,starLevel:l},i.carInfo.tbHeroList[c]={id:c,templateId:c,starLevel:l,pos:d,npcTemplateId:h.npc_id,level:1}}}this.createCar(i.carInfo,Y.opponents,this.campStartNode[Y.opponents])},t.getNpcList=function(){return this.npcList},t.getNpcById=function(e){return this.npcList?this.npcList[e]:null},t.getflyingObjList=function(){return this.flyingObjList},t.emitFlyingObj=function(e,t,o,i,a,n){if(o||1!=n){var r=h.default.getInstance().genId(),s=new y.default;s.init(r,e,t,o,this.mapNode,i,a),this.flyingObjList[r]=s}},t.createObstacleObj=function(e,t,o,i,a){var n=h.default.getInstance().genId(),r=new C.default;r.init(n,e,t,o,this.mapNode,i,a),this.obstacleList[n]=r},t.onObstacleDie=function(e){this.obstacleList[e]=null,delete this.obstacleList[e]},t.onFlyingObjDie=function(e){this.flyingObjList[e]=null,delete this.flyingObjList[e]},t.onNpcDie=function(e){this.npcList[e]&&(this.npcList[e]=null),cc.director.emit("Event_NpcDie",this.camp)},t.isExistEnemyNpc=function(){var e=0;for(var t in this.npcList){var o=this.npcList[t];if(o&&o.camp==Y.opponents&&0==o.isDead()){e=1;break}}return e},t.clearCombat=function(){this.removeAllObstacle(),this.removeAllFlyingObj(),this.removeAllNpc(),this.batchModel.onAllNpcDie(),this.resetHeroState()},t.onGameEnd=function(e,t){if(void 0===t&&(t=!1),this.getController()){var o=this.getController().getCheatValueCom();o&&o.stopPretect(),this.controller.showResultUI(e)}n.G.CheatTables.checkTableMemory(),this.gameState=O.End;try{this.removeAllPassiveEvent(),this.removeAllNpc(),this.removeCar(),this.removeAllObstacle(),this.removeAllFlyingObj()}catch(s){console.log("onGameEnd \u51fa\u9519\u5566"+s)}var i=T.default.getViewByName("MatchMainView");i&&i.view&&i.view.closeView(),this.reqFightResult(e);var r=T.default.getViewByName("BattleCardInfo");r&&r.view&&r.view.closeView(),a.default.matchReconnectData=null,this.controller&&this.controller.emojiTimer&&(clearInterval(this.controller.emojiTimer),this.controller.emojiTimer=null)},t.reqFightResult=function(e,t){if(void 0===t&&(t=!1),this.isCoop()||this.isPvP()){var o=null,n=a.default.getMatchBattleInfo(!0),c=a.default.getMatchBattleInfo(!1);if(c&&(o=1==c.bRobot?new i.C_Fight_Report_Result_To_Logic:new i.C_Fight_Report_Result_To_Fight),o){o.reportData.isWin=e,this.getController()&&(this.getController().bCheat&&o.reportData.params.push(8089),this.getController().bCheatTable&&o.reportData.params.push(8090),this.getController().bCheatTableFile&&o.reportData.params.push(8091),this.getController().bCheat8094&&o.reportData.params.push(8094),this.getController().bCheat8096&&o.reportData.params.push(8096)),a.default.getCombatType()==a.CombatType.SOLO?a.default.matchType==d.FIGHT_TYPE.FIGHT_TYPE_BATTLE_GOLDENLEAGUE?o.reportData.fightType=d.FIGHT_TYPE.FIGHT_TYPE_BATTLE_GOLDENLEAGUE:a.default.matchType==d.FIGHT_TYPE.FIGHT_TYPE_BATTLE_EAT_CHICKEN?o.fightType=d.FIGHT_TYPE.FIGHT_TYPE_BATTLE_EAT_CHICKEN:a.default.matchType==d.FIGHT_TYPE.FIGHT_TYPE_BATTLE_SOCIATY_WAR?(o.fightType=d.FIGHT_TYPE.FIGHT_TYPE_BATTLE_SOCIATY_WAR,o.reportData.fightType=d.FIGHT_TYPE.FIGHT_TYPE_BATTLE_SOCIATY_WAR):a.default.matchType==d.FIGHT_TYPE.FIGHT_TYPE_ANNIVERSARY_TRIAL?(o.fightType=d.FIGHT_TYPE.FIGHT_TYPE_ANNIVERSARY_TRIAL,o.reportData.fightType=d.FIGHT_TYPE.FIGHT_TYPE_ANNIVERSARY_TRIAL):o.reportData.fightType=d.FIGHT_TYPE.FIGHT_TYPE_BATTLE:a.default.getCombatType()==a.CombatType.COOP?a.default.matchType==d.FIGHT_TYPE.FIGHT_TYPE_BATTLE_GREAT_SAILING?(o.reportData.fightType=d.FIGHT_TYPE.FIGHT_TYPE_BATTLE_GREAT_SAILING,o.reportData.isWin=this.batchModel.isWin):a.default.matchType==d.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE?(o.reportData.fightType=d.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE,o.reportData.isWin=e):a.default.matchType==d.FIGHT_TYPE.FIGHT_TYPE_WEEK_COOPERATION?(o.reportData.fightType=d.FIGHT_TYPE.FIGHT_TYPE_WEEK_COOPERATION,o.reportData.isWin=this.batchModel.isWin):a.default.matchType==d.FIGHT_TYPE.FIGHT_TYPE_FOG_HIDDEN?(o.reportData.fightType=d.FIGHT_TYPE.FIGHT_TYPE_FOG_HIDDEN,o.reportData.isWin=this.batchModel.isWin):a.default.matchType==d.FIGHT_TYPE.FIGHT_TYPE_MACHINARIUM?(o.reportData.fightType=d.FIGHT_TYPE.FIGHT_TYPE_MACHINARIUM,o.reportData.isWin=this.batchModel.isWin):(o.reportData.fightType=d.FIGHT_TYPE.FIGHT_TYPE_COOPERATION,o.reportData.isWin=this.batchModel.isWin):a.default.getCombatType()==a.CombatType.DUEL&&(o.reportData.fightType=d.FIGHT_TYPE.FIGHT_TYPE_DUEL_BATTLE),o.reportData.fightModule=a.default.matchModule;var u=new l.T_Fight_Role_Detail_Info;u.roleID=S.default.UUID,u.round=this.batchModel?this.batchModel.getIndexTip():0,u.roleAbstract=n;var h=this.getSelfCombatModel();try{h&&(u.round<h.combatStatistic.maxRound&&(u.round=h.combatStatistic.maxRound),h.combatStatistic.recordAllHeroCardLevel(Y.myPlayer),u.maxSp=h.combatStatistic.maxSlivers,u.cumulativeSp=h.combatStatistic.slivers,u.heros=h.combatStatistic.heros,h.combatStatistic.heros.forEach(function(e){console.log("recordAllHeroCardLevel my report "+e.cardLevel)}),u.typeMonster=h.combatStatistic.mosters,u.statisticInfo=h.combatStatistic.getBattleDetails(Y.myPlayer),this.HeroCount8097(h.getHeroOnCarNum())>j&&o.reportData.params.push(8097),h.recordSliverChange(0,t))}catch(C){console.log("reqFightResult combatStatistic myPlayer"+C);var p=[];p.push("reqFightResult combatStatistic myPlayer"+C),w.GamePlatform.reportWXLog(p)}u.lastMonsterTime=I.TimeOffSetManager.utcTime(),o.reportData.fightRoleInfo.set(S.default.UUID,u);var f=new l.T_Fight_Role_Detail_Info;f.roleID=c.roleID,f.round=this.batchModel?this.batchModel.getIndexTip():0,h&&f.round<h.combatStatistic.maxRound&&(f.round=h.combatStatistic.maxRound),f.roleAbstract=c;var g=Y.opponents;this.isCoop()&&(g=Y.coopPlayer);try{var m=this.getPlayerModelByCamp(g);m&&(m.combatStatistic.recordAllHeroCardLevel(g),f.maxSp=m.combatStatistic.maxSlivers,f.cumulativeSp=m.combatStatistic.slivers,f.heros=m.combatStatistic.heros,m.combatStatistic.heros.forEach(function(e){console.log("recordAllHeroCardLevel other report "+e.cardLevel)}),f.typeMonster=m.combatStatistic.mosters,f.statisticInfo=m.combatStatistic.getBattleDetails(g))}catch(C){console.log("reqFightResult combatStatistic otherPlayer"+C);var _=[];_.push("reqFightResult combatStatistic otherPlayer"+C),w.GamePlatform.reportWXLog(_)}if(f.lastMonsterTime=I.TimeOffSetManager.utcTime(),o.reportData.fightRoleInfo.set(c.roleID,f),1==c.bRobot){var y=i.FIGHT_CLIENT_ENUM.P_Fight_Report_Result_To_Logic;1==t&&(y=i.FIGHT_CLIENT_ENUM.P_Fight_Report_Phase_Result_To_Logic),r.ClientNetwork.getInstance().Send(y,o),t||this.checkFightEndMessage()}else{var v=i.FIGHT_CLIENT_ENUM.P_Fight_Report_Result_To_Fight;1==t&&(v=i.FIGHT_CLIENT_ENUM.P_Fight_Report_Phase_Result_To_Fight),s.FightNetwork.getInstance().Send(v,o),t||this.checkFightEndMessage()}t&&o.reportData.fightType==d.FIGHT_TYPE.FIGHT_TYPE_BATTLE_GREAT_SAILING&&(this.controller.sailingSendPhaseNum++,this.checkSailingPhaseReport())}}else this.controller.showResultUI(e)},t.checkFightEndMessage=function(){try{var e=this;this.sendFightResultMsg=!0,this.controller.delayEvent(function(){e.sendFightResultMsg&&(D.default.callRoleClientLog("checkFightEndMessage fail"),n.G.StringManager.PopString(n.G.StringManager.getString("WAITING_FIGHT_RESULT_ERROR")),M.default.ShowReconnectLayer())},10)}catch(t){}},t.checkSailingPhaseReport=function(){try{if(0==S.default.checkModulerOnOffState(54))return}catch(i){return}console.log("phasereportnum check = "+this.controller.sailingSendPhaseNum);var e=[];e[0]="sailingP",e[1]=this.controller.sailingSendPhaseNum.toString(),w.GamePlatform.reportWXLog(e);var t=Number((0,N.getConfigIntValue)("greatsailing_max_phase"));if(!(this.controller.sailingSendPhaseNum<t||M.default.show())){var o=n.G.StringManager.getString("SOCKET_CLOSE");w.GamePlatform.showModalRestartAlert(o)||r.ClientNetwork.getInstance().Disconnect()}},t.removeAllNpc=function(){for(var e in this.npcList){var t=this.npcList[e];t&&t.onDie()}this.npcList={}},t.removeCar=function(){for(var e in this.carList){var t=this.carList[e];t&&(t.onDie(),this.carList[e]=null)}this.carList={}},t.removeCarByCamp=function(e){var t=this.carList[e];t&&t.onDie(),this.carList[e]=null},t.removeAllObstacle=function(){for(var e in this.obstacleList){var t=this.obstacleList[e];t&&t.onDie()}this.obstacleList={}},t.removeAllFlyingObj=function(){for(var e in this.flyingObjList){var t=this.flyingObjList[e];t&&(t.onDie(),this.flyingObjList[e]=null)}this.flyingObjList=[]},t.removeAllPassiveEvent=function(){for(var e in this.controller&&this.controller.unscheduleAllCallbacks(),cc.director.emit("passive_unActive"),this.npcList){var t=this.npcList[e];if(t&&(t.unBindPassiveEvent(),t.isCar()))for(var o in t.heroList)if(o<90){var i=t.heroList[o];i&&i.unBindPassiveEvent()}}},t.killTarget=function(e,t){var o=t.dropMoney+e.getKillRewardPlus(t.dropMoney),i=this.getPlayerModelByCamp(e.camp);if(i&&(i.addMoney(o),i.combatStatistic.countMosterNum(t.isBoss())),this.isCoop()){var a=this.getCoopPlayerByCamp(e.camp);a&&(a.addMoney(o),a.combatStatistic.countMosterNum(t.isBoss()))}},t.update=function(e){if(this.gameState==O.Fighting){var t=a.default.getMatchBattleInfo(!1);if(this.isCoop()){if(1==t.bRobot&&this.selfCarObj&&(this.selfCarObj.isDead()||this.selfCarObj.state==V.Dead)&&this.getCoopCarByCamp(this.selfCarObj.camp)&&(this.getCoopCarByCamp(this.selfCarObj.camp).isDead()||this.getCoopCarByCamp(this.selfCarObj.camp).state==V.Dead))return this.deleteCardByCamp(this.selfCarObj.camp),this.deleteCardByCamp(this.getCoopCarByCamp(this.selfCarObj.camp).camp),void this.onGameEnd(!1);if(1==t.bRobot&&a.default.matchType==d.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE&&this.getCarByCamp(Y.opponents)&&(this.getCarByCamp(Y.opponents).isDead()||this.getCarByCamp(Y.opponents).state==V.Dead))return void this.onGameEnd(!0)}else if(1==t.bRobot){if(this.selfCarObj.isDead()||this.selfCarObj.state==V.Dead)return void this.onGameEnd(!1);if(this.isPvP()&&this.getCarByCamp(Y.opponents)&&(this.getCarByCamp(Y.opponents).isDead()||this.getCarByCamp(Y.opponents).state==V.Dead))return void this.onGameEnd(!0)}var o=this.getNpcList();for(var i in o){var n=o[i];n?n.update(e):delete o[i]}var r=this.getflyingObjList();for(var i in r){var s=r[i];s&&s.update(e)}this.isCoop()&&a.default.matchType!=d.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE&&this.batchModel.update(e),this.lockStepManager&&this.lockStepManager.update(e)}},t.isPvP=function(){return a.default.getCombatType()==a.CombatType.SOLO||a.default.getCombatType()==a.CombatType.DUEL},t.isGreatSailing=function(){return a.default.getCombatType()==a.CombatType.COOP&&a.default.matchType==d.FIGHT_TYPE.FIGHT_TYPE_BATTLE_GREAT_SAILING},t.isFogHidden=function(){return a.default.getCombatType()==a.CombatType.COOP&&a.default.matchType==d.FIGHT_TYPE.FIGHT_TYPE_FOG_HIDDEN},t.isCoop=function(){return a.default.getCombatType()==a.CombatType.COOP},t.isSkyCastle=function(){return a.default.getCombatType()==a.CombatType.COOP&&a.default.matchType==d.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE},t.isSkyCastleEnemy=function(e){return this.isSkyCastle()&&(e==Y.opponents||e==Y.opponentsCoop)},t.isCoopPartner=function(e,t){return a.default.getCombatType()==a.CombatType.COOP&&(e%2==1&&t%2==1||e%2==0&&t%2==0)},t.getCoopCarByCamp=function(e){var t=null;return e==Y.coopPlayer?t=this.getSelfCar():e==Y.myPlayer?t=this.getCarByCamp(Y.coopPlayer):e==Y.opponents?t=this.getCarByCamp(Y.opponentsCoop):e==Y.opponentsCoop&&(t=this.getCarByCamp(Y.opponents)),t},t.getCoopCarCamp=function(e){return e==Y.coopPlayer?Y.myPlayer:e==Y.myPlayer?Y.coopPlayer:e==Y.opponents?Y.opponentsCoop:e==Y.opponentsCoop?Y.opponents:0},t.getOpponentsCarCamp=function(e){return e%2==1?Y.opponents:Y.myPlayer},t.getPvpPlayerByCamp=function(e){var t=null;return e==Y.opponents?t=this.getSelfCombatModel():e==Y.myPlayer&&(t=this.getPlayerModelByCamp(Y.opponents)),t},t.getCoopPlayerByCamp=function(e){var t=null;return e==Y.coopPlayer?t=this.getSelfCombatModel():e==Y.myPlayer?t=this.getPlayerModelByCamp(Y.coopPlayer):e==Y.opponents?t=this.getPlayerModelByCamp(Y.opponentsCoop):e==Y.opponentsCoop&&(t=this.getPlayerModelByCamp(Y.opponents)),t},t.coopHaveSamePassive=function(e,t){if(this.isCoop()){var o=u.default.getInstance().getPassiveSkillConfig(t);if(o&&0==o.buff)return!1;var i=this.getCoopCarByCamp(e.camp);if(i)for(var a in i.heroList){var n=i.heroList[a];if(n&&n.templateId==e.templateId&&(n.pPassiveSkillObjList&&n.pPassiveSkillObjList[t]||n.maxPassiveSkillObjList&&n.maxPassiveSkillObjList[t]))return!0}}return!1},t.getCoopSameHeroPS=function(e,t){if(this.isCoop()){var o=this.getCoopCarByCamp(e.camp);if(o)for(var i in o.heroList){var a=o.heroList[i];if(a&&a.templateId==e.templateId){if(a.pPassiveSkillObjList)for(var n in a.pPassiveSkillObjList)if(a.pPassiveSkillObjList[n]){var r=a.pPassiveSkillObjList[n].config.kind,s=a.pPassiveSkillObjList[n].templateId;if(t==r)return s}if(a.maxPassiveSkillObjList)for(var c in a.maxPassiveSkillObjList)if(a.maxPassiveSkillObjList[c]){var l=a.maxPassiveSkillObjList[c].config.kind,d=a.maxPassiveSkillObjList[c].templateId;if(t==l)return d}}}}return-1},t.getMaxStarHero=function(e){return this.MaxStarHeroList[e]?this.MaxStarHeroList[e]:-1},t.addMaxStarHero=function(e){this.MaxStarHeroList[e]?this.MaxStarHeroList[e]+=1:this.MaxStarHeroList[e]=1},t.deleteMaxStarHero=function(e){this.MaxStarHeroList[e]&&(this.MaxStarHeroList[e]-=1)},t.showFightResult=function(e){var t=this,o=function(e){var t=e.type,o=e.bWin,i=p.PrefabUrl.FightResultPPVE;t!=d.FIGHT_TYPE.FIGHT_TYPE_BATTLE&&t!=d.FIGHT_TYPE.FIGHT_TYPE_DUEL_BATTLE&&t!=d.FIGHT_TYPE.FIGHT_TYPE_BATTLE_GOLDENLEAGUE&&t!=d.FIGHT_TYPE.FIGHT_TYPE_BATTLE_EAT_CHICKEN&&t!=d.FIGHT_TYPE.FIGHT_TYPE_BATTLE_SOCIATY_WAR&&t!=d.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE&&t!=d.FIGHT_TYPE.FIGHT_TYPE_ANNIVERSARY_TRIAL||(i=o?p.PrefabUrl.FightResultPVPWIN:p.PrefabUrl.FightResultPVPLOSE),n.G.UIManager.showPopLayer(i,!0,!0,p.PopNodeTag.FightResultPVPWIN,p.PopNodeType.FullScreen,null).then(function(t){if(t&&cc.isValid(t)){var o=t.getComponent(g.default);o&&(o.setData(e),(0,N.setTouchEnabled)(!0),S.default.setFightBalanceData(null))}else{var i=[];i[0]="showPopLayer Error loadResFail",w.GamePlatform.reportWXLog(i),M.default.ShowReconnectLayer()}}).catch(function(e){cc.error(e.message);var t=[];t[0]="showPopLayer Error catch",t[1]=e.message,w.GamePlatform.reportWXLog(t),M.default.ShowReconnectLayer()})};if(this.isCoop())return o.call(this,e);if(!this.controller||!this.controller.isValid)return o.call(this,e);var i;i=0==e.bWin?a.default.getCarSkinId(Y.myPlayer):a.default.getCarSkinId(Y.opponents);var r=A.default.Instance.getCarSpineUrl(A.default.TYPE_BOOM,i);this.controller.scheduleOnce(function(){o.call(t,e)},2.3),b.default.loadSpineNode(r).then(function(o){0==e.bWin?o.parent=t.controller.playerNode1:o.parent=t.controller.playerNode2,o.scale=.4,o.getComponent(sp.Skeleton).timeScale=.5,o.getComponent(sp.Skeleton).setAnimation(0,"idle",!1)}).catch(function(e){E.default.info(e)})},t.clearNpcBlood=function(){var e=this.getNpcList();for(var t in e){var o=e[t];o&&o.clearDropBlood()}},t.onSendRoleBossDropItems=function(e,t,o,n){var r=a.default.getMatchBattleInfo(!0),c=a.default.getMatchBattleInfo(!1),l=new i.C_Fight_Operate_Equip_SYNC;l.carId=e,a.default.matchType==d.FIGHT_TYPE.FIGHT_TYPE_BATTLE_EAT_CHICKEN&&(l.carId=853),a.default.matchType==d.FIGHT_TYPE.FIGHT_TYPE_WEEK_COOPERATION&&(l.carId=40011),a.default.matchType==d.FIGHT_TYPE.FIGHT_TYPE_MACHINARIUM&&(l.carId=20625);var u=1;"skill"==o?u=2:"skillAgain"==o&&(u=3),l.target=1e3*(0,N.getRoleIdentity)(n)+u,this.isCoop()?!this.isSkyCastle()||n!=Y.opponents&&n!=Y.opponentsCoop?a.default.matchRoleIdentity==x.away?l.roleId=c.roleID:l.roleId=r.roleID:l.roleId=P.default.fromNumber(Y.opponents):l.roleId=t||r.roleID,l.operateType=i.OPERATE_TYPE.OPERATE_TYPE_DROP_EQUIP,s.FightNetwork.getInstance().Send(i.FIGHT_CLIENT_ENUM.P_Fight_Operate_Equip_SYNC,l);var h=[];h[0]="dropEquip",h[1]=o},t.onSendRoleSpecialEffect=function(e){var t=new i.C_Fight_Operate_Equip_SYNC;t.roleId=S.default.UUID,t.carId=a.default.matchRoleIdentity,"xiaoye"==e&&(t.target=1),t.operateType=i.OPERATE_TYPE.OPERATE_TYPE_SPECIAL_EFFECT,s.FightNetwork.getInstance().Send(i.FIGHT_CLIENT_ENUM.P_Fight_Operate_Equip_SYNC,t)},t.setReconnectData=function(){var e=a.default.matchReconnectData;if(this.gameState==O.Reconnect&&null!=e){var t=e.monsters;for(var o in t){var i=t[o],n=this.npcList[i.gid];i&&n&&(n.isCar()&&n.setReconnectData(),this.setMonsterReconnectData(i))}R.default.Instance.emit(L.default.BattleChangeHero,Y.myPlayer),R.default.Instance.emit(L.default.BattleChangeHero,Y.opponents)}},t.setMonsterReconnectData=function(t){var o=t.gid;if(this.npcList[o]&&t){var i=!1;for(var a in 1==t.attr.pop()&&(i=!0),this.npcList[o].setTheSummonerInfo(t.attr.pop(),i,t.attr.pop()),this.npcList[o].setNextSkillIndex(t.attr.pop()),this.npcList[o].summonedSustainTime=t.attr.pop(),this.npcList[o].setWhosyourdaddyState(t.attr.pop()),this.npcList[o].setCastSkillCount(t.attr.pop()),t.skillVector)if(t.skillVector[a])for(var n in this.npcList[o].pSkillObjList)this.npcList[o].pSkillObjList[n].templateId==t.skillVector[a].skillID&&((this.npcList[o].isBoss()||516==this.npcList[o].templateId)&&(this.npcList[o].pSkillObjList[n].deltaTime=t.skillVector[a].cdtime),this.npcList[o].pSkillObjList[n].randomSeed&&this.npcList[o].pSkillObjList[n].randomSeed.RandomSeed(this.npcList[o].getCastSkillCount()),1==t.physicalReduce&&(this.npcList[o].pSkillObjList[n].bReconnectDoSkill=!0));for(var r in this.npcList[o].removeAllBuff(),t.buffVector)if(t.buffVector[r]){var s=t.buffVector[r],c=null;if(0!=s.sourceGid)c=this.npcList[s.sourceGid];else if(0!=s.towerData.heroID){var l=this.npcList[s.towerData.roleIdentity];l&&(c=l.getHeroObjByHeroID(s.towerData.heroID))}for(var d in this.npcList[o].addBuff(t.buffVector[r].buffID,c),this.npcList[o].buffList)this.npcList[o].buffList[d].templateId==t.buffVector[r].buffID&&(this.npcList[o].buffList[d]._LastTime=t.buffVector[r].lifetime,this.npcList[o].buffList[d]._continueIntervalTime=t.buffVector[r].continueIntervalTime)}var u=this;if(t.behitCount.forEach(function(e,t){u.npcList[o].setBehitCount(t,e)}),10044==u.npcList[o].resId&&e.getInstance().isCoop()){var h=e.getInstance().getPlayerModelByCamp(Y.myPlayer),p=e.getInstance().getPlayerModelByCamp(Y.coopPlayer);h&&h.setBossChangeSpritRS(this.npcList[o].getCastSkillCount()),p&&p.setBossChangeSpritRS(this.npcList[o].getCastSkillCount())}this.npcList[o].setCritSeedRandom(this.npcList[o].getCastSkillCount()),this.npcList[o].setDodgeSeedRandom(this.npcList[o].getCastSkillCount()),this.npcList[o].hp=t.blood.curBlood,this.npcList[o].tmpHp=t.blood.curBlood,this.npcList[o].isCar()&&(this.npcList[o].carTmpHp=t.blood.curBlood),this.npcList[o].tmpMaxHp=t.blood.maxBlood,this.npcList[o].maxHp=t.blood.maxBlood,this.npcList[o].attr&&(this.npcList[o].attr=t.attr,this.npcList[o].onRefreshHpBar(),0!=this.npcList[o].attr[F.move_speed]&&(this.npcList[o].moveSpeed=t.attr[F.move_speed]))}},t.resumeReconnectMsg=function(){for(;0!=this.reconnectMsgList.length;){var e=this.reconnectMsgList.splice(0,1)[0];null!=e&&cc.director.emit("msg_"+e.ptl,e.message,e.ptl)}},t.setStoryState=function(e){this.storyState=e},t.getStoryState=function(){return this.storyState},t.HeroCount8097=function(e){return 0==S.default.checkModulerOnOffState(39)?0:e},t.recordXiaoYe=function(t,o,i,a,n){try{var r=null,s=null;e.getInstance().isCoop()&&(r=e.getInstance().getPlayerModelByCamp(Y.myPlayer),s=e.getInstance().getPlayerModelByCamp(Y.coopPlayer));var c=0;r&&r.combatStatistic&&(c=r.combatStatistic._round.value);var l=c+"\u6ce2 attackId="+t+" recvdamage="+o+" carTmpHp="+i+" tmpHp="+a+" hp="+n;r&&r.combatStatistic&&(console.log("xiaoye self"),r.combatStatistic.addXiaoYe(l)),s&&s.combatStatistic&&(console.log("xiaoye opponent"),s.combatStatistic.addXiaoYe(l));var d=[];d.push(l),w.GamePlatform.reportWXLog(d),e.getInstance().reqFightResult(!1,!0)}catch(u){}},e}();o.default=W,W.Instance=null,t.exports=o.default,cc._RF.pop()},{"../Global/GameGlobal":"GameGlobal","../common/CombatModule":"CombatModule","../common/EventConst":"EventConst","../common/NetworkProtocolCommon":"NetworkProtocolCommon","../common/PlayerModule":"PlayerModule","../modules/base/GameView":"GameView","../modules/manager/EventManager":"EventManager","../modules/manager/LoadResManager":"LoadResManager","../modules/manager/cheat/CheatManager":"CheatManager","../modules/manager/cheat/SafeNumber":"SafeNumber","../network/ClientNetwork":"ClientNetwork","../network/FightNetwork":"FightNetwork","../network/LockStepManager":"LockStepManager","../network/ReconnectLayer":"ReconnectLayer","../network/protocol/BaseProtocols":"BaseProtocols","../network/protocol/FightProtocols":"FightProtocols","../network/protocol/TypeProtocols":"TypeProtocols","../network/protocol/long":"long","../utils/ConfigUtils":"ConfigUtils","../utils/ConstValue":"ConstValue","../utils/GamePlatform":"GamePlatform","../utils/GameUtils":"GameUtils","../utils/LogUtil":"LogUtil","../utils/TimeOffSetManager":"TimeOffSetManager","../utils/Tools":"Tools","../utils/UIManager":"UIManager","../view/mainScene/CarSkinUtils":"CarSkinUtils","./BatchModel":"BatchModel","./FightResultView":"FightResultView","./PlayerCombatModel":"PlayerCombatModel","./unit/CarObj":"CarObj","./unit/FlyingObj":"FlyingObj","./unit/NpcObj":"NpcObj","./unit/ObstacleObj":"ObstacleObj"}],CombatModule:[function(e,t,o){"use strict";cc._RF.push(t,"a2923vZStpNt5KPXKrVBvJJ","CombatModule"),Object.defineProperty(o,"__esModule",{value:!0}),o.CombatType=void 0;var i,a=e("../network/protocol/TypeProtocols"),n=e("../utils/ConstValue"),r=e("../utils/GameUtils"),s=e("../utils/LogUtil"),c=e("../utils/RandomSeed"),l=e("../view/mainScene/CarSkinUtils");(function(e){e[e.PVE=1]="PVE",e[e.PVP=2]="PVP",e[e.SOLO=3]="SOLO",e[e.COOP=4]="COOP",e[e.DUEL=5]="DUEL"})(i=o.CombatType||(o.CombatType={}));var d=function(){function e(){this._matchOpponentsBattleInfo=null,this._matchSelfBattleInfo=null,this._matchModule=a.FIGHT_MODULE.FIGHT_MODULE_ONLINE,this._matchType=a.FIGHT_TYPE.FIGHT_TYPE_BATTLE,this._matchPattern=a.FIGHT_PATTERN.FIGHT_PATTERN_BATTLE,this._matchReconnectInfo=null,this._opponentsReplaced=!1,this._wudaohuiEndTime=0,this._combatType=i.PVE,this._batchMonsterId=0,this._battleMapId=0,this._dropEquipItem=[[]],this._carSummonId=[],this._matchPlayerCards=[],this._AI_DropId=0,this._matchOpponentsBattleInfo=null,this._matchSelfBattleInfo=null,this._matchModule=0,this._matchType=0,this._matchPattern=0,this._matchRoleIdentity=0,this._matchSeedIds=[],this._matchToken="",this._matchReconnectInfo=null,this._opponentsReplaced=!1,this._matchBossIdIndexs=[],this._wudaohuiEndTime=0,this._matchAIBattleInfo=[],this._matchAIBattleCardInfo=[[]],this._matchSeedRandomResult=[]}return e.instance=function(){return this._instance||(this._instance=new this),this._instance},e.prototype.destroy=function(){this._combatType=i.PVE,this._batchMonsterId=0,this._battleMapId=0,this.removeDropEquips(),this._matchOpponentsBattleInfo=null,this._matchSelfBattleInfo=null,this._carSummonId=[],this._matchModule=0,this._matchPlayerCards=[],this._AI_DropId=0,this._matchType=0,this._matchPattern=0,this._matchRoleIdentity=0,this._matchSeedIds=[],this._matchToken="",this._matchReconnectInfo=null,this._opponentsReplaced=!1,this._matchBossIdIndexs=[],this._wudaohuiEndTime=0,this._matchAIBattleInfo=[],this._matchAIBattleCardInfo=[[]],this._matchSeedRandomResult=[]},e.prototype.setCombatType=function(e){this._combatType=e},e.prototype.getCombatType=function(){return this._combatType},e.prototype.setBatchMonsterId=function(e){this._batchMonsterId=e},e.prototype.getBatchMonsterId=function(){return this._batchMonsterId},e.prototype.setBattleMapId=function(e){this._battleMapId=e},e.prototype.getBattleMapId=function(){return this._battleMapId},e.prototype.getDropEquipList=function(){return this._dropEquipItem},e.prototype.pushDropEquipList=function(e){this._dropEquipItem[e.camp]||(this._dropEquipItem[e.camp]=[]),this._dropEquipItem[e.camp].push(e)},e.prototype.removeDropEquips=function(){this._dropEquipItem.forEach(function(e){e.forEach(function(e){e.destroy()})}),this._dropEquipItem=[[]]},e.prototype.setCarSummonId=function(e,t){this._carSummonId[e]=t},e.prototype.getCarSummonId=function(e){return this._carSummonId[e]},e.prototype.setMatchPlayerCards=function(e){var t=this;this._matchPlayerCards=[],e.forEach(function(e){t._matchPlayerCards[e.heroID]=e})},e.prototype.getMatchPlayerCard=function(e){return this._matchPlayerCards[e]},e.prototype.setMatchBattleInfo=function(e,t){e?(this._matchSelfBattleInfo=null,this._matchSelfBattleInfo=t):(this._matchOpponentsBattleInfo=null,this._matchOpponentsBattleInfo=t)},e.prototype.getMatchBattleInfo=function(e){return e?this._matchSelfBattleInfo:this._matchOpponentsBattleInfo},e.prototype.setMatchBattleAIInfo=function(e,t){null==this._matchAIBattleInfo[n.PLAYER_CAMP.opponents]?(this._matchAIBattleInfo[n.PLAYER_CAMP.opponents]=t,this._matchAIBattleInfo[n.PLAYER_CAMP.opponents].roleID=e,this.setMatchBattleAICardInfo(n.PLAYER_CAMP.opponents,t.heros)):(this._matchAIBattleInfo[n.PLAYER_CAMP.opponentsCoop]=t,this._matchAIBattleInfo[n.PLAYER_CAMP.opponentsCoop].roleID=e,this.setMatchBattleAICardInfo(n.PLAYER_CAMP.opponentsCoop,t.heros))},e.prototype.getMatchBattleAIInfo=function(e){return this._matchAIBattleInfo[e]},e.prototype.setMatchBattleAICardInfo=function(e,t){var o=this;this._matchAIBattleCardInfo[e]=[],t.forEach(function(t){o._matchAIBattleCardInfo[e][t.heroID]=t})},e.prototype.getMatchBattleAICardInfo=function(e,t){return this._matchAIBattleCardInfo[e][t]},e.prototype.getPetId=function(e){var t=0,o=this.getMatchBattleInfo(e);return o&&o.runes&&o.runes.forEach(function(e,o){o==a.ROLE_ATTR_VALUES.ROLE_ATTR_PETID&&(t=e.itemID)}),s.default.log("CombatModule, getPetId, bMySelf="+e+", petId="+t),t},e.prototype.getHeroSkinId=function(e,t){var o=0;return this.getMatchBattleInfo(e).heros.forEach(function(e){t==e.heroID&&(o=e.skinId)}),o},e.prototype.getCarSkinId=function(e){var t,o=0,i=null;this._matchType!=a.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE||e!=n.PLAYER_CAMP.opponents&&e!=n.PLAYER_CAMP.opponentsCoop?(t=e==n.PLAYER_CAMP.myPlayer,i=this.getMatchBattleInfo(t)):i=this.getMatchBattleAIInfo(e);return i&&i.runes&&i.runes.forEach(function(e,t){t==a.ROLE_ATTR_VALUES.ROLE_ATTR_CARSKINID&&(o=Math.floor(e.itemID/1e3))}),o},e.prototype.getCarSkinLevel=function(e){var t,o=0,i=null;this._matchType!=a.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE||e!=n.PLAYER_CAMP.opponents&&e!=n.PLAYER_CAMP.opponentsCoop?(t=e==n.PLAYER_CAMP.myPlayer,i=this.getMatchBattleInfo(t)):i=this.getMatchBattleAIInfo(e);if(o==l.default.CAR_DEFAULT_SKIN_ID)return 1;var s=1,c=0;i&&i.runes&&i.runes.forEach(function(e,t){t==a.ROLE_ATTR_VALUES.ROLE_ATTR_CARSKINID&&(o=Math.floor(e.itemID/1e3),c=e.itemID%1e3)});var d=l.default.Instance.getCarLvByCarItemNum(o,c);null!=d&&(s=d.level);var u=parseInt(r.getConfigIntValue("car_skin_level_max"));return s>u&&(s=u),s},e.prototype.initSeedRandomResult=function(){var e=new c.RandomSeed;e.RandomSeed(0);for(var t=0;t<200;++t){var o=e.randomMinMaxInt(1,n.AttrParam);this._matchSeedRandomResult.push(o)}},e.prototype.getSeedRandomResult=function(e){return this._matchSeedRandomResult.length<=0&&this.initSeedRandomResult(),e%=this._matchSeedRandomResult.length,this._matchSeedRandomResult[e]},Object.defineProperty(e.prototype,"matchModule",{get:function(){return this._matchModule},set:function(e){this._matchModule=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"matchType",{get:function(){return this._matchType},set:function(e){this._matchType=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"matchToken",{get:function(){return this._matchToken},set:function(e){this._matchToken=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"matchPattern",{get:function(){return this._matchPattern},set:function(e){this._matchPattern=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"matchRoleIdentity",{get:function(){return this._matchType==a.FIGHT_TYPE.FIGHT_TYPE_BATTLE_GREAT_SAILING?2:this._matchRoleIdentity},set:function(e){this._matchRoleIdentity=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"matchSeedIds",{get:function(){return this._matchSeedIds},set:function(e){this._matchSeedIds=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"matchReconnectData",{get:function(){return this._matchReconnectInfo},set:function(e){this._matchReconnectInfo=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"aiDropId",{get:function(){return this._AI_DropId},set:function(e){this._AI_DropId=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"opponentsReplaced",{get:function(){return this._opponentsReplaced},set:function(e){this._opponentsReplaced=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"coopBossIdIndexs",{get:function(){return this._matchBossIdIndexs},set:function(e){this._matchBossIdIndexs=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"wudaohuiEndTime",{get:function(){return this._wudaohuiEndTime},set:function(e){this._wudaohuiEndTime=e},enumerable:!1,configurable:!0}),e}();o.default=d.instance(),cc._RF.pop()},{"../network/protocol/TypeProtocols":"TypeProtocols","../utils/ConstValue":"ConstValue","../utils/GameUtils":"GameUtils","../utils/LogUtil":"LogUtil","../utils/RandomSeed":"RandomSeed","../view/mainScene/CarSkinUtils":"CarSkinUtils"}],CombatObj:[function(e,t,o){"use strict";cc._RF.push(t,"dacd1If1RNHX4hobXK38itP","CombatObj"),o.__esModule=!0,o.default=void 0;var i=C(e("../../common/CombatModule")),a=C(e("../../common/PlayerModule")),n=e("../../network/protocol/FightProtocols"),r=C(e("../../utils/ConfigUtils")),s=e("../../utils/ConstValue"),c=C(e("../../utils/Debug")),l=e("../../utils/GameUtils"),d=C(e("../../utils/Tools")),u=C(e("../CombatManager")),h=(C(e("../../modules/manager/cheat/CheatManager")),C(e("./CarObj"))),p=C(e("./HeroObj")),f=C(e("./NpcObj")),g=C(e("../../network/protocol/long")),m=e("../../utils/GamePlatform"),_=e("../../modules/manager/cheat/SafeNumber"),y=C(e("../../utils/ResourcesManager")),v=(e("../../network/protocol/TypeProtocols"),e("../../Global/GameGlobal"));function C(e){return e&&e.__esModule?e:{default:e}}function S(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var T=function(){function e(){this.id=0,this.templateId=0,this.node=null,this.preNode=null,this.attr=[],this.res="",this.behitRes="",this.scale=1,this.height=0,this.width=0,this.speed=cc.v2(0,0),this.accSpeed=cc.v2(0,0),this.lastPos=cc.v2(0,0),this.spineNode=null,this.camp=0,this.campParam=1,this.hpY=0,this.ownerId=0,this.bDestory=!1,this.prof=0,this.curHp=new _.SafeNumber(0),this._maxHp=new _.SafeNumber(0),this.starAttParam=1,this.starHpParam=1,this.damageType=0,this.occupation=0,this.dropBloodMap=new Map,this._tmpHp=new _.SafeNumber(0),this._tmpMaxHp=new _.SafeNumber(0),this.setDamageRatio(100),this.clearBehitCount(),this.setCastSkillCount(0)}var t,o,C=e.prototype;return C.destroy=function(){if(this.node&&cc.isValid(this.node)){this.node.angle=0;var e=this.getCamp();3==e&&(e=1);var t=this.bloodNode;t&&(t.active=!1,t.getComponent(cc.ProgressBar).progress=1,t.scale=1,t.getChildByName("clock").active=!1);var o=this.shadowNode;o&&(o.active=!1);var i=this.node.getComponent(sp.Skeleton);i&&(i.node.active=!1),this instanceof p.default||this instanceof h.default||516==this.templateId||this.isBoss()?(this.node.destroy(),this.bloodNode&&(this.bloodNode.parent=null,this.bloodNode.destroy()),this.shadowNode&&(this.shadowNode.parent=null,this.shadowNode.destroy())):this instanceof f.default?u.default.getInstance().getController().putNpcNode(this.node):u.default.getInstance().getController().putFlyNode(this.node)}this.spineNode=null,this.speed=null,this.lastPos=null,this.attr=null,this.res=null,this.bDestory=!0,this.speed=cc.v2(0,0),this.accSpeed=cc.v2(0,0),this.lastPos=cc.v2(0,0),this.starAttParam=1,this.starHpParam=1,this.tmpHp=0,this.tmpMaxHp=0,this.setDamageRatio(100),this.clearBehitCount(),this.setCastSkillCount(0)},C.init=function(e,t,o,i){this.bDestory=!1,this.id=e||d.default.getInstance().genId(),this.templateId=t,this instanceof p.default||this instanceof h.default||516==this.templateId||this.isBoss()?this.node=new cc.Node:this instanceof f.default?this.node=u.default.getInstance().getController().getNpcSpNode():this.node=u.default.getInstance().getController().getFlySpNode(),this.node.parent=o,this.node.x=i.x,this.node.y=i.y,this.node.zIndex=999-this.node.y,this.node.opacity=255,this.heroTemplateId&&2==r.default.getInstance().getHeroConfig(this.heroTemplateId).hero_type&&(this.node.x=o.width/2,this.node.y=o.height/2+90,this.node.scale=.8)},C.setAttrValue=function(e,t){this.attr[e]&&e!=s.Npc_Attr_Type.maxHp?this.attr[e]+=t:this.attr[e]=t},C.setAttr=function(e){var t=u.default.getInstance().getController().getCheatValueCom();this.checkCheat()&&t&&t.checkObjCheat(this,this.getProtectStr),this.setAttrValue(s.Npc_Attr_Type.attack,e.attack*this.starAttParam),this.setAttrValue(s.Npc_Attr_Type.def_phy,e.def_phy),this.setAttrValue(s.Npc_Attr_Type.def_magic,e.def_magic),this.setAttrValue(s.Npc_Attr_Type.maxHp,e.hp),this.setAttrValue(s.Npc_Attr_Type.hit,e.hit),this.setAttrValue(s.Npc_Attr_Type.dodge,e.dodge),this.setAttrValue(s.Npc_Attr_Type.critical,e.critical),this.setAttrValue(s.Npc_Attr_Type.resist,e.resist),this.setAttrValue(s.Npc_Attr_Type.critical_inc,e.critical_inc),this.setAttrValue(s.Npc_Attr_Type.critical_desc,e.critical_desc),this.setAttrValue(s.Npc_Attr_Type.attack_inc,e.attack_inc),this.setAttrValue(s.Npc_Attr_Type.def_phy_inc,e.def_phy_inc),this.setAttrValue(s.Npc_Attr_Type.def_magic_inc,e.def_magic_inc),this.setAttrValue(s.Npc_Attr_Type.hp_inc,e.hp_inc),this.setAttrValue(s.Npc_Attr_Type.damage_inc,e.damage_inc),this.setAttrValue(s.Npc_Attr_Type.damage_desc,e.damage_desc),this.setAttrValue(s.Npc_Attr_Type.move_speed,e.move_speed),this.setAttrValue(s.Npc_Attr_Type.attack_speed,e.attack_speed),this.setAttrValue(s.Npc_Attr_Type.pureDamage_desc,e.pureDamage_desc),this.setAttrValue(s.Npc_Attr_Type.heal_inc,e.heal_inc),this.setAttrValue(s.Npc_Attr_Type.rebound_inc,e.rebound_inc),this.setAttrValue(s.Npc_Attr_Type.toughness_inc,e.toughness_inc),this.setAttrValue(s.Npc_Attr_Type.lifeDrain,0),this.setAttrValue(s.Npc_Attr_Type.def_phy_minus,0),this.setAttrValue(s.Npc_Attr_Type.def_magic_minus,0),this.setAttrValue(s.Npc_Attr_Type.trueDamage_desc,0),this.checkCheat()&&t&&t.protectObj(this,this.getProtectStr)},C.getProtectStr=function(){var e="";for(var t in this.attr)e=e+this.attr[t]+"_";for(var o in e+=this.damageRatio+"_",this.behitCount)e=e+o+"_"+this.behitCount[o]+"_";return e},C.cloneAttr=function(e){var t=u.default.getInstance().getController().getCheatValueCom();this.checkCheat()&&t&&t.checkObjCheat(this,this.getProtectStr),this.attr[s.Npc_Attr_Type.attack]=e.attr[s.Npc_Attr_Type.attack],this.attr[s.Npc_Attr_Type.def_phy]=e.attr[s.Npc_Attr_Type.def_phy],this.attr[s.Npc_Attr_Type.def_magic]=e.attr[s.Npc_Attr_Type.def_magic],this.attr[s.Npc_Attr_Type.maxHp]=e.attr[s.Npc_Attr_Type.maxHp],this.attr[s.Npc_Attr_Type.hit]=e.attr[s.Npc_Attr_Type.hit],this.attr[s.Npc_Attr_Type.dodge]=e.attr[s.Npc_Attr_Type.dodge],this.attr[s.Npc_Attr_Type.critical]=e.attr[s.Npc_Attr_Type.critical],this.attr[s.Npc_Attr_Type.resist]=e.attr[s.Npc_Attr_Type.resist],this.attr[s.Npc_Attr_Type.critical_inc]=e.attr[s.Npc_Attr_Type.critical_inc],this.attr[s.Npc_Attr_Type.critical_desc]=e.attr[s.Npc_Attr_Type.critical_desc],this.attr[s.Npc_Attr_Type.attack_inc]=e.attr[s.Npc_Attr_Type.attack_inc],this.attr[s.Npc_Attr_Type.def_phy_inc]=e.attr[s.Npc_Attr_Type.def_phy_inc],this.attr[s.Npc_Attr_Type.def_magic_inc]=e.attr[s.Npc_Attr_Type.def_magic_inc],this.attr[s.Npc_Attr_Type.hp_inc]=e.attr[s.Npc_Attr_Type.hp_inc],this.attr[s.Npc_Attr_Type.damage_inc]=e.attr[s.Npc_Attr_Type.damage_inc],this.attr[s.Npc_Attr_Type.damage_desc]=e.attr[s.Npc_Attr_Type.damage_desc],this.attr[s.Npc_Attr_Type.move_speed]=e.attr[s.Npc_Attr_Type.move_speed],this.attr[s.Npc_Attr_Type.attack_speed]=e.attr[s.Npc_Attr_Type.attack_speed],this.attr[s.Npc_Attr_Type.pureDamage_desc]=e.attr[s.Npc_Attr_Type.pureDamage_desc],this.attr[s.Npc_Attr_Type.heal_inc]=e.attr[s.Npc_Attr_Type.heal_inc],this.attr[s.Npc_Attr_Type.rebound_inc]=e.attr[s.Npc_Attr_Type.rebound_inc],this.attr[s.Npc_Attr_Type.toughness_inc]=e.attr[s.Npc_Attr_Type.toughness_inc],this.attr[s.Npc_Attr_Type.lifeDrain]=e.attr[s.Npc_Attr_Type.lifeDrain],this.attr[s.Npc_Attr_Type.def_phy_minus]=e.attr[s.Npc_Attr_Type.def_phy_minus],this.attr[s.Npc_Attr_Type.def_magic_minus]=e.attr[s.Npc_Attr_Type.def_magic_minus],this.attr[s.Npc_Attr_Type.trueDamage_desc]=e.attr[s.Npc_Attr_Type.trueDamage_desc],this.checkCheat()&&t&&t.protectObj(this,this.getProtectStr)},C.getAttackSpeed=function(){return this.attr?this.attr[s.Npc_Attr_Type.attack_speed]:0},C.getAttack=function(){return this.attr?this.attr[s.Npc_Attr_Type.attack]<=0?0:(this.attr[s.Npc_Attr_Type.attack]*(1+.001*Math.max(-990,this.attr[s.Npc_Attr_Type.attack_inc]))).toFixed(0):0},C.getPhyDef=function(){return this.attr?(this.attr[s.Npc_Attr_Type.def_phy]*(1+.001*this.attr[s.Npc_Attr_Type.def_phy_inc])-this.attr[s.Npc_Attr_Type.def_phy_minus]).toFixed(0):0},C.getMagicDef=function(){return this.attr?(this.attr[s.Npc_Attr_Type.def_magic]*(1+.001*this.attr[s.Npc_Attr_Type.def_magic_inc])-this.attr[s.Npc_Attr_Type.def_magic_minus]).toFixed(0):0},C.getPureDamageDesc=function(){return this.attr&&this.attr[s.Npc_Attr_Type.pureDamage_desc]?this.attr[s.Npc_Attr_Type.pureDamage_desc]>90?.9:.01*this.attr[s.Npc_Attr_Type.pureDamage_desc]:0},C.getTrueDamageDesc=function(){return this.attr&&this.attr[s.Npc_Attr_Type.trueDamage_desc]?this.attr[s.Npc_Attr_Type.trueDamage_desc]>90?.9:.01*this.attr[s.Npc_Attr_Type.trueDamage_desc]:0},C.getHealInc=function(){return this.attr&&this.attr[s.Npc_Attr_Type.heal_inc]?this.attr[s.Npc_Attr_Type.heal_inc]<-300?1:Math.min(.9,.01*this.attr[s.Npc_Attr_Type.heal_inc]*-1):0},C.getReoundInc=function(){return this.attr&&this.attr[s.Npc_Attr_Type.rebound_inc]?.01*this.attr[s.Npc_Attr_Type.rebound_inc]:0},C.getDamageDesc=function(){return this.attr&&this.attr[s.Npc_Attr_Type.damage_desc]?.1*this.attr[s.Npc_Attr_Type.damage_desc]:0},C.getLifeDrain=function(){return this.attr&&this.attr[s.Npc_Attr_Type.lifeDrain]?.01*this.attr[s.Npc_Attr_Type.lifeDrain]:0},C.getHitRate=function(e){return this.attr?Math.max(10,s.AttrParam+this.attr[s.Npc_Attr_Type.hit]-e.attr[s.Npc_Attr_Type.dodge]):0},C.onBorn=function(){var e=Math.floor(this.maxHp);this.maxHp=Math.floor(this.attr[s.Npc_Attr_Type.maxHp]*(s.AttrParam+this.attr[s.Npc_Attr_Type.hp_inc])/s.AttrParam*this.starHpParam),this.curHp.value+=this.maxHp-e,this.tmpHp=this.curHp.value,this.isCar()&&(this.carTmpHp=this.curHp.value),this.tmpMaxHp=this.maxHp},C.initRes=function(e){this.resId=e;var t=r.default.getInstance().getResConfig(e);if(t){this.res=t.animation,this.behitRes=t.behit,this.behitScale=.01*t.behitscale,this.behitAudio=t.behitaudio,this.scale=.01*t.scale,this.width=t.width,this.height=t.height,this.hpY=t.hpY,this.Shadow=t.Shadow,this.hpscalable=t.hpscalable,this.node.scaleX=this.node.scaleX*this.scale*this.campParam,this.node.scaleY=this.node.scaleY*this.scale;var o=this;cc.resources.load(this.res,sp.SkeletonData,function(e,t){if(e)if(c.default.error("load err errff:"+e.message),o.state=s.NPC_STATE.Dead,cc.isValid(o,!0)&&(o instanceof p.default||o instanceof h.default)&&u.default.getInstance().getController().combatResFail(o.res),o instanceof p.default);else if(!(o instanceof h.default)){if(1==a.default.checkModulerOnOffState(47)&&o.npcType==s.NPC_TYPE.Boss&&u.default.getInstance().isCoop()){var r=u.default.getInstance().getSelfCar();if(r){var l=new n.T_Blood_Struct;l.dropBlood=r.maxHp,l.maxBlood=r.getMaxHp(),l.type=r.npcType,r.dropBloodMap.set(a.default.UUID,l)}var d=u.default.getInstance().getCarByCamp(s.PLAYER_CAMP.coopPlayer);if(d){var f=new n.T_Blood_Struct;f.dropBlood=d.maxHp,f.maxBlood=d.getMaxHp(),f.type=d.npcType,d.dropBloodMap.set(a.default.UUID,f)}var g=v.G.StringManager.getString("RESOURCE_FAIL_MAX");m.GamePlatform.showModalRestartAlert(g,function(){cc.assetManager.cacheManager.clearCache()})}else if(o.npcType!=s.NPC_TYPE.Boss){var _=i.default.getMatchBattleInfo();if(_&&1==_.bRobot)o.onDie();else{var C=new n.T_Blood_Struct;C.dropBlood=o.maxHp,C.maxBlood=o.getMaxHp(),C.type=o.npcType,o.dropBloodMap.set(a.default.UUID,C),setTimeout(function(){o.onDie()},220)}}return}cc.isValid(o,!0)&&(o.onLoadRes(t),o.destroyPreNode(),null!=o.resInitCompleteFunc?o.resInitCompleteFunc():console.log("#######CombatObj, resInitCompleteFunc is null"),o instanceof p.default||(y.default.pushReleaseAssets(1,{path:o.res,resType:cc.SpriteFrame}),y.default.pushReleaseAssets(1,{path:o.res,resType:cc.Texture2D}),y.default.pushReleaseAssets(1,{path:o.res,resType:sp.SkeletonData})))})}},C.setResInitCompleteFunc=function(e,t){this.resInitCompleteFunc=e,this.resInitCompleteTarget=t},C.refRes=function(e){this.resId!=e&&(this.preNode=this.node,this.node=new cc.Node,this.node.parent=this.preNode.parent,this.node.x=this.preNode.x,this.node.y=this.preNode.y,this.node.zIndex=999-this.node.y,this.initRes(e),this.refreshBuffRes(this.node))},C.refreshBuffRes=function(){},C.onLoadRes=function(e){if(this.node&&cc.isValid(this.node)){var t=this.node.getComponent(sp.Skeleton);t||(t=this.node.addComponent(sp.Skeleton)),t&&(t.node.active=!0,t.skeletonData=e,t.setSkin("default"),t.setAnimation(0,"idle",!0),!(this.resId>=600)||this.isBoss()||this instanceof h.default||this instanceof p.default||t.setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.SHARED_CACHE),t.enableBatch=!0,t.timeScale=1,this.spineNode=t)}},C.destroyPreNode=function(){this.preNode&&u.default.getInstance().getController().putNpcNode(this.preNode)},C.setPos=function(e){this.node&&cc.isValid(this.node)&&(this.node.x=e.x,this.node.y=e.y)},C.setSpeed=function(e,t){try{this.speed.x=e,this.speed.y=t}catch(o){}},C.getSpeed=function(){return this.speed},C.setAccSpeed=function(e,t){try{this.accSpeed.x=e,this.accSpeed.y=t}catch(o){}},C.setOwnerId=function(e){this.ownerId=e},C.getOwnerId=function(){return this.ownerId>0?this.ownerId:this.id},C.update=function(e){try{this.updatePos(e)}catch(t){}},C.updatePos=function(e){if(1==this.xuanyun_state)return!1;if(this.lastPos=this.getWorldPos(),!this.isHero()&&!this.isCar()){if(this.isNpc()){var t=0,o=1280,i=null;if(-1==this.campParam){if(u.default.getInstance().isPvP())(i=u.default.getInstance().getCarByCamp(s.PLAYER_CAMP.myPlayer))&&(t=i.getLastPos().x+i.width/2);else if(u.default.getInstance().isCoop()){var a=s.PLAYER_CAMP.myPlayer;(0,l.getRoleIdentity)(a)==s.PLAYER_IDENTITY.home&&(a=s.PLAYER_CAMP.coopPlayer),(i=u.default.getInstance().getCarByCamp(a))&&(t=i.getLastPos().x+i.width/2)}}else 1==this.campParam&&(i=u.default.getInstance().getCarByCamp(s.PLAYER_CAMP.opponents))&&(o=i.getLastPos().x-i.width/2);if(1==this.campParam&&this.lastPos.x==o||-1==this.campParam&&this.lastPos.x==t)return;var n=this.lastPos.x+this.speed.x*e-.5*this.accSpeed.x*e*e;if(1==this.campParam&&n>o||-1==this.campParam&&n<t)return void(this.node.parent&&(1==this.campParam?this.node.x=this.node.parent.convertToNodeSpaceAR(cc.Vec2(o,0)).x:this.node.x=this.node.parent.convertToNodeSpaceAR(cc.Vec2(t,0)).x))}this.node&&cc.isValid(this.node)&&(this.speed.x=this.speed.x+this.accSpeed.x*e,this.speed.y=this.speed.y+this.accSpeed.y*e,this.node.x=this.node.x+this.speed.x*e-.5*this.accSpeed.x*e*e,this.node.y=this.node.y+this.speed.y*e-.5*this.accSpeed.x*e*e),this.bloodNode&&(this.bloodNode.x=this.node.x),this.shadowNode&&(this.shadowNode.x=this.node.x)}},C.getLastPos=function(){return this.lastPos},C.getPos=function(){if(this.node&&cc.isValid(this.node))return cc.v2(this.node.x,this.node.y)},C.getWorldPos=function(){if(this.node&&cc.isValid(this.node))try{return this.node.convertToWorldSpaceAR(cc.v2(0,0))}catch(e){console.log("\u5750\u6807\u51fa\u9519\u4e86!")}return cc.v2(0,0)},C.getSpineNode=function(){return this.spineNode},C.checkPointCollide=function(e,t){return t==s.Speed_Type.Speed_JiaoDu||t==s.Speed_Type.Speed_Acc?this.checkPointCollideX(e):t==s.Speed_Type.Speed_ShuiPing?this.checkPointCollideX(e):t==s.Speed_Type.Speed_ShuZhi?this.checkPointCollideY(e)&&this.checkPointCollideX(e):void 0},C.checkPointCollideX=function(e){var t=this.getWorldPos(),o=e.getWorldPos();if(t&&o)try{var i=e.width>0?e.width/2:10;if(Math.abs(t.x-o.x)<i)return!0;if((t.x-o.x>0?1:-1)*(this.getLastPos().x-e.getLastPos().x>0?1:-1)<0)return!0}catch(a){console.log("\u78b0\u649e\u68c0\u6d4b\u51fa\u9519\u4e86")}return!1},C.checkPointCollideY=function(e){var t=this.getWorldPos(),o=e.getWorldPos(),i=e.height>0?e.height/2:10;return Math.abs(t.y-o.y)<i||(t.y-o.y>0?1:-1)*(this.getLastPos().y-e.getLastPos().y>0?1:-1)<0},C.attackTarget=function(e,t,o,i){if(e){if(!t){if(u.default.getInstance().isCoop()&&e.camp!=s.PLAYER_CAMP.opponents){var a=(0,l.getRoleIdentity)(e.camp);if(a==s.PLAYER_IDENTITY.home)return;if(a==s.PLAYER_CAMP.opponentsCoop)return}var n=!0;if(e.dodgeSeedRandom){var r=this.getHitRate(e);r<s.AttrParam&&(n=e.getDodgeSeedRandom(this.getId(),e.getId(),this.getCamp(),this.getCastSkillCount())<=r)}if(!n)return e.createPopFont("MISS",t,0,!1),void(e.isCar()&&cc.director.emit("Event_Dodge",e.camp,e.id))}var c=0;this.attr&&e.attr&&(c=Math.min(Math.max(0,this.attr[s.Npc_Attr_Type.critical]-e.attr[s.Npc_Attr_Type.resist]),1*s.AttrParam));var d=this.getCritSeedRandom()<=c?1:0;e.isHaveDebufType(this.getTriggerCritDebufType())&&(d=1);var h=1;1==d&&(h=Math.max(1*s.AttrParam,2*s.AttrParam+this.attr[s.Npc_Attr_Type.critical_inc]-e.attr[s.Npc_Attr_Type.critical_desc])/s.AttrParam)<2&&(h=2);var p=0;t?p=e.getHealInc():1==this.damageType?p=Math.min(.99,.052*e.getPhyDef()/(.9+.048*Math.abs(e.getPhyDef()))):2==this.damageType?p=Math.min(.99,.052*e.getMagicDef()/(.9+.048*Math.abs(e.getMagicDef()))):3==this.damageType?p=e.getPureDamageDesc():6==this.damageType&&(p=e.getTrueDamageDesc());var f=this.checkTureDamageState();f.state&&!t&&(p=e.getTrueDamageDesc());var g=[],m=!1;10093==this.templateId&&(m=!0,g.push("10093"));var _=(Number(this.getAttack())+Number(this.getTargetHPDamagePlus(e)))*i*(1-p)*h;if(m&&(g.push(_.toString()),g.push(this.getAttack().toString())),t){if(e.isCar()||e.isBoss()){var y=this.getHealPercent(e);if(y>0){var v=e.getHealInc();f.state&&(v=0),_+=y*(1-v)}}}else{var C=this.getProfAttackParam(e);_*=Math.max((1*s.AttrParam+this.attr[s.Npc_Attr_Type.damage_inc]+C-e.getDamageDesc())/s.AttrParam,.1),_+=Number(this.getTargetHPExtraDamage(e))*(1-p),m&&g.push(_.toString())}if(_*=this.getDamageMultiple(e.getBehitCount(this.getOwnerId())),m&&g.push(_.toString()),f.state&&!t&&(_=_*f.percent/s.AttrParam),_*=this.getEnemyHeroProfValue(),_*=this.getEnemyPopulationAddValue(),!t){var S=e.getDamageLimitMaxHp();S>0&&_>S&&(_=S)}_=Math.floor(_),e.recvDamage(_,t,d,this,o)}},C.calcDamage=function(e){try{if(e){if(!bHealth&&u.default.getInstance().isCoop()&&e.camp!=s.PLAYER_CAMP.opponents){var t=(0,l.getRoleIdentity)(e.camp);if(t==s.PLAYER_IDENTITY.home)return 0;if(t==s.PLAYER_CAMP.opponentsCoop)return 0}var o=0;this.attr&&e.attr&&(o=Math.min(Math.max(0,this.attr[s.Npc_Attr_Type.critical]-e.attr[s.Npc_Attr_Type.resist]),1*s.AttrParam));var i=d.default.rand(0,s.AttrParam)<=o?1:0;e.isHaveDebufType(this.getTriggerCritDebufType())&&(i=1);var a=1;1==i&&(a=Math.max(1*s.AttrParam,2*s.AttrParam+this.attr[s.Npc_Attr_Type.critical_inc]-e.attr[s.Npc_Attr_Type.critical_desc])/s.AttrParam)<2&&(a=2);var n=0;1==this.damageType?n=Math.min(.99,.052*e.getPhyDef()/(.9+.048*Math.abs(e.getPhyDef()))):2==this.damageType?n=Math.min(.99,.052*e.getMagicDef()/(.9+.048*Math.abs(e.getMagicDef()))):3==this.damageType?n=e.getPureDamageDesc():4==this.damageType&&(n=e.getHealInc());var r=this.checkTureDamageState();r.state&&(n=0);var c=(Number(this.getAttack())+Number(this.getTargetHPDamagePlus(e)))*damageParam*(1-n)*a,h=this.getProfAttackParam(e);c*=Math.max((1*s.AttrParam+this.attr[s.Npc_Attr_Type.damage_inc]+h-e.getDamageDesc())/s.AttrParam,.1),c+=Number(this.getTargetHPExtraDamage(e))*(1-n),c*=this.getDamageMultiple(e.getBehitCount(this.getOwnerId())),r.state&&(c=c*r.percent/s.AttrParam),c*=this.getEnemyHeroProfValue(),c*=this.getEnemyPopulationAddValue();var p=e.getDamageLimitMaxHp();return p>0&&c>p&&(c=p),Math.floor(c)}}catch(f){console.log("\u51fa\u9519\u4e86"+f)}},C.reflectDamage=function(e,t,o,i,a,n,r){if(void 0===n&&(n=!1),void 0===r&&(r=!1),e>0){var s=0;if(i.emitterNpc)if(i.emitterNpc.isHero()){var c=u.default.getInstance().getCarByCamp(i.camp);if(c){if(r){var l=c.getHealInc(),d=Math.floor(e*(1-l));c.recvDamage(d,t,o,i,a,n,r)}else c.recvDamage(e,t,o,this,a,n,r);if(s=c.tmpHp,u.default.getInstance().isCoop()){var h=u.default.getInstance().getCoopCarByCamp(i.camp);if(h){if(r){var p=h.getHealInc(),g=Math.floor(e*(1-p));h.recvDamage(g,t,o,i,a,n,r)}else h.recvDamage(e,t,o,this,a,n,r);s+=h.tmpHp}}}}else{if(r){var m=i.getHealInc();e=Math.floor(e*(1-m)),i.emitterNpc.recvDamage(e,t,o,i,a,n,r)}else i.emitterNpc.recvDamage(e,t,o,this,a,n,r);s=i.emitterNpc.tmpHp}else if(i instanceof f.default){if(r){var _=i.getHealInc();e=Math.floor(e*(1-_)),i.recvDamage(e,t,o,i,a,n,r)}else i.recvDamage(e,t,o,this,a,n,r);s=i.tmpHp}return s}return i.tmpHp},C.recvDamage=function(e,t,o,i,a,n,r){if(void 0===n&&(n=!1),void 0===r&&(r=!1),i){if(this.isHero())return;if(u.default.getInstance().isCoop()&&this.camp!=s.PLAYER_CAMP.opponents){var c=(0,l.getRoleIdentity)(this.camp);if(c==s.PLAYER_IDENTITY.home)return;if(c==s.PLAYER_CAMP.opponentsCoop)return}if(!t&&31101!=this.templateId){var d=this.getDamageLimitMaxHp();d>0&&e>d&&(e=Math.floor(d))}var h=0,p=0;if(i.emitterNpc){if(i.emitterNpc.isHero())h=i.emitterNpc.heroTemplateId;else if(i.emitterNpc.isBoss())p=i.emitterNpc.templateId;else if(i.emitterNpc.isSummoned()){var g=i.emitterNpc.getTheSummonerinfo();g.bIsHero?h=g.theSummonerId:p=g.theSummonerId}}else if(i.isHero())h=i.heroTemplateId;else if(i.isBoss())p=i.templateId;else if(i.isSummoned()){var m=i.getTheSummonerinfo();m.bIsHero?h=m.theSummonerId:p=m.theSummonerId}if(this.state!=s.NPC_STATE.Dead&&this.tmpHp>0){var _=i.camp;i.isSummoned()?_=i.getTheSummonerinfo().camp:i.emitterNpc&&i.emitterNpc.isSummoned()&&(_=i.emitterNpc.getTheSummonerinfo().camp);var y=u.default.getInstance().getPlayerModelByCamp(_);y&&h>0&&(t?y.addTotalHeal(h,Number(e)):1!=this.wudi_state&&(i.camp==this.camp||u.default.getInstance().isCoopPartner(i.camp,this.camp)||(this.damageLimitHeros(h)&&Number(e)>(0,l.getMaxDamageLimit)()&&(e=(0,l.getMaxDamageLimit)()),y.addTotalDamage(h,Number(e)))))}var v=i.npcType;if(i.emitterNpc&&(v=i.emitterNpc.npcType),n&&(v=6),t)this.tmpHp>0&&this.chgHp(e,i.camp,i.getOwnerId(),i.getKillRewardPlus(this.dropMoney),v);else{if(this.damageLimitHeros(h)&&e>(0,l.getMaxDamageLimit)()&&(e=(0,l.getMaxDamageLimit)()),this.damageLimitBoss(p)&&e>(0,l.getMaxDamageLimit)()&&(e=(0,l.getMaxDamageLimit)()),1==this.wudi_state&&(e=0),this.isCar()&&1==this.getWhosyourdaddyState()&&this.isReachHPLimit(Math.abs(e))){console.log("xiaoye recvdamage: "+Math.abs(e)+"attack heroId: "+h),this.addWhosyourdaddyBuff(),this.setWhosyourdaddyState(0),this.addBuff(814,null);var C=i.id;return i.emitterNpc&&(C=i.emitterNpc.id),void u.default.getInstance().recordXiaoYe(C,Math.abs(e),this.carTmpHp,this.tmpHp,this.hp)}this.chgHp(-1*e,i.camp,i.getOwnerId(),i.getKillRewardPlus(this.dropMoney),v);var S=0;if(!n&&(this.tmpHp>0||this.isNpc())){var T=Math.floor(e*this.getReoundInc());S=this.reflectDamage(T,!1,0,i,cc.v2(0,0),!0,!1)}if(!r){if(0==S)if(i.emitterNpc)if(i.emitterNpc.isHero()){var I=u.default.getInstance().getCarByCamp(i.camp);if(I&&(S=I.tmpHp,u.default.getInstance().isCoop())){var N=u.default.getInstance().getCoopCarByCamp(i.camp);N&&(S+=N.tmpHp)}}else S=i.emitterNpc.tmpHp;else i instanceof f.default&&(S=i.tmpHp);if(S>0){var b=Math.floor(e*i.getLifeDrain());this.reflectDamage(b,!0,0,i,cc.v2(0,0),!1,!0)}}}t||cc.director.emit("Event_AttackTarget",i.getOwnerId(),this.id,this.camp,n),this.state!=s.NPC_STATE.Dead&&(this.hp<=0&&(u.default.getInstance().isCoop()&&this.isCar()?u.default.getInstance().getCoopCarByCamp(this.camp).hp<=0&&(u.default.getInstance().killTarget(i,this),cc.director.emit("Event_KillTarget",i.getOwnerId(),this.id)):(u.default.getInstance().killTarget(i,this),cc.director.emit("Event_KillTarget",i.getOwnerId(),this.id))),this.camp==s.PLAYER_CAMP.opponents&&u.default.getInstance().batchModel.addDamage(e)),this.onHurt(i,e,t,o,a,n)}},C.setCamp=function(e){this.camp=e},C.initCampParam=function(){this.camp!=s.PLAYER_CAMP.opponents&&this.camp!=s.PLAYER_CAMP.opponentsCoop||(this.campParam=-1)},C.getCamp=function(){return this.camp},C.getId=function(){return this.id},C.modAttr=function(e,t){if(this.attr){var o=u.default.getInstance().getController().getCheatValueCom();this.checkCheat()&&o&&o.checkObjCheat(this,this.getProtectStr),this.attr[e]?this.attr[e]+=t:this.attr[e]=t,this.checkCheat()&&o&&o.protectObj(this,this.getProtectStr)}},C.recordMaxDropBlood=function(e,t){t>e.maxDropBlood&&(e.maxDropBlood=t,e.maxDropBlood>s.INT_MAX_VALUE&&(e.maxDropBlood=s.INT_MAX_VALUE))},C.setDropBlood=function(e,t,o,i,a){var r=null,c=0;if(this.dropBloodMap.forEach(function(t,o){c<t.dropBlood&&(c=t.dropBlood),o.equals(e)&&(r=t)}),!(c>=this.getMaxHp()&&t<0))if(r)r.dropBlood+t>s.INT_BIG_VALUE?r.dropBlood=s.INT_BIG_VALUE:r.dropBlood+=t,r.damageType=a,this.isDead()&&(r.dropBlood=this.getMaxHp(),r.damageType=6),2!=a&&5!=a||this.recordMaxDropBlood(r,t),r.curBlood=this.hp,r.maxBlood=this.getMaxHp(),r.heroId=o,r.extraDropMoney=i;else{var l=new n.T_Blood_Struct;t>s.INT_BIG_VALUE?l.dropBlood=s.INT_BIG_VALUE:l.dropBlood=t,2!=a&&5!=a||this.recordMaxDropBlood(l,t),l.curBlood=this.hp,l.maxBlood=this.getMaxHp(),l.type=this.npcType,l.heroId=o,l.extraDropMoney=i,l.damageType=a,this.dropBloodMap.set(e,l)}},C.clearDropBlood=function(){if(this.dropBloodMap.clear(),this.isCar()){var e=u.default.getInstance().getOpponentsCarCamp(this.camp);if(e===s.PLAYER_CAMP.myPlayer)this.setDropBlood(a.default.UUID,0,0,0,0);else{var t=i.default.getMatchBattleInfo(!1);u.default.getInstance().isPvP()?e===s.PLAYER_CAMP.opponents&&this.setDropBlood(t.roleID,0,0,0,0):u.default.getInstance().isCoop()&&(e===s.PLAYER_CAMP.coopPlayer?this.setDropBlood(t.roleID,0,0,0,0):e!==s.PLAYER_CAMP.opponents&&e!==s.PLAYER_CAMP.opponentsCoop||(e===s.PLAYER_CAMP.opponentsCoop&&(e=s.PLAYER_CAMP.opponents),this.setDropBlood(g.default.fromNumber(e),0,0,0,0)))}}},C.chgHp=function(e,t,o,n,r){if(void 0===o&&(o=0),void 0===n&&(n=0),void 0===r&&(r=0),u.default.getInstance().isCoop()&&this.camp!=s.PLAYER_CAMP.opponents){var c=(0,l.getRoleIdentity)(this.camp);if(c==s.PLAYER_IDENTITY.home)return;if(c==s.PLAYER_CAMP.opponentsCoop)return}this.lastHp=this.hp;var d=0;d-=Number(e);var h=i.default.getMatchBattleInfo(!1);return t===s.PLAYER_CAMP.myPlayer&&this.setDropBlood(a.default.UUID,d,o,n,r),u.default.getInstance().isPvP()?t===s.PLAYER_CAMP.opponents&&this.setDropBlood(h.roleID,d,o,n,r):u.default.getInstance().isCoop()&&(t===s.PLAYER_CAMP.coopPlayer?this.setDropBlood(h.roleID,d,o,n,r):t!==s.PLAYER_CAMP.opponents&&t!==s.PLAYER_CAMP.opponentsCoop||(t===s.PLAYER_CAMP.opponentsCoop&&(t=s.PLAYER_CAMP.opponents),this.setDropBlood(g.default.fromNumber(t),d,o,n,r))),null!=h&&1==h.bRobot&&(this.hp=this.lastHp+e,this.hp<=0?this.hp=0:this.hp>this.maxHp&&(this.hp=this.maxHp)),this.tmpHp=this.tmpHp+e,this.tmpHp>this.maxHp?this.tmpHp=this.maxHp:this.tmpHp<0&&(this.tmpHp=0),this.isCar()&&(this.carTmpHp=this.carTmpHp+e,this.carTmpHp>this.maxHp?this.carTmpHp=this.maxHp:this.carTmpHp<0&&(this.carTmpHp=0),console.log("carTmpHp this.tmpHp = ",this.tmpHp),console.log("carTmpHp this.carTmpHp%d  delta%d",this.carTmpHp,e)),cc.director.emit("Event_ChangeHp",this.npcType,this.camp,this.id),this.hp-this.lastHp},C.getAttrValue=function(e){return this.attr[e]?this.attr[e]:0},C.getMaxHp=function(){return this.maxHp},C.setMaxHp=function(e){this.maxHp=e,this.tmpMaxHp=this.maxHp},C.getProfAttackParam=function(e){return this.prof==s.Prof.ZhanShi&&e.isBoss()?0:this.prof==s.Prof.Lieren&&e.isOnLand()?0:(this.prof==s.Prof.FaShi&&e.isInAir(),0)},C.getPassiveDamageInc=function(){return 0},C.modDamageRatio=function(e){var t=u.default.getInstance().getController().getCheatValueCom();this.checkCheat()&&t&&t.checkObjCheat(this,this.getProtectStr),this.damageRatio+=e,this.checkCheat()&&t&&t.protectObj(this,this.getProtectStr)},C.setDamageRatio=function(e){var t=u.default.getInstance().getController().getCheatValueCom();this.checkCheat()&&t&&t.checkObjCheat(this,this.getProtectStr),this.damageRatio=e,this.checkCheat()&&t&&t.protectObj(this,this.getProtectStr)},C.getDamageRatio=function(){return.01*this.damageRatio},C.modBehitCount=function(e){var t=u.default.getInstance().getController().getCheatValueCom();this.checkCheat()&&t&&t.checkObjCheat(this,this.getProtectStr),void 0!==this.behitCount[e]?this.behitCount[e]+=1:this.behitCount[e]=0,this.checkCheat()&&t&&t.protectObj(this,this.getProtectStr)},C.clearBehitCount=function(){var e=u.default.getInstance().getController().getCheatValueCom();for(var t in this.checkCheat()&&e&&e.checkObjCheat(this,this.getProtectStr),this.behitCount)delete this.behitCount[t];this.behitCount=[],this.checkCheat()&&e&&e.protectObj(this,this.getProtectStr)},C.setBehitCount=function(e,t){var o=u.default.getInstance().getController().getCheatValueCom();this.checkCheat()&&o&&o.checkObjCheat(this,this.getProtectStr),this.behitCount[e]=t,this.checkCheat()&&o&&o.protectObj(this,this.getProtectStr)},C.getBehitCount=function(e){return this.behitCount[e]},C.checkCheat=function(){return!1},C.setCastSkillCount=function(e){this.castSkillCount=e},C.getCastSkillCount=function(){return this.castSkillCount},C.modCastSkillCount=function(){return this.castSkillCount++},C.checkTureDamageState=function(){if(this.isFlyingobj()){if(this.emitterNpc&&this.emitterNpc.trueDamage_state&&4!=this.damageType)return{state:!0,percent:this.emitterNpc.getTrueDamagePERC()}}else if(this.trueDamage_state&&4!=this.damageType)return{state:!0,percent:this.getTrueDamagePERC()};return{state:!1,percent:0}},C.damageLimitHeros=function(e){return 18==e||43==e||59==e||35==e||78==e},C.damageLimitBoss=function(e){return 10412==e||20502==e},C.isNpc=function(){return!1},C.isMonster=function(){return!1},C.isHero=function(){return!1},C.isBoss=function(){return!1},C.isCar=function(){return!1},C.isSummoned=function(){return!1},C.isFlyingobj=function(){return!1},C.isReachHPLimit=function(e){if((0,l.isRobot)(s.PLAYER_CAMP.coopPlayer)){if(this.tmpHp<=Math.abs(e))return!0;var t=Number((0,l.getConfigIntValue)("hp_limit"));return(this.tmpHp-e)/this.maxHp*s.AttrParam<=t}return!1},C.getCritSeedRandom=function(){return s.AttrParam},C.getDodgeSeedRandom=function(){return 0},t=e,(o=[{key:"hp",set:function(e){this.curHp.value=e},get:function(){return Math.floor(this.curHp.value)}},{key:"maxHp",set:function(e){this._maxHp.value=e},get:function(){return this._maxHp.value}},{key:"tmpHp",get:function(){return this._tmpHp.value},set:function(e){this._tmpHp.value=e}},{key:"tmpMaxHp",get:function(){return this._tmpMaxHp.value},set:function(e){this._tmpMaxHp.value=e}}])&&S(t.prototype,o),e}();o.default=T,t.exports=o.default,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../common/CombatModule":"CombatModule","../../common/PlayerModule":"PlayerModule","../../modules/manager/cheat/CheatManager":"CheatManager","../../modules/manager/cheat/SafeNumber":"SafeNumber","../../network/protocol/FightProtocols":"FightProtocols","../../network/protocol/TypeProtocols":"TypeProtocols","../../network/protocol/long":"long","../../utils/ConfigUtils":"ConfigUtils","../../utils/ConstValue":"ConstValue","../../utils/Debug":"Debug","../../utils/GamePlatform":"GamePlatform","../../utils/GameUtils":"GameUtils","../../utils/ResourcesManager":"ResourcesManager","../../utils/Tools":"Tools","../CombatManager":"CombatManager","./CarObj":"CarObj","./HeroObj":"HeroObj","./NpcObj":"NpcObj"}],CombatStatistic:[function(e,t,o){"use strict";cc._RF.push(t,"fad3ag16vtHlYrmwL1cTFP8","CombatStatistic"),Object.defineProperty(o,"__esModule",{value:!0});var i,a=e("../common/PlayerModule"),n=e("../network/protocol/BaseProtocols"),r=e("../network/protocol/ObjCollection"),s=e("../network/protocol/long"),c=e("../common/CombatModule"),l=e("../network/protocol/BaseProtocols"),d=e("../utils/ConstValue"),u=e("./CombatManager"),h=e("../network/protocol/BaseProtocols"),p=e("../utils/GamePlatform"),f=e("../utils/GameUtils"),g=e("../network/ClientNetwork"),m=e("../network/LocalMessage"),_=e("../modules/manager/cheat/SafeNumber"),y=e("../utils/TimeOffSetManager");(function(e){e[e.COUNT_MOSTER_TYPE_LITTLE=1]="COUNT_MOSTER_TYPE_LITTLE",e[e.COUNT_MOSTER_TYPE_BOSS=3]="COUNT_MOSTER_TYPE_BOSS"})(i||(i={}));var v=function(){this.heroID=new _.SafeNumber(0),this.maxFightLevel=new _.SafeNumber(0),this.mixLevel=new r.ObjMap,this.damageTotal=s.fromInt(0),this.maxDamage=new _.SafeNumber(0),this.cardLevel=new _.SafeNumber(0),this.healTotal=s.fromInt(0)},C=function(){function e(){this._round=new _.SafeNumber(1),this._maxSingleDamage=new _.SafeNumber(-1),this._otherInfo="",this._heros=new r.ObjMap,this._typeMonster=new r.ObjMap,this._maxSp=0,this._cumulativeSp=0,this._round.value=1,this._refreshTimes=-1,this._refreshTimeHeroId=s.fromInt(-1),c.default.getCombatType()==c.CombatType.COOP?this._maxSingleDamage=new _.SafeNumber(parseInt(f.getConfigIntValue("fight_max_damage_pve"))):this._maxSingleDamage=new _.SafeNumber(parseInt(f.getConfigIntValue("fight_max_damage_pvp"))),this._otherInfo=""}return e.prototype.resetAllData=function(){this._heros.clear(),this._typeMonster.clear(),this._maxSp=0,this._cumulativeSp=0,this._round.value=1,this._refreshTimes=-1,this._refreshTimeHeroId=s.fromNumber(-1),this._maxSingleDamage.value=-1,this._otherInfo=""},Object.defineProperty(e.prototype,"heros",{get:function(){var e=this._heros.get(this._refreshTimeHeroId);if(e){var t=new l.T_Fight_Role_Detail_Info_HeroMixLevelData;t.buildNum=this.refreshTimes,e.mixLevel.set(t.buildNum,t)}return this.convert_To_T_Fight_Role_Detail_Info_Heros()},set:function(e){this._heros=this.convert_To_T_Fight_Role_Detail_Info_Heros_Safe(e)},enumerable:!1,configurable:!0}),e.prototype.getHeroInfo=function(e,t){var o;if(e==d.PLAYER_CAMP.myPlayer){if((o=a.default.getItemByBag(t))&&o.itemUUID)return this._heros.has(o.itemUUID)||((i=new v).heroID.value=t,i.maxFightLevel.value=0,i.damageTotal=s.fromNumber(0),this._heros.set(o.itemUUID,i)),this._refreshTimeHeroId.equals(s.fromNumber(-1))&&(this._refreshTimeHeroId=o.itemUUID),this._heros.get(o.itemUUID)}else if((o=f.getMatchPlayerCard(t,e))&&o.heroUUID){var i;return this._heros.has(o.heroUUID)||((i=new v).heroID.value=t,i.maxFightLevel.value=0,i.damageTotal=s.fromNumber(0),this._heros.set(o.heroUUID,i)),this._refreshTimeHeroId.equals(s.fromNumber(-1))&&(this._refreshTimeHeroId=o.heroUUID),this._heros.get(o.heroUUID)}},e.prototype.countHeroLvUp=function(e,t){var o=this.getHeroInfo(e,t);o&&(o.maxFightLevel.value+=1)},e.prototype.getHeroLv=function(e,t){var o=this.getHeroInfo(e,t);return o?o.maxFightLevel.value:1},e.prototype.countHeroDamage=function(e,t,o){var i,a=this.getHeroInfo(e,t);a&&(a.damageTotal=a.damageTotal.add(o),a.maxDamage.value<o&&(a.maxDamage.value=o,a.maxDamage.value>=d.INT_MAX_VALUE&&(a.maxDamage.value=d.INT_MAX_VALUE),e==d.PLAYER_CAMP.myPlayer))&&(a.maxDamage.value>=this._maxSingleDamage.value&&(g.ClientNetwork.getInstance().pushLocalMessage(m.LOCAL_MESSAGE.LocalMsg_Cheat8094),(i=[])[0]="maxSingleDamage",i[1]=a.maxDamage.value.toString(),i[2]=this._maxSingleDamage.value.toString(),p.GamePlatform.reportWXLog(i)),0==a.maxDamage.value&&a.damageTotal.notEquals(0)&&(g.ClientNetwork.getInstance().pushLocalMessage(m.LOCAL_MESSAGE.LocalMsg_Cheat8094),(i=[])[0]="totalDamageError",i[1]=a.damageTotal.toString(),p.GamePlatform.reportWXLog(i)))},e.prototype.countHeroHeal=function(e,t,o){var i=this.getHeroInfo(e,t);i&&(i.healTotal=i.healTotal.add(o))},e.prototype.addStatisticHero=function(e,t){this.getHeroInfo(e,t)},e.prototype.recordAllHeroCardLevel=function(e){this._heros.forEach(function(t){var o,i=0;if(e==d.PLAYER_CAMP.myPlayer)i=a.default.getHeroCarData()[t.heroID.value].heroLevel;else{var n=f.getMatchPlayerCard(t.heroID.value,e);n&&(i=n.heroLevel)}if(o=u.default.getInstance().getPlayerModelByCamp(e)){var r=o.carInfo.tbHeroList[t.heroID.value];r&&r.level>i&&(i=r.level)}var s=u.default.getInstance().getCarByCamp(e);if(s){var c=s.getHeroObjById(t.heroID);c&&c.level>i&&(i=c.level)}if(i>t.cardLevel.value&&(t.cardLevel.value=i),i<=0){var l=[];l[0]="recordAllHeroCardLevel",p.GamePlatform.reportWXLog(l)}console.log("recordAllHeroCardLevel camp="+e+" heroId="+t.heroID.value+" cardLevel="+t.cardLevel.value)})},Object.defineProperty(e.prototype,"mosters",{get:function(){return this._typeMonster},set:function(e){this._typeMonster=e},enumerable:!1,configurable:!0}),e.prototype.countMosterNum=function(e){var t;e?this._typeMonster.has(i.COUNT_MOSTER_TYPE_BOSS)?this._typeMonster.get(i.COUNT_MOSTER_TYPE_BOSS).deathNum+=1:((t=new n.T_Fight_Role_Detail_Info_Monsters).deathNum=1,this._typeMonster.set(i.COUNT_MOSTER_TYPE_BOSS,t)):this._typeMonster.has(i.COUNT_MOSTER_TYPE_LITTLE)?this._typeMonster.get(i.COUNT_MOSTER_TYPE_LITTLE).deathNum+=1:((t=new n.T_Fight_Role_Detail_Info_Monsters).deathNum=1,this._typeMonster.set(i.COUNT_MOSTER_TYPE_LITTLE,t))},Object.defineProperty(e.prototype,"slivers",{get:function(){return this._cumulativeSp},set:function(e){this._cumulativeSp=e},enumerable:!1,configurable:!0}),e.prototype.countSliverNum=function(e){this._cumulativeSp+=e,a.default.checkModulerOnOffState(66)&&this._cumulativeSp>d.INT_MAX_MONEY&&(this._cumulativeSp=d.INT_MAX_MONEY)},Object.defineProperty(e.prototype,"maxSlivers",{get:function(){return this._maxSp},set:function(e){this._maxSp=e},enumerable:!1,configurable:!0}),e.prototype.countMaxSliverNum=function(e){this._maxSp<e&&(this._maxSp=e)},Object.defineProperty(e.prototype,"refreshTimes",{get:function(){return this._refreshTimes},set:function(e){this._refreshTimes=e},enumerable:!1,configurable:!0}),e.prototype.countRefreshTime=function(e){this._refreshTimes+=e},e.prototype.getBattleDetails=function(e){var t=new h.T_Fight_Statistic_info;this.heros.forEach(function(e){console.log("recordAllHeroCardLevel my report "+e.cardLevel),t.totalDamage=t.totalDamage.add(e.damageTotal),t.totalHeal=t.totalHeal.add(e.healTotal),-1==t.maxDamage.compare(e.maxDamage)&&(t.maxDamage=s.fromNumber(e.maxDamage),t.heroId=e.heroID)}),t.cumulativeSp=this.slivers,t.cumulativeRef=this.refreshTimes;var o=u.default.getInstance().getPlayerModelByCamp(e);if(o){var i=o.getHeroFightList();for(var a in i){var r=i[a];if(r&&!(Number(r.pos)>=100)){var l=new n.T_Fight_Statistic_Team_Hero_Info;l.heroID=r.templateId,l.level=r.level,l.starLevel=r.starLevel;var p=c.default.getHeroSkinId(e==d.PLAYER_CAMP.myPlayer,r.templateId);l.skinId=p,t.team.push(l)}}t.carLevel=o.getMaxHeroNum(),t.otherInfo=this._otherInfo}return t},e.prototype.convert_To_T_Fight_Role_Detail_Info_Heros=function(){var e=new r.ObjMap;return this._heros.forEach(function(t,o){var i=new n.T_Fight_Role_Detail_Info_Heros;i.heroID=t.heroID.value,i.maxFightLevel=t.maxFightLevel.value,i.mixLevel=t.mixLevel,i.damageTotal=t.damageTotal,i.maxDamage=t.maxDamage.value,i.cardLevel=t.cardLevel.value,i.healTotal=t.healTotal,e.set(o,i)}),e},e.prototype.convert_To_T_Fight_Role_Detail_Info_Heros_Safe=function(e){var t=new r.ObjMap;return e.forEach(function(e,o){var i=new v;i.heroID.value=e.heroID,i.maxFightLevel.value=e.maxFightLevel,i.mixLevel=e.mixLevel,i.damageTotal=e.damageTotal,i.maxDamage.value=e.maxDamage,i.cardLevel.value=e.cardLevel,i.healTotal=e.healTotal,t.set(o,i)}),t},Object.defineProperty(e.prototype,"maxRound",{get:function(){return this._round.value},set:function(e){this._round.value=e},enumerable:!1,configurable:!0}),e.prototype.addOtherInfo=function(e){this._otherInfo.length>0&&(this._otherInfo+="#"),this._otherInfo+=e},e.prototype.addXiaoYe=function(e){var t=y.TimeOffSetManager.getServerUTCSecond();this.addOtherInfo("\u89e6\u53d1\u5c0f\u91ce time="+t+" "+e)},e}();o.default=C,cc._RF.pop()},{"../common/CombatModule":"CombatModule","../common/PlayerModule":"PlayerModule","../modules/manager/cheat/SafeNumber":"SafeNumber","../network/ClientNetwork":"ClientNetwork","../network/LocalMessage":"LocalMessage","../network/protocol/BaseProtocols":"BaseProtocols","../network/protocol/ObjCollection":"ObjCollection","../network/protocol/long":"long","../utils/ConstValue":"ConstValue","../utils/GamePlatform":"GamePlatform","../utils/GameUtils":"GameUtils","../utils/TimeOffSetManager":"TimeOffSetManager","./CombatManager":"CombatManager"}],CommandValue:[function(e,t,o){"use strict";cc._RF.push(t,"c0b57Qn1oBOV5NA6tpxRMdu","CommandValue"),Object.defineProperty(o,"__esModule",{value:!0}),o.ChatViewVisible=o.ModulerViewOnOff=o.CommonRet=o.CommonValue=void 0,o.CommonValue={CM_Login:10001,CM_Logout:10002,CM_Register:10003,CM_SyncCardInfo:10010,CM_CardLvUp:10011,CM_CardFight:10012,CM_SyncSingleCard:10013},o.CommonRet={Ok:0,NoCard:1},o.ModulerViewOnOff={LotteryView:2,ChickenDinnerView:17,SociatyFightView:18,PushGiftView:19,NavigationView:23,LoadSceneReleaseAsset:27,FightCheat8096:28,ForceAPPCheckGame:29,ProficiencyShare:31,checkBatchConfig:32,checkBatchIndex:33,rechargeProtect:34,SystemAndFriendToFight:36,FightCheat8097:39,WeekCoopFight:40,NewYearFreeGift:41,NewYearRechargeGift:42,NewYearSkinGift:43,Anniversary:45,AnniversaryReturnBack:50,FogHidden:52,OutFightReleaseUnUse:55,FogHiddenRank:61,MachineryCityActivity:64},o.ChatViewVisible={Popup:1,Retracting:2},cc._RF.pop()},{}],ConfigIntTableData:[function(e,t,o){"use strict";cc._RF.push(t,"47364Td92tKeZXRC3Kx6V7g","ConfigIntTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.ConfigIntTableData=void 0;var i=e("../TableReader"),a=function(){function e(){this.name="",this.value="",this.describe=""}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.name=e.getString(),this.value=e.getString(),this.describe=e.getString()},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"ConfigIntTableData"},e.prototype.isAutoId=function(){return!0},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.ConfigIntTableData=a,cc._RF.pop()},{"../TableReader":"TableReader"}],ConfigInt:[function(e,t,o){"use strict";cc._RF.push(t,"e0ca81TcENMlq6jyk1d2O4+","ConfigInt"),Object.defineProperty(o,"__esModule",{value:!0}),o.delayCallSlowFuncTime=o.CELLEVERYTIME=o.CELLFADEINTIME=o.MAXSCENETRACERTNUM=o.MARKBUTTONGUIDECOLOR=o.MARKGUIDECOLOR=o.POPNODEPRIORITY=o.CONFIG_BASE_RECONNECT_TIME_OUT=o.CHONGZHI_TYPE=o.GameConfigInt=void 0,o.GameConfigInt||(o.GameConfigInt={}),o.CHONGZHI_TYPE||(o.CHONGZHI_TYPE={}),o.CONFIG_BASE_RECONNECT_TIME_OUT=15,o.POPNODEPRIORITY=-256,o.MARKGUIDECOLOR=175,o.MARKBUTTONGUIDECOLOR=80,o.MAXSCENETRACERTNUM=20,o.CELLFADEINTIME=.3,o.CELLEVERYTIME=.03,o.delayCallSlowFuncTime=.2,cc._RF.pop()},{}],ConfigUtils:[function(e,t,o){"use strict";cc._RF.push(t,"981eeMeQmJD/rn5eD1QAPM3","ConfigUtils"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../Global/GameGlobal"),a=e("./MD5"),n=function(){function e(){this.data={},this.toLoadCnt=0,this.loadedCnt=0,this.totalConfStrMd5="",this.needCheckTable=new Set,this.tableLineKeyCache=new Map,this.tableRowKeyCache=new Map}return e.getInstance=function(){return this.Instance||(this.Instance=new e,this.Instance.data={}),this.Instance},Object.defineProperty(e.prototype,"cfgToLoadCnt",{get:function(){return this.toLoadCnt},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cfgLoadCnt",{get:function(){return this.loadedCnt},enumerable:!1,configurable:!0}),e.prototype.load=function(t,o){this.toLoadCnt++;var a=this;cc.resources.load(t,function(n,r){if(n);else{for(var s=r.text.replace(/[\r]/g,"").split("\n"),c=s[0].split(","),l=s[1].split(","),d={},u=3;u<s.length;u++){for(var h=s[u].split(","),p={id:0},f=0;f<c.length;f++)"NUMBER"==l[f]?p[c[f]]=Number(h[f]):p[c[f]]=h[f];var g=o?o(p):p.id;0!=g&&(d[g]=p)}e.Instance.data[t]=d,e.Instance.loadedCnt++,a.tableNeedCheck(t)&&i.G.CheatTables.setObj(d,a.cheatStrFunc),e.Instance.checkAllConfigDone()&&a.allConfigDone()}})},e.prototype.checkAllConfigDone=function(){return e.Instance.loadedCnt>=e.Instance.toLoadCnt},e.prototype.getTableLineKeys=function(e){if(!this.tableLineKeyCache.has(e)){var t=[];for(var o in e)t.push(o);t.sort(function(e,t){return e>t?1:-1}),this.tableLineKeyCache.set(e,t)}return this.tableLineKeyCache.get(e)},e.prototype.getTableRowKeys=function(e,t){if(!this.tableRowKeyCache.has(e)){var o=[];for(var i in t)o.push(i);o.sort(function(e,t){return e>t?1:-1}),this.tableRowKeyCache.set(e,o)}return this.tableRowKeyCache.get(e)},e.prototype.cheatStrFunc=function(){var t="",o=e.getInstance().getTableLineKeys(this);for(var i in o){var a=this[o[i]];if(a){var n=e.getInstance().getTableRowKeys(this,a);for(var r in n){var s=a[n[r]];s&&(t+=s)}}}return t},e.prototype.getCheatMd5=function(){return this.totalConfStrMd5},e.prototype.tableNeedCheck=function(e){return this.needCheckTable.has(e)},e.prototype.initNeedCheckTable=function(){this.needCheckTable.add("StaticData/BatchTableData"),this.needCheckTable.add("StaticData/BuffTableData"),this.needCheckTable.add("StaticData/CarTableData"),this.needCheckTable.add("StaticData/EquipTableData"),this.needCheckTable.add("StaticData/FlyingObjTableData"),this.needCheckTable.add("StaticData/HeroTableData"),this.needCheckTable.add("StaticData/NpcTemplateTableData"),this.needCheckTable.add("StaticData/PassiveSkillTableData"),this.needCheckTable.add("StaticData/RandomConstTableData"),this.needCheckTable.add("StaticData/SkillTableData"),this.needCheckTable.add("StaticData/StarTableData"),this.needCheckTable.add("StaticData/StarNavigationTableData"),this.needCheckTable.add("StaticData/BatchRandBossTableData"),this.needCheckTable.add("StaticData/HeroTalentTableData"),this.needCheckTable.add("StaticData/BatchRandBossNavigationTableData"),this.needCheckTable.add("StaticData/BatchTableDataIce"),this.needCheckTable.add("StaticData/StarTableDataIce"),this.needCheckTable.add("StaticData/BatchRandBossTableDataIce"),this.needCheckTable.add("StaticData/DropTableData"),this.needCheckTable.add("StaticData/BatchRandBossTableFogHidden"),this.needCheckTable.add("StaticData/StarFogHiddenTableData"),this.needCheckTable.add("StaticData/BatchRandBossMachineryCityTableData"),this.needCheckTable.add("StaticData/StarMachineryCityTableData"),this.needCheckTable.add("StaticData/BatchMachineryCityTableData")},e.prototype.initData=function(){this.initNeedCheckTable(),this.load("StaticData/InstanceTableData"),this.load("StaticData/SkillTableData"),this.load("StaticData/FlyingObjTableData"),this.load("StaticData/HeroTableData"),this.load("StaticData/NpcTemplateTableData",function(e){return 1e3*e.id+e.level}),this.load("StaticData/BatchTableData",function(e){return 1e4*e.id+e.index}),this.load("StaticData/CarTableData"),this.load("StaticData/BuffTableData"),this.load("StaticData/ResTableData"),this.load("StaticData/FightTempTableData"),this.load("StaticData/RandomConstTableData"),this.load("StaticData/PassiveSkillTableData"),this.load("StaticData/SummonTableData"),this.load("StaticData/AITableData",function(e){return 1e3*e.id+e.index}),this.load("StaticData/ObstacleTableData"),this.load("StaticData/ShopTableData"),this.load("StaticData/ShopBoxTableData"),this.load("StaticData/ShopDropTableData"),this.load("StaticData/ShopTavernTableData"),this.load("StaticData/StarNavigationTableData"),this.load("StaticData/StarTableData"),this.load("StaticData/AIDataTableData",function(e){return 1e3*e.id+e.index}),this.load("StaticData/KeyWordsTableData"),this.load("StaticData/ItemTableData"),this.load("StaticData/EquipTableData"),this.load("StaticData/DropTableData"),this.load("StaticData/BattleTableData"),this.load("StaticData/StringValueTableData"),this.load("StaticData/RoleScoreTableData",function(e){return 1e3*e.id+e.index}),this.load("StaticData/RankListTypeTableData"),this.load("StaticData/BatchRandBossTableData"),this.load("StaticData/CarSummonTableData",function(e){return 1e3*e.id+e.index}),this.load("StaticData/HeroTalentTableData"),this.load("StaticData/BatchRandBossNavigationTableData"),this.load("StaticData/BatchRandBossTableDataIce"),this.load("StaticData/BatchTableDataIce",function(e){return 1e4*e.id+e.index}),this.load("StaticData/StarTableDataIce"),this.load("StaticData/BatchRandBossTableFogHidden"),this.load("StaticData/StarFogHiddenTableData"),this.load("StaticData/BatchRandBossMachineryCityTableData"),this.load("StaticData/BatchMachineryCityTableData",function(e){return 1e4*e.id+e.index}),this.load("StaticData/StarMachineryCityTableData")},e.prototype.isAllConfigLoad=function(){return this.toLoadCnt==this.loadedCnt},e.prototype.allConfigDone=function(){var e=this.generateConfMd5(),t=this.generateConfMd5();this.totalConfStrMd5=e==t?e:""},e.prototype.generateConfMd5=function(){var e="";try{var t=[];for(var o in this.data)t.push(o);t.sort(function(e,t){return e>t?1:-1});for(var i="",n=0,r=t;n<r.length;n++){o=r[n];var s=this.data[o],c=this.cheatStrFunc.call(s);i+=c,c.length}e=(new a.default).hex_md5(i).toLowerCase(),console.log("tablemd5 "+e)}catch(l){return e}return e},e.prototype.getSkillConfig=function(e){return this.data["StaticData/SkillTableData"][e]},e.prototype.getFlyingObjConfig=function(e){return this.data["StaticData/FlyingObjTableData"][e]},e.prototype.getNpcTemplateConfig=function(e,t){var o=1e3*e+t;return this.data["StaticData/NpcTemplateTableData"][o]},e.prototype.getBatchConfig=function(e,t){var o=1e4*e+t;return this.data["StaticData/BatchTableData"][o]},e.prototype.getCarConfig=function(e){return this.data["StaticData/CarTableData"][e]},e.prototype.getBuffConfig=function(e){return this.data["StaticData/BuffTableData"][e]},e.prototype.getResConfig=function(e){return this.data["StaticData/ResTableData"][e]},e.prototype.getHeroConfig=function(e){return this.data["StaticData/HeroTableData"][e]},e.prototype.getPassiveSkillConfig=function(e){return this.data["StaticData/PassiveSkillTableData"][e]},e.prototype.getFightClickTemp=function(){return this.data["StaticData/FightTempTableData"]},e.prototype.getRandomConstfig=function(){return this.data["StaticData/RandomConstTableData"]},e.prototype.getSummonConfig=function(e){return this.data["StaticData/SummonTableData"][e]},e.prototype.getAIConfig=function(e,t){var o=1e3*e+t;return this.data["StaticData/AITableData"][o]},e.prototype.getAIDataConfig=function(e,t){var o=1e3*e+t;return this.data["StaticData/AIDataTableData"][o]},e.prototype.getObstacleConfig=function(e){return this.data["StaticData/ObstacleTableData"][e]},e.prototype.getShopConfig=function(){return this.data["StaticData/ShopTableData"]},e.prototype.getShopConfigByID=function(e){return this.data["StaticData/ShopTableData"][e]},e.prototype.getShopBoxConfig=function(){return this.data["StaticData/ShopBoxTableData"]},e.prototype.getShopBoxConfigByID=function(e){return this.data["StaticData/ShopBoxTableData"][e]},e.prototype.getShopDropConfig=function(){return this.data["StaticData/ShopDropTableData"]},e.prototype.getShopDropConfigByID=function(e){return this.data["StaticData/ShopDropTableData"][e]},e.prototype.getShopTavernConfig=function(){return this.data["StaticData/ShopTavernTableData"]},e.prototype.getShopTavernConfigID=function(e){return this.data["StaticData/ShopTavernTableData"][e]},e.prototype.getInstanceConfig=function(){return this.data["StaticData/InstanceTableData"]},e.prototype.getStarParam=function(e){return this.data["StaticData/StarTableData"][e]},e.prototype.getKeyWordConfig=function(){return this.data["StaticData/KeyWordsTableData"]},e.prototype.getItemByID=function(e){return this.data["StaticData/ItemTableData"][e]},e.prototype.getEquipByID=function(e){for(var t=this.data["StaticData/EquipTableData"],o=[],i=0,a=Object.keys(t);i<a.length;i++){var n=a[i];t.hasOwnProperty(n)&&t[n].equipid==e&&o.push(t[n])}return o},e.prototype.getDorpItemsByID=function(e){return this.data["StaticData/DropTableData"][e]},e.prototype.getBattleCfg=function(){return this.data["StaticData/BattleTableData"]},e.prototype.getStringValueCfg=function(e){return this.data["StaticData/StringValueTableData"][e]},e.prototype.getRankListTypeCfg=function(e){return this.data["StaticData/RankListTypeTableData"][e]},e.prototype.getRoleScoreByScore=function(e){var t=this.data["StaticData/RoleScoreTableData"],o="1";for(var i in t){if(t[i].id>e)return t[o];o=i}return null},e.prototype.getBatchRandBossCfg=function(){return this.data["StaticData/BatchRandBossTableData"]},e.prototype.getCarSummonCfg=function(){return this.data["StaticData/CarSummonTableData"]},e.prototype.getHeroTalentTableDataCfg=function(){return this.data["StaticData/HeroTalentTableData"]},e.prototype.getNavigationBatchRandBossCfg=function(){return this.data["StaticData/BatchRandBossNavigationTableData"]},e.prototype.getNavigationStarParam=function(e){return this.data["StaticData/StarNavigationTableData"][e]},e.prototype.getWeekCoopBatchRandBossCfg=function(){return this.data["StaticData/BatchRandBossTableDataIce"]},e.prototype.getWeekCoopStarParam=function(e){return this.data["StaticData/StarTableDataIce"][e]},e.prototype.getWeekCoopBatchConfig=function(e,t){var o=1e4*e+t;return this.data["StaticData/BatchTableDataIce"][o]},e.prototype.getFogHiddenBatchRandBossCfg=function(){return this.data["StaticData/BatchRandBossTableFogHidden"]},e.prototype.getFogHiddenStarParam=function(e){return this.data["StaticData/StarFogHiddenTableData"][e]},e.prototype.getMachineryCityBatchRandBossCfg=function(){return this.data["StaticData/BatchRandBossMachineryCityTableData"]},e.prototype.getMachineryCityStarParam=function(e){return this.data["StaticData/StarMachineryCityTableData"][e]},e.prototype.getMachineryCityBatchConfig=function(e,t){var o=1e4*e+t;return this.data["StaticData/BatchMachineryCityTableData"][o]},e.Instance=null,e}();o.default=n,cc._RF.pop()},{"../Global/GameGlobal":"GameGlobal","./MD5":"MD5"}],Configuration:[function(e,t,o){"use strict";cc._RF.push(t,"e704ebOqOpH26kCnS0Ve/x0","Configuration"),Object.defineProperty(o,"__esModule",{value:!0}),o.VIEW_BASE_MSG=o.VIEW_OPTION=void 0,function(e){e[e.LAYER=0]="LAYER",e[e.OVERLAY=1]="OVERLAY",e[e.SINGLE=2]="SINGLE"}(o.VIEW_OPTION||(o.VIEW_OPTION={}));var i=function(){function e(){}return e.On_View_Appera="view-appera",e.ON_View_Close="view-disappera",e}();o.VIEW_BASE_MSG=i,cc._RF.pop()},{}],ConstValue:[function(e,t,o){"use strict";cc._RF.push(t,"6c262jaIk5Pi4/2kDveEdkz","ConstValue"),o.__esModule=!0,o.INT_MAX_MONEY=o.coldDownTime=o.DROPBOXSPINEID=o.DROPBOXSPRITE=o.INT_BIG_DAMAGE=o.INT_BIG_VALUE=o.INT_MAX_VALUE=o.COOP_BATCH_ID=o.Enum_Elf_Card=o.CAR_TEMPLATE_ID=o.PLAYER_IDENTITY=o.PLAYER_CAMP=o.HERO_TOTAL_TYPE=o.Passive_Type=o.Passive_Condition=o.Passive_target=o.SummonedSustainTime=o.redPointRes=o.Direction=o.AI_Atcion=o.cardProfDesc=o.cardDescArry=o.randomQualityList=o.randomCardMaxNum=o.HeroMaxLevel=o.HeroMaxNUm=o.PvpBatchTurn=o.NpcCellHEIGHT=o.NpcCellWIDTH=o.ConfigParam=o.Car_Max_Level=o.Npc_Type_Num=o.WalkAction=o.DeadAction=o.SkillAction=o.AttackAction=o.IdleAction=o.AttrParam=o.ColorList=o.Prof=o.Npc_Attr_Type=o.Speed_Type=o.Buff_Type=o.Game_State=o.FlyingObj_Type=o.Damage_Type=o.NPC_POS_TYPE=o.NPC_TYPE=o.NPC_CAMP=o.NPC_BUFF_STATE=o.NPC_STATE=o.HERO_PROF_TYPE=o.SKILL_NEGATIVE_EFFECT=o.SKILL_SEARCH_CONDITION=o.SKILL_TARGET=o.SkillType=void 0,o.SkillType={direct_damage:1,AddHp:2,other:3,random:4,random_sprite:5,queue:6,steal_skill:7},o.SKILL_TARGET={selfNpc:1,opponentsNpc:2,selfCar:3,opponentsCar:4,opponentsLandNpc:5,opponentsAirNpc:6,selfHero:7,opponentsHero:8,selfBindHero:9,selfHeroExcludeBind:10},o.SKILL_SEARCH_CONDITION={rand:0,maxAttack:1,GTRLvOne:2,excludeWarlock:3,excludeMaxAttack:4},o.SKILL_NEGATIVE_EFFECT={default:0,minusCurHp:1},o.HERO_PROF_TYPE={Warrior:1,Hunter:2,Mage:3,Priest:4,Summoner:5,Sprite:6,Panda:7,Engineer:8,Warlock:9},o.NPC_STATE={IDLE:0,Walk:1,Attack:2,Behit:3,Dead:4},o.NPC_BUFF_STATE={FROZEN:0},o.NPC_CAMP={Left:1,Right:2},o.NPC_TYPE={Car:1,Hero:2,Monster:3,Boss:4,Summoned:5},o.NPC_POS_TYPE={Air:1,Land:2},o.Damage_Type={Phy_Damage:1,Magic_Damage:2},o.FlyingObj_Type={Once:1,Repeat:2,Repeat_AddHp:3},o.Game_State={Prepare:1,Wait:2,Fighting:3,Reconnect:4,End:100},o.Buff_Type={WuDi:1,XuanYun:2,TempChangeAtt:3,ChangeAtt:4,SlowSpeed:5,ChangeAttPercent:6,AddMoney:7,immunity:8,immunitySeveral:9,frozen:10,changeDamageRatio:11,countBehit:12,TempChangeAttPercent:13,Magic_Dot:14,Physic_Dot:15,True_Damage_Dot:16,True_Damage:17,Pure_Damage_Dot:18,Equip_Invalid:19,Die_Boom:20,Sliver_Curse:21,TempChangeAttrProfNum:22,Hero_Time_Bomb:23,Extra_Sliver_Invalid:24,Story_State:25,TempChangeAttrByAttr:26,AddPercentCurMoney:27,AddSameProfNumMoney:28,Sell_Sliver_Invalid:29},o.Speed_Type={Speed_JiaoDu:1,Speed_ShuiPing:2,Speed_ShuZhi:3,Speed_Acc:4,Speed_ShuiPing_Hero:5},o.Npc_Attr_Type={curHp:0,attack:1,def_phy:2,def_magic:3,maxHp:4,hit:5,dodge:6,critical:7,resist:8,critical_inc:9,critical_desc:10,attack_inc:11,def_phy_inc:12,def_magic_inc:13,hp_inc:14,damage_inc:15,damage_desc:16,move_speed:17,attack_speed:18,pureDamage_desc:19,heal_inc:20,rebound_inc:21,toughness_inc:22,lifeDrain:23,def_phy_minus:24,def_magic_minus:25,trueDamage_desc:26},o.Prof={ZhanShi:1,Lieren:2,FaShi:3,ZhaoHuan:4},o.ColorList=[{color1:255,color2:255,color3:255},{color1:132,color2:254,color3:58},{color1:29,color2:236,color3:255},{color1:193,color2:112,color3:255},{color1:254,color2:189,color3:34}],o.AttrParam=100,o.IdleAction="idle",o.AttackAction="attack",o.SkillAction="skill",o.DeadAction="dead",o.WalkAction="walk",o.Npc_Type_Num=5,o.Car_Max_Level=6,o.ConfigParam=1e3,o.NpcCellWIDTH=100,o.NpcCellHEIGHT=100,o.PvpBatchTurn=50,o.HeroMaxNUm=21,o.HeroMaxLevel=4,o.randomCardMaxNum=3,o.randomQualityList=[{green:25,blue:25,purple:25,orange:25},{green:25,blue:25,purple:25,orange:25},{green:25,blue:25,purple:25,orange:25},{green:25,blue:25,purple:25,orange:25},{green:25,blue:25,purple:25,orange:25},{green:25,blue:25,purple:25,orange:25}],o.cardDescArry=["\u653b\u51fb\u529b","\u653b\u51fb\u7c7b\u578b","\u653b\u901f","\u751f\u547d"],o.cardProfDesc=["","\u7eaf\u7cb9\u4f24\u5bb3","\u7269\u7406\u4f24\u5bb3","\u9b54\u6cd5\u4f24\u5bb3","\u6cbb\u7597","\u53ec\u5524","\u7279\u6b8a","\u7279\u6b8a","\u771f\u5b9e\u4f24\u5bb3","\u771f\u5b9e\u4f24\u5bb3"],o.AI_Atcion={none:0,refreshCard:1,updateCar:2,buycard:3,sellCard:4},o.Direction={LEFT_TO_RIGHT:1,RIGHT_TO_LEFT:2},o.redPointRes="ui/common_res/redpoint",o.SummonedSustainTime=12e3,o.Passive_target={selfNpc:1,opponentsNpc:2,selfCar:3,opponentsCar:4,selfHero:5,opponentsHero:6,onlySelf:7},o.Passive_Condition={population:1,specialHero:2,noSpecialHero:3,moreCarLv:4,probability:5,percentMoney:6,allSameProf:7,profNumMinus:8,specialHeros:9,noSpecialHeros:10,specialOCC:11,haveOCC:12},o.Passive_Type={extra_maxHp_damage:1,kill_target:2,attack_target:3,buff_prof:4,buff_all_prof:5,debuff_enemy:6,extra_maxHp_attr:7,debuff_crit:8,extra_kill_money:9,extra_recv_money:10,buff_car:11,extra_sliver_attr:12,buff_car_monster:13,buff_self:14,sell_more_money:15,extra_heroLv_attr:16,extra_heroStar_attr:17,buff_soldier:18,buff_hunter:19,buff_Mage:20,buff_prisst:21,buff_summoned:22,extra_curHp_attr:23,extra_maxHp_attack:24,buff_summoned_npc:25,extra_hp:26,buff_car_population:27,buff_no_prof:28,upgrate_rate:29,weight:30,extra_curHp_attack:31,summoned_live_time:32,summoned_extra_attr:33,panda:34,superpose_damage:35,charge_interest:36,superpose_damage_prof:37,sell_card_add_attr:38,extra_enemy_heroNum_attr:39,change_skill:40,compare_enemy_carLv:41,summon_npc:42,summon_spirit:43,behit_add_buff:44,all_same_prof:45,change_spirit:46,prof_num_minus:47,equip_invalid:48,damage_limit_depend_maxHp:49,whos_your_daddy:50,enemy_num:51,enemy_profNum_add_damage:52,change_drop_box:53,enemy_population_add_damage:54,buff_ninja:55,car_dodge_self_add_buff:56,car_dodge_add_buff:57,car_attr_change_add_buff:58},o.HERO_TOTAL_TYPE={NUM:1,STAR:2},o.PLAYER_CAMP={myPlayer:1,opponents:2,coopPlayer:3,opponentsCoop:4},o.PLAYER_IDENTITY={home:1,away:2},o.CAR_TEMPLATE_ID={pvp:1,coop_front:100,coop_back:101,coop_car_boss:201},o.Enum_Elf_Card={guangElf:34,leiElf:35,huanElf:39,anElf:40,muElf:44,moElf:50,rainbowElf:63,tuElf:66,fireworkElf:9999},o.COOP_BATCH_ID=10,o.INT_MAX_VALUE=2147483637,o.INT_BIG_VALUE=1e9,o.INT_BIG_DAMAGE=99999999,o.DROPBOXSPRITE="ui/common_res/parachute",o.DROPBOXSPINEID=20001,o.coldDownTime=.5,o.INT_MAX_MONEY=5e5,cc._RF.pop()},{}],CostGetTableData:[function(e,t,o){"use strict";cc._RF.push(t,"34894TXpl9IuY3Ju231m/gG","CostGetTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.CostGetTableData=void 0;var i=e("../TableReader"),a=e("./BaseTableData"),n=function(){function e(){this.id=0,this.cost=new Array,this.get=new Array,this.dayMaxNum=0,this.remark=""}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber();for(var o=e.getString(),n=new i.TableReader(o);n.getPos()<n.getLen();)(s=new a.ItemInfo).readOriginal(n),this.cost.push(s);o=e.getString();for(var r=new i.TableReader(o);r.getPos()<r.getLen();){var s;(s=new a.ItemInfo).readOriginal(r),this.get.push(s)}this.dayMaxNum=e.getNumber(),this.remark=e.getString()},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"CostGetTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.CostGetTableData=n,cc._RF.pop()},{"../TableReader":"TableReader","./BaseTableData":"BaseTableData"}],CustomEventDef:[function(e,t,o){"use strict";cc._RF.push(t,"7d21fg9pRhO/bsVgMJOyITP","CustomEventDef"),Object.defineProperty(o,"__esModule",{value:!0}),o.Decouple=o.DecoupleEvent=o.REGISTER=o.HANDLE=o.CustomAnalyticsEvent=o.CustomZIndex=o.CustomEventDef=void 0,function(e){e.DisableGuide="disableguide",e.EnableGuide="enableguide",e.PveReconnect="pve_reconnect",e.NewBuildingOpen="new_building_open",e.PreNewBuildingOpen="pre_new_building_open",e.ScrollMainReq="scroll_main_req",e.ScrollMainRsp="scroll_main_rsp",e.CheckNoncoerciveGuide="check_noncoercive",e.SceneLoaded="scene_loaded",e.HideActivityBtn="hide_activity_btn",e.SaveFightPoint="save_fight_point",e.ShowFightPointChange="show_fight_point_change",e.ShowReconnectLayer="show_reconnect_layer",e.LoadRankingLayer="load_ranking_layer",e.PopLoaded="pop_loaded",e.PopHide="pop_hide",e.CorpsSceneDonate="corps_scene_donate",e.CS_PvPFightWinInit="cs_pvpfightwin_init",e.SystemMessageTips_HideTips="SystemMessageTips_HideTips",e.TowerUpgradeTopButtonInit="TowerUpgradeTopButtonInit",e.PveStageScene_clearData="PveStageScene_clearData",e.PveStageScene_sendCounterPartInfo="PveStageScene_sendCounterPartInfo",e.MakeEquipMain_setView="MakeEquipMain_setView",e.PveStageScene_setModule="PveStageScene_setModule",e.PveStageScene_setChapterId="PveStageScene_setChapterId",e.PveStageScene_onNormalClick="PveStageScene_onNormalClick",e.PveStageScene_onEliteClick="PveStageScene_onEliteClick",e.PveStageScene_jumpToGate="PveStageScene_jumpToGate",e.CenterPvpListLayer_setData="CenterPvpListLayer_setData",e.CenterPvpUnOPenLayer_setData="CenterPvpUnOPenLayer_setData",e.refreshButtonTipsByChangeScene="refreshButtonTipsByChangeScene",e.requestCorpsFunc="requestCorpsFunc",e.HomeGonggao_setOpacity="HomeGonggao_setOpacity",e.enterChatObjectLayer1="enterChatObjectLayer1",e.recordEnterChatLayerData="recordEnterChatLayerData",e.PveFightScene_setPause="PveFightScene_setPause",e.TowerTalentManager_setTalentData="TowerTalentManager_setTalentData",e.BottomButton_refreshTips="BottomButton_refreshTips",e.enterFlowerRewardTips="enterFlowerRewardTips",e.refreshAllButtonTips="refreshAllButtonTips",e.MainScene_refreshMars="MainScene_refreshMars",e.PrayDialSelectItem_playSelectedAction="PrayDialSelectItem_playSelectedAction",e.Contrast_setQmtzData="Contrast_setQmtzData",e.PvpLoadingScene_setPvpinfo="PvpLoadingScene_setPvpinfo",e.isGuiding="is_guiding",e.GuideRelease="guide_release",e.DeleteFriendTips_setBlackListData="DeleteFriendTips_setBlackListData",e.DeleteFriendTips_setDeleteFriendData="DeleteFriendTips_setDeleteFriendData",e.StageDrop_setData="StageDrop_setData",e.StageDrop_setCanClick="StageDrop_setCanClick",e.StageDrop_setFirstDrop="StageDrop_setFirstDrop",e.CreateRoleScene_updatePos="CreateRoleScene_updatePos",e.BottomButton_freshPvp="BottomButton_freshPvp",e.BloodFight_Welcome="BloodFight_Welcome",e.BloodFight_Main="BloodFight_Main",e.CS_YcdgMain="CS_YcdgMain",e.CS_Tzyhmain="CS_Tzyhmain",e.pvp_shop="pvp_shop",e.roleinfo_huodongclick="roleinfo_huodongclick",e.roleinfo_fuliclick="roleinfo_fuliclick",e.roleinfo_close_vip_layer="roleinfo_close_vip_layer",e.PopLayer_Destroy="DestroyPoplayer"}(o.CustomEventDef||(o.CustomEventDef={})),function(e){e[e.None=0]="None",e[e.GlobalBg=1]="GlobalBg",e[e.PopLayer=1]="PopLayer",e[e.NonForceGuide=999]="NonForceGuide",e[e.Guide=1e3]="Guide",e[e.Talk=1001]="Talk",e[e.ReconnectLayer=1e4]="ReconnectLayer"}(o.CustomZIndex||(o.CustomZIndex={})),(o.CustomAnalyticsEvent||(o.CustomAnalyticsEvent={})).Dialog="evt_Dialog",o.HANDLE=function(){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];return i.Instance.handle.apply(i.Instance,arguments)},o.REGISTER=function(e,t){i.Instance.register(e,t)},function(e){e[e.PopLayerFactory_enterTimeHeroPreview=0]="PopLayerFactory_enterTimeHeroPreview",e[e.PopLayerFactory_enterTimeHeroLayer=1]="PopLayerFactory_enterTimeHeroLayer",e[e.PopLayerFactory_enterGeneralDetailPopLayer=2]="PopLayerFactory_enterGeneralDetailPopLayer",e[e.PopLayerFactory_enterTipsPopLayer=3]="PopLayerFactory_enterTipsPopLayer",e[e.PopLayerFactory_showFightPointChangeLayer=4]="PopLayerFactory_showFightPointChangeLayer",e[e.PopLayerFactory_enterFamousStarWay=5]="PopLayerFactory_enterFamousStarWay",e[e.PopLayerFactory_enterItemInfoLayer=6]="PopLayerFactory_enterItemInfoLayer",e[e.PopLayerFactory_enterGetHorseRidingPopLayer=7]="PopLayerFactory_enterGetHorseRidingPopLayer",e[e.PopLayerFactory_enterCzlbLyer=8]="PopLayerFactory_enterCzlbLyer",e[e.PopLayerFactory_enterDrugStoreLayer=9]="PopLayerFactory_enterDrugStoreLayer",e[e.PopLayerFactory_enterRecycleLayer=10]="PopLayerFactory_enterRecycleLayer"}(o.DecoupleEvent||(o.DecoupleEvent={}));var i=function(){function e(){this.handlers={}}return Object.defineProperty(e,"Instance",{get:function(){return null===this._instance&&(this._instance=new e),this._instance},enumerable:!1,configurable:!0}),e.prototype.register=function(e,t){if(null!=this.handlers[e])throw"Error: there is already a handler with id: '"+e+"'.";this.handlers[e]=t},e.prototype.handle=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];var i=this.handlers[e];if(!i)throw"Error: cannot find a handler with id: '"+e+"'.";return i.apply(this,t)},e._instance=null,e}();o.Decouple=i,cc._RF.pop()},{}],1:[function(e,t,o){var i=o;i.bignum=e("bn.js"),i.define=e("./asn1/api").define,i.base=e("./asn1/base"),i.constants=e("./asn1/constants"),i.decoders=e("./asn1/decoders"),i.encoders=e("./asn1/encoders")},{"./asn1/api":2,"./asn1/base":4,"./asn1/constants":8,"./asn1/decoders":10,"./asn1/encoders":13,"bn.js":15}],2:[function(e,t,o){var i=e("../asn1"),a=e("inherits");function n(e,t){this.name=e,this.body=t,this.decoders={},this.encoders={}}o.define=function(e,t){return new n(e,t)},n.prototype._createNamed=function(t){var o;try{o=e("vm").runInThisContext("(function "+this.name+"(entity) {\n  this._initNamed(entity);\n})")}catch(i){o=function(e){this._initNamed(e)}}return a(o,t),o.prototype._initNamed=function(e){t.call(this,e)},new o(this)},n.prototype._getDecoder=function(e){return e=e||"der",this.decoders.hasOwnProperty(e)||(this.decoders[e]=this._createNamed(i.decoders[e])),this.decoders[e]},n.prototype.decode=function(e,t,o){return this._getDecoder(t).decode(e,o)},n.prototype._getEncoder=function(e){return e=e||"der",this.encoders.hasOwnProperty(e)||(this.encoders[e]=this._createNamed(i.encoders[e])),this.encoders[e]},n.prototype.encode=function(e,t,o){return this._getEncoder(t).encode(e,o)}},{"../asn1":1,inherits:140,vm:197}],3:[function(e,t,o){var i=e("inherits"),a=e("../base").Reporter,n=e("buffer").Buffer;function r(e,t){a.call(this,t),n.isBuffer(e)?(this.base=e,this.offset=0,this.length=e.length):this.error("Input not Buffer")}function s(e,t){if(Array.isArray(e))this.length=0,this.value=e.map(function(e){return e instanceof s||(e=new s(e,t)),this.length+=e.length,e},this);else if("number"==typeof e){if(!(0<=e&&e<=255))return t.error("non-byte EncoderBuffer value");this.value=e,this.length=1}else if("string"==typeof e)this.value=e,this.length=n.byteLength(e);else{if(!n.isBuffer(e))return t.error("Unsupported type: "+typeof e);this.value=e,this.length=e.length}}i(r,a),o.DecoderBuffer=r,r.prototype.save=function(){return{offset:this.offset,reporter:a.prototype.save.call(this)}},r.prototype.restore=function(e){var t=new r(this.base);return t.offset=e.offset,t.length=this.offset,this.offset=e.offset,a.prototype.restore.call(this,e.reporter),t},r.prototype.isEmpty=function(){return this.offset===this.length},r.prototype.readUInt8=function(e){return this.offset+1<=this.length?this.base.readUInt8(this.offset++,!0):this.error(e||"DecoderBuffer overrun")},r.prototype.skip=function(e,t){if(!(this.offset+e<=this.length))return this.error(t||"DecoderBuffer overrun");var o=new r(this.base);return o._reporterState=this._reporterState,o.offset=this.offset,o.length=this.offset+e,this.offset+=e,o},r.prototype.raw=function(e){return this.base.slice(e?e.offset:this.offset,this.length)},o.EncoderBuffer=s,s.prototype.join=function(e,t){return e||(e=new n(this.length)),t||(t=0),0===this.length?e:(Array.isArray(this.value)?this.value.forEach(function(o){o.join(e,t),t+=o.length}):("number"==typeof this.value?e[t]=this.value:"string"==typeof this.value?e.write(this.value,t):n.isBuffer(this.value)&&this.value.copy(e,t),t+=this.length),e)}},{"../base":4,buffer:66,inherits:140}],4:[function(e,t,o){var i=o;i.Reporter=e("./reporter").Reporter,i.DecoderBuffer=e("./buffer").DecoderBuffer,i.EncoderBuffer=e("./buffer").EncoderBuffer,i.Node=e("./node")},{"./buffer":3,"./node":5,"./reporter":6}],5:[function(e,t){var o=e("../base").Reporter,i=e("../base").EncoderBuffer,a=e("../base").DecoderBuffer,n=e("minimalistic-assert"),r=["seq","seqof","set","setof","objid","bool","gentime","utctime","null_","enum","int","objDesc","bitstr","bmpstr","charstr","genstr","graphstr","ia5str","iso646str","numstr","octstr","printstr","t61str","unistr","utf8str","videostr"],s=["key","obj","use","optional","explicit","implicit","def","choice","any","contains"].concat(r);function c(e,t){var o={};this._baseState=o,o.enc=e,o.parent=t||null,o.children=null,o.tag=null,o.args=null,o.reverseArgs=null,o.choice=null,o.optional=!1,o.any=!1,o.obj=!1,o.use=null,o.useDecoder=null,o.key=null,o.default=null,o.explicit=null,o.implicit=null,o.contains=null,o.parent||(o.children=[],this._wrap())}t.exports=c;var l=["enc","parent","children","tag","args","reverseArgs","choice","optional","any","obj","use","alteredUse","key","default","explicit","implicit","contains"];c.prototype.clone=function(){var e=this._baseState,t={};l.forEach(function(o){t[o]=e[o]});var o=new this.constructor(t.parent);return o._baseState=t,o},c.prototype._wrap=function(){var e=this._baseState;s.forEach(function(t){this[t]=function(){var o=new this.constructor(this);return e.children.push(o),o[t].apply(o,arguments)}},this)},c.prototype._init=function(e){var t=this._baseState;n(null===t.parent),e.call(this),t.children=t.children.filter(function(e){return e._baseState.parent===this},this),n.equal(t.children.length,1,"Root node can have only one child")},c.prototype._useArgs=function(e){var t=this._baseState,o=e.filter(function(e){return e instanceof this.constructor},this);e=e.filter(function(e){return!(e instanceof this.constructor)},this),0!==o.length&&(n(null===t.children),t.children=o,o.forEach(function(e){e._baseState.parent=this},this)),0!==e.length&&(n(null===t.args),t.args=e,t.reverseArgs=e.map(function(e){if("object"!=typeof e||e.constructor!==Object)return e;var t={};return Object.keys(e).forEach(function(o){o==(0|o)&&(o|=0);var i=e[o];t[i]=o}),t}))},["_peekTag","_decodeTag","_use","_decodeStr","_decodeObjid","_decodeTime","_decodeNull","_decodeInt","_decodeBool","_decodeList","_encodeComposite","_encodeStr","_encodeObjid","_encodeTime","_encodeNull","_encodeInt","_encodeBool"].forEach(function(e){c.prototype[e]=function(){var t=this._baseState;throw new Error(e+" not implemented for encoding: "+t.enc)}}),r.forEach(function(e){c.prototype[e]=function(){var t=this._baseState,o=Array.prototype.slice.call(arguments);return n(null===t.tag),t.tag=e,this._useArgs(o),this}}),c.prototype.use=function(e){n(e);var t=this._baseState;return n(null===t.use),t.use=e,this},c.prototype.optional=function(){return this._baseState.optional=!0,this},c.prototype.def=function(e){var t=this._baseState;return n(null===t.default),t.default=e,t.optional=!0,this},c.prototype.explicit=function(e){var t=this._baseState;return n(null===t.explicit&&null===t.implicit),t.explicit=e,this},c.prototype.implicit=function(e){var t=this._baseState;return n(null===t.explicit&&null===t.implicit),t.implicit=e,this},c.prototype.obj=function(){var e=this._baseState,t=Array.prototype.slice.call(arguments);return e.obj=!0,0!==t.length&&this._useArgs(t),this},c.prototype.key=function(e){var t=this._baseState;return n(null===t.key),t.key=e,this},c.prototype.any=function(){return this._baseState.any=!0,this},c.prototype.choice=function(e){var t=this._baseState;return n(null===t.choice),t.choice=e,this._useArgs(Object.keys(e).map(function(t){return e[t]})),this},c.prototype.contains=function(e){var t=this._baseState;return n(null===t.use),t.contains=e,this},c.prototype._decode=function(e,t){var o=this._baseState;if(null===o.parent)return e.wrapResult(o.children[0]._decode(e,t));var i,n=o.default,r=!0,s=null;if(null!==o.key&&(s=e.enterKey(o.key)),o.optional){var c=null;if(null!==o.explicit?c=o.explicit:null!==o.implicit?c=o.implicit:null!==o.tag&&(c=o.tag),null!==c||o.any){if(r=this._peekTag(e,c,o.any),e.isError(r))return r}else{var l=e.save();try{null===o.choice?this._decodeGeneric(o.tag,e,t):this._decodeChoice(e,t),r=!0}catch(f){r=!1}e.restore(l)}}if(o.obj&&r&&(i=e.enterObject()),r){if(null!==o.explicit){var d=this._decodeTag(e,o.explicit);if(e.isError(d))return d;e=d}var u=e.offset;if(null===o.use&&null===o.choice){o.any&&(l=e.save());var h=this._decodeTag(e,null!==o.implicit?o.implicit:o.tag,o.any);if(e.isError(h))return h;o.any?n=e.raw(l):e=h}if(t&&t.track&&null!==o.tag&&t.track(e.path(),u,e.length,"tagged"),t&&t.track&&null!==o.tag&&t.track(e.path(),e.offset,e.length,"content"),n=o.any?n:null===o.choice?this._decodeGeneric(o.tag,e,t):this._decodeChoice(e,t),e.isError(n))return n;if(o.any||null!==o.choice||null===o.children||o.children.forEach(function(o){o._decode(e,t)}),o.contains&&("octstr"===o.tag||"bitstr"===o.tag)){var p=new a(n);n=this._getUse(o.contains,e._reporterState.obj)._decode(p,t)}}return o.obj&&r&&(n=e.leaveObject(i)),null===o.key||null===n&&!0!==r?null!==s&&e.exitKey(s):e.leaveKey(s,o.key,n),n},c.prototype._decodeGeneric=function(e,t,o){var i=this._baseState;return"seq"===e||"set"===e?null:"seqof"===e||"setof"===e?this._decodeList(t,e,i.args[0],o):/str$/.test(e)?this._decodeStr(t,e,o):"objid"===e&&i.args?this._decodeObjid(t,i.args[0],i.args[1],o):"objid"===e?this._decodeObjid(t,null,null,o):"gentime"===e||"utctime"===e?this._decodeTime(t,e,o):"null_"===e?this._decodeNull(t,o):"bool"===e?this._decodeBool(t,o):"objDesc"===e?this._decodeStr(t,e,o):"int"===e||"enum"===e?this._decodeInt(t,i.args&&i.args[0],o):null!==i.use?this._getUse(i.use,t._reporterState.obj)._decode(t,o):t.error("unknown tag: "+e)},c.prototype._getUse=function(e,t){var o=this._baseState;return o.useDecoder=this._use(e,t),n(null===o.useDecoder._baseState.parent),o.useDecoder=o.useDecoder._baseState.children[0],o.implicit!==o.useDecoder._baseState.implicit&&(o.useDecoder=o.useDecoder.clone(),o.useDecoder._baseState.implicit=o.implicit),o.useDecoder},c.prototype._decodeChoice=function(e,t){var o=this._baseState,i=null,a=!1;return Object.keys(o.choice).some(function(n){var r=e.save(),s=o.choice[n];try{var c=s._decode(e,t);if(e.isError(c))return!1;i={type:n,value:c},a=!0}catch(l){return e.restore(r),!1}return!0},this),a?i:e.error("Choice not matched")},c.prototype._createEncoderBuffer=function(e){return new i(e,this.reporter)},c.prototype._encode=function(e,t,o){var i=this._baseState;if(null===i.default||i.default!==e){var a=this._encodeValue(e,t,o);if(void 0!==a&&!this._skipDefault(a,t,o))return a}},c.prototype._encodeValue=function(e,t,i){var a=this._baseState;if(null===a.parent)return a.children[0]._encode(e,t||new o);var n=null;if(this.reporter=t,a.optional&&void 0===e){if(null===a.default)return;e=a.default}var r=null,s=!1;if(a.any)n=this._createEncoderBuffer(e);else if(a.choice)n=this._encodeChoice(e,t);else if(a.contains)r=this._getUse(a.contains,i)._encode(e,t),s=!0;else if(a.children)r=a.children.map(function(o){if("null_"===o._baseState.tag)return o._encode(null,t,e);if(null===o._baseState.key)return t.error("Child should have a key");var i=t.enterKey(o._baseState.key);if("object"!=typeof e)return t.error("Child expected, but input is not object");var a=o._encode(e[o._baseState.key],t,e);return t.leaveKey(i),a},this).filter(function(e){return e}),r=this._createEncoderBuffer(r);else if("seqof"===a.tag||"setof"===a.tag){if(!a.args||1!==a.args.length)return t.error("Too many args for : "+a.tag);if(!Array.isArray(e))return t.error("seqof/setof, but data is not Array");var c=this.clone();c._baseState.implicit=null,r=this._createEncoderBuffer(e.map(function(o){var i=this._baseState;return this._getUse(i.args[0],e)._encode(o,t)},c))}else null!==a.use?n=this._getUse(a.use,i)._encode(e,t):(r=this._encodePrimitive(a.tag,e),s=!0);if(!a.any&&null===a.choice){var l=null!==a.implicit?a.implicit:a.tag,d=null===a.implicit?"universal":"context";null===l?null===a.use&&t.error("Tag could be omitted only for .use()"):null===a.use&&(n=this._encodeComposite(l,s,d,r))}return null!==a.explicit&&(n=this._encodeComposite(a.explicit,!1,"context",n)),n},c.prototype._encodeChoice=function(e,t){var o=this._baseState,i=o.choice[e.type];return i||n(!1,e.type+" not found in "+JSON.stringify(Object.keys(o.choice))),i._encode(e.value,t)},c.prototype._encodePrimitive=function(e,t){var o=this._baseState;if(/str$/.test(e))return this._encodeStr(t,e);if("objid"===e&&o.args)return this._encodeObjid(t,o.reverseArgs[0],o.args[1]);if("objid"===e)return this._encodeObjid(t,null,null);if("gentime"===e||"utctime"===e)return this._encodeTime(t,e);if("null_"===e)return this._encodeNull();if("int"===e||"enum"===e)return this._encodeInt(t,o.args&&o.reverseArgs[0]);if("bool"===e)return this._encodeBool(t);if("objDesc"===e)return this._encodeStr(t,e);throw new Error("Unsupported tag: "+e)},c.prototype._isNumstr=function(e){return/^[0-9 ]*$/.test(e)},c.prototype._isPrintstr=function(e){return/^[A-Za-z0-9 '\(\)\+,\-\.\/:=\?]*$/.test(e)}},{"../base":4,"minimalistic-assert":145}],6:[function(e,t,o){var i=e("inherits");function a(e){this._reporterState={obj:null,path:[],options:e||{},errors:[]}}function n(e,t){this.path=e,this.rethrow(t)}o.Reporter=a,a.prototype.isError=function(e){return e instanceof n},a.prototype.save=function(){var e=this._reporterState;return{obj:e.obj,pathLen:e.path.length}},a.prototype.restore=function(e){var t=this._reporterState;t.obj=e.obj,t.path=t.path.slice(0,e.pathLen)},a.prototype.enterKey=function(e){return this._reporterState.path.push(e)},a.prototype.exitKey=function(e){var t=this._reporterState;t.path=t.path.slice(0,e-1)},a.prototype.leaveKey=function(e,t,o){var i=this._reporterState;this.exitKey(e),null!==i.obj&&(i.obj[t]=o)},a.prototype.path=function(){return this._reporterState.path.join("/")},a.prototype.enterObject=function(){var e=this._reporterState,t=e.obj;return e.obj={},t},a.prototype.leaveObject=function(e){var t=this._reporterState,o=t.obj;return t.obj=e,o},a.prototype.error=function(e){var t,o=this._reporterState,i=e instanceof n;if(t=i?e:new n(o.path.map(function(e){return"["+JSON.stringify(e)+"]"}).join(""),e.message||e,e.stack),!o.options.partial)throw t;return i||o.errors.push(t),t},a.prototype.wrapResult=function(e){var t=this._reporterState;return t.options.partial?{result:this.isError(e)?null:e,errors:t.errors}:e},i(n,Error),n.prototype.rethrow=function(e){if(this.message=e+" at: "+(this.path||"(shallow)"),Error.captureStackTrace&&Error.captureStackTrace(this,n),!this.stack)try{throw new Error(this.message)}catch(t){this.stack=t.stack}return this}},{inherits:140}],7:[function(e,t,o){var i=e("../constants");o.tagClass={0:"universal",1:"application",2:"context",3:"private"},o.tagClassByName=i._reverse(o.tagClass),o.tag={0:"end",1:"bool",2:"int",3:"bitstr",4:"octstr",5:"null_",6:"objid",7:"objDesc",8:"external",9:"real",10:"enum",11:"embed",12:"utf8str",13:"relativeOid",16:"seq",17:"set",18:"numstr",19:"printstr",20:"t61str",21:"videostr",22:"ia5str",23:"utctime",24:"gentime",25:"graphstr",26:"iso646str",27:"genstr",28:"unistr",29:"charstr",30:"bmpstr"},o.tagByName=i._reverse(o.tag)},{"../constants":8}],8:[function(e,t,o){var i=o;i._reverse=function(e){var t={};return Object.keys(e).forEach(function(o){(0|o)==o&&(o|=0);var i=e[o];t[i]=o}),t},i.der=e("./der")},{"./der":7}],9:[function(e,t){var o=e("inherits"),i=e("../../asn1"),a=i.base,n=i.bignum,r=i.constants.der;function s(e){this.enc="der",this.name=e.name,this.entity=e,this.tree=new c,this.tree._init(e.body)}function c(e){a.Node.call(this,"der",e)}function l(e,t){var o=e.readUInt8(t);if(e.isError(o))return o;var i=r.tagClass[o>>6],a=0==(32&o);if(31==(31&o)){var n=o;for(o=0;128==(128&n);){if(n=e.readUInt8(t),e.isError(n))return n;o<<=7,o|=127&n}}else o&=31;return{cls:i,primitive:a,tag:o,tagStr:r.tag[o]}}function d(e,t,o){var i=e.readUInt8(o);if(e.isError(i))return i;if(!t&&128===i)return null;if(0==(128&i))return i;var a=127&i;if(a>4)return e.error("length octect is too long");i=0;for(var n=0;n<a;n++){i<<=8;var r=e.readUInt8(o);if(e.isError(r))return r;i|=r}return i}t.exports=s,s.prototype.decode=function(e,t){return e instanceof a.DecoderBuffer||(e=new a.DecoderBuffer(e,t)),this.tree._decode(e,t)},o(c,a.Node),c.prototype._peekTag=function(e,t,o){if(e.isEmpty())return!1;var i=e.save(),a=l(e,'Failed to peek tag: "'+t+'"');return e.isError(a)?a:(e.restore(i),a.tag===t||a.tagStr===t||a.tagStr+"of"===t||o)},c.prototype._decodeTag=function(e,t,o){var i=l(e,'Failed to decode tag of "'+t+'"');if(e.isError(i))return i;var a=d(e,i.primitive,'Failed to get length of "'+t+'"');if(e.isError(a))return a;if(!o&&i.tag!==t&&i.tagStr!==t&&i.tagStr+"of"!==t)return e.error('Failed to match tag: "'+t+'"');if(i.primitive||null!==a)return e.skip(a,'Failed to match body of: "'+t+'"');var n=e.save(),r=this._skipUntilEnd(e,'Failed to skip indefinite length body: "'+this.tag+'"');return e.isError(r)?r:(a=e.offset-n.offset,e.restore(n),e.skip(a,'Failed to match body of: "'+t+'"'))},c.prototype._skipUntilEnd=function(e,t){for(;;){var o=l(e,t);if(e.isError(o))return o;var i,a=d(e,o.primitive,t);if(e.isError(a))return a;if(i=o.primitive||null!==a?e.skip(a):this._skipUntilEnd(e,t),e.isError(i))return i;if("end"===o.tagStr)break}},c.prototype._decodeList=function(e,t,o,i){for(var a=[];!e.isEmpty();){var n=this._peekTag(e,"end");if(e.isError(n))return n;var r=o.decode(e,"der",i);if(e.isError(r)&&n)break;a.push(r)}return a},c.prototype._decodeStr=function(e,t){if("bitstr"===t){var o=e.readUInt8();return e.isError(o)?o:{unused:o,data:e.raw()}}if("bmpstr"===t){var i=e.raw();if(i.length%2==1)return e.error("Decoding of string type: bmpstr length mismatch");for(var a="",n=0;n<i.length/2;n++)a+=String.fromCharCode(i.readUInt16BE(2*n));return a}if("numstr"===t){var r=e.raw().toString("ascii");return this._isNumstr(r)?r:e.error("Decoding of string type: numstr unsupported characters")}if("octstr"===t)return e.raw();if("objDesc"===t)return e.raw();if("printstr"===t){var s=e.raw().toString("ascii");return this._isPrintstr(s)?s:e.error("Decoding of string type: printstr unsupported characters")}return/str$/.test(t)?e.raw().toString():e.error("Decoding of string type: "+t+" unsupported")},c.prototype._decodeObjid=function(e,t,o){for(var i,a=[],n=0;!e.isEmpty();){var r=e.readUInt8();n<<=7,n|=127&r,0==(128&r)&&(a.push(n),n=0)}128&r&&a.push(n);var s=a[0]/40|0,c=a[0]%40;if(i=o?a:[s,c].concat(a.slice(1)),t){var l=t[i.join(" ")];void 0===l&&(l=t[i.join(".")]),void 0!==l&&(i=l)}return i},c.prototype._decodeTime=function(e,t){var o=e.raw().toString();if("gentime"===t)var i=0|o.slice(0,4),a=0|o.slice(4,6),n=0|o.slice(6,8),r=0|o.slice(8,10),s=0|o.slice(10,12),c=0|o.slice(12,14);else{if("utctime"!==t)return e.error("Decoding "+t+" time is not supported yet");i=0|o.slice(0,2),a=0|o.slice(2,4),n=0|o.slice(4,6),r=0|o.slice(6,8),s=0|o.slice(8,10),c=0|o.slice(10,12),i=i<70?2e3+i:1900+i}return Date.UTC(i,a-1,n,r,s,c,0)},c.prototype._decodeNull=function(){return null},c.prototype._decodeBool=function(e){var t=e.readUInt8();return e.isError(t)?t:0!==t},c.prototype._decodeInt=function(e,t){var o=e.raw(),i=new n(o);return t&&(i=t[i.toString(10)]||i),i},c.prototype._use=function(e,t){return"function"==typeof e&&(e=e(t)),e._getDecoder("der").tree}},{"../../asn1":1,inherits:140}],10:[function(e,t,o){var i=o;i.der=e("./der"),i.pem=e("./pem")},{"./der":9,"./pem":11}],11:[function(e,t){var o=e("inherits"),i=e("buffer").Buffer,a=e("./der");function n(e){a.call(this,e),this.enc="pem"}o(n,a),t.exports=n,n.prototype.decode=function(e,t){for(var o=e.toString().split(/[\r\n]+/g),n=t.label.toUpperCase(),r=/^-----(BEGIN|END) ([^-]+)-----$/,s=-1,c=-1,l=0;l<o.length;l++){var d=o[l].match(r);if(null!==d&&d[2]===n){if(-1!==s){if("END"!==d[1])break;c=l;break}if("BEGIN"!==d[1])break;s=l}}if(-1===s||-1===c)throw new Error("PEM section not found for: "+n);var u=o.slice(s+1,c).join("");u.replace(/[^a-z0-9\+\/=]+/gi,"");var h=new i(u,"base64");return a.prototype.decode.call(this,h,t)}},{"./der":9,buffer:66,inherits:140}],12:[function(e,t){var o=e("inherits"),i=e("buffer").Buffer,a=e("../../asn1"),n=a.base,r=a.constants.der;function s(e){this.enc="der",this.name=e.name,this.entity=e,this.tree=new c,this.tree._init(e.body)}function c(e){n.Node.call(this,"der",e)}function l(e){return e<10?"0"+e:e}function d(e,t,o,i){var a;if("seqof"===e?e="seq":"setof"===e&&(e="set"),r.tagByName.hasOwnProperty(e))a=r.tagByName[e];else{if("number"!=typeof e||(0|e)!==e)return i.error("Unknown tag: "+e);a=e}return a>=31?i.error("Multi-octet tag encoding unsupported"):(t||(a|=32),a|=r.tagClassByName[o||"universal"]<<6)}t.exports=s,s.prototype.encode=function(e,t){return this.tree._encode(e,t).join()},o(c,n.Node),c.prototype._encodeComposite=function(e,t,o,a){var n,r=d(e,t,o,this.reporter);if(a.length<128)return(n=new i(2))[0]=r,n[1]=a.length,this._createEncoderBuffer([n,a]);for(var s=1,c=a.length;c>=256;c>>=8)s++;(n=new i(2+s))[0]=r,n[1]=128|s,c=1+s;for(var l=a.length;l>0;c--,l>>=8)n[c]=255&l;return this._createEncoderBuffer([n,a])},c.prototype._encodeStr=function(e,t){if("bitstr"===t)return this._createEncoderBuffer([0|e.unused,e.data]);if("bmpstr"===t){for(var o=new i(2*e.length),a=0;a<e.length;a++)o.writeUInt16BE(e.charCodeAt(a),2*a);return this._createEncoderBuffer(o)}return"numstr"===t?this._isNumstr(e)?this._createEncoderBuffer(e):this.reporter.error("Encoding of string type: numstr supports only digits and space"):"printstr"===t?this._isPrintstr(e)?this._createEncoderBuffer(e):this.reporter.error("Encoding of string type: printstr supports only latin upper and lower case letters, digits, space, apostrophe, left and rigth parenthesis, plus sign, comma, hyphen, dot, slash, colon, equal sign, question mark"):/str$/.test(t)?this._createEncoderBuffer(e):"objDesc"===t?this._createEncoderBuffer(e):this.reporter.error("Encoding of string type: "+t+" unsupported")},c.prototype._encodeObjid=function(e,t,o){if("string"==typeof e){if(!t)return this.reporter.error("string objid given, but no values map found");if(!t.hasOwnProperty(e))return this.reporter.error("objid not found in values map");e=t[e].split(/[\s\.]+/g);for(var a=0;a<e.length;a++)e[a]|=0}else if(Array.isArray(e))for(e=e.slice(),a=0;a<e.length;a++)e[a]|=0;if(!Array.isArray(e))return this.reporter.error("objid() should be either array or string, got: "+JSON.stringify(e));if(!o){if(e[1]>=40)return this.reporter.error("Second objid identifier OOB");e.splice(0,2,40*e[0]+e[1])}var n=0;for(a=0;a<e.length;a++){var r=e[a];for(n++;r>=128;r>>=7)n++}var s=new i(n),c=s.length-1;for(a=e.length-1;a>=0;a--)for(r=e[a],s[c--]=127&r;(r>>=7)>0;)s[c--]=128|127&r;return this._createEncoderBuffer(s)},c.prototype._encodeTime=function(e,t){var o,i=new Date(e);return"gentime"===t?o=[l(i.getFullYear()),l(i.getUTCMonth()+1),l(i.getUTCDate()),l(i.getUTCHours()),l(i.getUTCMinutes()),l(i.getUTCSeconds()),"Z"].join(""):"utctime"===t?o=[l(i.getFullYear()%100),l(i.getUTCMonth()+1),l(i.getUTCDate()),l(i.getUTCHours()),l(i.getUTCMinutes()),l(i.getUTCSeconds()),"Z"].join(""):this.reporter.error("Encoding "+t+" time is not supported yet"),this._encodeStr(o,"octstr")},c.prototype._encodeNull=function(){return this._createEncoderBuffer("")},c.prototype._encodeInt=function(e,t){if("string"==typeof e){if(!t)return this.reporter.error("String int or enum given, but no values map");if(!t.hasOwnProperty(e))return this.reporter.error("Values map doesn't contain: "+JSON.stringify(e));e=t[e]}if("number"!=typeof e&&!i.isBuffer(e)){var o=e.toArray();!e.sign&&128&o[0]&&o.unshift(0),e=new i(o)}if(i.isBuffer(e)){var a=e.length;0===e.length&&a++;var n=new i(a);return e.copy(n),0===e.length&&(n[0]=0),this._createEncoderBuffer(n)}if(e<128)return this._createEncoderBuffer(e);if(e<256)return this._createEncoderBuffer([0,e]);a=1;for(var r=e;r>=256;r>>=8)a++;for(r=(n=new Array(a)).length-1;r>=0;r--)n[r]=255&e,e>>=8;return 128&n[0]&&n.unshift(0),this._createEncoderBuffer(new i(n))},c.prototype._encodeBool=function(e){return this._createEncoderBuffer(e?255:0)},c.prototype._use=function(e,t){return"function"==typeof e&&(e=e(t)),e._getEncoder("der").tree},c.prototype._skipDefault=function(e,t,o){var i,a=this._baseState;if(null===a.default)return!1;var n=e.join();if(void 0===a.defaultBuffer&&(a.defaultBuffer=this._encodeValue(a.default,t,o).join()),n.length!==a.defaultBuffer.length)return!1;for(i=0;i<n.length;i++)if(n[i]!==a.defaultBuffer[i])return!1;return!0}},{"../../asn1":1,buffer:66,inherits:140}],13:[function(e,t,o){var i=o;i.der=e("./der"),i.pem=e("./pem")},{"./der":12,"./pem":14}],14:[function(e,t){var o=e("inherits"),i=e("./der");function a(e){i.call(this,e),this.enc="pem"}o(a,i),t.exports=a,a.prototype.encode=function(e,t){for(var o=i.prototype.encode.call(this,e).toString("base64"),a=["-----BEGIN "+t.label+"-----"],n=0;n<o.length;n+=64)a.push(o.slice(n,n+64));return a.push("-----END "+t.label+"-----"),a.join("\n")}},{"./der":12,inherits:140}],15:[function(e,t){(function(t,o){"use strict";function i(e,t){if(!e)throw new Error(t||"Assertion failed")}function a(e,t){e.super_=t;var o=function(){};o.prototype=t.prototype,e.prototype=new o,e.prototype.constructor=e}function n(e,t,o){if(n.isBN(e))return e;this.negative=0,this.words=null,this.length=0,this.red=null,null!==e&&("le"!==t&&"be"!==t||(o=t,t=10),this._init(e||0,t||10,o||"be"))}var r;"object"==typeof t?t.exports=n:o.BN=n,n.BN=n,n.wordSize=26;try{r=e("buffer").Buffer}catch(w){}function s(e,t,o){for(var i=0,a=Math.min(e.length,o),n=t;n<a;n++){var r=e.charCodeAt(n)-48;i<<=4,i|=r>=49&&r<=54?r-49+10:r>=17&&r<=22?r-17+10:15&r}return i}function c(e,t,o,i){for(var a=0,n=Math.min(e.length,o),r=t;r<n;r++){var s=e.charCodeAt(r)-48;a*=i,a+=s>=49?s-49+10:s>=17?s-17+10:s}return a}n.isBN=function(e){return e instanceof n||null!==e&&"object"==typeof e&&e.constructor.wordSize===n.wordSize&&Array.isArray(e.words)},n.max=function(e,t){return e.cmp(t)>0?e:t},n.min=function(e,t){return e.cmp(t)<0?e:t},n.prototype._init=function(e,t,o){if("number"==typeof e)return this._initNumber(e,t,o);if("object"==typeof e)return this._initArray(e,t,o);"hex"===t&&(t=16),i(t===(0|t)&&t>=2&&t<=36);var a=0;"-"===(e=e.toString().replace(/\s+/g,""))[0]&&a++,16===t?this._parseHex(e,a):this._parseBase(e,t,a),"-"===e[0]&&(this.negative=1),this.strip(),"le"===o&&this._initArray(this.toArray(),t,o)},n.prototype._initNumber=function(e,t,o){e<0&&(this.negative=1,e=-e),e<67108864?(this.words=[67108863&e],this.length=1):e<4503599627370496?(this.words=[67108863&e,e/67108864&67108863],this.length=2):(i(e<9007199254740992),this.words=[67108863&e,e/67108864&67108863,1],this.length=3),"le"===o&&this._initArray(this.toArray(),t,o)},n.prototype._initArray=function(e,t,o){if(i("number"==typeof e.length),e.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(e.length/3),this.words=new Array(this.length);for(var a=0;a<this.length;a++)this.words[a]=0;var n,r,s=0;if("be"===o)for(a=e.length-1,n=0;a>=0;a-=3)r=e[a]|e[a-1]<<8|e[a-2]<<16,this.words[n]|=r<<s&67108863,this.words[n+1]=r>>>26-s&67108863,(s+=24)>=26&&(s-=26,n++);else if("le"===o)for(a=0,n=0;a<e.length;a+=3)r=e[a]|e[a+1]<<8|e[a+2]<<16,this.words[n]|=r<<s&67108863,this.words[n+1]=r>>>26-s&67108863,(s+=24)>=26&&(s-=26,n++);return this.strip()},n.prototype._parseHex=function(e,t){this.length=Math.ceil((e.length-t)/6),this.words=new Array(this.length);for(var o=0;o<this.length;o++)this.words[o]=0;var i,a,n=0;for(o=e.length-6,i=0;o>=t;o-=6)a=s(e,o,o+6),this.words[i]|=a<<n&67108863,this.words[i+1]|=a>>>26-n&4194303,(n+=24)>=26&&(n-=26,i++);o+6!==t&&(a=s(e,t,o+6),this.words[i]|=a<<n&67108863,this.words[i+1]|=a>>>26-n&4194303),this.strip()},n.prototype._parseBase=function(e,t,o){this.words=[0],this.length=1;for(var i=0,a=1;a<=67108863;a*=t)i++;i--,a=a/t|0;for(var n=e.length-o,r=n%i,s=Math.min(n,n-r)+o,l=0,d=o;d<s;d+=i)l=c(e,d,d+i,t),this.imuln(a),this.words[0]+l<67108864?this.words[0]+=l:this._iaddn(l);if(0!==r){var u=1;for(l=c(e,d,e.length,t),d=0;d<r;d++)u*=t;this.imuln(u),this.words[0]+l<67108864?this.words[0]+=l:this._iaddn(l)}},n.prototype.copy=function(e){e.words=new Array(this.length);for(var t=0;t<this.length;t++)e.words[t]=this.words[t];e.length=this.length,e.negative=this.negative,e.red=this.red},n.prototype.clone=function(){var e=new n(null);return this.copy(e),e},n.prototype._expand=function(e){for(;this.length<e;)this.words[this.length++]=0;return this},n.prototype.strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},n.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},n.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var l=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],d=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],u=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function h(e){for(var t=new Array(e.bitLength()),o=0;o<t.length;o++){var i=o/26|0,a=o%26;t[o]=(e.words[i]&1<<a)>>>a}return t}function p(e,t,o){o.negative=t.negative^e.negative;var i=e.length+t.length|0;o.length=i,i=i-1|0;var a=0|e.words[0],n=0|t.words[0],r=a*n,s=67108863&r,c=r/67108864|0;o.words[0]=s;for(var l=1;l<i;l++){for(var d=c>>>26,u=67108863&c,h=Math.min(l,t.length-1),p=Math.max(0,l-e.length+1);p<=h;p++){var f=l-p|0;d+=(r=(a=0|e.words[f])*(n=0|t.words[p])+u)/67108864|0,u=67108863&r}o.words[l]=0|u,c=0|d}return 0!==c?o.words[l]=0|c:o.length--,o.strip()}n.prototype.toString=function(e,t){var o;if(t=0|t||1,16===(e=e||10)||"hex"===e){o="";for(var a=0,n=0,r=0;r<this.length;r++){var s=this.words[r],c=(16777215&(s<<a|n)).toString(16);o=0!=(n=s>>>24-a&16777215)||r!==this.length-1?l[6-c.length]+c+o:c+o,(a+=2)>=26&&(a-=26,r--)}for(0!==n&&(o=n.toString(16)+o);o.length%t!=0;)o="0"+o;return 0!==this.negative&&(o="-"+o),o}if(e===(0|e)&&e>=2&&e<=36){var h=d[e],p=u[e];o="";var f=this.clone();for(f.negative=0;!f.isZero();){var g=f.modn(p).toString(e);o=(f=f.idivn(p)).isZero()?g+o:l[h-g.length]+g+o}for(this.isZero()&&(o="0"+o);o.length%t!=0;)o="0"+o;return 0!==this.negative&&(o="-"+o),o}i(!1,"Base should be between 2 and 36")},n.prototype.toNumber=function(){var e=this.words[0];return 2===this.length?e+=67108864*this.words[1]:3===this.length&&1===this.words[2]?e+=4503599627370496+67108864*this.words[1]:this.length>2&&i(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-e:e},n.prototype.toJSON=function(){return this.toString(16)},n.prototype.toBuffer=function(e,t){return i(void 0!==r),this.toArrayLike(r,e,t)},n.prototype.toArray=function(e,t){return this.toArrayLike(Array,e,t)},n.prototype.toArrayLike=function(e,t,o){var a=this.byteLength(),n=o||Math.max(1,a);i(a<=n,"byte array longer than desired length"),i(n>0,"Requested array length <= 0"),this.strip();var r,s,c="le"===t,l=new e(n),d=this.clone();if(c){for(s=0;!d.isZero();s++)r=d.andln(255),d.iushrn(8),l[s]=r;for(;s<n;s++)l[s]=0}else{for(s=0;s<n-a;s++)l[s]=0;for(s=0;!d.isZero();s++)r=d.andln(255),d.iushrn(8),l[n-s-1]=r}return l},Math.clz32?n.prototype._countBits=function(e){return 32-Math.clz32(e)}:n.prototype._countBits=function(e){var t=e,o=0;return t>=4096&&(o+=13,t>>>=13),t>=64&&(o+=7,t>>>=7),t>=8&&(o+=4,t>>>=4),t>=2&&(o+=2,t>>>=2),o+t},n.prototype._zeroBits=function(e){if(0===e)return 26;var t=e,o=0;return 0==(8191&t)&&(o+=13,t>>>=13),0==(127&t)&&(o+=7,t>>>=7),0==(15&t)&&(o+=4,t>>>=4),0==(3&t)&&(o+=2,t>>>=2),0==(1&t)&&o++,o},n.prototype.bitLength=function(){var e=this.words[this.length-1],t=this._countBits(e);return 26*(this.length-1)+t},n.prototype.zeroBits=function(){if(this.isZero())return 0;for(var e=0,t=0;t<this.length;t++){var o=this._zeroBits(this.words[t]);if(e+=o,26!==o)break}return e},n.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},n.prototype.toTwos=function(e){return 0!==this.negative?this.abs().inotn(e).iaddn(1):this.clone()},n.prototype.fromTwos=function(e){return this.testn(e-1)?this.notn(e).iaddn(1).ineg():this.clone()},n.prototype.isNeg=function(){return 0!==this.negative},n.prototype.neg=function(){return this.clone().ineg()},n.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},n.prototype.iuor=function(e){for(;this.length<e.length;)this.words[this.length++]=0;for(var t=0;t<e.length;t++)this.words[t]=this.words[t]|e.words[t];return this.strip()},n.prototype.ior=function(e){return i(0==(this.negative|e.negative)),this.iuor(e)},n.prototype.or=function(e){return this.length>e.length?this.clone().ior(e):e.clone().ior(this)},n.prototype.uor=function(e){return this.length>e.length?this.clone().iuor(e):e.clone().iuor(this)},n.prototype.iuand=function(e){var t;t=this.length>e.length?e:this;for(var o=0;o<t.length;o++)this.words[o]=this.words[o]&e.words[o];return this.length=t.length,this.strip()},n.prototype.iand=function(e){return i(0==(this.negative|e.negative)),this.iuand(e)},n.prototype.and=function(e){return this.length>e.length?this.clone().iand(e):e.clone().iand(this)},n.prototype.uand=function(e){return this.length>e.length?this.clone().iuand(e):e.clone().iuand(this)},n.prototype.iuxor=function(e){var t,o;this.length>e.length?(t=this,o=e):(t=e,o=this);for(var i=0;i<o.length;i++)this.words[i]=t.words[i]^o.words[i];if(this!==t)for(;i<t.length;i++)this.words[i]=t.words[i];return this.length=t.length,this.strip()},n.prototype.ixor=function(e){return i(0==(this.negative|e.negative)),this.iuxor(e)},n.prototype.xor=function(e){return this.length>e.length?this.clone().ixor(e):e.clone().ixor(this)},n.prototype.uxor=function(e){return this.length>e.length?this.clone().iuxor(e):e.clone().iuxor(this)},n.prototype.inotn=function(e){i("number"==typeof e&&e>=0);var t=0|Math.ceil(e/26),o=e%26;this._expand(t),o>0&&t--;for(var a=0;a<t;a++)this.words[a]=67108863&~this.words[a];return o>0&&(this.words[a]=~this.words[a]&67108863>>26-o),this.strip()},n.prototype.notn=function(e){return this.clone().inotn(e)},n.prototype.setn=function(e,t){i("number"==typeof e&&e>=0);var o=e/26|0,a=e%26;return this._expand(o+1),this.words[o]=t?this.words[o]|1<<a:this.words[o]&~(1<<a),this.strip()},n.prototype.iadd=function(e){var t,o,i;if(0!==this.negative&&0===e.negative)return this.negative=0,t=this.isub(e),this.negative^=1,this._normSign();if(0===this.negative&&0!==e.negative)return e.negative=0,t=this.isub(e),e.negative=1,t._normSign();this.length>e.length?(o=this,i=e):(o=e,i=this);for(var a=0,n=0;n<i.length;n++)t=(0|o.words[n])+(0|i.words[n])+a,this.words[n]=67108863&t,a=t>>>26;for(;0!==a&&n<o.length;n++)t=(0|o.words[n])+a,this.words[n]=67108863&t,a=t>>>26;if(this.length=o.length,0!==a)this.words[this.length]=a,this.length++;else if(o!==this)for(;n<o.length;n++)this.words[n]=o.words[n];return this},n.prototype.add=function(e){var t;return 0!==e.negative&&0===this.negative?(e.negative=0,t=this.sub(e),e.negative^=1,t):0===e.negative&&0!==this.negative?(this.negative=0,t=e.sub(this),this.negative=1,t):this.length>e.length?this.clone().iadd(e):e.clone().iadd(this)},n.prototype.isub=function(e){if(0!==e.negative){e.negative=0;var t=this.iadd(e);return e.negative=1,t._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(e),this.negative=1,this._normSign();var o,i,a=this.cmp(e);if(0===a)return this.negative=0,this.length=1,this.words[0]=0,this;a>0?(o=this,i=e):(o=e,i=this);for(var n=0,r=0;r<i.length;r++)n=(t=(0|o.words[r])-(0|i.words[r])+n)>>26,this.words[r]=67108863&t;for(;0!==n&&r<o.length;r++)n=(t=(0|o.words[r])+n)>>26,this.words[r]=67108863&t;if(0===n&&r<o.length&&o!==this)for(;r<o.length;r++)this.words[r]=o.words[r];return this.length=Math.max(this.length,r),o!==this&&(this.negative=1),this.strip()},n.prototype.sub=function(e){return this.clone().isub(e)};var f=function(e,t,o){var i,a,n,r=e.words,s=t.words,c=o.words,l=0,d=0|r[0],u=8191&d,h=d>>>13,p=0|r[1],f=8191&p,g=p>>>13,m=0|r[2],_=8191&m,y=m>>>13,v=0|r[3],C=8191&v,S=v>>>13,T=0|r[4],I=8191&T,N=T>>>13,b=0|r[5],w=8191&b,E=b>>>13,P=0|r[6],R=8191&P,L=P>>>13,A=0|r[7],D=8191&A,M=A>>>13,B=0|r[8],k=8191&B,G=B>>>13,O=0|r[9],H=8191&O,V=O>>>13,F=0|s[0],U=8191&F,x=F>>>13,Y=0|s[1],j=8191&Y,W=Y>>>13,z=0|s[2],K=8191&z,q=z>>>13,Q=0|s[3],X=8191&Q,J=Q>>>13,Z=0|s[4],$=8191&Z,ee=Z>>>13,te=0|s[5],oe=8191&te,ie=te>>>13,ae=0|s[6],ne=8191&ae,re=ae>>>13,se=0|s[7],ce=8191&se,le=se>>>13,de=0|s[8],ue=8191&de,he=de>>>13,pe=0|s[9],fe=8191&pe,ge=pe>>>13;o.negative=e.negative^t.negative,o.length=19;var me=(l+(i=Math.imul(u,U))|0)+((8191&(a=(a=Math.imul(u,x))+Math.imul(h,U)|0))<<13)|0;l=((n=Math.imul(h,x))+(a>>>13)|0)+(me>>>26)|0,me&=67108863,i=Math.imul(f,U),a=(a=Math.imul(f,x))+Math.imul(g,U)|0,n=Math.imul(g,x);var _e=(l+(i=i+Math.imul(u,j)|0)|0)+((8191&(a=(a=a+Math.imul(u,W)|0)+Math.imul(h,j)|0))<<13)|0;l=((n=n+Math.imul(h,W)|0)+(a>>>13)|0)+(_e>>>26)|0,_e&=67108863,i=Math.imul(_,U),a=(a=Math.imul(_,x))+Math.imul(y,U)|0,n=Math.imul(y,x),i=i+Math.imul(f,j)|0,a=(a=a+Math.imul(f,W)|0)+Math.imul(g,j)|0,n=n+Math.imul(g,W)|0;var ye=(l+(i=i+Math.imul(u,K)|0)|0)+((8191&(a=(a=a+Math.imul(u,q)|0)+Math.imul(h,K)|0))<<13)|0;l=((n=n+Math.imul(h,q)|0)+(a>>>13)|0)+(ye>>>26)|0,ye&=67108863,i=Math.imul(C,U),a=(a=Math.imul(C,x))+Math.imul(S,U)|0,n=Math.imul(S,x),i=i+Math.imul(_,j)|0,a=(a=a+Math.imul(_,W)|0)+Math.imul(y,j)|0,n=n+Math.imul(y,W)|0,i=i+Math.imul(f,K)|0,a=(a=a+Math.imul(f,q)|0)+Math.imul(g,K)|0,n=n+Math.imul(g,q)|0;var ve=(l+(i=i+Math.imul(u,X)|0)|0)+((8191&(a=(a=a+Math.imul(u,J)|0)+Math.imul(h,X)|0))<<13)|0;l=((n=n+Math.imul(h,J)|0)+(a>>>13)|0)+(ve>>>26)|0,ve&=67108863,i=Math.imul(I,U),a=(a=Math.imul(I,x))+Math.imul(N,U)|0,n=Math.imul(N,x),i=i+Math.imul(C,j)|0,a=(a=a+Math.imul(C,W)|0)+Math.imul(S,j)|0,n=n+Math.imul(S,W)|0,i=i+Math.imul(_,K)|0,a=(a=a+Math.imul(_,q)|0)+Math.imul(y,K)|0,n=n+Math.imul(y,q)|0,i=i+Math.imul(f,X)|0,a=(a=a+Math.imul(f,J)|0)+Math.imul(g,X)|0,n=n+Math.imul(g,J)|0;var Ce=(l+(i=i+Math.imul(u,$)|0)|0)+((8191&(a=(a=a+Math.imul(u,ee)|0)+Math.imul(h,$)|0))<<13)|0;l=((n=n+Math.imul(h,ee)|0)+(a>>>13)|0)+(Ce>>>26)|0,Ce&=67108863,i=Math.imul(w,U),a=(a=Math.imul(w,x))+Math.imul(E,U)|0,n=Math.imul(E,x),i=i+Math.imul(I,j)|0,a=(a=a+Math.imul(I,W)|0)+Math.imul(N,j)|0,n=n+Math.imul(N,W)|0,i=i+Math.imul(C,K)|0,a=(a=a+Math.imul(C,q)|0)+Math.imul(S,K)|0,n=n+Math.imul(S,q)|0,i=i+Math.imul(_,X)|0,a=(a=a+Math.imul(_,J)|0)+Math.imul(y,X)|0,n=n+Math.imul(y,J)|0,i=i+Math.imul(f,$)|0,a=(a=a+Math.imul(f,ee)|0)+Math.imul(g,$)|0,n=n+Math.imul(g,ee)|0;var Se=(l+(i=i+Math.imul(u,oe)|0)|0)+((8191&(a=(a=a+Math.imul(u,ie)|0)+Math.imul(h,oe)|0))<<13)|0;l=((n=n+Math.imul(h,ie)|0)+(a>>>13)|0)+(Se>>>26)|0,Se&=67108863,i=Math.imul(R,U),a=(a=Math.imul(R,x))+Math.imul(L,U)|0,n=Math.imul(L,x),i=i+Math.imul(w,j)|0,a=(a=a+Math.imul(w,W)|0)+Math.imul(E,j)|0,n=n+Math.imul(E,W)|0,i=i+Math.imul(I,K)|0,a=(a=a+Math.imul(I,q)|0)+Math.imul(N,K)|0,n=n+Math.imul(N,q)|0,i=i+Math.imul(C,X)|0,a=(a=a+Math.imul(C,J)|0)+Math.imul(S,X)|0,n=n+Math.imul(S,J)|0,i=i+Math.imul(_,$)|0,a=(a=a+Math.imul(_,ee)|0)+Math.imul(y,$)|0,n=n+Math.imul(y,ee)|0,i=i+Math.imul(f,oe)|0,a=(a=a+Math.imul(f,ie)|0)+Math.imul(g,oe)|0,n=n+Math.imul(g,ie)|0;var Te=(l+(i=i+Math.imul(u,ne)|0)|0)+((8191&(a=(a=a+Math.imul(u,re)|0)+Math.imul(h,ne)|0))<<13)|0;l=((n=n+Math.imul(h,re)|0)+(a>>>13)|0)+(Te>>>26)|0,Te&=67108863,i=Math.imul(D,U),a=(a=Math.imul(D,x))+Math.imul(M,U)|0,n=Math.imul(M,x),i=i+Math.imul(R,j)|0,a=(a=a+Math.imul(R,W)|0)+Math.imul(L,j)|0,n=n+Math.imul(L,W)|0,i=i+Math.imul(w,K)|0,a=(a=a+Math.imul(w,q)|0)+Math.imul(E,K)|0,n=n+Math.imul(E,q)|0,i=i+Math.imul(I,X)|0,a=(a=a+Math.imul(I,J)|0)+Math.imul(N,X)|0,n=n+Math.imul(N,J)|0,i=i+Math.imul(C,$)|0,a=(a=a+Math.imul(C,ee)|0)+Math.imul(S,$)|0,n=n+Math.imul(S,ee)|0,i=i+Math.imul(_,oe)|0,a=(a=a+Math.imul(_,ie)|0)+Math.imul(y,oe)|0,n=n+Math.imul(y,ie)|0,i=i+Math.imul(f,ne)|0,a=(a=a+Math.imul(f,re)|0)+Math.imul(g,ne)|0,n=n+Math.imul(g,re)|0;var Ie=(l+(i=i+Math.imul(u,ce)|0)|0)+((8191&(a=(a=a+Math.imul(u,le)|0)+Math.imul(h,ce)|0))<<13)|0;l=((n=n+Math.imul(h,le)|0)+(a>>>13)|0)+(Ie>>>26)|0,Ie&=67108863,i=Math.imul(k,U),a=(a=Math.imul(k,x))+Math.imul(G,U)|0,n=Math.imul(G,x),i=i+Math.imul(D,j)|0,a=(a=a+Math.imul(D,W)|0)+Math.imul(M,j)|0,n=n+Math.imul(M,W)|0,i=i+Math.imul(R,K)|0,a=(a=a+Math.imul(R,q)|0)+Math.imul(L,K)|0,n=n+Math.imul(L,q)|0,i=i+Math.imul(w,X)|0,a=(a=a+Math.imul(w,J)|0)+Math.imul(E,X)|0,n=n+Math.imul(E,J)|0,i=i+Math.imul(I,$)|0,a=(a=a+Math.imul(I,ee)|0)+Math.imul(N,$)|0,n=n+Math.imul(N,ee)|0,i=i+Math.imul(C,oe)|0,a=(a=a+Math.imul(C,ie)|0)+Math.imul(S,oe)|0,n=n+Math.imul(S,ie)|0,i=i+Math.imul(_,ne)|0,a=(a=a+Math.imul(_,re)|0)+Math.imul(y,ne)|0,n=n+Math.imul(y,re)|0,i=i+Math.imul(f,ce)|0,a=(a=a+Math.imul(f,le)|0)+Math.imul(g,ce)|0,n=n+Math.imul(g,le)|0;var Ne=(l+(i=i+Math.imul(u,ue)|0)|0)+((8191&(a=(a=a+Math.imul(u,he)|0)+Math.imul(h,ue)|0))<<13)|0;l=((n=n+Math.imul(h,he)|0)+(a>>>13)|0)+(Ne>>>26)|0,Ne&=67108863,i=Math.imul(H,U),a=(a=Math.imul(H,x))+Math.imul(V,U)|0,n=Math.imul(V,x),i=i+Math.imul(k,j)|0,a=(a=a+Math.imul(k,W)|0)+Math.imul(G,j)|0,n=n+Math.imul(G,W)|0,i=i+Math.imul(D,K)|0,a=(a=a+Math.imul(D,q)|0)+Math.imul(M,K)|0,n=n+Math.imul(M,q)|0,i=i+Math.imul(R,X)|0,a=(a=a+Math.imul(R,J)|0)+Math.imul(L,X)|0,n=n+Math.imul(L,J)|0,i=i+Math.imul(w,$)|0,a=(a=a+Math.imul(w,ee)|0)+Math.imul(E,$)|0,n=n+Math.imul(E,ee)|0,i=i+Math.imul(I,oe)|0,a=(a=a+Math.imul(I,ie)|0)+Math.imul(N,oe)|0,n=n+Math.imul(N,ie)|0,i=i+Math.imul(C,ne)|0,a=(a=a+Math.imul(C,re)|0)+Math.imul(S,ne)|0,n=n+Math.imul(S,re)|0,i=i+Math.imul(_,ce)|0,a=(a=a+Math.imul(_,le)|0)+Math.imul(y,ce)|0,n=n+Math.imul(y,le)|0,i=i+Math.imul(f,ue)|0,a=(a=a+Math.imul(f,he)|0)+Math.imul(g,ue)|0,n=n+Math.imul(g,he)|0;var be=(l+(i=i+Math.imul(u,fe)|0)|0)+((8191&(a=(a=a+Math.imul(u,ge)|0)+Math.imul(h,fe)|0))<<13)|0;l=((n=n+Math.imul(h,ge)|0)+(a>>>13)|0)+(be>>>26)|0,be&=67108863,i=Math.imul(H,j),a=(a=Math.imul(H,W))+Math.imul(V,j)|0,n=Math.imul(V,W),i=i+Math.imul(k,K)|0,a=(a=a+Math.imul(k,q)|0)+Math.imul(G,K)|0,n=n+Math.imul(G,q)|0,i=i+Math.imul(D,X)|0,a=(a=a+Math.imul(D,J)|0)+Math.imul(M,X)|0,n=n+Math.imul(M,J)|0,i=i+Math.imul(R,$)|0,a=(a=a+Math.imul(R,ee)|0)+Math.imul(L,$)|0,n=n+Math.imul(L,ee)|0,i=i+Math.imul(w,oe)|0,a=(a=a+Math.imul(w,ie)|0)+Math.imul(E,oe)|0,n=n+Math.imul(E,ie)|0,i=i+Math.imul(I,ne)|0,a=(a=a+Math.imul(I,re)|0)+Math.imul(N,ne)|0,n=n+Math.imul(N,re)|0,i=i+Math.imul(C,ce)|0,a=(a=a+Math.imul(C,le)|0)+Math.imul(S,ce)|0,n=n+Math.imul(S,le)|0,i=i+Math.imul(_,ue)|0,a=(a=a+Math.imul(_,he)|0)+Math.imul(y,ue)|0,n=n+Math.imul(y,he)|0;var we=(l+(i=i+Math.imul(f,fe)|0)|0)+((8191&(a=(a=a+Math.imul(f,ge)|0)+Math.imul(g,fe)|0))<<13)|0;l=((n=n+Math.imul(g,ge)|0)+(a>>>13)|0)+(we>>>26)|0,we&=67108863,i=Math.imul(H,K),a=(a=Math.imul(H,q))+Math.imul(V,K)|0,n=Math.imul(V,q),i=i+Math.imul(k,X)|0,a=(a=a+Math.imul(k,J)|0)+Math.imul(G,X)|0,n=n+Math.imul(G,J)|0,i=i+Math.imul(D,$)|0,a=(a=a+Math.imul(D,ee)|0)+Math.imul(M,$)|0,n=n+Math.imul(M,ee)|0,i=i+Math.imul(R,oe)|0,a=(a=a+Math.imul(R,ie)|0)+Math.imul(L,oe)|0,n=n+Math.imul(L,ie)|0,i=i+Math.imul(w,ne)|0,a=(a=a+Math.imul(w,re)|0)+Math.imul(E,ne)|0,n=n+Math.imul(E,re)|0,i=i+Math.imul(I,ce)|0,a=(a=a+Math.imul(I,le)|0)+Math.imul(N,ce)|0,n=n+Math.imul(N,le)|0,i=i+Math.imul(C,ue)|0,a=(a=a+Math.imul(C,he)|0)+Math.imul(S,ue)|0,n=n+Math.imul(S,he)|0;var Ee=(l+(i=i+Math.imul(_,fe)|0)|0)+((8191&(a=(a=a+Math.imul(_,ge)|0)+Math.imul(y,fe)|0))<<13)|0;l=((n=n+Math.imul(y,ge)|0)+(a>>>13)|0)+(Ee>>>26)|0,Ee&=67108863,i=Math.imul(H,X),a=(a=Math.imul(H,J))+Math.imul(V,X)|0,n=Math.imul(V,J),i=i+Math.imul(k,$)|0,a=(a=a+Math.imul(k,ee)|0)+Math.imul(G,$)|0,n=n+Math.imul(G,ee)|0,i=i+Math.imul(D,oe)|0,a=(a=a+Math.imul(D,ie)|0)+Math.imul(M,oe)|0,n=n+Math.imul(M,ie)|0,i=i+Math.imul(R,ne)|0,a=(a=a+Math.imul(R,re)|0)+Math.imul(L,ne)|0,n=n+Math.imul(L,re)|0,i=i+Math.imul(w,ce)|0,a=(a=a+Math.imul(w,le)|0)+Math.imul(E,ce)|0,n=n+Math.imul(E,le)|0,i=i+Math.imul(I,ue)|0,a=(a=a+Math.imul(I,he)|0)+Math.imul(N,ue)|0,n=n+Math.imul(N,he)|0;var Pe=(l+(i=i+Math.imul(C,fe)|0)|0)+((8191&(a=(a=a+Math.imul(C,ge)|0)+Math.imul(S,fe)|0))<<13)|0;l=((n=n+Math.imul(S,ge)|0)+(a>>>13)|0)+(Pe>>>26)|0,Pe&=67108863,i=Math.imul(H,$),a=(a=Math.imul(H,ee))+Math.imul(V,$)|0,n=Math.imul(V,ee),i=i+Math.imul(k,oe)|0,a=(a=a+Math.imul(k,ie)|0)+Math.imul(G,oe)|0,n=n+Math.imul(G,ie)|0,i=i+Math.imul(D,ne)|0,a=(a=a+Math.imul(D,re)|0)+Math.imul(M,ne)|0,n=n+Math.imul(M,re)|0,i=i+Math.imul(R,ce)|0,a=(a=a+Math.imul(R,le)|0)+Math.imul(L,ce)|0,n=n+Math.imul(L,le)|0,i=i+Math.imul(w,ue)|0,a=(a=a+Math.imul(w,he)|0)+Math.imul(E,ue)|0,n=n+Math.imul(E,he)|0;var Re=(l+(i=i+Math.imul(I,fe)|0)|0)+((8191&(a=(a=a+Math.imul(I,ge)|0)+Math.imul(N,fe)|0))<<13)|0;l=((n=n+Math.imul(N,ge)|0)+(a>>>13)|0)+(Re>>>26)|0,Re&=67108863,i=Math.imul(H,oe),a=(a=Math.imul(H,ie))+Math.imul(V,oe)|0,n=Math.imul(V,ie),i=i+Math.imul(k,ne)|0,a=(a=a+Math.imul(k,re)|0)+Math.imul(G,ne)|0,n=n+Math.imul(G,re)|0,i=i+Math.imul(D,ce)|0,a=(a=a+Math.imul(D,le)|0)+Math.imul(M,ce)|0,n=n+Math.imul(M,le)|0,i=i+Math.imul(R,ue)|0,a=(a=a+Math.imul(R,he)|0)+Math.imul(L,ue)|0,n=n+Math.imul(L,he)|0;var Le=(l+(i=i+Math.imul(w,fe)|0)|0)+((8191&(a=(a=a+Math.imul(w,ge)|0)+Math.imul(E,fe)|0))<<13)|0;l=((n=n+Math.imul(E,ge)|0)+(a>>>13)|0)+(Le>>>26)|0,Le&=67108863,i=Math.imul(H,ne),a=(a=Math.imul(H,re))+Math.imul(V,ne)|0,n=Math.imul(V,re),i=i+Math.imul(k,ce)|0,a=(a=a+Math.imul(k,le)|0)+Math.imul(G,ce)|0,n=n+Math.imul(G,le)|0,i=i+Math.imul(D,ue)|0,a=(a=a+Math.imul(D,he)|0)+Math.imul(M,ue)|0,n=n+Math.imul(M,he)|0;var Ae=(l+(i=i+Math.imul(R,fe)|0)|0)+((8191&(a=(a=a+Math.imul(R,ge)|0)+Math.imul(L,fe)|0))<<13)|0;l=((n=n+Math.imul(L,ge)|0)+(a>>>13)|0)+(Ae>>>26)|0,Ae&=67108863,i=Math.imul(H,ce),a=(a=Math.imul(H,le))+Math.imul(V,ce)|0,n=Math.imul(V,le),i=i+Math.imul(k,ue)|0,a=(a=a+Math.imul(k,he)|0)+Math.imul(G,ue)|0,n=n+Math.imul(G,he)|0;var De=(l+(i=i+Math.imul(D,fe)|0)|0)+((8191&(a=(a=a+Math.imul(D,ge)|0)+Math.imul(M,fe)|0))<<13)|0;l=((n=n+Math.imul(M,ge)|0)+(a>>>13)|0)+(De>>>26)|0,De&=67108863,i=Math.imul(H,ue),a=(a=Math.imul(H,he))+Math.imul(V,ue)|0,n=Math.imul(V,he);var Me=(l+(i=i+Math.imul(k,fe)|0)|0)+((8191&(a=(a=a+Math.imul(k,ge)|0)+Math.imul(G,fe)|0))<<13)|0;l=((n=n+Math.imul(G,ge)|0)+(a>>>13)|0)+(Me>>>26)|0,Me&=67108863;var Be=(l+(i=Math.imul(H,fe))|0)+((8191&(a=(a=Math.imul(H,ge))+Math.imul(V,fe)|0))<<13)|0;return l=((n=Math.imul(V,ge))+(a>>>13)|0)+(Be>>>26)|0,Be&=67108863,c[0]=me,c[1]=_e,c[2]=ye,c[3]=ve,c[4]=Ce,c[5]=Se,c[6]=Te,c[7]=Ie,c[8]=Ne,c[9]=be,c[10]=we,c[11]=Ee,c[12]=Pe,c[13]=Re,c[14]=Le,c[15]=Ae,c[16]=De,c[17]=Me,c[18]=Be,0!==l&&(c[19]=l,o.length++),o};function g(e,t,o){o.negative=t.negative^e.negative,o.length=e.length+t.length;for(var i=0,a=0,n=0;n<o.length-1;n++){var r=a;a=0;for(var s=67108863&i,c=Math.min(n,t.length-1),l=Math.max(0,n-e.length+1);l<=c;l++){var d=n-l,u=(0|e.words[d])*(0|t.words[l]),h=67108863&u;s=67108863&(h=h+s|0),a+=(r=(r=r+(u/67108864|0)|0)+(h>>>26)|0)>>>26,r&=67108863}o.words[n]=s,i=r,r=a}return 0!==i?o.words[n]=i:o.length--,o.strip()}function m(e,t,o){return(new _).mulp(e,t,o)}function _(e,t){this.x=e,this.y=t}Math.imul||(f=p),n.prototype.mulTo=function(e,t){var o=this.length+e.length;return 10===this.length&&10===e.length?f(this,e,t):o<63?p(this,e,t):o<1024?g(this,e,t):m(this,e,t)},_.prototype.makeRBT=function(e){for(var t=new Array(e),o=n.prototype._countBits(e)-1,i=0;i<e;i++)t[i]=this.revBin(i,o,e);return t},_.prototype.revBin=function(e,t,o){if(0===e||e===o-1)return e;for(var i=0,a=0;a<t;a++)i|=(1&e)<<t-a-1,e>>=1;return i},_.prototype.permute=function(e,t,o,i,a,n){for(var r=0;r<n;r++)i[r]=t[e[r]],a[r]=o[e[r]]},_.prototype.transform=function(e,t,o,i,a,n){this.permute(n,e,t,o,i,a);for(var r=1;r<a;r<<=1)for(var s=r<<1,c=Math.cos(2*Math.PI/s),l=Math.sin(2*Math.PI/s),d=0;d<a;d+=s)for(var u=c,h=l,p=0;p<r;p++){var f=o[d+p],g=i[d+p],m=o[d+p+r],_=i[d+p+r],y=u*m-h*_;_=u*_+h*m,m=y,o[d+p]=f+m,i[d+p]=g+_,o[d+p+r]=f-m,i[d+p+r]=g-_,p!==s&&(y=c*u-l*h,h=c*h+l*u,u=y)}},_.prototype.guessLen13b=function(e,t){var o=1|Math.max(t,e),i=1&o,a=0;for(o=o/2|0;o;o>>>=1)a++;return 1<<a+1+i},_.prototype.conjugate=function(e,t,o){if(!(o<=1))for(var i=0;i<o/2;i++){var a=e[i];e[i]=e[o-i-1],e[o-i-1]=a,a=t[i],t[i]=-t[o-i-1],t[o-i-1]=-a}},_.prototype.normalize13b=function(e,t){for(var o=0,i=0;i<t/2;i++){var a=8192*Math.round(e[2*i+1]/t)+Math.round(e[2*i]/t)+o;e[i]=67108863&a,o=a<67108864?0:a/67108864|0}return e},_.prototype.convert13b=function(e,t,o,a){for(var n=0,r=0;r<t;r++)n+=0|e[r],o[2*r]=8191&n,n>>>=13,o[2*r+1]=8191&n,n>>>=13;for(r=2*t;r<a;++r)o[r]=0;i(0===n),i(0==(-8192&n))},_.prototype.stub=function(e){for(var t=new Array(e),o=0;o<e;o++)t[o]=0;return t},_.prototype.mulp=function(e,t,o){var i=2*this.guessLen13b(e.length,t.length),a=this.makeRBT(i),n=this.stub(i),r=new Array(i),s=new Array(i),c=new Array(i),l=new Array(i),d=new Array(i),u=new Array(i),h=o.words;h.length=i,this.convert13b(e.words,e.length,r,i),this.convert13b(t.words,t.length,l,i),this.transform(r,n,s,c,i,a),this.transform(l,n,d,u,i,a);for(var p=0;p<i;p++){var f=s[p]*d[p]-c[p]*u[p];c[p]=s[p]*u[p]+c[p]*d[p],s[p]=f}return this.conjugate(s,c,i),this.transform(s,c,h,n,i,a),this.conjugate(h,n,i),this.normalize13b(h,i),o.negative=e.negative^t.negative,o.length=e.length+t.length,o.strip()},n.prototype.mul=function(e){var t=new n(null);return t.words=new Array(this.length+e.length),this.mulTo(e,t)},n.prototype.mulf=function(e){var t=new n(null);return t.words=new Array(this.length+e.length),m(this,e,t)},n.prototype.imul=function(e){return this.clone().mulTo(e,this)},n.prototype.imuln=function(e){i("number"==typeof e),i(e<67108864);for(var t=0,o=0;o<this.length;o++){var a=(0|this.words[o])*e,n=(67108863&a)+(67108863&t);t>>=26,t+=a/67108864|0,t+=n>>>26,this.words[o]=67108863&n}return 0!==t&&(this.words[o]=t,this.length++),this},n.prototype.muln=function(e){return this.clone().imuln(e)},n.prototype.sqr=function(){return this.mul(this)},n.prototype.isqr=function(){return this.imul(this.clone())},n.prototype.pow=function(e){var t=h(e);if(0===t.length)return new n(1);for(var o=this,i=0;i<t.length&&0===t[i];i++,o=o.sqr());if(++i<t.length)for(var a=o.sqr();i<t.length;i++,a=a.sqr())0!==t[i]&&(o=o.mul(a));return o},n.prototype.iushln=function(e){i("number"==typeof e&&e>=0);var t,o=e%26,a=(e-o)/26,n=67108863>>>26-o<<26-o;if(0!==o){var r=0;for(t=0;t<this.length;t++){var s=this.words[t]&n,c=(0|this.words[t])-s<<o;this.words[t]=c|r,r=s>>>26-o}r&&(this.words[t]=r,this.length++)}if(0!==a){for(t=this.length-1;t>=0;t--)this.words[t+a]=this.words[t];for(t=0;t<a;t++)this.words[t]=0;this.length+=a}return this.strip()},n.prototype.ishln=function(e){return i(0===this.negative),this.iushln(e)},n.prototype.iushrn=function(e,t,o){var a;i("number"==typeof e&&e>=0),a=t?(t-t%26)/26:0;var n=e%26,r=Math.min((e-n)/26,this.length),s=67108863^67108863>>>n<<n,c=o;if(a-=r,a=Math.max(0,a),c){for(var l=0;l<r;l++)c.words[l]=this.words[l];c.length=r}if(0===r);else if(this.length>r)for(this.length-=r,l=0;l<this.length;l++)this.words[l]=this.words[l+r];else this.words[0]=0,this.length=1;var d=0;for(l=this.length-1;l>=0&&(0!==d||l>=a);l--){var u=0|this.words[l];this.words[l]=d<<26-n|u>>>n,d=u&s}return c&&0!==d&&(c.words[c.length++]=d),0===this.length&&(this.words[0]=0,this.length=1),this.strip()},n.prototype.ishrn=function(e,t,o){return i(0===this.negative),this.iushrn(e,t,o)},n.prototype.shln=function(e){return this.clone().ishln(e)},n.prototype.ushln=function(e){return this.clone().iushln(e)},n.prototype.shrn=function(e){return this.clone().ishrn(e)},n.prototype.ushrn=function(e){return this.clone().iushrn(e)},n.prototype.testn=function(e){i("number"==typeof e&&e>=0);var t=e%26,o=(e-t)/26,a=1<<t;return!(this.length<=o||!(this.words[o]&a))},n.prototype.imaskn=function(e){i("number"==typeof e&&e>=0);var t=e%26,o=(e-t)/26;if(i(0===this.negative,"imaskn works only with positive numbers"),this.length<=o)return this;if(0!==t&&o++,this.length=Math.min(o,this.length),0!==t){var a=67108863^67108863>>>t<<t;this.words[this.length-1]&=a}return this.strip()},n.prototype.maskn=function(e){return this.clone().imaskn(e)},n.prototype.iaddn=function(e){return i("number"==typeof e),i(e<67108864),e<0?this.isubn(-e):0!==this.negative?1===this.length&&(0|this.words[0])<e?(this.words[0]=e-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(e),this.negative=1,this):this._iaddn(e)},n.prototype._iaddn=function(e){this.words[0]+=e;for(var t=0;t<this.length&&this.words[t]>=67108864;t++)this.words[t]-=67108864,t===this.length-1?this.words[t+1]=1:this.words[t+1]++;return this.length=Math.max(this.length,t+1),this},n.prototype.isubn=function(e){if(i("number"==typeof e),i(e<67108864),e<0)return this.iaddn(-e);if(0!==this.negative)return this.negative=0,this.iaddn(e),this.negative=1,this;if(this.words[0]-=e,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var t=0;t<this.length&&this.words[t]<0;t++)this.words[t]+=67108864,this.words[t+1]-=1;return this.strip()},n.prototype.addn=function(e){return this.clone().iaddn(e)},n.prototype.subn=function(e){return this.clone().isubn(e)},n.prototype.iabs=function(){return this.negative=0,this},n.prototype.abs=function(){return this.clone().iabs()},n.prototype._ishlnsubmul=function(e,t,o){var a,n,r=e.length+o;this._expand(r);var s=0;for(a=0;a<e.length;a++){n=(0|this.words[a+o])+s;var c=(0|e.words[a])*t;s=((n-=67108863&c)>>26)-(c/67108864|0),this.words[a+o]=67108863&n}for(;a<this.length-o;a++)s=(n=(0|this.words[a+o])+s)>>26,this.words[a+o]=67108863&n;if(0===s)return this.strip();for(i(-1===s),s=0,a=0;a<this.length;a++)s=(n=-(0|this.words[a])+s)>>26,this.words[a]=67108863&n;return this.negative=1,this.strip()},n.prototype._wordDiv=function(e,t){var o=(this.length,e.length),i=this.clone(),a=e,r=0|a.words[a.length-1];0!=(o=26-this._countBits(r))&&(a=a.ushln(o),i.iushln(o),r=0|a.words[a.length-1]);var s,c=i.length-a.length;if("mod"!==t){(s=new n(null)).length=c+1,s.words=new Array(s.length);for(var l=0;l<s.length;l++)s.words[l]=0}var d=i.clone()._ishlnsubmul(a,1,c);0===d.negative&&(i=d,s&&(s.words[c]=1));for(var u=c-1;u>=0;u--){var h=67108864*(0|i.words[a.length+u])+(0|i.words[a.length+u-1]);for(h=Math.min(h/r|0,67108863),i._ishlnsubmul(a,h,u);0!==i.negative;)h--,i.negative=0,i._ishlnsubmul(a,1,u),i.isZero()||(i.negative^=1);s&&(s.words[u]=h)}return s&&s.strip(),i.strip(),"div"!==t&&0!==o&&i.iushrn(o),{div:s||null,mod:i}},n.prototype.divmod=function(e,t,o){return i(!e.isZero()),this.isZero()?{div:new n(0),mod:new n(0)}:0!==this.negative&&0===e.negative?(s=this.neg().divmod(e,t),"mod"!==t&&(a=s.div.neg()),"div"!==t&&(r=s.mod.neg(),o&&0!==r.negative&&r.iadd(e)),{div:a,mod:r}):0===this.negative&&0!==e.negative?(s=this.divmod(e.neg(),t),"mod"!==t&&(a=s.div.neg()),{div:a,mod:s.mod}):0!=(this.negative&e.negative)?(s=this.neg().divmod(e.neg(),t),"div"!==t&&(r=s.mod.neg(),o&&0!==r.negative&&r.isub(e)),{div:s.div,mod:r}):e.length>this.length||this.cmp(e)<0?{div:new n(0),mod:this}:1===e.length?"div"===t?{div:this.divn(e.words[0]),mod:null}:"mod"===t?{div:null,mod:new n(this.modn(e.words[0]))}:{div:this.divn(e.words[0]),mod:new n(this.modn(e.words[0]))}:this._wordDiv(e,t);var a,r,s},n.prototype.div=function(e){return this.divmod(e,"div",!1).div},n.prototype.mod=function(e){return this.divmod(e,"mod",!1).mod},n.prototype.umod=function(e){return this.divmod(e,"mod",!0).mod},n.prototype.divRound=function(e){var t=this.divmod(e);if(t.mod.isZero())return t.div;var o=0!==t.div.negative?t.mod.isub(e):t.mod,i=e.ushrn(1),a=e.andln(1),n=o.cmp(i);return n<0||1===a&&0===n?t.div:0!==t.div.negative?t.div.isubn(1):t.div.iaddn(1)},n.prototype.modn=function(e){i(e<=67108863);for(var t=(1<<26)%e,o=0,a=this.length-1;a>=0;a--)o=(t*o+(0|this.words[a]))%e;return o},n.prototype.idivn=function(e){i(e<=67108863);for(var t=0,o=this.length-1;o>=0;o--){var a=(0|this.words[o])+67108864*t;this.words[o]=a/e|0,t=a%e}return this.strip()},n.prototype.divn=function(e){return this.clone().idivn(e)},n.prototype.egcd=function(e){i(0===e.negative),i(!e.isZero());var t=this,o=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var a=new n(1),r=new n(0),s=new n(0),c=new n(1),l=0;t.isEven()&&o.isEven();)t.iushrn(1),o.iushrn(1),++l;for(var d=o.clone(),u=t.clone();!t.isZero();){for(var h=0,p=1;0==(t.words[0]&p)&&h<26;++h,p<<=1);if(h>0)for(t.iushrn(h);h-- >0;)(a.isOdd()||r.isOdd())&&(a.iadd(d),r.isub(u)),a.iushrn(1),r.iushrn(1);for(var f=0,g=1;0==(o.words[0]&g)&&f<26;++f,g<<=1);if(f>0)for(o.iushrn(f);f-- >0;)(s.isOdd()||c.isOdd())&&(s.iadd(d),c.isub(u)),s.iushrn(1),c.iushrn(1);t.cmp(o)>=0?(t.isub(o),a.isub(s),r.isub(c)):(o.isub(t),s.isub(a),c.isub(r))}return{a:s,b:c,gcd:o.iushln(l)}},n.prototype._invmp=function(e){i(0===e.negative),i(!e.isZero());var t=this,o=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var a,r=new n(1),s=new n(0),c=o.clone();t.cmpn(1)>0&&o.cmpn(1)>0;){for(var l=0,d=1;0==(t.words[0]&d)&&l<26;++l,d<<=1);if(l>0)for(t.iushrn(l);l-- >0;)r.isOdd()&&r.iadd(c),r.iushrn(1);for(var u=0,h=1;0==(o.words[0]&h)&&u<26;++u,h<<=1);if(u>0)for(o.iushrn(u);u-- >0;)s.isOdd()&&s.iadd(c),s.iushrn(1);t.cmp(o)>=0?(t.isub(o),r.isub(s)):(o.isub(t),s.isub(r))}return(a=0===t.cmpn(1)?r:s).cmpn(0)<0&&a.iadd(e),a},n.prototype.gcd=function(e){if(this.isZero())return e.abs();if(e.isZero())return this.abs();var t=this.clone(),o=e.clone();t.negative=0,o.negative=0;for(var i=0;t.isEven()&&o.isEven();i++)t.iushrn(1),o.iushrn(1);for(;;){for(;t.isEven();)t.iushrn(1);for(;o.isEven();)o.iushrn(1);var a=t.cmp(o);if(a<0){var n=t;t=o,o=n}else if(0===a||0===o.cmpn(1))break;t.isub(o)}return o.iushln(i)},n.prototype.invm=function(e){return this.egcd(e).a.umod(e)},n.prototype.isEven=function(){return 0==(1&this.words[0])},n.prototype.isOdd=function(){return 1==(1&this.words[0])},n.prototype.andln=function(e){return this.words[0]&e},n.prototype.bincn=function(e){i("number"==typeof e);var t=e%26,o=(e-t)/26,a=1<<t;if(this.length<=o)return this._expand(o+1),this.words[o]|=a,this;for(var n=a,r=o;0!==n&&r<this.length;r++){var s=0|this.words[r];n=(s+=n)>>>26,s&=67108863,this.words[r]=s}return 0!==n&&(this.words[r]=n,this.length++),this},n.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},n.prototype.cmpn=function(e){var t,o=e<0;if(0!==this.negative&&!o)return-1;if(0===this.negative&&o)return 1;if(this.strip(),this.length>1)t=1;else{o&&(e=-e),i(e<=67108863,"Number is too big");var a=0|this.words[0];t=a===e?0:a<e?-1:1}return 0!==this.negative?0|-t:t},n.prototype.cmp=function(e){if(0!==this.negative&&0===e.negative)return-1;if(0===this.negative&&0!==e.negative)return 1;var t=this.ucmp(e);return 0!==this.negative?0|-t:t},n.prototype.ucmp=function(e){if(this.length>e.length)return 1;if(this.length<e.length)return-1;for(var t=0,o=this.length-1;o>=0;o--){var i=0|this.words[o],a=0|e.words[o];if(i!==a){i<a?t=-1:i>a&&(t=1);break}}return t},n.prototype.gtn=function(e){return 1===this.cmpn(e)},n.prototype.gt=function(e){return 1===this.cmp(e)},n.prototype.gten=function(e){return this.cmpn(e)>=0},n.prototype.gte=function(e){return this.cmp(e)>=0},n.prototype.ltn=function(e){return-1===this.cmpn(e)},n.prototype.lt=function(e){return-1===this.cmp(e)},n.prototype.lten=function(e){return this.cmpn(e)<=0},n.prototype.lte=function(e){return this.cmp(e)<=0},n.prototype.eqn=function(e){return 0===this.cmpn(e)},n.prototype.eq=function(e){return 0===this.cmp(e)},n.red=function(e){return new N(e)},n.prototype.toRed=function(e){return i(!this.red,"Already a number in reduction context"),i(0===this.negative,"red works only with positives"),e.convertTo(this)._forceRed(e)},n.prototype.fromRed=function(){return i(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},n.prototype._forceRed=function(e){return this.red=e,this},n.prototype.forceRed=function(e){return i(!this.red,"Already a number in reduction context"),this._forceRed(e)},n.prototype.redAdd=function(e){return i(this.red,"redAdd works only with red numbers"),this.red.add(this,e)},n.prototype.redIAdd=function(e){return i(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,e)},n.prototype.redSub=function(e){return i(this.red,"redSub works only with red numbers"),this.red.sub(this,e)},n.prototype.redISub=function(e){return i(this.red,"redISub works only with red numbers"),this.red.isub(this,e)},n.prototype.redShl=function(e){return i(this.red,"redShl works only with red numbers"),this.red.shl(this,e)},n.prototype.redMul=function(e){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.mul(this,e)},n.prototype.redIMul=function(e){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.imul(this,e)},n.prototype.redSqr=function(){return i(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},n.prototype.redISqr=function(){return i(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},n.prototype.redSqrt=function(){return i(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},n.prototype.redInvm=function(){return i(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},n.prototype.redNeg=function(){return i(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},n.prototype.redPow=function(e){return i(this.red&&!e.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,e)};var y={k256:null,p224:null,p192:null,p25519:null};function v(e,t){this.name=e,this.p=new n(t,16),this.n=this.p.bitLength(),this.k=new n(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function C(){v.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function S(){v.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function T(){v.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function I(){v.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function N(e){if("string"==typeof e){var t=n._prime(e);this.m=t.p,this.prime=t}else i(e.gtn(1),"modulus must be greater than 1"),this.m=e,this.prime=null}function b(e){N.call(this,e),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new n(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}v.prototype._tmp=function(){var e=new n(null);return e.words=new Array(Math.ceil(this.n/13)),e},v.prototype.ireduce=function(e){var t,o=e;do{this.split(o,this.tmp),t=(o=(o=this.imulK(o)).iadd(this.tmp)).bitLength()}while(t>this.n);var i=t<this.n?-1:o.ucmp(this.p);return 0===i?(o.words[0]=0,o.length=1):i>0?o.isub(this.p):void 0!==o.strip?o.strip():o._strip(),o},v.prototype.split=function(e,t){e.iushrn(this.n,0,t)},v.prototype.imulK=function(e){return e.imul(this.k)},a(C,v),C.prototype.split=function(e,t){for(var o=Math.min(e.length,9),i=0;i<o;i++)t.words[i]=e.words[i];if(t.length=o,e.length<=9)return e.words[0]=0,void(e.length=1);var a=e.words[9];for(t.words[t.length++]=4194303&a,i=10;i<e.length;i++){var n=0|e.words[i];e.words[i-10]=(4194303&n)<<4|a>>>22,a=n}a>>>=22,e.words[i-10]=a,0===a&&e.length>10?e.length-=10:e.length-=9},C.prototype.imulK=function(e){e.words[e.length]=0,e.words[e.length+1]=0,e.length+=2;for(var t=0,o=0;o<e.length;o++){var i=0|e.words[o];t+=977*i,e.words[o]=67108863&t,t=64*i+(t/67108864|0)}return 0===e.words[e.length-1]&&(e.length--,0===e.words[e.length-1]&&e.length--),e},a(S,v),a(T,v),a(I,v),I.prototype.imulK=function(e){for(var t=0,o=0;o<e.length;o++){var i=19*(0|e.words[o])+t,a=67108863&i;i>>>=26,e.words[o]=a,t=i}return 0!==t&&(e.words[e.length++]=t),e},n._prime=function(e){if(y[e])return y[e];var t;if("k256"===e)t=new C;else if("p224"===e)t=new S;else if("p192"===e)t=new T;else{if("p25519"!==e)throw new Error("Unknown prime "+e);t=new I}return y[e]=t,t},N.prototype._verify1=function(e){i(0===e.negative,"red works only with positives"),i(e.red,"red works only with red numbers")},N.prototype._verify2=function(e,t){i(0==(e.negative|t.negative),"red works only with positives"),i(e.red&&e.red===t.red,"red works only with red numbers")},N.prototype.imod=function(e){return this.prime?this.prime.ireduce(e)._forceRed(this):e.umod(this.m)._forceRed(this)},N.prototype.neg=function(e){return e.isZero()?e.clone():this.m.sub(e)._forceRed(this)},N.prototype.add=function(e,t){this._verify2(e,t);var o=e.add(t);return o.cmp(this.m)>=0&&o.isub(this.m),o._forceRed(this)},N.prototype.iadd=function(e,t){this._verify2(e,t);var o=e.iadd(t);return o.cmp(this.m)>=0&&o.isub(this.m),o},N.prototype.sub=function(e,t){this._verify2(e,t);var o=e.sub(t);return o.cmpn(0)<0&&o.iadd(this.m),o._forceRed(this)},N.prototype.isub=function(e,t){this._verify2(e,t);var o=e.isub(t);return o.cmpn(0)<0&&o.iadd(this.m),o},N.prototype.shl=function(e,t){return this._verify1(e),this.imod(e.ushln(t))},N.prototype.imul=function(e,t){return this._verify2(e,t),this.imod(e.imul(t))},N.prototype.mul=function(e,t){return this._verify2(e,t),this.imod(e.mul(t))},N.prototype.isqr=function(e){return this.imul(e,e.clone())},N.prototype.sqr=function(e){return this.mul(e,e)},N.prototype.sqrt=function(e){if(e.isZero())return e.clone();var t=this.m.andln(3);if(i(t%2==1),3===t){var o=this.m.add(new n(1)).iushrn(2);return this.pow(e,o)}for(var a=this.m.subn(1),r=0;!a.isZero()&&0===a.andln(1);)r++,a.iushrn(1);i(!a.isZero());var s=new n(1).toRed(this),c=s.redNeg(),l=this.m.subn(1).iushrn(1),d=this.m.bitLength();for(d=new n(2*d*d).toRed(this);0!==this.pow(d,l).cmp(c);)d.redIAdd(c);for(var u=this.pow(d,a),h=this.pow(e,a.addn(1).iushrn(1)),p=this.pow(e,a),f=r;0!==p.cmp(s);){for(var g=p,m=0;0!==g.cmp(s);m++)g=g.redSqr();i(m<f);var _=this.pow(u,new n(1).iushln(f-m-1));h=h.redMul(_),u=_.redSqr(),p=p.redMul(u),f=m}return h},N.prototype.invm=function(e){var t=e._invmp(this.m);return 0!==t.negative?(t.negative=0,this.imod(t).redNeg()):this.imod(t)},N.prototype.pow=function(e,t){if(t.isZero())return new n(1).toRed(this);if(0===t.cmpn(1))return e.clone();var o=new Array(16);o[0]=new n(1).toRed(this),o[1]=e;for(var i=2;i<o.length;i++)o[i]=this.mul(o[i-1],e);var a=o[0],r=0,s=0,c=t.bitLength()%26;for(0===c&&(c=26),i=t.length-1;i>=0;i--){for(var l=t.words[i],d=c-1;d>=0;d--){var u=l>>d&1;a!==o[0]&&(a=this.sqr(a)),0!==u||0!==r?(r<<=1,r|=u,(4==++s||0===i&&0===d)&&(a=this.mul(a,o[r]),s=0,r=0)):s=0}c=26}return a},N.prototype.convertTo=function(e){var t=e.umod(this.m);return t===e?t.clone():t},N.prototype.convertFrom=function(e){var t=e.clone();return t.red=null,t},n.mont=function(e){return new b(e)},a(b,N),b.prototype.convertTo=function(e){return this.imod(e.ushln(this.shift))},b.prototype.convertFrom=function(e){var t=this.imod(e.mul(this.rinv));return t.red=null,t},b.prototype.imul=function(e,t){if(e.isZero()||t.isZero())return e.words[0]=0,e.length=1,e;var o=e.imul(t),i=o.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),a=o.isub(i).iushrn(this.shift),n=a;return a.cmp(this.m)>=0?n=a.isub(this.m):a.cmpn(0)<0&&(n=a.iadd(this.m)),n._forceRed(this)},b.prototype.mul=function(e,t){if(e.isZero()||t.isZero())return new n(0)._forceRed(this);var o=e.mul(t),i=o.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),a=o.isub(i).iushrn(this.shift),r=a;return a.cmp(this.m)>=0?r=a.isub(this.m):a.cmpn(0)<0&&(r=a.iadd(this.m)),r._forceRed(this)},b.prototype.invm=function(e){return this.imod(e._invmp(this.m).mul(this.r2))._forceRed(this)}})(void 0===t||t,this)},{buffer:19}],16:[function(e,t,o){"use strict";o.byteLength=function(e){var t=l(e),o=t[0],i=t[1];return 3*(o+i)/4-i},o.toByteArray=function(e){var t,o,i=l(e),r=i[0],s=i[1],c=new n(d(0,r,s)),u=0,h=s>0?r-4:r;for(o=0;o<h;o+=4)t=a[e.charCodeAt(o)]<<18|a[e.charCodeAt(o+1)]<<12|a[e.charCodeAt(o+2)]<<6|a[e.charCodeAt(o+3)],c[u++]=t>>16&255,c[u++]=t>>8&255,c[u++]=255&t;return 2===s&&(t=a[e.charCodeAt(o)]<<2|a[e.charCodeAt(o+1)]>>4,c[u++]=255&t),1===s&&(t=a[e.charCodeAt(o)]<<10|a[e.charCodeAt(o+1)]<<4|a[e.charCodeAt(o+2)]>>2,c[u++]=t>>8&255,c[u++]=255&t),c},o.fromByteArray=function(e){for(var t,o=e.length,a=o%3,n=[],r=0,s=o-a;r<s;r+=16383)n.push(u(e,r,r+16383>s?s:r+16383));return 1===a?(t=e[o-1],n.push(i[t>>2]+i[t<<4&63]+"==")):2===a&&(t=(e[o-2]<<8)+e[o-1],n.push(i[t>>10]+i[t>>4&63]+i[t<<2&63]+"=")),n.join("")};for(var i=[],a=[],n="undefined"!=typeof Uint8Array?Uint8Array:Array,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,c=r.length;s<c;++s)i[s]=r[s],a[r.charCodeAt(s)]=s;function l(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var o=e.indexOf("=");return-1===o&&(o=t),[o,o===t?0:4-o%4]}function d(e,t,o){return 3*(t+o)/4-o}function u(e,t,o){for(var a,n,r=[],s=t;s<o;s+=3)a=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),r.push(i[(n=a)>>18&63]+i[n>>12&63]+i[n>>6&63]+i[63&n]);return r.join("")}a["-".charCodeAt(0)]=62,a["_".charCodeAt(0)]=63},{}],17:[function(e,t){(function(t,o){"use strict";function i(e,t){if(!e)throw new Error(t||"Assertion failed")}function a(e,t){e.super_=t;var o=function(){};o.prototype=t.prototype,e.prototype=new o,e.prototype.constructor=e}function n(e,t,o){if(n.isBN(e))return e;this.negative=0,this.words=null,this.length=0,this.red=null,null!==e&&("le"!==t&&"be"!==t||(o=t,t=10),this._init(e||0,t||10,o||"be"))}var r;"object"==typeof t?t.exports=n:o.BN=n,n.BN=n,n.wordSize=26;try{r=e("buffer").Buffer}catch(R){}function s(e,t,o){for(var a=0,n=Math.min(e.length,o),r=0,s=t;s<n;s++){var c,l=e.charCodeAt(s)-48;a<<=4,a|=c=l>=49&&l<=54?l-49+10:l>=17&&l<=22?l-17+10:l,r|=c}return i(!(240&r),"Invalid character in "+e),a}function c(e,t,o,a){for(var n=0,r=0,s=Math.min(e.length,o),c=t;c<s;c++){var l=e.charCodeAt(c)-48;n*=a,r=l>=49?l-49+10:l>=17?l-17+10:l,i(l>=0&&r<a,"Invalid character"),n+=r}return n}function l(e,t){e.words=t.words,e.length=t.length,e.negative=t.negative,e.red=t.red}function d(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}n.isBN=function(e){return e instanceof n||null!==e&&"object"==typeof e&&e.constructor.wordSize===n.wordSize&&Array.isArray(e.words)},n.max=function(e,t){return e.cmp(t)>0?e:t},n.min=function(e,t){return e.cmp(t)<0?e:t},n.prototype._init=function(e,t,o){if("number"==typeof e)return this._initNumber(e,t,o);if("object"==typeof e)return this._initArray(e,t,o);"hex"===t&&(t=16),i(t===(0|t)&&t>=2&&t<=36);var a=0;"-"===(e=e.toString().replace(/\s+/g,""))[0]&&a++,16===t?this._parseHex(e,a):this._parseBase(e,t,a),"-"===e[0]&&(this.negative=1),this._strip(),"le"===o&&this._initArray(this.toArray(),t,o)},n.prototype._initNumber=function(e,t,o){e<0&&(this.negative=1,e=-e),e<67108864?(this.words=[67108863&e],this.length=1):e<4503599627370496?(this.words=[67108863&e,e/67108864&67108863],this.length=2):(i(e<9007199254740992),this.words=[67108863&e,e/67108864&67108863,1],this.length=3),"le"===o&&this._initArray(this.toArray(),t,o)},n.prototype._initArray=function(e,t,o){if(i("number"==typeof e.length),e.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(e.length/3),this.words=new Array(this.length);for(var a=0;a<this.length;a++)this.words[a]=0;var n,r,s=0;if("be"===o)for(a=e.length-1,n=0;a>=0;a-=3)r=e[a]|e[a-1]<<8|e[a-2]<<16,this.words[n]|=r<<s&67108863,this.words[n+1]=r>>>26-s&67108863,(s+=24)>=26&&(s-=26,n++);else if("le"===o)for(a=0,n=0;a<e.length;a+=3)r=e[a]|e[a+1]<<8|e[a+2]<<16,this.words[n]|=r<<s&67108863,this.words[n+1]=r>>>26-s&67108863,(s+=24)>=26&&(s-=26,n++);return this._strip()},n.prototype._parseHex=function(e,t){this.length=Math.ceil((e.length-t)/6),this.words=new Array(this.length);for(var o=0;o<this.length;o++)this.words[o]=0;var i,a,n=0;for(o=e.length-6,i=0;o>=t;o-=6)a=s(e,o,o+6),this.words[i]|=a<<n&67108863,this.words[i+1]|=a>>>26-n&4194303,(n+=24)>=26&&(n-=26,i++);o+6!==t&&(a=s(e,t,o+6),this.words[i]|=a<<n&67108863,this.words[i+1]|=a>>>26-n&4194303),this._strip()},n.prototype._parseBase=function(e,t,o){this.words=[0],this.length=1;for(var i=0,a=1;a<=67108863;a*=t)i++;i--,a=a/t|0;for(var n=e.length-o,r=n%i,s=Math.min(n,n-r)+o,l=0,d=o;d<s;d+=i)l=c(e,d,d+i,t),this.imuln(a),this.words[0]+l<67108864?this.words[0]+=l:this._iaddn(l);if(0!==r){var u=1;for(l=c(e,d,e.length,t),d=0;d<r;d++)u*=t;this.imuln(u),this.words[0]+l<67108864?this.words[0]+=l:this._iaddn(l)}},n.prototype.copy=function(e){e.words=new Array(this.length);for(var t=0;t<this.length;t++)e.words[t]=this.words[t];e.length=this.length,e.negative=this.negative,e.red=this.red},n.prototype._move=function(e){l(e,this)},n.prototype.clone=function(){var e=new n(null);return this.copy(e),e},n.prototype._expand=function(e){for(;this.length<e;)this.words[this.length++]=0;return this},n.prototype._strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},n.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},"undefined"!=typeof Symbol&&"function"==typeof Symbol.for?n.prototype[Symbol.for("nodejs.util.inspect.custom")]=d:n.prototype.inspect=d;var u=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],h=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],p=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];n.prototype.toString=function(e,t){var o;if(t=0|t||1,16===(e=e||10)||"hex"===e){o="";for(var a=0,n=0,r=0;r<this.length;r++){var s=this.words[r],c=(16777215&(s<<a|n)).toString(16);o=0!=(n=s>>>24-a&16777215)||r!==this.length-1?u[6-c.length]+c+o:c+o,(a+=2)>=26&&(a-=26,r--)}for(0!==n&&(o=n.toString(16)+o);o.length%t!=0;)o="0"+o;return 0!==this.negative&&(o="-"+o),o}if(e===(0|e)&&e>=2&&e<=36){var l=h[e],d=p[e];o="";var f=this.clone();for(f.negative=0;!f.isZero();){var g=f.modrn(d).toString(e);o=(f=f.idivn(d)).isZero()?g+o:u[l-g.length]+g+o}for(this.isZero()&&(o="0"+o);o.length%t!=0;)o="0"+o;return 0!==this.negative&&(o="-"+o),o}i(!1,"Base should be between 2 and 36")},n.prototype.toNumber=function(){var e=this.words[0];return 2===this.length?e+=67108864*this.words[1]:3===this.length&&1===this.words[2]?e+=4503599627370496+67108864*this.words[1]:this.length>2&&i(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-e:e},n.prototype.toJSON=function(){return this.toString(16,2)},r&&(n.prototype.toBuffer=function(e,t){return this.toArrayLike(r,e,t)}),n.prototype.toArray=function(e,t){return this.toArrayLike(Array,e,t)};var f=function(e,t){return e.allocUnsafe?e.allocUnsafe(t):new e(t)};function g(e){for(var t=new Array(e.bitLength()),o=0;o<t.length;o++){var i=o/26|0,a=o%26;t[o]=e.words[i]>>>a&1}return t}function m(e,t,o){o.negative=t.negative^e.negative;var i=e.length+t.length|0;o.length=i,i=i-1|0;var a=0|e.words[0],n=0|t.words[0],r=a*n,s=67108863&r,c=r/67108864|0;o.words[0]=s;for(var l=1;l<i;l++){for(var d=c>>>26,u=67108863&c,h=Math.min(l,t.length-1),p=Math.max(0,l-e.length+1);p<=h;p++){var f=l-p|0;d+=(r=(a=0|e.words[f])*(n=0|t.words[p])+u)/67108864|0,u=67108863&r}o.words[l]=0|u,c=0|d}return 0!==c?o.words[l]=0|c:o.length--,o._strip()}n.prototype.toArrayLike=function(e,t,o){this._strip();var a=this.byteLength(),n=o||Math.max(1,a);i(a<=n,"byte array longer than desired length"),i(n>0,"Requested array length <= 0");var r=f(e,n);return this["_toArrayLike"+("le"===t?"LE":"BE")](r,a),r},n.prototype._toArrayLikeLE=function(e){for(var t=0,o=0,i=0,a=0;i<this.length;i++){var n=this.words[i]<<a|o;e[t++]=255&n,t<e.length&&(e[t++]=n>>8&255),t<e.length&&(e[t++]=n>>16&255),6===a?(t<e.length&&(e[t++]=n>>24&255),o=0,a=0):(o=n>>>24,a+=2)}if(t<e.length)for(e[t++]=o;t<e.length;)e[t++]=0},n.prototype._toArrayLikeBE=function(e){for(var t=e.length-1,o=0,i=0,a=0;i<this.length;i++){var n=this.words[i]<<a|o;e[t--]=255&n,t>=0&&(e[t--]=n>>8&255),t>=0&&(e[t--]=n>>16&255),6===a?(t>=0&&(e[t--]=n>>24&255),o=0,a=0):(o=n>>>24,a+=2)}if(t>=0)for(e[t--]=o;t>=0;)e[t--]=0},Math.clz32?n.prototype._countBits=function(e){return 32-Math.clz32(e)}:n.prototype._countBits=function(e){var t=e,o=0;return t>=4096&&(o+=13,t>>>=13),t>=64&&(o+=7,t>>>=7),t>=8&&(o+=4,t>>>=4),t>=2&&(o+=2,t>>>=2),o+t},n.prototype._zeroBits=function(e){if(0===e)return 26;var t=e,o=0;return 0==(8191&t)&&(o+=13,t>>>=13),0==(127&t)&&(o+=7,t>>>=7),0==(15&t)&&(o+=4,t>>>=4),0==(3&t)&&(o+=2,t>>>=2),0==(1&t)&&o++,o},n.prototype.bitLength=function(){var e=this.words[this.length-1],t=this._countBits(e);return 26*(this.length-1)+t},n.prototype.zeroBits=function(){if(this.isZero())return 0;for(var e=0,t=0;t<this.length;t++){var o=this._zeroBits(this.words[t]);if(e+=o,26!==o)break}return e},n.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},n.prototype.toTwos=function(e){return 0!==this.negative?this.abs().inotn(e).iaddn(1):this.clone()},n.prototype.fromTwos=function(e){return this.testn(e-1)?this.notn(e).iaddn(1).ineg():this.clone()},n.prototype.isNeg=function(){return 0!==this.negative},n.prototype.neg=function(){return this.clone().ineg()},n.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},n.prototype.iuor=function(e){for(;this.length<e.length;)this.words[this.length++]=0;for(var t=0;t<e.length;t++)this.words[t]=this.words[t]|e.words[t];return this._strip()},n.prototype.ior=function(e){return i(0==(this.negative|e.negative)),this.iuor(e)},n.prototype.or=function(e){return this.length>e.length?this.clone().ior(e):e.clone().ior(this)},n.prototype.uor=function(e){return this.length>e.length?this.clone().iuor(e):e.clone().iuor(this)},n.prototype.iuand=function(e){var t;t=this.length>e.length?e:this;for(var o=0;o<t.length;o++)this.words[o]=this.words[o]&e.words[o];return this.length=t.length,this._strip()},n.prototype.iand=function(e){return i(0==(this.negative|e.negative)),this.iuand(e)},n.prototype.and=function(e){return this.length>e.length?this.clone().iand(e):e.clone().iand(this)},n.prototype.uand=function(e){return this.length>e.length?this.clone().iuand(e):e.clone().iuand(this)},n.prototype.iuxor=function(e){var t,o;this.length>e.length?(t=this,o=e):(t=e,o=this);for(var i=0;i<o.length;i++)this.words[i]=t.words[i]^o.words[i];if(this!==t)for(;i<t.length;i++)this.words[i]=t.words[i];return this.length=t.length,this._strip()},n.prototype.ixor=function(e){return i(0==(this.negative|e.negative)),this.iuxor(e)},n.prototype.xor=function(e){return this.length>e.length?this.clone().ixor(e):e.clone().ixor(this)},n.prototype.uxor=function(e){return this.length>e.length?this.clone().iuxor(e):e.clone().iuxor(this)},n.prototype.inotn=function(e){i("number"==typeof e&&e>=0);var t=0|Math.ceil(e/26),o=e%26;this._expand(t),o>0&&t--;for(var a=0;a<t;a++)this.words[a]=67108863&~this.words[a];return o>0&&(this.words[a]=~this.words[a]&67108863>>26-o),this._strip()},n.prototype.notn=function(e){return this.clone().inotn(e)},n.prototype.setn=function(e,t){i("number"==typeof e&&e>=0);var o=e/26|0,a=e%26;return this._expand(o+1),this.words[o]=t?this.words[o]|1<<a:this.words[o]&~(1<<a),this._strip()},n.prototype.iadd=function(e){var t,o,i;if(0!==this.negative&&0===e.negative)return this.negative=0,t=this.isub(e),this.negative^=1,this._normSign();if(0===this.negative&&0!==e.negative)return e.negative=0,t=this.isub(e),e.negative=1,t._normSign();this.length>e.length?(o=this,i=e):(o=e,i=this);for(var a=0,n=0;n<i.length;n++)t=(0|o.words[n])+(0|i.words[n])+a,this.words[n]=67108863&t,a=t>>>26;for(;0!==a&&n<o.length;n++)t=(0|o.words[n])+a,this.words[n]=67108863&t,a=t>>>26;if(this.length=o.length,0!==a)this.words[this.length]=a,this.length++;else if(o!==this)for(;n<o.length;n++)this.words[n]=o.words[n];return this},n.prototype.add=function(e){var t;return 0!==e.negative&&0===this.negative?(e.negative=0,t=this.sub(e),e.negative^=1,t):0===e.negative&&0!==this.negative?(this.negative=0,t=e.sub(this),this.negative=1,t):this.length>e.length?this.clone().iadd(e):e.clone().iadd(this)},n.prototype.isub=function(e){if(0!==e.negative){e.negative=0;var t=this.iadd(e);return e.negative=1,t._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(e),this.negative=1,this._normSign();var o,i,a=this.cmp(e);if(0===a)return this.negative=0,this.length=1,this.words[0]=0,this;a>0?(o=this,i=e):(o=e,i=this);for(var n=0,r=0;r<i.length;r++)n=(t=(0|o.words[r])-(0|i.words[r])+n)>>26,this.words[r]=67108863&t;for(;0!==n&&r<o.length;r++)n=(t=(0|o.words[r])+n)>>26,this.words[r]=67108863&t;if(0===n&&r<o.length&&o!==this)for(;r<o.length;r++)this.words[r]=o.words[r];return this.length=Math.max(this.length,r),o!==this&&(this.negative=1),this._strip()},n.prototype.sub=function(e){return this.clone().isub(e)};var _=function(e,t,o){var i,a,n,r=e.words,s=t.words,c=o.words,l=0,d=0|r[0],u=8191&d,h=d>>>13,p=0|r[1],f=8191&p,g=p>>>13,m=0|r[2],_=8191&m,y=m>>>13,v=0|r[3],C=8191&v,S=v>>>13,T=0|r[4],I=8191&T,N=T>>>13,b=0|r[5],w=8191&b,E=b>>>13,P=0|r[6],R=8191&P,L=P>>>13,A=0|r[7],D=8191&A,M=A>>>13,B=0|r[8],k=8191&B,G=B>>>13,O=0|r[9],H=8191&O,V=O>>>13,F=0|s[0],U=8191&F,x=F>>>13,Y=0|s[1],j=8191&Y,W=Y>>>13,z=0|s[2],K=8191&z,q=z>>>13,Q=0|s[3],X=8191&Q,J=Q>>>13,Z=0|s[4],$=8191&Z,ee=Z>>>13,te=0|s[5],oe=8191&te,ie=te>>>13,ae=0|s[6],ne=8191&ae,re=ae>>>13,se=0|s[7],ce=8191&se,le=se>>>13,de=0|s[8],ue=8191&de,he=de>>>13,pe=0|s[9],fe=8191&pe,ge=pe>>>13;o.negative=e.negative^t.negative,o.length=19;var me=(l+(i=Math.imul(u,U))|0)+((8191&(a=(a=Math.imul(u,x))+Math.imul(h,U)|0))<<13)|0;l=((n=Math.imul(h,x))+(a>>>13)|0)+(me>>>26)|0,me&=67108863,i=Math.imul(f,U),a=(a=Math.imul(f,x))+Math.imul(g,U)|0,n=Math.imul(g,x);var _e=(l+(i=i+Math.imul(u,j)|0)|0)+((8191&(a=(a=a+Math.imul(u,W)|0)+Math.imul(h,j)|0))<<13)|0;l=((n=n+Math.imul(h,W)|0)+(a>>>13)|0)+(_e>>>26)|0,_e&=67108863,i=Math.imul(_,U),a=(a=Math.imul(_,x))+Math.imul(y,U)|0,n=Math.imul(y,x),i=i+Math.imul(f,j)|0,a=(a=a+Math.imul(f,W)|0)+Math.imul(g,j)|0,n=n+Math.imul(g,W)|0;var ye=(l+(i=i+Math.imul(u,K)|0)|0)+((8191&(a=(a=a+Math.imul(u,q)|0)+Math.imul(h,K)|0))<<13)|0;l=((n=n+Math.imul(h,q)|0)+(a>>>13)|0)+(ye>>>26)|0,ye&=67108863,i=Math.imul(C,U),a=(a=Math.imul(C,x))+Math.imul(S,U)|0,n=Math.imul(S,x),i=i+Math.imul(_,j)|0,a=(a=a+Math.imul(_,W)|0)+Math.imul(y,j)|0,n=n+Math.imul(y,W)|0,i=i+Math.imul(f,K)|0,a=(a=a+Math.imul(f,q)|0)+Math.imul(g,K)|0,n=n+Math.imul(g,q)|0;var ve=(l+(i=i+Math.imul(u,X)|0)|0)+((8191&(a=(a=a+Math.imul(u,J)|0)+Math.imul(h,X)|0))<<13)|0;l=((n=n+Math.imul(h,J)|0)+(a>>>13)|0)+(ve>>>26)|0,ve&=67108863,i=Math.imul(I,U),a=(a=Math.imul(I,x))+Math.imul(N,U)|0,n=Math.imul(N,x),i=i+Math.imul(C,j)|0,a=(a=a+Math.imul(C,W)|0)+Math.imul(S,j)|0,n=n+Math.imul(S,W)|0,i=i+Math.imul(_,K)|0,a=(a=a+Math.imul(_,q)|0)+Math.imul(y,K)|0,n=n+Math.imul(y,q)|0,i=i+Math.imul(f,X)|0,a=(a=a+Math.imul(f,J)|0)+Math.imul(g,X)|0,n=n+Math.imul(g,J)|0;var Ce=(l+(i=i+Math.imul(u,$)|0)|0)+((8191&(a=(a=a+Math.imul(u,ee)|0)+Math.imul(h,$)|0))<<13)|0;l=((n=n+Math.imul(h,ee)|0)+(a>>>13)|0)+(Ce>>>26)|0,Ce&=67108863,i=Math.imul(w,U),a=(a=Math.imul(w,x))+Math.imul(E,U)|0,n=Math.imul(E,x),i=i+Math.imul(I,j)|0,a=(a=a+Math.imul(I,W)|0)+Math.imul(N,j)|0,n=n+Math.imul(N,W)|0,i=i+Math.imul(C,K)|0,a=(a=a+Math.imul(C,q)|0)+Math.imul(S,K)|0,n=n+Math.imul(S,q)|0,i=i+Math.imul(_,X)|0,a=(a=a+Math.imul(_,J)|0)+Math.imul(y,X)|0,n=n+Math.imul(y,J)|0,i=i+Math.imul(f,$)|0,a=(a=a+Math.imul(f,ee)|0)+Math.imul(g,$)|0,n=n+Math.imul(g,ee)|0;var Se=(l+(i=i+Math.imul(u,oe)|0)|0)+((8191&(a=(a=a+Math.imul(u,ie)|0)+Math.imul(h,oe)|0))<<13)|0;l=((n=n+Math.imul(h,ie)|0)+(a>>>13)|0)+(Se>>>26)|0,Se&=67108863,i=Math.imul(R,U),a=(a=Math.imul(R,x))+Math.imul(L,U)|0,n=Math.imul(L,x),i=i+Math.imul(w,j)|0,a=(a=a+Math.imul(w,W)|0)+Math.imul(E,j)|0,n=n+Math.imul(E,W)|0,i=i+Math.imul(I,K)|0,a=(a=a+Math.imul(I,q)|0)+Math.imul(N,K)|0,n=n+Math.imul(N,q)|0,i=i+Math.imul(C,X)|0,a=(a=a+Math.imul(C,J)|0)+Math.imul(S,X)|0,n=n+Math.imul(S,J)|0,i=i+Math.imul(_,$)|0,a=(a=a+Math.imul(_,ee)|0)+Math.imul(y,$)|0,n=n+Math.imul(y,ee)|0,i=i+Math.imul(f,oe)|0,a=(a=a+Math.imul(f,ie)|0)+Math.imul(g,oe)|0,n=n+Math.imul(g,ie)|0;var Te=(l+(i=i+Math.imul(u,ne)|0)|0)+((8191&(a=(a=a+Math.imul(u,re)|0)+Math.imul(h,ne)|0))<<13)|0;l=((n=n+Math.imul(h,re)|0)+(a>>>13)|0)+(Te>>>26)|0,Te&=67108863,i=Math.imul(D,U),a=(a=Math.imul(D,x))+Math.imul(M,U)|0,n=Math.imul(M,x),i=i+Math.imul(R,j)|0,a=(a=a+Math.imul(R,W)|0)+Math.imul(L,j)|0,n=n+Math.imul(L,W)|0,i=i+Math.imul(w,K)|0,a=(a=a+Math.imul(w,q)|0)+Math.imul(E,K)|0,n=n+Math.imul(E,q)|0,i=i+Math.imul(I,X)|0,a=(a=a+Math.imul(I,J)|0)+Math.imul(N,X)|0,n=n+Math.imul(N,J)|0,i=i+Math.imul(C,$)|0,a=(a=a+Math.imul(C,ee)|0)+Math.imul(S,$)|0,n=n+Math.imul(S,ee)|0,i=i+Math.imul(_,oe)|0,a=(a=a+Math.imul(_,ie)|0)+Math.imul(y,oe)|0,n=n+Math.imul(y,ie)|0,i=i+Math.imul(f,ne)|0,a=(a=a+Math.imul(f,re)|0)+Math.imul(g,ne)|0,n=n+Math.imul(g,re)|0;var Ie=(l+(i=i+Math.imul(u,ce)|0)|0)+((8191&(a=(a=a+Math.imul(u,le)|0)+Math.imul(h,ce)|0))<<13)|0;l=((n=n+Math.imul(h,le)|0)+(a>>>13)|0)+(Ie>>>26)|0,Ie&=67108863,i=Math.imul(k,U),a=(a=Math.imul(k,x))+Math.imul(G,U)|0,n=Math.imul(G,x),i=i+Math.imul(D,j)|0,a=(a=a+Math.imul(D,W)|0)+Math.imul(M,j)|0,n=n+Math.imul(M,W)|0,i=i+Math.imul(R,K)|0,a=(a=a+Math.imul(R,q)|0)+Math.imul(L,K)|0,n=n+Math.imul(L,q)|0,i=i+Math.imul(w,X)|0,a=(a=a+Math.imul(w,J)|0)+Math.imul(E,X)|0,n=n+Math.imul(E,J)|0,i=i+Math.imul(I,$)|0,a=(a=a+Math.imul(I,ee)|0)+Math.imul(N,$)|0,n=n+Math.imul(N,ee)|0,i=i+Math.imul(C,oe)|0,a=(a=a+Math.imul(C,ie)|0)+Math.imul(S,oe)|0,n=n+Math.imul(S,ie)|0,i=i+Math.imul(_,ne)|0,a=(a=a+Math.imul(_,re)|0)+Math.imul(y,ne)|0,n=n+Math.imul(y,re)|0,i=i+Math.imul(f,ce)|0,a=(a=a+Math.imul(f,le)|0)+Math.imul(g,ce)|0,n=n+Math.imul(g,le)|0;var Ne=(l+(i=i+Math.imul(u,ue)|0)|0)+((8191&(a=(a=a+Math.imul(u,he)|0)+Math.imul(h,ue)|0))<<13)|0;l=((n=n+Math.imul(h,he)|0)+(a>>>13)|0)+(Ne>>>26)|0,Ne&=67108863,i=Math.imul(H,U),a=(a=Math.imul(H,x))+Math.imul(V,U)|0,n=Math.imul(V,x),i=i+Math.imul(k,j)|0,a=(a=a+Math.imul(k,W)|0)+Math.imul(G,j)|0,n=n+Math.imul(G,W)|0,i=i+Math.imul(D,K)|0,a=(a=a+Math.imul(D,q)|0)+Math.imul(M,K)|0,n=n+Math.imul(M,q)|0,i=i+Math.imul(R,X)|0,a=(a=a+Math.imul(R,J)|0)+Math.imul(L,X)|0,n=n+Math.imul(L,J)|0,i=i+Math.imul(w,$)|0,a=(a=a+Math.imul(w,ee)|0)+Math.imul(E,$)|0,n=n+Math.imul(E,ee)|0,i=i+Math.imul(I,oe)|0,a=(a=a+Math.imul(I,ie)|0)+Math.imul(N,oe)|0,n=n+Math.imul(N,ie)|0,i=i+Math.imul(C,ne)|0,a=(a=a+Math.imul(C,re)|0)+Math.imul(S,ne)|0,n=n+Math.imul(S,re)|0,i=i+Math.imul(_,ce)|0,a=(a=a+Math.imul(_,le)|0)+Math.imul(y,ce)|0,n=n+Math.imul(y,le)|0,i=i+Math.imul(f,ue)|0,a=(a=a+Math.imul(f,he)|0)+Math.imul(g,ue)|0,n=n+Math.imul(g,he)|0;var be=(l+(i=i+Math.imul(u,fe)|0)|0)+((8191&(a=(a=a+Math.imul(u,ge)|0)+Math.imul(h,fe)|0))<<13)|0;l=((n=n+Math.imul(h,ge)|0)+(a>>>13)|0)+(be>>>26)|0,be&=67108863,i=Math.imul(H,j),a=(a=Math.imul(H,W))+Math.imul(V,j)|0,n=Math.imul(V,W),i=i+Math.imul(k,K)|0,a=(a=a+Math.imul(k,q)|0)+Math.imul(G,K)|0,n=n+Math.imul(G,q)|0,i=i+Math.imul(D,X)|0,a=(a=a+Math.imul(D,J)|0)+Math.imul(M,X)|0,n=n+Math.imul(M,J)|0,i=i+Math.imul(R,$)|0,a=(a=a+Math.imul(R,ee)|0)+Math.imul(L,$)|0,n=n+Math.imul(L,ee)|0,i=i+Math.imul(w,oe)|0,a=(a=a+Math.imul(w,ie)|0)+Math.imul(E,oe)|0,n=n+Math.imul(E,ie)|0,i=i+Math.imul(I,ne)|0,a=(a=a+Math.imul(I,re)|0)+Math.imul(N,ne)|0,n=n+Math.imul(N,re)|0,i=i+Math.imul(C,ce)|0,a=(a=a+Math.imul(C,le)|0)+Math.imul(S,ce)|0,n=n+Math.imul(S,le)|0,i=i+Math.imul(_,ue)|0,a=(a=a+Math.imul(_,he)|0)+Math.imul(y,ue)|0,n=n+Math.imul(y,he)|0;var we=(l+(i=i+Math.imul(f,fe)|0)|0)+((8191&(a=(a=a+Math.imul(f,ge)|0)+Math.imul(g,fe)|0))<<13)|0;l=((n=n+Math.imul(g,ge)|0)+(a>>>13)|0)+(we>>>26)|0,we&=67108863,i=Math.imul(H,K),a=(a=Math.imul(H,q))+Math.imul(V,K)|0,n=Math.imul(V,q),i=i+Math.imul(k,X)|0,a=(a=a+Math.imul(k,J)|0)+Math.imul(G,X)|0,n=n+Math.imul(G,J)|0,i=i+Math.imul(D,$)|0,a=(a=a+Math.imul(D,ee)|0)+Math.imul(M,$)|0,n=n+Math.imul(M,ee)|0,i=i+Math.imul(R,oe)|0,a=(a=a+Math.imul(R,ie)|0)+Math.imul(L,oe)|0,n=n+Math.imul(L,ie)|0,i=i+Math.imul(w,ne)|0,a=(a=a+Math.imul(w,re)|0)+Math.imul(E,ne)|0,n=n+Math.imul(E,re)|0,i=i+Math.imul(I,ce)|0,a=(a=a+Math.imul(I,le)|0)+Math.imul(N,ce)|0,n=n+Math.imul(N,le)|0,i=i+Math.imul(C,ue)|0,a=(a=a+Math.imul(C,he)|0)+Math.imul(S,ue)|0,n=n+Math.imul(S,he)|0;var Ee=(l+(i=i+Math.imul(_,fe)|0)|0)+((8191&(a=(a=a+Math.imul(_,ge)|0)+Math.imul(y,fe)|0))<<13)|0;l=((n=n+Math.imul(y,ge)|0)+(a>>>13)|0)+(Ee>>>26)|0,Ee&=67108863,i=Math.imul(H,X),a=(a=Math.imul(H,J))+Math.imul(V,X)|0,n=Math.imul(V,J),i=i+Math.imul(k,$)|0,a=(a=a+Math.imul(k,ee)|0)+Math.imul(G,$)|0,n=n+Math.imul(G,ee)|0,i=i+Math.imul(D,oe)|0,a=(a=a+Math.imul(D,ie)|0)+Math.imul(M,oe)|0,n=n+Math.imul(M,ie)|0,i=i+Math.imul(R,ne)|0,a=(a=a+Math.imul(R,re)|0)+Math.imul(L,ne)|0,n=n+Math.imul(L,re)|0,i=i+Math.imul(w,ce)|0,a=(a=a+Math.imul(w,le)|0)+Math.imul(E,ce)|0,n=n+Math.imul(E,le)|0,i=i+Math.imul(I,ue)|0,a=(a=a+Math.imul(I,he)|0)+Math.imul(N,ue)|0,n=n+Math.imul(N,he)|0;var Pe=(l+(i=i+Math.imul(C,fe)|0)|0)+((8191&(a=(a=a+Math.imul(C,ge)|0)+Math.imul(S,fe)|0))<<13)|0;l=((n=n+Math.imul(S,ge)|0)+(a>>>13)|0)+(Pe>>>26)|0,Pe&=67108863,i=Math.imul(H,$),a=(a=Math.imul(H,ee))+Math.imul(V,$)|0,n=Math.imul(V,ee),i=i+Math.imul(k,oe)|0,a=(a=a+Math.imul(k,ie)|0)+Math.imul(G,oe)|0,n=n+Math.imul(G,ie)|0,i=i+Math.imul(D,ne)|0,a=(a=a+Math.imul(D,re)|0)+Math.imul(M,ne)|0,n=n+Math.imul(M,re)|0,i=i+Math.imul(R,ce)|0,a=(a=a+Math.imul(R,le)|0)+Math.imul(L,ce)|0,n=n+Math.imul(L,le)|0,i=i+Math.imul(w,ue)|0,a=(a=a+Math.imul(w,he)|0)+Math.imul(E,ue)|0,n=n+Math.imul(E,he)|0;var Re=(l+(i=i+Math.imul(I,fe)|0)|0)+((8191&(a=(a=a+Math.imul(I,ge)|0)+Math.imul(N,fe)|0))<<13)|0;l=((n=n+Math.imul(N,ge)|0)+(a>>>13)|0)+(Re>>>26)|0,Re&=67108863,i=Math.imul(H,oe),a=(a=Math.imul(H,ie))+Math.imul(V,oe)|0,n=Math.imul(V,ie),i=i+Math.imul(k,ne)|0,a=(a=a+Math.imul(k,re)|0)+Math.imul(G,ne)|0,n=n+Math.imul(G,re)|0,i=i+Math.imul(D,ce)|0,a=(a=a+Math.imul(D,le)|0)+Math.imul(M,ce)|0,n=n+Math.imul(M,le)|0,i=i+Math.imul(R,ue)|0,a=(a=a+Math.imul(R,he)|0)+Math.imul(L,ue)|0,n=n+Math.imul(L,he)|0;var Le=(l+(i=i+Math.imul(w,fe)|0)|0)+((8191&(a=(a=a+Math.imul(w,ge)|0)+Math.imul(E,fe)|0))<<13)|0;l=((n=n+Math.imul(E,ge)|0)+(a>>>13)|0)+(Le>>>26)|0,Le&=67108863,i=Math.imul(H,ne),a=(a=Math.imul(H,re))+Math.imul(V,ne)|0,n=Math.imul(V,re),i=i+Math.imul(k,ce)|0,a=(a=a+Math.imul(k,le)|0)+Math.imul(G,ce)|0,n=n+Math.imul(G,le)|0,i=i+Math.imul(D,ue)|0,a=(a=a+Math.imul(D,he)|0)+Math.imul(M,ue)|0,n=n+Math.imul(M,he)|0;var Ae=(l+(i=i+Math.imul(R,fe)|0)|0)+((8191&(a=(a=a+Math.imul(R,ge)|0)+Math.imul(L,fe)|0))<<13)|0;l=((n=n+Math.imul(L,ge)|0)+(a>>>13)|0)+(Ae>>>26)|0,Ae&=67108863,i=Math.imul(H,ce),a=(a=Math.imul(H,le))+Math.imul(V,ce)|0,n=Math.imul(V,le),i=i+Math.imul(k,ue)|0,a=(a=a+Math.imul(k,he)|0)+Math.imul(G,ue)|0,n=n+Math.imul(G,he)|0;var De=(l+(i=i+Math.imul(D,fe)|0)|0)+((8191&(a=(a=a+Math.imul(D,ge)|0)+Math.imul(M,fe)|0))<<13)|0;l=((n=n+Math.imul(M,ge)|0)+(a>>>13)|0)+(De>>>26)|0,De&=67108863,i=Math.imul(H,ue),a=(a=Math.imul(H,he))+Math.imul(V,ue)|0,n=Math.imul(V,he);var Me=(l+(i=i+Math.imul(k,fe)|0)|0)+((8191&(a=(a=a+Math.imul(k,ge)|0)+Math.imul(G,fe)|0))<<13)|0;l=((n=n+Math.imul(G,ge)|0)+(a>>>13)|0)+(Me>>>26)|0,Me&=67108863;var Be=(l+(i=Math.imul(H,fe))|0)+((8191&(a=(a=Math.imul(H,ge))+Math.imul(V,fe)|0))<<13)|0;return l=((n=Math.imul(V,ge))+(a>>>13)|0)+(Be>>>26)|0,Be&=67108863,c[0]=me,c[1]=_e,c[2]=ye,c[3]=ve,c[4]=Ce,c[5]=Se,c[6]=Te,c[7]=Ie,c[8]=Ne,c[9]=be,c[10]=we,c[11]=Ee,c[12]=Pe,c[13]=Re,c[14]=Le,c[15]=Ae,c[16]=De,c[17]=Me,c[18]=Be,0!==l&&(c[19]=l,o.length++),o};function y(e,t,o){o.negative=t.negative^e.negative,o.length=e.length+t.length;for(var i=0,a=0,n=0;n<o.length-1;n++){var r=a;a=0;for(var s=67108863&i,c=Math.min(n,t.length-1),l=Math.max(0,n-e.length+1);l<=c;l++){var d=n-l,u=(0|e.words[d])*(0|t.words[l]),h=67108863&u;s=67108863&(h=h+s|0),a+=(r=(r=r+(u/67108864|0)|0)+(h>>>26)|0)>>>26,r&=67108863}o.words[n]=s,i=r,r=a}return 0!==i?o.words[n]=i:o.length--,o._strip()}function v(e,t,o){return y(e,t,o)}function C(e,t){this.x=e,this.y=t}Math.imul||(_=m),n.prototype.mulTo=function(e,t){var o=this.length+e.length;return 10===this.length&&10===e.length?_(this,e,t):o<63?m(this,e,t):o<1024?y(this,e,t):v(this,e,t)},C.prototype.makeRBT=function(e){for(var t=new Array(e),o=n.prototype._countBits(e)-1,i=0;i<e;i++)t[i]=this.revBin(i,o,e);return t},C.prototype.revBin=function(e,t,o){if(0===e||e===o-1)return e;for(var i=0,a=0;a<t;a++)i|=(1&e)<<t-a-1,e>>=1;return i},C.prototype.permute=function(e,t,o,i,a,n){for(var r=0;r<n;r++)i[r]=t[e[r]],a[r]=o[e[r]]},C.prototype.transform=function(e,t,o,i,a,n){this.permute(n,e,t,o,i,a);for(var r=1;r<a;r<<=1)for(var s=r<<1,c=Math.cos(2*Math.PI/s),l=Math.sin(2*Math.PI/s),d=0;d<a;d+=s)for(var u=c,h=l,p=0;p<r;p++){var f=o[d+p],g=i[d+p],m=o[d+p+r],_=i[d+p+r],y=u*m-h*_;_=u*_+h*m,m=y,o[d+p]=f+m,i[d+p]=g+_,o[d+p+r]=f-m,i[d+p+r]=g-_,p!==s&&(y=c*u-l*h,h=c*h+l*u,u=y)}},C.prototype.guessLen13b=function(e,t){var o=1|Math.max(t,e),i=1&o,a=0;for(o=o/2|0;o;o>>>=1)a++;return 1<<a+1+i},C.prototype.conjugate=function(e,t,o){if(!(o<=1))for(var i=0;i<o/2;i++){var a=e[i];e[i]=e[o-i-1],e[o-i-1]=a,a=t[i],t[i]=-t[o-i-1],t[o-i-1]=-a}},C.prototype.normalize13b=function(e,t){for(var o=0,i=0;i<t/2;i++){var a=8192*Math.round(e[2*i+1]/t)+Math.round(e[2*i]/t)+o;e[i]=67108863&a,o=a<67108864?0:a/67108864|0}return e},C.prototype.convert13b=function(e,t,o,a){for(var n=0,r=0;r<t;r++)n+=0|e[r],o[2*r]=8191&n,n>>>=13,o[2*r+1]=8191&n,n>>>=13;for(r=2*t;r<a;++r)o[r]=0;i(0===n),i(0==(-8192&n))},C.prototype.stub=function(e){for(var t=new Array(e),o=0;o<e;o++)t[o]=0;return t},C.prototype.mulp=function(e,t,o){var i=2*this.guessLen13b(e.length,t.length),a=this.makeRBT(i),n=this.stub(i),r=new Array(i),s=new Array(i),c=new Array(i),l=new Array(i),d=new Array(i),u=new Array(i),h=o.words;h.length=i,this.convert13b(e.words,e.length,r,i),this.convert13b(t.words,t.length,l,i),this.transform(r,n,s,c,i,a),this.transform(l,n,d,u,i,a);for(var p=0;p<i;p++){var f=s[p]*d[p]-c[p]*u[p];c[p]=s[p]*u[p]+c[p]*d[p],s[p]=f}return this.conjugate(s,c,i),this.transform(s,c,h,n,i,a),this.conjugate(h,n,i),this.normalize13b(h,i),o.negative=e.negative^t.negative,o.length=e.length+t.length,o._strip()},n.prototype.mul=function(e){var t=new n(null);return t.words=new Array(this.length+e.length),this.mulTo(e,t)},n.prototype.mulf=function(e){var t=new n(null);return t.words=new Array(this.length+e.length),v(this,e,t)},n.prototype.imul=function(e){return this.clone().mulTo(e,this)},n.prototype.imuln=function(e){var t=e<0;t&&(e=-e),i("number"==typeof e),i(e<67108864);for(var o=0,a=0;a<this.length;a++){var n=(0|this.words[a])*e,r=(67108863&n)+(67108863&o);o>>=26,o+=n/67108864|0,o+=r>>>26,this.words[a]=67108863&r}return 0!==o&&(this.words[a]=o,this.length++),t?this.ineg():this},n.prototype.muln=function(e){return this.clone().imuln(e)},n.prototype.sqr=function(){return this.mul(this)},n.prototype.isqr=function(){return this.imul(this.clone())},n.prototype.pow=function(e){var t=g(e);if(0===t.length)return new n(1);for(var o=this,i=0;i<t.length&&0===t[i];i++,o=o.sqr());if(++i<t.length)for(var a=o.sqr();i<t.length;i++,a=a.sqr())0!==t[i]&&(o=o.mul(a));return o},n.prototype.iushln=function(e){i("number"==typeof e&&e>=0);var t,o=e%26,a=(e-o)/26,n=67108863>>>26-o<<26-o;if(0!==o){var r=0;for(t=0;t<this.length;t++){var s=this.words[t]&n,c=(0|this.words[t])-s<<o;this.words[t]=c|r,r=s>>>26-o}r&&(this.words[t]=r,this.length++)}if(0!==a){for(t=this.length-1;t>=0;t--)this.words[t+a]=this.words[t];for(t=0;t<a;t++)this.words[t]=0;this.length+=a}return this._strip()},n.prototype.ishln=function(e){return i(0===this.negative),this.iushln(e)},n.prototype.iushrn=function(e,t,o){var a;i("number"==typeof e&&e>=0),a=t?(t-t%26)/26:0;var n=e%26,r=Math.min((e-n)/26,this.length),s=67108863^67108863>>>n<<n,c=o;if(a-=r,a=Math.max(0,a),c){for(var l=0;l<r;l++)c.words[l]=this.words[l];c.length=r}if(0===r);else if(this.length>r)for(this.length-=r,l=0;l<this.length;l++)this.words[l]=this.words[l+r];else this.words[0]=0,this.length=1;var d=0;for(l=this.length-1;l>=0&&(0!==d||l>=a);l--){var u=0|this.words[l];this.words[l]=d<<26-n|u>>>n,d=u&s}return c&&0!==d&&(c.words[c.length++]=d),0===this.length&&(this.words[0]=0,this.length=1),this._strip()},n.prototype.ishrn=function(e,t,o){return i(0===this.negative),this.iushrn(e,t,o)},n.prototype.shln=function(e){return this.clone().ishln(e)},n.prototype.ushln=function(e){return this.clone().iushln(e)},n.prototype.shrn=function(e){return this.clone().ishrn(e)},n.prototype.ushrn=function(e){return this.clone().iushrn(e)},n.prototype.testn=function(e){i("number"==typeof e&&e>=0);var t=e%26,o=(e-t)/26,a=1<<t;return!(this.length<=o||!(this.words[o]&a))},n.prototype.imaskn=function(e){i("number"==typeof e&&e>=0);var t=e%26,o=(e-t)/26;if(i(0===this.negative,"imaskn works only with positive numbers"),this.length<=o)return this;if(0!==t&&o++,this.length=Math.min(o,this.length),0!==t){var a=67108863^67108863>>>t<<t;this.words[this.length-1]&=a}return this._strip()},n.prototype.maskn=function(e){return this.clone().imaskn(e)},n.prototype.iaddn=function(e){return i("number"==typeof e),i(e<67108864),e<0?this.isubn(-e):0!==this.negative?1===this.length&&(0|this.words[0])<=e?(this.words[0]=e-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(e),this.negative=1,this):this._iaddn(e)},n.prototype._iaddn=function(e){this.words[0]+=e;for(var t=0;t<this.length&&this.words[t]>=67108864;t++)this.words[t]-=67108864,t===this.length-1?this.words[t+1]=1:this.words[t+1]++;return this.length=Math.max(this.length,t+1),this},n.prototype.isubn=function(e){if(i("number"==typeof e),i(e<67108864),e<0)return this.iaddn(-e);if(0!==this.negative)return this.negative=0,this.iaddn(e),this.negative=1,this;if(this.words[0]-=e,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var t=0;t<this.length&&this.words[t]<0;t++)this.words[t]+=67108864,this.words[t+1]-=1;return this._strip()},n.prototype.addn=function(e){return this.clone().iaddn(e)},n.prototype.subn=function(e){return this.clone().isubn(e)},n.prototype.iabs=function(){return this.negative=0,this},n.prototype.abs=function(){return this.clone().iabs()},n.prototype._ishlnsubmul=function(e,t,o){var a,n,r=e.length+o;this._expand(r);var s=0;for(a=0;a<e.length;a++){n=(0|this.words[a+o])+s;var c=(0|e.words[a])*t;s=((n-=67108863&c)>>26)-(c/67108864|0),this.words[a+o]=67108863&n}for(;a<this.length-o;a++)s=(n=(0|this.words[a+o])+s)>>26,this.words[a+o]=67108863&n;if(0===s)return this._strip();for(i(-1===s),s=0,a=0;a<this.length;a++)s=(n=-(0|this.words[a])+s)>>26,this.words[a]=67108863&n;return this.negative=1,this._strip()},n.prototype._wordDiv=function(e,t){var o=(this.length,e.length),i=this.clone(),a=e,r=0|a.words[a.length-1];0!=(o=26-this._countBits(r))&&(a=a.ushln(o),i.iushln(o),r=0|a.words[a.length-1]);var s,c=i.length-a.length;if("mod"!==t){(s=new n(null)).length=c+1,s.words=new Array(s.length);for(var l=0;l<s.length;l++)s.words[l]=0}var d=i.clone()._ishlnsubmul(a,1,c);0===d.negative&&(i=d,s&&(s.words[c]=1));for(var u=c-1;u>=0;u--){var h=67108864*(0|i.words[a.length+u])+(0|i.words[a.length+u-1]);for(h=Math.min(h/r|0,67108863),i._ishlnsubmul(a,h,u);0!==i.negative;)h--,i.negative=0,i._ishlnsubmul(a,1,u),i.isZero()||(i.negative^=1);s&&(s.words[u]=h)}return s&&s._strip(),i._strip(),"div"!==t&&0!==o&&i.iushrn(o),{div:s||null,mod:i}},n.prototype.divmod=function(e,t,o){return i(!e.isZero()),this.isZero()?{div:new n(0),mod:new n(0)}:0!==this.negative&&0===e.negative?(s=this.neg().divmod(e,t),"mod"!==t&&(a=s.div.neg()),"div"!==t&&(r=s.mod.neg(),o&&0!==r.negative&&r.iadd(e)),{div:a,mod:r}):0===this.negative&&0!==e.negative?(s=this.divmod(e.neg(),t),"mod"!==t&&(a=s.div.neg()),{div:a,mod:s.mod}):0!=(this.negative&e.negative)?(s=this.neg().divmod(e.neg(),t),"div"!==t&&(r=s.mod.neg(),o&&0!==r.negative&&r.isub(e)),{div:s.div,mod:r}):e.length>this.length||this.cmp(e)<0?{div:new n(0),mod:this}:1===e.length?"div"===t?{div:this.divn(e.words[0]),mod:null}:"mod"===t?{div:null,mod:new n(this.modrn(e.words[0]))}:{div:this.divn(e.words[0]),mod:new n(this.modrn(e.words[0]))}:this._wordDiv(e,t);var a,r,s},n.prototype.div=function(e){return this.divmod(e,"div",!1).div},n.prototype.mod=function(e){return this.divmod(e,"mod",!1).mod},n.prototype.umod=function(e){return this.divmod(e,"mod",!0).mod},n.prototype.divRound=function(e){var t=this.divmod(e);if(t.mod.isZero())return t.div;var o=0!==t.div.negative?t.mod.isub(e):t.mod,i=e.ushrn(1),a=e.andln(1),n=o.cmp(i);return n<0||1===a&&0===n?t.div:0!==t.div.negative?t.div.isubn(1):t.div.iaddn(1)},n.prototype.modrn=function(e){var t=e<0;t&&(e=-e),i(e<=67108863);for(var o=(1<<26)%e,a=0,n=this.length-1;n>=0;n--)a=(o*a+(0|this.words[n]))%e;return t?-a:a},n.prototype.modn=function(e){return this.modrn(e)},n.prototype.idivn=function(e){var t=e<0;t&&(e=-e),i(e<=67108863);for(var o=0,a=this.length-1;a>=0;a--){var n=(0|this.words[a])+67108864*o;this.words[a]=n/e|0,o=n%e}return this._strip(),t?this.ineg():this},n.prototype.divn=function(e){return this.clone().idivn(e)},n.prototype.egcd=function(e){i(0===e.negative),i(!e.isZero());var t=this,o=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var a=new n(1),r=new n(0),s=new n(0),c=new n(1),l=0;t.isEven()&&o.isEven();)t.iushrn(1),o.iushrn(1),++l;for(var d=o.clone(),u=t.clone();!t.isZero();){for(var h=0,p=1;0==(t.words[0]&p)&&h<26;++h,p<<=1);if(h>0)for(t.iushrn(h);h-- >0;)(a.isOdd()||r.isOdd())&&(a.iadd(d),r.isub(u)),a.iushrn(1),r.iushrn(1);for(var f=0,g=1;0==(o.words[0]&g)&&f<26;++f,g<<=1);if(f>0)for(o.iushrn(f);f-- >0;)(s.isOdd()||c.isOdd())&&(s.iadd(d),c.isub(u)),s.iushrn(1),c.iushrn(1);t.cmp(o)>=0?(t.isub(o),a.isub(s),r.isub(c)):(o.isub(t),s.isub(a),c.isub(r))}return{a:s,b:c,gcd:o.iushln(l)}},n.prototype._invmp=function(e){i(0===e.negative),i(!e.isZero());var t=this,o=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var a,r=new n(1),s=new n(0),c=o.clone();t.cmpn(1)>0&&o.cmpn(1)>0;){for(var l=0,d=1;0==(t.words[0]&d)&&l<26;++l,d<<=1);if(l>0)for(t.iushrn(l);l-- >0;)r.isOdd()&&r.iadd(c),r.iushrn(1);for(var u=0,h=1;0==(o.words[0]&h)&&u<26;++u,h<<=1);if(u>0)for(o.iushrn(u);u-- >0;)s.isOdd()&&s.iadd(c),s.iushrn(1);t.cmp(o)>=0?(t.isub(o),r.isub(s)):(o.isub(t),s.isub(r))}return(a=0===t.cmpn(1)?r:s).cmpn(0)<0&&a.iadd(e),a},n.prototype.gcd=function(e){if(this.isZero())return e.abs();if(e.isZero())return this.abs();var t=this.clone(),o=e.clone();t.negative=0,o.negative=0;for(var i=0;t.isEven()&&o.isEven();i++)t.iushrn(1),o.iushrn(1);for(;;){for(;t.isEven();)t.iushrn(1);for(;o.isEven();)o.iushrn(1);var a=t.cmp(o);if(a<0){var n=t;t=o,o=n}else if(0===a||0===o.cmpn(1))break;t.isub(o)}return o.iushln(i)},n.prototype.invm=function(e){return this.egcd(e).a.umod(e)},n.prototype.isEven=function(){return 0==(1&this.words[0])},n.prototype.isOdd=function(){return 1==(1&this.words[0])},n.prototype.andln=function(e){return this.words[0]&e},n.prototype.bincn=function(e){i("number"==typeof e);var t=e%26,o=(e-t)/26,a=1<<t;if(this.length<=o)return this._expand(o+1),this.words[o]|=a,this;for(var n=a,r=o;0!==n&&r<this.length;r++){var s=0|this.words[r];n=(s+=n)>>>26,s&=67108863,this.words[r]=s}return 0!==n&&(this.words[r]=n,this.length++),this},n.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},n.prototype.cmpn=function(e){var t,o=e<0;if(0!==this.negative&&!o)return-1;if(0===this.negative&&o)return 1;if(this._strip(),this.length>1)t=1;else{o&&(e=-e),i(e<=67108863,"Number is too big");var a=0|this.words[0];t=a===e?0:a<e?-1:1}return 0!==this.negative?0|-t:t},n.prototype.cmp=function(e){if(0!==this.negative&&0===e.negative)return-1;if(0===this.negative&&0!==e.negative)return 1;var t=this.ucmp(e);return 0!==this.negative?0|-t:t},n.prototype.ucmp=function(e){if(this.length>e.length)return 1;if(this.length<e.length)return-1;for(var t=0,o=this.length-1;o>=0;o--){var i=0|this.words[o],a=0|e.words[o];if(i!==a){i<a?t=-1:i>a&&(t=1);break}}return t},n.prototype.gtn=function(e){return 1===this.cmpn(e)},n.prototype.gt=function(e){return 1===this.cmp(e)},n.prototype.gten=function(e){return this.cmpn(e)>=0},n.prototype.gte=function(e){return this.cmp(e)>=0},n.prototype.ltn=function(e){return-1===this.cmpn(e)},n.prototype.lt=function(e){return-1===this.cmp(e)},n.prototype.lten=function(e){return this.cmpn(e)<=0},n.prototype.lte=function(e){return this.cmp(e)<=0},n.prototype.eqn=function(e){return 0===this.cmpn(e)},n.prototype.eq=function(e){return 0===this.cmp(e)},n.red=function(e){return new E(e)},n.prototype.toRed=function(e){return i(!this.red,"Already a number in reduction context"),i(0===this.negative,"red works only with positives"),e.convertTo(this)._forceRed(e)},n.prototype.fromRed=function(){return i(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},n.prototype._forceRed=function(e){return this.red=e,this},n.prototype.forceRed=function(e){return i(!this.red,"Already a number in reduction context"),this._forceRed(e)},n.prototype.redAdd=function(e){return i(this.red,"redAdd works only with red numbers"),this.red.add(this,e)},n.prototype.redIAdd=function(e){return i(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,e)},n.prototype.redSub=function(e){return i(this.red,"redSub works only with red numbers"),this.red.sub(this,e)},n.prototype.redISub=function(e){return i(this.red,"redISub works only with red numbers"),this.red.isub(this,e)},n.prototype.redShl=function(e){return i(this.red,"redShl works only with red numbers"),this.red.shl(this,e)},n.prototype.redMul=function(e){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.mul(this,e)},n.prototype.redIMul=function(e){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.imul(this,e)},n.prototype.redSqr=function(){return i(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},n.prototype.redISqr=function(){return i(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},n.prototype.redSqrt=function(){return i(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},n.prototype.redInvm=function(){return i(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},n.prototype.redNeg=function(){return i(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},n.prototype.redPow=function(e){return i(this.red&&!e.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,e)};var S={k256:null,p224:null,p192:null,p25519:null};function T(e,t){this.name=e,this.p=new n(t,16),this.n=this.p.bitLength(),this.k=new n(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function I(){T.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function N(){T.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function b(){T.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function w(){T.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function E(e){if("string"==typeof e){var t=n._prime(e);this.m=t.p,this.prime=t}else i(e.gtn(1),"modulus must be greater than 1"),this.m=e,this.prime=null}function P(e){E.call(this,e),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new n(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}T.prototype._tmp=function(){var e=new n(null);return e.words=new Array(Math.ceil(this.n/13)),e},T.prototype.ireduce=function(e){var t,o=e;do{this.split(o,this.tmp),t=(o=(o=this.imulK(o)).iadd(this.tmp)).bitLength()}while(t>this.n);var i=t<this.n?-1:o.ucmp(this.p);return 0===i?(o.words[0]=0,o.length=1):i>0?o.isub(this.p):void 0!==o.strip?o.strip():o._strip(),o},T.prototype.split=function(e,t){e.iushrn(this.n,0,t)},T.prototype.imulK=function(e){return e.imul(this.k)},a(I,T),I.prototype.split=function(e,t){for(var o=Math.min(e.length,9),i=0;i<o;i++)t.words[i]=e.words[i];if(t.length=o,e.length<=9)return e.words[0]=0,void(e.length=1);var a=e.words[9];for(t.words[t.length++]=4194303&a,i=10;i<e.length;i++){var n=0|e.words[i];e.words[i-10]=(4194303&n)<<4|a>>>22,a=n}a>>>=22,e.words[i-10]=a,0===a&&e.length>10?e.length-=10:e.length-=9},I.prototype.imulK=function(e){e.words[e.length]=0,e.words[e.length+1]=0,e.length+=2;for(var t=0,o=0;o<e.length;o++){var i=0|e.words[o];t+=977*i,e.words[o]=67108863&t,t=64*i+(t/67108864|0)}return 0===e.words[e.length-1]&&(e.length--,0===e.words[e.length-1]&&e.length--),e},a(N,T),a(b,T),a(w,T),w.prototype.imulK=function(e){for(var t=0,o=0;o<e.length;o++){var i=19*(0|e.words[o])+t,a=67108863&i;i>>>=26,e.words[o]=a,t=i}return 0!==t&&(e.words[e.length++]=t),e},n._prime=function(e){if(S[e])return S[e];var t;if("k256"===e)t=new I;else if("p224"===e)t=new N;else if("p192"===e)t=new b;else{if("p25519"!==e)throw new Error("Unknown prime "+e);t=new w}return S[e]=t,t},E.prototype._verify1=function(e){i(0===e.negative,"red works only with positives"),i(e.red,"red works only with red numbers")},E.prototype._verify2=function(e,t){i(0==(e.negative|t.negative),"red works only with positives"),i(e.red&&e.red===t.red,"red works only with red numbers")},E.prototype.imod=function(e){return this.prime?this.prime.ireduce(e)._forceRed(this):(l(e,e.umod(this.m)._forceRed(this)),e)},E.prototype.neg=function(e){return e.isZero()?e.clone():this.m.sub(e)._forceRed(this)},E.prototype.add=function(e,t){this._verify2(e,t);var o=e.add(t);return o.cmp(this.m)>=0&&o.isub(this.m),o._forceRed(this)},E.prototype.iadd=function(e,t){this._verify2(e,t);var o=e.iadd(t);return o.cmp(this.m)>=0&&o.isub(this.m),o},E.prototype.sub=function(e,t){this._verify2(e,t);var o=e.sub(t);return o.cmpn(0)<0&&o.iadd(this.m),o._forceRed(this)},E.prototype.isub=function(e,t){this._verify2(e,t);var o=e.isub(t);return o.cmpn(0)<0&&o.iadd(this.m),o},E.prototype.shl=function(e,t){return this._verify1(e),this.imod(e.ushln(t))},E.prototype.imul=function(e,t){return this._verify2(e,t),this.imod(e.imul(t))},E.prototype.mul=function(e,t){return this._verify2(e,t),this.imod(e.mul(t))},E.prototype.isqr=function(e){return this.imul(e,e.clone())},E.prototype.sqr=function(e){return this.mul(e,e)},E.prototype.sqrt=function(e){if(e.isZero())return e.clone();var t=this.m.andln(3);if(i(t%2==1),3===t){var o=this.m.add(new n(1)).iushrn(2);return this.pow(e,o)}for(var a=this.m.subn(1),r=0;!a.isZero()&&0===a.andln(1);)r++,a.iushrn(1);i(!a.isZero());var s=new n(1).toRed(this),c=s.redNeg(),l=this.m.subn(1).iushrn(1),d=this.m.bitLength();for(d=new n(2*d*d).toRed(this);0!==this.pow(d,l).cmp(c);)d.redIAdd(c);for(var u=this.pow(d,a),h=this.pow(e,a.addn(1).iushrn(1)),p=this.pow(e,a),f=r;0!==p.cmp(s);){for(var g=p,m=0;0!==g.cmp(s);m++)g=g.redSqr();i(m<f);var _=this.pow(u,new n(1).iushln(f-m-1));h=h.redMul(_),u=_.redSqr(),p=p.redMul(u),f=m}return h},E.prototype.invm=function(e){var t=e._invmp(this.m);return 0!==t.negative?(t.negative=0,this.imod(t).redNeg()):this.imod(t)},E.prototype.pow=function(e,t){if(t.isZero())return new n(1).toRed(this);if(0===t.cmpn(1))return e.clone();var o=new Array(16);o[0]=new n(1).toRed(this),o[1]=e;for(var i=2;i<o.length;i++)o[i]=this.mul(o[i-1],e);var a=o[0],r=0,s=0,c=t.bitLength()%26;for(0===c&&(c=26),i=t.length-1;i>=0;i--){for(var l=t.words[i],d=c-1;d>=0;d--){var u=l>>d&1;a!==o[0]&&(a=this.sqr(a)),0!==u||0!==r?(r<<=1,r|=u,(4==++s||0===i&&0===d)&&(a=this.mul(a,o[r]),s=0,r=0)):s=0}c=26}return a},E.prototype.convertTo=function(e){var t=e.umod(this.m);return t===e?t.clone():t},E.prototype.convertFrom=function(e){var t=e.clone();return t.red=null,t},n.mont=function(e){return new P(e)},a(P,E),P.prototype.convertTo=function(e){return this.imod(e.ushln(this.shift))},P.prototype.convertFrom=function(e){var t=this.imod(e.mul(this.rinv));return t.red=null,t},P.prototype.imul=function(e,t){if(e.isZero()||t.isZero())return e.words[0]=0,e.length=1,e;var o=e.imul(t),i=o.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),a=o.isub(i).iushrn(this.shift),n=a;return a.cmp(this.m)>=0?n=a.isub(this.m):a.cmpn(0)<0&&(n=a.iadd(this.m)),n._forceRed(this)},P.prototype.mul=function(e,t){if(e.isZero()||t.isZero())return new n(0)._forceRed(this);var o=e.mul(t),i=o.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),a=o.isub(i).iushrn(this.shift),r=a;return a.cmp(this.m)>=0?r=a.isub(this.m):a.cmpn(0)<0&&(r=a.iadd(this.m)),r._forceRed(this)},P.prototype.invm=function(e){return this.imod(e._invmp(this.m).mul(this.r2))._forceRed(this)}})(void 0===t||t,this)},{buffer:19}],18:[function(e,t){var o;function i(e){this.rand=e}if(t.exports=function(e){return o||(o=new i(null)),o.generate(e)},t.exports.Rand=i,i.prototype.generate=function(e){return this._rand(e)},i.prototype._rand=function(e){if(this.rand.getBytes)return this.rand.getBytes(e);for(var t=new Uint8Array(e),o=0;o<t.length;o++)t[o]=this.rand.getByte();return t},"object"==typeof self)self.crypto&&self.crypto.getRandomValues?i.prototype._rand=function(e){var t=new Uint8Array(e);return self.crypto.getRandomValues(t),t}:self.msCrypto&&self.msCrypto.getRandomValues?i.prototype._rand=function(e){var t=new Uint8Array(e);return self.msCrypto.getRandomValues(t),t}:"object"==typeof window&&(i.prototype._rand=function(){throw new Error("Not implemented yet")});else try{var a=e("crypto");if("function"!=typeof a.randomBytes)throw new Error("Not supported");i.prototype._rand=function(e){return a.randomBytes(e)}}catch(n){}},{crypto:19}],19:[function(){},{}],20:[function(e,t){var o=e("safe-buffer").Buffer;function i(e){o.isBuffer(e)||(e=o.from(e));for(var t=e.length/4|0,i=new Array(t),a=0;a<t;a++)i[a]=e.readUInt32BE(4*a);return i}function a(e){for(;0<e.length;e++)e[0]=0}function n(e,t,o,i,a){for(var n,r,s,c,l=o[0],d=o[1],u=o[2],h=o[3],p=e[0]^t[0],f=e[1]^t[1],g=e[2]^t[2],m=e[3]^t[3],_=4,y=1;y<a;y++)n=l[p>>>24]^d[f>>>16&255]^u[g>>>8&255]^h[255&m]^t[_++],r=l[f>>>24]^d[g>>>16&255]^u[m>>>8&255]^h[255&p]^t[_++],s=l[g>>>24]^d[m>>>16&255]^u[p>>>8&255]^h[255&f]^t[_++],c=l[m>>>24]^d[p>>>16&255]^u[f>>>8&255]^h[255&g]^t[_++],p=n,f=r,g=s,m=c;return n=(i[p>>>24]<<24|i[f>>>16&255]<<16|i[g>>>8&255]<<8|i[255&m])^t[_++],r=(i[f>>>24]<<24|i[g>>>16&255]<<16|i[m>>>8&255]<<8|i[255&p])^t[_++],s=(i[g>>>24]<<24|i[m>>>16&255]<<16|i[p>>>8&255]<<8|i[255&f])^t[_++],c=(i[m>>>24]<<24|i[p>>>16&255]<<16|i[f>>>8&255]<<8|i[255&g])^t[_++],[n>>>=0,r>>>=0,s>>>=0,c>>>=0]}var r=[0,1,2,4,8,16,32,64,128,27,54],s=function(){for(var e=new Array(256),t=0;t<256;t++)e[t]=t<128?t<<1:t<<1^283;for(var o=[],i=[],a=[[],[],[],[]],n=[[],[],[],[]],r=0,s=0,c=0;c<256;++c){var l=s^s<<1^s<<2^s<<3^s<<4;l=l>>>8^255&l^99,o[r]=l,i[l]=r;var d=e[r],u=e[d],h=e[u],p=257*e[l]^16843008*l;a[0][r]=p<<24|p>>>8,a[1][r]=p<<16|p>>>16,a[2][r]=p<<8|p>>>24,a[3][r]=p,p=16843009*h^65537*u^257*d^16843008*r,n[0][l]=p<<24|p>>>8,n[1][l]=p<<16|p>>>16,n[2][l]=p<<8|p>>>24,n[3][l]=p,0===r?r=s=1:(r=d^e[e[e[h^d]]],s^=e[e[s]])}return{SBOX:o,INV_SBOX:i,SUB_MIX:a,INV_SUB_MIX:n}}();function c(e){this._key=i(e),this._reset()}c.blockSize=16,c.keySize=32,c.prototype.blockSize=c.blockSize,c.prototype.keySize=c.keySize,c.prototype._reset=function(){for(var e=this._key,t=e.length,o=t+6,i=4*(o+1),a=[],n=0;n<t;n++)a[n]=e[n];for(n=t;n<i;n++){var c=a[n-1];n%t==0?(c=c<<8|c>>>24,c=s.SBOX[c>>>24]<<24|s.SBOX[c>>>16&255]<<16|s.SBOX[c>>>8&255]<<8|s.SBOX[255&c],c^=r[n/t|0]<<24):t>6&&n%t==4&&(c=s.SBOX[c>>>24]<<24|s.SBOX[c>>>16&255]<<16|s.SBOX[c>>>8&255]<<8|s.SBOX[255&c]),a[n]=a[n-t]^c}for(var l=[],d=0;d<i;d++){var u=i-d,h=a[u-(d%4?0:4)];l[d]=d<4||u<=4?h:s.INV_SUB_MIX[0][s.SBOX[h>>>24]]^s.INV_SUB_MIX[1][s.SBOX[h>>>16&255]]^s.INV_SUB_MIX[2][s.SBOX[h>>>8&255]]^s.INV_SUB_MIX[3][s.SBOX[255&h]]}this._nRounds=o,this._keySchedule=a,this._invKeySchedule=l},c.prototype.encryptBlockRaw=function(e){return n(e=i(e),this._keySchedule,s.SUB_MIX,s.SBOX,this._nRounds)},c.prototype.encryptBlock=function(e){var t=this.encryptBlockRaw(e),i=o.allocUnsafe(16);return i.writeUInt32BE(t[0],0),i.writeUInt32BE(t[1],4),i.writeUInt32BE(t[2],8),i.writeUInt32BE(t[3],12),i},c.prototype.decryptBlock=function(e){var t=(e=i(e))[1];e[1]=e[3],e[3]=t;var a=n(e,this._invKeySchedule,s.INV_SUB_MIX,s.INV_SBOX,this._nRounds),r=o.allocUnsafe(16);return r.writeUInt32BE(a[0],0),r.writeUInt32BE(a[3],4),r.writeUInt32BE(a[2],8),r.writeUInt32BE(a[1],12),r},c.prototype.scrub=function(){a(this._keySchedule),a(this._invKeySchedule),a(this._key)},t.exports.AES=c},{"safe-buffer":185}],21:[function(e,t){var o=e("./aes"),i=e("safe-buffer").Buffer,a=e("cipher-base"),n=e("inherits"),r=e("./ghash"),s=e("buffer-xor"),c=e("./incr32");function l(e,t){var o=0;e.length!==t.length&&o++;for(var i=Math.min(e.length,t.length),a=0;a<i;++a)o+=e[a]^t[a];return o}function d(e,t,o){if(12===t.length)return e._finID=i.concat([t,i.from([0,0,0,1])]),i.concat([t,i.from([0,0,0,2])]);var a=new r(o),n=t.length,s=n%16;a.update(t),s&&(s=16-s,a.update(i.alloc(s,0))),a.update(i.alloc(8,0));var l=8*n,d=i.alloc(8);d.writeUIntBE(l,0,8),a.update(d),e._finID=a.state;var u=i.from(e._finID);return c(u),u}function u(e,t,n,s){a.call(this);var c=i.alloc(4,0);this._cipher=new o.AES(t);var l=this._cipher.encryptBlock(c);this._ghash=new r(l),n=d(this,n,l),this._prev=i.from(n),this._cache=i.allocUnsafe(0),this._secCache=i.allocUnsafe(0),this._decrypt=s,this._alen=0,this._len=0,this._mode=e,this._authTag=null,this._called=!1}n(u,a),u.prototype._update=function(e){if(!this._called&&this._alen){var t=16-this._alen%16;t<16&&(t=i.alloc(t,0),this._ghash.update(t))}this._called=!0;var o=this._mode.encrypt(this,e);return this._decrypt?this._ghash.update(e):this._ghash.update(o),this._len+=e.length,o},u.prototype._final=function(){if(this._decrypt&&!this._authTag)throw new Error("Unsupported state or unable to authenticate data");var e=s(this._ghash.final(8*this._alen,8*this._len),this._cipher.encryptBlock(this._finID));if(this._decrypt&&l(e,this._authTag))throw new Error("Unsupported state or unable to authenticate data");this._authTag=e,this._cipher.scrub()},u.prototype.getAuthTag=function(){if(this._decrypt||!i.isBuffer(this._authTag))throw new Error("Attempting to get auth tag in unsupported state");return this._authTag},u.prototype.setAuthTag=function(e){if(!this._decrypt)throw new Error("Attempting to set auth tag in unsupported state");this._authTag=e},u.prototype.setAAD=function(e){if(this._called)throw new Error("Attempting to set AAD in unsupported state");this._ghash.update(e),this._alen+=e.length},t.exports=u},{"./aes":20,"./ghash":25,"./incr32":26,"buffer-xor":65,"cipher-base":68,inherits:140,"safe-buffer":185}],22:[function(e,t,o){var i=e("./encrypter"),a=e("./decrypter"),n=e("./modes/list.json");o.createCipher=o.Cipher=i.createCipher,o.createCipheriv=o.Cipheriv=i.createCipheriv,o.createDecipher=o.Decipher=a.createDecipher,o.createDecipheriv=o.Decipheriv=a.createDecipheriv,o.listCiphers=o.getCiphers=function(){return Object.keys(n)}},{"./decrypter":23,"./encrypter":24,"./modes/list.json":34}],23:[function(e,t,o){var i=e("./authCipher"),a=e("safe-buffer").Buffer,n=e("./modes"),r=e("./streamCipher"),s=e("cipher-base"),c=e("./aes"),l=e("evp_bytestokey");function d(e,t,o){s.call(this),this._cache=new u,this._last=void 0,this._cipher=new c.AES(t),this._prev=a.from(o),this._mode=e,this._autopadding=!0}function u(){this.cache=a.allocUnsafe(0)}function h(e){var t=e[15];if(t<1||t>16)throw new Error("unable to decrypt data");for(var o=-1;++o<t;)if(e[o+(16-t)]!==t)throw new Error("unable to decrypt data");if(16!==t)return e.slice(0,16-t)}function p(e,t,o){var s=n[e.toLowerCase()];if(!s)throw new TypeError("invalid suite type");if("string"==typeof o&&(o=a.from(o)),"GCM"!==s.mode&&o.length!==s.iv)throw new TypeError("invalid iv length "+o.length);if("string"==typeof t&&(t=a.from(t)),t.length!==s.key/8)throw new TypeError("invalid key length "+t.length);return"stream"===s.type?new r(s.module,t,o,!0):"auth"===s.type?new i(s.module,t,o,!0):new d(s.module,t,o)}e("inherits")(d,s),d.prototype._update=function(e){var t,o;this._cache.add(e);for(var i=[];t=this._cache.get(this._autopadding);)o=this._mode.decrypt(this,t),i.push(o);return a.concat(i)},d.prototype._final=function(){var e=this._cache.flush();if(this._autopadding)return h(this._mode.decrypt(this,e));if(e)throw new Error("data not multiple of block length")},d.prototype.setAutoPadding=function(e){return this._autopadding=!!e,this},u.prototype.add=function(e){this.cache=a.concat([this.cache,e])},u.prototype.get=function(e){var t;if(e){if(this.cache.length>16)return t=this.cache.slice(0,16),this.cache=this.cache.slice(16),t}else if(this.cache.length>=16)return t=this.cache.slice(0,16),this.cache=this.cache.slice(16),t;return null},u.prototype.flush=function(){if(this.cache.length)return this.cache},o.createDecipher=function(e,t){var o=n[e.toLowerCase()];if(!o)throw new TypeError("invalid suite type");var i=l(t,!1,o.key,o.iv);return p(e,i.key,i.iv)},o.createDecipheriv=p},{"./aes":20,"./authCipher":21,"./modes":33,"./streamCipher":36,"cipher-base":68,evp_bytestokey:106,inherits:140,"safe-buffer":185}],24:[function(e,t,o){var i=e("./modes"),a=e("./authCipher"),n=e("safe-buffer").Buffer,r=e("./streamCipher"),s=e("cipher-base"),c=e("./aes"),l=e("evp_bytestokey");function d(e,t,o){s.call(this),this._cache=new h,this._cipher=new c.AES(t),this._prev=n.from(o),this._mode=e,this._autopadding=!0}e("inherits")(d,s),d.prototype._update=function(e){var t,o;this._cache.add(e);for(var i=[];t=this._cache.get();)o=this._mode.encrypt(this,t),i.push(o);return n.concat(i)};var u=n.alloc(16,16);function h(){this.cache=n.allocUnsafe(0)}function p(e,t,o){var s=i[e.toLowerCase()];if(!s)throw new TypeError("invalid suite type");if("string"==typeof t&&(t=n.from(t)),t.length!==s.key/8)throw new TypeError("invalid key length "+t.length);if("string"==typeof o&&(o=n.from(o)),"GCM"!==s.mode&&o.length!==s.iv)throw new TypeError("invalid iv length "+o.length);return"stream"===s.type?new r(s.module,t,o):"auth"===s.type?new a(s.module,t,o):new d(s.module,t,o)}d.prototype._final=function(){var e=this._cache.flush();if(this._autopadding)return e=this._mode.encrypt(this,e),this._cipher.scrub(),e;if(!e.equals(u))throw this._cipher.scrub(),new Error("data not multiple of block length")},d.prototype.setAutoPadding=function(e){return this._autopadding=!!e,this},h.prototype.add=function(e){this.cache=n.concat([this.cache,e])},h.prototype.get=function(){if(this.cache.length>15){var e=this.cache.slice(0,16);return this.cache=this.cache.slice(16),e}return null},h.prototype.flush=function(){for(var e=16-this.cache.length,t=n.allocUnsafe(e),o=-1;++o<e;)t.writeUInt8(e,o);return n.concat([this.cache,t])},o.createCipheriv=p,o.createCipher=function(e,t){var o=i[e.toLowerCase()];if(!o)throw new TypeError("invalid suite type");var a=l(t,!1,o.key,o.iv);return p(e,a.key,a.iv)}},{"./aes":20,"./authCipher":21,"./modes":33,"./streamCipher":36,"cipher-base":68,evp_bytestokey:106,inherits:140,"safe-buffer":185}],25:[function(e,t){var o=e("safe-buffer").Buffer,i=o.alloc(16,0);function a(e){var t=o.allocUnsafe(16);return t.writeUInt32BE(e[0]>>>0,0),t.writeUInt32BE(e[1]>>>0,4),t.writeUInt32BE(e[2]>>>0,8),t.writeUInt32BE(e[3]>>>0,12),t}function n(e){this.h=e,this.state=o.alloc(16,0),this.cache=o.allocUnsafe(0)}n.prototype.ghash=function(e){for(var t=-1;++t<e.length;)this.state[t]^=e[t];this._multiply()},n.prototype._multiply=function(){for(var e,t,o,i=[(e=this.h).readUInt32BE(0),e.readUInt32BE(4),e.readUInt32BE(8),e.readUInt32BE(12)],n=[0,0,0,0],r=-1;++r<128;){for(0!=(this.state[~~(r/8)]&1<<7-r%8)&&(n[0]^=i[0],n[1]^=i[1],n[2]^=i[2],n[3]^=i[3]),o=0!=(1&i[3]),t=3;t>0;t--)i[t]=i[t]>>>1|(1&i[t-1])<<31;i[0]=i[0]>>>1,o&&(i[0]=i[0]^225<<24)}this.state=a(n)},n.prototype.update=function(e){var t;for(this.cache=o.concat([this.cache,e]);this.cache.length>=16;)t=this.cache.slice(0,16),this.cache=this.cache.slice(16),this.ghash(t)},n.prototype.final=function(e,t){return this.cache.length&&this.ghash(o.concat([this.cache,i],16)),this.ghash(a([0,e,0,t])),this.state},t.exports=n},{"safe-buffer":185}],26:[function(e,t){t.exports=function(e){for(var t,o=e.length;o--;){if(255!==(t=e.readUInt8(o))){t++,e.writeUInt8(t,o);break}e.writeUInt8(0,o)}}},{}],27:[function(e,t,o){var i=e("buffer-xor");o.encrypt=function(e,t){var o=i(t,e._prev);return e._prev=e._cipher.encryptBlock(o),e._prev},o.decrypt=function(e,t){var o=e._prev;e._prev=t;var a=e._cipher.decryptBlock(t);return i(a,o)}},{"buffer-xor":65}],28:[function(e,t,o){var i=e("safe-buffer").Buffer,a=e("buffer-xor");function n(e,t,o){var n=t.length,r=a(t,e._cache);return e._cache=e._cache.slice(n),e._prev=i.concat([e._prev,o?t:r]),r}o.encrypt=function(e,t,o){for(var a,r=i.allocUnsafe(0);t.length;){if(0===e._cache.length&&(e._cache=e._cipher.encryptBlock(e._prev),e._prev=i.allocUnsafe(0)),!(e._cache.length<=t.length)){r=i.concat([r,n(e,t,o)]);break}a=e._cache.length,r=i.concat([r,n(e,t.slice(0,a),o)]),t=t.slice(a)}return r}},{"buffer-xor":65,"safe-buffer":185}],29:[function(e,t,o){var i=e("safe-buffer").Buffer;function a(e,t,o){for(var i,a,r=-1,s=0;++r<8;)i=t&1<<7-r?128:0,s+=(128&(a=e._cipher.encryptBlock(e._prev)[0]^i))>>r%8,e._prev=n(e._prev,o?i:a);return s}function n(e,t){var o=e.length,a=-1,n=i.allocUnsafe(e.length);for(e=i.concat([e,i.from([t])]);++a<o;)n[a]=e[a]<<1|e[a+1]>>7;return n}o.encrypt=function(e,t,o){for(var n=t.length,r=i.allocUnsafe(n),s=-1;++s<n;)r[s]=a(e,t[s],o);return r}},{"safe-buffer":185}],30:[function(e,t,o){var i=e("safe-buffer").Buffer;function a(e,t,o){var a=e._cipher.encryptBlock(e._prev)[0]^t;return e._prev=i.concat([e._prev.slice(1),i.from([o?t:a])]),a}o.encrypt=function(e,t,o){for(var n=t.length,r=i.allocUnsafe(n),s=-1;++s<n;)r[s]=a(e,t[s],o);return r}},{"safe-buffer":185}],31:[function(e,t,o){var i=e("buffer-xor"),a=e("safe-buffer").Buffer,n=e("../incr32");function r(e){var t=e._cipher.encryptBlockRaw(e._prev);return n(e._prev),t}o.encrypt=function(e,t){var o=Math.ceil(t.length/16),n=e._cache.length;e._cache=a.concat([e._cache,a.allocUnsafe(16*o)]);for(var s=0;s<o;s++){var c=r(e),l=n+16*s;e._cache.writeUInt32BE(c[0],l+0),e._cache.writeUInt32BE(c[1],l+4),e._cache.writeUInt32BE(c[2],l+8),e._cache.writeUInt32BE(c[3],l+12)}var d=e._cache.slice(0,t.length);return e._cache=e._cache.slice(t.length),i(t,d)}},{"../incr32":26,"buffer-xor":65,"safe-buffer":185}],32:[function(e,t,o){o.encrypt=function(e,t){return e._cipher.encryptBlock(t)},o.decrypt=function(e,t){return e._cipher.decryptBlock(t)}},{}],33:[function(e,t){var o={ECB:e("./ecb"),CBC:e("./cbc"),CFB:e("./cfb"),CFB8:e("./cfb8"),CFB1:e("./cfb1"),OFB:e("./ofb"),CTR:e("./ctr"),GCM:e("./ctr")},i=e("./list.json");for(var a in i)i[a].module=o[i[a].mode];t.exports=i},{"./cbc":27,"./cfb":28,"./cfb1":29,"./cfb8":30,"./ctr":31,"./ecb":32,"./list.json":34,"./ofb":35}],34:[function(e,t){t.exports={"aes-128-ecb":{cipher:"AES",key:128,iv:0,mode:"ECB",type:"block"},"aes-192-ecb":{cipher:"AES",key:192,iv:0,mode:"ECB",type:"block"},"aes-256-ecb":{cipher:"AES",key:256,iv:0,mode:"ECB",type:"block"},"aes-128-cbc":{cipher:"AES",key:128,iv:16,mode:"CBC",type:"block"},"aes-192-cbc":{cipher:"AES",key:192,iv:16,mode:"CBC",type:"block"},"aes-256-cbc":{cipher:"AES",key:256,iv:16,mode:"CBC",type:"block"},aes128:{cipher:"AES",key:128,iv:16,mode:"CBC",type:"block"},aes192:{cipher:"AES",key:192,iv:16,mode:"CBC",type:"block"},aes256:{cipher:"AES",key:256,iv:16,mode:"CBC",type:"block"},"aes-128-cfb":{cipher:"AES",key:128,iv:16,mode:"CFB",type:"stream"},"aes-192-cfb":{cipher:"AES",key:192,iv:16,mode:"CFB",type:"stream"},"aes-256-cfb":{cipher:"AES",key:256,iv:16,mode:"CFB",type:"stream"},"aes-128-cfb8":{cipher:"AES",key:128,iv:16,mode:"CFB8",type:"stream"},"aes-192-cfb8":{cipher:"AES",key:192,iv:16,mode:"CFB8",type:"stream"},"aes-256-cfb8":{cipher:"AES",key:256,iv:16,mode:"CFB8",type:"stream"},"aes-128-cfb1":{cipher:"AES",key:128,iv:16,mode:"CFB1",type:"stream"},"aes-192-cfb1":{cipher:"AES",key:192,iv:16,mode:"CFB1",type:"stream"},"aes-256-cfb1":{cipher:"AES",key:256,iv:16,mode:"CFB1",type:"stream"},"aes-128-ofb":{cipher:"AES",key:128,iv:16,mode:"OFB",type:"stream"},"aes-192-ofb":{cipher:"AES",key:192,iv:16,mode:"OFB",type:"stream"},"aes-256-ofb":{cipher:"AES",key:256,iv:16,mode:"OFB",type:"stream"},"aes-128-ctr":{cipher:"AES",key:128,iv:16,mode:"CTR",type:"stream"},"aes-192-ctr":{cipher:"AES",key:192,iv:16,mode:"CTR",type:"stream"},"aes-256-ctr":{cipher:"AES",key:256,iv:16,mode:"CTR",type:"stream"},"aes-128-gcm":{cipher:"AES",key:128,iv:12,mode:"GCM",type:"auth"},"aes-192-gcm":{cipher:"AES",key:192,iv:12,mode:"GCM",type:"auth"},"aes-256-gcm":{cipher:"AES",key:256,iv:12,mode:"GCM",type:"auth"}}},{}],35:[function(e,t,o){(function(t){var i=e("buffer-xor");function a(e){return e._prev=e._cipher.encryptBlock(e._prev),e._prev}o.encrypt=function(e,o){for(;e._cache.length<o.length;)e._cache=t.concat([e._cache,a(e)]);var n=e._cache.slice(0,o.length);return e._cache=e._cache.slice(o.length),i(o,n)}}).call(this,e("buffer").Buffer)},{buffer:66,"buffer-xor":65}],36:[function(e,t){var o=e("./aes"),i=e("safe-buffer").Buffer,a=e("cipher-base");function n(e,t,n,r){a.call(this),this._cipher=new o.AES(t),this._prev=i.from(n),this._cache=i.allocUnsafe(0),this._secCache=i.allocUnsafe(0),this._decrypt=r,this._mode=e}e("inherits")(n,a),n.prototype._update=function(e){return this._mode.encrypt(this,e,this._decrypt)},n.prototype._final=function(){this._cipher.scrub()},t.exports=n},{"./aes":20,"cipher-base":68,inherits:140,"safe-buffer":185}],37:[function(e,t,o){var i=e("browserify-des"),a=e("browserify-aes/browser"),n=e("browserify-aes/modes"),r=e("browserify-des/modes"),s=e("evp_bytestokey");function c(e,t,o){if(e=e.toLowerCase(),n[e])return a.createCipheriv(e,t,o);if(r[e])return new i({key:t,iv:o,mode:e});throw new TypeError("invalid suite type")}function l(e,t,o){if(e=e.toLowerCase(),n[e])return a.createDecipheriv(e,t,o);if(r[e])return new i({key:t,iv:o,mode:e,decrypt:!0});throw new TypeError("invalid suite type")}o.createCipher=o.Cipher=function(e,t){var o,i;if(e=e.toLowerCase(),n[e])o=n[e].key,i=n[e].iv;else{if(!r[e])throw new TypeError("invalid suite type");o=8*r[e].key,i=r[e].iv}var a=s(t,!1,o,i);return c(e,a.key,a.iv)},o.createCipheriv=o.Cipheriv=c,o.createDecipher=o.Decipher=function(e,t){var o,i;if(e=e.toLowerCase(),n[e])o=n[e].key,i=n[e].iv;else{if(!r[e])throw new TypeError("invalid suite type");o=8*r[e].key,i=r[e].iv}var a=s(t,!1,o,i);return l(e,a.key,a.iv)},o.createDecipheriv=o.Decipheriv=l,o.listCiphers=o.getCiphers=function(){return Object.keys(r).concat(a.getCiphers())}},{"browserify-aes/browser":22,"browserify-aes/modes":33,"browserify-des":38,"browserify-des/modes":39,evp_bytestokey:106}],38:[function(e,t){var o=e("cipher-base"),i=e("des.js"),a=e("inherits"),n=e("safe-buffer").Buffer,r={"des-ede3-cbc":i.CBC.instantiate(i.EDE),"des-ede3":i.EDE,"des-ede-cbc":i.CBC.instantiate(i.EDE),"des-ede":i.EDE,"des-cbc":i.CBC.instantiate(i.DES),"des-ecb":i.DES};function s(e){o.call(this);var t,i=e.mode.toLowerCase(),a=r[i];t=e.decrypt?"decrypt":"encrypt";var s=e.key;n.isBuffer(s)||(s=n.from(s)),"des-ede"!==i&&"des-ede-cbc"!==i||(s=n.concat([s,s.slice(0,8)]));var c=e.iv;n.isBuffer(c)||(c=n.from(c)),this._des=a.create({key:s,iv:c,type:t})}r.des=r["des-cbc"],r.des3=r["des-ede3-cbc"],t.exports=s,a(s,o),s.prototype._update=function(e){return n.from(this._des.update(e))},s.prototype._final=function(){return n.from(this._des.final())}},{"cipher-base":68,"des.js":77,inherits:140,"safe-buffer":185}],39:[function(e,t,o){o["des-ecb"]={key:8,iv:0},o["des-cbc"]=o.des={key:8,iv:8},o["des-ede3-cbc"]=o.des3={key:24,iv:8},o["des-ede3"]={key:24,iv:0},o["des-ede-cbc"]={key:16,iv:8},o["des-ede"]={key:16,iv:0}},{}],40:[function(e,t){(function(o){var i=e("bn.js"),a=e("randombytes");function n(e){var t=s(e);return{blinder:t.toRed(i.mont(e.modulus)).redPow(new i(e.publicExponent)).fromRed(),unblinder:t.invm(e.modulus)}}function r(e,t){var a=n(t),r=t.modulus.byteLength(),s=(i.mont(t.modulus),new i(e).mul(a.blinder).umod(t.modulus)),c=s.toRed(i.mont(t.prime1)),l=s.toRed(i.mont(t.prime2)),d=t.coefficient,u=t.prime1,h=t.prime2,p=c.redPow(t.exponent1),f=l.redPow(t.exponent2);p=p.fromRed(),f=f.fromRed();var g=p.isub(f).imul(d).umod(u);return g.imul(h),f.iadd(g),new o(f.imul(a.unblinder).umod(t.modulus).toArray(!1,r))}function s(e){for(var t=e.modulus.byteLength(),o=new i(a(t));o.cmp(e.modulus)>=0||!o.umod(e.prime1)||!o.umod(e.prime2);)o=new i(a(t));return o}t.exports=r,r.getr=s}).call(this,e("buffer").Buffer)},{"bn.js":41,buffer:66,randombytes:167}],41:[function(e,t,o){arguments[4][15][0].apply(o,arguments)},{buffer:19,dup:15}],42:[function(e,t){t.exports=e("./browser/algorithms.json")},{"./browser/algorithms.json":43}],43:[function(e,t){t.exports={sha224WithRSAEncryption:{sign:"rsa",hash:"sha224",id:"302d300d06096086480165030402040500041c"},"RSA-SHA224":{sign:"ecdsa/rsa",hash:"sha224",id:"302d300d06096086480165030402040500041c"},sha256WithRSAEncryption:{sign:"rsa",hash:"sha256",id:"3031300d060960864801650304020105000420"},"RSA-SHA256":{sign:"ecdsa/rsa",hash:"sha256",id:"3031300d060960864801650304020105000420"},sha384WithRSAEncryption:{sign:"rsa",hash:"sha384",id:"3041300d060960864801650304020205000430"},"RSA-SHA384":{sign:"ecdsa/rsa",hash:"sha384",id:"3041300d060960864801650304020205000430"},sha512WithRSAEncryption:{sign:"rsa",hash:"sha512",id:"3051300d060960864801650304020305000440"},"RSA-SHA512":{sign:"ecdsa/rsa",hash:"sha512",id:"3051300d060960864801650304020305000440"},"RSA-SHA1":{sign:"rsa",hash:"sha1",id:"3021300906052b0e03021a05000414"},"ecdsa-with-SHA1":{sign:"ecdsa",hash:"sha1",id:""},sha256:{sign:"ecdsa",hash:"sha256",id:""},sha224:{sign:"ecdsa",hash:"sha224",id:""},sha384:{sign:"ecdsa",hash:"sha384",id:""},sha512:{sign:"ecdsa",hash:"sha512",id:""},"DSA-SHA":{sign:"dsa",hash:"sha1",id:""},"DSA-SHA1":{sign:"dsa",hash:"sha1",id:""},DSA:{sign:"dsa",hash:"sha1",id:""},"DSA-WITH-SHA224":{sign:"dsa",hash:"sha224",id:""},"DSA-SHA224":{sign:"dsa",hash:"sha224",id:""},"DSA-WITH-SHA256":{sign:"dsa",hash:"sha256",id:""},"DSA-SHA256":{sign:"dsa",hash:"sha256",id:""},"DSA-WITH-SHA384":{sign:"dsa",hash:"sha384",id:""},"DSA-SHA384":{sign:"dsa",hash:"sha384",id:""},"DSA-WITH-SHA512":{sign:"dsa",hash:"sha512",id:""},"DSA-SHA512":{sign:"dsa",hash:"sha512",id:""},"DSA-RIPEMD160":{sign:"dsa",hash:"rmd160",id:""},ripemd160WithRSA:{sign:"rsa",hash:"rmd160",id:"3021300906052b2403020105000414"},"RSA-RIPEMD160":{sign:"rsa",hash:"rmd160",id:"3021300906052b2403020105000414"},md5WithRSAEncryption:{sign:"rsa",hash:"md5",id:"3020300c06082a864886f70d020505000410"},"RSA-MD5":{sign:"rsa",hash:"md5",id:"3020300c06082a864886f70d020505000410"}}},{}],44:[function(e,t){t.exports={"1.3.132.0.10":"secp256k1","1.3.132.0.33":"p224","1.2.840.10045.3.1.1":"p192","1.2.840.10045.3.1.7":"p256","1.3.132.0.34":"p384","1.3.132.0.35":"p521"}},{}],45:[function(e,t){var o=e("safe-buffer").Buffer,i=e("create-hash"),a=e("readable-stream"),n=e("inherits"),r=e("./sign"),s=e("./verify"),c=e("./algorithms.json");function l(e){a.Writable.call(this);var t=c[e];if(!t)throw new Error("Unknown message digest");this._hashType=t.hash,this._hash=i(t.hash),this._tag=t.id,this._signType=t.sign}function d(e){a.Writable.call(this);var t=c[e];if(!t)throw new Error("Unknown message digest");this._hash=i(t.hash),this._tag=t.id,this._signType=t.sign}function u(e){return new l(e)}function h(e){return new d(e)}Object.keys(c).forEach(function(e){c[e].id=o.from(c[e].id,"hex"),c[e.toLowerCase()]=c[e]}),n(l,a.Writable),l.prototype._write=function(e,t,o){this._hash.update(e),o()},l.prototype.update=function(e,t){return"string"==typeof e&&(e=o.from(e,t)),this._hash.update(e),this},l.prototype.sign=function(e,t){this.end();var o=this._hash.digest(),i=r(o,e,this._hashType,this._signType,this._tag);return t?i.toString(t):i},n(d,a.Writable),d.prototype._write=function(e,t,o){this._hash.update(e),o()},d.prototype.update=function(e,t){return"string"==typeof e&&(e=o.from(e,t)),this._hash.update(e),this},d.prototype.verify=function(e,t,i){"string"==typeof t&&(t=o.from(t,i)),this.end();var a=this._hash.digest();return s(t,a,e,this._signType,this._tag)},t.exports={Sign:u,Verify:h,createSign:u,createVerify:h}},{"./algorithms.json":43,"./sign":46,"./verify":47,"create-hash":72,inherits:140,"readable-stream":62,"safe-buffer":63}],46:[function(e,t){var o=e("safe-buffer").Buffer,i=e("create-hmac"),a=e("browserify-rsa"),n=e("elliptic").ec,r=e("bn.js"),s=e("parse-asn1"),c=e("./curves.json");function l(e,t){var i=c[t.curve.join(".")];if(!i)throw new Error("unknown curve "+t.curve.join("."));var a=new n(i).keyFromPrivate(t.privateKey).sign(e);return o.from(a.toDER())}function d(e,t,o){for(var i,a=t.params.priv_key,n=t.params.p,s=t.params.q,c=t.params.g,l=new r(0),d=p(e,s).mod(s),f=!1,_=h(a,s,e,o);!1===f;)l=m(c,i=g(s,_,o),n,s),0===(f=i.invm(s).imul(d.add(a.mul(l))).mod(s)).cmpn(0)&&(f=!1,l=new r(0));return u(l,f)}function u(e,t){e=e.toArray(),t=t.toArray(),128&e[0]&&(e=[0].concat(e)),128&t[0]&&(t=[0].concat(t));var i=[48,e.length+t.length+4,2,e.length];return i=i.concat(e,[2,t.length],t),o.from(i)}function h(e,t,a,n){if((e=o.from(e.toArray())).length<t.byteLength()){var r=o.alloc(t.byteLength()-e.length);e=o.concat([r,e])}var s=a.length,c=f(a,t),l=o.alloc(s);l.fill(1);var d=o.alloc(s);return d=i(n,d).update(l).update(o.from([0])).update(e).update(c).digest(),l=i(n,d).update(l).digest(),{k:d=i(n,d).update(l).update(o.from([1])).update(e).update(c).digest(),v:l=i(n,d).update(l).digest()}}function p(e,t){var o=new r(e),i=(e.length<<3)-t.bitLength();return i>0&&o.ishrn(i),o}function f(e,t){e=(e=p(e,t)).mod(t);var i=o.from(e.toArray());if(i.length<t.byteLength()){var a=o.alloc(t.byteLength()-i.length);i=o.concat([a,i])}return i}function g(e,t,a){var n,r;do{for(n=o.alloc(0);8*n.length<e.bitLength();)t.v=i(a,t.k).update(t.v).digest(),n=o.concat([n,t.v]);r=p(n,e),t.k=i(a,t.k).update(t.v).update(o.from([0])).digest(),t.v=i(a,t.k).update(t.v).digest()}while(-1!==r.cmp(e));return r}function m(e,t,o,i){return e.toRed(r.mont(o)).redPow(t).fromRed().mod(i)}t.exports=function(e,t,i,n,r){var c=s(t);if(c.curve){if("ecdsa"!==n&&"ecdsa/rsa"!==n)throw new Error("wrong private key type");return l(e,c)}if("dsa"===c.type){if("dsa"!==n)throw new Error("wrong private key type");return d(e,c,i)}if("rsa"!==n&&"ecdsa/rsa"!==n)throw new Error("wrong private key type");e=o.concat([r,e]);for(var u=c.modulus.byteLength(),h=[0,1];e.length+h.length+1<u;)h.push(255);h.push(0);for(var p=-1;++p<e.length;)h.push(e[p]);return a(h,c)},t.exports.getKey=h,t.exports.makeKey=g},{"./curves.json":44,"bn.js":17,"browserify-rsa":40,"create-hmac":74,elliptic:88,"parse-asn1":151,"safe-buffer":63}],47:[function(e,t){var o=e("safe-buffer").Buffer,i=e("bn.js"),a=e("elliptic").ec,n=e("parse-asn1"),r=e("./curves.json");function s(e,t,o){var i=r[o.data.algorithm.curve.join(".")];if(!i)throw new Error("unknown curve "+o.data.algorithm.curve.join("."));var n=new a(i),s=o.data.subjectPrivateKey.data;return n.verify(t,e,s)}function c(e,t,o){var a=o.data.p,r=o.data.q,s=o.data.g,c=o.data.pub_key,d=n.signature.decode(e,"der"),u=d.s,h=d.r;l(u,r),l(h,r);var p=i.mont(a),f=u.invm(r);return 0===s.toRed(p).redPow(new i(t).mul(f).mod(r)).fromRed().mul(c.toRed(p).redPow(h.mul(f).mod(r)).fromRed()).mod(a).mod(r).cmp(h)}function l(e,t){if(e.cmpn(0)<=0)throw new Error("invalid sig");if(e.cmp(t)>=t)throw new Error("invalid sig")}t.exports=function(e,t,a,r,l){var d=n(a);if("ec"===d.type){if("ecdsa"!==r&&"ecdsa/rsa"!==r)throw new Error("wrong public key type");return s(e,t,d)}if("dsa"===d.type){if("dsa"!==r)throw new Error("wrong public key type");return c(e,t,d)}if("rsa"!==r&&"ecdsa/rsa"!==r)throw new Error("wrong public key type");t=o.concat([l,t]);for(var u=d.modulus.byteLength(),h=[1],p=0;t.length+h.length+2<u;)h.push(255),p++;h.push(0);for(var f=-1;++f<t.length;)h.push(t[f]);h=o.from(h);var g=i.mont(d.modulus);e=(e=new i(e).toRed(g)).redPow(new i(d.publicExponent)),e=o.from(e.fromRed().toArray());var m=p<8?1:0;for(u=Math.min(e.length,h.length),e.length!==h.length&&(m=1),f=-1;++f<u;)m|=e[f]^h[f];return 0===m}},{"./curves.json":44,"bn.js":17,elliptic:88,"parse-asn1":151,"safe-buffer":63}],48:[function(e,t){"use strict";var o={};function i(e,t,i){function a(e,o,i){return"string"==typeof t?t:t(e,o,i)}i||(i=Error);var n=function(e){var t,o;function i(t,o,i){return e.call(this,a(t,o,i))||this}return o=e,(t=i).prototype=Object.create(o.prototype),t.prototype.constructor=t,t.__proto__=o,i}(i);n.prototype.name=i.name,n.prototype.code=e,o[e]=n}function a(e,t){if(Array.isArray(e)){var o=e.length;return e=e.map(function(e){return String(e)}),o>2?"one of ".concat(t," ").concat(e.slice(0,o-1).join(", "),", or ")+e[o-1]:2===o?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])}return"of ".concat(t," ").concat(String(e))}function n(e,t,o){return(void 0===o||o>e.length)&&(o=e.length),e.substring(o-t.length,o)===t}function r(e,t,o){return"number"!=typeof o&&(o=0),!(o+t.length>e.length)&&-1!==e.indexOf(t,o)}i("ERR_INVALID_OPT_VALUE",function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'},TypeError),i("ERR_INVALID_ARG_TYPE",function(e,t,o){var i,s;if("string"==typeof t&&("not ","not "===t.substr(0,"not ".length))?(i="must not be",t=t.replace(/^not /,"")):i="must be",n(e," argument"))s="The ".concat(e," ").concat(i," ").concat(a(t,"type"));else{var c=r(e,".")?"property":"argument";s='The "'.concat(e,'" ').concat(c," ").concat(i," ").concat(a(t,"type"))}return s+". Received type ".concat(typeof o)},TypeError),i("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),i("ERR_METHOD_NOT_IMPLEMENTED",function(e){return"The "+e+" method is not implemented"}),i("ERR_STREAM_PREMATURE_CLOSE","Premature close"),i("ERR_STREAM_DESTROYED",function(e){return"Cannot call "+e+" after a stream was destroyed"}),i("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),i("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),i("ERR_STREAM_WRITE_AFTER_END","write after end"),i("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),i("ERR_UNKNOWN_ENCODING",function(e){return"Unknown encoding: "+e},TypeError),i("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),t.exports.codes=o},{}],49:[function(e,t){(function(o){"use strict";var i=Object.keys||function(e){var t=[];for(var o in e)t.push(o);return t};t.exports=l;var a=e("./_stream_readable"),n=e("./_stream_writable");e("inherits")(l,a);for(var r=i(n.prototype),s=0;s<r.length;s++){var c=r[s];l.prototype[c]||(l.prototype[c]=n.prototype[c])}function l(e){if(!(this instanceof l))return new l(e);a.call(this,e),n.call(this,e),this.allowHalfOpen=!0,e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",d)))}function d(){this._writableState.ended||o.nextTick(u,this)}function u(e){e.end()}Object.defineProperty(l.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(l.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(l.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(l.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}})}).call(this,e("_process"))},{"./_stream_readable":51,"./_stream_writable":53,_process:159,inherits:140}],50:[function(e,t){"use strict";t.exports=i;var o=e("./_stream_transform");function i(e){if(!(this instanceof i))return new i(e);o.call(this,e)}e("inherits")(i,o),i.prototype._transform=function(e,t,o){o(null,e)}},{"./_stream_transform":52,inherits:140}],51:[function(e,t){(function(o,i){"use strict";var a;t.exports=E,E.ReadableState=w,e("events").EventEmitter;var n=function(e,t){return e.listeners(t).length},r=e("./internal/streams/stream"),s=e("buffer").Buffer,c=i.Uint8Array||function(){};function l(e){return s.from(e)}var d,u=e("util");d=u&&u.debuglog?u.debuglog("stream"):function(){};var h,p,f,g=e("./internal/streams/buffer_list"),m=e("./internal/streams/destroy"),_=e("./internal/streams/state").getHighWaterMark,y=e("../errors").codes,v=y.ERR_INVALID_ARG_TYPE,C=y.ERR_STREAM_PUSH_AFTER_EOF,S=y.ERR_METHOD_NOT_IMPLEMENTED,T=y.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;e("inherits")(E,r);var I=m.errorOrDestroy,N=["error","close","destroy","pause","resume"];function b(e,t,o){if("function"==typeof e.prependListener)return e.prependListener(t,o);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(o):e._events[t]=[o,e._events[t]]:e.on(t,o)}function w(t,o,i){a=a||e("./_stream_duplex"),t=t||{},"boolean"!=typeof i&&(i=o instanceof a),this.objectMode=!!t.objectMode,i&&(this.objectMode=this.objectMode||!!t.readableObjectMode),this.highWaterMark=_(this,t,"readableHighWaterMark",i),this.buffer=new g,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==t.emitClose,this.autoDestroy=!!t.autoDestroy,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(h||(h=e("string_decoder/").StringDecoder),this.decoder=new h(t.encoding),this.encoding=t.encoding)}function E(t){if(a=a||e("./_stream_duplex"),!(this instanceof E))return new E(t);var o=this instanceof a;this._readableState=new w(t,this,o),this.readable=!0,t&&("function"==typeof t.read&&(this._read=t.read),"function"==typeof t.destroy&&(this._destroy=t.destroy)),r.call(this)}function P(e,t,o,i,a){d("readableAddChunk",t);var n,r=e._readableState;if(null===t)r.reading=!1,B(e,r);else if(a||(n=L(r,t)),n)I(e,n);else if(r.objectMode||t&&t.length>0)if("string"==typeof t||r.objectMode||Object.getPrototypeOf(t)===s.prototype||(t=l(t)),i)r.endEmitted?I(e,new T):R(e,r,t,!0);else if(r.ended)I(e,new C);else{if(r.destroyed)return!1;r.reading=!1,r.decoder&&!o?(t=r.decoder.write(t),r.objectMode||0!==t.length?R(e,r,t,!1):O(e,r)):R(e,r,t,!1)}else i||(r.reading=!1,O(e,r));return!r.ended&&(r.length<r.highWaterMark||0===r.length)}function R(e,t,o,i){t.flowing&&0===t.length&&!t.sync?(t.awaitDrain=0,e.emit("data",o)):(t.length+=t.objectMode?1:o.length,i?t.buffer.unshift(o):t.buffer.push(o),t.needReadable&&k(e)),O(e,t)}function L(e,t){var o,i;return i=t,s.isBuffer(i)||i instanceof c||"string"==typeof t||void 0===t||e.objectMode||(o=new v("chunk",["string","Buffer","Uint8Array"],t)),o}Object.defineProperty(E.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),E.prototype.destroy=m.destroy,E.prototype._undestroy=m.undestroy,E.prototype._destroy=function(e,t){t(e)},E.prototype.push=function(e,t){var o,i=this._readableState;return i.objectMode?o=!0:"string"==typeof e&&((t=t||i.defaultEncoding)!==i.encoding&&(e=s.from(e,t),t=""),o=!0),P(this,e,t,!1,o)},E.prototype.unshift=function(e){return P(this,e,null,!0,!1)},E.prototype.isPaused=function(){return!1===this._readableState.flowing},E.prototype.setEncoding=function(t){h||(h=e("string_decoder/").StringDecoder);var o=new h(t);this._readableState.decoder=o,this._readableState.encoding=this._readableState.decoder.encoding;for(var i=this._readableState.buffer.head,a="";null!==i;)a+=o.write(i.data),i=i.next;return this._readableState.buffer.clear(),""!==a&&this._readableState.buffer.push(a),this._readableState.length=a.length,this};var A=1073741824;function D(e){return e>=A?e=A:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}function M(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=D(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function B(e,t){if(d("onEofChunk"),!t.ended){if(t.decoder){var o=t.decoder.end();o&&o.length&&(t.buffer.push(o),t.length+=t.objectMode?1:o.length)}t.ended=!0,t.sync?k(e):(t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,G(e)))}}function k(e){var t=e._readableState;d("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(d("emitReadable",t.flowing),t.emittedReadable=!0,o.nextTick(G,e))}function G(e){var t=e._readableState;d("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,j(e)}function O(e,t){t.readingMore||(t.readingMore=!0,o.nextTick(H,e,t))}function H(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){var o=t.length;if(d("maybeReadMore read 0"),e.read(0),o===t.length)break}t.readingMore=!1}function V(e){return function(){var t=e._readableState;d("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&n(e,"data")&&(t.flowing=!0,j(e))}}function F(e){var t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!t.paused?t.flowing=!0:e.listenerCount("data")>0&&e.resume()}function U(e){d("readable nexttick read 0"),e.read(0)}function x(e,t){t.resumeScheduled||(t.resumeScheduled=!0,o.nextTick(Y,e,t))}function Y(e,t){d("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),j(e),t.flowing&&!t.reading&&e.read(0)}function j(e){var t=e._readableState;for(d("flow",t.flowing);t.flowing&&null!==e.read(););}function W(e,t){return 0===t.length?null:(t.objectMode?o=t.buffer.shift():!e||e>=t.length?(o=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):o=t.buffer.consume(e,t.decoder),o);var o}function z(e){var t=e._readableState;d("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,o.nextTick(K,t,e))}function K(e,t){if(d("endReadableNT",e.endEmitted,e.length),!e.endEmitted&&0===e.length&&(e.endEmitted=!0,t.readable=!1,t.emit("end"),e.autoDestroy)){var o=t._writableState;(!o||o.autoDestroy&&o.finished)&&t.destroy()}}function q(e,t){for(var o=0,i=e.length;o<i;o++)if(e[o]===t)return o;return-1}E.prototype.read=function(e){d("read",e),e=parseInt(e,10);var t=this._readableState,o=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return d("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?z(this):k(this),null;if(0===(e=M(e,t))&&t.ended)return 0===t.length&&z(this),null;var i,a=t.needReadable;return d("need readable",a),(0===t.length||t.length-e<t.highWaterMark)&&d("length less than watermark",a=!0),t.ended||t.reading?d("reading or ended",a=!1):a&&(d("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=M(o,t))),null===(i=e>0?W(e,t):null)?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.awaitDrain=0),0===t.length&&(t.ended||(t.needReadable=!0),o!==e&&t.ended&&z(this)),null!==i&&this.emit("data",i),i},E.prototype._read=function(){I(this,new S("_read()"))},E.prototype.pipe=function(e,t){var i=this,a=this._readableState;switch(a.pipesCount){case 0:a.pipes=e;break;case 1:a.pipes=[a.pipes,e];break;default:a.pipes.push(e)}a.pipesCount+=1,d("pipe count=%d opts=%j",a.pipesCount,t);var r=t&&!1===t.end||e===o.stdout||e===o.stderr?m:c;function s(t,o){d("onunpipe"),t===i&&o&&!1===o.hasUnpiped&&(o.hasUnpiped=!0,d("cleanup"),e.removeListener("close",f),e.removeListener("finish",g),e.removeListener("drain",l),e.removeListener("error",p),e.removeListener("unpipe",s),i.removeListener("end",c),i.removeListener("end",m),i.removeListener("data",h),u=!0,!a.awaitDrain||e._writableState&&!e._writableState.needDrain||l())}function c(){d("onend"),e.end()}a.endEmitted?o.nextTick(r):i.once("end",r),e.on("unpipe",s);var l=V(i);e.on("drain",l);var u=!1;function h(t){d("ondata");var o=e.write(t);d("dest.write",o),!1===o&&((1===a.pipesCount&&a.pipes===e||a.pipesCount>1&&-1!==q(a.pipes,e))&&!u&&(d("false write response, pause",a.awaitDrain),a.awaitDrain++),i.pause())}function p(t){d("onerror",t),m(),e.removeListener("error",p),0===n(e,"error")&&I(e,t)}function f(){e.removeListener("finish",g),m()}function g(){d("onfinish"),e.removeListener("close",f),m()}function m(){d("unpipe"),i.unpipe(e)}return i.on("data",h),b(e,"error",p),e.once("close",f),e.once("finish",g),e.emit("pipe",i),a.flowing||(d("pipe resume"),i.resume()),e},E.prototype.unpipe=function(e){var t=this._readableState,o={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,o),this);if(!e){var i=t.pipes,a=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var n=0;n<a;n++)i[n].emit("unpipe",this,{hasUnpiped:!1});return this}var r=q(t.pipes,e);return-1===r?this:(t.pipes.splice(r,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,o),this)},E.prototype.on=function(e,t){var i=r.prototype.on.call(this,e,t),a=this._readableState;return"data"===e?(a.readableListening=this.listenerCount("readable")>0,!1!==a.flowing&&this.resume()):"readable"===e&&(a.endEmitted||a.readableListening||(a.readableListening=a.needReadable=!0,a.flowing=!1,a.emittedReadable=!1,d("on readable",a.length,a.reading),a.length?k(this):a.reading||o.nextTick(U,this))),i},E.prototype.addListener=E.prototype.on,E.prototype.removeListener=function(e,t){var i=r.prototype.removeListener.call(this,e,t);return"readable"===e&&o.nextTick(F,this),i},E.prototype.removeAllListeners=function(e){var t=r.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&void 0!==e||o.nextTick(F,this),t},E.prototype.resume=function(){var e=this._readableState;return e.flowing||(d("resume"),e.flowing=!e.readableListening,x(this,e)),e.paused=!1,this},E.prototype.pause=function(){return d("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(d("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},E.prototype.wrap=function(e){var t=this,o=this._readableState,i=!1;for(var a in e.on("end",function(){if(d("wrapped end"),o.decoder&&!o.ended){var e=o.decoder.end();e&&e.length&&t.push(e)}t.push(null)}),e.on("data",function(a){d("wrapped data"),o.decoder&&(a=o.decoder.write(a)),o.objectMode&&null==a||(o.objectMode||a&&a.length)&&(t.push(a)||(i=!0,e.pause()))}),e)void 0===this[a]&&"function"==typeof e[a]&&(this[a]=function(t){return function(){return e[t].apply(e,arguments)}}(a));for(var n=0;n<N.length;n++)e.on(N[n],this.emit.bind(this,N[n]));return this._read=function(t){d("wrapped _read",t),i&&(i=!1,e.resume())},this},"function"==typeof Symbol&&(E.prototype[Symbol.asyncIterator]=function(){return void 0===p&&(p=e("./internal/streams/async_iterator")),p(this)}),Object.defineProperty(E.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(E.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(E.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),E._fromList=W,Object.defineProperty(E.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(E.from=function(t,o){return void 0===f&&(f=e("./internal/streams/from")),f(E,t,o)})}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../errors":48,"./_stream_duplex":49,"./internal/streams/async_iterator":54,"./internal/streams/buffer_list":55,"./internal/streams/destroy":56,"./internal/streams/from":58,"./internal/streams/state":60,"./internal/streams/stream":61,_process:159,buffer:66,events:105,inherits:140,"string_decoder/":64,util:19}],52:[function(e,t){"use strict";t.exports=l;var o=e("../errors").codes,i=o.ERR_METHOD_NOT_IMPLEMENTED,a=o.ERR_MULTIPLE_CALLBACK,n=o.ERR_TRANSFORM_ALREADY_TRANSFORMING,r=o.ERR_TRANSFORM_WITH_LENGTH_0,s=e("./_stream_duplex");function c(e,t){var o=this._transformState;o.transforming=!1;var i=o.writecb;if(null===i)return this.emit("error",new a);o.writechunk=null,o.writecb=null,null!=t&&this.push(t),i(e);var n=this._readableState;n.reading=!1,(n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}function l(e){if(!(this instanceof l))return new l(e);s.call(this,e),this._transformState={afterTransform:c.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",d)}function d(){var e=this;"function"!=typeof this._flush||this._readableState.destroyed?u(this,null,null):this._flush(function(t,o){u(e,t,o)})}function u(e,t,o){if(t)return e.emit("error",t);if(null!=o&&e.push(o),e._writableState.length)throw new r;if(e._transformState.transforming)throw new n;return e.push(null)}e("inherits")(l,s),l.prototype.push=function(e,t){return this._transformState.needTransform=!1,s.prototype.push.call(this,e,t)},l.prototype._transform=function(e,t,o){o(new i("_transform()"))},l.prototype._write=function(e,t,o){var i=this._transformState;if(i.writecb=o,i.writechunk=e,i.writeencoding=t,!i.transforming){var a=this._readableState;(i.needTransform||a.needReadable||a.length<a.highWaterMark)&&this._read(a.highWaterMark)}},l.prototype._read=function(){var e=this._transformState;null===e.writechunk||e.transforming?e.needTransform=!0:(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform))},l.prototype._destroy=function(e,t){s.prototype._destroy.call(this,e,function(e){t(e)})}},{"../errors":48,"./_stream_duplex":49,inherits:140}],53:[function(e,t){(function(o,i){"use strict";function a(e){var t=this;this.next=null,this.entry=null,this.finish=function(){Y(t,e)}}var n;t.exports=w,w.WritableState=b;var r={deprecate:e("util-deprecate")},s=e("./internal/streams/stream"),c=e("buffer").Buffer,l=i.Uint8Array||function(){};function d(e){return c.from(e)}var u,h=e("./internal/streams/destroy"),p=e("./internal/streams/state").getHighWaterMark,f=e("../errors").codes,g=f.ERR_INVALID_ARG_TYPE,m=f.ERR_METHOD_NOT_IMPLEMENTED,_=f.ERR_MULTIPLE_CALLBACK,y=f.ERR_STREAM_CANNOT_PIPE,v=f.ERR_STREAM_DESTROYED,C=f.ERR_STREAM_NULL_VALUES,S=f.ERR_STREAM_WRITE_AFTER_END,T=f.ERR_UNKNOWN_ENCODING,I=h.errorOrDestroy;function N(){}function b(t,o,i){n=n||e("./_stream_duplex"),t=t||{},"boolean"!=typeof i&&(i=o instanceof n),this.objectMode=!!t.objectMode,i&&(this.objectMode=this.objectMode||!!t.writableObjectMode),this.highWaterMark=p(this,t,"writableHighWaterMark",i),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var r=!1===t.decodeStrings;this.decodeStrings=!r,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){B(o,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==t.emitClose,this.autoDestroy=!!t.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new a(this)}function w(t){var o=this instanceof(n=n||e("./_stream_duplex"));if(!o&&!u.call(w,this))return new w(t);this._writableState=new b(t,this,o),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev),"function"==typeof t.destroy&&(this._destroy=t.destroy),"function"==typeof t.final&&(this._final=t.final)),s.call(this)}function E(e,t){var i=new S;I(e,i),o.nextTick(t,i)}function P(e,t,i,a){var n;return null===i?n=new C:"string"==typeof i||t.objectMode||(n=new g("chunk",["string","Buffer"],i)),!n||(I(e,n),o.nextTick(a,n),!1)}function R(e,t,o){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=c.from(t,o)),t}function L(e,t,o,i,a,n){if(!o){var r=R(t,i,a);i!==r&&(o=!0,a="buffer",i=r)}var s=t.objectMode?1:i.length;t.length+=s;var c=t.length<t.highWaterMark;if(c||(t.needDrain=!0),t.writing||t.corked){var l=t.lastBufferedRequest;t.lastBufferedRequest={chunk:i,encoding:a,isBuf:o,callback:n,next:null},l?l.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else A(e,t,!1,s,i,a,n);return c}function A(e,t,o,i,a,n,r){t.writelen=i,t.writecb=r,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new v("write")):o?e._writev(a,t.onwrite):e._write(a,n,t.onwrite),t.sync=!1}function D(e,t,i,a,n){--t.pendingcb,i?(o.nextTick(n,a),o.nextTick(U,e,t),e._writableState.errorEmitted=!0,I(e,a)):(n(a),e._writableState.errorEmitted=!0,I(e,a),U(e,t))}function M(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}function B(e,t){var i=e._writableState,a=i.sync,n=i.writecb;if("function"!=typeof n)throw new _;if(M(i),t)D(e,i,a,t,n);else{var r=H(i)||e.destroyed;r||i.corked||i.bufferProcessing||!i.bufferedRequest||O(e,i),a?o.nextTick(k,e,i,r,n):k(e,i,r,n)}}function k(e,t,o,i){o||G(e,t),t.pendingcb--,i(),U(e,t)}function G(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}function O(e,t){t.bufferProcessing=!0;var o=t.bufferedRequest;if(e._writev&&o&&o.next){var i=t.bufferedRequestCount,n=new Array(i),r=t.corkedRequestsFree;r.entry=o;for(var s=0,c=!0;o;)n[s]=o,o.isBuf||(c=!1),o=o.next,s+=1;n.allBuffers=c,A(e,t,!0,t.length,n,"",r.finish),t.pendingcb++,t.lastBufferedRequest=null,r.next?(t.corkedRequestsFree=r.next,r.next=null):t.corkedRequestsFree=new a(t),t.bufferedRequestCount=0}else{for(;o;){var l=o.chunk,d=o.encoding,u=o.callback;if(A(e,t,!1,t.objectMode?1:l.length,l,d,u),o=o.next,t.bufferedRequestCount--,t.writing)break}null===o&&(t.lastBufferedRequest=null)}t.bufferedRequest=o,t.bufferProcessing=!1}function H(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function V(e,t){e._final(function(o){t.pendingcb--,o&&I(e,o),t.prefinished=!0,e.emit("prefinish"),U(e,t)})}function F(e,t){t.prefinished||t.finalCalled||("function"!=typeof e._final||t.destroyed?(t.prefinished=!0,e.emit("prefinish")):(t.pendingcb++,t.finalCalled=!0,o.nextTick(V,e,t)))}function U(e,t){var o=H(t);if(o&&(F(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"),t.autoDestroy))){var i=e._readableState;(!i||i.autoDestroy&&i.endEmitted)&&e.destroy()}return o}function x(e,t,i){t.ending=!0,U(e,t),i&&(t.finished?o.nextTick(i):e.once("finish",i)),t.ended=!0,e.writable=!1}function Y(e,t,o){var i=e.entry;for(e.entry=null;i;){var a=i.callback;t.pendingcb--,a(o),i=i.next}t.corkedRequestsFree.next=e}e("inherits")(w,s),b.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(b.prototype,"buffer",{get:r.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(u=Function.prototype[Symbol.hasInstance],Object.defineProperty(w,Symbol.hasInstance,{value:function(e){return!!u.call(this,e)||this===w&&e&&e._writableState instanceof b}})):u=function(e){return e instanceof this},w.prototype.pipe=function(){I(this,new y)},w.prototype.write=function(e,t,o){var i,a=this._writableState,n=!1,r=!a.objectMode&&(i=e,c.isBuffer(i)||i instanceof l);return r&&!c.isBuffer(e)&&(e=d(e)),"function"==typeof t&&(o=t,t=null),r?t="buffer":t||(t=a.defaultEncoding),"function"!=typeof o&&(o=N),a.ending?E(this,o):(r||P(this,a,e,o))&&(a.pendingcb++,n=L(this,a,r,e,t,o)),n},w.prototype.cork=function(){this._writableState.corked++},w.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||O(this,e))},w.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new T(e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(w.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(w.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),w.prototype._write=function(e,t,o){o(new m("_write()"))},w.prototype._writev=null,w.prototype.end=function(e,t,o){var i=this._writableState;return"function"==typeof e?(o=e,e=null,t=null):"function"==typeof t&&(o=t,t=null),null!=e&&this.write(e,t),i.corked&&(i.corked=1,this.uncork()),i.ending||x(this,i,o),this},Object.defineProperty(w.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(w.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),w.prototype.destroy=h.destroy,w.prototype._undestroy=h.undestroy,w.prototype._destroy=function(e,t){t(e)}}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../errors":48,"./_stream_duplex":49,"./internal/streams/destroy":56,"./internal/streams/state":60,"./internal/streams/stream":61,_process:159,buffer:66,inherits:140,"util-deprecate":196}],54:[function(e,t){(function(o){"use strict";var i;function a(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var n=e("./end-of-stream"),r=Symbol("lastResolve"),s=Symbol("lastReject"),c=Symbol("error"),l=Symbol("ended"),d=Symbol("lastPromise"),u=Symbol("handlePromise"),h=Symbol("stream");function p(e,t){return{value:e,done:t}}function f(e){var t=e[r];if(null!==t){var o=e[h].read();null!==o&&(e[d]=null,e[r]=null,e[s]=null,t(p(o,!1)))}}function g(e){o.nextTick(f,e)}function m(e,t){return function(o,i){e.then(function(){t[l]?o(p(void 0,!0)):t[u](o,i)},i)}}var _=Object.getPrototypeOf(function(){}),y=Object.setPrototypeOf((a(i={get stream(){return this[h]},next:function(){var e=this,t=this[c];if(null!==t)return Promise.reject(t);if(this[l])return Promise.resolve(p(void 0,!0));if(this[h].destroyed)return new Promise(function(t,i){o.nextTick(function(){e[c]?i(e[c]):t(p(void 0,!0))})});var i,a=this[d];if(a)i=new Promise(m(a,this));else{var n=this[h].read();if(null!==n)return Promise.resolve(p(n,!1));i=new Promise(this[u])}return this[d]=i,i}},Symbol.asyncIterator,function(){return this}),a(i,"return",function(){var e=this;return new Promise(function(t,o){e[h].destroy(null,function(e){e?o(e):t(p(void 0,!0))})})}),i),_);t.exports=function(e){var t,o=Object.create(y,(a(t={},h,{value:e,writable:!0}),a(t,r,{value:null,writable:!0}),a(t,s,{value:null,writable:!0}),a(t,c,{value:null,writable:!0}),a(t,l,{value:e._readableState.endEmitted,writable:!0}),a(t,u,{value:function(e,t){var i=o[h].read();i?(o[d]=null,o[r]=null,o[s]=null,e(p(i,!1))):(o[r]=e,o[s]=t)},writable:!0}),t));return o[d]=null,n(e,function(e){if(e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code){var t=o[s];return null!==t&&(o[d]=null,o[r]=null,o[s]=null,t(e)),void(o[c]=e)}var i=o[r];null!==i&&(o[d]=null,o[r]=null,o[s]=null,i(p(void 0,!0))),o[l]=!0}),e.on("readable",g.bind(null,o)),o}}).call(this,e("_process"))},{"./end-of-stream":57,_process:159}],55:[function(e,t){"use strict";function o(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),o.push.apply(o,i)}return o}function i(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?o(Object(i),!0).forEach(function(t){a(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):o(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}function a(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var s=e("buffer").Buffer,c=e("util").inspect,l=c&&c.custom||"inspect";t.exports=function(){function e(){n(this,e),this.head=null,this.tail=null,this.length=0}var t,o;return t=e,(o=[{key:"push",value:function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}},{key:"unshift",value:function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}},{key:"shift",value:function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(e){if(0===this.length)return"";for(var t=this.head,o=""+t.data;t=t.next;)o+=e+t.data;return o}},{key:"concat",value:function(e){if(0===this.length)return s.alloc(0);for(var t,o,i,a=s.allocUnsafe(e>>>0),n=this.head,r=0;n;)t=n.data,o=a,i=r,s.prototype.copy.call(t,o,i),r+=n.data.length,n=n.next;return a}},{key:"consume",value:function(e,t){var o;return e<this.head.data.length?(o=this.head.data.slice(0,e),this.head.data=this.head.data.slice(e)):o=e===this.head.data.length?this.shift():t?this._getString(e):this._getBuffer(e),o}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(e){var t=this.head,o=1,i=t.data;for(e-=i.length;t=t.next;){var a=t.data,n=e>a.length?a.length:e;if(n===a.length?i+=a:i+=a.slice(0,e),0==(e-=n)){n===a.length?(++o,t.next?this.head=t.next:this.head=this.tail=null):(this.head=t,t.data=a.slice(n));break}++o}return this.length-=o,i}},{key:"_getBuffer",value:function(e){var t=s.allocUnsafe(e),o=this.head,i=1;for(o.data.copy(t),e-=o.data.length;o=o.next;){var a=o.data,n=e>a.length?a.length:e;if(a.copy(t,t.length-e,0,n),0==(e-=n)){n===a.length?(++i,o.next?this.head=o.next:this.head=this.tail=null):(this.head=o,o.data=a.slice(n));break}++i}return this.length-=i,t}},{key:l,value:function(e,t){return c(this,i({},t,{depth:0,customInspect:!1}))}}])&&r(t.prototype,o),e}()},{buffer:66,util:19}],56:[function(e,t){(function(e){"use strict";function o(e,t){a(e,t),i(e)}function i(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function a(e,t){e.emit("error",t)}t.exports={destroy:function(t,n){var r=this,s=this._readableState&&this._readableState.destroyed,c=this._writableState&&this._writableState.destroyed;return s||c?(n?n(t):t&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,e.nextTick(a,this,t)):e.nextTick(a,this,t)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,function(t){!n&&t?r._writableState?r._writableState.errorEmitted?e.nextTick(i,r):(r._writableState.errorEmitted=!0,e.nextTick(o,r,t)):e.nextTick(o,r,t):n?(e.nextTick(i,r),n(t)):e.nextTick(i,r)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,t){var o=e._readableState,i=e._writableState;o&&o.autoDestroy||i&&i.autoDestroy?e.destroy(t):e.emit("error",t)}}}).call(this,e("_process"))},{_process:159}],57:[function(e,t){"use strict";var o=e("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function i(e){var t=!1;return function(){if(!t){t=!0;for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];e.apply(this,i)}}}function a(){}function n(e){return e.setHeader&&"function"==typeof e.abort}t.exports=function e(t,r,s){if("function"==typeof r)return e(t,null,r);r||(r={}),s=i(s||a);var c=r.readable||!1!==r.readable&&t.readable,l=r.writable||!1!==r.writable&&t.writable,d=function(){t.writable||h()},u=t._writableState&&t._writableState.finished,h=function(){l=!1,u=!0,c||s.call(t)},p=t._readableState&&t._readableState.endEmitted,f=function(){c=!1,p=!0,l||s.call(t)},g=function(e){s.call(t,e)},m=function(){var e;return c&&!p?(t._readableState&&t._readableState.ended||(e=new o),s.call(t,e)):l&&!u?(t._writableState&&t._writableState.ended||(e=new o),s.call(t,e)):void 0},_=function(){t.req.on("finish",h)};return n(t)?(t.on("complete",h),t.on("abort",m),t.req?_():t.on("request",_)):l&&!t._writableState&&(t.on("end",d),t.on("close",d)),t.on("end",f),t.on("finish",h),!1!==r.error&&t.on("error",g),t.on("close",m),function(){t.removeListener("complete",h),t.removeListener("abort",m),t.removeListener("request",_),t.req&&t.req.removeListener("finish",h),t.removeListener("end",d),t.removeListener("close",d),t.removeListener("finish",h),t.removeListener("end",f),t.removeListener("error",g),t.removeListener("close",m)}}},{"../../../errors":48}],58:[function(e,t){t.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],59:[function(e,t){"use strict";var o;function i(e){var t=!1;return function(){t||(t=!0,e.apply(void 0,arguments))}}var a=e("../../../errors").codes,n=a.ERR_MISSING_ARGS,r=a.ERR_STREAM_DESTROYED;function s(e){if(e)throw e}function c(e){return e.setHeader&&"function"==typeof e.abort}function l(t,a,n,s){s=i(s);var l=!1;t.on("close",function(){l=!0}),void 0===o&&(o=e("./end-of-stream")),o(t,{readable:a,writable:n},function(e){if(e)return s(e);l=!0,s()});var d=!1;return function(e){if(!l&&!d)return d=!0,c(t)?t.abort():"function"==typeof t.destroy?t.destroy():void s(e||new r("pipe"))}}function d(e){e()}function u(e,t){return e.pipe(t)}function h(e){return e.length?"function"!=typeof e[e.length-1]?s:e.pop():s}t.exports=function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];var i,a=h(t);if(Array.isArray(t[0])&&(t=t[0]),t.length<2)throw new n("streams");var r=t.map(function(e,o){var n=o<t.length-1;return l(e,n,o>0,function(e){i||(i=e),e&&r.forEach(d),n||(r.forEach(d),a(i))})});return t.reduce(u)}},{"../../../errors":48,"./end-of-stream":57}],60:[function(e,t){"use strict";var o=e("../../../errors").codes.ERR_INVALID_OPT_VALUE;function i(e,t,o){return null!=e.highWaterMark?e.highWaterMark:t?e[o]:null}t.exports={getHighWaterMark:function(e,t,a,n){var r=i(t,n,a);if(null!=r){if(!isFinite(r)||Math.floor(r)!==r||r<0)throw new o(n?a:"highWaterMark",r);return Math.floor(r)}return e.objectMode?16:16384}}},{"../../../errors":48}],61:[function(e,t){t.exports=e("events").EventEmitter},{events:105}],62:[function(e,t,o){(o=t.exports=e("./lib/_stream_readable.js")).Stream=o,o.Readable=o,o.Writable=e("./lib/_stream_writable.js"),o.Duplex=e("./lib/_stream_duplex.js"),o.Transform=e("./lib/_stream_transform.js"),o.PassThrough=e("./lib/_stream_passthrough.js"),o.finished=e("./lib/internal/streams/end-of-stream.js"),o.pipeline=e("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":49,"./lib/_stream_passthrough.js":50,"./lib/_stream_readable.js":51,"./lib/_stream_transform.js":52,"./lib/_stream_writable.js":53,"./lib/internal/streams/end-of-stream.js":57,"./lib/internal/streams/pipeline.js":59}],63:[function(e,t,o){var i=e("buffer"),a=i.Buffer;function n(e,t){for(var o in e)t[o]=e[o]}function r(e,t,o){return a(e,t,o)}a.from&&a.alloc&&a.allocUnsafe&&a.allocUnsafeSlow?t.exports=i:(n(i,o),o.Buffer=r),r.prototype=Object.create(a.prototype),n(a,r),r.from=function(e,t,o){if("number"==typeof e)throw new TypeError("Argument must not be a number");return a(e,t,o)},r.alloc=function(e,t,o){if("number"!=typeof e)throw new TypeError("Argument must be a number");var i=a(e);return void 0!==t?"string"==typeof o?i.fill(t,o):i.fill(t):i.fill(0),i},r.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return a(e)},r.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i.SlowBuffer(e)}},{buffer:66}],64:[function(e,t,o){"use strict";var i=e("safe-buffer").Buffer,a=i.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function n(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}function r(e){var t=n(e);if("string"!=typeof t&&(i.isEncoding===a||!a(e)))throw new Error("Unknown encoding: "+e);return t||e}function s(e){var t;switch(this.encoding=r(e),this.encoding){case"utf16le":this.text=h,this.end=p,t=4;break;case"utf8":this.fillLast=u,t=4;break;case"base64":this.text=f,this.end=g,t=3;break;default:return this.write=m,void(this.end=_)}this.lastNeed=0,this.lastTotal=0,this.lastChar=i.allocUnsafe(t)}function c(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function l(e,t,o){var i=t.length-1;if(i<o)return 0;var a=c(t[i]);return a>=0?(a>0&&(e.lastNeed=a-1),a):--i<o||-2===a?0:(a=c(t[i]))>=0?(a>0&&(e.lastNeed=a-2),a):--i<o||-2===a?0:(a=c(t[i]))>=0?(a>0&&(2===a?a=0:e.lastNeed=a-3),a):0}function d(e,t){if(128!=(192&t[0]))return e.lastNeed=0,"\ufffd";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"\ufffd";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,"\ufffd"}}function u(e){var t=this.lastTotal-this.lastNeed,o=d(this,e);return void 0!==o?o:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function h(e,t){if((e.length-t)%2==0){var o=e.toString("utf16le",t);if(o){var i=o.charCodeAt(o.length-1);if(i>=55296&&i<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],o.slice(0,-1)}return o}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function p(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var o=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,o)}return t}function f(e,t){var o=(e.length-t)%3;return 0===o?e.toString("base64",t):(this.lastNeed=3-o,this.lastTotal=3,1===o?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-o))}function g(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function m(e){return e.toString(this.encoding)}function _(e){return e&&e.length?this.write(e):""}o.StringDecoder=s,s.prototype.write=function(e){if(0===e.length)return"";var t,o;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";o=this.lastNeed,this.lastNeed=0}else o=0;return o<e.length?t?t+this.text(e,o):this.text(e,o):t||""},s.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"\ufffd":t},s.prototype.text=function(e,t){var o=l(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=o;var i=e.length-(o-this.lastNeed);return e.copy(this.lastChar,0,i),e.toString("utf8",t,i)},s.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},{"safe-buffer":63}],65:[function(e,t){(function(e){t.exports=function(t,o){for(var i=Math.min(t.length,o.length),a=new e(i),n=0;n<i;++n)a[n]=t[n]^o[n];return a}}).call(this,e("buffer").Buffer)},{buffer:66}],66:[function(e,t,o){(function(t){"use strict";var i=e("base64-js"),a=e("ieee754"),n=e("isarray");function r(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(e,t){if(r()<t)throw new RangeError("Invalid typed array length");return c.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=c.prototype:(null===e&&(e=new c(t)),e.length=t),e}function c(e,t,o){if(!(c.TYPED_ARRAY_SUPPORT||this instanceof c))return new c(e,t,o);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return h(this,e)}return l(this,e,t,o)}function l(e,t,o,i){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?g(e,t,o,i):"string"==typeof t?p(e,t,o):m(e,t)}function d(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function u(e,t,o,i){return d(t),t<=0?s(e,t):void 0!==o?"string"==typeof i?s(e,t).fill(o,i):s(e,t).fill(o):s(e,t)}function h(e,t){if(d(t),e=s(e,t<0?0:0|_(t)),!c.TYPED_ARRAY_SUPPORT)for(var o=0;o<t;++o)e[o]=0;return e}function p(e,t,o){if("string"==typeof o&&""!==o||(o="utf8"),!c.isEncoding(o))throw new TypeError('"encoding" must be a valid string encoding');var i=0|y(t,o),a=(e=s(e,i)).write(t,o);return a!==i&&(e=e.slice(0,a)),e}function f(e,t){var o=t.length<0?0:0|_(t.length);e=s(e,o);for(var i=0;i<o;i+=1)e[i]=255&t[i];return e}function g(e,t,o,i){if(t.byteLength,o<0||t.byteLength<o)throw new RangeError("'offset' is out of bounds");if(t.byteLength<o+(i||0))throw new RangeError("'length' is out of bounds");return t=void 0===o&&void 0===i?new Uint8Array(t):void 0===i?new Uint8Array(t,o):new Uint8Array(t,o,i),c.TYPED_ARRAY_SUPPORT?(e=t).__proto__=c.prototype:e=f(e,t),e}function m(e,t){if(c.isBuffer(t)){var o=0|_(t.length);return 0===(e=s(e,o)).length?e:(t.copy(e,0,0,o),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(i=t.length)!=i?s(e,0):f(e,t);if("Buffer"===t.type&&n(t.data))return f(e,t.data)}var i;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function _(e){if(e>=r())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+r().toString(16)+" bytes");return 0|e}function y(e,t){if(c.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var o=e.length;if(0===o)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return o;case"utf8":case"utf-8":case void 0:return K(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*o;case"hex":return o>>>1;case"base64":return X(e).length;default:if(i)return K(e).length;t=(""+t).toLowerCase(),i=!0}}function v(e,t,o){var i=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===o||o>this.length)&&(o=this.length),o<=0)return"";if((o>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return k(this,t,o);case"utf8":case"utf-8":return L(this,t,o);case"ascii":return M(this,t,o);case"latin1":case"binary":return B(this,t,o);case"base64":return R(this,t,o);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return G(this,t,o);default:if(i)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),i=!0}}function C(e,t,o){var i=e[t];e[t]=e[o],e[o]=i}function S(e,t,o,i,a){if(0===e.length)return-1;if("string"==typeof o?(i=o,o=0):o>2147483647?o=2147483647:o<-2147483648&&(o=-2147483648),o=+o,isNaN(o)&&(o=a?0:e.length-1),o<0&&(o=e.length+o),o>=e.length){if(a)return-1;o=e.length-1}else if(o<0){if(!a)return-1;o=0}if("string"==typeof t&&(t=c.from(t,i)),c.isBuffer(t))return 0===t.length?-1:T(e,t,o,i,a);if("number"==typeof t)return t&=255,c.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?a?Uint8Array.prototype.indexOf.call(e,t,o):Uint8Array.prototype.lastIndexOf.call(e,t,o):T(e,[t],o,i,a);throw new TypeError("val must be string, number or Buffer")}function T(e,t,o,i,a){var n,r=1,s=e.length,c=t.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(e.length<2||t.length<2)return-1;r=2,s/=2,c/=2,o/=2}function l(e,t){return 1===r?e[t]:e.readUInt16BE(t*r)}if(a){var d=-1;for(n=o;n<s;n++)if(l(e,n)===l(t,-1===d?0:n-d)){if(-1===d&&(d=n),n-d+1===c)return d*r}else-1!==d&&(n-=n-d),d=-1}else for(o+c>s&&(o=s-c),n=o;n>=0;n--){for(var u=!0,h=0;h<c;h++)if(l(e,n+h)!==l(t,h)){u=!1;break}if(u)return n}return-1}function I(e,t,o,i){o=Number(o)||0;var a=e.length-o;i?(i=Number(i))>a&&(i=a):i=a;var n=t.length;if(n%2!=0)throw new TypeError("Invalid hex string");i>n/2&&(i=n/2);for(var r=0;r<i;++r){var s=parseInt(t.substr(2*r,2),16);if(isNaN(s))return r;e[o+r]=s}return r}function N(e,t,o,i){return J(K(t,e.length-o),e,o,i)}function b(e,t,o,i){return J(q(t),e,o,i)}function w(e,t,o,i){return b(e,t,o,i)}function E(e,t,o,i){return J(X(t),e,o,i)}function P(e,t,o,i){return J(Q(t,e.length-o),e,o,i)}function R(e,t,o){return 0===t&&o===e.length?i.fromByteArray(e):i.fromByteArray(e.slice(t,o))}function L(e,t,o){o=Math.min(e.length,o);for(var i=[],a=t;a<o;){var n,r,s,c,l=e[a],d=null,u=l>239?4:l>223?3:l>191?2:1;if(a+u<=o)switch(u){case 1:l<128&&(d=l);break;case 2:128==(192&(n=e[a+1]))&&(c=(31&l)<<6|63&n)>127&&(d=c);break;case 3:n=e[a+1],r=e[a+2],128==(192&n)&&128==(192&r)&&(c=(15&l)<<12|(63&n)<<6|63&r)>2047&&(c<55296||c>57343)&&(d=c);break;case 4:n=e[a+1],r=e[a+2],s=e[a+3],128==(192&n)&&128==(192&r)&&128==(192&s)&&(c=(15&l)<<18|(63&n)<<12|(63&r)<<6|63&s)>65535&&c<1114112&&(d=c)}null===d?(d=65533,u=1):d>65535&&(d-=65536,i.push(d>>>10&1023|55296),d=56320|1023&d),i.push(d),a+=u}return D(i)}o.Buffer=c,o.SlowBuffer=function(e){return+e!=e&&(e=0),c.alloc(+e)},o.INSPECT_MAX_BYTES=50,c.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(t){return!1}}(),o.kMaxLength=r(),c.poolSize=8192,c._augment=function(e){return e.__proto__=c.prototype,e},c.from=function(e,t,o){return l(null,e,t,o)},c.TYPED_ARRAY_SUPPORT&&(c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0})),c.alloc=function(e,t,o){return u(null,e,t,o)},c.allocUnsafe=function(e){return h(null,e)},c.allocUnsafeSlow=function(e){return h(null,e)},c.isBuffer=function(e){return!(null==e||!e._isBuffer)},c.compare=function(e,t){if(!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var o=e.length,i=t.length,a=0,n=Math.min(o,i);a<n;++a)if(e[a]!==t[a]){o=e[a],i=t[a];break}return o<i?-1:i<o?1:0},c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(e,t){if(!n(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return c.alloc(0);var o;if(void 0===t)for(t=0,o=0;o<e.length;++o)t+=e[o].length;var i=c.allocUnsafe(t),a=0;for(o=0;o<e.length;++o){var r=e[o];if(!c.isBuffer(r))throw new TypeError('"list" argument must be an Array of Buffers');r.copy(i,a),a+=r.length}return i},c.byteLength=y,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)C(this,t,t+1);return this},c.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)C(this,t,t+3),C(this,t+1,t+2);return this},c.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)C(this,t,t+7),C(this,t+1,t+6),C(this,t+2,t+5),C(this,t+3,t+4);return this},c.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?L(this,0,e):v.apply(this,arguments)},c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===c.compare(this,e)},c.prototype.inspect=function(){var e="",t=o.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,t).match(/.{2}/g).join(" "),this.length>t&&(e+=" ... ")),"<Buffer "+e+">"},c.prototype.compare=function(e,t,o,i,a){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===o&&(o=e?e.length:0),void 0===i&&(i=0),void 0===a&&(a=this.length),t<0||o>e.length||i<0||a>this.length)throw new RangeError("out of range index");if(i>=a&&t>=o)return 0;if(i>=a)return-1;if(t>=o)return 1;if(this===e)return 0;for(var n=(a>>>=0)-(i>>>=0),r=(o>>>=0)-(t>>>=0),s=Math.min(n,r),l=this.slice(i,a),d=e.slice(t,o),u=0;u<s;++u)if(l[u]!==d[u]){n=l[u],r=d[u];break}return n<r?-1:r<n?1:0},c.prototype.includes=function(e,t,o){return-1!==this.indexOf(e,t,o)},c.prototype.indexOf=function(e,t,o){return S(this,e,t,o,!0)},c.prototype.lastIndexOf=function(e,t,o){return S(this,e,t,o,!1)},c.prototype.write=function(e,t,o,i){if(void 0===t)i="utf8",o=this.length,t=0;else if(void 0===o&&"string"==typeof t)i=t,o=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(o)?(o|=0,void 0===i&&(i="utf8")):(i=o,o=void 0)}var a=this.length-t;if((void 0===o||o>a)&&(o=a),e.length>0&&(o<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var n=!1;;)switch(i){case"hex":return I(this,e,t,o);case"utf8":case"utf-8":return N(this,e,t,o);case"ascii":return b(this,e,t,o);case"latin1":case"binary":return w(this,e,t,o);case"base64":return E(this,e,t,o);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,e,t,o);default:if(n)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),n=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var A=4096;function D(e){var t=e.length;if(t<=A)return String.fromCharCode.apply(String,e);for(var o="",i=0;i<t;)o+=String.fromCharCode.apply(String,e.slice(i,i+=A));return o}function M(e,t,o){var i="";o=Math.min(e.length,o);for(var a=t;a<o;++a)i+=String.fromCharCode(127&e[a]);return i}function B(e,t,o){var i="";o=Math.min(e.length,o);for(var a=t;a<o;++a)i+=String.fromCharCode(e[a]);return i}function k(e,t,o){var i,a=e.length;(!t||t<0)&&(t=0),(!o||o<0||o>a)&&(o=a);for(var n="",r=t;r<o;++r)n+=(i=e[r])<16?"0"+i.toString(16):i.toString(16);return n}function G(e,t,o){for(var i=e.slice(t,o),a="",n=0;n<i.length;n+=2)a+=String.fromCharCode(i[n]+256*i[n+1]);return a}function O(e,t,o){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>o)throw new RangeError("Trying to access beyond buffer length")}function H(e,t,o,i,a,n){if(!c.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>a||t<n)throw new RangeError('"value" argument is out of bounds');if(o+i>e.length)throw new RangeError("Index out of range")}function V(e,t,o,i){t<0&&(t=65535+t+1);for(var a=0,n=Math.min(e.length-o,2);a<n;++a)e[o+a]=(t&255<<8*(i?a:1-a))>>>8*(i?a:1-a)}function F(e,t,o,i){t<0&&(t=4294967295+t+1);for(var a=0,n=Math.min(e.length-o,4);a<n;++a)e[o+a]=t>>>8*(i?a:3-a)&255}function U(e,t,o,i){if(o+i>e.length)throw new RangeError("Index out of range");if(o<0)throw new RangeError("Index out of range")}function x(e,t,o,i,n){return n||U(e,0,o,4),a.write(e,t,o,i,23,4),o+4}function Y(e,t,o,i,n){return n||U(e,0,o,8),a.write(e,t,o,i,52,8),o+8}c.prototype.slice=function(e,t){var o,i=this.length;if((e=~~e)<0?(e+=i)<0&&(e=0):e>i&&(e=i),(t=void 0===t?i:~~t)<0?(t+=i)<0&&(t=0):t>i&&(t=i),t<e&&(t=e),c.TYPED_ARRAY_SUPPORT)(o=this.subarray(e,t)).__proto__=c.prototype;else{var a=t-e;o=new c(a,void 0);for(var n=0;n<a;++n)o[n]=this[n+e]}return o},c.prototype.readUIntLE=function(e,t,o){e|=0,t|=0,o||O(e,t,this.length);for(var i=this[e],a=1,n=0;++n<t&&(a*=256);)i+=this[e+n]*a;return i},c.prototype.readUIntBE=function(e,t,o){e|=0,t|=0,o||O(e,t,this.length);for(var i=this[e+--t],a=1;t>0&&(a*=256);)i+=this[e+--t]*a;return i},c.prototype.readUInt8=function(e,t){return t||O(e,1,this.length),this[e]},c.prototype.readUInt16LE=function(e,t){return t||O(e,2,this.length),this[e]|this[e+1]<<8},c.prototype.readUInt16BE=function(e,t){return t||O(e,2,this.length),this[e]<<8|this[e+1]},c.prototype.readUInt32LE=function(e,t){return t||O(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},c.prototype.readUInt32BE=function(e,t){return t||O(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},c.prototype.readIntLE=function(e,t,o){e|=0,t|=0,o||O(e,t,this.length);for(var i=this[e],a=1,n=0;++n<t&&(a*=256);)i+=this[e+n]*a;return i>=(a*=128)&&(i-=Math.pow(2,8*t)),i},c.prototype.readIntBE=function(e,t,o){e|=0,t|=0,o||O(e,t,this.length);for(var i=t,a=1,n=this[e+--i];i>0&&(a*=256);)n+=this[e+--i]*a;return n>=(a*=128)&&(n-=Math.pow(2,8*t)),n},c.prototype.readInt8=function(e,t){return t||O(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},c.prototype.readInt16LE=function(e,t){t||O(e,2,this.length);var o=this[e]|this[e+1]<<8;return 32768&o?4294901760|o:o},c.prototype.readInt16BE=function(e,t){t||O(e,2,this.length);var o=this[e+1]|this[e]<<8;return 32768&o?4294901760|o:o},c.prototype.readInt32LE=function(e,t){return t||O(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return t||O(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readFloatLE=function(e,t){return t||O(e,4,this.length),a.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return t||O(e,4,this.length),a.read(this,e,!1,23,4)},c.prototype.readDoubleLE=function(e,t){return t||O(e,8,this.length),a.read(this,e,!0,52,8)},c.prototype.readDoubleBE=function(e,t){return t||O(e,8,this.length),a.read(this,e,!1,52,8)},c.prototype.writeUIntLE=function(e,t,o,i){e=+e,t|=0,o|=0,i||H(this,e,t,o,Math.pow(2,8*o)-1,0);var a=1,n=0;for(this[t]=255&e;++n<o&&(a*=256);)this[t+n]=e/a&255;return t+o},c.prototype.writeUIntBE=function(e,t,o,i){e=+e,t|=0,o|=0,i||H(this,e,t,o,Math.pow(2,8*o)-1,0);var a=o-1,n=1;for(this[t+a]=255&e;--a>=0&&(n*=256);)this[t+a]=e/n&255;return t+o},c.prototype.writeUInt8=function(e,t,o){return e=+e,t|=0,o||H(this,e,t,1,255,0),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},c.prototype.writeUInt16LE=function(e,t,o){return e=+e,t|=0,o||H(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):V(this,e,t,!0),t+2},c.prototype.writeUInt16BE=function(e,t,o){return e=+e,t|=0,o||H(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):V(this,e,t,!1),t+2},c.prototype.writeUInt32LE=function(e,t,o){return e=+e,t|=0,o||H(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):F(this,e,t,!0),t+4},c.prototype.writeUInt32BE=function(e,t,o){return e=+e,t|=0,o||H(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):F(this,e,t,!1),t+4},c.prototype.writeIntLE=function(e,t,o,i){if(e=+e,t|=0,!i){var a=Math.pow(2,8*o-1);H(this,e,t,o,a-1,-a)}var n=0,r=1,s=0;for(this[t]=255&e;++n<o&&(r*=256);)e<0&&0===s&&0!==this[t+n-1]&&(s=1),this[t+n]=(e/r>>0)-s&255;return t+o},c.prototype.writeIntBE=function(e,t,o,i){if(e=+e,t|=0,!i){var a=Math.pow(2,8*o-1);H(this,e,t,o,a-1,-a)}var n=o-1,r=1,s=0;for(this[t+n]=255&e;--n>=0&&(r*=256);)e<0&&0===s&&0!==this[t+n+1]&&(s=1),this[t+n]=(e/r>>0)-s&255;return t+o},c.prototype.writeInt8=function(e,t,o){return e=+e,t|=0,o||H(this,e,t,1,127,-128),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},c.prototype.writeInt16LE=function(e,t,o){return e=+e,t|=0,o||H(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):V(this,e,t,!0),t+2},c.prototype.writeInt16BE=function(e,t,o){return e=+e,t|=0,o||H(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):V(this,e,t,!1),t+2},c.prototype.writeInt32LE=function(e,t,o){return e=+e,t|=0,o||H(this,e,t,4,2147483647,-2147483648),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):F(this,e,t,!0),t+4},c.prototype.writeInt32BE=function(e,t,o){return e=+e,t|=0,o||H(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):F(this,e,t,!1),t+4},c.prototype.writeFloatLE=function(e,t,o){return x(this,e,t,!0,o)},c.prototype.writeFloatBE=function(e,t,o){return x(this,e,t,!1,o)},c.prototype.writeDoubleLE=function(e,t,o){return Y(this,e,t,!0,o)},c.prototype.writeDoubleBE=function(e,t,o){return Y(this,e,t,!1,o)},c.prototype.copy=function(e,t,o,i){if(o||(o=0),i||0===i||(i=this.length),t>=e.length&&(t=e.length),t||(t=0),i>0&&i<o&&(i=o),i===o)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(o<0||o>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-t<i-o&&(i=e.length-t+o);var a,n=i-o;if(this===e&&o<t&&t<i)for(a=n-1;a>=0;--a)e[a+t]=this[a+o];else if(n<1e3||!c.TYPED_ARRAY_SUPPORT)for(a=0;a<n;++a)e[a+t]=this[a+o];else Uint8Array.prototype.set.call(e,this.subarray(o,o+n),t);return n},c.prototype.fill=function(e,t,o,i){if("string"==typeof e){if("string"==typeof t?(i=t,t=0,o=this.length):"string"==typeof o&&(i=o,o=this.length),1===e.length){var a=e.charCodeAt(0);a<256&&(e=a)}if(void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!c.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<o)throw new RangeError("Out of range index");if(o<=t)return this;var n;if(t>>>=0,o=void 0===o?this.length:o>>>0,e||(e=0),"number"==typeof e)for(n=t;n<o;++n)this[n]=e;else{var r=c.isBuffer(e)?e:K(new c(e,i).toString()),s=r.length;for(n=0;n<o-t;++n)this[n+t]=r[n%s]}return this};var j=/[^+\/0-9A-Za-z-_]/g;function W(e){if((e=z(e).replace(j,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}function z(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function K(e,t){var o;t=t||1/0;for(var i=e.length,a=null,n=[],r=0;r<i;++r){if((o=e.charCodeAt(r))>55295&&o<57344){if(!a){if(o>56319){(t-=3)>-1&&n.push(239,191,189);continue}if(r+1===i){(t-=3)>-1&&n.push(239,191,189);continue}a=o;continue}if(o<56320){(t-=3)>-1&&n.push(239,191,189),a=o;continue}o=65536+(a-55296<<10|o-56320)}else a&&(t-=3)>-1&&n.push(239,191,189);if(a=null,o<128){if((t-=1)<0)break;n.push(o)}else if(o<2048){if((t-=2)<0)break;n.push(o>>6|192,63&o|128)}else if(o<65536){if((t-=3)<0)break;n.push(o>>12|224,o>>6&63|128,63&o|128)}else{if(!(o<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;n.push(o>>18|240,o>>12&63|128,o>>6&63|128,63&o|128)}}return n}function q(e){for(var t=[],o=0;o<e.length;++o)t.push(255&e.charCodeAt(o));return t}function Q(e,t){for(var o,i,a,n=[],r=0;r<e.length&&!((t-=2)<0);++r)i=(o=e.charCodeAt(r))>>8,a=o%256,n.push(a),n.push(i);return n}function X(e){return i.toByteArray(W(e))}function J(e,t,o,i){for(var a=0;a<i&&!(a+o>=t.length||a>=e.length);++a)t[a+o]=e[a];return a}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"base64-js":16,ieee754:138,isarray:67}],67:[function(e,t){var o={}.toString;t.exports=Array.isArray||function(e){return"[object Array]"==o.call(e)}},{}],68:[function(e,t){var o=e("safe-buffer").Buffer,i=e("stream").Transform,a=e("string_decoder").StringDecoder;function n(e){i.call(this),this.hashMode="string"==typeof e,this.hashMode?this[e]=this._finalOrDigest:this.final=this._finalOrDigest,this._final&&(this.__final=this._final,this._final=null),this._decoder=null,this._encoding=null}e("inherits")(n,i),n.prototype.update=function(e,t,i){"string"==typeof e&&(e=o.from(e,t));var a=this._update(e);return this.hashMode?this:(i&&(a=this._toString(a,i)),a)},n.prototype.setAutoPadding=function(){},n.prototype.getAuthTag=function(){throw new Error("trying to get auth tag in unsupported state")},n.prototype.setAuthTag=function(){throw new Error("trying to set auth tag in unsupported state")},n.prototype.setAAD=function(){throw new Error("trying to set aad in unsupported state")},n.prototype._transform=function(e,t,o){var i;try{this.hashMode?this._update(e):this.push(this._update(e))}catch(a){i=a}finally{o(i)}},n.prototype._flush=function(e){var t;try{this.push(this.__final())}catch(o){t=o}e(t)},n.prototype._finalOrDigest=function(e){var t=this.__final()||o.alloc(0);return e&&(t=this._toString(t,e,!0)),t},n.prototype._toString=function(e,t,o){if(this._decoder||(this._decoder=new a(t),this._encoding=t),this._encoding!==t)throw new Error("can't switch encodings");var i=this._decoder.write(e);return o&&(i+=this._decoder.end()),i},t.exports=n},{inherits:140,"safe-buffer":185,stream:194,string_decoder:195}],69:[function(e,t,o){(function(e){function t(e){return Object.prototype.toString.call(e)}o.isArray=function(e){return Array.isArray?Array.isArray(e):"[object Array]"===t(e)},o.isBoolean=function(e){return"boolean"==typeof e},o.isNull=function(e){return null===e},o.isNullOrUndefined=function(e){return null==e},o.isNumber=function(e){return"number"==typeof e},o.isString=function(e){return"string"==typeof e},o.isSymbol=function(e){return"symbol"==typeof e},o.isUndefined=function(e){return void 0===e},o.isRegExp=function(e){return"[object RegExp]"===t(e)},o.isObject=function(e){return"object"==typeof e&&null!==e},o.isDate=function(e){return"[object Date]"===t(e)},o.isError=function(e){return"[object Error]"===t(e)||e instanceof Error},o.isFunction=function(e){return"function"==typeof e},o.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},o.isBuffer=e.isBuffer}).call(this,{isBuffer:e("../../is-buffer/index.js")})},{"../../is-buffer/index.js":141}],70:[function(e,t){(function(o){var i=e("elliptic"),a=e("bn.js");t.exports=function(e){return new r(e)};var n={secp256k1:{name:"secp256k1",byteLength:32},secp224r1:{name:"p224",byteLength:28},prime256v1:{name:"p256",byteLength:32},prime192v1:{name:"p192",byteLength:24},ed25519:{name:"ed25519",byteLength:32},secp384r1:{name:"p384",byteLength:48},secp521r1:{name:"p521",byteLength:66}};function r(e){this.curveType=n[e],this.curveType||(this.curveType={name:e}),this.curve=new i.ec(this.curveType.name),this.keys=void 0}function s(e,t,i){Array.isArray(e)||(e=e.toArray());var a=new o(e);if(i&&a.length<i){var n=new o(i-a.length);n.fill(0),a=o.concat([n,a])}return t?a.toString(t):a}n.p224=n.secp224r1,n.p256=n.secp256r1=n.prime256v1,n.p192=n.secp192r1=n.prime192v1,n.p384=n.secp384r1,n.p521=n.secp521r1,r.prototype.generateKeys=function(e,t){return this.keys=this.curve.genKeyPair(),this.getPublicKey(e,t)},r.prototype.computeSecret=function(e,t,i){return t=t||"utf8",o.isBuffer(e)||(e=new o(e,t)),s(this.curve.keyFromPublic(e).getPublic().mul(this.keys.getPrivate()).getX(),i,this.curveType.byteLength)},r.prototype.getPublicKey=function(e,t){var o=this.keys.getPublic("compressed"===t,!0);return"hybrid"===t&&(o[o.length-1]%2?o[0]=7:o[0]=6),s(o,e)},r.prototype.getPrivateKey=function(e){return s(this.keys.getPrivate(),e)},r.prototype.setPublicKey=function(e,t){return t=t||"utf8",o.isBuffer(e)||(e=new o(e,t)),this.keys._importPublic(e),this},r.prototype.setPrivateKey=function(e,t){t=t||"utf8",o.isBuffer(e)||(e=new o(e,t));var i=new a(e);return i=i.toString(16),this.keys=this.curve.genKeyPair(),this.keys._importPrivate(i),this}}).call(this,e("buffer").Buffer)},{"bn.js":71,buffer:66,elliptic:88}],71:[function(e,t,o){arguments[4][15][0].apply(o,arguments)},{buffer:19,dup:15}],72:[function(e,t){"use strict";var o=e("inherits"),i=e("md5.js"),a=e("ripemd160"),n=e("sha.js"),r=e("cipher-base");function s(e){r.call(this,"digest"),this._hash=e}o(s,r),s.prototype._update=function(e){this._hash.update(e)},s.prototype._final=function(){return this._hash.digest()},t.exports=function(e){return"md5"===(e=e.toLowerCase())?new i:"rmd160"===e||"ripemd160"===e?new a:new s(n(e))}},{"cipher-base":68,inherits:140,"md5.js":142,ripemd160:184,"sha.js":187}],73:[function(e,t){var o=e("md5.js");t.exports=function(e){return(new o).update(e).digest()}},{"md5.js":142}],74:[function(e,t){"use strict";var o=e("inherits"),i=e("./legacy"),a=e("cipher-base"),n=e("safe-buffer").Buffer,r=e("create-hash/md5"),s=e("ripemd160"),c=e("sha.js"),l=n.alloc(128);function d(e,t){a.call(this,"digest"),"string"==typeof t&&(t=n.from(t));var o="sha512"===e||"sha384"===e?128:64;this._alg=e,this._key=t,t.length>o?t=("rmd160"===e?new s:c(e)).update(t).digest():t.length<o&&(t=n.concat([t,l],o));for(var i=this._ipad=n.allocUnsafe(o),r=this._opad=n.allocUnsafe(o),d=0;d<o;d++)i[d]=54^t[d],r[d]=92^t[d];this._hash="rmd160"===e?new s:c(e),this._hash.update(i)}o(d,a),d.prototype._update=function(e){this._hash.update(e)},d.prototype._final=function(){var e=this._hash.digest();return("rmd160"===this._alg?new s:c(this._alg)).update(this._opad).update(e).digest()},t.exports=function(e,t){return"rmd160"===(e=e.toLowerCase())||"ripemd160"===e?new d("rmd160",t):"md5"===e?new i(r,t):new d(e,t)}},{"./legacy":75,"cipher-base":68,"create-hash/md5":73,inherits:140,ripemd160:184,"safe-buffer":185,"sha.js":187}],75:[function(e,t){"use strict";var o=e("inherits"),i=e("safe-buffer").Buffer,a=e("cipher-base"),n=i.alloc(128),r=64;function s(e,t){a.call(this,"digest"),"string"==typeof t&&(t=i.from(t)),this._alg=e,this._key=t,t.length>r?t=e(t):t.length<r&&(t=i.concat([t,n],r));for(var o=this._ipad=i.allocUnsafe(r),s=this._opad=i.allocUnsafe(r),c=0;c<r;c++)o[c]=54^t[c],s[c]=92^t[c];this._hash=[o]}o(s,a),s.prototype._update=function(e){this._hash.push(e)},s.prototype._final=function(){var e=this._alg(i.concat(this._hash));return this._alg(i.concat([this._opad,e]))},t.exports=s},{"cipher-base":68,inherits:140,"safe-buffer":185}],76:[function(e,t,o){"use strict";o.randomBytes=o.rng=o.pseudoRandomBytes=o.prng=e("randombytes"),o.createHash=o.Hash=e("create-hash"),o.createHmac=o.Hmac=e("create-hmac");var i=e("browserify-sign/algos"),a=Object.keys(i),n=["sha1","sha224","sha256","sha384","sha512","md5","rmd160"].concat(a);o.getHashes=function(){return n};var r=e("pbkdf2");o.pbkdf2=r.pbkdf2,o.pbkdf2Sync=r.pbkdf2Sync;var s=e("browserify-cipher");o.Cipher=s.Cipher,o.createCipher=s.createCipher,o.Cipheriv=s.Cipheriv,o.createCipheriv=s.createCipheriv,o.Decipher=s.Decipher,o.createDecipher=s.createDecipher,o.Decipheriv=s.Decipheriv,o.createDecipheriv=s.createDecipheriv,o.getCiphers=s.getCiphers,o.listCiphers=s.listCiphers;var c=e("diffie-hellman");o.DiffieHellmanGroup=c.DiffieHellmanGroup,o.createDiffieHellmanGroup=c.createDiffieHellmanGroup,o.getDiffieHellman=c.getDiffieHellman,o.createDiffieHellman=c.createDiffieHellman,o.DiffieHellman=c.DiffieHellman;var l=e("browserify-sign");o.createSign=l.createSign,o.Sign=l.Sign,o.createVerify=l.createVerify,o.Verify=l.Verify,o.createECDH=e("create-ecdh");var d=e("public-encrypt");o.publicEncrypt=d.publicEncrypt,o.privateEncrypt=d.privateEncrypt,o.publicDecrypt=d.publicDecrypt,o.privateDecrypt=d.privateDecrypt;var u=e("randomfill");o.randomFill=u.randomFill,o.randomFillSync=u.randomFillSync,o.createCredentials=function(){throw new Error(["sorry, createCredentials is not implemented yet","we accept pull requests","https://github.com/crypto-browserify/crypto-browserify"].join("\n"))},o.constants={DH_CHECK_P_NOT_SAFE_PRIME:2,DH_CHECK_P_NOT_PRIME:1,DH_UNABLE_TO_CHECK_GENERATOR:4,DH_NOT_SUITABLE_GENERATOR:8,NPN_ENABLED:1,ALPN_ENABLED:1,RSA_PKCS1_PADDING:1,RSA_SSLV23_PADDING:2,RSA_NO_PADDING:3,RSA_PKCS1_OAEP_PADDING:4,RSA_X931_PADDING:5,RSA_PKCS1_PSS_PADDING:6,POINT_CONVERSION_COMPRESSED:2,POINT_CONVERSION_UNCOMPRESSED:4,POINT_CONVERSION_HYBRID:6}},{"browserify-cipher":37,"browserify-sign":45,"browserify-sign/algos":42,"create-ecdh":70,"create-hash":72,"create-hmac":74,"diffie-hellman":83,pbkdf2:152,"public-encrypt":160,randombytes:167,randomfill:168}],77:[function(e,t,o){"use strict";o.utils=e("./des/utils"),o.Cipher=e("./des/cipher"),o.DES=e("./des/des"),o.CBC=e("./des/cbc"),o.EDE=e("./des/ede")},{"./des/cbc":78,"./des/cipher":79,"./des/des":80,"./des/ede":81,"./des/utils":82}],78:[function(e,t,o){"use strict";var i=e("minimalistic-assert"),a=e("inherits"),n={};function r(e){i.equal(e.length,8,"Invalid IV length"),this.iv=new Array(8);for(var t=0;t<this.iv.length;t++)this.iv[t]=e[t]}o.instantiate=function(e){function t(t){e.call(this,t),this._cbcInit()}a(t,e);for(var o=Object.keys(n),i=0;i<o.length;i++){var r=o[i];t.prototype[r]=n[r]}return t.create=function(e){return new t(e)},t},n._cbcInit=function(){var e=new r(this.options.iv);this._cbcState=e},n._update=function(e,t,o,i){var a=this._cbcState,n=this.constructor.super_.prototype,r=a.iv;if("encrypt"===this.type){for(var s=0;s<this.blockSize;s++)r[s]^=e[t+s];for(n._update.call(this,r,0,o,i),s=0;s<this.blockSize;s++)r[s]=o[i+s]}else{for(n._update.call(this,e,t,o,i),s=0;s<this.blockSize;s++)o[i+s]^=r[s];for(s=0;s<this.blockSize;s++)r[s]=e[t+s]}}},{inherits:140,"minimalistic-assert":145}],79:[function(e,t){"use strict";var o=e("minimalistic-assert");function i(e){this.options=e,this.type=this.options.type,this.blockSize=8,this._init(),this.buffer=new Array(this.blockSize),this.bufferOff=0}t.exports=i,i.prototype._init=function(){},i.prototype.update=function(e){return 0===e.length?[]:"decrypt"===this.type?this._updateDecrypt(e):this._updateEncrypt(e)},i.prototype._buffer=function(e,t){for(var o=Math.min(this.buffer.length-this.bufferOff,e.length-t),i=0;i<o;i++)this.buffer[this.bufferOff+i]=e[t+i];return this.bufferOff+=o,o},i.prototype._flushBuffer=function(e,t){return this._update(this.buffer,0,e,t),this.bufferOff=0,this.blockSize},i.prototype._updateEncrypt=function(e){var t=0,o=0,i=(this.bufferOff+e.length)/this.blockSize|0,a=new Array(i*this.blockSize);0!==this.bufferOff&&(t+=this._buffer(e,t),this.bufferOff===this.buffer.length&&(o+=this._flushBuffer(a,o)));for(var n=e.length-(e.length-t)%this.blockSize;t<n;t+=this.blockSize)this._update(e,t,a,o),o+=this.blockSize;for(;t<e.length;t++,this.bufferOff++)this.buffer[this.bufferOff]=e[t];return a},i.prototype._updateDecrypt=function(e){for(var t=0,o=0,i=Math.ceil((this.bufferOff+e.length)/this.blockSize)-1,a=new Array(i*this.blockSize);i>0;i--)t+=this._buffer(e,t),o+=this._flushBuffer(a,o);return t+=this._buffer(e,t),a},i.prototype.final=function(e){var t,o;return e&&(t=this.update(e)),o="encrypt"===this.type?this._finalEncrypt():this._finalDecrypt(),t?t.concat(o):o},i.prototype._pad=function(e,t){if(0===t)return!1;for(;t<e.length;)e[t++]=0;return!0},i.prototype._finalEncrypt=function(){if(!this._pad(this.buffer,this.bufferOff))return[];var e=new Array(this.blockSize);return this._update(this.buffer,0,e,0),e},i.prototype._unpad=function(e){return e},i.prototype._finalDecrypt=function(){o.equal(this.bufferOff,this.blockSize,"Not enough data to decrypt");var e=new Array(this.blockSize);return this._flushBuffer(e,0),this._unpad(e)}},{"minimalistic-assert":145}],80:[function(e,t){"use strict";var o=e("minimalistic-assert"),i=e("inherits"),a=e("./utils"),n=e("./cipher");function r(){this.tmp=new Array(2),this.keys=null}function s(e){n.call(this,e);var t=new r;this._desState=t,this.deriveKeys(t,e.key)}i(s,n),t.exports=s,s.create=function(e){return new s(e)};var c=[1,1,2,2,2,2,2,2,1,2,2,2,2,2,2,1];s.prototype.deriveKeys=function(e,t){e.keys=new Array(32),o.equal(t.length,this.blockSize,"Invalid key length");var i=a.readUInt32BE(t,0),n=a.readUInt32BE(t,4);a.pc1(i,n,e.tmp,0),i=e.tmp[0],n=e.tmp[1];for(var r=0;r<e.keys.length;r+=2){var s=c[r>>>1];i=a.r28shl(i,s),n=a.r28shl(n,s),a.pc2(i,n,e.keys,r)}},s.prototype._update=function(e,t,o,i){var n=this._desState,r=a.readUInt32BE(e,t),s=a.readUInt32BE(e,t+4);a.ip(r,s,n.tmp,0),r=n.tmp[0],s=n.tmp[1],"encrypt"===this.type?this._encrypt(n,r,s,n.tmp,0):this._decrypt(n,r,s,n.tmp,0),r=n.tmp[0],s=n.tmp[1],a.writeUInt32BE(o,r,i),a.writeUInt32BE(o,s,i+4)},s.prototype._pad=function(e,t){for(var o=e.length-t,i=t;i<e.length;i++)e[i]=o;return!0},s.prototype._unpad=function(e){for(var t=e[e.length-1],i=e.length-t;i<e.length;i++)o.equal(e[i],t);return e.slice(0,e.length-t)},s.prototype._encrypt=function(e,t,o,i,n){for(var r=t,s=o,c=0;c<e.keys.length;c+=2){var l=e.keys[c],d=e.keys[c+1];a.expand(s,e.tmp,0),l^=e.tmp[0],d^=e.tmp[1];var u=a.substitute(l,d),h=s;s=(r^a.permute(u))>>>0,r=h}a.rip(s,r,i,n)},s.prototype._decrypt=function(e,t,o,i,n){for(var r=o,s=t,c=e.keys.length-2;c>=0;c-=2){var l=e.keys[c],d=e.keys[c+1];a.expand(r,e.tmp,0),l^=e.tmp[0],d^=e.tmp[1];var u=a.substitute(l,d),h=r;r=(s^a.permute(u))>>>0,s=h}a.rip(r,s,i,n)}},{"./cipher":79,"./utils":82,inherits:140,"minimalistic-assert":145}],81:[function(e,t){"use strict";var o=e("minimalistic-assert"),i=e("inherits"),a=e("./cipher"),n=e("./des");function r(e,t){o.equal(t.length,24,"Invalid key length");var i=t.slice(0,8),a=t.slice(8,16),r=t.slice(16,24);this.ciphers="encrypt"===e?[n.create({type:"encrypt",key:i}),n.create({type:"decrypt",key:a}),n.create({type:"encrypt",key:r})]:[n.create({type:"decrypt",key:r}),n.create({type:"encrypt",key:a}),n.create({type:"decrypt",key:i})]}function s(e){a.call(this,e);var t=new r(this.type,this.options.key);this._edeState=t}i(s,a),t.exports=s,s.create=function(e){return new s(e)},s.prototype._update=function(e,t,o,i){var a=this._edeState;a.ciphers[0]._update(e,t,o,i),a.ciphers[1]._update(o,i,o,i),a.ciphers[2]._update(o,i,o,i)},s.prototype._pad=n.prototype._pad,s.prototype._unpad=n.prototype._unpad},{"./cipher":79,"./des":80,inherits:140,"minimalistic-assert":145}],82:[function(e,t,o){"use strict";o.readUInt32BE=function(e,t){return(e[0+t]<<24|e[1+t]<<16|e[2+t]<<8|e[3+t])>>>0},o.writeUInt32BE=function(e,t,o){e[0+o]=t>>>24,e[1+o]=t>>>16&255,e[2+o]=t>>>8&255,e[3+o]=255&t},o.ip=function(e,t,o,i){for(var a=0,n=0,r=6;r>=0;r-=2){for(var s=0;s<=24;s+=8)a<<=1,a|=t>>>s+r&1;for(s=0;s<=24;s+=8)a<<=1,a|=e>>>s+r&1}for(r=6;r>=0;r-=2){for(s=1;s<=25;s+=8)n<<=1,n|=t>>>s+r&1;for(s=1;s<=25;s+=8)n<<=1,n|=e>>>s+r&1}o[i+0]=a>>>0,o[i+1]=n>>>0},o.rip=function(e,t,o,i){for(var a=0,n=0,r=0;r<4;r++)for(var s=24;s>=0;s-=8)a<<=1,a|=t>>>s+r&1,a<<=1,a|=e>>>s+r&1;for(r=4;r<8;r++)for(s=24;s>=0;s-=8)n<<=1,n|=t>>>s+r&1,n<<=1,n|=e>>>s+r&1;o[i+0]=a>>>0,o[i+1]=n>>>0},o.pc1=function(e,t,o,i){for(var a=0,n=0,r=7;r>=5;r--){for(var s=0;s<=24;s+=8)a<<=1,a|=t>>s+r&1;for(s=0;s<=24;s+=8)a<<=1,a|=e>>s+r&1}for(s=0;s<=24;s+=8)a<<=1,a|=t>>s+r&1;for(r=1;r<=3;r++){for(s=0;s<=24;s+=8)n<<=1,n|=t>>s+r&1;for(s=0;s<=24;s+=8)n<<=1,n|=e>>s+r&1}for(s=0;s<=24;s+=8)n<<=1,n|=e>>s+r&1;o[i+0]=a>>>0,o[i+1]=n>>>0},o.r28shl=function(e,t){return e<<t&268435455|e>>>28-t};var i=[14,11,17,4,27,23,25,0,13,22,7,18,5,9,16,24,2,20,12,21,1,8,15,26,15,4,25,19,9,1,26,16,5,11,23,8,12,7,17,0,22,3,10,14,6,20,27,24];o.pc2=function(e,t,o,a){for(var n=0,r=0,s=i.length>>>1,c=0;c<s;c++)n<<=1,n|=e>>>i[c]&1;for(c=s;c<i.length;c++)r<<=1,r|=t>>>i[c]&1;o[a+0]=n>>>0,o[a+1]=r>>>0},o.expand=function(e,t,o){var i=0,a=0;i=(1&e)<<5|e>>>27;for(var n=23;n>=15;n-=4)i<<=6,i|=e>>>n&63;for(n=11;n>=3;n-=4)a|=e>>>n&63,a<<=6;a|=(31&e)<<1|e>>>31,t[o+0]=i>>>0,t[o+1]=a>>>0};var a=[14,0,4,15,13,7,1,4,2,14,15,2,11,13,8,1,3,10,10,6,6,12,12,11,5,9,9,5,0,3,7,8,4,15,1,12,14,8,8,2,13,4,6,9,2,1,11,7,15,5,12,11,9,3,7,14,3,10,10,0,5,6,0,13,15,3,1,13,8,4,14,7,6,15,11,2,3,8,4,14,9,12,7,0,2,1,13,10,12,6,0,9,5,11,10,5,0,13,14,8,7,10,11,1,10,3,4,15,13,4,1,2,5,11,8,6,12,7,6,12,9,0,3,5,2,14,15,9,10,13,0,7,9,0,14,9,6,3,3,4,15,6,5,10,1,2,13,8,12,5,7,14,11,12,4,11,2,15,8,1,13,1,6,10,4,13,9,0,8,6,15,9,3,8,0,7,11,4,1,15,2,14,12,3,5,11,10,5,14,2,7,12,7,13,13,8,14,11,3,5,0,6,6,15,9,0,10,3,1,4,2,7,8,2,5,12,11,1,12,10,4,14,15,9,10,3,6,15,9,0,0,6,12,10,11,1,7,13,13,8,15,9,1,4,3,5,14,11,5,12,2,7,8,2,4,14,2,14,12,11,4,2,1,12,7,4,10,7,11,13,6,1,8,5,5,0,3,15,15,10,13,3,0,9,14,8,9,6,4,11,2,8,1,12,11,7,10,1,13,14,7,2,8,13,15,6,9,15,12,0,5,9,6,10,3,4,0,5,14,3,12,10,1,15,10,4,15,2,9,7,2,12,6,9,8,5,0,6,13,1,3,13,4,14,14,0,7,11,5,3,11,8,9,4,14,3,15,2,5,12,2,9,8,5,12,15,3,10,7,11,0,14,4,1,10,7,1,6,13,0,11,8,6,13,4,13,11,0,2,11,14,7,15,4,0,9,8,1,13,10,3,14,12,3,9,5,7,12,5,2,10,15,6,8,1,6,1,6,4,11,11,13,13,8,12,1,3,4,7,10,14,7,10,9,15,5,6,0,8,15,0,14,5,2,9,3,2,12,13,1,2,15,8,13,4,8,6,10,15,3,11,7,1,4,10,12,9,5,3,6,14,11,5,0,0,14,12,9,7,2,7,2,11,1,4,14,1,7,9,4,12,10,14,8,2,13,0,15,6,12,10,9,13,0,15,3,3,5,5,6,8,11];o.substitute=function(e,t){for(var o=0,i=0;i<4;i++)o<<=4,o|=a[64*i+(e>>>18-6*i&63)];for(i=0;i<4;i++)o<<=4,o|=a[256+64*i+(t>>>18-6*i&63)];return o>>>0};var n=[16,25,12,11,3,20,4,15,31,17,9,6,27,14,1,22,30,24,8,18,0,5,29,23,13,19,2,26,10,21,28,7];o.permute=function(e){for(var t=0,o=0;o<n.length;o++)t<<=1,t|=e>>>n[o]&1;return t>>>0},o.padSplit=function(e,t,o){for(var i=e.toString(2);i.length<t;)i="0"+i;for(var a=[],n=0;n<t;n+=o)a.push(i.slice(n,n+o));return a.join(" ")}},{}],83:[function(e,t,o){(function(t){var i=e("./lib/generatePrime"),a=e("./lib/primes.json"),n=e("./lib/dh"),r={binary:!0,hex:!0,base64:!0};o.DiffieHellmanGroup=o.createDiffieHellmanGroup=o.getDiffieHellman=function(e){var o=new t(a[e].prime,"hex"),i=new t(a[e].gen,"hex");return new n(o,i)},o.createDiffieHellman=o.DiffieHellman=function e(o,a,s,c){return t.isBuffer(a)||void 0===r[a]?e(o,"binary",a,s):(a=a||"binary",c=c||"binary",s=s||new t([2]),t.isBuffer(s)||(s=new t(s,c)),"number"==typeof o?new n(i(o,s),s,!0):(t.isBuffer(o)||(o=new t(o,a)),new n(o,s,!0)))}}).call(this,e("buffer").Buffer)},{"./lib/dh":84,"./lib/generatePrime":85,"./lib/primes.json":86,buffer:66}],84:[function(e,t){(function(o){var i=e("bn.js"),a=new(e("miller-rabin")),n=new i(24),r=new i(11),s=new i(10),c=new i(3),l=new i(7),d=e("./generatePrime"),u=e("randombytes");function h(e,t){return t=t||"utf8",o.isBuffer(e)||(e=new o(e,t)),this._pub=new i(e),this}function p(e,t){return t=t||"utf8",o.isBuffer(e)||(e=new o(e,t)),this._priv=new i(e),this}t.exports=m;var f={};function g(e,t){var o=t.toString("hex"),i=[o,e.toString(16)].join("_");if(i in f)return f[i];var u,h=0;if(e.isEven()||!d.simpleSieve||!d.fermatTest(e)||!a.test(e))return h+=1,h+="02"===o||"05"===o?8:4,f[i]=h,h;switch(a.test(e.shrn(1))||(h+=2),o){case"02":e.mod(n).cmp(r)&&(h+=8);break;case"05":(u=e.mod(s)).cmp(c)&&u.cmp(l)&&(h+=8);break;default:h+=4}return f[i]=h,h}function m(e,t,o){this.setGenerator(t),this.__prime=new i(e),this._prime=i.mont(this.__prime),this._primeLen=e.length,this._pub=void 0,this._priv=void 0,this._primeCode=void 0,o?(this.setPublicKey=h,this.setPrivateKey=p):this._primeCode=8}function _(e,t){var i=new o(e.toArray());return t?i.toString(t):i}Object.defineProperty(m.prototype,"verifyError",{enumerable:!0,get:function(){return"number"!=typeof this._primeCode&&(this._primeCode=g(this.__prime,this.__gen)),this._primeCode}}),m.prototype.generateKeys=function(){return this._priv||(this._priv=new i(u(this._primeLen))),this._pub=this._gen.toRed(this._prime).redPow(this._priv).fromRed(),this.getPublicKey()},m.prototype.computeSecret=function(e){var t=(e=(e=new i(e)).toRed(this._prime)).redPow(this._priv).fromRed(),a=new o(t.toArray()),n=this.getPrime();if(a.length<n.length){var r=new o(n.length-a.length);r.fill(0),a=o.concat([r,a])}return a},m.prototype.getPublicKey=function(e){return _(this._pub,e)},m.prototype.getPrivateKey=function(e){return _(this._priv,e)},m.prototype.getPrime=function(e){return _(this.__prime,e)},m.prototype.getGenerator=function(e){return _(this._gen,e)},m.prototype.setGenerator=function(e,t){return t=t||"utf8",o.isBuffer(e)||(e=new o(e,t)),this.__gen=e,this._gen=new i(e),this}}).call(this,e("buffer").Buffer)},{"./generatePrime":85,"bn.js":87,buffer:66,"miller-rabin":143,randombytes:167}],85:[function(e,t){var o=e("randombytes");t.exports=_,_.simpleSieve=g,_.fermatTest=m;var i=e("bn.js"),a=new i(24),n=new(e("miller-rabin")),r=new i(1),s=new i(2),c=new i(5),l=(new i(16),new i(8),new i(10)),d=new i(3),u=(new i(7),new i(11)),h=new i(4),p=(new i(12),null);function f(){if(null!==p)return p;var e=[];e[0]=2;for(var t=1,o=3;o<1048576;o+=2){for(var i=Math.ceil(Math.sqrt(o)),a=0;a<t&&e[a]<=i&&o%e[a]!=0;a++);t!==a&&e[a]<=i||(e[t++]=o)}return p=e,e}function g(e){for(var t=f(),o=0;o<t.length;o++)if(0===e.modn(t[o]))return 0===e.cmpn(t[o]);return!0}function m(e){var t=i.mont(e);return 0===s.toRed(t).redPow(e.subn(1)).fromRed().cmpn(1)}function _(e,t){if(e<16)return new i(2===t||5===t?[140,123]:[140,39]);var p,f;for(t=new i(t);;){for(p=new i(o(Math.ceil(e/8)));p.bitLength()>e;)p.ishrn(1);if(p.isEven()&&p.iadd(r),p.testn(1)||p.iadd(s),t.cmp(s)){if(!t.cmp(c))for(;p.mod(l).cmp(d);)p.iadd(h)}else for(;p.mod(a).cmp(u);)p.iadd(h);if(g(f=p.shrn(1))&&g(p)&&m(f)&&m(p)&&n.test(f)&&n.test(p))return p}}},{"bn.js":87,"miller-rabin":143,randombytes:167}],86:[function(e,t){t.exports={modp1:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a63a3620ffffffffffffffff"},modp2:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece65381ffffffffffffffff"},modp5:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca237327ffffffffffffffff"},modp14:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aacaa68ffffffffffffffff"},modp15:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a93ad2caffffffffffffffff"},modp16:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c934063199ffffffffffffffff"},modp17:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dcc4024ffffffffffffffff"},modp18:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dbe115974a3926f12fee5e438777cb6a932df8cd8bec4d073b931ba3bc832b68d9dd300741fa7bf8afc47ed2576f6936ba424663aab639c5ae4f5683423b4742bf1c978238f16cbe39d652de3fdb8befc848ad922222e04a4037c0713eb57a81a23f0c73473fc646cea306b4bcbc8862f8385ddfa9d4b7fa2c087e879683303ed5bdd3a062b3cf5b3a278a66d2a13f83f44f82ddf310ee074ab6a364597e899a0255dc164f31cc50846851df9ab48195ded7ea1b1d510bd7ee74d73faf36bc31ecfa268359046f4eb879f924009438b481c6cd7889a002ed5ee382bc9190da6fc026e479558e4475677e9aa9e3050e2765694dfc81f56e880b96e7160c980dd98edd3dfffffffffffffffff"}}},{}],87:[function(e,t,o){arguments[4][15][0].apply(o,arguments)},{buffer:19,dup:15}],88:[function(e,t,o){"use strict";var i=o;i.version=e("../package.json").version,i.utils=e("./elliptic/utils"),i.rand=e("brorand"),i.curve=e("./elliptic/curve"),i.curves=e("./elliptic/curves"),i.ec=e("./elliptic/ec"),i.eddsa=e("./elliptic/eddsa")},{"../package.json":104,"./elliptic/curve":91,"./elliptic/curves":94,"./elliptic/ec":95,"./elliptic/eddsa":98,"./elliptic/utils":102,brorand:18}],89:[function(e,t){"use strict";var o=e("bn.js"),i=e("../utils"),a=i.getNAF,n=i.getJSF,r=i.assert;function s(e,t){this.type=e,this.p=new o(t.p,16),this.red=t.prime?o.red(t.prime):o.mont(this.p),this.zero=new o(0).toRed(this.red),this.one=new o(1).toRed(this.red),this.two=new o(2).toRed(this.red),this.n=t.n&&new o(t.n,16),this.g=t.g&&this.pointFromJSON(t.g,t.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var i=this.n&&this.p.div(this.n);!i||i.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}function c(e,t){this.curve=e,this.type=t,this.precomputed=null}t.exports=s,s.prototype.point=function(){throw new Error("Not implemented")},s.prototype.validate=function(){throw new Error("Not implemented")},s.prototype._fixedNafMul=function(e,t){r(e.precomputed);var o=e._getDoubles(),i=a(t,1,this._bitLength),n=(1<<o.step+1)-(o.step%2==0?2:1);n/=3;for(var s=[],c=0;c<i.length;c+=o.step){var l=0;for(t=c+o.step-1;t>=c;t--)l=(l<<1)+i[t];s.push(l)}for(var d=this.jpoint(null,null,null),u=this.jpoint(null,null,null),h=n;h>0;h--){for(c=0;c<s.length;c++)(l=s[c])===h?u=u.mixedAdd(o.points[c]):l===-h&&(u=u.mixedAdd(o.points[c].neg()));d=d.add(u)}return d.toP()},s.prototype._wnafMul=function(e,t){var o=4,i=e._getNAFPoints(o);o=i.wnd;for(var n=i.points,s=a(t,o,this._bitLength),c=this.jpoint(null,null,null),l=s.length-1;l>=0;l--){for(t=0;l>=0&&0===s[l];l--)t++;if(l>=0&&t++,c=c.dblp(t),l<0)break;var d=s[l];r(0!==d),c="affine"===e.type?d>0?c.mixedAdd(n[d-1>>1]):c.mixedAdd(n[-d-1>>1].neg()):d>0?c.add(n[d-1>>1]):c.add(n[-d-1>>1].neg())}return"affine"===e.type?c.toP():c},s.prototype._wnafMulAdd=function(e,t,o,i,r){for(var s=this._wnafT1,c=this._wnafT2,l=this._wnafT3,d=0,u=0;u<i;u++){var h=(b=t[u])._getNAFPoints(e);s[u]=h.wnd,c[u]=h.points}for(u=i-1;u>=1;u-=2){var p=u-1,f=u;if(1===s[p]&&1===s[f]){var g=[t[p],null,null,t[f]];0===t[p].y.cmp(t[f].y)?(g[1]=t[p].add(t[f]),g[2]=t[p].toJ().mixedAdd(t[f].neg())):0===t[p].y.cmp(t[f].y.redNeg())?(g[1]=t[p].toJ().mixedAdd(t[f]),g[2]=t[p].add(t[f].neg())):(g[1]=t[p].toJ().mixedAdd(t[f]),g[2]=t[p].toJ().mixedAdd(t[f].neg()));var m=[-3,-1,-5,-7,0,7,5,1,3],_=n(o[p],o[f]);d=Math.max(_[0].length,d),l[p]=new Array(d),l[f]=new Array(d);for(var y=0;y<d;y++){var v=0|_[0][y],C=0|_[1][y];l[p][y]=m[3*(v+1)+(C+1)],l[f][y]=0,c[p]=g}}else l[p]=a(o[p],s[p],this._bitLength),l[f]=a(o[f],s[f],this._bitLength),d=Math.max(l[p].length,d),d=Math.max(l[f].length,d)}var S=this.jpoint(null,null,null),T=this._wnafT4;for(u=d;u>=0;u--){for(var I=0;u>=0;){var N=!0;for(y=0;y<i;y++)T[y]=0|l[y][u],0!==T[y]&&(N=!1);if(!N)break;I++,u--}if(u>=0&&I++,S=S.dblp(I),u<0)break;for(y=0;y<i;y++){var b,w=T[y];0!==w&&(w>0?b=c[y][w-1>>1]:w<0&&(b=c[y][-w-1>>1].neg()),S="affine"===b.type?S.mixedAdd(b):S.add(b))}}for(u=0;u<i;u++)c[u]=null;return r?S:S.toP()},s.BasePoint=c,c.prototype.eq=function(){throw new Error("Not implemented")},c.prototype.validate=function(){return this.curve.validate(this)},s.prototype.decodePoint=function(e,t){e=i.toArray(e,t);var o=this.p.byteLength();if((4===e[0]||6===e[0]||7===e[0])&&e.length-1==2*o)return 6===e[0]?r(e[e.length-1]%2==0):7===e[0]&&r(e[e.length-1]%2==1),this.point(e.slice(1,1+o),e.slice(1+o,1+2*o));if((2===e[0]||3===e[0])&&e.length-1===o)return this.pointFromX(e.slice(1,1+o),3===e[0]);throw new Error("Unknown point format")},c.prototype.encodeCompressed=function(e){return this.encode(e,!0)},c.prototype._encode=function(e){var t=this.curve.p.byteLength(),o=this.getX().toArray("be",t);return e?[this.getY().isEven()?2:3].concat(o):[4].concat(o,this.getY().toArray("be",t))},c.prototype.encode=function(e,t){return i.encode(this._encode(t),e)},c.prototype.precompute=function(e){if(this.precomputed)return this;var t={doubles:null,naf:null,beta:null};return t.naf=this._getNAFPoints(8),t.doubles=this._getDoubles(4,e),t.beta=this._getBeta(),this.precomputed=t,this},c.prototype._hasDoubles=function(e){if(!this.precomputed)return!1;var t=this.precomputed.doubles;return!!t&&t.points.length>=Math.ceil((e.bitLength()+1)/t.step)},c.prototype._getDoubles=function(e,t){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var o=[this],i=this,a=0;a<t;a+=e){for(var n=0;n<e;n++)i=i.dbl();o.push(i)}return{step:e,points:o}},c.prototype._getNAFPoints=function(e){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var t=[this],o=(1<<e)-1,i=1===o?null:this.dbl(),a=1;a<o;a++)t[a]=t[a-1].add(i);return{wnd:e,points:t}},c.prototype._getBeta=function(){return null},c.prototype.dblp=function(e){for(var t=this,o=0;o<e;o++)t=t.dbl();return t}},{"../utils":102,"bn.js":103}],90:[function(e,t){"use strict";var o=e("../utils"),i=e("bn.js"),a=e("inherits"),n=e("./base"),r=o.assert;function s(e){this.twisted=1!=(0|e.a),this.mOneA=this.twisted&&-1==(0|e.a),this.extended=this.mOneA,n.call(this,"edwards",e),this.a=new i(e.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new i(e.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new i(e.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),r(!this.twisted||0===this.c.fromRed().cmpn(1)),this.oneC=1==(0|e.c)}function c(e,t,o,a,r){n.BasePoint.call(this,e,"projective"),null===t&&null===o&&null===a?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new i(t,16),this.y=new i(o,16),this.z=a?new i(a,16):this.curve.one,this.t=r&&new i(r,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}a(s,n),t.exports=s,s.prototype._mulA=function(e){return this.mOneA?e.redNeg():this.a.redMul(e)},s.prototype._mulC=function(e){return this.oneC?e:this.c.redMul(e)},s.prototype.jpoint=function(e,t,o,i){return this.point(e,t,o,i)},s.prototype.pointFromX=function(e,t){(e=new i(e,16)).red||(e=e.toRed(this.red));var o=e.redSqr(),a=this.c2.redSub(this.a.redMul(o)),n=this.one.redSub(this.c2.redMul(this.d).redMul(o)),r=a.redMul(n.redInvm()),s=r.redSqrt();if(0!==s.redSqr().redSub(r).cmp(this.zero))throw new Error("invalid point");var c=s.fromRed().isOdd();return(t&&!c||!t&&c)&&(s=s.redNeg()),this.point(e,s)},s.prototype.pointFromY=function(e,t){(e=new i(e,16)).red||(e=e.toRed(this.red));var o=e.redSqr(),a=o.redSub(this.c2),n=o.redMul(this.d).redMul(this.c2).redSub(this.a),r=a.redMul(n.redInvm());if(0===r.cmp(this.zero)){if(t)throw new Error("invalid point");return this.point(this.zero,e)}var s=r.redSqrt();if(0!==s.redSqr().redSub(r).cmp(this.zero))throw new Error("invalid point");return s.fromRed().isOdd()!==t&&(s=s.redNeg()),this.point(s,e)},s.prototype.validate=function(e){if(e.isInfinity())return!0;e.normalize();var t=e.x.redSqr(),o=e.y.redSqr(),i=t.redMul(this.a).redAdd(o),a=this.c2.redMul(this.one.redAdd(this.d.redMul(t).redMul(o)));return 0===i.cmp(a)},a(c,n.BasePoint),s.prototype.pointFromJSON=function(e){return c.fromJSON(this,e)},s.prototype.point=function(e,t,o,i){return new c(this,e,t,o,i)},c.fromJSON=function(e,t){return new c(e,t[0],t[1],t[2])},c.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},c.prototype.isInfinity=function(){return 0===this.x.cmpn(0)&&(0===this.y.cmp(this.z)||this.zOne&&0===this.y.cmp(this.curve.c))},c.prototype._extDbl=function(){var e=this.x.redSqr(),t=this.y.redSqr(),o=this.z.redSqr();o=o.redIAdd(o);var i=this.curve._mulA(e),a=this.x.redAdd(this.y).redSqr().redISub(e).redISub(t),n=i.redAdd(t),r=n.redSub(o),s=i.redSub(t),c=a.redMul(r),l=n.redMul(s),d=a.redMul(s),u=r.redMul(n);return this.curve.point(c,l,u,d)},c.prototype._projDbl=function(){var e,t,o,i=this.x.redAdd(this.y).redSqr(),a=this.x.redSqr(),n=this.y.redSqr();if(this.curve.twisted){var r=(l=this.curve._mulA(a)).redAdd(n);if(this.zOne)e=i.redSub(a).redSub(n).redMul(r.redSub(this.curve.two)),t=r.redMul(l.redSub(n)),o=r.redSqr().redSub(r).redSub(r);else{var s=this.z.redSqr(),c=r.redSub(s).redISub(s);e=i.redSub(a).redISub(n).redMul(c),t=r.redMul(l.redSub(n)),o=r.redMul(c)}}else{var l=a.redAdd(n);s=this.curve._mulC(this.z).redSqr(),c=l.redSub(s).redSub(s),e=this.curve._mulC(i.redISub(l)).redMul(c),t=this.curve._mulC(l).redMul(a.redISub(n)),o=l.redMul(c)}return this.curve.point(e,t,o)},c.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()},c.prototype._extAdd=function(e){var t=this.y.redSub(this.x).redMul(e.y.redSub(e.x)),o=this.y.redAdd(this.x).redMul(e.y.redAdd(e.x)),i=this.t.redMul(this.curve.dd).redMul(e.t),a=this.z.redMul(e.z.redAdd(e.z)),n=o.redSub(t),r=a.redSub(i),s=a.redAdd(i),c=o.redAdd(t),l=n.redMul(r),d=s.redMul(c),u=n.redMul(c),h=r.redMul(s);return this.curve.point(l,d,h,u)},c.prototype._projAdd=function(e){var t,o,i=this.z.redMul(e.z),a=i.redSqr(),n=this.x.redMul(e.x),r=this.y.redMul(e.y),s=this.curve.d.redMul(n).redMul(r),c=a.redSub(s),l=a.redAdd(s),d=this.x.redAdd(this.y).redMul(e.x.redAdd(e.y)).redISub(n).redISub(r),u=i.redMul(c).redMul(d);return this.curve.twisted?(t=i.redMul(l).redMul(r.redSub(this.curve._mulA(n))),o=c.redMul(l)):(t=i.redMul(l).redMul(r.redSub(n)),o=this.curve._mulC(c).redMul(l)),this.curve.point(u,t,o)},c.prototype.add=function(e){return this.isInfinity()?e:e.isInfinity()?this:this.curve.extended?this._extAdd(e):this._projAdd(e)},c.prototype.mul=function(e){return this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve._wnafMul(this,e)},c.prototype.mulAdd=function(e,t,o){return this.curve._wnafMulAdd(1,[this,t],[e,o],2,!1)},c.prototype.jmulAdd=function(e,t,o){return this.curve._wnafMulAdd(1,[this,t],[e,o],2,!0)},c.prototype.normalize=function(){if(this.zOne)return this;var e=this.z.redInvm();return this.x=this.x.redMul(e),this.y=this.y.redMul(e),this.t&&(this.t=this.t.redMul(e)),this.z=this.curve.one,this.zOne=!0,this},c.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())},c.prototype.getX=function(){return this.normalize(),this.x.fromRed()},c.prototype.getY=function(){return this.normalize(),this.y.fromRed()},c.prototype.eq=function(e){return this===e||0===this.getX().cmp(e.getX())&&0===this.getY().cmp(e.getY())},c.prototype.eqXToP=function(e){var t=e.toRed(this.curve.red).redMul(this.z);if(0===this.x.cmp(t))return!0;for(var o=e.clone(),i=this.curve.redN.redMul(this.z);;){if(o.iadd(this.curve.n),o.cmp(this.curve.p)>=0)return!1;if(t.redIAdd(i),0===this.x.cmp(t))return!0}},c.prototype.toP=c.prototype.normalize,c.prototype.mixedAdd=c.prototype.add},{"../utils":102,"./base":89,"bn.js":103,inherits:140}],91:[function(e,t,o){"use strict";var i=o;i.base=e("./base"),i.short=e("./short"),i.mont=e("./mont"),i.edwards=e("./edwards")},{"./base":89,"./edwards":90,"./mont":92,"./short":93}],92:[function(e,t){"use strict";var o=e("bn.js"),i=e("inherits"),a=e("./base"),n=e("../utils");function r(e){a.call(this,"mont",e),this.a=new o(e.a,16).toRed(this.red),this.b=new o(e.b,16).toRed(this.red),this.i4=new o(4).toRed(this.red).redInvm(),this.two=new o(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}function s(e,t,i){a.BasePoint.call(this,e,"projective"),null===t&&null===i?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new o(t,16),this.z=new o(i,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}i(r,a),t.exports=r,r.prototype.validate=function(e){var t=e.normalize().x,o=t.redSqr(),i=o.redMul(t).redAdd(o.redMul(this.a)).redAdd(t);return 0===i.redSqrt().redSqr().cmp(i)},i(s,a.BasePoint),r.prototype.decodePoint=function(e,t){return this.point(n.toArray(e,t),1)},r.prototype.point=function(e,t){return new s(this,e,t)},r.prototype.pointFromJSON=function(e){return s.fromJSON(this,e)},s.prototype.precompute=function(){},s.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())},s.fromJSON=function(e,t){return new s(e,t[0],t[1]||e.one)},s.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},s.prototype.isInfinity=function(){return 0===this.z.cmpn(0)},s.prototype.dbl=function(){var e=this.x.redAdd(this.z).redSqr(),t=this.x.redSub(this.z).redSqr(),o=e.redSub(t),i=e.redMul(t),a=o.redMul(t.redAdd(this.curve.a24.redMul(o)));return this.curve.point(i,a)},s.prototype.add=function(){throw new Error("Not supported on Montgomery curve")},s.prototype.diffAdd=function(e,t){var o=this.x.redAdd(this.z),i=this.x.redSub(this.z),a=e.x.redAdd(e.z),n=e.x.redSub(e.z).redMul(o),r=a.redMul(i),s=t.z.redMul(n.redAdd(r).redSqr()),c=t.x.redMul(n.redISub(r).redSqr());return this.curve.point(s,c)},s.prototype.mul=function(e){for(var t=e.clone(),o=this,i=this.curve.point(null,null),a=[];0!==t.cmpn(0);t.iushrn(1))a.push(t.andln(1));for(var n=a.length-1;n>=0;n--)0===a[n]?(o=o.diffAdd(i,this),i=i.dbl()):(i=o.diffAdd(i,this),o=o.dbl());return i},s.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")},s.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")},s.prototype.eq=function(e){return 0===this.getX().cmp(e.getX())},s.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this},s.prototype.getX=function(){return this.normalize(),this.x.fromRed()}},{"../utils":102,"./base":89,"bn.js":103,inherits:140}],93:[function(e,t){"use strict";var o=e("../utils"),i=e("bn.js"),a=e("inherits"),n=e("./base"),r=o.assert;function s(e){n.call(this,"short",e),this.a=new i(e.a,16).toRed(this.red),this.b=new i(e.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=0===this.a.fromRed().cmpn(0),this.threeA=0===this.a.fromRed().sub(this.p).cmpn(-3),this.endo=this._getEndomorphism(e),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}function c(e,t,o,a){n.BasePoint.call(this,e,"affine"),null===t&&null===o?(this.x=null,this.y=null,this.inf=!0):(this.x=new i(t,16),this.y=new i(o,16),a&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}function l(e,t,o,a){n.BasePoint.call(this,e,"jacobian"),null===t&&null===o&&null===a?(this.x=this.curve.one,this.y=this.curve.one,this.z=new i(0)):(this.x=new i(t,16),this.y=new i(o,16),this.z=new i(a,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}a(s,n),t.exports=s,s.prototype._getEndomorphism=function(e){if(this.zeroA&&this.g&&this.n&&1===this.p.modn(3)){var t,o;if(e.beta)t=new i(e.beta,16).toRed(this.red);else{var a=this._getEndoRoots(this.p);t=(t=a[0].cmp(a[1])<0?a[0]:a[1]).toRed(this.red)}if(e.lambda)o=new i(e.lambda,16);else{var n=this._getEndoRoots(this.n);0===this.g.mul(n[0]).x.cmp(this.g.x.redMul(t))?o=n[0]:(o=n[1],r(0===this.g.mul(o).x.cmp(this.g.x.redMul(t))))}return{beta:t,lambda:o,basis:e.basis?e.basis.map(function(e){return{a:new i(e.a,16),b:new i(e.b,16)}}):this._getEndoBasis(o)}}},s.prototype._getEndoRoots=function(e){var t=e===this.p?this.red:i.mont(e),o=new i(2).toRed(t).redInvm(),a=o.redNeg(),n=new i(3).toRed(t).redNeg().redSqrt().redMul(o);return[a.redAdd(n).fromRed(),a.redSub(n).fromRed()]},s.prototype._getEndoBasis=function(e){for(var t,o,a,n,r,s,c,l,d,u=this.n.ushrn(Math.floor(this.n.bitLength()/2)),h=e,p=this.n.clone(),f=new i(1),g=new i(0),m=new i(0),_=new i(1),y=0;0!==h.cmpn(0);){var v=p.div(h);l=p.sub(v.mul(h)),d=m.sub(v.mul(f));var C=_.sub(v.mul(g));if(!a&&l.cmp(u)<0)t=c.neg(),o=f,a=l.neg(),n=d;else if(a&&2==++y)break;c=l,p=h,h=l,m=f,f=d,_=g,g=C}r=l.neg(),s=d;var S=a.sqr().add(n.sqr());return r.sqr().add(s.sqr()).cmp(S)>=0&&(r=t,s=o),a.negative&&(a=a.neg(),n=n.neg()),r.negative&&(r=r.neg(),s=s.neg()),[{a:a,b:n},{a:r,b:s}]},s.prototype._endoSplit=function(e){var t=this.endo.basis,o=t[0],i=t[1],a=i.b.mul(e).divRound(this.n),n=o.b.neg().mul(e).divRound(this.n),r=a.mul(o.a),s=n.mul(i.a),c=a.mul(o.b),l=n.mul(i.b);return{k1:e.sub(r).sub(s),k2:c.add(l).neg()}},s.prototype.pointFromX=function(e,t){(e=new i(e,16)).red||(e=e.toRed(this.red));var o=e.redSqr().redMul(e).redIAdd(e.redMul(this.a)).redIAdd(this.b),a=o.redSqrt();if(0!==a.redSqr().redSub(o).cmp(this.zero))throw new Error("invalid point");var n=a.fromRed().isOdd();return(t&&!n||!t&&n)&&(a=a.redNeg()),this.point(e,a)},s.prototype.validate=function(e){if(e.inf)return!0;var t=e.x,o=e.y,i=this.a.redMul(t),a=t.redSqr().redMul(t).redIAdd(i).redIAdd(this.b);return 0===o.redSqr().redISub(a).cmpn(0)},s.prototype._endoWnafMulAdd=function(e,t,o){for(var i=this._endoWnafT1,a=this._endoWnafT2,n=0;n<e.length;n++){var r=this._endoSplit(t[n]),s=e[n],c=s._getBeta();r.k1.negative&&(r.k1.ineg(),s=s.neg(!0)),r.k2.negative&&(r.k2.ineg(),c=c.neg(!0)),i[2*n]=s,i[2*n+1]=c,a[2*n]=r.k1,a[2*n+1]=r.k2}for(var l=this._wnafMulAdd(1,i,a,2*n,o),d=0;d<2*n;d++)i[d]=null,a[d]=null;return l},a(c,n.BasePoint),s.prototype.point=function(e,t,o){return new c(this,e,t,o)},s.prototype.pointFromJSON=function(e,t){return c.fromJSON(this,e,t)},c.prototype._getBeta=function(){if(this.curve.endo){var e=this.precomputed;if(e&&e.beta)return e.beta;var t=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(e){var o=this.curve,i=function(e){return o.point(e.x.redMul(o.endo.beta),e.y)};e.beta=t,t.precomputed={beta:null,naf:e.naf&&{wnd:e.naf.wnd,points:e.naf.points.map(i)},doubles:e.doubles&&{step:e.doubles.step,points:e.doubles.points.map(i)}}}return t}},c.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},c.fromJSON=function(e,t,o){"string"==typeof t&&(t=JSON.parse(t));var i=e.point(t[0],t[1],o);if(!t[2])return i;function a(t){return e.point(t[0],t[1],o)}var n=t[2];return i.precomputed={beta:null,doubles:n.doubles&&{step:n.doubles.step,points:[i].concat(n.doubles.points.map(a))},naf:n.naf&&{wnd:n.naf.wnd,points:[i].concat(n.naf.points.map(a))}},i},c.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},c.prototype.isInfinity=function(){return this.inf},c.prototype.add=function(e){if(this.inf)return e;if(e.inf)return this;if(this.eq(e))return this.dbl();if(this.neg().eq(e))return this.curve.point(null,null);if(0===this.x.cmp(e.x))return this.curve.point(null,null);var t=this.y.redSub(e.y);0!==t.cmpn(0)&&(t=t.redMul(this.x.redSub(e.x).redInvm()));var o=t.redSqr().redISub(this.x).redISub(e.x),i=t.redMul(this.x.redSub(o)).redISub(this.y);return this.curve.point(o,i)},c.prototype.dbl=function(){if(this.inf)return this;var e=this.y.redAdd(this.y);if(0===e.cmpn(0))return this.curve.point(null,null);var t=this.curve.a,o=this.x.redSqr(),i=e.redInvm(),a=o.redAdd(o).redIAdd(o).redIAdd(t).redMul(i),n=a.redSqr().redISub(this.x.redAdd(this.x)),r=a.redMul(this.x.redSub(n)).redISub(this.y);return this.curve.point(n,r)},c.prototype.getX=function(){return this.x.fromRed()},c.prototype.getY=function(){return this.y.fromRed()},c.prototype.mul=function(e){return e=new i(e,16),this.isInfinity()?this:this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve.endo?this.curve._endoWnafMulAdd([this],[e]):this.curve._wnafMul(this,e)},c.prototype.mulAdd=function(e,t,o){var i=[this,t],a=[e,o];return this.curve.endo?this.curve._endoWnafMulAdd(i,a):this.curve._wnafMulAdd(1,i,a,2)},c.prototype.jmulAdd=function(e,t,o){var i=[this,t],a=[e,o];return this.curve.endo?this.curve._endoWnafMulAdd(i,a,!0):this.curve._wnafMulAdd(1,i,a,2,!0)},c.prototype.eq=function(e){return this===e||this.inf===e.inf&&(this.inf||0===this.x.cmp(e.x)&&0===this.y.cmp(e.y))},c.prototype.neg=function(e){if(this.inf)return this;var t=this.curve.point(this.x,this.y.redNeg());if(e&&this.precomputed){var o=this.precomputed,i=function(e){return e.neg()};t.precomputed={naf:o.naf&&{wnd:o.naf.wnd,points:o.naf.points.map(i)},doubles:o.doubles&&{step:o.doubles.step,points:o.doubles.points.map(i)}}}return t},c.prototype.toJ=function(){return this.inf?this.curve.jpoint(null,null,null):this.curve.jpoint(this.x,this.y,this.curve.one)},a(l,n.BasePoint),s.prototype.jpoint=function(e,t,o){return new l(this,e,t,o)},l.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var e=this.z.redInvm(),t=e.redSqr(),o=this.x.redMul(t),i=this.y.redMul(t).redMul(e);return this.curve.point(o,i)},l.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},l.prototype.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var t=e.z.redSqr(),o=this.z.redSqr(),i=this.x.redMul(t),a=e.x.redMul(o),n=this.y.redMul(t.redMul(e.z)),r=e.y.redMul(o.redMul(this.z)),s=i.redSub(a),c=n.redSub(r);if(0===s.cmpn(0))return 0!==c.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var l=s.redSqr(),d=l.redMul(s),u=i.redMul(l),h=c.redSqr().redIAdd(d).redISub(u).redISub(u),p=c.redMul(u.redISub(h)).redISub(n.redMul(d)),f=this.z.redMul(e.z).redMul(s);return this.curve.jpoint(h,p,f)},l.prototype.mixedAdd=function(e){if(this.isInfinity())return e.toJ();if(e.isInfinity())return this;var t=this.z.redSqr(),o=this.x,i=e.x.redMul(t),a=this.y,n=e.y.redMul(t).redMul(this.z),r=o.redSub(i),s=a.redSub(n);if(0===r.cmpn(0))return 0!==s.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var c=r.redSqr(),l=c.redMul(r),d=o.redMul(c),u=s.redSqr().redIAdd(l).redISub(d).redISub(d),h=s.redMul(d.redISub(u)).redISub(a.redMul(l)),p=this.z.redMul(r);return this.curve.jpoint(u,h,p)},l.prototype.dblp=function(e){if(0===e)return this;if(this.isInfinity())return this;if(!e)return this.dbl();if(this.curve.zeroA||this.curve.threeA){for(var t=this,o=0;o<e;o++)t=t.dbl();return t}var i=this.curve.a,a=this.curve.tinv,n=this.x,r=this.y,s=this.z,c=s.redSqr().redSqr(),l=r.redAdd(r);for(o=0;o<e;o++){var d=n.redSqr(),u=l.redSqr(),h=u.redSqr(),p=d.redAdd(d).redIAdd(d).redIAdd(i.redMul(c)),f=n.redMul(u),g=p.redSqr().redISub(f.redAdd(f)),m=f.redISub(g),_=p.redMul(m);_=_.redIAdd(_).redISub(h);var y=l.redMul(s);o+1<e&&(c=c.redMul(h)),n=g,s=y,l=_}return this.curve.jpoint(n,l.redMul(a),s)},l.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},l.prototype._zeroDbl=function(){var e,t,o;if(this.zOne){var i=this.x.redSqr(),a=this.y.redSqr(),n=a.redSqr(),r=this.x.redAdd(a).redSqr().redISub(i).redISub(n);r=r.redIAdd(r);var s=i.redAdd(i).redIAdd(i),c=s.redSqr().redISub(r).redISub(r),l=n.redIAdd(n);l=(l=l.redIAdd(l)).redIAdd(l),e=c,t=s.redMul(r.redISub(c)).redISub(l),o=this.y.redAdd(this.y)}else{var d=this.x.redSqr(),u=this.y.redSqr(),h=u.redSqr(),p=this.x.redAdd(u).redSqr().redISub(d).redISub(h);p=p.redIAdd(p);var f=d.redAdd(d).redIAdd(d),g=f.redSqr(),m=h.redIAdd(h);m=(m=m.redIAdd(m)).redIAdd(m),e=g.redISub(p).redISub(p),t=f.redMul(p.redISub(e)).redISub(m),o=(o=this.y.redMul(this.z)).redIAdd(o)}return this.curve.jpoint(e,t,o)},l.prototype._threeDbl=function(){var e,t,o;if(this.zOne){var i=this.x.redSqr(),a=this.y.redSqr(),n=a.redSqr(),r=this.x.redAdd(a).redSqr().redISub(i).redISub(n);r=r.redIAdd(r);var s=i.redAdd(i).redIAdd(i).redIAdd(this.curve.a),c=s.redSqr().redISub(r).redISub(r);e=c;var l=n.redIAdd(n);l=(l=l.redIAdd(l)).redIAdd(l),t=s.redMul(r.redISub(c)).redISub(l),o=this.y.redAdd(this.y)}else{var d=this.z.redSqr(),u=this.y.redSqr(),h=this.x.redMul(u),p=this.x.redSub(d).redMul(this.x.redAdd(d));p=p.redAdd(p).redIAdd(p);var f=h.redIAdd(h),g=(f=f.redIAdd(f)).redAdd(f);e=p.redSqr().redISub(g),o=this.y.redAdd(this.z).redSqr().redISub(u).redISub(d);var m=u.redSqr();m=(m=(m=m.redIAdd(m)).redIAdd(m)).redIAdd(m),t=p.redMul(f.redISub(e)).redISub(m)}return this.curve.jpoint(e,t,o)},l.prototype._dbl=function(){var e=this.curve.a,t=this.x,o=this.y,i=this.z,a=i.redSqr().redSqr(),n=t.redSqr(),r=o.redSqr(),s=n.redAdd(n).redIAdd(n).redIAdd(e.redMul(a)),c=t.redAdd(t),l=(c=c.redIAdd(c)).redMul(r),d=s.redSqr().redISub(l.redAdd(l)),u=l.redISub(d),h=r.redSqr();h=(h=(h=h.redIAdd(h)).redIAdd(h)).redIAdd(h);var p=s.redMul(u).redISub(h),f=o.redAdd(o).redMul(i);return this.curve.jpoint(d,p,f)},l.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var e=this.x.redSqr(),t=this.y.redSqr(),o=this.z.redSqr(),i=t.redSqr(),a=e.redAdd(e).redIAdd(e),n=a.redSqr(),r=this.x.redAdd(t).redSqr().redISub(e).redISub(i),s=(r=(r=(r=r.redIAdd(r)).redAdd(r).redIAdd(r)).redISub(n)).redSqr(),c=i.redIAdd(i);c=(c=(c=c.redIAdd(c)).redIAdd(c)).redIAdd(c);var l=a.redIAdd(r).redSqr().redISub(n).redISub(s).redISub(c),d=t.redMul(l);d=(d=d.redIAdd(d)).redIAdd(d);var u=this.x.redMul(s).redISub(d);u=(u=u.redIAdd(u)).redIAdd(u);var h=this.y.redMul(l.redMul(c.redISub(l)).redISub(r.redMul(s)));h=(h=(h=h.redIAdd(h)).redIAdd(h)).redIAdd(h);var p=this.z.redAdd(r).redSqr().redISub(o).redISub(s);return this.curve.jpoint(u,h,p)},l.prototype.mul=function(e,t){return e=new i(e,t),this.curve._wnafMul(this,e)},l.prototype.eq=function(e){if("affine"===e.type)return this.eq(e.toJ());if(this===e)return!0;var t=this.z.redSqr(),o=e.z.redSqr();if(0!==this.x.redMul(o).redISub(e.x.redMul(t)).cmpn(0))return!1;var i=t.redMul(this.z),a=o.redMul(e.z);return 0===this.y.redMul(a).redISub(e.y.redMul(i)).cmpn(0)},l.prototype.eqXToP=function(e){var t=this.z.redSqr(),o=e.toRed(this.curve.red).redMul(t);if(0===this.x.cmp(o))return!0;for(var i=e.clone(),a=this.curve.redN.redMul(t);;){if(i.iadd(this.curve.n),i.cmp(this.curve.p)>=0)return!1;if(o.redIAdd(a),0===this.x.cmp(o))return!0}},l.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},l.prototype.isInfinity=function(){return 0===this.z.cmpn(0)}},{"../utils":102,"./base":89,"bn.js":103,inherits:140}],94:[function(e,t,o){"use strict";var i,a=o,n=e("hash.js"),r=e("./curve"),s=e("./utils").assert;function c(e){"short"===e.type?this.curve=new r.short(e):"edwards"===e.type?this.curve=new r.edwards(e):this.curve=new r.mont(e),this.g=this.curve.g,this.n=this.curve.n,this.hash=e.hash,s(this.g.validate(),"Invalid curve"),s(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}function l(e,t){Object.defineProperty(a,e,{configurable:!0,enumerable:!0,get:function(){var o=new c(t);return Object.defineProperty(a,e,{configurable:!0,enumerable:!0,value:o}),o}})}a.PresetCurve=c,l("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:n.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),l("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:n.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),l("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:n.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),l("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:n.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),l("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:n.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),l("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:n.sha256,gRed:!1,g:["9"]}),l("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:n.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});try{i=e("./precomputed/secp256k1")}catch(d){i=void 0}l("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:n.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",i]})},{"./curve":91,"./precomputed/secp256k1":101,"./utils":102,"hash.js":125}],95:[function(e,t){"use strict";var o=e("bn.js"),i=e("hmac-drbg"),a=e("../utils"),n=e("../curves"),r=e("brorand"),s=a.assert,c=e("./key"),l=e("./signature");function d(e){if(!(this instanceof d))return new d(e);"string"==typeof e&&(s(n.hasOwnProperty(e),"Unknown curve "+e),e=n[e]),e instanceof n.PresetCurve&&(e={curve:e}),this.curve=e.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=e.curve.g,this.g.precompute(e.curve.n.bitLength()+1),this.hash=e.hash||e.curve.hash}t.exports=d,d.prototype.keyPair=function(e){return new c(this,e)},d.prototype.keyFromPrivate=function(e,t){return c.fromPrivate(this,e,t)},d.prototype.keyFromPublic=function(e,t){return c.fromPublic(this,e,t)},d.prototype.genKeyPair=function(e){e||(e={});for(var t=new i({hash:this.hash,pers:e.pers,persEnc:e.persEnc||"utf8",entropy:e.entropy||r(this.hash.hmacStrength),entropyEnc:e.entropy&&e.entropyEnc||"utf8",nonce:this.n.toArray()}),a=this.n.byteLength(),n=this.n.sub(new o(2));;){var s=new o(t.generate(a));if(!(s.cmp(n)>0))return s.iaddn(1),this.keyFromPrivate(s)}},d.prototype._truncateToN=function(e,t){var o=8*e.byteLength()-this.n.bitLength();return o>0&&(e=e.ushrn(o)),!t&&e.cmp(this.n)>=0?e.sub(this.n):e},d.prototype.sign=function(e,t,a,n){"object"==typeof a&&(n=a,a=null),n||(n={}),t=this.keyFromPrivate(t,a),e=this._truncateToN(new o(e,16));for(var r=this.n.byteLength(),s=t.getPrivate().toArray("be",r),c=e.toArray("be",r),d=new i({hash:this.hash,entropy:s,nonce:c,pers:n.pers,persEnc:n.persEnc||"utf8"}),u=this.n.sub(new o(1)),h=0;;h++){var p=n.k?n.k(h):new o(d.generate(this.n.byteLength()));if(!((p=this._truncateToN(p,!0)).cmpn(1)<=0||p.cmp(u)>=0)){var f=this.g.mul(p);if(!f.isInfinity()){var g=f.getX(),m=g.umod(this.n);if(0!==m.cmpn(0)){var _=p.invm(this.n).mul(m.mul(t.getPrivate()).iadd(e));if(0!==(_=_.umod(this.n)).cmpn(0)){var y=(f.getY().isOdd()?1:0)|(0!==g.cmp(m)?2:0);return n.canonical&&_.cmp(this.nh)>0&&(_=this.n.sub(_),y^=1),new l({r:m,s:_,recoveryParam:y})}}}}}},d.prototype.verify=function(e,t,i,a){e=this._truncateToN(new o(e,16)),i=this.keyFromPublic(i,a);var n=(t=new l(t,"hex")).r,r=t.s;if(n.cmpn(1)<0||n.cmp(this.n)>=0)return!1;if(r.cmpn(1)<0||r.cmp(this.n)>=0)return!1;var s,c=r.invm(this.n),d=c.mul(e).umod(this.n),u=c.mul(n).umod(this.n);return this.curve._maxwellTrick?!(s=this.g.jmulAdd(d,i.getPublic(),u)).isInfinity()&&s.eqXToP(n):!(s=this.g.mulAdd(d,i.getPublic(),u)).isInfinity()&&0===s.getX().umod(this.n).cmp(n)},d.prototype.recoverPubKey=function(e,t,i,a){s((3&i)===i,"The recovery param is more than two bits"),t=new l(t,a);var n=this.n,r=new o(e),c=t.r,d=t.s,u=1&i,h=i>>1;if(c.cmp(this.curve.p.umod(this.curve.n))>=0&&h)throw new Error("Unable to find sencond key candinate");c=h?this.curve.pointFromX(c.add(this.curve.n),u):this.curve.pointFromX(c,u);var p=t.r.invm(n),f=n.sub(r).mul(p).umod(n),g=d.mul(p).umod(n);return this.g.mulAdd(f,c,g)},d.prototype.getKeyRecoveryParam=function(e,t,o,i){if(null!==(t=new l(t,i)).recoveryParam)return t.recoveryParam;for(var a=0;a<4;a++){var n;try{n=this.recoverPubKey(e,t,a)}catch(e){continue}if(n.eq(o))return a}throw new Error("Unable to find valid recovery factor")}},{"../curves":94,"../utils":102,"./key":96,"./signature":97,"bn.js":103,brorand:18,"hmac-drbg":137}],96:[function(e,t){"use strict";var o=e("bn.js"),i=e("../utils").assert;function a(e,t){this.ec=e,this.priv=null,this.pub=null,t.priv&&this._importPrivate(t.priv,t.privEnc),t.pub&&this._importPublic(t.pub,t.pubEnc)}t.exports=a,a.fromPublic=function(e,t,o){return t instanceof a?t:new a(e,{pub:t,pubEnc:o})},a.fromPrivate=function(e,t,o){return t instanceof a?t:new a(e,{priv:t,privEnc:o})},a.prototype.validate=function(){var e=this.getPublic();return e.isInfinity()?{result:!1,reason:"Invalid public key"}:e.validate()?e.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},a.prototype.getPublic=function(e,t){return"string"==typeof e&&(t=e,e=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),t?this.pub.encode(t,e):this.pub},a.prototype.getPrivate=function(e){return"hex"===e?this.priv.toString(16,2):this.priv},a.prototype._importPrivate=function(e,t){this.priv=new o(e,t||16),this.priv=this.priv.umod(this.ec.curve.n)},a.prototype._importPublic=function(e,t){if(e.x||e.y)return"mont"===this.ec.curve.type?i(e.x,"Need x coordinate"):"short"!==this.ec.curve.type&&"edwards"!==this.ec.curve.type||i(e.x&&e.y,"Need both x and y coordinate"),void(this.pub=this.ec.curve.point(e.x,e.y));this.pub=this.ec.curve.decodePoint(e,t)},a.prototype.derive=function(e){return e.mul(this.priv).getX()},a.prototype.sign=function(e,t,o){return this.ec.sign(e,this,t,o)},a.prototype.verify=function(e,t){return this.ec.verify(e,t,this)},a.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"}},{"../utils":102,"bn.js":103}],97:[function(e,t){"use strict";var o=e("bn.js"),i=e("../utils"),a=i.assert;function n(e,t){if(e instanceof n)return e;this._importDER(e,t)||(a(e.r&&e.s,"Signature without r or s"),this.r=new o(e.r,16),this.s=new o(e.s,16),void 0===e.recoveryParam?this.recoveryParam=null:this.recoveryParam=e.recoveryParam)}function r(){this.place=0}function s(e,t){var o=e[t.place++];if(!(128&o))return o;var i=15&o;if(0===i||i>4)return!1;for(var a=0,n=0,r=t.place;n<i;n++,r++)a<<=8,a|=e[r],a>>>=0;return!(a<=127)&&(t.place=r,a)}function c(e){for(var t=0,o=e.length-1;!e[t]&&!(128&e[t+1])&&t<o;)t++;return 0===t?e:e.slice(t)}function l(e,t){if(t<128)e.push(t);else{var o=1+(Math.log(t)/Math.LN2>>>3);for(e.push(128|o);--o;)e.push(t>>>(o<<3)&255);e.push(t)}}t.exports=n,n.prototype._importDER=function(e,t){e=i.toArray(e,t);var a=new r;if(48!==e[a.place++])return!1;var n=s(e,a);if(!1===n)return!1;if(n+a.place!==e.length)return!1;if(2!==e[a.place++])return!1;var c=s(e,a);if(!1===c)return!1;var l=e.slice(a.place,c+a.place);if(a.place+=c,2!==e[a.place++])return!1;var d=s(e,a);if(!1===d)return!1;if(e.length!==d+a.place)return!1;var u=e.slice(a.place,d+a.place);if(0===l[0]){if(!(128&l[1]))return!1;l=l.slice(1)}if(0===u[0]){if(!(128&u[1]))return!1;u=u.slice(1)}return this.r=new o(l),this.s=new o(u),this.recoveryParam=null,!0},n.prototype.toDER=function(e){var t=this.r.toArray(),o=this.s.toArray();for(128&t[0]&&(t=[0].concat(t)),128&o[0]&&(o=[0].concat(o)),t=c(t),o=c(o);!(o[0]||128&o[1]);)o=o.slice(1);var a=[2];l(a,t.length),(a=a.concat(t)).push(2),l(a,o.length);var n=a.concat(o),r=[48];return l(r,n.length),r=r.concat(n),i.encode(r,e)}},{"../utils":102,"bn.js":103}],98:[function(e,t){"use strict";var o=e("hash.js"),i=e("../curves"),a=e("../utils"),n=a.assert,r=a.parseBytes,s=e("./key"),c=e("./signature");function l(e){if(n("ed25519"===e,"only tested with ed25519 so far"),!(this instanceof l))return new l(e);e=i[e].curve,this.curve=e,this.g=e.g,this.g.precompute(e.n.bitLength()+1),this.pointClass=e.point().constructor,this.encodingLength=Math.ceil(e.n.bitLength()/8),this.hash=o.sha512}t.exports=l,l.prototype.sign=function(e,t){e=r(e);var o=this.keyFromSecret(t),i=this.hashInt(o.messagePrefix(),e),a=this.g.mul(i),n=this.encodePoint(a),s=this.hashInt(n,o.pubBytes(),e).mul(o.priv()),c=i.add(s).umod(this.curve.n);return this.makeSignature({R:a,S:c,Rencoded:n})},l.prototype.verify=function(e,t,o){e=r(e),t=this.makeSignature(t);var i=this.keyFromPublic(o),a=this.hashInt(t.Rencoded(),i.pubBytes(),e),n=this.g.mul(t.S());return t.R().add(i.pub().mul(a)).eq(n)},l.prototype.hashInt=function(){for(var e=this.hash(),t=0;t<arguments.length;t++)e.update(arguments[t]);return a.intFromLE(e.digest()).umod(this.curve.n)},l.prototype.keyFromPublic=function(e){return s.fromPublic(this,e)},l.prototype.keyFromSecret=function(e){return s.fromSecret(this,e)},l.prototype.makeSignature=function(e){return e instanceof c?e:new c(this,e)},l.prototype.encodePoint=function(e){var t=e.getY().toArray("le",this.encodingLength);return t[this.encodingLength-1]|=e.getX().isOdd()?128:0,t},l.prototype.decodePoint=function(e){var t=(e=a.parseBytes(e)).length-1,o=e.slice(0,t).concat(-129&e[t]),i=0!=(128&e[t]),n=a.intFromLE(o);return this.curve.pointFromY(n,i)},l.prototype.encodeInt=function(e){return e.toArray("le",this.encodingLength)},l.prototype.decodeInt=function(e){return a.intFromLE(e)},l.prototype.isPoint=function(e){return e instanceof this.pointClass}},{"../curves":94,"../utils":102,"./key":99,"./signature":100,"hash.js":125}],99:[function(e,t){"use strict";var o=e("../utils"),i=o.assert,a=o.parseBytes,n=o.cachedProperty;function r(e,t){this.eddsa=e,this._secret=a(t.secret),e.isPoint(t.pub)?this._pub=t.pub:this._pubBytes=a(t.pub)}r.fromPublic=function(e,t){return t instanceof r?t:new r(e,{pub:t})},r.fromSecret=function(e,t){return t instanceof r?t:new r(e,{secret:t})},r.prototype.secret=function(){return this._secret},n(r,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())}),n(r,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())}),n(r,"privBytes",function(){var e=this.eddsa,t=this.hash(),o=e.encodingLength-1,i=t.slice(0,e.encodingLength);return i[0]&=248,i[o]&=127,i[o]|=64,i}),n(r,"priv",function(){return this.eddsa.decodeInt(this.privBytes())}),n(r,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()}),n(r,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)}),r.prototype.sign=function(e){return i(this._secret,"KeyPair can only verify"),this.eddsa.sign(e,this)},r.prototype.verify=function(e,t){return this.eddsa.verify(e,t,this)},r.prototype.getSecret=function(e){return i(this._secret,"KeyPair is public only"),o.encode(this.secret(),e)},r.prototype.getPublic=function(e){return o.encode(this.pubBytes(),e)},t.exports=r},{"../utils":102}],100:[function(e,t){"use strict";var o=e("bn.js"),i=e("../utils"),a=i.assert,n=i.cachedProperty,r=i.parseBytes;function s(e,t){this.eddsa=e,"object"!=typeof t&&(t=r(t)),Array.isArray(t)&&(t={R:t.slice(0,e.encodingLength),S:t.slice(e.encodingLength)}),a(t.R&&t.S,"Signature without R or S"),e.isPoint(t.R)&&(this._R=t.R),t.S instanceof o&&(this._S=t.S),this._Rencoded=Array.isArray(t.R)?t.R:t.Rencoded,this._Sencoded=Array.isArray(t.S)?t.S:t.Sencoded}n(s,"S",function(){return this.eddsa.decodeInt(this.Sencoded())}),n(s,"R",function(){return this.eddsa.decodePoint(this.Rencoded())}),n(s,"Rencoded",function(){return this.eddsa.encodePoint(this.R())}),n(s,"Sencoded",function(){return this.eddsa.encodeInt(this.S())}),s.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())},s.prototype.toHex=function(){return i.encode(this.toBytes(),"hex").toUpperCase()},t.exports=s},{"../utils":102,"bn.js":103}],101:[function(e,t){t.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}},{}],102:[function(e,t,o){"use strict";var i=o,a=e("bn.js"),n=e("minimalistic-assert"),r=e("minimalistic-crypto-utils");i.assert=n,i.toArray=r.toArray,i.zero2=r.zero2,i.toHex=r.toHex,i.encode=r.encode,i.getNAF=function(e,t,o){var i=new Array(Math.max(e.bitLength(),o)+1);i.fill(0);for(var a=1<<t+1,n=e.clone(),r=0;r<i.length;r++){var s,c=n.andln(a-1);n.isOdd()?(s=c>(a>>1)-1?(a>>1)-c:c,n.isubn(s)):s=0,i[r]=s,n.iushrn(1)}return i},i.getJSF=function(e,t){var o=[[],[]];e=e.clone(),t=t.clone();for(var i=0,a=0;e.cmpn(-i)>0||t.cmpn(-a)>0;){var n,r,s,c=e.andln(3)+i&3,l=t.andln(3)+a&3;3===c&&(c=-1),3===l&&(l=-1),n=0==(1&c)?0:3!=(s=e.andln(7)+i&7)&&5!==s||2!==l?c:-c,o[0].push(n),r=0==(1&l)?0:3!=(s=t.andln(7)+a&7)&&5!==s||2!==c?l:-l,o[1].push(r),2*i===n+1&&(i=1-i),2*a===r+1&&(a=1-a),e.iushrn(1),t.iushrn(1)}return o},i.cachedProperty=function(e,t,o){var i="_"+t;e.prototype[t]=function(){return void 0!==this[i]?this[i]:this[i]=o.call(this)}},i.parseBytes=function(e){return"string"==typeof e?i.toArray(e,"hex"):e},i.intFromLE=function(e){return new a(e,"hex","le")}},{"bn.js":103,"minimalistic-assert":145,"minimalistic-crypto-utils":146}],103:[function(e,t,o){arguments[4][15][0].apply(o,arguments)},{buffer:19,dup:15}],104:[function(e,t){t.exports={_from:"elliptic@^6.5.2",_id:"elliptic@6.5.3",_inBundle:!1,_integrity:"sha512-IMqzv5wNQf+E6aHeIqATs0tOLeOTwj1QKbRcS3jBbYkl5oLAserA8yJTT7/VyHUYG91PRmPyeQDObKLPpeS4dw==",_location:"/elliptic",_phantomChildren:{},_requested:{type:"range",registry:!0,raw:"elliptic@^6.5.2",name:"elliptic",escapedName:"elliptic",rawSpec:"^6.5.2",saveSpec:null,fetchSpec:"^6.5.2"},_requiredBy:["/browserify-sign","/create-ecdh"],_resolved:"https://registry.npmjs.org/elliptic/-/elliptic-6.5.3.tgz",_shasum:"cb59eb2efdaf73a0bd78ccd7015a62ad6e0f93d6",_spec:"elliptic@^6.5.2",_where:"F:\\jenkins\\workspace\\Creator_2D\\fireball\\windows\\fireball\\dist\\resources\\app\\node_modules\\browserify-sign",author:{name:"Fedor Indutny",email:"fedor@indutny.com"},bugs:{url:"https://github.com/indutny/elliptic/issues"},bundleDependencies:!1,dependencies:{"bn.js":"^4.4.0",brorand:"^1.0.1","hash.js":"^1.0.0","hmac-drbg":"^1.0.0",inherits:"^2.0.1","minimalistic-assert":"^1.0.0","minimalistic-crypto-utils":"^1.0.0"},deprecated:!1,description:"EC cryptography",devDependencies:{brfs:"^1.4.3",coveralls:"^3.0.8",grunt:"^1.0.4","grunt-browserify":"^5.0.0","grunt-cli":"^1.2.0","grunt-contrib-connect":"^1.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-uglify":"^1.0.1","grunt-mocha-istanbul":"^3.0.1","grunt-saucelabs":"^9.0.1",istanbul:"^0.4.2",jscs:"^3.0.7",jshint:"^2.10.3",mocha:"^6.2.2"},files:["lib"],homepage:"https://github.com/indutny/elliptic",keywords:["EC","Elliptic","curve","Cryptography"],license:"MIT",main:"lib/elliptic.js",name:"elliptic",repository:{type:"git",url:"git+ssh://git@github.com/indutny/elliptic.git"},scripts:{jscs:"jscs benchmarks/*.js lib/*.js lib/**/*.js lib/**/**/*.js test/index.js",jshint:"jscs benchmarks/*.js lib/*.js lib/**/*.js lib/**/**/*.js test/index.js",lint:"npm run jscs && npm run jshint",test:"npm run lint && npm run unit",unit:"istanbul test _mocha --reporter=spec test/index.js",version:"grunt dist && git add dist/"},version:"6.5.3"}},{}],105:[function(e,t){function o(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function i(e){return"function"==typeof e}function a(e){return"object"==typeof e&&null!==e}function n(e){return void 0===e}t.exports=o,o.EventEmitter=o,o.prototype._events=void 0,o.prototype._maxListeners=void 0,o.defaultMaxListeners=10,o.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},o.prototype.emit=function(e){var t,o,r,s,c,l;if(this._events||(this._events={}),"error"===e&&(!this._events.error||a(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var d=new Error('Uncaught, unspecified "error" event. ('+t+")");throw d.context=t,d}if(n(o=this._events[e]))return!1;if(i(o))switch(arguments.length){case 1:o.call(this);break;case 2:o.call(this,arguments[1]);break;case 3:o.call(this,arguments[1],arguments[2]);break;default:s=Array.prototype.slice.call(arguments,1),o.apply(this,s)}else if(a(o))for(s=Array.prototype.slice.call(arguments,1),r=(l=o.slice()).length,c=0;c<r;c++)l[c].apply(this,s);return!0},o.prototype.addListener=function(e,t){var r;if(!i(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,i(t.listener)?t.listener:t),this._events[e]?a(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,a(this._events[e])&&!this._events[e].warned&&(r=n(this._maxListeners)?o.defaultMaxListeners:this._maxListeners)&&r>0&&this._events[e].length>r&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},o.prototype.on=o.prototype.addListener,o.prototype.once=function(e,t){if(!i(t))throw TypeError("listener must be a function");var o=!1;function a(){this.removeListener(e,a),o||(o=!0,t.apply(this,arguments))}return a.listener=t,this.on(e,a),this},o.prototype.removeListener=function(e,t){var o,n,r,s;if(!i(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(r=(o=this._events[e]).length,n=-1,o===t||i(o.listener)&&o.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(a(o)){for(s=r;s-- >0;)if(o[s]===t||o[s].listener&&o[s].listener===t){n=s;break}if(n<0)return this;1===o.length?(o.length=0,delete this._events[e]):o.splice(n,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},o.prototype.removeAllListeners=function(e){var t,o;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(i(o=this._events[e]))this.removeListener(e,o);else if(o)for(;o.length;)this.removeListener(e,o[o.length-1]);return delete this._events[e],this},o.prototype.listeners=function(e){return this._events&&this._events[e]?i(this._events[e])?[this._events[e]]:this._events[e].slice():[]},o.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(i(t))return 1;if(t)return t.length}return 0},o.listenerCount=function(e,t){return e.listenerCount(t)}},{}],106:[function(e,t){var o=e("safe-buffer").Buffer,i=e("md5.js");t.exports=function(e,t,a,n){if(o.isBuffer(e)||(e=o.from(e,"binary")),t&&(o.isBuffer(t)||(t=o.from(t,"binary")),8!==t.length))throw new RangeError("salt should be Buffer with 8 byte length");for(var r=a/8,s=o.alloc(r),c=o.alloc(n||0),l=o.alloc(0);r>0||n>0;){var d=new i;d.update(l),d.update(e),t&&d.update(t),l=d.digest();var u=0;if(r>0){var h=s.length-r;u=Math.min(r,l.length),l.copy(s,h,0,u),r-=u}if(u<l.length&&n>0){var p=c.length-n,f=Math.min(n,l.length-u);l.copy(c,p,u,u+f),n-=f}}return l.fill(0),{key:s,iv:c}}},{"md5.js":142,"safe-buffer":185}],107:[function(e,t){"use strict";var o=e("safe-buffer").Buffer,i=e("readable-stream").Transform;function a(e,t){if(!o.isBuffer(e)&&"string"!=typeof e)throw new TypeError(t+" must be a string or a buffer")}function n(e){i.call(this),this._block=o.allocUnsafe(e),this._blockSize=e,this._blockOffset=0,this._length=[0,0,0,0],this._finalized=!1}e("inherits")(n,i),n.prototype._transform=function(e,t,o){var i=null;try{this.update(e,t)}catch(a){i=a}o(i)},n.prototype._flush=function(e){var t=null;try{this.push(this.digest())}catch(o){t=o}e(t)},n.prototype.update=function(e,t){if(a(e,"Data"),this._finalized)throw new Error("Digest already called");o.isBuffer(e)||(e=o.from(e,t));for(var i=this._block,n=0;this._blockOffset+e.length-n>=this._blockSize;){for(var r=this._blockOffset;r<this._blockSize;)i[r++]=e[n++];this._update(),this._blockOffset=0}for(;n<e.length;)i[this._blockOffset++]=e[n++];for(var s=0,c=8*e.length;c>0;++s)this._length[s]+=c,(c=this._length[s]/4294967296|0)>0&&(this._length[s]-=4294967296*c);return this},n.prototype._update=function(){throw new Error("_update is not implemented")},n.prototype.digest=function(e){if(this._finalized)throw new Error("Digest already called");this._finalized=!0;var t=this._digest();void 0!==e&&(t=t.toString(e)),this._block.fill(0),this._blockOffset=0;for(var o=0;o<4;++o)this._length[o]=0;return t},n.prototype._digest=function(){throw new Error("_digest is not implemented")},t.exports=n},{inherits:140,"readable-stream":122,"safe-buffer":123}],108:[function(e,t,o){arguments[4][48][0].apply(o,arguments)},{dup:48}],109:[function(e,t,o){arguments[4][49][0].apply(o,arguments)},{"./_stream_readable":111,"./_stream_writable":113,_process:159,dup:49,inherits:140}],110:[function(e,t,o){arguments[4][50][0].apply(o,arguments)},{"./_stream_transform":112,dup:50,inherits:140}],111:[function(e,t,o){arguments[4][51][0].apply(o,arguments)},{"../errors":108,"./_stream_duplex":109,"./internal/streams/async_iterator":114,"./internal/streams/buffer_list":115,"./internal/streams/destroy":116,"./internal/streams/from":118,"./internal/streams/state":120,"./internal/streams/stream":121,_process:159,buffer:66,dup:51,events:105,inherits:140,"string_decoder/":124,util:19}],112:[function(e,t,o){arguments[4][52][0].apply(o,arguments)},{"../errors":108,"./_stream_duplex":109,dup:52,inherits:140}],113:[function(e,t,o){arguments[4][53][0].apply(o,arguments)},{"../errors":108,"./_stream_duplex":109,"./internal/streams/destroy":116,"./internal/streams/state":120,"./internal/streams/stream":121,_process:159,buffer:66,dup:53,inherits:140,"util-deprecate":196}],114:[function(e,t,o){arguments[4][54][0].apply(o,arguments)},{"./end-of-stream":117,_process:159,dup:54}],115:[function(e,t,o){arguments[4][55][0].apply(o,arguments)},{buffer:66,dup:55,util:19}],116:[function(e,t,o){arguments[4][56][0].apply(o,arguments)},{_process:159,dup:56}],117:[function(e,t,o){arguments[4][57][0].apply(o,arguments)},{"../../../errors":108,dup:57}],118:[function(e,t,o){arguments[4][58][0].apply(o,arguments)},{dup:58}],119:[function(e,t,o){arguments[4][59][0].apply(o,arguments)},{"../../../errors":108,"./end-of-stream":117,dup:59}],120:[function(e,t,o){arguments[4][60][0].apply(o,arguments)},{"../../../errors":108,dup:60}],121:[function(e,t,o){arguments[4][61][0].apply(o,arguments)},{dup:61,events:105}],122:[function(e,t,o){arguments[4][62][0].apply(o,arguments)},{"./lib/_stream_duplex.js":109,"./lib/_stream_passthrough.js":110,"./lib/_stream_readable.js":111,"./lib/_stream_transform.js":112,"./lib/_stream_writable.js":113,"./lib/internal/streams/end-of-stream.js":117,"./lib/internal/streams/pipeline.js":119,dup:62}],123:[function(e,t,o){arguments[4][63][0].apply(o,arguments)},{buffer:66,dup:63}],124:[function(e,t,o){arguments[4][64][0].apply(o,arguments)},{dup:64,"safe-buffer":123}],125:[function(e,t,o){var i=o;i.utils=e("./hash/utils"),i.common=e("./hash/common"),i.sha=e("./hash/sha"),i.ripemd=e("./hash/ripemd"),i.hmac=e("./hash/hmac"),i.sha1=i.sha.sha1,i.sha256=i.sha.sha256,i.sha224=i.sha.sha224,i.sha384=i.sha.sha384,i.sha512=i.sha.sha512,i.ripemd160=i.ripemd.ripemd160},{"./hash/common":126,"./hash/hmac":127,"./hash/ripemd":128,"./hash/sha":129,"./hash/utils":136}],126:[function(e,t,o){"use strict";var i=e("./utils"),a=e("minimalistic-assert");function n(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}o.BlockHash=n,n.prototype.update=function(e,t){if(e=i.toArray(e,t),this.pending?this.pending=this.pending.concat(e):this.pending=e,this.pendingTotal+=e.length,this.pending.length>=this._delta8){var o=(e=this.pending).length%this._delta8;this.pending=e.slice(e.length-o,e.length),0===this.pending.length&&(this.pending=null),e=i.join32(e,0,e.length-o,this.endian);for(var a=0;a<e.length;a+=this._delta32)this._update(e,a,a+this._delta32)}return this},n.prototype.digest=function(e){return this.update(this._pad()),a(null===this.pending),this._digest(e)},n.prototype._pad=function(){var e=this.pendingTotal,t=this._delta8,o=t-(e+this.padLength)%t,i=new Array(o+this.padLength);i[0]=128;for(var a=1;a<o;a++)i[a]=0;if(e<<=3,"big"===this.endian){for(var n=8;n<this.padLength;n++)i[a++]=0;i[a++]=0,i[a++]=0,i[a++]=0,i[a++]=0,i[a++]=e>>>24&255,i[a++]=e>>>16&255,i[a++]=e>>>8&255,i[a++]=255&e}else for(i[a++]=255&e,i[a++]=e>>>8&255,i[a++]=e>>>16&255,i[a++]=e>>>24&255,i[a++]=0,i[a++]=0,i[a++]=0,i[a++]=0,n=8;n<this.padLength;n++)i[a++]=0;return i}},{"./utils":136,"minimalistic-assert":145}],127:[function(e,t){"use strict";var o=e("./utils"),i=e("minimalistic-assert");function a(e,t,i){if(!(this instanceof a))return new a(e,t,i);this.Hash=e,this.blockSize=e.blockSize/8,this.outSize=e.outSize/8,this.inner=null,this.outer=null,this._init(o.toArray(t,i))}t.exports=a,a.prototype._init=function(e){e.length>this.blockSize&&(e=(new this.Hash).update(e).digest()),i(e.length<=this.blockSize);for(var t=e.length;t<this.blockSize;t++)e.push(0);for(t=0;t<e.length;t++)e[t]^=54;for(this.inner=(new this.Hash).update(e),t=0;t<e.length;t++)e[t]^=106;this.outer=(new this.Hash).update(e)},a.prototype.update=function(e,t){return this.inner.update(e,t),this},a.prototype.digest=function(e){return this.outer.update(this.inner.digest()),this.outer.digest(e)}},{"./utils":136,"minimalistic-assert":145}],128:[function(e,t,o){"use strict";var i=e("./utils"),a=e("./common"),n=i.rotl32,r=i.sum32,s=i.sum32_3,c=i.sum32_4,l=a.BlockHash;function d(){if(!(this instanceof d))return new d;l.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}function u(e,t,o,i){return e<=15?t^o^i:e<=31?t&o|~t&i:e<=47?(t|~o)^i:e<=63?t&i|o&~i:t^(o|~i)}function h(e){return e<=15?0:e<=31?1518500249:e<=47?1859775393:e<=63?2400959708:2840853838}function p(e){return e<=15?1352829926:e<=31?1548603684:e<=47?1836072691:e<=63?2053994217:0}i.inherits(d,l),o.ripemd160=d,d.blockSize=512,d.outSize=160,d.hmacStrength=192,d.padLength=64,d.prototype._update=function(e,t){for(var o=this.h[0],i=this.h[1],a=this.h[2],l=this.h[3],d=this.h[4],y=o,v=i,C=a,S=l,T=d,I=0;I<80;I++){var N=r(n(c(o,u(I,i,a,l),e[f[I]+t],h(I)),m[I]),d);o=d,d=l,l=n(a,10),a=i,i=N,N=r(n(c(y,u(79-I,v,C,S),e[g[I]+t],p(I)),_[I]),T),y=T,T=S,S=n(C,10),C=v,v=N}N=s(this.h[1],a,S),this.h[1]=s(this.h[2],l,T),this.h[2]=s(this.h[3],d,y),this.h[3]=s(this.h[4],o,v),this.h[4]=s(this.h[0],i,C),this.h[0]=N},d.prototype._digest=function(e){return"hex"===e?i.toHex32(this.h,"little"):i.split32(this.h,"little")};var f=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],g=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],m=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],_=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]},{"./common":126,"./utils":136}],129:[function(e,t,o){"use strict";o.sha1=e("./sha/1"),o.sha224=e("./sha/224"),o.sha256=e("./sha/256"),o.sha384=e("./sha/384"),o.sha512=e("./sha/512")},{"./sha/1":130,"./sha/224":131,"./sha/256":132,"./sha/384":133,"./sha/512":134}],130:[function(e,t){"use strict";var o=e("../utils"),i=e("../common"),a=e("./common"),n=o.rotl32,r=o.sum32,s=o.sum32_5,c=a.ft_1,l=i.BlockHash,d=[1518500249,1859775393,2400959708,3395469782];function u(){if(!(this instanceof u))return new u;l.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}o.inherits(u,l),t.exports=u,u.blockSize=512,u.outSize=160,u.hmacStrength=80,u.padLength=64,u.prototype._update=function(e,t){for(var o=this.W,i=0;i<16;i++)o[i]=e[t+i];for(;i<o.length;i++)o[i]=n(o[i-3]^o[i-8]^o[i-14]^o[i-16],1);var a=this.h[0],l=this.h[1],u=this.h[2],h=this.h[3],p=this.h[4];for(i=0;i<o.length;i++){var f=~~(i/20),g=s(n(a,5),c(f,l,u,h),p,o[i],d[f]);p=h,h=u,u=n(l,30),l=a,a=g}this.h[0]=r(this.h[0],a),this.h[1]=r(this.h[1],l),this.h[2]=r(this.h[2],u),this.h[3]=r(this.h[3],h),this.h[4]=r(this.h[4],p)},u.prototype._digest=function(e){return"hex"===e?o.toHex32(this.h,"big"):o.split32(this.h,"big")}},{"../common":126,"../utils":136,"./common":135}],131:[function(e,t){"use strict";var o=e("../utils"),i=e("./256");function a(){if(!(this instanceof a))return new a;i.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}o.inherits(a,i),t.exports=a,a.blockSize=512,a.outSize=224,a.hmacStrength=192,a.padLength=64,a.prototype._digest=function(e){return"hex"===e?o.toHex32(this.h.slice(0,7),"big"):o.split32(this.h.slice(0,7),"big")}},{"../utils":136,"./256":132}],132:[function(e,t){"use strict";var o=e("../utils"),i=e("../common"),a=e("./common"),n=e("minimalistic-assert"),r=o.sum32,s=o.sum32_4,c=o.sum32_5,l=a.ch32,d=a.maj32,u=a.s0_256,h=a.s1_256,p=a.g0_256,f=a.g1_256,g=i.BlockHash,m=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function _(){if(!(this instanceof _))return new _;g.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=m,this.W=new Array(64)}o.inherits(_,g),t.exports=_,_.blockSize=512,_.outSize=256,_.hmacStrength=192,_.padLength=64,_.prototype._update=function(e,t){for(var o=this.W,i=0;i<16;i++)o[i]=e[t+i];for(;i<o.length;i++)o[i]=s(f(o[i-2]),o[i-7],p(o[i-15]),o[i-16]);var a=this.h[0],g=this.h[1],m=this.h[2],_=this.h[3],y=this.h[4],v=this.h[5],C=this.h[6],S=this.h[7];for(n(this.k.length===o.length),i=0;i<o.length;i++){var T=c(S,h(y),l(y,v,C),this.k[i],o[i]),I=r(u(a),d(a,g,m));S=C,C=v,v=y,y=r(_,T),_=m,m=g,g=a,a=r(T,I)}this.h[0]=r(this.h[0],a),this.h[1]=r(this.h[1],g),this.h[2]=r(this.h[2],m),this.h[3]=r(this.h[3],_),this.h[4]=r(this.h[4],y),this.h[5]=r(this.h[5],v),this.h[6]=r(this.h[6],C),this.h[7]=r(this.h[7],S)},_.prototype._digest=function(e){return"hex"===e?o.toHex32(this.h,"big"):o.split32(this.h,"big")}},{"../common":126,"../utils":136,"./common":135,"minimalistic-assert":145}],133:[function(e,t){"use strict";var o=e("../utils"),i=e("./512");function a(){if(!(this instanceof a))return new a;i.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}o.inherits(a,i),t.exports=a,a.blockSize=1024,a.outSize=384,a.hmacStrength=192,a.padLength=128,a.prototype._digest=function(e){return"hex"===e?o.toHex32(this.h.slice(0,12),"big"):o.split32(this.h.slice(0,12),"big")}},{"../utils":136,"./512":134}],134:[function(e,t){"use strict";var o=e("../utils"),i=e("../common"),a=e("minimalistic-assert"),n=o.rotr64_hi,r=o.rotr64_lo,s=o.shr64_hi,c=o.shr64_lo,l=o.sum64,d=o.sum64_hi,u=o.sum64_lo,h=o.sum64_4_hi,p=o.sum64_4_lo,f=o.sum64_5_hi,g=o.sum64_5_lo,m=i.BlockHash,_=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function y(){if(!(this instanceof y))return new y;m.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=_,this.W=new Array(160)}function v(e,t,o,i,a){var n=e&o^~e&a;return n<0&&(n+=4294967296),n}function C(e,t,o,i,a,n){var r=t&i^~t&n;return r<0&&(r+=4294967296),r}function S(e,t,o,i,a){var n=e&o^e&a^o&a;return n<0&&(n+=4294967296),n}function T(e,t,o,i,a,n){var r=t&i^t&n^i&n;return r<0&&(r+=4294967296),r}function I(e,t){var o=n(e,t,28)^n(t,e,2)^n(t,e,7);return o<0&&(o+=4294967296),o}function N(e,t){var o=r(e,t,28)^r(t,e,2)^r(t,e,7);return o<0&&(o+=4294967296),o}function b(e,t){var o=r(e,t,14)^r(e,t,18)^r(t,e,9);return o<0&&(o+=4294967296),o}function w(e,t){var o=n(e,t,1)^n(e,t,8)^s(e,t,7);return o<0&&(o+=4294967296),o}function E(e,t){var o=r(e,t,1)^r(e,t,8)^c(e,t,7);return o<0&&(o+=4294967296),o}function P(e,t){var o=r(e,t,19)^r(t,e,29)^c(e,t,6);return o<0&&(o+=4294967296),o}o.inherits(y,m),t.exports=y,y.blockSize=1024,y.outSize=512,y.hmacStrength=192,y.padLength=128,y.prototype._prepareBlock=function(e,t){for(var o=this.W,i=0;i<32;i++)o[i]=e[t+i];for(;i<o.length;i+=2){var a=(m=o[i-4],_=o[i-3],y=void 0,(y=n(m,_,19)^n(_,m,29)^s(m,_,6))<0&&(y+=4294967296),y),r=P(o[i-4],o[i-3]),c=o[i-14],l=o[i-13],d=w(o[i-30],o[i-29]),u=E(o[i-30],o[i-29]),f=o[i-32],g=o[i-31];o[i]=h(a,r,c,l,d,u,f,g),o[i+1]=p(a,r,c,l,d,u,f,g)}var m,_,y},y.prototype._update=function(e,t){this._prepareBlock(e,t);var o,i,r,s=this.W,c=this.h[0],h=this.h[1],p=this.h[2],m=this.h[3],_=this.h[4],y=this.h[5],w=this.h[6],E=this.h[7],P=this.h[8],R=this.h[9],L=this.h[10],A=this.h[11],D=this.h[12],M=this.h[13],B=this.h[14],k=this.h[15];a(this.k.length===s.length);for(var G=0;G<s.length;G+=2){var O=B,H=k,V=(r=void 0,(r=n(o=P,i=R,14)^n(o,i,18)^n(i,o,9))<0&&(r+=4294967296),r),F=b(P,R),U=v(P,0,L,0,D),x=C(0,R,0,A,0,M),Y=this.k[G],j=this.k[G+1],W=s[G],z=s[G+1],K=f(O,H,V,F,U,x,Y,j,W,z),q=g(O,H,V,F,U,x,Y,j,W,z);O=I(c,h),H=N(c,h),V=S(c,0,p,0,_),F=T(0,h,0,m,0,y);var Q=d(O,H,V,F),X=u(O,H,V,F);B=D,k=M,D=L,M=A,L=P,A=R,P=d(w,E,K,q),R=u(E,E,K,q),w=_,E=y,_=p,y=m,p=c,m=h,c=d(K,q,Q,X),h=u(K,q,Q,X)}l(this.h,0,c,h),l(this.h,2,p,m),l(this.h,4,_,y),l(this.h,6,w,E),l(this.h,8,P,R),l(this.h,10,L,A),l(this.h,12,D,M),l(this.h,14,B,k)},y.prototype._digest=function(e){return"hex"===e?o.toHex32(this.h,"big"):o.split32(this.h,"big")}},{"../common":126,"../utils":136,"minimalistic-assert":145}],135:[function(e,t,o){"use strict";var i=e("../utils").rotr32;function a(e,t,o){return e&t^~e&o}function n(e,t,o){return e&t^e&o^t&o}function r(e,t,o){return e^t^o}o.ft_1=function(e,t,o,i){return 0===e?a(t,o,i):1===e||3===e?r(t,o,i):2===e?n(t,o,i):void 0},o.ch32=a,o.maj32=n,o.p32=r,o.s0_256=function(e){return i(e,2)^i(e,13)^i(e,22)},o.s1_256=function(e){return i(e,6)^i(e,11)^i(e,25)},o.g0_256=function(e){return i(e,7)^i(e,18)^e>>>3},o.g1_256=function(e){return i(e,17)^i(e,19)^e>>>10}},{"../utils":136}],136:[function(e,t,o){"use strict";var i=e("minimalistic-assert"),a=e("inherits");function n(e,t){return 55296==(64512&e.charCodeAt(t))&&!(t<0||t+1>=e.length)&&56320==(64512&e.charCodeAt(t+1))}function r(e){return(e>>>24|e>>>8&65280|e<<8&16711680|(255&e)<<24)>>>0}function s(e){return 1===e.length?"0"+e:e}function c(e){return 7===e.length?"0"+e:6===e.length?"00"+e:5===e.length?"000"+e:4===e.length?"0000"+e:3===e.length?"00000"+e:2===e.length?"000000"+e:1===e.length?"0000000"+e:e}o.inherits=a,o.toArray=function(e,t){if(Array.isArray(e))return e.slice();if(!e)return[];var o=[];if("string"==typeof e)if(t){if("hex"===t)for((e=e.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(e="0"+e),a=0;a<e.length;a+=2)o.push(parseInt(e[a]+e[a+1],16))}else for(var i=0,a=0;a<e.length;a++){var r=e.charCodeAt(a);r<128?o[i++]=r:r<2048?(o[i++]=r>>6|192,o[i++]=63&r|128):n(e,a)?(r=65536+((1023&r)<<10)+(1023&e.charCodeAt(++a)),o[i++]=r>>18|240,o[i++]=r>>12&63|128,o[i++]=r>>6&63|128,o[i++]=63&r|128):(o[i++]=r>>12|224,o[i++]=r>>6&63|128,o[i++]=63&r|128)}else for(a=0;a<e.length;a++)o[a]=0|e[a];return o},o.toHex=function(e){for(var t="",o=0;o<e.length;o++)t+=s(e[o].toString(16));return t},o.htonl=r,o.toHex32=function(e,t){for(var o="",i=0;i<e.length;i++){var a=e[i];"little"===t&&(a=r(a)),o+=c(a.toString(16))}return o},o.zero2=s,o.zero8=c,o.join32=function(e,t,o,a){var n=o-t;i(n%4==0);for(var r=new Array(n/4),s=0,c=t;s<r.length;s++,c+=4){var l;l="big"===a?e[c]<<24|e[c+1]<<16|e[c+2]<<8|e[c+3]:e[c+3]<<24|e[c+2]<<16|e[c+1]<<8|e[c],r[s]=l>>>0}return r},o.split32=function(e,t){for(var o=new Array(4*e.length),i=0,a=0;i<e.length;i++,a+=4){var n=e[i];"big"===t?(o[a]=n>>>24,o[a+1]=n>>>16&255,o[a+2]=n>>>8&255,o[a+3]=255&n):(o[a+3]=n>>>24,o[a+2]=n>>>16&255,o[a+1]=n>>>8&255,o[a]=255&n)}return o},o.rotr32=function(e,t){return e>>>t|e<<32-t},o.rotl32=function(e,t){return e<<t|e>>>32-t},o.sum32=function(e,t){return e+t>>>0},o.sum32_3=function(e,t,o){return e+t+o>>>0},o.sum32_4=function(e,t,o,i){return e+t+o+i>>>0},o.sum32_5=function(e,t,o,i,a){return e+t+o+i+a>>>0},o.sum64=function(e,t,o,i){var a=e[t],n=i+e[t+1]>>>0,r=(n<i?1:0)+o+a;e[t]=r>>>0,e[t+1]=n},o.sum64_hi=function(e,t,o,i){return(t+i>>>0<t?1:0)+e+o>>>0},o.sum64_lo=function(e,t,o,i){return t+i>>>0},o.sum64_4_hi=function(e,t,o,i,a,n,r,s){var c=0,l=t;return c+=(l=l+i>>>0)<t?1:0,c+=(l=l+n>>>0)<n?1:0,e+o+a+r+(c+=(l=l+s>>>0)<s?1:0)>>>0},o.sum64_4_lo=function(e,t,o,i,a,n,r,s){return t+i+n+s>>>0},o.sum64_5_hi=function(e,t,o,i,a,n,r,s,c,l){var d=0,u=t;return d+=(u=u+i>>>0)<t?1:0,d+=(u=u+n>>>0)<n?1:0,d+=(u=u+s>>>0)<s?1:0,e+o+a+r+c+(d+=(u=u+l>>>0)<l?1:0)>>>0},o.sum64_5_lo=function(e,t,o,i,a,n,r,s,c,l){return t+i+n+s+l>>>0},o.rotr64_hi=function(e,t,o){return(t<<32-o|e>>>o)>>>0},o.rotr64_lo=function(e,t,o){return(e<<32-o|t>>>o)>>>0},o.shr64_hi=function(e,t,o){return e>>>o},o.shr64_lo=function(e,t,o){return(e<<32-o|t>>>o)>>>0}},{inherits:140,"minimalistic-assert":145}],137:[function(e,t){"use strict";var o=e("hash.js"),i=e("minimalistic-crypto-utils"),a=e("minimalistic-assert");function n(e){if(!(this instanceof n))return new n(e);this.hash=e.hash,this.predResist=!!e.predResist,this.outLen=this.hash.outSize,this.minEntropy=e.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var t=i.toArray(e.entropy,e.entropyEnc||"hex"),o=i.toArray(e.nonce,e.nonceEnc||"hex"),r=i.toArray(e.pers,e.persEnc||"hex");a(t.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(t,o,r)}t.exports=n,n.prototype._init=function(e,t,o){var i=e.concat(t).concat(o);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var a=0;a<this.V.length;a++)this.K[a]=0,this.V[a]=1;this._update(i),this._reseed=1,this.reseedInterval=281474976710656},n.prototype._hmac=function(){return new o.hmac(this.hash,this.K)},n.prototype._update=function(e){var t=this._hmac().update(this.V).update([0]);e&&(t=t.update(e)),this.K=t.digest(),this.V=this._hmac().update(this.V).digest(),e&&(this.K=this._hmac().update(this.V).update([1]).update(e).digest(),this.V=this._hmac().update(this.V).digest())},n.prototype.reseed=function(e,t,o,n){"string"!=typeof t&&(n=o,o=t,t=null),e=i.toArray(e,t),o=i.toArray(o,n),a(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(e.concat(o||[])),this._reseed=1},n.prototype.generate=function(e,t,o,a){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");"string"!=typeof t&&(a=o,o=t,t=null),o&&(o=i.toArray(o,a||"hex"),this._update(o));for(var n=[];n.length<e;)this.V=this._hmac().update(this.V).digest(),n=n.concat(this.V);var r=n.slice(0,e);return this._update(o),this._reseed++,i.encode(r,t)}},{"hash.js":125,"minimalistic-assert":145,"minimalistic-crypto-utils":146}],138:[function(e,t,o){o.read=function(e,t,o,i,a){var n,r,s=8*a-i-1,c=(1<<s)-1,l=c>>1,d=-7,u=o?a-1:0,h=o?-1:1,p=e[t+u];for(u+=h,n=p&(1<<-d)-1,p>>=-d,d+=s;d>0;n=256*n+e[t+u],u+=h,d-=8);for(r=n&(1<<-d)-1,n>>=-d,d+=i;d>0;r=256*r+e[t+u],u+=h,d-=8);if(0===n)n=1-l;else{if(n===c)return r?NaN:1/0*(p?-1:1);r+=Math.pow(2,i),n-=l}return(p?-1:1)*r*Math.pow(2,n-i)},o.write=function(e,t,o,i,a,n){var r,s,c,l=8*n-a-1,d=(1<<l)-1,u=d>>1,h=23===a?Math.pow(2,-24)-Math.pow(2,-77):0,p=i?0:n-1,f=i?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,r=d):(r=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-r))<1&&(r--,c*=2),(t+=r+u>=1?h/c:h*Math.pow(2,1-u))*c>=2&&(r++,c/=2),r+u>=d?(s=0,r=d):r+u>=1?(s=(t*c-1)*Math.pow(2,a),r+=u):(s=t*Math.pow(2,u-1)*Math.pow(2,a),r=0));a>=8;e[o+p]=255&s,p+=f,s/=256,a-=8);for(r=r<<a|s,l+=a;l>0;e[o+p]=255&r,p+=f,r/=256,l-=8);e[o+p-f]|=128*g}},{}],139:[function(e,t){var o=[].indexOf;t.exports=function(e,t){if(o)return e.indexOf(t);for(var i=0;i<e.length;++i)if(e[i]===t)return i;return-1}},{}],140:[function(e,t){"function"==typeof Object.create?t.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:t.exports=function(e,t){if(t){e.super_=t;var o=function(){};o.prototype=t.prototype,e.prototype=new o,e.prototype.constructor=e}}},{}],141:[function(e,t){function o(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}function i(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&o(e.slice(0,0))}t.exports=function(e){return null!=e&&(o(e)||i(e)||!!e._isBuffer)}},{}],142:[function(e,t){"use strict";var o=e("inherits"),i=e("hash-base"),a=e("safe-buffer").Buffer,n=new Array(16);function r(){i.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878}function s(e,t){return e<<t|e>>>32-t}function c(e,t,o,i,a,n,r){return s(e+(t&o|~t&i)+a+n|0,r)+t|0}function l(e,t,o,i,a,n,r){return s(e+(t&i|o&~i)+a+n|0,r)+t|0}function d(e,t,o,i,a,n,r){return s(e+(t^o^i)+a+n|0,r)+t|0}function u(e,t,o,i,a,n,r){return s(e+(o^(t|~i))+a+n|0,r)+t|0}o(r,i),r.prototype._update=function(){for(var e=n,t=0;t<16;++t)e[t]=this._block.readInt32LE(4*t);var o=this._a,i=this._b,a=this._c,r=this._d;o=c(o,i,a,r,e[0],3614090360,7),r=c(r,o,i,a,e[1],3905402710,12),a=c(a,r,o,i,e[2],606105819,17),i=c(i,a,r,o,e[3],3250441966,22),o=c(o,i,a,r,e[4],4118548399,7),r=c(r,o,i,a,e[5],1200080426,12),a=c(a,r,o,i,e[6],2821735955,17),i=c(i,a,r,o,e[7],4249261313,22),o=c(o,i,a,r,e[8],1770035416,7),r=c(r,o,i,a,e[9],2336552879,12),a=c(a,r,o,i,e[10],4294925233,17),i=c(i,a,r,o,e[11],2304563134,22),o=c(o,i,a,r,e[12],1804603682,7),r=c(r,o,i,a,e[13],4254626195,12),a=c(a,r,o,i,e[14],2792965006,17),o=l(o,i=c(i,a,r,o,e[15],1236535329,22),a,r,e[1],4129170786,5),r=l(r,o,i,a,e[6],3225465664,9),a=l(a,r,o,i,e[11],643717713,14),i=l(i,a,r,o,e[0],3921069994,20),o=l(o,i,a,r,e[5],3593408605,5),r=l(r,o,i,a,e[10],38016083,9),a=l(a,r,o,i,e[15],3634488961,14),i=l(i,a,r,o,e[4],3889429448,20),o=l(o,i,a,r,e[9],568446438,5),r=l(r,o,i,a,e[14],3275163606,9),a=l(a,r,o,i,e[3],4107603335,14),i=l(i,a,r,o,e[8],1163531501,20),o=l(o,i,a,r,e[13],2850285829,5),r=l(r,o,i,a,e[2],4243563512,9),a=l(a,r,o,i,e[7],1735328473,14),o=d(o,i=l(i,a,r,o,e[12],2368359562,20),a,r,e[5],4294588738,4),r=d(r,o,i,a,e[8],2272392833,11),a=d(a,r,o,i,e[11],1839030562,16),i=d(i,a,r,o,e[14],4259657740,23),o=d(o,i,a,r,e[1],2763975236,4),r=d(r,o,i,a,e[4],1272893353,11),a=d(a,r,o,i,e[7],4139469664,16),i=d(i,a,r,o,e[10],3200236656,23),o=d(o,i,a,r,e[13],681279174,4),r=d(r,o,i,a,e[0],3936430074,11),a=d(a,r,o,i,e[3],3572445317,16),i=d(i,a,r,o,e[6],76029189,23),o=d(o,i,a,r,e[9],3654602809,4),r=d(r,o,i,a,e[12],3873151461,11),a=d(a,r,o,i,e[15],530742520,16),o=u(o,i=d(i,a,r,o,e[2],3299628645,23),a,r,e[0],4096336452,6),r=u(r,o,i,a,e[7],1126891415,10),a=u(a,r,o,i,e[14],2878612391,15),i=u(i,a,r,o,e[5],4237533241,21),o=u(o,i,a,r,e[12],1700485571,6),r=u(r,o,i,a,e[3],2399980690,10),a=u(a,r,o,i,e[10],4293915773,15),i=u(i,a,r,o,e[1],2240044497,21),o=u(o,i,a,r,e[8],1873313359,6),r=u(r,o,i,a,e[15],4264355552,10),a=u(a,r,o,i,e[6],2734768916,15),i=u(i,a,r,o,e[13],1309151649,21),o=u(o,i,a,r,e[4],4149444226,6),r=u(r,o,i,a,e[11],3174756917,10),a=u(a,r,o,i,e[2],718787259,15),i=u(i,a,r,o,e[9],3951481745,21),this._a=this._a+o|0,this._b=this._b+i|0,this._c=this._c+a|0,this._d=this._d+r|0},r.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var e=a.allocUnsafe(16);return e.writeInt32LE(this._a,0),e.writeInt32LE(this._b,4),e.writeInt32LE(this._c,8),e.writeInt32LE(this._d,12),e},t.exports=r},{"hash-base":107,inherits:140,"safe-buffer":185}],143:[function(e,t){var o=e("bn.js"),i=e("brorand");function a(e){this.rand=e||new i.Rand}t.exports=a,a.create=function(e){return new a(e)},a.prototype._randbelow=function(e){var t=e.bitLength(),i=Math.ceil(t/8);do{var a=new o(this.rand.generate(i))}while(a.cmp(e)>=0);return a},a.prototype._randrange=function(e,t){var o=t.sub(e);return e.add(this._randbelow(o))},a.prototype.test=function(e,t,i){var a=e.bitLength(),n=o.mont(e),r=new o(1).toRed(n);t||(t=Math.max(1,a/48|0));for(var s=e.subn(1),c=0;!s.testn(c);c++);for(var l=e.shrn(c),d=s.toRed(n);t>0;t--){var u=this._randrange(new o(2),s);i&&i(u);var h=u.toRed(n).redPow(l);if(0!==h.cmp(r)&&0!==h.cmp(d)){for(var p=1;p<c;p++){if(0===(h=h.redSqr()).cmp(r))return!1;if(0===h.cmp(d))break}if(p===c)return!1}}return!0},a.prototype.getDivisor=function(e,t){var i=e.bitLength(),a=o.mont(e),n=new o(1).toRed(a);t||(t=Math.max(1,i/48|0));for(var r=e.subn(1),s=0;!r.testn(s);s++);for(var c=e.shrn(s),l=r.toRed(a);t>0;t--){var d=this._randrange(new o(2),r),u=e.gcd(d);if(0!==u.cmpn(1))return u;var h=d.toRed(a).redPow(c);if(0!==h.cmp(n)&&0!==h.cmp(l)){for(var p=1;p<s;p++){if(0===(h=h.redSqr()).cmp(n))return h.fromRed().subn(1).gcd(e);if(0===h.cmp(l))break}if(p===s)return(h=h.redSqr()).fromRed().subn(1).gcd(e)}}return!1}},{"bn.js":144,brorand:18}],144:[function(e,t,o){arguments[4][15][0].apply(o,arguments)},{buffer:19,dup:15}],145:[function(e,t){function o(e,t){if(!e)throw new Error(t||"Assertion failed")}t.exports=o,o.equal=function(e,t,o){if(e!=t)throw new Error(o||"Assertion failed: "+e+" != "+t)}},{}],146:[function(e,t,o){"use strict";var i=o;function a(e){return 1===e.length?"0"+e:e}function n(e){for(var t="",o=0;o<e.length;o++)t+=a(e[o].toString(16));return t}i.toArray=function(e,t){if(Array.isArray(e))return e.slice();if(!e)return[];var o=[];if("string"!=typeof e){for(var i=0;i<e.length;i++)o[i]=0|e[i];return o}if("hex"===t)for((e=e.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(e="0"+e),i=0;i<e.length;i+=2)o.push(parseInt(e[i]+e[i+1],16));else for(i=0;i<e.length;i++){var a=e.charCodeAt(i),n=a>>8,r=255&a;n?o.push(n,r):o.push(r)}return o},i.zero2=a,i.toHex=n,i.encode=function(e,t){return"hex"===t?n(e):e}},{}],147:[function(e,t){t.exports={"2.16.840.1.101.3.4.1.1":"aes-128-ecb","2.16.840.1.101.3.4.1.2":"aes-128-cbc","2.16.840.1.101.3.4.1.3":"aes-128-ofb","2.16.840.1.101.3.4.1.4":"aes-128-cfb","2.16.840.1.101.3.4.1.21":"aes-192-ecb","2.16.840.1.101.3.4.1.22":"aes-192-cbc","2.16.840.1.101.3.4.1.23":"aes-192-ofb","2.16.840.1.101.3.4.1.24":"aes-192-cfb","2.16.840.1.101.3.4.1.41":"aes-256-ecb","2.16.840.1.101.3.4.1.42":"aes-256-cbc","2.16.840.1.101.3.4.1.43":"aes-256-ofb","2.16.840.1.101.3.4.1.44":"aes-256-cfb"}},{}],148:[function(e,t,o){"use strict";var i=e("asn1.js");o.certificate=e("./certificate");var a=i.define("RSAPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("modulus").int(),this.key("publicExponent").int(),this.key("privateExponent").int(),this.key("prime1").int(),this.key("prime2").int(),this.key("exponent1").int(),this.key("exponent2").int(),this.key("coefficient").int())});o.RSAPrivateKey=a;var n=i.define("RSAPublicKey",function(){this.seq().obj(this.key("modulus").int(),this.key("publicExponent").int())});o.RSAPublicKey=n;var r=i.define("SubjectPublicKeyInfo",function(){this.seq().obj(this.key("algorithm").use(s),this.key("subjectPublicKey").bitstr())});o.PublicKey=r;var s=i.define("AlgorithmIdentifier",function(){this.seq().obj(this.key("algorithm").objid(),this.key("none").null_().optional(),this.key("curve").objid().optional(),this.key("params").seq().obj(this.key("p").int(),this.key("q").int(),this.key("g").int()).optional())}),c=i.define("PrivateKeyInfo",function(){this.seq().obj(this.key("version").int(),this.key("algorithm").use(s),this.key("subjectPrivateKey").octstr())});o.PrivateKey=c;var l=i.define("EncryptedPrivateKeyInfo",function(){this.seq().obj(this.key("algorithm").seq().obj(this.key("id").objid(),this.key("decrypt").seq().obj(this.key("kde").seq().obj(this.key("id").objid(),this.key("kdeparams").seq().obj(this.key("salt").octstr(),this.key("iters").int())),this.key("cipher").seq().obj(this.key("algo").objid(),this.key("iv").octstr()))),this.key("subjectPrivateKey").octstr())});o.EncryptedPrivateKey=l;var d=i.define("DSAPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("p").int(),this.key("q").int(),this.key("g").int(),this.key("pub_key").int(),this.key("priv_key").int())});o.DSAPrivateKey=d,o.DSAparam=i.define("DSAparam",function(){this.int()});var u=i.define("ECPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("privateKey").octstr(),this.key("parameters").optional().explicit(0).use(h),this.key("publicKey").optional().explicit(1).bitstr())});o.ECPrivateKey=u;var h=i.define("ECParameters",function(){this.choice({namedCurve:this.objid()})});o.signature=i.define("signature",function(){this.seq().obj(this.key("r").int(),this.key("s").int())})},{"./certificate":149,"asn1.js":1}],149:[function(e,t){"use strict";var o=e("asn1.js"),i=o.define("Time",function(){this.choice({utcTime:this.utctime(),generalTime:this.gentime()})}),a=o.define("AttributeTypeValue",function(){this.seq().obj(this.key("type").objid(),this.key("value").any())}),n=o.define("AlgorithmIdentifier",function(){this.seq().obj(this.key("algorithm").objid(),this.key("parameters").optional(),this.key("curve").objid().optional())}),r=o.define("SubjectPublicKeyInfo",function(){this.seq().obj(this.key("algorithm").use(n),this.key("subjectPublicKey").bitstr())}),s=o.define("RelativeDistinguishedName",function(){this.setof(a)}),c=o.define("RDNSequence",function(){this.seqof(s)}),l=o.define("Name",function(){this.choice({rdnSequence:this.use(c)})}),d=o.define("Validity",function(){this.seq().obj(this.key("notBefore").use(i),this.key("notAfter").use(i))}),u=o.define("Extension",function(){this.seq().obj(this.key("extnID").objid(),this.key("critical").bool().def(!1),this.key("extnValue").octstr())}),h=o.define("TBSCertificate",function(){this.seq().obj(this.key("version").explicit(0).int().optional(),this.key("serialNumber").int(),this.key("signature").use(n),this.key("issuer").use(l),this.key("validity").use(d),this.key("subject").use(l),this.key("subjectPublicKeyInfo").use(r),this.key("issuerUniqueID").implicit(1).bitstr().optional(),this.key("subjectUniqueID").implicit(2).bitstr().optional(),this.key("extensions").explicit(3).seqof(u).optional())}),p=o.define("X509Certificate",function(){this.seq().obj(this.key("tbsCertificate").use(h),this.key("signatureAlgorithm").use(n),this.key("signatureValue").bitstr())});t.exports=p},{"asn1.js":1}],150:[function(e,t){var o=/Proc-Type: 4,ENCRYPTED[\n\r]+DEK-Info: AES-((?:128)|(?:192)|(?:256))-CBC,([0-9A-H]+)[\n\r]+([0-9A-z\n\r\+\/\=]+)[\n\r]+/m,i=/^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----/m,a=/^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----([0-9A-z\n\r\+\/\=]+)-----END \1-----$/m,n=e("evp_bytestokey"),r=e("browserify-aes"),s=e("safe-buffer").Buffer;t.exports=function(e,t){var c,l=e.toString(),d=l.match(o);if(d){var u="aes"+d[1],h=s.from(d[2],"hex"),p=s.from(d[3].replace(/[\r\n]/g,""),"base64"),f=n(t,h.slice(0,8),parseInt(d[1],10)).key,g=[],m=r.createDecipheriv(u,f,h);g.push(m.update(p)),g.push(m.final()),c=s.concat(g)}else{var _=l.match(a);c=new s(_[2].replace(/[\r\n]/g,""),"base64")}return{tag:l.match(i)[1],data:c}}},{"browserify-aes":22,evp_bytestokey:106,"safe-buffer":185}],151:[function(e,t){var o=e("./asn1"),i=e("./aesid.json"),a=e("./fixProc"),n=e("browserify-aes"),r=e("pbkdf2"),s=e("safe-buffer").Buffer;function c(e){var t;"object"!=typeof e||s.isBuffer(e)||(t=e.passphrase,e=e.key),"string"==typeof e&&(e=s.from(e));var i,n,r=a(e,t),c=r.tag,d=r.data;switch(c){case"CERTIFICATE":n=o.certificate.decode(d,"der").tbsCertificate.subjectPublicKeyInfo;case"PUBLIC KEY":switch(n||(n=o.PublicKey.decode(d,"der")),i=n.algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return o.RSAPublicKey.decode(n.subjectPublicKey.data,"der");case"1.2.840.10045.2.1":return n.subjectPrivateKey=n.subjectPublicKey,{type:"ec",data:n};case"1.2.840.10040.4.1":return n.algorithm.params.pub_key=o.DSAparam.decode(n.subjectPublicKey.data,"der"),{type:"dsa",data:n.algorithm.params};default:throw new Error("unknown key id "+i)}throw new Error("unknown key type "+c);case"ENCRYPTED PRIVATE KEY":d=l(d=o.EncryptedPrivateKey.decode(d,"der"),t);case"PRIVATE KEY":switch(i=(n=o.PrivateKey.decode(d,"der")).algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return o.RSAPrivateKey.decode(n.subjectPrivateKey,"der");case"1.2.840.10045.2.1":return{curve:n.algorithm.curve,privateKey:o.ECPrivateKey.decode(n.subjectPrivateKey,"der").privateKey};case"1.2.840.10040.4.1":return n.algorithm.params.priv_key=o.DSAparam.decode(n.subjectPrivateKey,"der"),{type:"dsa",params:n.algorithm.params};default:throw new Error("unknown key id "+i)}throw new Error("unknown key type "+c);case"RSA PUBLIC KEY":return o.RSAPublicKey.decode(d,"der");case"RSA PRIVATE KEY":return o.RSAPrivateKey.decode(d,"der");case"DSA PRIVATE KEY":return{type:"dsa",params:o.DSAPrivateKey.decode(d,"der")};case"EC PRIVATE KEY":return{curve:(d=o.ECPrivateKey.decode(d,"der")).parameters.value,privateKey:d.privateKey};default:throw new Error("unknown key type "+c)}}function l(e,t){var o=e.algorithm.decrypt.kde.kdeparams.salt,a=parseInt(e.algorithm.decrypt.kde.kdeparams.iters.toString(),10),c=i[e.algorithm.decrypt.cipher.algo.join(".")],l=e.algorithm.decrypt.cipher.iv,d=e.subjectPrivateKey,u=parseInt(c.split("-")[1],10)/8,h=r.pbkdf2Sync(t,o,a,u,"sha1"),p=n.createDecipheriv(c,h,l),f=[];return f.push(p.update(d)),f.push(p.final()),s.concat(f)}t.exports=c,c.signature=o.signature},{"./aesid.json":147,"./asn1":148,"./fixProc":150,"browserify-aes":22,pbkdf2:152,"safe-buffer":185}],152:[function(e,t,o){o.pbkdf2=e("./lib/async"),o.pbkdf2Sync=e("./lib/sync")},{"./lib/async":153,"./lib/sync":156}],153:[function(e,t){(function(o,i){var a,n=e("safe-buffer").Buffer,r=e("./precondition"),s=e("./default-encoding"),c=e("./sync"),l=e("./to-buffer"),d=i.crypto&&i.crypto.subtle,u={sha:"SHA-1","sha-1":"SHA-1",sha1:"SHA-1",sha256:"SHA-256","sha-256":"SHA-256",sha384:"SHA-384","sha-384":"SHA-384","sha-512":"SHA-512",sha512:"SHA-512"},h=[];function p(e){if(i.process&&!i.process.browser)return Promise.resolve(!1);if(!d||!d.importKey||!d.deriveBits)return Promise.resolve(!1);if(void 0!==h[e])return h[e];var t=f(a=a||n.alloc(8),a,10,128,e).then(function(){return!0}).catch(function(){return!1});return h[e]=t,t}function f(e,t,o,i,a){return d.importKey("raw",e,{name:"PBKDF2"},!1,["deriveBits"]).then(function(e){return d.deriveBits({name:"PBKDF2",salt:t,iterations:o,hash:{name:a}},e,i<<3)}).then(function(e){return n.from(e)})}function g(e,t){e.then(function(e){o.nextTick(function(){t(null,e)})},function(e){o.nextTick(function(){t(e)})})}t.exports=function(e,t,a,n,d,h){"function"==typeof d&&(h=d,d=void 0);var m=u[(d=d||"sha1").toLowerCase()];if(!m||"function"!=typeof i.Promise)return o.nextTick(function(){var o;try{o=c(e,t,a,n,d)}catch(i){return h(i)}h(null,o)});if(r(a,n),e=l(e,s,"Password"),t=l(t,s,"Salt"),"function"!=typeof h)throw new Error("No callback provided to pbkdf2");g(p(m).then(function(o){return o?f(e,t,a,n,m):c(e,t,a,n,d)}),h)}}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./default-encoding":154,"./precondition":155,"./sync":156,"./to-buffer":157,_process:159,"safe-buffer":185}],154:[function(e,t){(function(e){var o;o=e.browser?"utf-8":e.version?parseInt(e.version.split(".")[0].slice(1),10)>=6?"utf-8":"binary":"utf-8",t.exports=o}).call(this,e("_process"))},{_process:159}],155:[function(e,t){var o=Math.pow(2,30)-1;t.exports=function(e,t){if("number"!=typeof e)throw new TypeError("Iterations not a number");if(e<0)throw new TypeError("Bad iterations");if("number"!=typeof t)throw new TypeError("Key length not a number");if(t<0||t>o||t!=t)throw new TypeError("Bad key length")}},{}],156:[function(e,t){var o=e("create-hash/md5"),i=e("ripemd160"),a=e("sha.js"),n=e("safe-buffer").Buffer,r=e("./precondition"),s=e("./default-encoding"),c=e("./to-buffer"),l=n.alloc(128),d={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,rmd160:20,ripemd160:20};function u(e,t,o){var i=h(e),a="sha512"===e||"sha384"===e?128:64;t.length>a?t=i(t):t.length<a&&(t=n.concat([t,l],a));for(var r=n.allocUnsafe(a+d[e]),s=n.allocUnsafe(a+d[e]),c=0;c<a;c++)r[c]=54^t[c],s[c]=92^t[c];var u=n.allocUnsafe(a+o+4);r.copy(u,0,0,a),this.ipad1=u,this.ipad2=r,this.opad=s,this.alg=e,this.blocksize=a,this.hash=i,this.size=d[e]}function h(e){return"rmd160"===e||"ripemd160"===e?function(e){return(new i).update(e).digest()}:"md5"===e?o:function(t){return a(e).update(t).digest()}}u.prototype.run=function(e,t){return e.copy(t,this.blocksize),this.hash(t).copy(this.opad,this.blocksize),this.hash(this.opad)},t.exports=function(e,t,o,i,a){r(o,i);var l=new u(a=a||"sha1",e=c(e,s,"Password"),(t=c(t,s,"Salt")).length),h=n.allocUnsafe(i),p=n.allocUnsafe(t.length+4);t.copy(p,0,0,t.length);for(var f=0,g=d[a],m=Math.ceil(i/g),_=1;_<=m;_++){p.writeUInt32BE(_,t.length);for(var y=l.run(p,l.ipad1),v=y,C=1;C<o;C++){v=l.run(v,l.ipad2);for(var S=0;S<g;S++)y[S]^=v[S]}y.copy(h,f),f+=g}return h}},{"./default-encoding":154,"./precondition":155,"./to-buffer":157,"create-hash/md5":73,ripemd160:184,"safe-buffer":185,"sha.js":187}],157:[function(e,t){var o=e("safe-buffer").Buffer;t.exports=function(e,t,i){if(o.isBuffer(e))return e;if("string"==typeof e)return o.from(e,t);if(ArrayBuffer.isView(e))return o.from(e.buffer);throw new TypeError(i+" must be a string, a Buffer, a typed array or a DataView")}},{"safe-buffer":185}],158:[function(e,t){(function(e){"use strict";void 0===e||!e.version||0===e.version.indexOf("v0.")||0===e.version.indexOf("v1.")&&0!==e.version.indexOf("v1.8.")?t.exports={nextTick:function(t,o,i,a){if("function"!=typeof t)throw new TypeError('"callback" argument must be a function');var n,r,s=arguments.length;switch(s){case 0:case 1:return e.nextTick(t);case 2:return e.nextTick(function(){t.call(null,o)});case 3:return e.nextTick(function(){t.call(null,o,i)});case 4:return e.nextTick(function(){t.call(null,o,i,a)});default:for(n=new Array(s-1),r=0;r<n.length;)n[r++]=arguments[r];return e.nextTick(function(){t.apply(null,n)})}}}:t.exports=e}).call(this,e("_process"))},{_process:159}],159:[function(e,t){var o,i,a=t.exports={};function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function s(e){if(o===setTimeout)return setTimeout(e,0);if((o===n||!o)&&setTimeout)return o=setTimeout,setTimeout(e,0);try{return o(e,0)}catch(t){try{return o.call(null,e,0)}catch(t){return o.call(this,e,0)}}}function c(e){if(i===clearTimeout)return clearTimeout(e);if((i===r||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{return i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(function(){try{o="function"==typeof setTimeout?setTimeout:n}catch(e){o=n}try{i="function"==typeof clearTimeout?clearTimeout:r}catch(e){i=r}})();var l,d=[],u=!1,h=-1;function p(){u&&l&&(u=!1,l.length?d=l.concat(d):h=-1,d.length&&f())}function f(){if(!u){var e=s(p);u=!0;for(var t=d.length;t;){for(l=d,d=[];++h<t;)l&&l[h].run();h=-1,t=d.length}l=null,u=!1,c(e)}}function g(e,t){this.fun=e,this.array=t}function m(){}a.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var o=1;o<arguments.length;o++)t[o-1]=arguments[o];d.push(new g(e,t)),1!==d.length||u||s(f)},g.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=m,a.addListener=m,a.once=m,a.off=m,a.removeListener=m,a.removeAllListeners=m,a.emit=m,a.prependListener=m,a.prependOnceListener=m,a.listeners=function(){return[]},a.binding=function(){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(){throw new Error("process.chdir is not supported")},a.umask=function(){return 0}},{}],160:[function(e,t,o){o.publicEncrypt=e("./publicEncrypt"),o.privateDecrypt=e("./privateDecrypt"),o.privateEncrypt=function(e,t){return o.publicEncrypt(e,t,!0)},o.publicDecrypt=function(e,t){return o.privateDecrypt(e,t,!0)}},{"./privateDecrypt":163,"./publicEncrypt":164}],161:[function(e,t){var o=e("create-hash"),i=e("safe-buffer").Buffer;function a(e){var t=i.allocUnsafe(4);return t.writeUInt32BE(e,0),t}t.exports=function(e,t){for(var n,r=i.alloc(0),s=0;r.length<t;)n=a(s++),r=i.concat([r,o("sha1").update(e).update(n).digest()]);return r.slice(0,t)}},{"create-hash":72,"safe-buffer":185}],162:[function(e,t,o){arguments[4][15][0].apply(o,arguments)},{buffer:19,dup:15}],163:[function(e,t){var o=e("parse-asn1"),i=e("./mgf"),a=e("./xor"),n=e("bn.js"),r=e("browserify-rsa"),s=e("create-hash"),c=e("./withPublic"),l=e("safe-buffer").Buffer;function d(e,t){var o=e.modulus.byteLength(),n=s("sha1").update(l.alloc(0)).digest(),r=n.length;if(0!==t[0])throw new Error("decryption error");var c=t.slice(1,r+1),d=t.slice(r+1),u=a(c,i(d,r)),p=a(d,i(u,o-r-1));if(h(n,p.slice(0,r)))throw new Error("decryption error");for(var f=r;0===p[f];)f++;if(1!==p[f++])throw new Error("decryption error");return p.slice(f)}function u(e,t,o){for(var i=t.slice(0,2),a=2,n=0;0!==t[a++];)if(a>=t.length){n++;break}var r=t.slice(2,a-1);if(("0002"!==i.toString("hex")&&!o||"0001"!==i.toString("hex")&&o)&&n++,r.length<8&&n++,n)throw new Error("decryption error");return t.slice(a)}function h(e,t){e=l.from(e),t=l.from(t);var o=0,i=e.length;e.length!==t.length&&(o++,i=Math.min(e.length,t.length));for(var a=-1;++a<i;)o+=e[a]^t[a];return o}t.exports=function(e,t,i){var a;a=e.padding?e.padding:i?1:4;var s,h=o(e),p=h.modulus.byteLength();if(t.length>p||new n(t).cmp(h.modulus)>=0)throw new Error("decryption error");s=i?c(new n(t),h):r(t,h);var f=l.alloc(p-s.length);if(s=l.concat([f,s],p),4===a)return d(h,s);if(1===a)return u(0,s,i);if(3===a)return s;throw new Error("unknown padding")}},{"./mgf":161,"./withPublic":165,"./xor":166,"bn.js":162,"browserify-rsa":40,"create-hash":72,"parse-asn1":151,"safe-buffer":185}],164:[function(e,t){var o=e("parse-asn1"),i=e("randombytes"),a=e("create-hash"),n=e("./mgf"),r=e("./xor"),s=e("bn.js"),c=e("./withPublic"),l=e("browserify-rsa"),d=e("safe-buffer").Buffer;function u(e,t){var o=e.modulus.byteLength(),c=t.length,l=a("sha1").update(d.alloc(0)).digest(),u=l.length,h=2*u;if(c>o-h-2)throw new Error("message too long");var p=d.alloc(o-c-h-2),f=o-u-1,g=i(u),m=r(d.concat([l,p,d.alloc(1,1),t],f),n(g,f)),_=r(g,n(m,u));return new s(d.concat([d.alloc(1),_,m],o))}function h(e,t,o){var i,a=t.length,n=e.modulus.byteLength();if(a>n-11)throw new Error("message too long");return i=o?d.alloc(n-a-3,255):p(n-a-3),new s(d.concat([d.from([0,o?1:2]),i,d.alloc(1),t],n))}function p(e){for(var t,o=d.allocUnsafe(e),a=0,n=i(2*e),r=0;a<e;)r===n.length&&(n=i(2*e),r=0),(t=n[r++])&&(o[a++]=t);return o}t.exports=function(e,t,i){var a;a=e.padding?e.padding:i?1:4;var n,r=o(e);if(4===a)n=u(r,t);else if(1===a)n=h(r,t,i);else{if(3!==a)throw new Error("unknown padding");if((n=new s(t)).cmp(r.modulus)>=0)throw new Error("data too long for modulus")}return i?l(n,r):c(n,r)}},{"./mgf":161,"./withPublic":165,"./xor":166,"bn.js":162,"browserify-rsa":40,"create-hash":72,"parse-asn1":151,randombytes:167,"safe-buffer":185}],165:[function(e,t){var o=e("bn.js"),i=e("safe-buffer").Buffer;t.exports=function(e,t){return i.from(e.toRed(o.mont(t.modulus)).redPow(new o(t.publicExponent)).fromRed().toArray())}},{"bn.js":162,"safe-buffer":185}],166:[function(e,t){t.exports=function(e,t){for(var o=e.length,i=-1;++i<o;)e[i]^=t[i];return e}},{}],167:[function(e,t){(function(o,i){"use strict";var a=e("safe-buffer").Buffer,n=i.crypto||i.msCrypto;n&&n.getRandomValues?t.exports=function(e,t){if(e>4294967295)throw new RangeError("requested too many random bytes");var i=a.allocUnsafe(e);if(e>0)if(e>65536)for(var r=0;r<e;r+=65536)n.getRandomValues(i.slice(r,r+65536));else n.getRandomValues(i);return"function"==typeof t?o.nextTick(function(){t(null,i)}):i}:t.exports=function(){throw new Error("Secure random number generation is not supported by this browser.\nUse Chrome, Firefox or Internet Explorer 11")}}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:159,"safe-buffer":185}],168:[function(e,t,o){(function(t,i){"use strict";function a(){throw new Error("secure random number generation not supported by this browser\nuse chrome, FireFox or Internet Explorer 11")}var n=e("safe-buffer"),r=e("randombytes"),s=n.Buffer,c=n.kMaxLength,l=i.crypto||i.msCrypto,d=Math.pow(2,32)-1;function u(e,t){if("number"!=typeof e||e!=e)throw new TypeError("offset must be a number");if(e>d||e<0)throw new TypeError("offset must be a uint32");if(e>c||e>t)throw new RangeError("offset out of range")}function h(e,t,o){if("number"!=typeof e||e!=e)throw new TypeError("size must be a number");if(e>d||e<0)throw new TypeError("size must be a uint32");if(e+t>o||e>c)throw new RangeError("buffer too small")}function p(e,o,i,a){if(t.browser){var n=e.buffer,s=new Uint8Array(n,o,i);return l.getRandomValues(s),a?void t.nextTick(function(){a(null,e)}):e}if(!a)return r(i).copy(e,o),e;r(i,function(t,i){if(t)return a(t);i.copy(e,o),a(null,e)})}l&&l.getRandomValues||!t.browser?(o.randomFill=function(e,t,o,a){if(!(s.isBuffer(e)||e instanceof i.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');if("function"==typeof t)a=t,t=0,o=e.length;else if("function"==typeof o)a=o,o=e.length-t;else if("function"!=typeof a)throw new TypeError('"cb" argument must be a function');return u(t,e.length),h(o,t,e.length),p(e,t,o,a)},o.randomFillSync=function(e,t,o){if(void 0===t&&(t=0),!(s.isBuffer(e)||e instanceof i.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');return u(t,e.length),void 0===o&&(o=e.length-t),h(o,t,e.length),p(e,t,o)}):(o.randomFill=a,o.randomFillSync=a)}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:159,randombytes:167,"safe-buffer":185}],169:[function(e,t){t.exports=e("./lib/_stream_duplex.js")},{"./lib/_stream_duplex.js":170}],170:[function(e,t){"use strict";var o=e("process-nextick-args"),i=Object.keys||function(e){var t=[];for(var o in e)t.push(o);return t};t.exports=d;var a=Object.create(e("core-util-is"));a.inherits=e("inherits");var n=e("./_stream_readable"),r=e("./_stream_writable");a.inherits(d,n);for(var s=i(r.prototype),c=0;c<s.length;c++){var l=s[c];d.prototype[l]||(d.prototype[l]=r.prototype[l])}function d(e){if(!(this instanceof d))return new d(e);n.call(this,e),r.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",u)}function u(){this.allowHalfOpen||this._writableState.ended||o.nextTick(h,this)}function h(e){e.end()}Object.defineProperty(d.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(d.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}),d.prototype._destroy=function(e,t){this.push(null),this.end(),o.nextTick(t,e)}},{"./_stream_readable":172,"./_stream_writable":174,"core-util-is":69,inherits:140,"process-nextick-args":158}],171:[function(e,t){"use strict";t.exports=a;var o=e("./_stream_transform"),i=Object.create(e("core-util-is"));function a(e){if(!(this instanceof a))return new a(e);o.call(this,e)}i.inherits=e("inherits"),i.inherits(a,o),a.prototype._transform=function(e,t,o){o(null,e)}},{"./_stream_transform":173,"core-util-is":69,inherits:140}],172:[function(e,t){(function(o,i){"use strict";var a=e("process-nextick-args");t.exports=S;var n,r=e("isarray");S.ReadableState=C,e("events").EventEmitter;var s=function(e,t){return e.listeners(t).length},c=e("./internal/streams/stream"),l=e("safe-buffer").Buffer,d=i.Uint8Array||function(){};function u(e){return l.from(e)}var h=Object.create(e("core-util-is"));h.inherits=e("inherits");var p=e("util"),f=void 0;f=p&&p.debuglog?p.debuglog("stream"):function(){};var g,m=e("./internal/streams/BufferList"),_=e("./internal/streams/destroy");h.inherits(S,c);var y=["error","close","destroy","pause","resume"];function v(e,t,o){if("function"==typeof e.prependListener)return e.prependListener(t,o);e._events&&e._events[t]?r(e._events[t])?e._events[t].unshift(o):e._events[t]=[o,e._events[t]]:e.on(t,o)}function C(t,o){t=t||{};var i=o instanceof(n=n||e("./_stream_duplex"));this.objectMode=!!t.objectMode,i&&(this.objectMode=this.objectMode||!!t.readableObjectMode);var a=t.highWaterMark,r=t.readableHighWaterMark,s=this.objectMode?16:16384;this.highWaterMark=a||0===a?a:i&&(r||0===r)?r:s,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new m,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(g||(g=e("string_decoder/").StringDecoder),this.decoder=new g(t.encoding),this.encoding=t.encoding)}function S(t){if(n=n||e("./_stream_duplex"),!(this instanceof S))return new S(t);this._readableState=new C(t,this),this.readable=!0,t&&("function"==typeof t.read&&(this._read=t.read),"function"==typeof t.destroy&&(this._destroy=t.destroy)),c.call(this)}function T(e,t,o,i,a){var n,r=e._readableState;return null===t?(r.reading=!1,R(e,r)):(a||(n=N(r,t)),n?e.emit("error",n):r.objectMode||t&&t.length>0?("string"==typeof t||r.objectMode||Object.getPrototypeOf(t)===l.prototype||(t=u(t)),i?r.endEmitted?e.emit("error",new Error("stream.unshift() after end event")):I(e,r,t,!0):r.ended?e.emit("error",new Error("stream.push() after EOF")):(r.reading=!1,r.decoder&&!o?(t=r.decoder.write(t),r.objectMode||0!==t.length?I(e,r,t,!1):D(e,r)):I(e,r,t,!1))):i||(r.reading=!1)),b(r)}function I(e,t,o,i){t.flowing&&0===t.length&&!t.sync?(e.emit("data",o),e.read(0)):(t.length+=t.objectMode?1:o.length,i?t.buffer.unshift(o):t.buffer.push(o),t.needReadable&&L(e)),D(e,t)}function N(e,t){var o,i;return i=t,l.isBuffer(i)||i instanceof d||"string"==typeof t||void 0===t||e.objectMode||(o=new TypeError("Invalid non-string/buffer chunk")),o}function b(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}Object.defineProperty(S.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),S.prototype.destroy=_.destroy,S.prototype._undestroy=_.undestroy,S.prototype._destroy=function(e,t){this.push(null),t(e)},S.prototype.push=function(e,t){var o,i=this._readableState;return i.objectMode?o=!0:"string"==typeof e&&((t=t||i.defaultEncoding)!==i.encoding&&(e=l.from(e,t),t=""),o=!0),T(this,e,t,!1,o)},S.prototype.unshift=function(e){return T(this,e,null,!0,!1)},S.prototype.isPaused=function(){return!1===this._readableState.flowing},S.prototype.setEncoding=function(t){return g||(g=e("string_decoder/").StringDecoder),this._readableState.decoder=new g(t),this._readableState.encoding=t,this};var w=8388608;function E(e){return e>=w?e=w:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}function P(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=E(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function R(e,t){if(!t.ended){if(t.decoder){var o=t.decoder.end();o&&o.length&&(t.buffer.push(o),t.length+=t.objectMode?1:o.length)}t.ended=!0,L(e)}}function L(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(f("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?a.nextTick(A,e):A(e))}function A(e){f("emit readable"),e.emit("readable"),H(e)}function D(e,t){t.readingMore||(t.readingMore=!0,a.nextTick(M,e,t))}function M(e,t){for(var o=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(f("maybeReadMore read 0"),e.read(0),o!==t.length);)o=t.length;t.readingMore=!1}function B(e){return function(){var t=e._readableState;f("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&s(e,"data")&&(t.flowing=!0,H(e))}}function k(e){f("readable nexttick read 0"),e.read(0)}function G(e,t){t.resumeScheduled||(t.resumeScheduled=!0,a.nextTick(O,e,t))}function O(e,t){t.reading||(f("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),H(e),t.flowing&&!t.reading&&e.read(0)}function H(e){var t=e._readableState;for(f("flow",t.flowing);t.flowing&&null!==e.read(););}function V(e,t){return 0===t.length?null:(t.objectMode?o=t.buffer.shift():!e||e>=t.length?(o=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):o=F(e,t.buffer,t.decoder),o);var o}function F(e,t,o){var i;return e<t.head.data.length?(i=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):i=e===t.head.data.length?t.shift():o?U(e,t):x(e,t),i}function U(e,t){var o=t.head,i=1,a=o.data;for(e-=a.length;o=o.next;){var n=o.data,r=e>n.length?n.length:e;if(r===n.length?a+=n:a+=n.slice(0,e),0==(e-=r)){r===n.length?(++i,o.next?t.head=o.next:t.head=t.tail=null):(t.head=o,o.data=n.slice(r));break}++i}return t.length-=i,a}function x(e,t){var o=l.allocUnsafe(e),i=t.head,a=1;for(i.data.copy(o),e-=i.data.length;i=i.next;){var n=i.data,r=e>n.length?n.length:e;if(n.copy(o,o.length-e,0,r),0==(e-=r)){r===n.length?(++a,i.next?t.head=i.next:t.head=t.tail=null):(t.head=i,i.data=n.slice(r));break}++a}return t.length-=a,o}function Y(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,a.nextTick(j,t,e))}function j(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function W(e,t){for(var o=0,i=e.length;o<i;o++)if(e[o]===t)return o;return-1}S.prototype.read=function(e){f("read",e),e=parseInt(e,10);var t=this._readableState,o=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return f("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?Y(this):L(this),null;if(0===(e=P(e,t))&&t.ended)return 0===t.length&&Y(this),null;var i,a=t.needReadable;return f("need readable",a),(0===t.length||t.length-e<t.highWaterMark)&&f("length less than watermark",a=!0),t.ended||t.reading?f("reading or ended",a=!1):a&&(f("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=P(o,t))),null===(i=e>0?V(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),o!==e&&t.ended&&Y(this)),null!==i&&this.emit("data",i),i},S.prototype._read=function(){this.emit("error",new Error("_read() is not implemented"))},S.prototype.pipe=function(e,t){var i=this,n=this._readableState;switch(n.pipesCount){case 0:n.pipes=e;break;case 1:n.pipes=[n.pipes,e];break;default:n.pipes.push(e)}n.pipesCount+=1,f("pipe count=%d opts=%j",n.pipesCount,t);var r=t&&!1===t.end||e===o.stdout||e===o.stderr?y:l;function c(t,o){f("onunpipe"),t===i&&o&&!1===o.hasUnpiped&&(o.hasUnpiped=!0,f("cleanup"),e.removeListener("close",m),e.removeListener("finish",_),e.removeListener("drain",d),e.removeListener("error",g),e.removeListener("unpipe",c),i.removeListener("end",l),i.removeListener("end",y),i.removeListener("data",p),u=!0,!n.awaitDrain||e._writableState&&!e._writableState.needDrain||d())}function l(){f("onend"),e.end()}n.endEmitted?a.nextTick(r):i.once("end",r),e.on("unpipe",c);var d=B(i);e.on("drain",d);var u=!1;var h=!1;function p(t){f("ondata"),h=!1,!1!==e.write(t)||h||((1===n.pipesCount&&n.pipes===e||n.pipesCount>1&&-1!==W(n.pipes,e))&&!u&&(f("false write response, pause",i._readableState.awaitDrain),i._readableState.awaitDrain++,h=!0),i.pause())}function g(t){f("onerror",t),y(),e.removeListener("error",g),0===s(e,"error")&&e.emit("error",t)}function m(){e.removeListener("finish",_),y()}function _(){f("onfinish"),e.removeListener("close",m),y()}function y(){f("unpipe"),i.unpipe(e)}return i.on("data",p),v(e,"error",g),e.once("close",m),e.once("finish",_),e.emit("pipe",i),n.flowing||(f("pipe resume"),i.resume()),e},S.prototype.unpipe=function(e){var t=this._readableState,o={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,o),this);if(!e){var i=t.pipes,a=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var n=0;n<a;n++)i[n].emit("unpipe",this,o);return this}var r=W(t.pipes,e);return-1===r?this:(t.pipes.splice(r,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,o),this)},S.prototype.on=function(e,t){var o=c.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var i=this._readableState;i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.emittedReadable=!1,i.reading?i.length&&L(this):a.nextTick(k,this))}return o},S.prototype.addListener=S.prototype.on,S.prototype.resume=function(){var e=this._readableState;return e.flowing||(f("resume"),e.flowing=!0,G(this,e)),this},S.prototype.pause=function(){return f("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(f("pause"),this._readableState.flowing=!1,this.emit("pause")),this},S.prototype.wrap=function(e){var t=this,o=this._readableState,i=!1;for(var a in e.on("end",function(){if(f("wrapped end"),o.decoder&&!o.ended){var e=o.decoder.end();e&&e.length&&t.push(e)}t.push(null)}),e.on("data",function(a){f("wrapped data"),o.decoder&&(a=o.decoder.write(a)),o.objectMode&&null==a||(o.objectMode||a&&a.length)&&(t.push(a)||(i=!0,e.pause()))}),e)void 0===this[a]&&"function"==typeof e[a]&&(this[a]=function(t){return function(){return e[t].apply(e,arguments)}}(a));for(var n=0;n<y.length;n++)e.on(y[n],this.emit.bind(this,y[n]));return this._read=function(t){f("wrapped _read",t),i&&(i=!1,e.resume())},this},Object.defineProperty(S.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),S._fromList=V}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./_stream_duplex":170,"./internal/streams/BufferList":175,"./internal/streams/destroy":176,"./internal/streams/stream":177,_process:159,"core-util-is":69,events:105,inherits:140,isarray:178,"process-nextick-args":158,"safe-buffer":185,"string_decoder/":179,util:19}],173:[function(e,t){"use strict";t.exports=n;var o=e("./_stream_duplex"),i=Object.create(e("core-util-is"));function a(e,t){var o=this._transformState;o.transforming=!1;var i=o.writecb;if(!i)return this.emit("error",new Error("write callback called multiple times"));o.writechunk=null,o.writecb=null,null!=t&&this.push(t),i(e);var a=this._readableState;a.reading=!1,(a.needReadable||a.length<a.highWaterMark)&&this._read(a.highWaterMark)}function n(e){if(!(this instanceof n))return new n(e);o.call(this,e),this._transformState={afterTransform:a.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",r)}function r(){var e=this;"function"==typeof this._flush?this._flush(function(t,o){s(e,t,o)}):s(this,null,null)}function s(e,t,o){if(t)return e.emit("error",t);if(null!=o&&e.push(o),e._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(e._transformState.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}i.inherits=e("inherits"),i.inherits(n,o),n.prototype.push=function(e,t){return this._transformState.needTransform=!1,o.prototype.push.call(this,e,t)},n.prototype._transform=function(){throw new Error("_transform() is not implemented")},n.prototype._write=function(e,t,o){var i=this._transformState;if(i.writecb=o,i.writechunk=e,i.writeencoding=t,!i.transforming){var a=this._readableState;(i.needTransform||a.needReadable||a.length<a.highWaterMark)&&this._read(a.highWaterMark)}},n.prototype._read=function(){var e=this._transformState;null!==e.writechunk&&e.writecb&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0},n.prototype._destroy=function(e,t){var i=this;o.prototype._destroy.call(this,e,function(e){t(e),i.emit("close")})}},{"./_stream_duplex":170,"core-util-is":69,inherits:140}],174:[function(e,t){(function(o,i){"use strict";var a=e("process-nextick-args");function n(e){var t=this;this.next=null,this.entry=null,this.finish=function(){k(t,e)}}t.exports=y;var r,s=!o.browser&&["v0.10","v0.9."].indexOf(o.version.slice(0,5))>-1?setImmediate:a.nextTick;y.WritableState=_;var c=Object.create(e("core-util-is"));c.inherits=e("inherits");var l={deprecate:e("util-deprecate")},d=e("./internal/streams/stream"),u=e("safe-buffer").Buffer,h=i.Uint8Array||function(){};function p(e){return u.from(e)}var f,g=e("./internal/streams/destroy");function m(){}function _(t,o){r=r||e("./_stream_duplex"),t=t||{};var i=o instanceof r;this.objectMode=!!t.objectMode,i&&(this.objectMode=this.objectMode||!!t.writableObjectMode);var a=t.highWaterMark,s=t.writableHighWaterMark,c=this.objectMode?16:16384;this.highWaterMark=a||0===a?a:i&&(s||0===s)?s:c,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var l=!1===t.decodeStrings;this.decodeStrings=!l,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){w(o,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new n(this)}function y(t){if(r=r||e("./_stream_duplex"),!(f.call(y,this)||this instanceof r))return new y(t);this._writableState=new _(t,this),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev),"function"==typeof t.destroy&&(this._destroy=t.destroy),"function"==typeof t.final&&(this._final=t.final)),d.call(this)}function v(e,t){var o=new Error("write after end");e.emit("error",o),a.nextTick(t,o)}function C(e,t,o,i){var n=!0,r=!1;return null===o?r=new TypeError("May not write null values to stream"):"string"==typeof o||void 0===o||t.objectMode||(r=new TypeError("Invalid non-string/buffer chunk")),r&&(e.emit("error",r),a.nextTick(i,r),n=!1),n}function S(e,t,o){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=u.from(t,o)),t}function T(e,t,o,i,a,n){if(!o){var r=S(t,i,a);i!==r&&(o=!0,a="buffer",i=r)}var s=t.objectMode?1:i.length;t.length+=s;var c=t.length<t.highWaterMark;if(c||(t.needDrain=!0),t.writing||t.corked){var l=t.lastBufferedRequest;t.lastBufferedRequest={chunk:i,encoding:a,isBuf:o,callback:n,next:null},l?l.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else I(e,t,!1,s,i,a,n);return c}function I(e,t,o,i,a,n,r){t.writelen=i,t.writecb=r,t.writing=!0,t.sync=!0,o?e._writev(a,t.onwrite):e._write(a,n,t.onwrite),t.sync=!1}function N(e,t,o,i,n){--t.pendingcb,o?(a.nextTick(n,i),a.nextTick(M,e,t),e._writableState.errorEmitted=!0,e.emit("error",i)):(n(i),e._writableState.errorEmitted=!0,e.emit("error",i),M(e,t))}function b(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}function w(e,t){var o=e._writableState,i=o.sync,a=o.writecb;if(b(o),t)N(e,o,i,t,a);else{var n=L(o);n||o.corked||o.bufferProcessing||!o.bufferedRequest||R(e,o),i?s(E,e,o,n,a):E(e,o,n,a)}}function E(e,t,o,i){o||P(e,t),t.pendingcb--,i(),M(e,t)}function P(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}function R(e,t){t.bufferProcessing=!0;var o=t.bufferedRequest;if(e._writev&&o&&o.next){var i=t.bufferedRequestCount,a=new Array(i),r=t.corkedRequestsFree;r.entry=o;for(var s=0,c=!0;o;)a[s]=o,o.isBuf||(c=!1),o=o.next,s+=1;a.allBuffers=c,I(e,t,!0,t.length,a,"",r.finish),t.pendingcb++,t.lastBufferedRequest=null,r.next?(t.corkedRequestsFree=r.next,r.next=null):t.corkedRequestsFree=new n(t),t.bufferedRequestCount=0}else{for(;o;){var l=o.chunk,d=o.encoding,u=o.callback;if(I(e,t,!1,t.objectMode?1:l.length,l,d,u),o=o.next,t.bufferedRequestCount--,t.writing)break}null===o&&(t.lastBufferedRequest=null)}t.bufferedRequest=o,t.bufferProcessing=!1}function L(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function A(e,t){e._final(function(o){t.pendingcb--,o&&e.emit("error",o),t.prefinished=!0,e.emit("prefinish"),M(e,t)})}function D(e,t){t.prefinished||t.finalCalled||("function"==typeof e._final?(t.pendingcb++,t.finalCalled=!0,a.nextTick(A,e,t)):(t.prefinished=!0,e.emit("prefinish")))}function M(e,t){var o=L(t);return o&&(D(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"))),o}function B(e,t,o){t.ending=!0,M(e,t),o&&(t.finished?a.nextTick(o):e.once("finish",o)),t.ended=!0,e.writable=!1}function k(e,t,o){var i=e.entry;for(e.entry=null;i;){var a=i.callback;t.pendingcb--,a(o),i=i.next}t.corkedRequestsFree?t.corkedRequestsFree.next=e:t.corkedRequestsFree=e}c.inherits(y,d),_.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(_.prototype,"buffer",{get:l.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(f=Function.prototype[Symbol.hasInstance],Object.defineProperty(y,Symbol.hasInstance,{value:function(e){return!!f.call(this,e)||this===y&&e&&e._writableState instanceof _}})):f=function(e){return e instanceof this},y.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},y.prototype.write=function(e,t,o){var i,a=this._writableState,n=!1,r=!a.objectMode&&(i=e,u.isBuffer(i)||i instanceof h);return r&&!u.isBuffer(e)&&(e=p(e)),"function"==typeof t&&(o=t,t=null),r?t="buffer":t||(t=a.defaultEncoding),"function"!=typeof o&&(o=m),a.ended?v(this,o):(r||C(this,a,e,o))&&(a.pendingcb++,n=T(this,a,r,e,t,o)),n},y.prototype.cork=function(){this._writableState.corked++},y.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||R(this,e))},y.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(y.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),y.prototype._write=function(e,t,o){o(new Error("_write() is not implemented"))},y.prototype._writev=null,y.prototype.end=function(e,t,o){var i=this._writableState;"function"==typeof e?(o=e,e=null,t=null):"function"==typeof t&&(o=t,t=null),null!=e&&this.write(e,t),i.corked&&(i.corked=1,this.uncork()),i.ending||i.finished||B(this,i,o)},Object.defineProperty(y.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),y.prototype.destroy=g.destroy,y.prototype._undestroy=g.undestroy,y.prototype._destroy=function(e,t){this.end(),t(e)}}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./_stream_duplex":170,"./internal/streams/destroy":176,"./internal/streams/stream":177,_process:159,"core-util-is":69,inherits:140,"process-nextick-args":158,"safe-buffer":185,"util-deprecate":196}],175:[function(e,t){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=e("safe-buffer").Buffer,a=e("util");t.exports=function(){function e(){o(this,e),this.head=null,this.tail=null,this.length=0}return e.prototype.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},e.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},e.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},e.prototype.clear=function(){this.head=this.tail=null,this.length=0},e.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,o=""+t.data;t=t.next;)o+=e+t.data;return o},e.prototype.concat=function(e){if(0===this.length)return i.alloc(0);if(1===this.length)return this.head.data;for(var t,o,a=i.allocUnsafe(e>>>0),n=this.head,r=0;n;)t=a,o=r,n.data.copy(t,o),r+=n.data.length,n=n.next;return a},e}(),a&&a.inspect&&a.inspect.custom&&(t.exports.prototype[a.inspect.custom]=function(){var e=a.inspect({length:this.length});return this.constructor.name+" "+e})},{"safe-buffer":185,util:19}],176:[function(e,t){"use strict";var o=e("process-nextick-args");function i(e,t){e.emit("error",t)}t.exports={destroy:function(e,t){var a=this,n=this._readableState&&this._readableState.destroyed,r=this._writableState&&this._writableState.destroyed;return n||r?(t?t(e):!e||this._writableState&&this._writableState.errorEmitted||o.nextTick(i,this,e),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,function(e){!t&&e?(o.nextTick(i,a,e),a._writableState&&(a._writableState.errorEmitted=!0)):t&&t(e)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},{"process-nextick-args":158}],177:[function(e,t,o){arguments[4][61][0].apply(o,arguments)},{dup:61,events:105}],178:[function(e,t,o){arguments[4][67][0].apply(o,arguments)},{dup:67}],179:[function(e,t,o){arguments[4][64][0].apply(o,arguments)},{dup:64,"safe-buffer":185}],180:[function(e,t){t.exports=e("./readable").PassThrough},{"./readable":181}],181:[function(e,t,o){(o=t.exports=e("./lib/_stream_readable.js")).Stream=o,o.Readable=o,o.Writable=e("./lib/_stream_writable.js"),o.Duplex=e("./lib/_stream_duplex.js"),o.Transform=e("./lib/_stream_transform.js"),o.PassThrough=e("./lib/_stream_passthrough.js")},{"./lib/_stream_duplex.js":170,"./lib/_stream_passthrough.js":171,"./lib/_stream_readable.js":172,"./lib/_stream_transform.js":173,"./lib/_stream_writable.js":174}],182:[function(e,t){t.exports=e("./readable").Transform},{"./readable":181}],183:[function(e,t){t.exports=e("./lib/_stream_writable.js")},{"./lib/_stream_writable.js":174}],184:[function(e,t){"use strict";var o=e("buffer").Buffer,i=e("inherits"),a=e("hash-base"),n=new Array(16),r=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],s=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],c=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],l=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],d=[0,1518500249,1859775393,2400959708,2840853838],u=[1352829926,1548603684,1836072691,2053994217,0];function h(){a.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520}function p(e,t){return e<<t|e>>>32-t}function f(e,t,o,i,a,n,r,s){return p(e+(t^o^i)+n+r|0,s)+a|0}function g(e,t,o,i,a,n,r,s){return p(e+(t&o|~t&i)+n+r|0,s)+a|0}function m(e,t,o,i,a,n,r,s){return p(e+((t|~o)^i)+n+r|0,s)+a|0}function _(e,t,o,i,a,n,r,s){return p(e+(t&i|o&~i)+n+r|0,s)+a|0}function y(e,t,o,i,a,n,r,s){return p(e+(t^(o|~i))+n+r|0,s)+a|0}i(h,a),h.prototype._update=function(){for(var e=n,t=0;t<16;++t)e[t]=this._block.readInt32LE(4*t);for(var o=0|this._a,i=0|this._b,a=0|this._c,h=0|this._d,v=0|this._e,C=0|this._a,S=0|this._b,T=0|this._c,I=0|this._d,N=0|this._e,b=0;b<80;b+=1){var w,E;b<16?(w=f(o,i,a,h,v,e[r[b]],d[0],c[b]),E=y(C,S,T,I,N,e[s[b]],u[0],l[b])):b<32?(w=g(o,i,a,h,v,e[r[b]],d[1],c[b]),E=_(C,S,T,I,N,e[s[b]],u[1],l[b])):b<48?(w=m(o,i,a,h,v,e[r[b]],d[2],c[b]),E=m(C,S,T,I,N,e[s[b]],u[2],l[b])):b<64?(w=_(o,i,a,h,v,e[r[b]],d[3],c[b]),E=g(C,S,T,I,N,e[s[b]],u[3],l[b])):(w=y(o,i,a,h,v,e[r[b]],d[4],c[b]),E=f(C,S,T,I,N,e[s[b]],u[4],l[b])),o=v,v=h,h=p(a,10),a=i,i=w,C=N,N=I,I=p(T,10),T=S,S=E}var P=this._b+a+I|0;this._b=this._c+h+N|0,this._c=this._d+v+C|0,this._d=this._e+o+S|0,this._e=this._a+i+T|0,this._a=P},h.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var e=o.alloc?o.alloc(20):new o(20);return e.writeInt32LE(this._a,0),e.writeInt32LE(this._b,4),e.writeInt32LE(this._c,8),e.writeInt32LE(this._d,12),e.writeInt32LE(this._e,16),e},t.exports=h},{buffer:66,"hash-base":107,inherits:140}],185:[function(e,t,o){var i=e("buffer"),a=i.Buffer;function n(e,t){for(var o in e)t[o]=e[o]}function r(e,t,o){return a(e,t,o)}a.from&&a.alloc&&a.allocUnsafe&&a.allocUnsafeSlow?t.exports=i:(n(i,o),o.Buffer=r),n(a,r),r.from=function(e,t,o){if("number"==typeof e)throw new TypeError("Argument must not be a number");return a(e,t,o)},r.alloc=function(e,t,o){if("number"!=typeof e)throw new TypeError("Argument must be a number");var i=a(e);return void 0!==t?"string"==typeof o?i.fill(t,o):i.fill(t):i.fill(0),i},r.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return a(e)},r.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i.SlowBuffer(e)}},{buffer:66}],186:[function(e,t){var o=e("safe-buffer").Buffer;function i(e,t){this._block=o.alloc(e),this._finalSize=t,this._blockSize=e,this._len=0}i.prototype.update=function(e,t){"string"==typeof e&&(t=t||"utf8",e=o.from(e,t));for(var i=this._block,a=this._blockSize,n=e.length,r=this._len,s=0;s<n;){for(var c=r%a,l=Math.min(n-s,a-c),d=0;d<l;d++)i[c+d]=e[s+d];s+=l,(r+=l)%a==0&&this._update(i)}return this._len+=n,this},i.prototype.digest=function(e){var t=this._len%this._blockSize;this._block[t]=128,this._block.fill(0,t+1),t>=this._finalSize&&(this._update(this._block),this._block.fill(0));var o=8*this._len;if(o<=4294967295)this._block.writeUInt32BE(o,this._blockSize-4);else{var i=(4294967295&o)>>>0,a=(o-i)/4294967296;this._block.writeUInt32BE(a,this._blockSize-8),this._block.writeUInt32BE(i,this._blockSize-4)}this._update(this._block);var n=this._hash();return e?n.toString(e):n},i.prototype._update=function(){throw new Error("_update must be implemented by subclass")},t.exports=i},{"safe-buffer":185}],187:[function(e,t,o){(o=t.exports=function(e){e=e.toLowerCase();var t=o[e];if(!t)throw new Error(e+" is not supported (we accept pull requests)");return new t}).sha=e("./sha"),o.sha1=e("./sha1"),o.sha224=e("./sha224"),o.sha256=e("./sha256"),o.sha384=e("./sha384"),o.sha512=e("./sha512")},{"./sha":188,"./sha1":189,"./sha224":190,"./sha256":191,"./sha384":192,"./sha512":193}],188:[function(e,t){var o=e("inherits"),i=e("./hash"),a=e("safe-buffer").Buffer,n=[1518500249,1859775393,-1894007588,-899497514],r=new Array(80);function s(){this.init(),this._w=r,i.call(this,64,56)}function c(e){return e<<30|e>>>2}function l(e,t,o,i){return 0===e?t&o|~t&i:2===e?t&o|t&i|o&i:t^o^i}o(s,i),s.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},s.prototype._update=function(e){for(var t,o=this._w,i=0|this._a,a=0|this._b,r=0|this._c,s=0|this._d,d=0|this._e,u=0;u<16;++u)o[u]=e.readInt32BE(4*u);for(;u<80;++u)o[u]=o[u-3]^o[u-8]^o[u-14]^o[u-16];for(var h=0;h<80;++h){var p=~~(h/20),f=0|((t=i)<<5|t>>>27)+l(p,a,r,s)+d+o[h]+n[p];d=s,s=r,r=c(a),a=i,i=f}this._a=i+this._a|0,this._b=a+this._b|0,this._c=r+this._c|0,this._d=s+this._d|0,this._e=d+this._e|0},s.prototype._hash=function(){var e=a.allocUnsafe(20);return e.writeInt32BE(0|this._a,0),e.writeInt32BE(0|this._b,4),e.writeInt32BE(0|this._c,8),e.writeInt32BE(0|this._d,12),e.writeInt32BE(0|this._e,16),e},t.exports=s},{"./hash":186,inherits:140,"safe-buffer":185}],189:[function(e,t){var o=e("inherits"),i=e("./hash"),a=e("safe-buffer").Buffer,n=[1518500249,1859775393,-1894007588,-899497514],r=new Array(80);function s(){this.init(),this._w=r,i.call(this,64,56)}function c(e){return e<<5|e>>>27}function l(e){return e<<30|e>>>2}function d(e,t,o,i){return 0===e?t&o|~t&i:2===e?t&o|t&i|o&i:t^o^i}o(s,i),s.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},s.prototype._update=function(e){for(var t,o=this._w,i=0|this._a,a=0|this._b,r=0|this._c,s=0|this._d,u=0|this._e,h=0;h<16;++h)o[h]=e.readInt32BE(4*h);for(;h<80;++h)o[h]=(t=o[h-3]^o[h-8]^o[h-14]^o[h-16])<<1|t>>>31;for(var p=0;p<80;++p){var f=~~(p/20),g=c(i)+d(f,a,r,s)+u+o[p]+n[f]|0;u=s,s=r,r=l(a),a=i,i=g}this._a=i+this._a|0,this._b=a+this._b|0,this._c=r+this._c|0,this._d=s+this._d|0,this._e=u+this._e|0},s.prototype._hash=function(){var e=a.allocUnsafe(20);return e.writeInt32BE(0|this._a,0),e.writeInt32BE(0|this._b,4),e.writeInt32BE(0|this._c,8),e.writeInt32BE(0|this._d,12),e.writeInt32BE(0|this._e,16),e},t.exports=s},{"./hash":186,inherits:140,"safe-buffer":185}],190:[function(e,t){var o=e("inherits"),i=e("./sha256"),a=e("./hash"),n=e("safe-buffer").Buffer,r=new Array(64);function s(){this.init(),this._w=r,a.call(this,64,56)}o(s,i),s.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this},s.prototype._hash=function(){var e=n.allocUnsafe(28);return e.writeInt32BE(this._a,0),e.writeInt32BE(this._b,4),e.writeInt32BE(this._c,8),e.writeInt32BE(this._d,12),e.writeInt32BE(this._e,16),e.writeInt32BE(this._f,20),e.writeInt32BE(this._g,24),e},t.exports=s},{"./hash":186,"./sha256":191,inherits:140,"safe-buffer":185}],191:[function(e,t){var o=e("inherits"),i=e("./hash"),a=e("safe-buffer").Buffer,n=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],r=new Array(64);function s(){this.init(),this._w=r,i.call(this,64,56)}function c(e,t,o){return o^e&(t^o)}function l(e,t,o){return e&t|o&(e|t)}function d(e){return(e>>>2|e<<30)^(e>>>13|e<<19)^(e>>>22|e<<10)}function u(e){return(e>>>6|e<<26)^(e>>>11|e<<21)^(e>>>25|e<<7)}function h(e){return(e>>>7|e<<25)^(e>>>18|e<<14)^e>>>3}o(s,i),s.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this},s.prototype._update=function(e){for(var t,o=this._w,i=0|this._a,a=0|this._b,r=0|this._c,s=0|this._d,p=0|this._e,f=0|this._f,g=0|this._g,m=0|this._h,_=0;_<16;++_)o[_]=e.readInt32BE(4*_);for(;_<64;++_)o[_]=0|(((t=o[_-2])>>>17|t<<15)^(t>>>19|t<<13)^t>>>10)+o[_-7]+h(o[_-15])+o[_-16];for(var y=0;y<64;++y){var v=m+u(p)+c(p,f,g)+n[y]+o[y]|0,C=d(i)+l(i,a,r)|0;m=g,g=f,f=p,p=s+v|0,s=r,r=a,a=i,i=v+C|0}this._a=i+this._a|0,this._b=a+this._b|0,this._c=r+this._c|0,this._d=s+this._d|0,this._e=p+this._e|0,this._f=f+this._f|0,this._g=g+this._g|0,this._h=m+this._h|0},s.prototype._hash=function(){var e=a.allocUnsafe(32);return e.writeInt32BE(this._a,0),e.writeInt32BE(this._b,4),e.writeInt32BE(this._c,8),e.writeInt32BE(this._d,12),e.writeInt32BE(this._e,16),e.writeInt32BE(this._f,20),e.writeInt32BE(this._g,24),e.writeInt32BE(this._h,28),e},t.exports=s},{"./hash":186,inherits:140,"safe-buffer":185}],192:[function(e,t){var o=e("inherits"),i=e("./sha512"),a=e("./hash"),n=e("safe-buffer").Buffer,r=new Array(160);function s(){this.init(),this._w=r,a.call(this,128,112)}o(s,i),s.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this},s.prototype._hash=function(){var e=n.allocUnsafe(48);function t(t,o,i){e.writeInt32BE(t,i),e.writeInt32BE(o,i+4)}return t(this._ah,this._al,0),t(this._bh,this._bl,8),t(this._ch,this._cl,16),t(this._dh,this._dl,24),t(this._eh,this._el,32),t(this._fh,this._fl,40),e},t.exports=s},{"./hash":186,"./sha512":193,inherits:140,"safe-buffer":185}],193:[function(e,t){var o=e("inherits"),i=e("./hash"),a=e("safe-buffer").Buffer,n=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],r=new Array(160);function s(){this.init(),this._w=r,i.call(this,128,112)}function c(e,t,o){return o^e&(t^o)}function l(e,t,o){return e&t|o&(e|t)}function d(e,t){return(e>>>28|t<<4)^(t>>>2|e<<30)^(t>>>7|e<<25)}function u(e,t){return(e>>>14|t<<18)^(e>>>18|t<<14)^(t>>>9|e<<23)}function h(e,t){return(e>>>1|t<<31)^(e>>>8|t<<24)^e>>>7}function p(e,t){return(e>>>1|t<<31)^(e>>>8|t<<24)^(e>>>7|t<<25)}function f(e,t){return(e>>>19|t<<13)^(t>>>29|e<<3)^e>>>6}function g(e,t){return(e>>>19|t<<13)^(t>>>29|e<<3)^(e>>>6|t<<26)}function m(e,t){return e>>>0<t>>>0?1:0}o(s,i),s.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this},s.prototype._update=function(e){for(var t=this._w,o=0|this._ah,i=0|this._bh,a=0|this._ch,r=0|this._dh,s=0|this._eh,_=0|this._fh,y=0|this._gh,v=0|this._hh,C=0|this._al,S=0|this._bl,T=0|this._cl,I=0|this._dl,N=0|this._el,b=0|this._fl,w=0|this._gl,E=0|this._hl,P=0;P<32;P+=2)t[P]=e.readInt32BE(4*P),t[P+1]=e.readInt32BE(4*P+4);for(;P<160;P+=2){var R=t[P-30],L=t[P-30+1],A=h(R,L),D=p(L,R),M=f(R=t[P-4],L=t[P-4+1]),B=g(L,R),k=t[P-14],G=t[P-14+1],O=t[P-32],H=t[P-32+1],V=D+G|0,F=A+k+m(V,D)|0;F=(F=F+M+m(V=V+B|0,B)|0)+O+m(V=V+H|0,H)|0,t[P]=F,t[P+1]=V}for(var U=0;U<160;U+=2){F=t[U],V=t[U+1];var x=l(o,i,a),Y=l(C,S,T),j=d(o,C),W=d(C,o),z=u(s,N),K=u(N,s),q=n[U],Q=n[U+1],X=c(s,_,y),J=c(N,b,w),Z=E+K|0,$=v+z+m(Z,E)|0;$=($=($=$+X+m(Z=Z+J|0,J)|0)+q+m(Z=Z+Q|0,Q)|0)+F+m(Z=Z+V|0,V)|0;var ee=W+Y|0,te=j+x+m(ee,W)|0;v=y,E=w,y=_,w=b,_=s,b=N,s=r+$+m(N=I+Z|0,I)|0,r=a,I=T,a=i,T=S,i=o,S=C,o=$+te+m(C=Z+ee|0,Z)|0}this._al=this._al+C|0,this._bl=this._bl+S|0,this._cl=this._cl+T|0,this._dl=this._dl+I|0,this._el=this._el+N|0,this._fl=this._fl+b|0,this._gl=this._gl+w|0,this._hl=this._hl+E|0,this._ah=this._ah+o+m(this._al,C)|0,this._bh=this._bh+i+m(this._bl,S)|0,this._ch=this._ch+a+m(this._cl,T)|0,this._dh=this._dh+r+m(this._dl,I)|0,this._eh=this._eh+s+m(this._el,N)|0,this._fh=this._fh+_+m(this._fl,b)|0,this._gh=this._gh+y+m(this._gl,w)|0,this._hh=this._hh+v+m(this._hl,E)|0},s.prototype._hash=function(){var e=a.allocUnsafe(64);function t(t,o,i){e.writeInt32BE(t,i),e.writeInt32BE(o,i+4)}return t(this._ah,this._al,0),t(this._bh,this._bl,8),t(this._ch,this._cl,16),t(this._dh,this._dl,24),t(this._eh,this._el,32),t(this._fh,this._fl,40),t(this._gh,this._gl,48),t(this._hh,this._hl,56),e},t.exports=s},{"./hash":186,inherits:140,"safe-buffer":185}],194:[function(e,t){t.exports=i;var o=e("events").EventEmitter;function i(){o.call(this)}e("inherits")(i,o),i.Readable=e("readable-stream/readable.js"),i.Writable=e("readable-stream/writable.js"),i.Duplex=e("readable-stream/duplex.js"),i.Transform=e("readable-stream/transform.js"),i.PassThrough=e("readable-stream/passthrough.js"),i.Stream=i,i.prototype.pipe=function(e,t){var i=this;function a(t){e.writable&&!1===e.write(t)&&i.pause&&i.pause()}function n(){i.readable&&i.resume&&i.resume()}i.on("data",a),e.on("drain",n),e._isStdio||t&&!1===t.end||(i.on("end",s),i.on("close",c));var r=!1;function s(){r||(r=!0,e.end())}function c(){r||(r=!0,"function"==typeof e.destroy&&e.destroy())}function l(e){if(d(),0===o.listenerCount(this,"error"))throw e}function d(){i.removeListener("data",a),e.removeListener("drain",n),i.removeListener("end",s),i.removeListener("close",c),i.removeListener("error",l),e.removeListener("error",l),i.removeListener("end",d),i.removeListener("close",d),e.removeListener("close",d)}return i.on("error",l),e.on("error",l),i.on("end",d),i.on("close",d),e.on("close",d),e.emit("pipe",i),e}},{events:105,inherits:140,"readable-stream/duplex.js":169,"readable-stream/passthrough.js":180,"readable-stream/readable.js":181,"readable-stream/transform.js":182,"readable-stream/writable.js":183}],195:[function(e,t,o){var i=e("buffer").Buffer,a=i.isEncoding||function(e){switch(e&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function n(e){if(e&&!a(e))throw new Error("Unknown encoding: "+e)}var r=o.StringDecoder=function(e){switch(this.encoding=(e||"utf8").toLowerCase().replace(/[-_]/,""),n(e),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=c;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=l;break;default:return void(this.write=s)}this.charBuffer=new i(6),this.charReceived=0,this.charLength=0};function s(e){return e.toString(this.encoding)}function c(e){this.charReceived=e.length%2,this.charLength=this.charReceived?2:0}function l(e){this.charReceived=e.length%3,this.charLength=this.charReceived?3:0}r.prototype.write=function(e){for(var t="";this.charLength;){var o=e.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:e.length;if(e.copy(this.charBuffer,this.charReceived,0,o),this.charReceived+=o,this.charReceived<this.charLength)return"";if(e=e.slice(o,e.length),!((i=(t=this.charBuffer.slice(0,this.charLength).toString(this.encoding)).charCodeAt(t.length-1))>=55296&&i<=56319)){if(this.charReceived=this.charLength=0,0===e.length)return t;break}this.charLength+=this.surrogateSize,t=""}this.detectIncompleteChar(e);var i,a=e.length;if(this.charLength&&(e.copy(this.charBuffer,0,e.length-this.charReceived,a),a-=this.charReceived),a=(t+=e.toString(this.encoding,0,a)).length-1,(i=t.charCodeAt(a))>=55296&&i<=56319){var n=this.surrogateSize;return this.charLength+=n,this.charReceived+=n,this.charBuffer.copy(this.charBuffer,n,0,n),e.copy(this.charBuffer,0,0,n),t.substring(0,a)}return t},r.prototype.detectIncompleteChar=function(e){for(var t=e.length>=3?3:e.length;t>0;t--){var o=e[e.length-t];if(1==t&&o>>5==6){this.charLength=2;break}if(t<=2&&o>>4==14){this.charLength=3;break}if(t<=3&&o>>3==30){this.charLength=4;break}}this.charReceived=t},r.prototype.end=function(e){var t="";if(e&&e.length&&(t=this.write(e)),this.charReceived){var o=this.charReceived,i=this.charBuffer,a=this.encoding;t+=i.slice(0,o).toString(a)}return t}},{buffer:66}],196:[function(e,t){(function(e){function o(t){try{if(!e.localStorage)return!1}catch(i){return!1}var o=e.localStorage[t];return null!=o&&"true"===String(o).toLowerCase()}t.exports=function(e,t){if(o("noDeprecation"))return e;var i=!1;return function(){if(!i){if(o("throwDeprecation"))throw new Error(t);o("traceDeprecation")?console.trace(t):console.warn(t),i=!0}return e.apply(this,arguments)}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],197:[function(require,module,exports){var indexOf=require("indexof"),Object_keys=function(e){if(Object.keys)return Object.keys(e);var t=[];for(var o in e)t.push(o);return t},forEach=function(e,t){if(e.forEach)return e.forEach(t);for(var o=0;o<e.length;o++)t(e[o],o,e)},defineProp=function(){try{return Object.defineProperty({},"_",{}),function(e,t,o){Object.defineProperty(e,t,{writable:!0,enumerable:!1,configurable:!0,value:o})}}catch(e){return function(e,t,o){e[t]=o}}}(),globals=["Array","Boolean","Date","Error","EvalError","Function","Infinity","JSON","Math","NaN","Number","Object","RangeError","ReferenceError","RegExp","String","SyntaxError","TypeError","URIError","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","escape","eval","isFinite","isNaN","parseFloat","parseInt","undefined","unescape"];function Context(){}Context.prototype={};var Script=exports.Script=function(e){if(!(this instanceof Script))return new Script(e);this.code=e};Script.prototype.runInContext=function(e){if(!(e instanceof Context))throw new TypeError("needs a 'context' argument.");var t=document.createElement("iframe");t.style||(t.style={}),t.style.display="none",document.body.appendChild(t);var o=t.contentWindow,i=o.eval,a=o.execScript;!i&&a&&(a.call(o,"null"),i=o.eval),forEach(Object_keys(e),function(t){o[t]=e[t]}),forEach(globals,function(t){e[t]&&(o[t]=e[t])});var n=Object_keys(o),r=i.call(o,this.code);return forEach(Object_keys(o),function(t){(t in e||-1===indexOf(n,t))&&(e[t]=o[t])}),forEach(globals,function(t){t in e||defineProp(e,t,o[t])}),document.body.removeChild(t),r},Script.prototype.runInThisContext=function(){return eval(this.code)},Script.prototype.runInNewContext=function(e){var t=Script.createContext(e),o=this.runInContext(t);return forEach(Object_keys(t),function(o){e[o]=t[o]}),o},forEach(Object_keys(Script.prototype),function(e){exports[e]=Script[e]=function(t){var o=Script(t);return o[e].apply(o,[].slice.call(arguments,1))}}),exports.createScript=function(e){return exports.Script(e)},exports.createContext=Script.createContext=function(e){var t=new Context;return"object"==typeof e&&forEach(Object_keys(e),function(o){t[o]=e[o]}),t}},{indexof:139}],DalanReportUtils:[function(e,t,o){"use strict";cc._RF.push(t,"0c97aZJ3O5P0ZHE2/Qdr+lv","DalanReportUtils"),Object.defineProperty(o,"__esModule",{value:!0}),o.DalanReportUtils=void 0;var i=e("../common/PlayerModule"),a=e("../network/protocol/TypeProtocols"),n=e("./GamePlatform"),r=e("./GameUtils"),s=function(){function e(){}return Object.defineProperty(e,"Instance",{get:function(){return null==e.g_instance&&(e.g_instance=new e),e.g_instance},enumerable:!1,configurable:!0}),e.prototype.reprot_chat=function(e,t){if("bigBlue"==n.GamePlatform.getMiYaVideoTypeNoSet()){var o=i.default.uuidTransformRoieId(),s=r.getLocalData("uid"),c=i.default.roleName,l=i.default.getRoleAttrValByKey(a.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE),d=i.default.getRoleAttrValByKey(a.ROLE_ATTR_VALUES.ROLE_ATTR_VIPLEVEL),u=i.default.getServersTime2(),h=null!=n.GamePlatform.m_MiYaLoginData?n.GamePlatform.m_MiYaLoginData.zone:0,p=null!=n.GamePlatform.m_MiYaLoginData?n.GamePlatform.m_MiYaLoginData.webname:"",f={};f.channel=e,f.content=t,f.role_id=o,f.uid=s,f.role_name=c,f.role_level=l,f.vip_level=d,f.create_time=u,f.server_id=h,f.server_name=p;var g=new XMLHttpRequest;g.onload=function(){console.log("\u5927\u84dd\u804a\u5929\u4e0a\u62a5, onload!")},g.onreadystatechange=function(){if(console.log("\u5927\u84dd\u804a\u5929\u4e0a\u62a5, onreadystatechange, readyState="+g.readyState+", status="+g.status),4==g.readyState&&console.log("\u5927\u84dd\u804a\u5929\u4e0a\u62a5, onreadystatechange, http=",g),4==g.readyState&&g.status>=200&&g.status<400){var e=JSON.parse(g.responseText);console.log("\u5927\u84dd\u804a\u5929\u4e0a\u62a5, response=",e)}},g.onerror=function(){console.log("\u5927\u84dd\u804a\u5929\u4e0a\u62a5, onerror!")},g.open("POST","https://mszctest.gameserver.iplay11g.com/gmsys/weblogic/webc/appdalan/appdalanreportchat.php",!0);var m={};m.content=f;var _=JSON.stringify(m);console.log("\u5927\u84dd\u804a\u5929\u4e0a\u62a5, sendValue=",_),g.send(_)}},e.g_instance=null,e.REPORT_CHAT_CHANNEL_PRIVATE=0,e.REPORT_CHAT_CHANNEL_WORLD=1,e.REPORT_CHAT_CHANNEL_SOCIATY=4,e.REPORT_CHAT_CHANNEL_FIGHT=7,e}();o.DalanReportUtils=s,cc._RF.pop()},{"../common/PlayerModule":"PlayerModule","../network/protocol/TypeProtocols":"TypeProtocols","./GamePlatform":"GamePlatform","./GameUtils":"GameUtils"}],DataViewRW:[function(e,t,o){"use strict";cc._RF.push(t,"b5ce0/YjbRF7rUE8u3MDOLY","DataViewRW");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0}),o.DataViewReader=o.DataViewWriter=void 0;var n=e("./long"),r=function(){function e(e,t,o){this.m_DataView=new DataView(e,t,o),this.m_len=0,this.m_pos=0}return e.prototype.markEnd=function(){this.m_len=this.m_pos},e.prototype.getLen=function(){return this.m_len},e.prototype.getPos=function(){return this.m_pos},e.prototype.setLen=function(e){this.m_len=e},e.prototype.resetPos=function(){this.m_pos=0},e.prototype.advance=function(e){this.m_pos+=e},e.prototype.getCapacity=function(){return this.m_DataView.byteLength},e.prototype.getBuffer=function(){return this.m_DataView.buffer},e.prototype.getOffset=function(){return this.m_DataView.byteOffset},e}(),s=function(e){function t(t,o,i){return e.call(this,t,o,i)||this}return a(t,e),t.prototype.setBool=function(e){this.setInt8(Number(e))},t.prototype.setInt8=function(e){this.m_DataView.setInt8(this.m_pos,e),this.m_pos+=1},t.prototype.setUint8=function(e){this.setInt8(e)},t.prototype.setInt16=function(e){this.m_DataView.setInt16(this.m_pos,e,!0),this.m_pos+=2},t.prototype.setUint16=function(e){this.setInt16(e)},t.prototype.setInt32=function(e){this.m_DataView.setInt32(this.m_pos,e,!0),this.m_pos+=4},t.prototype.setUint32=function(e){this.setInt32(e)},t.prototype.setLong=function(e){for(var t=0,o=e.toBytesLE();t<o.length;t++){var i=o[t];this.setUint8(i)}},t.prototype.setFloat32=function(e){this.m_DataView.setFloat32(this.m_pos,e,!0),this.m_pos+=4},t.prototype.setFloat64=function(e){this.m_DataView.setFloat64(this.m_pos,e,!0),this.m_pos+=8},t.prototype.setString=function(e){for(var t=new Array,o=0;o<e.length;++o){var i=e.charCodeAt(o);if(i<128)t.push(e.charCodeAt(o));else if(i<2048){var a=i>>6|192,n=63&i|128;t.push(a),t.push(n)}else if(i<65536){a=i>>12|224,n=i>>6&63|128;var r=63&i|128;t.push(a),t.push(n),t.push(r)}else{if(!(i<1114112))throw new Error("not supported code");a=i>>18|240,n=i>>12&63|128,r=i>>6&63|128;var s=63&i|128;t.push(a),t.push(n),t.push(r),t.push(s)}}this.setInt32(t.length);for(var c=0,l=t;c<l.length;c++){var d=l[c];this.setUint8(d)}},t.prototype.getDataView=function(){return new DataView(this.m_DataView.buffer,this.m_DataView.byteOffset,this.m_len)},t.prototype.getArrayBuffer=function(){return this.m_DataView.buffer.slice(this.m_DataView.byteOffset,this.m_DataView.byteOffset+this.m_len)},t}(r);o.DataViewWriter=s;var c=function(e){function t(t,o,i){return e.call(this,t,o,i)||this}return a(t,e),t.prototype.getBool=function(){return Boolean(this.getInt8())},t.prototype.getInt8=function(){var e=this.m_DataView.getInt8(this.m_pos);return this.m_pos+=1,e},t.prototype.getUint8=function(){var e=this.m_DataView.getUint8(this.m_pos);return this.m_pos+=1,e},t.prototype.getInt16=function(){var e=this.m_DataView.getInt16(this.m_pos,!0);return this.m_pos+=2,e},t.prototype.getUint16=function(){var e=this.m_DataView.getUint16(this.m_pos,!0);return this.m_pos+=2,e},t.prototype.getInt32=function(){var e=this.m_DataView.getInt32(this.m_pos,!0);return this.m_pos+=4,e},t.prototype.getUint32=function(){var e=this.m_DataView.getUint32(this.m_pos,!0);return this.m_pos+=4,e},t.prototype.getLong=function(){for(var e=new Array,t=0;t<8;++t)e.push(this.getUint8());return n.fromBytesLE(e)},t.prototype.getFloat32=function(){var e=this.m_DataView.getFloat32(this.m_pos,!0);return this.m_pos+=4,e},t.prototype.getFloat64=function(){var e=this.m_DataView.getFloat64(this.m_pos,!0);return this.m_pos+=8,e},t.prototype.getString=function(e){for(var t="",o=0;o<e;){var i=this.getUint8();if(240==(240&i)){if(o+3>=e)return t;var a=(7&i)<<18|(63&this.getUint8())<<12|(63&this.getUint8())<<6|63&this.getUint8();t+=String.fromCharCode(a),o+=4}else if(224==(224&i)){if(o+2>=e)return t;a=(15&i)<<12|(63&this.getUint8())<<6|63&this.getUint8(),t+=String.fromCharCode(a),o+=3}else if(192==(192&i)){if(o+1>=e)return t;a=(31&i)<<6|63&this.getUint8(),t+=String.fromCharCode(a),o+=2}else t+=String.fromCharCode(i),++o}return t},t.prototype.getLen=function(){return this.m_DataView.byteLength},t}(r);o.DataViewReader=c,cc._RF.pop()},{"./long":"long"}],Debug:[function(e,t,o){"use strict";cc._RF.push(t,"63dc0yK1KVATKW/uA9Zk2NF","Debug"),o.__esModule=!0,o.default=void 0;var i=function(){function e(){}return e.error=function(e){cc.log("error: "+e)},e.info=function(e){cc.log(e)},e.trace=function(e){var t=arguments.callee.caller,o=0;for(e=e||1,cc.log("***----------------------------------------  ** "+(o+1));t&&o<e;)cc.log(t.toString()),t=t.caller,o++,cc.log("***---------------------------------------- ** "+(o+1))},e}();o.default=i,t.exports=o.default,cc._RF.pop()},{}],Decorators:[function(e,t,o){"use strict";cc._RF.push(t,"ed61fqljUFEwr32J6eLiGzC","Decorators"),Object.defineProperty(o,"__esModule",{value:!0}),o.Register_Button_Sound=o.Register_Class=o.Register_Class2=void 0;var i=e("./GameView"),a=e("../../utils/Tools"),n=e("../../StaticData/SoundTableData");o.Register_Class2=function(e,t){return function(o){i.default.registerCls(o,e,t)}},o.Register_Class=function(e){var t=cc.js.getClassName(e);i.default.registerCls(e,t)},o.Register_Button_Sound=function(){cc.Button.prototype._onTouchBegan=function(e){if(this.interactable&&this.enabledInHierarchy){var t=e.target;t.scale=.92*t.scale,this._pressed=!0,this._updateState(),e.stopPropagation()}},cc.Button.prototype._onTouchCancel=function(e){if(this.interactable&&this.enabledInHierarchy&&0!=this._pressed){var t=e.target;t.scale=t.scale/.92,this._pressed=!1,this._updateState()}},cc.Button.prototype._onTouchEnded=function(e){var t=this;if(this.interactable&&this.enabledInHierarchy){if(this._pressed){var o=e.target;if(o.scale=o.scale/.92,cc.Component.EventHandler.emitEvents(this.clickEvents,e),this.node.emit("click",this),n.SoundTableData.getDataMap().size<=0)return;if(0==a.checkGameMuteVolume()){var i=n.SoundTableData.getById(1).res,r=cc.resources.get(i,cc.AudioClip);r?(this.audioId&&cc.audioEngine.stopEffect(this.audioId),this.audioId=cc.audioEngine.playEffect(r,!1),cc.audioEngine.setFinishCallback(this.audioId,function(){t.audioId=null})):cc.resources.load(i,cc.AudioClip,function(e,o){e||(t.audioId=cc.audioEngine.playEffect(o,!1),cc.audioEngine.setFinishCallback(t.audioId,function(){t.audioId=null}))})}}this._pressed=!1,this._updateState(),e.stopPropagation()}}},cc._RF.pop()},{"../../StaticData/SoundTableData":"SoundTableData","../../utils/Tools":"Tools","./GameView":"GameView"}],DetainmentView:[function(e,t,o){"use strict";cc._RF.push(t,"9606fYoFmFLna+vWps2euAQ","DetainmentView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../modules/base/BaseView"),s=e("../utils/GameTools"),c=e("../common/PlayerModule"),l=e("../modules/base/Decorators"),d=e("../network/ClientNetwork"),u=e("../modules/base/GameView"),h=e("../network/protocol/TypeProtocols"),p=e("../utils/RewardedVideoUnitIdConst"),f=e("../utils/RewardedVideoAd"),g=e("../utils/GameUtils"),m=e("../network/protocol/RoleProtocols"),_=e("../utils/GamePlatform"),y=e("../common/NetworkProtocolCommon"),v=e("../utils/ByteDanceMiniGameUtils"),C=e("../StaticData/CostGetTableData"),S=e("../Global/GameGlobal"),T=e("../common/EventConst"),I=e("../modules/manager/EventManager"),N=e("../network/LocalMessage"),b=cc._decorator,w=b.ccclass,E=b.property,P=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.GiftNode=null,t.GiftCountLab=null,t.ProtectNode=null,t.ProtectCountLab=null,t.m_isFree_qqhall=!1,t}return a(t,e),t.path=function(){return"ui/mainScene/DetainmentNode"},t.prototype.onLoad=function(){var e=this;s.default.registerTouchEvent(this.GiftNode.getChildByName("RejectBtn"),function(){e.closeView()}),s.default.registerTouchEvent(this.ProtectNode.getChildByName("RejectBtn"),function(){e.closeView()}),this.node.active=!1,cc.find("Canvas").getChildByName("UI_Mask_"+this.node.name).active=!1,_.GamePlatform.isByteDanceMiniGame()?(this.GiftNode.getChildByName("RejectBtn").active=!1,this.ProtectNode.getChildByName("RejectBtn").active=!1,this.GiftNode.getChildByName("RejectBtn_douyin").active=!0,this.ProtectNode.getChildByName("RejectBtn_douyin").active=!0,this.GiftNode.getChildByName("AcceptButton").setPosition(111,-220),this.ProtectNode.getChildByName("AcceptButton").setPosition(111,-220),this.GiftNode.getChildByName("RejectBtn_douyin").y=-220,this.ProtectNode.getChildByName("RejectBtn_douyin").y=-220,this.GiftNode.getChildByName("RejectBtn_douyin").scale=this.ProtectNode.getChildByName("RejectBtn_douyin").scale=1.1,s.default.registerTouchEvent(this.GiftNode.getChildByName("RejectBtn_douyin"),function(){e.closeView()}),s.default.registerTouchEvent(this.ProtectNode.getChildByName("RejectBtn_douyin"),function(){e.closeView()})):(this.GiftNode.getChildByName("RejectBtn_douyin").active=!1,this.ProtectNode.getChildByName("RejectBtn_douyin").active=!1)},t.prototype.start=function(){var e=this;d.ClientNetwork.getInstance().listenLocalMessage(N.LOCAL_MESSAGE.LocalMsg_EnterMainScene,function(){e.closeView()},this),d.ClientNetwork.getInstance().listenProtocol(m.ROLE_CLIENT_ENUM.P_Role_ReceiveFightWinExtra,function(t){t.resetPos();var o=new m.S_Role_ReceiveFightWinExtra;if(o.read(t))if(0===o.errorcode){if(0==e.m_isFree_qqhall&&_.GamePlatform.isNoVideoBag()){var i=C.CostGetTableData.getById(1004).cost[0].itemNum;c.default.getGoldNum()>=Number(i)&&y.default.callRoleCostGet(1004)}e.closeView(),o.prize.length>0&&u.default.addPopView("BaseCtrl","AcquirePopupView","AcquirePopupView",{items:o.prize});var a=u.default.getViewByName("MainSceneView");a&&a.view&&a.view.onClientTaskAddAdvert(p.RewardedVideoClientIdConst.ReceiveFightWinExtra)}else S.G.StringManager.PopString("S_Role_ReceiveFightWinExtra Error "+o.errorcode)},this),d.ClientNetwork.getInstance().listenProtocol(m.ROLE_CLIENT_ENUM.P_Role_ReceiveFightLoserProtect,function(t){t.resetPos();var o=new m.S_Role_ReceiveFightLoserProtect;if(o.read(t))if(0===o.errorcode){if(0==e.m_isFree_qqhall&&_.GamePlatform.isNoVideoBag()){var i=C.CostGetTableData.getById(1004).cost[0].itemNum;c.default.getGoldNum()>=Number(i)&&y.default.callRoleCostGet(1004)}e.closeView(),I.default.Instance.emit(T.default.RefreshMainPlayerCupNum);var a=u.default.getViewByName("MainSceneView");a&&a.view&&a.view.onClientTaskAddAdvert(p.RewardedVideoClientIdConst.ReceiveFightLoserProtect)}else S.G.StringManager.PopString("\u6062\u590d\u676f\u6570\u9519\u8bef Error "+o.errorcode)},this),this.changeAdButtonSkins()},t.prototype.init=function(e){if(1==e.bWin){if(g.checkPvPOverLimit())return void this.closeView();if(c.default.getRoleAttrValByKey(h.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE)<Number(g.getConfigIntValue("fightwin_min_score")))return void this.closeView();var t=c.default.getRoleInfoData().fightWinDayNum;if(t>=(o=Number(g.getConfigIntValue("fightwin_day_num"))))return void this.closeView();this.GiftCountLab.string="("+(Number(o)-t)+"/"+o+")",this.node.active=!0,this.GiftNode.active=!0,this.ProtectNode.active=!1,(_.GamePlatform.isQQGameRoom()||_.GamePlatform.IsH5SmallBag()||_.GamePlatform.IsMiYaIosH5()||_.GamePlatform.IsDysbSmallBag()||_.GamePlatform.Is5Add7SmallBag())&&(this.GiftNode.getChildByName("watchQQVideo").active=!0,this.GiftNode.getChildByName("AcceptButton").active=!1,this.GiftNode.getChildByName("watchQQVideo").getChildByName("labCount").getComponent(cc.Label).string="("+(Number(o)-t)+"/"+o+")",0==t&&(this.GiftNode.getChildByName("watchQQVideo").getChildByName("costGold").active=!1,this.GiftNode.getChildByName("watchQQVideo").getChildByName("Label").getComponent(cc.Label).string="\u9996\u6b21\u514d\u8d39",this.m_isFree_qqhall=!0))}else{if(c.default.getRoleAttrValByKey(h.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE)<Number(g.getConfigIntValue("fightloserprotect_min_score")))return void this.closeView();var o,i=c.default.getRoleInfoData().fightLoserProtectDayNum;if(i>=(o=Number(g.getConfigIntValue("fightloserprotect_day_num"))))return void this.closeView();if(e.losterScore<=0)return void this.closeView();this.ProtectCountLab.string="("+(Number(o)-i)+"/"+o+")",this.node.active=!0,this.ProtectNode.active=!0,this.GiftNode.active=!1,(_.GamePlatform.isQQGameRoom()||_.GamePlatform.IsH5SmallBag()||_.GamePlatform.IsMiYaIosH5()||_.GamePlatform.IsDysbSmallBag()||_.GamePlatform.Is5Add7SmallBag())&&(this.ProtectNode.getChildByName("watchQQVideo").active=!0,this.ProtectNode.getChildByName("AcceptButton").active=!1,this.ProtectNode.getChildByName("watchQQVideo").getChildByName("labCount").getComponent(cc.Label).string="("+(Number(o)-i)+"/"+o+")",0==i&&(this.ProtectNode.getChildByName("watchQQVideo").getChildByName("costGold").active=!1,this.ProtectNode.getChildByName("watchQQVideo").getChildByName("Label").getComponent(cc.Label).string="\u9996\u6b21\u514d\u8d39",this.m_isFree_qqhall=!0)),this.ProtectNode.getChildByName("scoreCount").getComponent(cc.Label).string="-"+e.losterScore}cc.find("Canvas").getChildByName("UI_Mask_"+this.node.name).active=this.node.active},t.prototype.onGiftBtnCallBack=function(){if(_.GamePlatform.isQQGameRoom()||_.GamePlatform.IsH5SmallBag()||_.GamePlatform.IsMiYaIosH5()||_.GamePlatform.IsDysbSmallBag()||_.GamePlatform.Is5Add7SmallBag())if(this.m_isFree_qqhall)(e=new m.C_Role_ReceiveFightWinExtra).isReceive=!0,d.ClientNetwork.getInstance().Send(m.ROLE_CLIENT_ENUM.P_Role_ReceiveFightWinExtra,e),this.ProtectNode.getChildByName("watchQQVideo").getComponent(cc.Button).interactable=!1;else{var e,t=C.CostGetTableData.getById(1004).cost[0].itemNum;if(!(c.default.getGoldNum()>=Number(t)))return S.G.StringManager.PopString("\u91d1\u5e01\u4e0d\u8db3\uff01");(e=new m.C_Role_ReceiveFightWinExtra).isReceive=!0,d.ClientNetwork.getInstance().Send(m.ROLE_CLIENT_ENUM.P_Role_ReceiveFightWinExtra,e),this.ProtectNode.getChildByName("watchQQVideo").getComponent(cc.Button).interactable=!1}else f.default.createVideo({name:"receive_fightWin_extra",adUnitId:p.RewardedVideoUnitIdConst.ReceiveFightWinExtra,advertID:p.RewardedVideoClientIdConst.ReceiveFightWinExtra,finishCb:function(){var e=new m.C_Role_ReceiveFightWinExtra;e.isReceive=!0,d.ClientNetwork.getInstance().Send(m.ROLE_CLIENT_ENUM.P_Role_ReceiveFightWinExtra,e)}})},t.prototype.onProtectBtnCallBack=function(){if(_.GamePlatform.isQQGameRoom()||_.GamePlatform.IsH5SmallBag()||_.GamePlatform.IsMiYaIosH5()||_.GamePlatform.IsDysbSmallBag()||_.GamePlatform.Is5Add7SmallBag())if(this.m_isFree_qqhall)(e=new m.C_Role_ReceiveFightLoserProtect).isReceive=!0,d.ClientNetwork.getInstance().Send(m.ROLE_CLIENT_ENUM.P_Role_ReceiveFightLoserProtect,e),this.ProtectNode.getChildByName("watchQQVideo").getComponent(cc.Button).interactable=!1;else{var e,t=C.CostGetTableData.getById(1004).cost[0].itemNum;if(!(c.default.getGoldNum()>=Number(t)))return S.G.StringManager.PopString("\u91d1\u5e01\u4e0d\u8db3\uff01");(e=new m.C_Role_ReceiveFightLoserProtect).isReceive=!0,d.ClientNetwork.getInstance().Send(m.ROLE_CLIENT_ENUM.P_Role_ReceiveFightLoserProtect,e),this.ProtectNode.getChildByName("watchQQVideo").getComponent(cc.Button).interactable=!1}else f.default.createVideo({name:"receive_fight_loser",adUnitId:p.RewardedVideoUnitIdConst.ReceiveFightLoserProtect,advertID:p.RewardedVideoClientIdConst.ReceiveFightLoserProtect,finishCb:function(){var e=new m.C_Role_ReceiveFightLoserProtect;e.isReceive=!0,d.ClientNetwork.getInstance().Send(m.ROLE_CLIENT_ENUM.P_Role_ReceiveFightLoserProtect,e)}})},t.prototype.changeAdButtonSkins=function(){_.GamePlatform.isByteDanceMiniGame()&&(v.default.getInstance().changeSkinOfAdButton(this.GiftNode.getChildByName("AcceptButton").getChildByName("Background"),"advertise"),v.default.getInstance().changeSkinOfAdButton(this.ProtectNode.getChildByName("AcceptButton").getChildByName("Background"),"advertise"))},t.prototype.onDestroy=function(){d.ClientNetwork.getInstance().removeLocalMessage(N.LOCAL_MESSAGE.LocalMsg_EnterMainScene,this),d.ClientNetwork.getInstance().removeMessageTarget(this),I.default.Instance.off(this,T.default.RefreshMainPlayerCupNum)},n([E(cc.Node)],t.prototype,"GiftNode",void 0),n([E(cc.Label)],t.prototype,"GiftCountLab",void 0),n([E(cc.Node)],t.prototype,"ProtectNode",void 0),n([E(cc.Label)],t.prototype,"ProtectCountLab",void 0),n([l.Register_Class,w],t)}(r.default);o.default=P,cc._RF.pop()},{"../Global/GameGlobal":"GameGlobal","../StaticData/CostGetTableData":"CostGetTableData","../common/EventConst":"EventConst","../common/NetworkProtocolCommon":"NetworkProtocolCommon","../common/PlayerModule":"PlayerModule","../modules/base/BaseView":"BaseView","../modules/base/Decorators":"Decorators","../modules/base/GameView":"GameView","../modules/manager/EventManager":"EventManager","../network/ClientNetwork":"ClientNetwork","../network/LocalMessage":"LocalMessage","../network/protocol/RoleProtocols":"RoleProtocols","../network/protocol/TypeProtocols":"TypeProtocols","../utils/ByteDanceMiniGameUtils":"ByteDanceMiniGameUtils","../utils/GamePlatform":"GamePlatform","../utils/GameTools":"GameTools","../utils/GameUtils":"GameUtils","../utils/RewardedVideoAd":"RewardedVideoAd","../utils/RewardedVideoUnitIdConst":"RewardedVideoUnitIdConst"}],DiscountRechargeTableData:[function(e,t,o){"use strict";cc._RF.push(t,"02bd6au3iZO64Rl1d4QPVHB","DiscountRechargeTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.DiscountRechargeTableData=void 0;var i=e("../TableReader"),a=function(){function e(){this.id=0,this.desc="",this.bg="",this.resId=0,this.scale=0,this.animationName=""}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.desc=e.getString(),this.bg=e.getString(),this.resId=e.getNumber(),this.scale=e.getNumber(),this.animationName=e.getString()},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"DiscountRechargeTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.DiscountRechargeTableData=a,cc._RF.pop()},{"../TableReader":"TableReader"}],DrawCardIntroduceView:[function(e,t,o){"use strict";cc._RF.push(t,"08875tlAA1IYZcEwm7/uCcp","DrawCardIntroduceView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=cc._decorator.ccclass,l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.path=function(){return"ui/drawcard/prefab/drawCardTips"},n([s.Register_Class,c],t)}(r.default);o.default=l,cc._RF.pop()},{"../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators"}],DrawCardMainCtrl:[function(e,t,o){"use strict";cc._RF.push(t,"18b5c7rFb5L5L/l/tmTjDFF","DrawCardMainCtrl");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseCtrl"),s=e("../../../scripts/modules/base/Decorators"),c=e("../../utils/LogUtil"),l=e("../../network/ClientNetwork"),d=e("../../network/protocol/RoleProtocols"),u=e("../../../scripts/modules/manager/ViewManager"),h=e("../../modules/base/GameView"),p=e("../../modules/manager/EventManager"),f=e("../../common/EventConst"),g=e("../../common/PlayerModule"),m=e("../../StaticData/StringValueTableData"),_=e("../../StaticData/DrawPrizeTableData"),y=e("../../utils/ConfigUtils"),v=cc._decorator,C=v.ccclass,S=(v.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.view=null,t}return a(t,e),t.prototype.init=function(){var e=this;this.onlistenProtocol(),p.default.Instance.on(f.default.SendProtocolDrawOne,function(){e.onSendProtocolDrawOne()},this),p.default.Instance.on(f.default.SendProtocolDrawTen,function(){e.onSendProtocolDrawTen()},this)},t.prototype.destroy=function(){p.default.Instance.off(this),l.ClientNetwork.getInstance().removeMessageTarget(this)},t.prototype.onlistenProtocol=function(){var e=this;l.ClientNetwork.getInstance().listenProtocol(d.ROLE_CLIENT_ENUM.P_Role_DrawPrize,function(t){t.resetPos();var o=new d.S_Role_DrawPrize;if(o.read(t))if(0===o.error&&o.prize.length>0){for(var i=function(e){if(2===y.default.getInstance().getItemByID(e).type){var t=g.default.getHeroCarData()[e];if(t&&0==t.bHeroLock)return!0}return!1},a=o.prize.length-1;a>=0;a--){var n=Math.floor(Math.random()*(a+1)),r=o.prize[n];o.prize[n]=o.prize[a],o.prize[a]=r}var s=[];o.prize.forEach(function(t){var o=i.call(e,t.dropID);s.forEach(function(e){e===t.dropID&&(o=!1)}),t.bNew=o,s.push(t.dropID)});var l=h.default.getViewByName("DrawCardShowView");l&&l.view?l.view.refreshView({prize:o.prize}):h.default.addPopView("BaseCtrl","DrawCardShowView","DrawCardShowView",{prize:o.prize})}else c.default.info(o)},this),l.ClientNetwork.getInstance().listenProtocol(d.ROLE_CLIENT_ENUM.P_Role_DrawBox_GetReward,function(e){e.resetPos();var t=new d.S_Role_DrawBox_GetReward;if(t.read(e)&&0==t.errorcode){var o=h.default.getViewByName("DrawCardOptionalBoxView");o&&o.view&&(o.view.node.active=!1,o.view.closeView()),h.default.addPopView("BaseCtrl","AcquirePopupView","AcquirePopupView",{items:t.prize})}},this)},t.prototype.onSendProtocolDrawOne=function(){var e=this,t=_.DrawPrizeTableData.getDataMap().get(1).cost;if(g.default.diamondNum<t[0].itemNum){var o=h.default.getViewByName("MainSceneView");if(o&&o.view&&0==o.view.getShopNodeShowState())return;h.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:m.StringValueTableData.getById(9).string_value,gotoCb:function(){e.view.closeView(),h.default.addPopView("ShopMainCtrl","ShopMainView","ShopMainView",{skipType:"Diamond"})}})}else{c.default.log("\u70b9\u51fb\u53d1\u9001\u5355\u62bd");var i=new d.C_Role_DrawPrize;i.type=1,i.num=1,l.ClientNetwork.getInstance().Send(d.ROLE_CLIENT_ENUM.P_Role_DrawPrize,i)}},t.prototype.onSendProtocolDrawTen=function(){var e=this,t=_.DrawPrizeTableData.getDataMap().get(1).cost;if(g.default.diamondNum<9*t[0].itemNum){var o=h.default.getViewByName("MainSceneView");if(o&&o.view&&0==o.view.getShopNodeShowState())return;h.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:m.StringValueTableData.getById(9).string_value,gotoCb:function(){e.view.closeView(),h.default.addPopView("ShopMainCtrl","ShopMainView","ShopMainView",{skipType:"Diamond"})}})}else{c.default.log("\u70b9\u51fb\u53d1\u9001\u5341\u62bd");var i=new d.C_Role_DrawPrize;i.type=1,i.num=10,l.ClientNetwork.getInstance().Send(d.ROLE_CLIENT_ENUM.P_Role_DrawPrize,i)}},n([u.AddViewEvent("SendProtocolDrawOne")],t.prototype,"onSendProtocolDrawOne",null),n([u.AddViewEvent("onSendProtocolDrawTen")],t.prototype,"onSendProtocolDrawTen",null),n([s.Register_Class2("DrawCardMainCtrl"),C],t)}(r.default));o.default=S,cc._RF.pop()},{"../../../scripts/modules/base/Decorators":"Decorators","../../../scripts/modules/manager/ViewManager":"ViewManager","../../StaticData/DrawPrizeTableData":"DrawPrizeTableData","../../StaticData/StringValueTableData":"StringValueTableData","../../common/EventConst":"EventConst","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseCtrl":"BaseCtrl","../../modules/base/GameView":"GameView","../../modules/manager/EventManager":"EventManager","../../network/ClientNetwork":"ClientNetwork","../../network/protocol/RoleProtocols":"RoleProtocols","../../utils/ConfigUtils":"ConfigUtils","../../utils/LogUtil":"LogUtil"}],DrawCardMainView:[function(e,t,o){"use strict";cc._RF.push(t,"1343ck7SvxBcYQwQCT5A2kp","DrawCardMainView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/manager/LoadResManager"),c=e("../../../scripts/modules/base/Decorators"),l=e("../../utils/LogUtil"),d=e("../../StaticData/DrawPrizeTableData"),u=e("../../utils/GameUtils"),h=e("../../utils/GameTools"),p=e("../../modules/base/GameView"),f=e("../../common/PlayerModule"),g=e("../../network/protocol/ObjCollection"),m=e("../../network/protocol/RoleProtocols"),_=e("../../utils/GamePlatform"),y=cc._decorator,v=y.ccclass,C=y.property,S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.drawOne=null,t.drawTen=null,t.priceOne=null,t.priceTen=null,t.recruitNode=null,t}return a(t,e),t.path=function(){return"ui/drawcard/prefab/drawCardMain"},t.prototype.init=function(){this.initRecruitProgress()},t.prototype.start=function(){this.initTopView();var e=d.DrawPrizeTableData.getDataMap().get(1).cost;this.priceOne.string=e[0].itemNum.toString(),this.priceTen.string=(9*e[0].itemNum).toString(),_.GamePlatform.isByteDanceMiniGame()&&(this.node.getChildByName("TipsButton").getComponent(cc.Widget).top=150)},t.prototype.initTopView=function(){var e=this;s.default.loadPrefab("ui/CommonPrefab/TopView").then(function(t){t.parent=e.node,t.getComponent("TopView").bindExitEvent(function(){e.closeView()})}).catch(function(e){l.default.info(e)})},t.prototype.onClickDrawOne=function(){this.sendEvent("SendProtocolDrawOne")},t.prototype.onClickDrawTen=function(){this.sendEvent("onSendProtocolDrawTen")},t.prototype.initRecruitProgress=function(){var e=f.default.getDrawPrizeData();e||((e=new m.T_DrawPrizeDetail).roundDrawNum=0,e.rewardBoxStateMap=new g.ObjMap,e.round=1);var t=u.getConfigIntValue("recruit_purple_box"),o=u.getConfigIntValue("recruit_golden_box"),i=e.roundDrawNum;this.recruitNode.getChildByName("pro_bar").getComponent(cc.ProgressBar).progress=i/Number(o),this.recruitNode.getChildByName("scheduleLab1").getComponent(cc.Label).string=i+"/"+t,this.recruitNode.getChildByName("scheduleLab2").getComponent(cc.Label).string=i+"/"+o;var a=function(e,t){var o=0;return e.forEach(function(e,i){t==i&&(o=e)}),1==o},n=a.call(this,e.rewardBoxStateMap,Number(t)),r=a.call(this,e.rewardBoxStateMap,Number(o));i>=Number(t)&&0==n?this.recruitNode.getChildByName("Box1Node").getComponent(cc.Animation).play("boxshake"):this.recruitNode.getChildByName("Box1Node").getComponent(cc.Animation).play("boxnormal"),i>=Number(o)&&0==r?this.recruitNode.getChildByName("Box2Node").getComponent(cc.Animation).play("boxshake"):this.recruitNode.getChildByName("Box2Node").getComponent(cc.Animation).play("boxnormal"),i>=Number(t)&&1==n?this.recruitNode.getChildByName("Box1Node").getComponent(sp.Skeleton).setAnimation(0,"idle2",!0):this.recruitNode.getChildByName("Box1Node").getComponent(sp.Skeleton).setAnimation(0,"idle",!0),i>=Number(o)&&1==r?this.recruitNode.getChildByName("Box2Node").getComponent(sp.Skeleton).setAnimation(0,"idle2",!0):this.recruitNode.getChildByName("Box2Node").getComponent(sp.Skeleton).setAnimation(0,"idle",!0),h.default.registerTouchEvent(this.recruitNode.getChildByName("Box1Node"),function(){p.default.addPopView("BaseCtrl","DrawCardOptionalBoxView","DrawCardOptionalBoxView",{boxType:t,roundNum:e.round,receiveState:n})}),h.default.registerTouchEvent(this.recruitNode.getChildByName("Box2Node"),function(){p.default.addPopView("BaseCtrl","DrawCardOptionalBoxView","DrawCardOptionalBoxView",{boxType:o,roundNum:e.round,receiveState:r})})},t.prototype.onClickTipCallBack=function(){p.default.addPopView("BaseCtrl","DrawCardIntroduceView","DrawCardIntroduceView")},n([C(cc.Button)],t.prototype,"drawOne",void 0),n([C(cc.Button)],t.prototype,"drawTen",void 0),n([C(cc.Label)],t.prototype,"priceOne",void 0),n([C(cc.Label)],t.prototype,"priceTen",void 0),n([C(cc.Node)],t.prototype,"recruitNode",void 0),n([c.Register_Class,v],t)}(r.default);o.default=S,cc._RF.pop()},{"../../../scripts/modules/base/Decorators":"Decorators","../../StaticData/DrawPrizeTableData":"DrawPrizeTableData","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/GameView":"GameView","../../modules/manager/LoadResManager":"LoadResManager","../../network/protocol/ObjCollection":"ObjCollection","../../network/protocol/RoleProtocols":"RoleProtocols","../../utils/GamePlatform":"GamePlatform","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils","../../utils/LogUtil":"LogUtil"}],DrawCardOptionalBoxView:[function(e,t,o){"use strict";cc._RF.push(t,"8b4a1kWvOBIVJBE3iiwmh04","DrawCardOptionalBoxView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=e("../../network/ClientNetwork"),l=e("../../network/protocol/RoleProtocols"),d=e("../../StaticData/RecruitTableData"),u=e("../../utils/GameTools"),h=e("../../modules/manager/LoadResManager"),p=e("../../network/protocol/BaseProtocols"),f=e("../../common/PlayerModule"),g=e("../../Global/GameGlobal"),m=cc._decorator.ccclass,_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._rewardsArrNode=[],t._drawCount=0,t._roundNum=0,t._receiveState=!1,t}return a(t,e),t.path=function(){return"ui/drawcard/prefab/OptionalBoxNode"},t.prototype.start=function(){},t.prototype.init=function(e){if(e.boxType){var t=[],o=f.default.getCurSeasonData();if(o.seasonID<=0)return;d.RecruitTableData.getDataMap().forEach(function(i){i.seasonId==o.seasonID&&i.index==e.roundNum&&i.count==e.boxType&&(t=i.prizes)}),this.initShowRewardsInfo(t),this._drawCount=Number(e.boxType),this._roundNum=e.roundNum,this._receiveState=e.receiveState;var i=this.node.getChildByName("btnYes");1==this._receiveState?(i.children[1].active=!0,i.children[0].active=!1,i.getComponent(cc.Button).interactable=!1,i.getComponent(cc.Button).enableAutoGrayEffect=!0):(i.children[1].active=!1,i.children[0].active=!0,i.getComponent(cc.Button).interactable=!0,i.getComponent(cc.Button).enableAutoGrayEffect=!1)}},t.prototype.initShowRewardsInfo=function(e){var t=this;e.sort(function(e,o){var i=t.checkHaveHero(e.itemID);return(1==t.checkHaveHero(o.itemID)?1:0)-(1==i?1:0)});var o=this.node.getChildByName("scrollview"),i=e.length,a=0;this.schedule(function(){if(e[a]){var i=new p.T_Reward;i.dropType=1,i.dropID=e[a].itemID,i.dropNum=e[a].itemNum,u.default.createNormalItems(e[a].itemID,e[a].itemNum,o.getComponent(cc.ScrollView).content,function(e){if(0==t.checkHaveHero(i.dropID))u.default.setNodeBright(e,!1);else{var o=new cc.Node("select");o.parent=e;var a=o.addComponent(cc.Sprite);h.default.loadSpriteFrame("ui/drawcard/res/xianzhong").then(function(e){a.spriteFrame=e}),o.active=!1,t._rewardsArrNode.length<=0&&(o.active=!0),o.scale=1.22}e.ItemInfo=i,e.on(cc.Node.EventType.TOUCH_END,function(e){if(!e.target.getChildByName("select"))return g.G.StringManager.PopString("\u5c1a\u672a\u83b7\u5f97\u6b64\u82f1\u96c4\uff01");t._rewardsArrNode.forEach(function(t){t.getChildByName("select")&&(t==e.target?t.getChildByName("select").active=!0:t.getChildByName("select").active=!1)})}),e.scale=.85,t._rewardsArrNode.push(e)})}if(++a>=e.length){var n=Math.ceil(e.length/5),r=Math.floor(t._rewardsArrNode[0].height*t._rewardsArrNode[0].scale)+o.getComponent(cc.ScrollView).content.getComponent(cc.Layout).spacingY;o.getComponent(cc.ScrollView).content.height=r*n}},0,i-1,0)},t.prototype.checkHaveHero=function(e){for(var t=f.default.getHeroCarData(),o=0;o<t.length;o++)if(t[o]&&e==t[o].heroId&&1==t[o].bHeroLock)return!0;return!1},t.prototype.onClickReceiveCallBack=function(){var e=null;if(this._rewardsArrNode.forEach(function(t){t.getChildByName("select")&&1==t.getChildByName("select").active&&(e=t.ItemInfo)}),!e)return g.G.StringManager.PopString("\u6ca1\u6709\u53ef\u9009\u7684\u82f1\u96c4\uff01");var t=f.default.getDrawPrizeData();if(!t||t.roundDrawNum<this._drawCount)return g.G.StringManager.PopString("\u62db\u52df\u6b21\u6570\u4e0d\u8db3\uff0c\u65e0\u6cd5\u9886\u53d6\uff01");var o=new l.C_Role_DrawBox_GetReward;o.round=this._roundNum,o.count=this._drawCount,o.reward=e,c.ClientNetwork.getInstance().Send(l.ROLE_CLIENT_ENUM.P_Role_DrawBox_GetReward,o)},n([s.Register_Class,m],t)}(r.default);o.default=_,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/RecruitTableData":"RecruitTableData","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/manager/LoadResManager":"LoadResManager","../../network/ClientNetwork":"ClientNetwork","../../network/protocol/BaseProtocols":"BaseProtocols","../../network/protocol/RoleProtocols":"RoleProtocols","../../utils/GameTools":"GameTools"}],DrawCardShowView:[function(e,t,o){"use strict";cc._RF.push(t,"2e119XuXARPVIOKkrOwKNhy","DrawCardShowView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../../scripts/modules/base/Decorators"),c=e("../../utils/LogUtil"),l=e("../../modules/manager/LoadResManager"),d=e("../../modules/manager/EventManager"),u=e("../../common/EventConst"),h=e("../../utils/ConfigUtils"),p=e("../../common/PlayerModule"),f=e("../../modules/base/GameView"),g=e("../../StaticData/SoundTableData"),m=e("../../utils/Tools"),_=e("../../utils/GamePlatform"),y=e("../../common/NetworkProtocolCommon"),v=e("../../StaticData/CostGetTableData"),C=["ui/common_res/quality1","ui/common_res/quality2","ui/common_res/quality3","ui/common_res/quality4"],S=cc._decorator,T=S.ccclass,I=S.property,N=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.continueNode=null,t.cardLayoutNode=null,t.cardPrefab=null,t.newCardPrefab=null,t.canceal=null,t.confirm=null,t._cardIndex=0,t._GoldHeroNum=0,t._drawCardData=null,t._isShared=!1,t._time=0,t}return a(t,e),t.path=function(){return"ui/drawcard/prefab/showDrawCard"},t.prototype.onLoad=function(){var e=this;if(_.GamePlatform.isWechat()){var t=function(){if(e._isShared){console.log("\u5206\u4eab\u6210\u529f"),e._isShared=!1;var o=(new Date).getTime(),i=o-e._time;console.log("reduceTime===================",i),e._time=o,cc.isValid(this)&&i>=1e3&&(1==e.confirm.children[2].active&&y.default.callRoleCostGet(3),wx.offShow(t))}};wx.onShow(t)}else if(_.GamePlatform.isQQMiniGame()){var o=function(){if(e._isShared){console.log("\u5206\u4eab\u6210\u529f"),e._isShared=!1;var t=(new Date).getTime(),i=t-e._time;console.log("reduceTime===================",i),e._time=t,cc.isValid(this)&&i>=1e3&&(1==e.confirm.children[2].active&&y.default.callRoleCostGet(3),qq.offShow(o))}};qq.onShow(o)}},t.prototype.start=function(){var e=this;this.continueNode.active=!1,this.canceal.active=!1,this.confirm.active=!1,this.node.on(cc.Node.EventType.TOUCH_END,function(){!1!==e.continueNode.active&&(e.node.off(cc.Node.EventType.TOUCH_END),e.scheduleOnce(function(){e.onContinueCallBack()},.2))})},t.prototype.init=function(e){this.refreshView(e)},t.prototype.refreshView=function(e){this._cardIndex=0;var t=this.cardLayoutNode.getComponent(cc.Layout);1===e.prize.length?(this.cardLayoutNode.width=this.cardPrefab.data.width,this.cardLayoutNode.height=this.cardPrefab.data.height):(this.cardLayoutNode.width=4*(this.cardPrefab.data.width+t.spacingX)+this.cardPrefab.data.width,this.cardLayoutNode.height=this.cardPrefab.data.height+t.spacingY+this.cardPrefab.data.height);var o=g.SoundTableData.getById(7).res;m.playAudioEffect(o),this.cardLayoutNode.removeAllChildren(),this._drawCardData=e.prize,this.createCard(e.prize[this._cardIndex]),this.setDrawCardBtnActive(!1)},t.prototype.initTopView=function(){var e=this;l.default.loadPrefab("ui/CommonPrefab/TopView").then(function(t){t.parent=e.node,t.getComponent("TopView").bindExitEvent(function(){e.closeView()})}).catch(function(e){c.default.info(e)})},t.prototype.setDrawCardBtnActive=function(e){if((_.GamePlatform.isWechat()||_.GamePlatform.isQQMiniGame())&&this._GoldHeroNum>=2){this.continueNode.active=!1,this.canceal.active=!0,this.confirm.active=!0;var t=v.CostGetTableData.getById(3).get[0].itemNum,o=v.CostGetTableData.getById(3).dayMaxNum;this.confirm.getChildByName("get").getComponent(cc.Label).string="\u6bcf\u65e5\u524d3\u6b21\u5206\u4eab\u53ef\u5f97"+t;var i=p.default.getCostGetDataByID(3);i&&i>=o&&(this.confirm.children[2].active=!1,this.confirm.children[3].active=!1)}else this.continueNode.active=e},t.prototype.createCard=function(e){var t=this,o=cc.instantiate(this.cardPrefab);o.scale=.1,o.parent=this.cardLayoutNode,this.setCardInfo(o,e),cc.tween(o).to(.16,{scale:1.25}).to(.16,{scale:1}).call(function(){f.default.getViewByName("DrawNewHeroCardView")?t.schedule(t.onScheduleNewHeroInfo,1):(t._cardIndex++,t._cardIndex<t._drawCardData.length&&t.createCard(t._drawCardData[t._cardIndex])),t._cardIndex>=t._drawCardData.length&&t.setDrawCardBtnActive(!0)}).start()},t.prototype.onScheduleNewHeroInfo=function(){f.default.getViewByName("DrawNewHeroCardView")||(this._cardIndex++,this._cardIndex<this._drawCardData.length&&this.createCard(this._drawCardData[this._cardIndex]),this.unschedule(this.onScheduleNewHeroInfo)),this._cardIndex>=this._drawCardData.length&&this.setDrawCardBtnActive(!0)},t.prototype.setCardInfo=function(e,t){var o=h.default.getInstance().getItemByID(t.dropID);if(o){e.getChildByName("bg").active=!1,(_.GamePlatform.isWechat()||_.GamePlatform.isQQMiniGame())&&4==o.quality&&this._GoldHeroNum++,l.default.loadSpriteFrame(C[o.quality-1]).then(function(t){e.getChildByName("bg").getComponent(cc.Sprite).spriteFrame=t,e.getChildByName("bg").active=!0}).catch(function(e){c.default.info(e)}),e.getChildByName("icon").active=!1,l.default.loadSpriteFrame(o.icon).then(function(t){e.getChildByName("icon").getComponent(cc.Sprite).spriteFrame=t,e.getChildByName("icon").active=!0}).catch(function(e){c.default.info(e)}),e.getChildByName("num").getComponent(cc.Label).string="",t.dropNum>1?e.getChildByName("name").getComponent(cc.Label).string=o.name+" x "+t.dropNum:e.getChildByName("name").getComponent(cc.Label).string=o.name;var i=t.bNew;e.getChildByName("new_s").active=i,2!=o.type||!0!==i&&4!==o.quality||f.default.addPopView("BaseCtrl","DrawNewHeroCardView","DrawNewHeroCardView",{heroId:t.dropID,bShowNew:i,bPlaySound:!0,bAction:!0})}else console.log("read ItemTableData nill")},t.prototype.checkNewHeroCard=function(e){if(2===h.default.getInstance().getItemByID(e).type){var t=p.default.getHeroCarData()[e];if(t&&0==t.bHeroLock)return!0}return!1},t.prototype.onClickDrawOne=function(){d.default.Instance.emit(u.default.SendProtocolDrawOne)},t.prototype.onClickDrawTen=function(){d.default.Instance.emit(u.default.SendProtocolDrawTen)},t.prototype.onContinueCallBack=function(){this._GoldHeroNum<2&&this.closeView()},t.prototype.onClose=function(){this.closeView()},t.prototype.onShareBtnCallBack=function(){_.GamePlatform.isWechat()&&this._GoldHeroNum>=2?(this._isShared=!0,this._time=(new Date).getTime(),wx.shareAppMessage({title:"\u5feb\u6765\u4e00\u8d77\u5438\u6b27\u6c14\u5427\uff01",imageUrl:"https://tfjl-1300944069.file.myqcloud.com/shareBg.png"}),this.confirm.getComponent(cc.Button).interactable=!1,this.confirm.getComponent(cc.Button).enableAutoGrayEffect=!0):_.GamePlatform.isQQMiniGame()&&this._GoldHeroNum>=2&&(this._isShared=!0,this._time=(new Date).getTime(),qq.shareAppMessage({title:"\u5feb\u6765\u4e00\u8d77\u5438\u6b27\u6c14\u5427\uff01",imageUrl:"https://tfjl-1300944069.file.myqcloud.com/shareBg.png"}),this.confirm.getComponent(cc.Button).interactable=!1,this.confirm.getComponent(cc.Button).enableAutoGrayEffect=!0)},t.prototype.onDestroy=function(){this.unschedule(this.onScheduleNewHeroInfo)},n([I(cc.Node)],t.prototype,"continueNode",void 0),n([I(cc.Node)],t.prototype,"cardLayoutNode",void 0),n([I(cc.Prefab)],t.prototype,"cardPrefab",void 0),n([I(cc.Prefab)],t.prototype,"newCardPrefab",void 0),n([I(cc.Node)],t.prototype,"canceal",void 0),n([I(cc.Node)],t.prototype,"confirm",void 0),n([s.Register_Class,T],t)}(r.default);o.default=N,cc._RF.pop()},{"../../../scripts/modules/base/Decorators":"Decorators","../../StaticData/CostGetTableData":"CostGetTableData","../../StaticData/SoundTableData":"SoundTableData","../../common/EventConst":"EventConst","../../common/NetworkProtocolCommon":"NetworkProtocolCommon","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/GameView":"GameView","../../modules/manager/EventManager":"EventManager","../../modules/manager/LoadResManager":"LoadResManager","../../utils/ConfigUtils":"ConfigUtils","../../utils/GamePlatform":"GamePlatform","../../utils/LogUtil":"LogUtil","../../utils/Tools":"Tools"}],DrawNewHeroCardView:[function(e,t,o){"use strict";cc._RF.push(t,"885aeS451JBWYj+bNcteHBs","DrawNewHeroCardView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../utils/ConfigUtils"),c=e("../../modules/manager/LoadResManager"),l=e("../../utils/LogUtil"),d=e("../../utils/ResourcesManager"),u=e("../../utils/ConstValue"),h=e("../../../scripts/modules/base/Decorators"),p=e("../../utils/Tools"),f=e("../../StaticData/SoundTableData"),g=cc._decorator,m=g.ccclass,_=g.property,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.scroview=null,t.cardsAttrfab=null,t.heroCardAniNode=null,t.heroDescribe=null,t._heroId=0,t._nodeArr=[],t._bIsNewHero=!1,t}return a(t,e),t.path=function(){return"ui/drawcard/prefab/newCardInfo"},t.prototype.init=function(e){var t=this;if(this._heroId=e.heroId,this._bIsNewHero=e.bShowNew,this.showCardAttr(),this.showHeroCardInfo(),1==e.bAction?setTimeout(function(){t.onShowNewHeroAction()},30):(this.node.getChildByName("UI_Root").active=e.bShowNew,this.showHeroCardAni()),e.bPlaySound){var o=f.SoundTableData.getById(3).res;p.playAudioEffect(o)}},t.prototype.start=function(){var e=this;cc.tween(this.node).delay(.5).call(function(){e.node.on(cc.Node.EventType.TOUCH_END,function(){!0===e.node.getChildByName("tips").active&&e.closeView()})}).start()},t.prototype.onShowNewHeroAction=function(){var e=this;this._nodeArr.push({targetPos:this.node.getChildByName("HeroStatus").position,direction:1,targetNode:this.node.getChildByName("HeroStatus")}),this._nodeArr.push({targetPos:this.node.getChildByName("HeroInfo").position,direction:0,targetNode:this.node.getChildByName("HeroInfo")}),this._nodeArr.push({targetPos:this.node.getChildByName("Skill1").position,direction:0,targetNode:this.node.getChildByName("Skill1")}),this._nodeArr.push({targetPos:this.node.getChildByName("Skill2").position,direction:0,targetNode:this.node.getChildByName("Skill2")}),this._nodeArr.push({targetPos:this.node.getChildByName("Skill3").position,direction:0,targetNode:this.node.getChildByName("Skill3")}),this._nodeArr.forEach(function(e){0===e.direction?e.targetNode.getComponent(cc.Widget).left=-e.targetNode.width:e.targetNode.getComponent(cc.Widget).right=-e.targetNode.width,e.targetNode.getComponent(cc.Widget).updateAlignment(),e.targetNode.active=!1}),this.node.getChildByName("UI_Root").active=!1,this.node.getChildByName("tips").active=!1,this.node.getChildByName("pvefang").active=!0,this.node.getChildByName("shadow_hero").active=!0,this.showHeroCardAni(),this.node.getChildByName("pvefang").getComponent(sp.Skeleton).setAnimation(0,"fang",!1),this.node.getChildByName("pvefang").getComponent(sp.Skeleton).setCompleteListener(function(){e._nodeArr.forEach(function(e){e.targetNode.active=!0,cc.tween(e.targetNode).to(.35,{x:e.targetPos.x}).start()}),cc.tween(e.node).delay(.65).call(function(){e.node.getChildByName("UI_Root").active=e._bIsNewHero,e.node.getChildByName("tips").active=!0}).start()})},t.prototype.showCardAttr=function(){for(var e=s.default.getInstance().getHeroConfig(this._heroId).npc_id,t=s.default.getInstance().getNpcTemplateConfig(e,1),o=s.default.getInstance().getHeroConfig(this._heroId).occupation,i=s.default.getInstance().getSkillConfig(t.skill_id),a=t.carhp,n=[t.attack,u.cardProfDesc[o],i.cd/1e3+"\u79d2/\u6b21",a],r=0;r<n.length;r++){var c=cc.instantiate(this.cardsAttrfab);c&&(this.setCarAttrInfo(n[r],c,r),this.scroview.content.addChild(c))}this.node.getChildByName("Skill1").getChildByName("Skill_Desc1").getComponent(cc.Label).string=i.skill_desc},t.prototype.setCarAttrInfo=function(e,t,o){c.default.loadSpriteFrame("ui/card_attricon/"+(o+1)).then(function(e){t.getChildByName("icon").getComponent(cc.Sprite).spriteFrame=e}).catch(function(e){l.default.info(e)}),t.getChildByName("type").getComponent(cc.Label).string=u.cardDescArry[o],t.getChildByName("num").getComponent(cc.Label).string=e},t.prototype.showHeroCardAni=function(){var e=this,t=s.default.getInstance().getHeroConfig(this._heroId).npc_id,o=s.default.getInstance().getNpcTemplateConfig(t,1).res_id,i=s.default.getInstance().getResConfig(o).uiScale;c.default.loadSpineNode(s.default.getInstance().getResConfig(o).animation).then(function(t){t.parent=e.heroCardAniNode,t.getComponent(sp.Skeleton).setAnimation(0,"idle",!0),t.scale=t.scale*i/100}).catch(function(e){l.default.info(e)})},t.prototype.showHeroCardInfo=function(){var e=s.default.getInstance().getHeroConfig(this._heroId),t=this.node.getChildByName("HeroInfo");t.getChildByName("HeroName").getComponent(cc.Label).string=e.name,t.getChildByName("heroProf").getComponent(cc.Label).string=["\u6218\u58eb","\u730e\u4eba","\u6cd5\u5e08","\u7267\u5e08","\u53ec\u5524","\u7cbe\u7075","\u718a\u732b","\u5de5\u7a0b","\u672f\u58eb"][e.occupation-1],c.default.loadSpriteFrame("ui/bag/img/a"+e.hero_color).then(function(e){t.getComponent(cc.Sprite).spriteFrame=e}).catch(function(e){l.default.info(e)});var o=t.getChildByName("ProfNode");d.default.loadSprite("ui/bag/img/prof"+e.hero_color,o.getComponent(cc.Sprite),function(e){e.addRef()}),d.default.loadSprite("ui/bag/img/"+["zhanshi","lieshou","fashi","mushi","zhaohuan","jingling","xiongmao","gongcheng","renzhe"][e.occupation-1],o.getChildByName("ProSprite").getComponent(cc.Sprite),function(e){e.addRef()});var i=this.node.getChildByName("Skill1").getChildByName("Skill_Icon1");c.default.loadSpriteFrame(e.skill_icon).then(function(e){i.getComponent(cc.Sprite).spriteFrame=e}).catch(function(e){l.default.info(e)}),this.node.getChildByName("Skill2").getChildByName("Skill_Desc2").getComponent(cc.Label).string=e.passive_desc,this.node.getChildByName("Skill3").getChildByName("Skill_Desc3").getComponent(cc.Label).string=e.passive_desc2,this.heroDescribe.string=e.hero_desc},n([_(cc.ScrollView)],t.prototype,"scroview",void 0),n([_(cc.Prefab)],t.prototype,"cardsAttrfab",void 0),n([_(cc.Node)],t.prototype,"heroCardAniNode",void 0),n([_(cc.Label)],t.prototype,"heroDescribe",void 0),n([h.Register_Class,m],t)}(r.default);o.default=y,cc._RF.pop()},{"../../../scripts/modules/base/Decorators":"Decorators","../../StaticData/SoundTableData":"SoundTableData","../../modules/base/BaseView":"BaseView","../../modules/manager/LoadResManager":"LoadResManager","../../utils/ConfigUtils":"ConfigUtils","../../utils/ConstValue":"ConstValue","../../utils/LogUtil":"LogUtil","../../utils/ResourcesManager":"ResourcesManager","../../utils/Tools":"Tools"}],DrawPrizePoolTableData:[function(e,t,o){"use strict";cc._RF.push(t,"329d7iINL5Fp7KCNtyWVLjr","DrawPrizePoolTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.DrawPrizePoolTableData=void 0;var i=e("../TableReader"),a=function(){function e(){this.id=0,this.poolid=0,this.weight=0,this.prize=new Array,this.strName1="",this.strName2="",this.seasonId=0}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.poolid=e.getNumber(),this.weight=e.getNumber();for(var o=e.getString(),a=new i.TableReader(o);a.getPos()<a.getLen();){var n;n=a.getNumber(),this.prize.push(n)}this.strName1=e.getString(),this.strName2=e.getString(),this.seasonId=e.getNumber()},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"DrawPrizePoolTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.DrawPrizePoolTableData=a,cc._RF.pop()},{"../TableReader":"TableReader"}],DrawPrizeTableData:[function(e,t,o){"use strict";cc._RF.push(t,"d69aeOBW41AYb/dhDhgnpM2","DrawPrizeTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.DrawPrizeTableData=o.DrawPrizePool=void 0;var i=e("../TableReader"),a=e("./BaseTableData"),n=function(){function e(){this.poolid=0,this.num=0,this.poolType=0}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.poolid=e.getNumber(),this.num=e.getNumber(),this.poolType=e.getNumber()},e}();o.DrawPrizePool=n;var r=function(){function e(){this.type=0,this.score=0,this.limitLevel=0,this.drawNum=0,this.cost=new Array,this.totalNum=0,this.guideDrawNum=0,this.guidePool=new Array,this.commonPool=new Array}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.type=e.getNumber(),this.score=e.getNumber(),this.limitLevel=e.getNumber(),this.drawNum=e.getNumber();for(var o=e.getString(),r=new i.TableReader(o);r.getPos()<r.getLen();)(l=new a.ItemInfo).readOriginal(r),this.cost.push(l);this.totalNum=e.getNumber(),this.guideDrawNum=e.getNumber(),o=e.getString();for(var s=new i.TableReader(o);s.getPos()<s.getLen();)(l=new n).readOriginal(s),this.guidePool.push(l);o=e.getString();for(var c=new i.TableReader(o);c.getPos()<c.getLen();){var l;(l=new n).readOriginal(c),this.commonPool.push(l)}},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"DrawPrizeTableData"},e.prototype.isAutoId=function(){return!0},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.DrawPrizeTableData=r,cc._RF.pop()},{"../TableReader":"TableReader","./BaseTableData":"BaseTableData"}],DropEquipObj:[function(e,t,o){"use strict";cc._RF.push(t,"8e5e5Jfd5NNLIWb2jgV8OC0","DropEquipObj"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../logic/PassiveSkill"),a=e("../../utils/ConstValue"),n=e("../../utils/ResourcesManager"),r=e("../../utils/ConfigUtils"),s=e("../../common/CombatModule"),c=e("../../combat/CombatManager"),l=function(){function e(){this._pPassiveSkillObjList=[],this._pMaxStarPassiveSkillObjList=[],this.camp=0,this.occupation=a.HERO_PROF_TYPE.Warrior,this._templateId=0,this.starNum=1,this.equipNodeName=""}return e.prototype.destroy=function(){if(this._pPassiveSkillObjList)for(var e in this._pPassiveSkillObjList)this._pPassiveSkillObjList[e]&&(this._pPassiveSkillObjList[e].pBindNpcObj=this,this._pPassiveSkillObjList[e].unbind(),this._pPassiveSkillObjList[e]=null);if(this._pMaxStarPassiveSkillObjList)for(var e in this._pMaxStarPassiveSkillObjList)this._pMaxStarPassiveSkillObjList[e]&&(this._pMaxStarPassiveSkillObjList[e].pBindNpcObj=this,this._pMaxStarPassiveSkillObjList[e].unbind(),this._pMaxStarPassiveSkillObjList[e]=null)},e.prototype.init=function(e,t,o,i,a,n){var l=s.default.getDropEquipList(),d=l[i]?l[i]:[];if(d.length>0)(p=d[d.length-1]._templateId)!=e&&(e=p,cc.log("\u8fd1\u4e86\u5417 equip-------444444444444-----------------"));else{var u=c.default.getInstance().getPlayerModelByCamp(i);if(u&&Object.keys(u.carInfo.tbEquipInfo).length>0)for(var h in u.carInfo.tbEquipInfo){var p;(p=h)!=e&&(e=p,cc.log("tbEquipInfo equip-------444444444444-----------------"))}}var f=r.default.getInstance().getEquipByID(e);if(!(f.length<=0)){for(var g=0,m=0;m<d.length;m++)d[m]._templateId==e&&d[m].starNum>g&&(g=d[m].starNum);this.starNum=g+1;var _=null;for(m=0;m<f.length;m++)if(f[m].star===this.starNum){_=f[m];break}_&&(this.camp=i,this._templateId=e,a&&this.showEquipNode(o,_,a,t,n))}},e.prototype.onReconnectInit=function(e,t,o){var i=r.default.getInstance().getEquipByID(e);if(!(i.length<=0)){console.log("onReconnectInit"+e+"star"+o),this.starNum=o;for(var s=null,l=0;l<i.length;l++)if(i[l].star===this.starNum){s=i[l];break}if(s){this.camp=t,this._templateId=e,this.onAddPassiveSkill(s),this.onAddMaxStarPassiveSkill(s);var d=null,u=c.default.getInstance().getController()._downPrefabNode;u&&(this.camp==a.PLAYER_CAMP.myPlayer?(d=u.getChildByName("EquipBag").getChildByName("EquipList").getChildByName("EquipNode"+s.equipType),u.getChildByName("EquipBag").getChildByName("EquipList").children.forEach(function(e){e.active=!1})):(d=u.getChildByName("EquipBag_b").getChildByName("EquipList_b").getChildByName("EquipNode"+s.equipType+"_b"),u.getChildByName("EquipBag_b").getChildByName("EquipList_b").children.forEach(function(e){e.active=!1})),this.equipNodeName=d.name,d.active=!0,n.default.loadSprite(s.icon,d.getComponent(cc.Sprite)))}}},e.prototype.showEquipNode=function(e,t,o,i,a){void 0===i&&(i=cc.Vec3.ZERO),void 0===a&&(a=1);var l=new cc.Node;l.parent=e,l.position=i;var d=c.default.getInstance().getController().dropBoxConfig.spineId;if(a%1e3==2||a%1e3==3)if(Math.floor(a/1e3)==s.default.matchRoleIdentity)d=c.default.getInstance().getController().monkeyDropBoxConfig[this.camp].spineId;else{var u=this.camp;s.default.getCombatType()==s.CombatType.COOP&&(u=c.default.getInstance().getCoopCarCamp(this.camp)),d=c.default.getInstance().getController().monkeyDropBoxConfig[u].spineId}var h=r.default.getInstance().getResConfig(d),p=this,f=function(e){var i=new cc.Node;i.parent=l,i.addComponent(cc.Sprite),i.scale=0,i.opacity=0,i.y=-70,i.x=23;var a=r.default.getInstance().getEquipByID(p._templateId);n.default.loadSprite(a[0].icon,i.getComponent(cc.Sprite),function(){cc.tween(i).to(1,{opacity:255}).parallel(cc.tween().to(.35,{y:0}),cc.tween().to(.35,{scale:.7})).delay(.5).call(function(){e&&e.destroy(),p.flyToEquipBox(i,t.equipType,o)}).start()})};cc.resources.load(h.animation,sp.SkeletonData,function(e,t){if(e)f(null);else{var o=new cc.Node,i=o.addComponent(sp.Skeleton);i&&(i.skeletonData=t,i.setSkin("default"),i.setAnimation(0,"idle",!0)),o.parent=l,o.x=21,o.y=-84,o.angle=5,o.scaleX=-.3,o.scaleY=.3;var a=o.getComponent(sp.Skeleton);a.setAnimation(0,"attack",!1),a.addAnimation(0,"dead",!0),f(o)}}),this.onAddPassiveSkill(t),this.onAddMaxStarPassiveSkill(t)},e.prototype.onAddPassiveSkill=function(e){if(!this.getPlayerEquipInvaildState()&&""!=e.passiveId){var t=e.passiveId.split("|");for(var o in t){var n=Number(t[o]);switch(this._pPassiveSkillObjList[n]=new i,r.default.getInstance().getPassiveSkillConfig(n).type){case 18:this.occupation=a.HERO_PROF_TYPE.Warrior;break;case 19:this.occupation=a.HERO_PROF_TYPE.Hunter;break;case 20:this.occupation=a.HERO_PROF_TYPE.Mage;break;case 21:this.occupation=a.HERO_PROF_TYPE.Priest;break;case 22:this.occupation=a.HERO_PROF_TYPE.Summoner}this._pPassiveSkillObjList[n].init(n,this)}}},e.prototype.onAddMaxStarPassiveSkill=function(e){if(!this.getPlayerEquipInvaildState()&&""!=e.maxpassiveId){var t=e.maxpassiveId.split("|");for(var o in t){var n=Number(t[o]);switch(this._pMaxStarPassiveSkillObjList[n]=new i,r.default.getInstance().getPassiveSkillConfig(n).type){case 18:this.occupation=a.HERO_PROF_TYPE.Warrior;break;case 19:this.occupation=a.HERO_PROF_TYPE.Hunter;break;case 20:this.occupation=a.HERO_PROF_TYPE.Mage;break;case 21:this.occupation=a.HERO_PROF_TYPE.Priest;break;case 22:this.occupation=a.HERO_PROF_TYPE.Summoner}this._pMaxStarPassiveSkillObjList[n].init(n,this)}}},e.prototype.flyToEquipBox=function(e,t,o){var i=this,n=null;if(n=this.camp==a.PLAYER_CAMP.myPlayer?o.getChildByName("EquipBag").getChildByName("EquipList").getChildByName("EquipNode"+t):o.getChildByName("EquipBag_b").getChildByName("EquipList_b").getChildByName("EquipNode"+t+"_b"),this.equipNodeName=n.name,n){var r=n.convertToWorldSpaceAR(cc.v2(0,0));r=e.parent.convertToNodeSpaceAR(r),cc.tween(e).delay(.5).parallel(cc.tween().to(.6,{position:r}),cc.tween().to(.6,{scale:n.scale})).call(function(){e.parent.destroy(),o.getComponent("FightCardView").onRefreshDropEquip(i._templateId,i.starNum,i.camp)}).start()}},Object.defineProperty(e.prototype,"equipId",{get:function(){return this._templateId},set:function(e){this._templateId=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"equipStar",{get:function(){return this.starNum},set:function(e){this.starNum=e},enumerable:!1,configurable:!0}),e.prototype.getPlayerEquipInvaildState=function(){var e=c.default.getInstance().getPlayerModelByCamp(this.camp);return!(!e||!e.getEquipInvaildState())},e}();o.default=l,cc._RF.pop()},{"../../combat/CombatManager":"CombatManager","../../common/CombatModule":"CombatModule","../../utils/ConfigUtils":"ConfigUtils","../../utils/ConstValue":"ConstValue","../../utils/ResourcesManager":"ResourcesManager","../logic/PassiveSkill":"PassiveSkill"}],DropMaterialsObj:[function(e,t,o){"use strict";cc._RF.push(t,"1c5e9Tg0/tHGoP2TxOfWdV1","DropMaterialsObj"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../utils/ResourcesManager"),a=e("../../utils/ConfigUtils"),n=e("../CombatManager"),r=e("../../utils/ConstValue"),s=e("../../network/protocol/TypeProtocols"),c=e("../../common/CombatModule"),l=function(){function e(){this.camp=0,this._templateId=0}return e.prototype.init=function(e,t,o,i,n,r,s){var c=a.default.getInstance().getItemByID(e);c&&(this.camp=i,this._templateId=e,this.showMaterialsNode(o,c,n,t,r,s))},e.prototype.showMaterialsNode=function(e,t,o,r,s,l){void 0===r&&(r=cc.Vec3.ZERO),void 0===s&&(s=0),void 0===l&&(l=1);var d=new cc.Node;d.parent=e,d.position=r,d.name="materialsNode";var u=n.getInstance().getController().dropBoxConfig.spineId;if(l%1e3==2||l%1e3==3)if(Math.floor(l/1e3)==c.default.matchRoleIdentity)u=n.getInstance().getController().monkeyDropBoxConfig[this.camp].spineId;else{var h=this.camp;c.default.getCombatType()==c.CombatType.COOP&&(h=n.getInstance().getCoopCarCamp(this.camp)),u=n.getInstance().getController().monkeyDropBoxConfig[h].spineId}var p=a.default.getInstance().getResConfig(u),f=this,g=function(e){var a=new cc.Node;a.parent=d,a.addComponent(cc.Sprite),a.scale=.1,a.opacity=0,a.y=-70,a.x=23,i.default.loadSprite(t.icon,a.getComponent(cc.Sprite),function(){cc.tween(a).to(1,{opacity:255}).parallel(cc.tween().to(.35,{y:0}),cc.tween().to(.35,{scale:.7})).delay(.5).call(function(){e&&e.destroy(),f.flyToTargetNode(a,o,s)}).start()})};cc.resources.load(p.animation,sp.SkeletonData,function(e,t){if(e)g(null);else{var o=new cc.Node,i=o.addComponent(sp.Skeleton);i&&(i.skeletonData=t,i.setSkin("default"),i.setAnimation(0,"idle",!0)),o.parent=d,o.x=21,o.y=-84,o.angle=5,o.scaleX=-.3,o.scaleY=.3;var a=o.getComponent(sp.Skeleton);a.setAnimation(0,"attack",!1),a.addAnimation(0,"dead",!0),g(o)}})},e.prototype.flyToTargetNode=function(e,t,o){var i=this;if(void 0===o&&(o=0),1003===Number(this._templateId)){if(this.camp!=r.PLAYER_CAMP.myPlayer){var a=n.getInstance().getPlayerModelByCamp(this.camp);return a&&a.addMoney(o),void e.parent.destroy()}if(!cc.isValid(t))return void(e&&e.parent&&e.parent.destroy());var c=(t=t.getChildByName("CurNum")).convertToWorldSpaceAR(cc.v2(0,0));c=e.parent.convertToNodeSpaceAR(c),cc.tween(e).delay(.5).parallel(cc.tween().to(.6,{position:c}),cc.tween().to(.6,{scale:.25})).call(function(){e.parent.destroy();var t=n.getInstance().getPlayerModelByCamp(i.camp);t&&(t.addMoney(o,s.SP_CHANGE_TYPE.SP_CHANGE_TYPE_ADD_MINE),t.carInfo.boxSliveNum.value-=100,t.carInfo.boxSliveNum.value<0&&(t.carInfo.boxSliveNum.value=0))}).start()}},e}();o.default=l,cc._RF.pop()},{"../../common/CombatModule":"CombatModule","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/ConfigUtils":"ConfigUtils","../../utils/ConstValue":"ConstValue","../../utils/ResourcesManager":"ResourcesManager","../CombatManager":"CombatManager"}],EatChickenRankListTableData:[function(e,t,o){"use strict";cc._RF.push(t,"c53a5s2YExPtICAryNNIdH7","EatChickenRankListTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.EatChickenRankListTableData=void 0;var i=e("../TableReader"),a=e("./BaseTableData"),n=function(){function e(){this.id=0,this.rankMin=0,this.rankMax=0,this.prize=new Array}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.rankMin=e.getNumber(),this.rankMax=e.getNumber();for(var o=e.getString(),n=new i.TableReader(o);n.getPos()<n.getLen();){var r=new a.DropItem;r.readOriginal(n),this.prize.push(r)}},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"EatChickenRankListTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.EatChickenRankListTableData=n,cc._RF.pop()},{"../TableReader":"TableReader","./BaseTableData":"BaseTableData"}],EndGame:[function(e,t,o){"use strict";cc._RF.push(t,"599590PRXZKWJ3GvYSxn7BY","EndGame");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../combat/CombatManager"),s=e("../Global/GameGlobal"),c=e("../common/CombatModule"),l=e("../network/ClientNetwork"),d=e("../network/LocalMessage"),u=cc._decorator,h=u.ccclass,p=(u.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.onLoad=function(){this._successNode=this.node.getChildByName("success_icon"),this._failNode=this.node.getChildByName("failNode"),this._backNode=this.node.getChildByName("back_node")},t.prototype.start=function(){this._backNode.on(cc.Node.EventType.TOUCH_END,function(){r.getInstance().exitMap(),r.getInstance().getSelfCombatModel().unregistMessage();var e=c.default.getCombatType();c.default.destroy(),s.G.UIManager.gotoMainScene(null,function(){e==c.CombatType.PVE&&l.ClientNetwork.getInstance().pushLocalMessage(d.LOCAL_MESSAGE.LocalMsg_OpenPveLayer)})},this)},t.prototype.init=function(e){this._successNode.active=!1,this._failNode.active=!1,1==e?(this._successNode.active=!0,this._successNode.getChildByName("curTimes").getComponent(cc.Label).string=r.getInstance().batchModel.getIndexTip()):(this._failNode.active=!0,this._failNode.getChildByName("curTimes").getComponent(cc.Label).string=r.getInstance().batchModel.getIndexTip())},n([h],t)}(cc.Component));o.default=p,cc._RF.pop()},{"../Global/GameGlobal":"GameGlobal","../combat/CombatManager":"CombatManager","../common/CombatModule":"CombatModule","../network/ClientNetwork":"ClientNetwork","../network/LocalMessage":"LocalMessage"}],EquipTempView:[function(e,t){"use strict";cc._RF.push(t,"9cf74RWk1lJ04OUWmMvvW4e","EquipTempView"),cc.Class({extends:cc.Component,properties:{},init:function(){},onClickEquip:function(){this.node.parent.active=!1}}),cc._RF.pop()},{}],ErrorCodeTableData:[function(e,t,o){"use strict";cc._RF.push(t,"f5f26v/cwtNxprJCY7cJsdF","ErrorCodeTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.ErrorCodeTableData=void 0;var i=e("../TableReader"),a=function(){function e(){this.id=0,this.type="",this.dec=""}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.type=e.getString(),this.dec=e.getString()},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"ErrorCodeTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.ErrorCodeTableData=a,cc._RF.pop()},{"../TableReader":"TableReader"}],EventConst:[function(e,t,o){"use strict";var i;cc._RF.push(t,"c1865hOmixCIIukyz0k8LBH","EventConst"),Object.defineProperty(o,"__esModule",{value:!0}),function(e){e.SyncGoldChange="SyncGoldChange",e.SyncDiamondChange="SyncDiamondChange",e.SyncVoucherChange="SyncVoucherChange",e.SyncDemonFruitChangeEvent="SyncDemonFruitChangeEvent",e.SendProtocolDrawOne="SendProtocolDrawOne",e.SendProtocolDrawTen="SendProtocolDrawTen",e.BattleChangeHero="BattleChangeHero",e.ChickenDinnerSync="ChickenDinnerSync",e.SyncSociatyChatMsg="SyncSociatyChatMsg",e.RecommendSociatyEvent="RecommendSociatyEvent",e.CloseNotJoinedSociatyView="CloseNotJoinedSociatyView",e.CloseCreateSociatyView="CloseCreateSociatyView",e.syncSociatyInvitedData="syncSociatyInvitedData",e.SociatyClearInvitedList="SociatyClearInvitedList",e.SociatyRefuseInvitedEvent="SociatyRefuseInvitedEvent",e.RefreshSociatyInfo="RefreshSociatyInfo",e.CloseSociatyMainView="CloseSociatyMainView",e.SyncSociatyApplyData="SyncSociatyApplyData",e.CallRoleGetSociatyData="CallRoleGetSociatyData",e.SociatySyncJoinSuccessEvent="SociatySyncJoinSuccessEvent",e.RefreshMemberList="RefreshMemberList",e.SociatySyncBattleRoom="SociatySyncBattleRoom",e.SociatySyncChangeBattleRoom="SociatySyncChangeBattleRoom",e.SociatySyncBoxEvent="SociatySyncBoxEvent",e.SociatySyncReceiveBoxEvent="SociatySyncReceiveBoxEvent",e.SociatyRefreshRedpoint="SociatyRefreshRedpoint",e.SociatyInviteBtnRedpointEvent="SociatyInviteBtnRedpointEvent",e.SociatyApplyBtnRedpointEvent="SociatyApplyBtnRedpointEvent",e.SociatyRefreshUnreadChatEvent="SociatyRefreshUnreadChatEvent",e.SociatyRefreshBoxRedpointEvent="SociatyRefreshBoxRedpointEvent",e.ChangeMainSceneEvent="ChangeMainSceneEvent",e.SycnClientCarHpChangeEvent="SycnClientCarHpChangeEvent",e.SociatyRefreshContributionEvent="SociatyRefreshContributionEvent",e.SociatyRefreshRedEnvelopeEvent="SociatyRefreshRedEnvelopeEvent",e.SyncRoleItemMapSkinEvent="SyncRoleItemMapSkinEvent",e.SyncSociatyWarEvent="SyncSociatyWarEvent",e.SyncSociatyWarMemberRankEvent="SyncSociatyWarMemberRankEvent",e.SyncSociatyGetAuctionDataEvent="SyncSociatyGetAuctionDataEvent",e.SyncSociatyChangeAuctionDataEvent="SyncSociatyChangeAuctionDataEvent",e.SyncSociatyChangeAuctionStateEvent="SyncSociatyChangeAuctionStateEvent",e.SyncModuleViewEvent="SyncModuleViewEvent",e.SkyCastleSyncBoxEvent="SkyCastleSyncBoxEvent",e.SkyCastleSyncReceiveBoxEvent="SkyCastleSyncReceiveBoxEvent",e.skyCastleRefreshContributionEvent="skyCastleRefreshContributionEvent",e.SkyCastleRefreshRedpoint="SkyCastleRefreshRedpoint",e.SkyCastleRefreshBoxRedpoint="SkyCastleRefreshBoxRedpoint",e.SyncSkyCastleChangeType="SyncSkyCastleChangeType",e.SyncChatViewChange="SyncChatViewChange",e.SycnChangeRoleBag="SycnChangeRoleBag",e.AnniversaryReturnBackSelectCard="AnniversaryReturnBackSelectCard",e.ReturnBackRechargeSuccess="ReturnBackRechargeSuccess",e.SyncActivityReturnBackHelpNew="SyncActivityReturnBackHelpNew",e.SyncActivityReturnBackWinTaskData="SyncActivityReturnBackWinTaskData",e.RefreshAnniversaryWinTaskRedpoint="RefreshAnniversaryWinTaskRedpoint",e.RefreshAnniversaryReturnBackRedpoint="RefreshAnniversaryReturnBackRedpoint",e.RefreshAnniversaryMainRedpoint="RefreshAnniversaryMainRedpoint",e.RefreshAnniversaryBoxRedpoint="RefreshAnniversaryBoxRedpoint",e.RefreshMainPlayerCupNum="RefreshMainPlayerCupNum",e.SyncActivityReturnBackOffState="SyncActivityReturnBackOffState",e.FogHidden_RefreshSurplusCount="FogHidden_RefreshSurplusCount",e.RefreshFogHiddenBoxRedpoint="RefreshFogHiddenBoxRedpoint",e.RefreshFogHiddenMainNodeInfo="RefreshFogHiddenMainNodeInfo",e.SyncFogHiddenRankOffState="SyncFogHiddenRankOffState",e.SyncShopScoreFund="SyncShopScoreFund",e.SyncMachineryCityChatMsgEvent="SyncMachineryCityChatMsgEvent",e.SyncRefreshMachineryCityEvent="SyncRefreshMachineryCityEvent",e.SociatySyncMachinariumDataEvent="SociatySyncMachinariumDataEvent",e.RefreshMachineryCityBoxRedpoint="RefreshMachineryCityBoxRedpoint",e.RefreshMachineryCityMainRedPoint="RefreshMachineryCityMainRedPoint",e.RefreshMachineryCityRoundRewardListEvent="RefreshMachineryCityRoundRewardListEvent",e.RefreshMachineryCityRoundRewardRedpoint="RefreshMachineryCityRoundRewardRedpoint"}(i||(i={})),o.default=i,cc._RF.pop()},{}],EventManager:[function(e,t,o){"use strict";cc._RF.push(t,"f8f68EVxdhK0L1EK9RDsrDx","EventManager");var i=this&&this.__spreadArrays||function(){for(var e=0,t=0,o=arguments.length;t<o;t++)e+=arguments[t].length;var i=Array(e),a=0;for(t=0;t<o;t++)for(var n=arguments[t],r=0,s=n.length;r<s;r++,a++)i[a]=n[r];return i};Object.defineProperty(o,"__esModule",{value:!0});var a=function(){function e(){this._events={}}return Object.defineProperty(e,"Instance",{get:function(){return null==e._instance&&(e._instance=new e),e._instance},enumerable:!1,configurable:!0}),e.prototype.on=function(e,t,o){if(this._events.hasOwnProperty(e))for(var i=0,a=this._events[e];i<a.length;i++){var n=a[i];if(n.target===o)return n.isValid=!0,void console.log("repeat regiest event ",o)}else this._events[e]=[];this._events[e].push({callback:t,target:o,isValid:!0})},e.prototype.emit=function(e){for(var t,o=[],a=1;a<arguments.length;a++)o[a-1]=arguments[a];if(this._events.hasOwnProperty(e)){for(var n=this._events[e],r=0;r<n.length;r++){var s=n[r];s.isValid&&cc.isValid(s.target)&&(t=s.callback).call.apply(t,i([s.target],o))}this._events[e]=n.filter(function(e){return e.isValid&&cc.isValid(e.target)})}else console.log("no one regiest eventName = "+e+" !!!")},e.prototype.off=function(e,t){var o=function(t){if(this._events.hasOwnProperty(t))for(var o=this._events[t],i=0;i<o.length;i++){var a=o[i];if(a.target===e){a.isValid=!1;break}}}.bind(this);if(t)o(t);else for(var i in this._events)this._events.hasOwnProperty(i)&&o(i)},e._instance=null,e}();o.default=a,cc._RF.pop()},{}],ExchangeCodeView:[function(e,t,o){"use strict";cc._RF.push(t,"779f7KBYTRN5oapiBnqNE2T","ExchangeCodeView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../modules/base/BaseView"),s=e("../network/ClientNetwork"),c=e("../network/protocol/RoleProtocols"),l=e("../modules/base/Decorators"),d=e("../modules/base/GameView"),u=e("../Global/GameGlobal"),h=cc._decorator,p=h.ccclass,f=h.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.editBoxNode=null,t._editboxString="",t.rewardCount=0,t}return a(t,e),t.path=function(){return"ui/playerInfo/image/Exchange"},t.prototype.start=function(){s.ClientNetwork.getInstance().listenProtocol(c.ROLE_CLIENT_ENUM.P_Role_GetCDKReward,function(e){e.resetPos();var t=new c.S_Role_GetCDKReward;if(t.read(e))if(0==t.errorcode)this.editBoxNode.getComponent(cc.EditBox).string="",this._editboxString="",t.prize.length>0&&(this.tRewards=t.prize,this.rewardCount=0,this.onShowRewards());else switch(t.errorcode){case-6:u.G.StringManager.PopString("\u65e0\u6548\u7684\u5151\u6362\u7801\u7ec4!");break;case-5:u.G.StringManager.PopString("\u67e5\u8be2\u6570\u636e\u5e93\u5931\u8d25!");break;case-4:u.G.StringManager.PopString("\u5151\u6362\u7801\u5df2\u88ab\u4f7f\u7528!");break;case-2:u.G.StringManager.PopString("\u8fde\u63a5\u6570\u636e\u5e93\u5931\u8d25!");break;case 4:u.G.StringManager.PopString("\u5151\u6362\u7801\u6709\u6548\uff0c\u4f46\u672a\u5230\u5f00\u59cb\u65f6\u95f4");break;case 5:u.G.StringManager.PopString("\u5151\u6362\u7801\u5df2\u8fc7\u671f");break;case 6:u.G.StringManager.PopString("sdktype\u9519\u8bef");break;case 7:u.G.StringManager.PopString("sdkid\u9519\u8bef");break;case 8:u.G.StringManager.PopString("\u8be5\u5151\u6362\u7801\u5df2\u8fbe\u4f7f\u7528\u6b21\u6570\u4e0a\u9650\uff0c\u65e0\u6cd5\u4f7f\u7528");break;case 9:u.G.StringManager.PopString("\u5df2\u7ecf\u4f7f\u7528\u8fc7\u540c\u7c7b\u578b\u5151\u6362\u7801");break;case 10:u.G.StringManager.PopString("\u957f\u5ea6\u4e0d\u5bf9\uff0c\u9700\u89816~18\u4f4d");break;case 14:u.G.StringManager.PopString("\u6b64\u5151\u6362\u7801\u65e0\u5956\u52b1");break;default:u.G.StringManager.PopString("\u5151\u6362\u7801\u9519\u8bef  "+t.errorcode)}},this)},t.prototype.onEditingReturnCallBack=function(e){e.string.length<=0||(this._editboxString=e.string)},t.prototype.onClickExchangeCallBack=function(){if(this._editboxString.length<=0)return u.G.StringManager.PopString("\u8bf7\u8f93\u5165\u793c\u5305\u5151\u6362\u7801");var e=new c.C_Role_GetCDKReward;e.cdkstr=this._editboxString,s.ClientNetwork.getInstance().Send(c.ROLE_CLIENT_ENUM.P_Role_GetCDKReward,e)},t.prototype.onShowRewards=function(){var e=this,t=this.tRewards.slice(6*this.rewardCount,6*(this.rewardCount+1));t.length>0&&d.default.addPopView("BaseCtrl","AcquirePopupView","AcquirePopupView",{items:t,closeCb:function(){e.rewardCount++,e.onShowRewards()}})},n([f(cc.Node)],t.prototype,"editBoxNode",void 0),n([l.Register_Class,p],t)}(r.default);o.default=g,cc._RF.pop()},{"../Global/GameGlobal":"GameGlobal","../modules/base/BaseView":"BaseView","../modules/base/Decorators":"Decorators","../modules/base/GameView":"GameView","../network/ClientNetwork":"ClientNetwork","../network/protocol/RoleProtocols":"RoleProtocols"}],FightCardView:[function(e,t){"use strict";cc._RF.push(t,"2cdd0E49M9AIpKu52IujQZC","FightCardView");var o=M(e("../combat/CombatManager")),i=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=D();if(t&&t.has(e))return t.get(e);var o={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var n=i?Object.getOwnPropertyDescriptor(e,a):null;n&&(n.get||n.set)?Object.defineProperty(o,a,n):o[a]=e[a]}return o.default=e,t&&t.set(e,o),o}(e("../common/CombatModule")),a=M(e("../common/PlayerModule")),n=M(e("../utils/ConfigUtils")),r=e("../utils/ConstValue"),s=M(e("../utils/ResourcesManager")),c=M(e("../utils/Tools")),l=M(e("../controller/Guide/GuideController")),d=e("../network/ClientNetwork"),u=e("../network/LocalMessage"),h=e("../network/protocol/FightProtocols"),p=e("../network/FightNetwork"),f=e("../network/protocol/TypeProtocols"),g=M(e("../controller/Guide/GuideConfig/GuideConst")),m=M(e("../modules/manager/LoadResManager")),_=M(e("../combat/unit/DropEquipObj")),y=M(e("../utils/GameTools")),v=e("../utils/GameUtils"),C=e("../modules/manager/cheat/SafeNumber"),S=M(e("../utils/ByteDanceMiniGameUtils")),T=e("../utils/GamePlatform"),I=e("../Global/GameGlobal"),N=e("../utils/WechatUtils"),b=M(e("./activity/ActivityModule")),w=e("../utils/DalanReportUtils"),E=M(e("../common/EventConst")),P=M(e("../modules/manager/EventManager")),R=e("../common/CommandValue"),L=M(e("./anniversary/AnniversaryModule")),A=M(e("./machineryCityActivity/MachineryCityModel"));function D(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return D=function(){return e},e}function M(e){return e&&e.__esModule?e:{default:e}}var B=r.PLAYER_CAMP.myPlayer,k=r.PLAYER_CAMP.opponents;cc.Class({extends:cc.Component,properties:{fightCardNode:cc.Node,randomNode:cc.Node,carNode:cc.Node,CardPrefab:cc.Prefab,Parent:cc.Node,curMoney:cc.Label,randomNum:cc.Label,carNum:cc.Label,curManNum:cc.Label,maxLevel:cc.Label,icon:cc.Sprite,dropRate:cc.Node,dropRateGreen:cc.Label,dropRateBlue:cc.Label,dropRatePurple:cc.Label,dropRateOrange:cc.Label,dropRateArrow:cc.Sprite,equipDetail:cc.Node,opponentEquipDetail:cc.Node,popupEmojiPre:cc.Node},init:function(e){this.game=e,this.playerCombatModel=o.default.getInstance().getSelfCombatModel(),this.maxLevel.node.active=!1,this.carNum.string=this.playerCombatModel.getCarLvUpCost(),1==this.playerCombatModel.carIsMaxLevel()?(this.maxLevel.node.active=!0,this.carNum.node.active=!1,this.icon.node.active=!1):(this.maxLevel.node.active=!1,this.carNum.node.active=!0,this.icon.node.active=!0),this.nCurTimes.value=this.playerCombatModel.getCarRefreshCount();var t=this.playerCombatModel.getCardIdVec();for(var i in this.tbRandomList=[],t)this.tbRandomList.push(t[i]);if(this.selEquipID=0,this.tbHeroList=[],0==this.nCurTimes.value){var a=this.getConstByTimes(1);this.randomNum.string=a}else{var n=this.getConstByTimes(this.nCurTimes.value);this.randomNum.string=n}this.initReconnectEquip()},onLoad:function(){var e=this;this.nCurTimes=new C.SafeNumber(0),this._equipListNode=this.node.getChildByName("EquipBag").getChildByName("EquipList"),this._opponentEquipListNode=this.node.getChildByName("EquipBag_b").getChildByName("EquipList_b"),o.default.getInstance().isCoop()&&!o.default.getInstance().isSkyCastle()&&(this.node.getChildByName("EquipBag_b").active=!1,this.node.getChildByName("EquipBag_bLabel").active=!1),this.bGuideRandom=!1,this.isRecording=!1,this.btn_recordVideo=this.node.getChildByName("btn_recordVideo"),this.btn_effectOnOff=this.node.getChildByName("btn_effectOnOff"),this.btn_recordVideo.active=!1,T.GamePlatform.isWechat()&&(this.btn_recordVideo.active=!0,y.default.registerTouchEvent(this.btn_recordVideo,function(){e.startWXVideoRecording()})),this.onRefreshEffectBtn()},onDestroy:function(){cc.director.off("Event_changeHero",this),P.default.Instance.off(this,E.default.SyncChatViewChange)},checkGudieHeroId:function(e){var t=!1;return[10,4,3,7,8].forEach(function(o){e==o&&(t=!0)}),t},start:function(){var e=this;if(this.tCardObjScrpit=[],i.default.matchType==f.FIGHT_TYPE.FIGHT_TYPE_ANNIVERSARY_TRIAL?this.tAnniversaryBattleHeroList=L.default.Instance.getAnniversaryBattleCards():i.default.matchType==f.FIGHT_TYPE.FIGHT_TYPE_MACHINARIUM&&(this.tMachineryCityBattleHeroList=A.default.Instance.getMachineryCityBattleCards()),this.tbRandomList.length<=0&&(this.nCurTimes.value<=0||1==this.nCurTimes.value&&0==this.playerCombatModel.combatStatistic.heros.size))this.getRandomList(),this.nCurTimes.value=1,this.sendCarRefreshNumToServer();else for(var t=0;t<this.tbRandomList.length;t++)this.tbRandomList[t]=new C.SafeNumber(this.tbRandomList[t]);var n=this.tbRandomList.length;l.default._Instance.getGuideStatus()&&(a.default.getRoleAttrValByKey(f.ROLE_ATTR_VALUES.ROLE_ATTR_GUIDE)+1==g.default.BattleSecondGuide.guideId?(this.tbRandomList[0]=new C.SafeNumber(3),this.tbRandomList[1]=new C.SafeNumber(4),this.tbRandomList[2]=new C.SafeNumber(5)):(this.tbRandomList[0]=new C.SafeNumber(10),this.tbRandomList[1]=new C.SafeNumber(3),this.tbRandomList[2]=new C.SafeNumber(9)),this.node.getChildByName("btn_emoji").active=!1,this.node.getChildByName("btn_chat").active=!1);for(var r=0;r<n;r++)if(this.tbRandomList[r]instanceof C.SafeNumber){var s=cc.instantiate(this.CardPrefab),c=this.tbRandomList[r].value;s.parent=this.Parent,s.active=!0,s.x=140*r-140,s.name="card"+r;var h=s.getComponent("CardItemView");h.setId(this,this.playerCombatModel,c,!1,this.game,!1),this.tCardObjScrpit[r]=h,this.refColor()}if(this._equipListNode)for(var p=this._equipListNode.children,_=0;_<p.length;++_)p[_]._camp=B,p[_].on(cc.Node.EventType.TOUCH_END,function(t){e.onClickEquip(t)});if(this._opponentEquipListNode)for(var y=this._opponentEquipListNode.children,v=0;v<y.length;++v)y[v]._camp=k,y[v].on(cc.Node.EventType.TOUCH_END,function(t){e.onClickEquip(t)});d.ClientNetwork.getInstance().listenLocalMessage(u.LOCAL_MESSAGE.LocalMsg_RefreshCoopFriendChatRed,this.refreshFightFriendChatMsg,this),d.ClientNetwork.getInstance().listenLocalMessage(u.LOCAL_MESSAGE.LocalMsg_BuyFightCard,this.clearCardList,this),this.node.width=cc.winSize.width,o.default.getInstance().isCoop()?(this.node.getChildByName("btn_chat").active=!1,this.node.getChildByName("btn_emoji").active=!1,i.default.matchType!=f.FIGHT_TYPE.FIGHT_TYPE_COOPERATION&&i.default.matchType!=f.FIGHT_TYPE.FIGHT_TYPE_FOG_HIDDEN&&i.default.matchType!=f.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE&&i.default.matchType!=f.FIGHT_TYPE.FIGHT_TYPE_WEEK_COOPERATION&&i.default.matchType!=f.FIGHT_TYPE.FIGHT_TYPE_MACHINARIUM||(this.node.getChildByName("btn_chat").active=!0,this.node.getChildByName("btn_emoji").active=!0,m.default.loadPrefab("ui/mainScene/ChatNode").then(function(t){t.parent=e.node,e._chatNode=t;var o=t.getChildByName("chatMain").getComponent("ChatMainView");o.setShowChannelTab([f.CHAT_CHANNEL_GROUP_TYPE.CHAT_CHANNEL_TEAM_GROUP,f.CHAT_CHANNEL_GROUP_TYPE.CHAT_CHANNEL_SYSTEM_GROUP,f.CHAT_CHANNEL_GROUP_TYPE.CHAT_CHANNEL_PRIVATE_GROUP]),o.setChatChannel(4),t.active=!1}).catch(function(e){LogUtil.info(e)}))):this.node.getChildByName("btn_chat").active=!1,l.default._Instance.getGuideStatus()&&(this.node.getChildByName("btn_emoji").active=!1,this.node.getChildByName("btn_chat").active=!1),1==this.node.getChildByName("btn_chat").active&&P.default.Instance.on(E.default.SyncChatViewChange,this.changeChatViewVisible,this)},changeChatViewVisible:function(e){var t=this;if(e&&!isNaN(e)&&cc.isValid(this._chatNode))if(this._chatNode.active=!0,1==e){var o=cc.winSize.width/2-this._chatNode.width/2;cc.tween(this._chatNode).to(.1,{x:o}).call(function(){t._topViewNode&&(t._topViewNode.active=!1),t._chatNode.getChildByName("chatMain").getComponent("ChatMainView").setChatChannel(4),t.node.getChildByName("btn_chat").getChildByName("redpoint").active=!1,t.refreshFightFriendChatMsg()}).start()}else if(2==e){var i=cc.winSize.width/2+this._chatNode.width/2;cc.tween(this._chatNode).to(.1,{x:i}).call(function(){t._topViewNode&&(t._topViewNode.active=!0),t._chatNode.active=!1}).start()}},onClickChatNodeCallBack:function(){P.default.Instance.emit(E.default.SyncChatViewChange,R.ChatViewVisible.Popup)},clearCardList:function(e){if(1==e[0])for(var t in this.tCardObjScrpit)this.tCardObjScrpit[t].removeSelf(!1)},setCarClickRefreshDisable:function(e){if(e==r.PLAYER_CAMP.myPlayer){for(var t in this.tCardObjScrpit)this.tCardObjScrpit[t].cancelClickEvent();this.randomNode.getComponent(cc.Button).interactable=!1}},refCardListInfo:function(){for(var e in this.tCardObjScrpit=[],this.getRandomList(),this.tbRandomList.length,l.default._Instance.getGuideStatus()&&(a.default.getRoleAttrValByKey(f.ROLE_ATTR_VALUES.ROLE_ATTR_GUIDE)+1==g.default.BattleSecondGuide.guideId?4==l.default.guideIndex?(this.tbRandomList[0]=new C.SafeNumber(11),this.tbRandomList[1]=new C.SafeNumber(4),this.tbRandomList[2]=new C.SafeNumber(5)):7==l.default.guideIndex&&(this.tbRandomList[0]=new C.SafeNumber(26),this.tbRandomList[1]=new C.SafeNumber(4),this.tbRandomList[2]=new C.SafeNumber(5)):(5==l.default.guideIndex?(this.tbRandomList[0]=new C.SafeNumber(11),this.tbRandomList[1]=new C.SafeNumber(5)):7==l.default.guideIndex&&(this.tbRandomList[0]=new C.SafeNumber(10),this.tbRandomList[1]=new C.SafeNumber(11),this.tbRandomList[2]=new C.SafeNumber(9)),1==function(e){var t={};for(var o in e){if(t[e[o].value])return!0;t[e[o].value]=!0}return!1}.call(this,this.tbRandomList)&&(this.tbRandomList[0]=new C.SafeNumber(10),this.tbRandomList[1]=new C.SafeNumber(5),this.tbRandomList[2]=new C.SafeNumber(9)))),this.Parent.removeAllChildren(),this.tbRandomList)if(this.tbRandomList[e]instanceof C.SafeNumber){var t=cc.instantiate(this.CardPrefab),i=this.tbRandomList[e].value,n=o.default.getInstance().getSelfCombatModel().getHeroLevel(i)>0;t.parent=this.Parent,t.active=!0,t.x=140*e-140,t.name="card"+e;var r=t.getComponent("CardItemView");r.setId(this,this.playerCombatModel,i,!0,this.game,n),this.tCardObjScrpit[e]=r}},getHeroAdditionWeight:function(e){for(var t=n.default.getInstance().getHeroTalentTableDataCfg(),o="",i=[],a=0,r=Object.keys(t);a<r.length;a++){var s=r[a];t.hasOwnProperty(s)&&t[s].heroId==e.heroId&&i.push(t[s])}if(i.forEach(function(t){Number(e.heroLevel)>=t.level&&(o=t.skillIdList)}),""!=o){var c=o.split("|");for(var l in c){var d=n.default.getInstance().getPassiveSkillConfig(Number(c[l]));if(d&&30==d.type)return d.attr_value}}return 0},getRandomCard:function(){var e,t=[],i=o.default.getInstance().getSelfCombatModel().getLevel()-1;for(var a in e=r.randomQualityList[i],this.tbHeroList)if(this.tbHeroList[a]){var s=n.default.getInstance().getHeroConfig(this.tbHeroList[a]._heroId),c=100;switch(s.hero_color){case 1:c=e.green;break;case 2:c=e.blue;break;case 3:c=e.purple;break;case 4:c=e.orange}var l=s.weight.split("|"),d=o.default.getInstance().getSelfCombatModel().getHeroLevel(this.tbHeroList[a]._heroId);2==s.hero_type&&(d=o.default.getInstance().getSelfCombatModel().onGetSpiritLv(this.tbHeroList[a]._heroId));var u=l[0];d>=1&&d<r.HeroMaxLevel?u=l[d]:d==r.HeroMaxLevel&&(u=0,2==s.hero_type&&(u=l[r.HeroMaxLevel-1]));var h=this.getHeroAdditionWeight(this.tbHeroList[a]);t.push((Number(u)+h)*this.playerCombatModel.getHeroNumWeightParam(this.tbHeroList[a]._heroId)*c)}if(!((t=this.arrOverAdd(t)).length<=0)){var p=t[t.length-1],f=Math.random()*p,g=this.getArrIndex(f,t),m=this.tbHeroList[g]._heroId;if(o.default.getInstance().getSelfCombatModel().getHeroLevel(m)!=r.HeroMaxLevel){var _=new C.SafeNumber(m);this.tbRandomList.push(_);for(var y=g+1;y<this.tbHeroList.length;y++)this.tbHeroList[y-1]=this.tbHeroList[y];this.tbHeroList.pop()}}},getRandomList:function(){this.tbHeroList=[];var e=a.default.getBattleHeroCarData(a.default.fightHeroArrayIndex);for(var t in i.default.matchType==f.FIGHT_TYPE.FIGHT_TYPE_BATTLE_GREAT_SAILING&&(e=b.default.getNavigationBattleCards()),i.default.matchType==f.FIGHT_TYPE.FIGHT_TYPE_ANNIVERSARY_TRIAL&&this.tAnniversaryBattleHeroList&&(e=this.tAnniversaryBattleHeroList),i.default.matchType==f.FIGHT_TYPE.FIGHT_TYPE_MACHINARIUM&&this.tMachineryCityBattleHeroList&&(e=this.tMachineryCityBattleHeroList),e)this.tbHeroList.push(e[t]);if(l.default._Instance.getGuideStatus()){for(var o in this.tbHeroList=[],e)3!=e[o].heroId&&5!=e[o].heroId&&9!=e[o].heroId&&10!=e[o].heroId&&11!=e[o].heroId&&4!=e[o].heroId&&26!=e[o].heroId||this.tbHeroList.push(e[o]);if(this.tbHeroList.length<r.randomCardMaxNum)for(var n in this.tbHeroList=[],l.default._Instance.onSendSetGuide(999),e)this.tbHeroList.push(e[n])}for(this.tbRandomList=[];this.tbRandomList.length<r.randomCardMaxNum;)this.getRandomCard();this.checkRandomListCheat(this.tbRandomList)},checkRandomListCheat:function(e){3==e.length&&(e[0].value!=e[1].value&&e[0].value!=e[2].value&&e[1].value!=e[2].value||d.ClientNetwork.getInstance().pushLocalMessage(u.LOCAL_MESSAGE.LocalMsg_CheatValue))},arrOverAdd:function(e){if(!e||e.length<=0)return[];for(var t=[],o=0;o<e.length;o++)t[o]=0==o?parseInt(e[o]):t[o-1]+parseInt(e[o]);return t},getArrIndex:function(e,t){var o=0;if(e>=t[t.length-1])return t.length-1;for(var i=0;i<this.tbHeroList.length;i++){if(e<=t[i]){o=i;break}if(e>t[i]&&e<=t[i+1]){o=i+1;break}}return o},update:function(){if(this.playerCombatModel){var e=this.playerCombatModel.getCurMoney();this.curMoney.string=e;var t=this.playerCombatModel.getCurHeroNum(),o=this.playerCombatModel.getMaxHeroNum();this.curManNum.string=t+"/"+o,this.refColor()}else this.curMoney.string=0,this.curManNum.string="0/0";Number(this.carNum.string)>Number(this.curMoney.string)?this.carNum.node.color=cc.Color.RED:this.carNum.node.color=cc.Color.WHITE,Number(this.randomNum.string)>Number(this.curMoney.string)?this.randomNum.node.color=cc.Color.RED:this.randomNum.node.color=cc.Color.WHITE},onClickRandom:function(){var e=this;if(o.default.getInstance().gameState!=r.Game_State.Reconnect)try{this.randomNode.getComponent(cc.Button).interactable=!1,this.scheduleOnce(function(){e.randomNode.getComponent(cc.Button).interactable=!0},r.coldDownTime);var t=this.getConstByTimes(this.nCurTimes.value);if(0==this.playerCombatModel.useMoney(t))return;this.refCardListInfo(),this.nCurTimes.value=this.nCurTimes.value+1,this.sendCarRefreshNumToServer();var i=this.getConstByTimes(this.nCurTimes.value);this.randomNum.string=i,this.refColor()}catch(n){var a=[];a[0]="fightCardview Error",a[1]=n.message,T.GamePlatform.reportWXLog(a)}else I.G.StringManager.PopStringOnce(I.G.StringManager.getString("RECONNECT_RESUME"))},getConstByTimes:function(e){if(0==e)return 5;var t=n.default.Instance.getRandomConstfig();for(var a in t)if(e>=t[a].min_times&&e<=t[a].max_times)return o.default.getInstance().isCoop()?i.default.matchType==f.FIGHT_TYPE.FIGHT_TYPE_COOPERATION?t[a].const_coop:i.default.matchType==f.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE?t[a].const_double:i.default.matchType==f.FIGHT_TYPE.FIGHT_TYPE_FOG_HIDDEN?t[a].const_fogHidden:i.default.matchType==f.FIGHT_TYPE.FIGHT_TYPE_MACHINARIUM?t[a].const_machineryCity:t[a].const_navigation:t[a].const},refColor:function(){for(var e in this.tCardObjScrpit)this.tCardObjScrpit[e].refColor()},onClickCar:function(){if(o.default.getInstance().gameState!=r.Game_State.Reconnect){var e=o.default.getInstance().getSelfCar();e&&0==e.getCarUpgradeState()&&1==this.playerCombatModel.reqCarLevelUp()&&(this.playerCombatModel.sendCarLvUpToServer(this.playerCombatModel.carInfo.level,a.default.UUID),o.default.getInstance().getSelfCar().setCarUpgradeState(!0),this.refColor(),this.carNum.string=this.playerCombatModel.getCarLvUpCost(),c.default.playBtnAudioMusic("combat/audio/effect/building",!1,1),1==this.playerCombatModel.carIsMaxLevel()?(this.maxLevel.node.active=!0,this.carNum.node.active=!1,this.icon.node.active=!1):(this.maxLevel.node.active=!1,this.carNum.node.active=!0,this.icon.node.active=!0))}else I.G.StringManager.PopStringOnce(I.G.StringManager.getString("RECONNECT_RESUME"))},refCarInfo:function(){this.carNum.string=this.playerCombatModel.getCarLvUpCost(),c.default.playBtnAudioMusic("combat/audio/effect/building",!1,1),1==this.playerCombatModel.carIsMaxLevel()?(this.maxLevel.node.active=!0,this.carNum.node.active=!1,this.icon.node.active=!1):(this.maxLevel.node.active=!1,this.carNum.node.active=!0,this.icon.node.active=!0)},onClickDropRate:function(){if(this.dropRate.active=!this.dropRate.active,1==this.dropRate.active){this.dropRateArrow.node.scaleY=-1;var e=o.default.getInstance().getSelfCombatModel().getLevel()-1,t=r.randomQualityList[e];this.dropRateGreen.string=t.green+"%",this.dropRateBlue.string=t.blue+"%",this.dropRatePurple.string=t.purple+"%",this.dropRateOrange.string=t.orange+"%"}else this.dropRateArrow.node.scaleY=1},onClickEquip:function(e){for(var t=i.default.getDropEquipList(),o=0,a=0,n=t[e.target._camp]?t[e.target._camp]:[],r=0;r<n.length;r++)n[r].equipNodeName==e.target.name&&(n[r].starNum>o&&(o=n[r].starNum),a=n[r]._templateId);a>0&&o>0&&this.showDetail(a,o,e.target._camp)},showDetail:function(e,t,o){var i=this.opponentEquipDetail;o==B&&(i=this.equipDetail);var a=i.getChildByName("desc"),s=i.getChildByName("name");this.selEquipID!=e||0==i.active?(this.selEquipID=e,i.active=!0):i.active=!1;var c=n.default.getInstance().getEquipByID(e);if(c){for(var l=null,d=0;d<c.length;d++)if(c[d].star===t){l=c[d];break}if(l.quality){var u=r.ColorList[l.quality];s.color=cc.color(u.color1,u.color2,u.color3)}a.getComponent(cc.Label).string=l.desc,s.getComponent(cc.Label).string=l.name}},onRefreshDropEquip:function(e,t,a){o.default.getInstance().getController().onRefreshEquipNodeName(a);var r=n.default.getInstance().getEquipByID(e);if(r){for(var c=null,l=0;l<r.length;l++)if(r[l].star===t){c=r[l];break}if(!c)return;var d=i.default.getDropEquipList(),u=d[a]?d[a]:[];if(u.length>0&&u[u.length-1]._templateId!=e)return;var h=null;a==B?(h=this._equipListNode.getChildByName("EquipNode"+c.equipType),this._equipListNode.children.forEach(function(e){e.active=!1})):(h=this._opponentEquipListNode.getChildByName("EquipNode"+c.equipType+"_b"),this._opponentEquipListNode.children.forEach(function(e){e.active=!1})),h.active=!0,s.default.loadSprite(c.icon,h.getComponent(cc.Sprite)),1==this.opponentEquipDetail.active&&(this.opponentEquipDetail.active=!1),1==this.equipDetail.active&&(this.equipDetail.active=!1)}},onClickEmojiCallBack:function(){this.initShowEmojiInfo()},initShowEmojiInfo:function(){var e=this,t=["\u5f53\u524d\u8840\u91cf","\u653b\u51fb","\u7269\u9632","\u9b54\u9632","\u8840\u91cf\u4e0a\u9650","\u547d\u4e2d%","\u95ea\u907f%","\u66b4\u51fb%","\u66b4\u6297%","\u66b4\u4f24%","\u66b4\u4f24\u51cf\u514d%","\u653b\u51fb%","\u7269\u9632%","\u9b54\u9632%","\u8840\u91cf%","\u4f24\u5bb3%","\u4f24\u5bb3\u51cf\u514d%","\u79fb\u901f%","\u653b\u901f%","\u7eaf\u9632%","\u6cbb\u7597%","\u53cd\u4f24","\u97e7\u6027","\u5438\u8840","\u7269\u9632\u51cf","\u9b54\u9632\u51cf","\u771f\u5b9e\u51cf\u514d"],i=o.default.getInstance().getSelfCar();if(i){var a="\u81ea\u5df1\u7684\u8f66";for(var c in i.attr)a=a+" "+t[c]+"\uff1a"+i.attr[c]+"  ";console.log(a)}var l=o.default.getInstance().getCarByCamp(r.PLAYER_CAMP.coopPlayer);if(l){var d="\u961f\u53cb\u7684\u8f66";for(var u in l.attr)d=d+" "+t[u]+"\uff1a"+l.attr[u]+"  ";console.log(d)}var h=o.default.getInstance().getCarByCamp(r.PLAYER_CAMP.opponents);if(h){var p="\u5bf9\u624b\u4e3b\u8f66";for(var f in h.attr)p=p+" "+t[f]+"\uff1a"+h.attr[f]+"  ";console.log(p)}var g=o.default.getInstance().getCarByCamp(r.PLAYER_CAMP.opponentsCoop);if(g){var m="\u5bf9\u624b\u526f\u8f66";for(var _ in g.attr)m=m+" "+t[_]+"\uff1a"+g.attr[_]+"  ";console.log(m)}this.node.getChildByName("EmojiNode").active=!0,this.node.getChildByName("btn_emoji").active=!1;var y=[],v=n.default.getInstance().data["StaticData/ItemTableData"];for(var C in v)Object.prototype.hasOwnProperty.call(v,C)&&6===v[C].type&&y.push(v[C]);for(var S=this.node.getChildByName("EmojiNode").getChildByName("EmojiLayout"),T=0;T<S.children.length;T++){var I=S.children[T];I.emojiId=y[T].id,s.default.loadSprite(y[T].icon,I.getComponent(cc.Sprite)),I.on(cc.Node.EventType.TOUCH_END,function(t){e.onSendCallEmoji(t.target.emojiId)})}},onSendCallEmoji:function(e){var t=i.default.getMatchBattleInfo(!1);t&&(0==t.bRobot?this.onCallFightExpression({type:0,contenId:e,msg:""}):this.onShowEmoji(e,!0))},onCallFightExpression:function(e){var t=i.default.getMatchBattleInfo(!1);if(t)if(0==t.bRobot){var o=new h.C_Fight_Expression;if(o.type=e.type,o.contentId=e.contenId,o.msg=e.msg.toString(),p.FightNetwork.getInstance().Send(h.FIGHT_CLIENT_ENUM.P_Fight_Expression,o),"bigBlue"==T.GamePlatform.getMiYaVideoType()){var a=w.DalanReportUtils.REPORT_CHAT_CHANNEL_FIGHT;w.DalanReportUtils.Instance.reprot_chat(a,e.msg)}}else this.onAddTeamChatMsg(e,!0)},onShowEmoji:function(e,t){var i=o.default.getInstance().getController().bloodNode.getChildByName("FightTopView");if(i){o.default.getInstance().isCoop()&&(i.getChildByName("RightEmojiNode").position=i.getChildByName("LeftEmojiNode").position),t?i.getChildByName("LeftEmojiNode").getChildByName("self_emoji_node")&&i.getChildByName("LeftEmojiNode").getChildByName("self_emoji_node").destroy():i.getChildByName("RightEmojiNode").getChildByName("opponent_emoji_node")&&i.getChildByName("RightEmojiNode").getChildByName("opponent_emoji_node").destroy();var a=cc.instantiate(this.popupEmojiPre);a.active=!0,a.scale=0,t?(a.parent=i.getChildByName("LeftEmojiNode"),s.default.loadSprite("ui/emoji/di_2",a.getComponent(cc.Sprite)),a.name="self_emoji_node",a.x=0,a.y=0,this.node.getChildByName("EmojiNode")&&(this.node.getChildByName("EmojiNode").active=!1),this.node.getChildByName("btn_emoji")&&(this.node.getChildByName("btn_emoji").active=!0)):(a.parent=i.getChildByName("RightEmojiNode"),o.default.getInstance().isCoop()?s.default.loadSprite("ui/emoji/di_2",a.getComponent(cc.Sprite)):s.default.loadSprite("ui/emoji/di",a.getComponent(cc.Sprite)),a.name="opponent_emoji_node",a.x=0,a.y=0);var r=n.default.getInstance().getItemByID(e),c=n.default.getInstance().getResConfig(r.spineId).uiScale;s.default.loadSpine(n.default.getInstance().getResConfig(r.spineId).animation,function(e){cc.isValid(a)&&(e.parent=a,e.getComponent(sp.Skeleton).setAnimation(0,"idle",!1),e.scale=e.scale*c/100,e.y=-10)}),cc.tween(a).to(.25,{scale:1}).delay(1.8).call(function(){a&&cc.isValid(a)&&a.destroy()}).start()}},initShowBattleChatInfo:function(){},onAddTeamChatMsg:function(e,t){var o={};if(t)o.roleID=a.default.UUID,o.headUrl=a.default.getHeadUrl(),o.headID=a.default.getRoleAttrValByKey(f.ROLE_ATTR_VALUES.ROLE_ATTR_HEADID),o.headFrameID=a.default.getRoleAttrValByKey(f.ROLE_ATTR_VALUES.ROLE_ATTR_HEADFRAMEID),o.chatType=e.type,o.chatText=e.msg,o.nickName=a.default.roleName,this._chatNode.getChildByName("chatMain").getComponent("ChatMainView").onClearEditBoxString();else{var n=i.default.getMatchBattleInfo(!1);if(!n)return;o.roleID=n.roleID,o.headUrl=n.headUrl,o.headID=n.headID,o.headFrameID=n.headFrameID,o.chatType=e.type,o.chatText=e.msg,o.nickName=n.nickName}this._chatNode.getChildByName("chatMain").getChildByName("teamNode").getComponent("TeamChatPanel").addMessage(o),0==this._chatNode.active&&(this.node.getChildByName("btn_chat").getChildByName("redpoint").active=!0)},refreshFightFriendChatMsg:function(){if(this._chatNode){var e=this._chatNode.getChildByName("chatMain");if(e){var t=e.getChildByName("ToggleContainer");if(t&&0!=t.getChildByName("channe_"+f.CHAT_CHANNEL_GROUP_TYPE.CHAT_CHANNEL_PRIVATE_GROUP).active){var o=!1;if(a.default.getPrivateChatSimData().forEach(function(e){e.noReadNum>0&&(o=!0)}),this.node){var i=this.node.getChildByName("btn_chat");i&&(i.getChildByName("redpoint").active=o)}t.getChildByName("channe_"+f.CHAT_CHANNEL_GROUP_TYPE.CHAT_CHANNEL_PRIVATE_GROUP).getChildByName("redpoint").active=o}}}},sendCarRefreshNumToServer:function(){if(i.default.getCombatType()!=i.CombatType.PVE){var e=new h.C_Fight_Refresh_Card_Count_SYNC;for(var t in e.roleID=a.default.UUID,e.refreshNum=this.nCurTimes.value-1,this.tbRandomList)e.cardIdVec.push(this.tbRandomList[t].value);this.playerCombatModel.combatStatistic.countRefreshTime(1),this.playerCombatModel.carRefreshCount=this.nCurTimes.value,this.playerCombatModel.setCardIdVec(e.cardIdVec),p.FightNetwork.getInstance().Send(h.FIGHT_CLIENT_ENUM.P_Fight_Refresh_Card_Count_SYNC,e)}},onClickRecordVideo:function(){console.log("onClickRecordVideo, this.this.isRecording=",this.isRecording),this.isRecording=!this.isRecording,1==this.isRecording?(I.G.StringManager.PopString("\u5f00\u59cb\u5f55\u5c4f"),s.default.loadSprite("douyin/record_stop",this.btn_recordVideo.getChildByName("Background").getComponent(cc.Sprite)),S.default.getInstance().startVideoRecording()):(I.G.StringManager.PopString("\u5f55\u5c4f\u7ed3\u675f"),s.default.loadSprite("douyin/record_start",this.btn_recordVideo.getChildByName("Background").getComponent(cc.Sprite)),S.default.getInstance().stopVideoRecording())},startWXVideoRecording:function(){console.log("onClickRecordVideo, this.this.isRecording=",this.isRecording),this.isRecording=!this.isRecording,1==this.isRecording?(I.G.StringManager.PopString("\u5f00\u59cb\u5f55\u5c4f"),s.default.loadSprite("douyin/record_stop",this.btn_recordVideo.getChildByName("Background").getComponent(cc.Sprite)),N.WechatUtils.getInstance().startVideoRecording()):(I.G.StringManager.PopString("\u5f55\u5c4f\u7ed3\u675f"),s.default.loadSprite("douyin/record_start",this.btn_recordVideo.getChildByName("Background").getComponent(cc.Sprite)),N.WechatUtils.getInstance().stopVideoRecording())},initReconnectEquip:function(e){void 0===e&&(e=!1);var t=i.default.matchReconnectData;if(null!=t){i.default.removeDropEquips();var a=o.default.getInstance().getReconnectPlayerInfo(t.playerInfo,i.default.matchRoleIdentity);if(a){var n=o.default.getInstance().getPlayerModelByCamp(r.PLAYER_CAMP.myPlayer);for(var s in a.equipVector){var c=a.equipVector[s].equipID,l=a.equipVector[s].starLevel;e&&(l=a.equipVector[s].equipPos);var d=new _.default;d.onReconnectInit(c,r.PLAYER_CAMP.myPlayer,l),i.default.pushDropEquipList(d),n.carInfo.tbEquipInfo[c]=l}var u=n.getEquipInvaildState();u&&n.setEquipInvaild(u)}var h=i.default.matchRoleIdentity==r.PLAYER_IDENTITY.home?r.PLAYER_IDENTITY.away:r.PLAYER_IDENTITY.home;o.default.getInstance().isSkyCastle()&&(h=r.PLAYER_CAMP.opponents+1);var p=o.default.getInstance().getReconnectPlayerInfo(t.playerInfo,h);if((o.default.getInstance().isPvP()||o.default.getInstance().isSkyCastle())&&p){var f=o.default.getInstance().getPlayerModelByCamp(r.PLAYER_CAMP.opponents);for(var g in p.equipVector){var m=p.equipVector[g].equipID,y=p.equipVector[g].starLevel;e&&(y=p.equipVector[g].equipPos);var v=new _.default;v.onReconnectInit(m,r.PLAYER_CAMP.opponents,y),i.default.pushDropEquipList(v),f.carInfo.tbEquipInfo[m]=y}var C=f.getEquipInvaildState();C&&f.setEquipInvaild(C)}}},onRefreshEffectBtn:function(){if(a.default.checkModulerOnOffState(59)){var e=(0,v.getBattleEffectOnOff)();this.btn_effectOnOff.getChildByName("off").active=!e,this.btn_effectOnOff.getChildByName("on").active=e}else this.btn_effectOnOff.active=!1},onClickEffectBtn:function(){var e=(0,v.getBattleEffectOnOff)();(0,v.setBattleEffectOnOff)(!e),this.onRefreshEffectBtn()}}),cc._RF.pop()},{"../Global/GameGlobal":"GameGlobal","../combat/CombatManager":"CombatManager","../combat/unit/DropEquipObj":"DropEquipObj","../common/CombatModule":"CombatModule","../common/CommandValue":"CommandValue","../common/EventConst":"EventConst","../common/PlayerModule":"PlayerModule","../controller/Guide/GuideConfig/GuideConst":"GuideConst","../controller/Guide/GuideController":"GuideController","../modules/manager/EventManager":"EventManager","../modules/manager/LoadResManager":"LoadResManager","../modules/manager/cheat/SafeNumber":"SafeNumber","../network/ClientNetwork":"ClientNetwork","../network/FightNetwork":"FightNetwork","../network/LocalMessage":"LocalMessage","../network/protocol/FightProtocols":"FightProtocols","../network/protocol/TypeProtocols":"TypeProtocols","../utils/ByteDanceMiniGameUtils":"ByteDanceMiniGameUtils","../utils/ConfigUtils":"ConfigUtils","../utils/ConstValue":"ConstValue","../utils/DalanReportUtils":"DalanReportUtils","../utils/GamePlatform":"GamePlatform","../utils/GameTools":"GameTools","../utils/GameUtils":"GameUtils","../utils/ResourcesManager":"ResourcesManager","../utils/Tools":"Tools","../utils/WechatUtils":"WechatUtils","./activity/ActivityModule":"ActivityModule","./anniversary/AnniversaryModule":"AnniversaryModule","./machineryCityActivity/MachineryCityModel":"MachineryCityModel"}],FightNetwork:[function(e,t,o){"use strict";cc._RF.push(t,"0169836MVZONJ0cwzMCXx8T","FightNetwork"),Object.defineProperty(o,"__esModule",{value:!0}),o.FightNetwork=o.FIGHTSERVER_EXTRA_MSG=void 0;var i,a=e("../Global/GameGlobal"),n=e("./protocol/DataViewRW"),r=e("./CheckCRC"),s=e("./protocol/long"),c=e("../utils/GamePlatform"),l=e("./ClientNetwork"),d=e("../utils/GameUtils");(function(e){e[e.EXTRA_MSG_FIGHTSEVER_NONE=100]="EXTRA_MSG_FIGHTSEVER_NONE",e[e.EXTRA_MSG_FIGHTSEVER_CONNCET_SUCCEED=101]="EXTRA_MSG_FIGHTSEVER_CONNCET_SUCCEED",e[e.EXTRA_MSG_FIGHTSEVER_CONNCET_FAILED=102]="EXTRA_MSG_FIGHTSEVER_CONNCET_FAILED",e[e.EXTRA_MSG_FIGHTSEVER_CLOSE=103]="EXTRA_MSG_FIGHTSEVER_CLOSE"})(i=o.FIGHTSERVER_EXTRA_MSG||(o.FIGHTSERVER_EXTRA_MSG={}));var u=function(){function e(){this.m_Ws=null,this.m_PingHandle=null,this.NCS_WORLD_PING=1001,this.m_Url=null,this.m_tagPtl=new Map,this.m_WaitingMsg=new Set,this.m_Seq=s.fromNumber(0),this.m_Key=0,this.maxSendLen=0,this.maxRecvLen=0,this.isSending=!1,this.list=[],this.frameSendOpen=!1}return e.prototype.getWebSocket=function(){return e.getInstance().m_Ws},e.getInstance=function(){return null===e.s_Ins&&(e.s_Ins=new e),e.s_Ins},e.prototype.Connect=function(e){return this.m_Url=e,this.Reconnect()},e.prototype.isConnected=function(){return!(!this.m_Ws||this.m_Ws.readyState!==WebSocket.OPEN)},e.prototype.Disconnect=function(){null!==this.m_Ws&&(this.m_Ws.close(),this.m_Ws=null)},e.prototype.Reconnect=function(){if(this.setFrameSendOpen(),null===this.m_Url)return!1;var e=l.ClientNetwork.getInstance().getWebSocket();return!(e&&e.readyState!=WebSocket.OPEN||(this.Disconnect(),cc.sys.isNative&&this.m_Url.startsWith("wss")?this.m_Ws=new WebSocket(this.m_Url,[],this.getWssCacert()):this.m_Ws=new WebSocket(this.m_Url),this.m_Ws.binaryType="arraybuffer",this.m_Ws.onopen=this.onOpen.bind(this),this.m_Ws.onclose=this.onClose.bind(this),this.m_Ws.onerror=this.onError.bind(this),this.m_Ws.onmessage=this.onMessage.bind(this),0))},e.prototype.ReconnectLater=function(e){var t=this;return void 0===e&&(e=3e3),null!==this.m_Url&&(setTimeout(function(){t.m_Ws.readyState!=WebSocket.OPEN&&t.Reconnect()},e),!0)},e.prototype.setFrameSendOpen=function(){var e=!1;1==parseInt(d.getConfigIntValue("fight_frame_send_msg"))&&(e=!0),this.frameSendOpen=c.GamePlatform.isByteDanceMiniGame()||c.GamePlatform.isWechat()&&e||!1,console.log("frameSendOpen "+this.frameSendOpen)},e.prototype.getNextSend=function(){if(0==this.list.length||this.isSending)return!1;var e=this.list.splice(0,1)[0];return null!=e&&(this.isSending=!0,this.Send2(e.ptl,e.message))},e.prototype.Send=function(e,t,o,i){if(void 0===o&&(o=!1),void 0===i&&(i=!1),this.frameSendOpen)return this.m_Ws&&this.m_Ws.readyState===WebSocket.OPEN?(this.list.push({ptl:e,message:t}),this.getNextSend()):(i&&a.G.StringManager.PopString(a.G.StringManager.getString("CONNECT_NO_CLIENTNETWORK")),this.m_Ws?console.log("Send wrong fightnetworkstate ["+this.m_Ws.readyState+"]"):console.log("Send wrong fightnetworkstate [m_Ws null]"),!1);this.Send2(e,t,o,i)},e.prototype.Send2=function(e,t,o,i){var s=this;if(void 0===o&&(o=!1),void 0===i&&(i=!1),!this.m_Ws||this.m_Ws.readyState!==WebSocket.OPEN)return i&&a.G.StringManager.PopString(a.G.StringManager.getString("CONNECT_NO_CLIENTNETWORK")),this.m_Ws?console.log("Send wrong fightnetworkstate ["+this.m_Ws.readyState+"]"):console.log("Send wrong fightnetworkstate [m_Ws null]"),!1;o&&(this.isTagPtl(e)&&this.m_WaitingMsg.add(""+e),a.G.UIManager.showWaitingLayer(a.G.UIManager.getCurSceneName()));var c=new ArrayBuffer(1048576),l=new n.DataViewWriter(c);l.advance(8),t&&t.write(l),l.markEnd(),l.resetPos(),l.setInt32(l.getLen()+8+4),l.setInt32(e),l.resetPos(),l.advance(l.getLen()),this.m_Seq=this.m_Seq.add(1),l.setLong(this.m_Seq),l.markEnd();var d=r.crc32_buf(new Uint8Array(c,0,l.getLen()),0);l.setUint32(d),l.markEnd(),0!=this.m_Key&&new Uint8Array(c,8,l.getLen()-8).forEach(function(e,t,o){o[t]=e^this.m_Key}.bind(this)),this.m_Ws.send(l.getArrayBuffer());var u=l.getLen();return u>this.maxSendLen&&(this.maxSendLen=u,console.log("nettest fight maxSend "+this.maxSendLen+" ptl "+e)),this.frameSendOpen&&setTimeout(function(){s.isSending=!1,s.getNextSend()},10),!0},e.prototype.listenProtocol=function(e,t,o){cc.director.on("msg_"+e,function(e,i){cc.isValid(o)?(e.resetPos(),t.call(o,e,i)):cc.director.targetOff(o)},o)},e.prototype.listenExtraMsg=function(e,t,o){cc.director.on("extra_"+e,function(e){cc.isValid(o)?t.call(o,e):cc.director.targetOff(o)},o)},e.prototype.listenLocalMessage=function(e,t,o,i){void 0===i&&(i=!1),i?cc.director.once("loacl_"+e,t,o):cc.director.on("loacl_"+e,t,o)},e.prototype.pushLocalMessage=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];cc.director.emit("loacl_"+String(e),t)},e.prototype.removeMessageTarget=function(e){cc.director.targetOff(e)},e.prototype.unlistenProtocol=function(e){cc.director.off("msg_"+e)},e.prototype.unlistenLocalMessage=function(e,t,o){cc.director.off("loacl_"+e,t,o)},e.prototype.removeLocalMessage=function(e,t){cc.director.off("loacl_"+e,null,t)},e.prototype.onOpen=function(){this.list=[],this.isSending=!1,console.log("fightserver onOpen~~~~~"+this.m_Ws.readyState),this.m_Seq=s.fromNumber(0),this.m_Key=0,this.m_Ws.readyState==WebSocket.OPEN&&(this.startSendPing(),cc.director.emit("extra_"+String(i.EXTRA_MSG_FIGHTSEVER_CONNCET_SUCCEED),i.EXTRA_MSG_FIGHTSEVER_CONNCET_SUCCEED))},e.prototype.onClose=function(e){console.log("fightserver onClose=",e),this.stopSendPing(),cc.director.emit("extra_"+String(i.EXTRA_MSG_FIGHTSEVER_CLOSE),e),this.list=[],this.isSending=!1},Object.defineProperty(e.prototype,"WaitingMsg",{get:function(){return this.m_WaitingMsg},enumerable:!1,configurable:!0}),e.prototype.startSendPing=function(){var e=this;null===this.m_PingHandle&&(this.m_PingHandle=setInterval(function(){e.SendPing()},25e3))},e.prototype.stopSendPing=function(){null!==this.m_PingHandle&&(clearInterval(this.m_PingHandle),this.m_PingHandle=null)},e.prototype.SendPing=function(){console.log("send ping..."),this.Send(this.NCS_WORLD_PING,null)},e.prototype.onError=function(){cc.log("onError~~~~~")},e.prototype.onMessage=function(e){var t=new n.DataViewReader(e.data);if(t.getLen()<8)return console.log("msg len Error!!!"),void this.Disconnect();t.getUint32();var o=t.getUint32(),i=t.getLen()-8;cc.director.emit("msg_"+o,new n.DataViewReader(t.getBuffer(),t.getOffset()+t.getPos(),i),o),this.m_RecvCallback&&this.m_RecvCallback(o);var a=i;a>this.maxRecvLen&&(this.maxRecvLen=a,console.log("nettest fight maxRecv "+this.maxRecvLen+" ptl "+o))},Object.defineProperty(e.prototype,"RecvCallback",{set:function(e){this.m_RecvCallback=e},enumerable:!1,configurable:!0}),e.prototype.getWssCacert=function(){var e=cc.resources.getInfoWithPath("cacert").uuid;return cc.assetManager.utils.getUrlWithUuid(e,{isNative:!0,nativeExt:".pem"})},e.prototype.addTagPtl=function(e){this.m_tagPtl.set(e,1)},e.prototype.isTagPtl=function(e){return this.m_tagPtl.has(e)},e.prototype.setKey=function(e){this.m_Key=e},e.s_Ins=null,e}();o.FightNetwork=u,cc._RF.pop()},{"../Global/GameGlobal":"GameGlobal","../utils/GamePlatform":"GamePlatform","../utils/GameUtils":"GameUtils","./CheckCRC":"CheckCRC","./ClientNetwork":"ClientNetwork","./protocol/DataViewRW":"DataViewRW","./protocol/long":"long"}],FightProtocols:[function(e,t,o){"use strict";cc._RF.push(t,"5353alBY/ZKKr6pOqAv0wzf","FightProtocols"),e("DataViewRW");var i=e("ObjCollection"),a=e("long"),n=e("./BaseProtocols").T_Fight_Detail_Info,r=e("./BaseProtocols").T_RoleAbstract,s=e("./BaseProtocols").T_Attr;e("./BaseProtocols").T_SkillParamStruct,function(e){e[e.P_Fight_Begin=1e7]="P_Fight_Begin",e[e.P_Fight_Test=10000001]="P_Fight_Test",e[e.P_Fight_Role_Login=10000002]="P_Fight_Role_Login",e[e.P_Fight_Loading_Ready=10000003]="P_Fight_Loading_Ready",e[e.P_Fight_FightStart=10000004]="P_Fight_FightStart",e[e.P_Fight_FightEnd=10000005]="P_Fight_FightEnd",e[e.P_Fight_Player_Blood_SYNC=10000006]="P_Fight_Player_Blood_SYNC",e[e.P_Fight_Monster_Blood_SYNC=10000007]="P_Fight_Monster_Blood_SYNC",e[e.P_Fight_SP_SYNC=10000008]="P_Fight_SP_SYNC",e[e.P_Fight_Random_Tower_SYNC=10000009]="P_Fight_Random_Tower_SYNC",e[e.P_Fight_Mix_Tower_SYNC=10000010]="P_Fight_Mix_Tower_SYNC",e[e.P_Fight_Level_Tower_SYNC=10000011]="P_Fight_Level_Tower_SYNC",e[e.P_Fight_Help_Scene_SYNC=10000012]="P_Fight_Help_Scene_SYNC",e[e.P_Fight_Scene_SYNC=10000013]="P_Fight_Scene_SYNC",e[e.P_Fight_Report_Result_To_Fight=10000014]="P_Fight_Report_Result_To_Fight",e[e.P_Fight_Report_Result_To_Logic=10000015]="P_Fight_Report_Result_To_Logic",e[e.P_Fight_Give_Up=10000016]="P_Fight_Give_Up",e[e.P_Fight_Expression=10000017]="P_Fight_Expression",e[e.P_Fight_Tower_State_SYNC=10000018]="P_Fight_Tower_State_SYNC",e[e.P_Fight_Skill_SYNC=10000019]="P_Fight_Skill_SYNC",e[e.P_Fight_Report_Phase_Result_To_Fight=10000020]="P_Fight_Report_Phase_Result_To_Fight",e[e.P_Fight_Report_Phase_Result_To_Logic=10000021]="P_Fight_Report_Phase_Result_To_Logic",e[e.P_Fight_Round_Sync=10000022]="P_Fight_Round_Sync",e[e.P_Fight_Scene_SYNC_Finish=10000023]="P_Fight_Scene_SYNC_Finish",e[e.P_Fight_Effect_SYNC=10000024]="P_Fight_Effect_SYNC",e[e.P_Fight_Monster_Info_SYNC=10000025]="P_Fight_Monster_Info_SYNC",e[e.P_Fight_Replace=10000026]="P_Fight_Replace",e[e.P_Fight_Meteor_Position_SYNC=10000027]="P_Fight_Meteor_Position_SYNC",e[e.P_Fight_Chat_Mute_Config_SYNC=10000028]="P_Fight_Chat_Mute_Config_SYNC",e[e.P_Fight_Player_Kill_Value_SYNC=10000029]="P_Fight_Player_Kill_Value_SYNC",e[e.P_Fight_Notice_Other_Effect_SYNC=10000030]="P_Fight_Notice_Other_Effect_SYNC",e[e.P_Fight_Guard_TableData_SYNC=10000031]="P_Fight_Guard_TableData_SYNC",e[e.P_Fight_Update_Car_SYNC=10000100]="P_Fight_Update_Car_SYNC",e[e.P_Fight_Update_Hero_SYNC=10000101]="P_Fight_Update_Hero_SYNC",e[e.P_Fight_Update_Equip_SYNC=10000102]="P_Fight_Update_Equip_SYNC",e[e.P_Fight_Car_Blood_SYN=10000103]="P_Fight_Car_Blood_SYN",e[e.P_Fight_Silver_SYNC=10000104]="P_Fight_Silver_SYNC",e[e.P_Fight_Sell_Hero_SYNC=10000105]="P_Fight_Sell_Hero_SYNC",e[e.P_Fight_Monster_SYNC=10000106]="P_Fight_Monster_SYNC",e[e.P_Fight_Hero_Attr_SYNC=10000107]="P_Fight_Hero_Attr_SYNC",e[e.P_Fight_Refresh_Card_Count_SYNC=10000108]="P_Fight_Refresh_Card_Count_SYNC",e[e.P_Fight_Operate_Equip_SYNC=10000109]="P_Fight_Operate_Equip_SYNC",e[e.P_Fight_Timer_Notice=10000110]="P_Fight_Timer_Notice",e[e.P_Fight_Key_Batch_Sync=10000111]="P_Fight_Key_Batch_Sync",e[e.P_Fight_Add_Buff_SYNC=10000112]="P_Fight_Add_Buff_SYNC",e[e.P_Fight_Remove_Buff_SYNC=10000113]="P_Fight_Remove_Buff_SYNC",e[e.P_Fight_Trigger_Buff_SYNC=10000114]="P_Fight_Trigger_Buff_SYNC"}(o.FIGHT_CLIENT_ENUM||(o.FIGHT_CLIENT_ENUM={})),function(e){e[e.NPC_TYPE_CAR=1]="NPC_TYPE_CAR",e[e.NPC_TYPE_HERO=2]="NPC_TYPE_HERO",e[e.NPC_TYPE_MONSTER=3]="NPC_TYPE_MONSTER",e[e.NPC_TYPE_BOSS=4]="NPC_TYPE_BOSS",e[e.NPC_TYPE_SUMMONED=5]="NPC_TYPE_SUMMONED"}(o.NPC_TYPE_ENUM||(o.NPC_TYPE_ENUM={})),function(e){e[e.OPERATE_TYPE_DROP_EQUIP=1]="OPERATE_TYPE_DROP_EQUIP",e[e.OPERATE_TYPE_CHANGE_EQUIP1=2]="OPERATE_TYPE_CHANGE_EQUIP1",e[e.OPERATE_TYPE_CHANGE_EQUIP2=3]="OPERATE_TYPE_CHANGE_EQUIP2",e[e.OPERATE_TYPE_COST_EQUIP=4]="OPERATE_TYPE_COST_EQUIP",e[e.OPERATE_TYPE_HERO_LVDOWN=5]="OPERATE_TYPE_HERO_LVDOWN",e[e.OPERATE_TYPE_SPECIAL_EFFECT=6]="OPERATE_TYPE_SPECIAL_EFFECT"}(o.OPERATE_TYPE||(o.OPERATE_TYPE={})),function(e){e[e.BUFF_TYPE_INJURY_FREE=1]="BUFF_TYPE_INJURY_FREE"}(o.BUFF_TYPE||(o.BUFF_TYPE={}));var c=function(){function e(){this.a=0,this.b=0,this.c=0,this.d=0,this.e=0,this.f=0,this.g=0,this.h=0,this.i=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<36||(this.a=e.getInt32(),this.b=e.getInt32(),this.c=e.getInt32(),this.d=e.getInt32(),this.e=e.getInt32(),this.f=e.getInt32(),this.g=e.getInt32(),this.h=e.getInt32(),this.i=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.a),e.setInt32(this.b),e.setInt32(this.c),e.setInt32(this.d),e.setInt32(this.e),e.setInt32(this.f),e.setInt32(this.g),e.setInt32(this.h),e.setInt32(this.i)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Fight_Test=c;var l=function(){function e(){this.roleID=a.fromValue(0),this.matchRoles=new i.ObjMap,this.fightToken="",this.fightPattern=0,this.fightType=0}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<12)return!1;this.roleID=e.getLong();var t=e.getUint32();this.matchRoles.clear();for(var o=0;o<t;++o){var i;i=e.getLong();var a=new r;if(!a.read(e))return!1;this.matchRoles.set(i,a)}if(e.getLen()-e.getPos()<4)return!1;var n=e.getUint32();return!(e.getLen()-e.getPos()<n||(this.fightToken=e.getString(n),e.getLen()-e.getPos()<8||(this.fightPattern=e.getInt32(),this.fightType=e.getInt32(),0)))},e.prototype.writeNoEnd=function(e){e.setLong(this.roleID),e.setUint32(this.matchRoles.size),this.matchRoles.forEach(function(t,o){e.setLong(o),t.writeNoEnd(e)}),e.setString(this.fightToken),e.setInt32(this.fightPattern),e.setInt32(this.fightType)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Fight_Role_Login=l;var d=function(){function e(){this.errorcode=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<5||(this.errorcode=e.getInt32(),this.key=e.getUint8(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setUint8(this.key)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Fight_Role_Login=d;var u=function(){function e(){this.roleID=a.fromValue(0),this.fightToken=""}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<12)return!1;this.roleID=e.getLong();var t=e.getUint32();return!(e.getLen()-e.getPos()<t||(this.fightToken=e.getString(t),0))},e.prototype.writeNoEnd=function(e){e.setLong(this.roleID),e.setString(this.fightToken)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Fight_Loading_Ready=u;var h=function(){function e(){this.errorcode=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Fight_Loading_Ready=h;var p=function(){function e(){}return e.prototype.read=function(){return!0},e.prototype.writeNoEnd=function(){},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Fight_FightStart=p;var f=function(){function e(){this.reason=0,this.winRoleID=a.fromValue(0)}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<12||(this.reason=e.getInt32(),this.winRoleID=e.getLong(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.reason),e.setLong(this.winRoleID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Fight_FightEnd=f;var g=function(){function e(){this.dropBlood=0,this.curBlood=0,this.maxBlood=0,this.addBlood=0,this.type=3,this.heroId=0,this.extraDropMoney=0,this.damageType=0,this.maxDropBlood=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<36||(this.dropBlood=e.getInt32(),this.curBlood=e.getInt32(),this.maxBlood=e.getInt32(),this.addBlood=e.getInt32(),this.type=e.getInt32(),this.heroId=e.getInt32(),this.extraDropMoney=e.getInt32(),this.damageType=e.getInt32(),this.maxDropBlood=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.dropBlood),e.setInt32(this.curBlood),e.setInt32(this.maxBlood),e.setInt32(this.addBlood),e.setInt32(this.type),e.setInt32(this.heroId),e.setInt32(this.extraDropMoney),e.setInt32(this.damageType),e.setInt32(this.maxDropBlood)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Blood_Struct=g;var m=function(){function e(){this.monsterBlood=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();if(e.getLen()-e.getPos()<40*t)return!1;this.monsterBlood.clear();for(var o=0;o<t;++o){var i;i=e.getInt32();var a=new g;if(!a.read(e))return!1;this.monsterBlood.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setUint32(this.monsterBlood.size),this.monsterBlood.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Monster_Blood_Struct=m;var _=function(){function e(){this.sp=0,this.spChange=0,this.type=0,this.spChangeType=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<16||(this.sp=e.getInt32(),this.spChange=e.getInt32(),this.type=e.getInt32(),this.spChangeType=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.sp),e.setInt32(this.spChange),e.setInt32(this.type),e.setInt32(this.spChangeType)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Fight_SP_Struct=_;var y=function(){function e(){this.heroID=0,this.roleIdentity=0,this.posIndex=0,this.levelUpLevel=0,this.mixLevel=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<20||(this.heroID=e.getInt32(),this.roleIdentity=e.getInt32(),this.posIndex=e.getInt32(),this.levelUpLevel=e.getInt32(),this.mixLevel=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.heroID),e.setInt32(this.roleIdentity),e.setInt32(this.posIndex),e.setInt32(this.levelUpLevel),e.setInt32(this.mixLevel)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Reconnect_Tower_Base_Struct=y;var v=function(){function e(){this.buffID=0,this.sourceGid=0,this.lifetime=0,this.continueIntervalTime=0,this.towerData=new y}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<36||(this.buffID=e.getInt32(),this.sourceGid=e.getInt32(),this.lifetime=e.getInt32(),this.continueIntervalTime=e.getInt32(),!this.towerData.read(e)))},e.prototype.writeNoEnd=function(e){e.setInt32(this.buffID),e.setInt32(this.sourceGid),e.setInt32(this.lifetime),e.setInt32(this.continueIntervalTime),this.towerData.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Reconnect_Buff_Struct=v;var C=function(){function e(){this.action=0,this.param1=0,this.param2=0,this.buffInfo=new v}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<48||(this.action=e.getInt32(),this.param1=e.getInt32(),this.param2=e.getInt32(),!this.buffInfo.read(e)))},e.prototype.writeNoEnd=function(e){e.setInt32(this.action),e.setInt32(this.param1),e.setInt32(this.param2),this.buffInfo.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Tower_ExtData_Struct=C;var S=function(){function e(){this.heroID=0,this.posIndex=0,this.levelUpLevel=0,this.minLevel=0,this.seedId=0,this.roleIdentity=1,this.isFree=!1,this.extData=new C}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<73||(this.heroID=e.getInt32(),this.posIndex=e.getInt32(),this.levelUpLevel=e.getInt32(),this.minLevel=e.getInt32(),this.seedId=e.getInt32(),this.roleIdentity=e.getInt32(),this.isFree=e.getBool(),!this.extData.read(e)))},e.prototype.writeNoEnd=function(e){e.setInt32(this.heroID),e.setInt32(this.posIndex),e.setInt32(this.levelUpLevel),e.setInt32(this.minLevel),e.setInt32(this.seedId),e.setInt32(this.roleIdentity),e.setBool(this.isFree),this.extData.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Random_Tower_Struct=S;var T=function(){function e(){this.posSource=0,this.posTarget=0,this.heroID=0,this.levelUpLevel=0,this.minLevel=0,this.seedId=0,this.extData=new C}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<72||(this.posSource=e.getInt32(),this.posTarget=e.getInt32(),this.heroID=e.getInt32(),this.levelUpLevel=e.getInt32(),this.minLevel=e.getInt32(),this.seedId=e.getInt32(),!this.extData.read(e)))},e.prototype.writeNoEnd=function(e){e.setInt32(this.posSource),e.setInt32(this.posTarget),e.setInt32(this.heroID),e.setInt32(this.levelUpLevel),e.setInt32(this.minLevel),e.setInt32(this.seedId),this.extData.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Mix_Tower_Struct=T;var I=function(){function e(){this.heroID=0,this.level=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.heroID=e.getInt32(),this.level=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.heroID),e.setInt32(this.level)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Level_Tower_Struct=I;var N=function(){function e(){this.state=0,this.roleIdentity=1}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.state=e.getInt32(),this.roleIdentity=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.state),e.setInt32(this.roleIdentity)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Tower_State_Struct=N;var b=function(){function e(){this.ownerType=0,this.skillID=0,this.targetVec=[],this.randomResultVec=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<12)return!1;this.ownerType=e.getInt32(),this.skillID=e.getInt32();var t=e.getUint32();if(e.getLen()-e.getPos()<4*t)return!1;this.targetVec=[];for(var o=0;o<t;++o){var i;i=e.getInt32(),this.targetVec.push(i)}if(e.getLen()-e.getPos()<4)return!1;var a=e.getUint32();if(e.getLen()-e.getPos()<4*a)return!1;this.randomResultVec=[];for(var n=0;n<a;++n){var r;r=e.getInt32(),this.randomResultVec.push(r)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.ownerType),e.setInt32(this.skillID),e.setUint32(this.targetVec.length),this.targetVec.forEach(function(t){e.setInt32(t)}),e.setUint32(this.randomResultVec.length),this.randomResultVec.forEach(function(t){e.setInt32(t)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Skill_Sync_Struct=b;var w=function(){function e(){this.effectType=1,this.targetType=1,this.effectID=0,this.uiEffectType=0,this.uiEffectData=0,this.monsterDistance=0,this.towerPosition=0,this.roleIdentity=1}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<32||(this.effectType=e.getInt32(),this.targetType=e.getInt32(),this.effectID=e.getInt32(),this.uiEffectType=e.getInt32(),this.uiEffectData=e.getInt32(),this.monsterDistance=e.getInt32(),this.towerPosition=e.getInt32(),this.roleIdentity=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.effectType),e.setInt32(this.targetType),e.setInt32(this.effectID),e.setInt32(this.uiEffectType),e.setInt32(this.uiEffectData),e.setInt32(this.monsterDistance),e.setInt32(this.towerPosition),e.setInt32(this.roleIdentity)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Fight_Effect_Sync_Struct=w;var E=function(){function e(){this.timeFrame=0,this.playerBlood=new i.ObjMap,this.monsterGid=0}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.timeFrame=e.getInt32();var t=e.getUint32();if(e.getLen()-e.getPos()<44*t)return!1;this.playerBlood.clear();for(var o=0;o<t;++o){var i;i=e.getLong();var a=new g;if(!a.read(e))return!1;this.playerBlood.set(i,a)}return!(e.getLen()-e.getPos()<4||(this.monsterGid=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.timeFrame),e.setUint32(this.playerBlood.size),this.playerBlood.forEach(function(t,o){e.setLong(o),t.writeNoEnd(e)}),e.setInt32(this.monsterGid)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Fight_Player_Blood_SYNC=E;var P=function(){function e(){this.timeFrame=0,this.syncRoleID=a.fromValue(0),this.playerBlood=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<16)return!1;this.timeFrame=e.getInt32(),this.syncRoleID=e.getLong();var t=e.getUint32();if(e.getLen()-e.getPos()<44*t)return!1;this.playerBlood.clear();for(var o=0;o<t;++o){var i;i=e.getLong();var a=new g;if(!a.read(e))return!1;this.playerBlood.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.timeFrame),e.setLong(this.syncRoleID),e.setUint32(this.playerBlood.size),this.playerBlood.forEach(function(t,o){e.setLong(o),t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Fight_Player_Blood_SYNC=P;var R=function(){function e(){this.monsterBlood=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();this.monsterBlood.clear();for(var o=0;o<t;++o){var i;i=e.getLong();var a=new m;if(!a.read(e))return!1;this.monsterBlood.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setUint32(this.monsterBlood.size),this.monsterBlood.forEach(function(t,o){e.setLong(o),t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Player_Monster_Blood_Struct=R;var L=function(){function e(){this.timeFrame=0,this.playerMonsterBlod=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.timeFrame=e.getInt32();var t=e.getUint32();this.playerMonsterBlod.clear();for(var o=0;o<t;++o){var i;i=e.getLong();var a=new R;if(!a.read(e))return!1;this.playerMonsterBlod.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.timeFrame),e.setUint32(this.playerMonsterBlod.size),this.playerMonsterBlod.forEach(function(t,o){e.setLong(o),t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Fight_Monster_Blood_SYNC=L;var A=function(){function e(){this.timeFrame=0,this.syncRoleID=a.fromValue(0),this.monsterBlood=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<16)return!1;this.timeFrame=e.getInt32(),this.syncRoleID=e.getLong();var t=e.getUint32();this.monsterBlood.clear();for(var o=0;o<t;++o){var i;i=e.getLong();var a=new m;if(!a.read(e))return!1;this.monsterBlood.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.timeFrame),e.setLong(this.syncRoleID),e.setUint32(this.monsterBlood.size),this.monsterBlood.forEach(function(t,o){e.setLong(o),t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Fight_Monster_Blood_SYNC=A;var D=function(){function e(){this.roleID=a.fromValue(0),this.sp=new _,this.timeFrame=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<28||(this.roleID=e.getLong(),!this.sp.read(e)||(this.timeFrame=e.getInt32(),0)))},e.prototype.writeNoEnd=function(e){e.setLong(this.roleID),this.sp.writeNoEnd(e),e.setInt32(this.timeFrame)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Fight_SP_SYNC=D;var M=function(){function e(){this.roleID=a.fromValue(0),this.sp=new _,this.timeFrame=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<28||(this.roleID=e.getLong(),!this.sp.read(e)||(this.timeFrame=e.getInt32(),0)))},e.prototype.writeNoEnd=function(e){e.setLong(this.roleID),this.sp.writeNoEnd(e),e.setInt32(this.timeFrame)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Fight_SP_SYNC=M;var B=function(){function e(){this.roleID=a.fromValue(0),this.randomTower=new S}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<81||(this.roleID=e.getLong(),!this.randomTower.read(e)))},e.prototype.writeNoEnd=function(e){e.setLong(this.roleID),this.randomTower.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Fight_Random_Tower_SYNC=B;var k=function(){function e(){this.roleID=a.fromValue(0),this.randomTower=new S}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<81||(this.roleID=e.getLong(),!this.randomTower.read(e)))},e.prototype.writeNoEnd=function(e){e.setLong(this.roleID),this.randomTower.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Fight_Random_Tower_SYNC=k;var G=function(){function e(){this.roleID=a.fromValue(0),this.mixTower=new T}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<80||(this.roleID=e.getLong(),!this.mixTower.read(e)))},e.prototype.writeNoEnd=function(e){e.setLong(this.roleID),this.mixTower.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Fight_Mix_Tower_SYNC=G;var O=function(){function e(){this.roleID=a.fromValue(0),this.mixTower=new T}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<80||(this.roleID=e.getLong(),!this.mixTower.read(e)))},e.prototype.writeNoEnd=function(e){e.setLong(this.roleID),this.mixTower.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Fight_Mix_Tower_SYNC=O;var H=function(){function e(){this.roleID=a.fromValue(0),this.levelTower=new I}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<16||(this.roleID=e.getLong(),!this.levelTower.read(e)))},e.prototype.writeNoEnd=function(e){e.setLong(this.roleID),this.levelTower.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Fight_Level_Tower_SYNC=H;var V=function(){function e(){this.roleID=a.fromValue(0),this.levelTower=new I}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<16||(this.roleID=e.getLong(),!this.levelTower.read(e)))},e.prototype.writeNoEnd=function(e){e.setLong(this.roleID),this.levelTower.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Fight_Level_Tower_SYNC=V;var F=function(){function e(){}return e.prototype.read=function(){return!0},e.prototype.writeNoEnd=function(){},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Fight_Help_Scene_SYNC=F;var U=function(){function e(){this.roleID=a.fromValue(0)}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.roleID=e.getLong(),0))},e.prototype.writeNoEnd=function(e){e.setLong(this.roleID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Fight_Help_Scene_SYNC=U;var x=function(){function e(){this.skillID=0,this.cdtime=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.skillID=e.getInt32(),this.cdtime=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.skillID),e.setInt32(this.cdtime)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Reconnect_skill_Struct=x;var Y=function(){function e(){this.id=0,this.gid=0,this.sp=0,this.speed=0,this.physicalReduce=0,this.magicReduce=0,this.roleIdentity=0,this.distanceX=0,this.distanceY=0,this.blood=new g,this.buffVector=[],this.skillVector=[],this.roleID=a.fromValue(0),this.attr=[],this.behitCount=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<76)return!1;if(this.id=e.getInt32(),this.gid=e.getInt32(),this.sp=e.getInt32(),this.speed=e.getInt32(),this.physicalReduce=e.getInt32(),this.magicReduce=e.getInt32(),this.roleIdentity=e.getInt32(),this.distanceX=e.getInt32(),this.distanceY=e.getInt32(),!this.blood.read(e))return!1;var t=e.getUint32();if(e.getLen()-e.getPos()<36*t)return!1;this.buffVector=[];for(var o=0;o<t;++o){var i=new v;if(!i.read(e))return!1;this.buffVector.push(i)}if(e.getLen()-e.getPos()<4)return!1;var a=e.getUint32();if(e.getLen()-e.getPos()<8*a)return!1;this.skillVector=[];for(var n=0;n<a;++n){var r=new x;if(!r.read(e))return!1;this.skillVector.push(r)}if(e.getLen()-e.getPos()<12)return!1;this.roleID=e.getLong();var s=e.getUint32();if(e.getLen()-e.getPos()<4*s)return!1;this.attr=[];for(var c=0;c<s;++c){var l;l=e.getInt32(),this.attr.push(l)}if(e.getLen()-e.getPos()<4)return!1;var d=e.getUint32();if(e.getLen()-e.getPos()<8*d)return!1;this.behitCount.clear();for(var u=0;u<d;++u){var h,p;h=e.getInt32(),p=e.getInt32(),this.behitCount.set(h,p)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.id),e.setInt32(this.gid),e.setInt32(this.sp),e.setInt32(this.speed),e.setInt32(this.physicalReduce),e.setInt32(this.magicReduce),e.setInt32(this.roleIdentity),e.setInt32(this.distanceX),e.setInt32(this.distanceY),this.blood.writeNoEnd(e),e.setUint32(this.buffVector.length),this.buffVector.forEach(function(t){t.writeNoEnd(e)}),e.setUint32(this.skillVector.length),this.skillVector.forEach(function(t){t.writeNoEnd(e)}),e.setLong(this.roleID),e.setUint32(this.attr.length),this.attr.forEach(function(t){e.setInt32(t)}),e.setUint32(this.behitCount.size),this.behitCount.forEach(function(t,o){e.setInt32(o),e.setInt32(t)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Reconnect_Monster_Info_Struct=Y;var j=function(){function e(){this.hostMonsterID=0,this.guestMonsterID=0,this.hostBossID=0,this.guestBossID=0,this.hostKillSummmonID=0,this.guestKillSummmonID=0,this.hostBossSummonID=0,this.guestBossSummonID=0,this.hostSeaMonsterSummonID=0,this.guestSeaMonsterSummonID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<40||(this.hostMonsterID=e.getInt32(),this.guestMonsterID=e.getInt32(),this.hostBossID=e.getInt32(),this.guestBossID=e.getInt32(),this.hostKillSummmonID=e.getInt32(),this.guestKillSummmonID=e.getInt32(),this.hostBossSummonID=e.getInt32(),this.guestBossSummonID=e.getInt32(),this.hostSeaMonsterSummonID=e.getInt32(),this.guestSeaMonsterSummonID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.hostMonsterID),e.setInt32(this.guestMonsterID),e.setInt32(this.hostBossID),e.setInt32(this.guestBossID),e.setInt32(this.hostKillSummmonID),e.setInt32(this.guestKillSummmonID),e.setInt32(this.hostBossSummonID),e.setInt32(this.guestBossSummonID),e.setInt32(this.hostSeaMonsterSummonID),e.setInt32(this.guestSeaMonsterSummonID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Reconnect_Monster_ID_Struct=j;var W=function(){function e(){this.paramInt=0,this.paramIntVector=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.paramInt=e.getInt32();var t=e.getUint32();if(e.getLen()-e.getPos()<4*t)return!1;this.paramIntVector=[];for(var o=0;o<t;++o){var i;i=e.getInt32(),this.paramIntVector.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.paramInt),e.setUint32(this.paramIntVector.length),this.paramIntVector.forEach(function(t){e.setInt32(t)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Reconnect_Extend_Tower_Info_Struct=W;var z=function(){function e(){this.heroID=0,this.gid=0,this.roleIdentity=0,this.posIndex=0,this.levelUpLevel=0,this.mixLevel=0,this.lockState=0,this.extendData=new W,this.skillVector=[],this.buffVector=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<28)return!1;if(this.heroID=e.getInt32(),this.gid=e.getInt32(),this.roleIdentity=e.getInt32(),this.posIndex=e.getInt32(),this.levelUpLevel=e.getInt32(),this.mixLevel=e.getInt32(),this.lockState=e.getInt32(),!this.extendData.read(e))return!1;if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();if(e.getLen()-e.getPos()<8*t)return!1;this.skillVector=[];for(var o=0;o<t;++o){var i=new x;if(!i.read(e))return!1;this.skillVector.push(i)}if(e.getLen()-e.getPos()<4)return!1;var a=e.getUint32();if(e.getLen()-e.getPos()<36*a)return!1;this.buffVector=[];for(var n=0;n<a;++n){var r=new v;if(!r.read(e))return!1;this.buffVector.push(r)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.heroID),e.setInt32(this.gid),e.setInt32(this.roleIdentity),e.setInt32(this.posIndex),e.setInt32(this.levelUpLevel),e.setInt32(this.mixLevel),e.setInt32(this.lockState),this.extendData.writeNoEnd(e),e.setUint32(this.skillVector.length),this.skillVector.forEach(function(t){t.writeNoEnd(e)}),e.setUint32(this.buffVector.length),this.buffVector.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Reconnect_Tower_Info_Struct=z;var K=function(){function e(){this.trapID=0,this.roleIdentity=0,this.distance=0,this.lifeTime=0,this.towerData=new y}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<36||(this.trapID=e.getInt32(),this.roleIdentity=e.getInt32(),this.distance=e.getInt32(),this.lifeTime=e.getInt32(),!this.towerData.read(e)))},e.prototype.writeNoEnd=function(e){e.setInt32(this.trapID),e.setInt32(this.roleIdentity),e.setInt32(this.distance),e.setInt32(this.lifeTime),this.towerData.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Reconnect_Trap_Info_Struct=K;var q=function(){function e(){this.id=0,this.hp=0,this.sp=0,this.roleIdentity=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<16||(this.id=e.getInt32(),this.hp=e.getInt32(),this.sp=e.getInt32(),this.roleIdentity=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.id),e.setInt32(this.hp),e.setInt32(this.sp),e.setInt32(this.roleIdentity)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Reconnect_Summmon_Monster_Struct=q;var Q=function(){function e(){this.id=0,this.attr=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();if(e.getLen()-e.getPos()<t)return!1;if(this.id=e.getString(t),e.getLen()-e.getPos()<4)return!1;var o=e.getUint32();if(e.getLen()-e.getPos()<4*o)return!1;this.attr=[];for(var i=0;i<o;++i){var a;a=e.getInt32(),this.attr.push(a)}return!0},e.prototype.writeNoEnd=function(e){e.setString(this.id),e.setUint32(this.attr.length),this.attr.forEach(function(t){e.setInt32(t)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Hero_Attr_Struct=Q;var X=function(){function e(){this.heroPos=0,this.heroID=0,this.level=0,this.starLevel=0,this.levelUpSp=0,this.damageTotal=a.fromValue(0),this.attr=[],this.lockState=0,this.skillVector=[],this.buffVector=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<32)return!1;this.heroPos=e.getInt32(),this.heroID=e.getInt32(),this.level=e.getInt32(),this.starLevel=e.getInt32(),this.levelUpSp=e.getInt32(),this.damageTotal=e.getLong();var t=e.getUint32();if(e.getLen()-e.getPos()<4*t)return!1;this.attr=[];for(var o=0;o<t;++o){var i;i=e.getInt32(),this.attr.push(i)}if(e.getLen()-e.getPos()<8)return!1;this.lockState=e.getInt32();var a=e.getUint32();if(e.getLen()-e.getPos()<8*a)return!1;this.skillVector=[];for(var n=0;n<a;++n){var r=new x;if(!r.read(e))return!1;this.skillVector.push(r)}if(e.getLen()-e.getPos()<4)return!1;var s=e.getUint32();if(e.getLen()-e.getPos()<36*s)return!1;this.buffVector=[];for(var c=0;c<s;++c){var l=new v;if(!l.read(e))return!1;this.buffVector.push(l)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.heroPos),e.setInt32(this.heroID),e.setInt32(this.level),e.setInt32(this.starLevel),e.setInt32(this.levelUpSp),e.setLong(this.damageTotal),e.setUint32(this.attr.length),this.attr.forEach(function(t){e.setInt32(t)}),e.setInt32(this.lockState),e.setUint32(this.skillVector.length),this.skillVector.forEach(function(t){t.writeNoEnd(e)}),e.setUint32(this.buffVector.length),this.buffVector.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Reconnect_Hero_Info_Struct=X;var J=function(){function e(){this.equipPos=0,this.equipID=0,this.starLevel=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<12||(this.equipPos=e.getInt32(),this.equipID=e.getInt32(),this.starLevel=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.equipPos),e.setInt32(this.equipID),e.setInt32(this.starLevel)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Reconnect_Equip_Info_Struct=J;var Z=function(){function e(){this.delta=0,this.index=1,this.nRefreshTime=0,this.usedheroList=[],this.autoManaged=!0,this.delayAction=0}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<16)return!1;this.delta=e.getInt32(),this.index=e.getInt32(),this.nRefreshTime=e.getInt32();var t=e.getUint32();if(e.getLen()-e.getPos()<4*t)return!1;this.usedheroList=[];for(var o=0;o<t;++o){var i;i=e.getInt32(),this.usedheroList.push(i)}return!(e.getLen()-e.getPos()<5||(this.autoManaged=e.getBool(),this.delayAction=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.delta),e.setInt32(this.index),e.setInt32(this.nRefreshTime),e.setUint32(this.usedheroList.length),this.usedheroList.forEach(function(t){e.setInt32(t)}),e.setBool(this.autoManaged),e.setInt32(this.delayAction)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Reconnect_Player_AI_Info_Struct=Z;var $=function(){function e(){this.sp=0,this.spRand=0,this.hp=0,this.maxHp=0,this.carLevel=0,this.carSummonIndex=0,this.heroVector=[],this.equipVector=[],this.roleIdentity=1,this.combosNum=0,this.killValue=0,this.cardIdVec=[],this.heroSummonedIdVec=[],this.aiInfo=new Z}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<28)return!1;this.sp=e.getInt32(),this.spRand=e.getInt32(),this.hp=e.getInt32(),this.maxHp=e.getInt32(),this.carLevel=e.getInt32(),this.carSummonIndex=e.getInt32();var t=e.getUint32();this.heroVector=[];for(var o=0;o<t;++o){var i=new X;if(!i.read(e))return!1;this.heroVector.push(i)}if(e.getLen()-e.getPos()<4)return!1;var a=e.getUint32();if(e.getLen()-e.getPos()<12*a)return!1;this.equipVector=[];for(var n=0;n<a;++n){var r=new J;if(!r.read(e))return!1;this.equipVector.push(r)}if(e.getLen()-e.getPos()<16)return!1;this.roleIdentity=e.getInt32(),this.combosNum=e.getInt32(),this.killValue=e.getInt32();var s=e.getUint32();if(e.getLen()-e.getPos()<4*s)return!1;this.cardIdVec=[];for(var c=0;c<s;++c){var l;l=e.getInt32(),this.cardIdVec.push(l)}if(e.getLen()-e.getPos()<4)return!1;var d=e.getUint32();if(e.getLen()-e.getPos()<4*d)return!1;this.heroSummonedIdVec=[];for(var u=0;u<d;++u){var h;h=e.getInt32(),this.heroSummonedIdVec.push(h)}return!!this.aiInfo.read(e)},e.prototype.writeNoEnd=function(e){e.setInt32(this.sp),e.setInt32(this.spRand),e.setInt32(this.hp),e.setInt32(this.maxHp),e.setInt32(this.carLevel),e.setInt32(this.carSummonIndex),e.setUint32(this.heroVector.length),this.heroVector.forEach(function(t){t.writeNoEnd(e)}),e.setUint32(this.equipVector.length),this.equipVector.forEach(function(t){t.writeNoEnd(e)}),e.setInt32(this.roleIdentity),e.setInt32(this.combosNum),e.setInt32(this.killValue),e.setUint32(this.cardIdVec.length),this.cardIdVec.forEach(function(t){e.setInt32(t)}),e.setUint32(this.heroSummonedIdVec.length),this.heroSummonedIdVec.forEach(function(t){e.setInt32(t)}),this.aiInfo.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Reconnect_Player_Info_Struct=$;var ee=function(){function e(){this.wave=0,this.waveTimelineIndex=0,this.waveTimelineIndexPassTime=0,this.bossIDIndex=0,this.sceneTime=0,this.battleState=0,this.summonMonsters=[],this.monsterIds=new j,this.monsters=[],this.towerInfo=[],this.trapInfo=[],this.playerInfo=[],this.reportData=new n}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<28)return!1;this.wave=e.getInt32(),this.waveTimelineIndex=e.getInt32(),this.waveTimelineIndexPassTime=e.getInt32(),this.bossIDIndex=e.getInt32(),this.sceneTime=e.getInt32(),this.battleState=e.getInt32();var t=e.getUint32();if(e.getLen()-e.getPos()<16*t)return!1;this.summonMonsters=[];for(var o=0;o<t;++o){var i=new q;if(!i.read(e))return!1;this.summonMonsters.push(i)}if(e.getLen()-e.getPos()<44)return!1;if(!this.monsterIds.read(e))return!1;var a=e.getUint32();this.monsters=[];for(var n=0;n<a;++n){var r=new Y;if(!r.read(e))return!1;this.monsters.push(r)}if(e.getLen()-e.getPos()<4)return!1;var s=e.getUint32();this.towerInfo=[];for(var c=0;c<s;++c){var l=new z;if(!l.read(e))return!1;this.towerInfo.push(l)}if(e.getLen()-e.getPos()<4)return!1;var d=e.getUint32();if(e.getLen()-e.getPos()<36*d)return!1;this.trapInfo=[];for(var u=0;u<d;++u){var h=new K;if(!h.read(e))return!1;this.trapInfo.push(h)}if(e.getLen()-e.getPos()<4)return!1;var p=e.getUint32();this.playerInfo=[];for(var f=0;f<p;++f){var g=new $;if(!g.read(e))return!1;this.playerInfo.push(g)}return!!this.reportData.read(e)},e.prototype.writeNoEnd=function(e){e.setInt32(this.wave),e.setInt32(this.waveTimelineIndex),e.setInt32(this.waveTimelineIndexPassTime),e.setInt32(this.bossIDIndex),e.setInt32(this.sceneTime),e.setInt32(this.battleState),e.setUint32(this.summonMonsters.length),this.summonMonsters.forEach(function(t){t.writeNoEnd(e)}),this.monsterIds.writeNoEnd(e),e.setUint32(this.monsters.length),this.monsters.forEach(function(t){t.writeNoEnd(e)}),e.setUint32(this.towerInfo.length),this.towerInfo.forEach(function(t){t.writeNoEnd(e)}),e.setUint32(this.trapInfo.length),this.trapInfo.forEach(function(t){t.writeNoEnd(e)}),e.setUint32(this.playerInfo.length),this.playerInfo.forEach(function(t){t.writeNoEnd(e)}),this.reportData.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Fight_Scene_SYNC=ee;var te=function(){function e(){this.roleID=a.fromValue(0),this.wave=0,this.waveTimelineIndex=0,this.waveTimelineIndexPassTime=0,this.bossIDIndex=0,this.sceneTime=0,this.battleState=0,this.summonMonsters=[],this.monsterIds=new j,this.monsters=[],this.towerInfo=[],this.trapInfo=[],this.playerInfo=[],this.reportData=new n}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<36)return!1;this.roleID=e.getLong(),this.wave=e.getInt32(),this.waveTimelineIndex=e.getInt32(),this.waveTimelineIndexPassTime=e.getInt32(),this.bossIDIndex=e.getInt32(),this.sceneTime=e.getInt32(),this.battleState=e.getInt32();var t=e.getUint32();if(e.getLen()-e.getPos()<16*t)return!1;this.summonMonsters=[];for(var o=0;o<t;++o){var i=new q;if(!i.read(e))return!1;this.summonMonsters.push(i)}if(e.getLen()-e.getPos()<44)return!1;if(!this.monsterIds.read(e))return!1;var a=e.getUint32();this.monsters=[];for(var n=0;n<a;++n){var r=new Y;if(!r.read(e))return!1;this.monsters.push(r)}if(e.getLen()-e.getPos()<4)return!1;var s=e.getUint32();this.towerInfo=[];for(var c=0;c<s;++c){var l=new z;if(!l.read(e))return!1;this.towerInfo.push(l)}if(e.getLen()-e.getPos()<4)return!1;var d=e.getUint32();if(e.getLen()-e.getPos()<36*d)return!1;this.trapInfo=[];for(var u=0;u<d;++u){var h=new K;if(!h.read(e))return!1;this.trapInfo.push(h)}if(e.getLen()-e.getPos()<4)return!1;var p=e.getUint32();this.playerInfo=[];for(var f=0;f<p;++f){var g=new $;if(!g.read(e))return!1;this.playerInfo.push(g)}return!!this.reportData.read(e)},e.prototype.writeNoEnd=function(e){e.setLong(this.roleID),e.setInt32(this.wave),e.setInt32(this.waveTimelineIndex),e.setInt32(this.waveTimelineIndexPassTime),e.setInt32(this.bossIDIndex),e.setInt32(this.sceneTime),e.setInt32(this.battleState),e.setUint32(this.summonMonsters.length),this.summonMonsters.forEach(function(t){t.writeNoEnd(e)}),this.monsterIds.writeNoEnd(e),e.setUint32(this.monsters.length),this.monsters.forEach(function(t){t.writeNoEnd(e)}),e.setUint32(this.towerInfo.length),this.towerInfo.forEach(function(t){t.writeNoEnd(e)}),e.setUint32(this.trapInfo.length),this.trapInfo.forEach(function(t){t.writeNoEnd(e)}),e.setUint32(this.playerInfo.length),this.playerInfo.forEach(function(t){t.writeNoEnd(e)}),this.reportData.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Fight_Scene_SYNC=te;var oe=function(){function e(){this.reportData=new n}return e.prototype.read=function(e){return!!this.reportData.read(e)},e.prototype.writeNoEnd=function(e){this.reportData.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Fight_Report_Result_To_Fight=oe;var ie=function(){function e(){this.errorcode=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Fight_Report_Result_To_Fight=ie;var ae=function(){function e(){this.reportData=new n}return e.prototype.read=function(e){return!!this.reportData.read(e)},e.prototype.writeNoEnd=function(e){this.reportData.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Fight_Report_Result_To_Logic=ae;var ne=function(){function e(){this.errorcode=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Fight_Report_Result_To_Logic=ne;var re=function(){function e(){}return e.prototype.read=function(){return!0},e.prototype.writeNoEnd=function(){},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Fight_Give_Up=re;var se=function(){function e(){this.errorcode=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Fight_Give_Up=se;var ce=function(){function e(){this.type=0,this.contentId=0,this.msg=""}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<12)return!1;this.type=e.getInt32(),this.contentId=e.getInt32();var t=e.getUint32();return!(e.getLen()-e.getPos()<t||(this.msg=e.getString(t),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.type),e.setInt32(this.contentId),e.setString(this.msg)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Fight_Expression=ce;var le=function(){function e(){this.errorcode=0,this.roleID=a.fromValue(0),this.type=0,this.contentId=0,this.msg=""}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<24)return!1;this.errorcode=e.getInt32(),this.roleID=e.getLong(),this.type=e.getInt32(),this.contentId=e.getInt32();var t=e.getUint32();return!(e.getLen()-e.getPos()<t||(this.msg=e.getString(t),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setLong(this.roleID),e.setInt32(this.type),e.setInt32(this.contentId),e.setString(this.msg)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Fight_Expression=le;var de=function(){function e(){this.roleID=a.fromValue(0),this.towerState=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<12)return!1;this.roleID=e.getLong();var t=e.getUint32();if(e.getLen()-e.getPos()<12*t)return!1;this.towerState.clear();for(var o=0;o<t;++o){var i;i=e.getInt32();var a=new N;if(!a.read(e))return!1;this.towerState.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setLong(this.roleID),e.setUint32(this.towerState.size),this.towerState.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Fight_Tower_State_SYNC=de;var ue=function(){function e(){this.roleID=a.fromValue(0),this.towerState=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<12)return!1;this.roleID=e.getLong();var t=e.getUint32();if(e.getLen()-e.getPos()<12*t)return!1;this.towerState.clear();for(var o=0;o<t;++o){var i;i=e.getInt32();var a=new N;if(!a.read(e))return!1;this.towerState.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setLong(this.roleID),e.setUint32(this.towerState.size),this.towerState.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Fight_Tower_State_SYNC=ue;var he=function(){function e(){this.roleID=a.fromValue(0),this.skillStruct=new b}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.roleID=e.getLong(),!this.skillStruct.read(e)))},e.prototype.writeNoEnd=function(e){e.setLong(this.roleID),this.skillStruct.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Fight_Skill_SYNC=he;var pe=function(){function e(){this.roleID=a.fromValue(0),this.skillStruct=new b}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.roleID=e.getLong(),!this.skillStruct.read(e)))},e.prototype.writeNoEnd=function(e){e.setLong(this.roleID),this.skillStruct.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Fight_Skill_SYNC=pe;var fe=function(){function e(){this.reportData=new n}return e.prototype.read=function(e){return!!this.reportData.read(e)},e.prototype.writeNoEnd=function(e){this.reportData.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Fight_Report_Phase_Result_To_Fight=fe;var ge=function(){function e(){this.errorcode=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Fight_Report_Phase_Result_To_Fight=ge;var me=function(){function e(){this.reportData=new n}return e.prototype.read=function(e){return!!this.reportData.read(e)},e.prototype.writeNoEnd=function(e){this.reportData.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Fight_Report_Phase_Result_To_Logic=me;var _e=function(){function e(){this.errorcode=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Fight_Report_Phase_Result_To_Logic=_e;var ye=function(){function e(){this.round=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.round=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.round)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Fight_Round_Sync=ye;var ve=function(){function e(){this.round=0,this.errorcode=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.round=e.getInt32(),this.errorcode=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.round),e.setInt32(this.errorcode)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Fight_Round_Sync=ve;var Ce=function(){function e(){}return e.prototype.read=function(){return!0},e.prototype.writeNoEnd=function(){},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Fight_Scene_SYNC_Finish=Ce;var Se=function(){function e(){}return e.prototype.read=function(){return!0},e.prototype.writeNoEnd=function(){},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Fight_Scene_SYNC_Finish=Se;var Te=function(){function e(){this.roleID=a.fromValue(0),this.effectStruct=new w}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<40||(this.roleID=e.getLong(),!this.effectStruct.read(e)))},e.prototype.writeNoEnd=function(e){e.setLong(this.roleID),this.effectStruct.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Fight_Effect_SYNC=Te;var Ie=function(){function e(){this.roleID=a.fromValue(0),this.effectStruct=new w}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<40||(this.roleID=e.getLong(),!this.effectStruct.read(e)))},e.prototype.writeNoEnd=function(e){e.setLong(this.roleID),this.effectStruct.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Fight_Effect_SYNC=Ie;var Ne=function(){function e(){this.roleID=a.fromValue(0),this.replaced=!1}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<9||(this.roleID=e.getLong(),this.replaced=e.getBool(),0))},e.prototype.writeNoEnd=function(e){e.setLong(this.roleID),e.setBool(this.replaced)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Fight_Replace=Ne;var be=function(){function e(){this.id=0,this.hp=0,this.sp=0,this.type=0,this.distance=0,this.roleIdentity=1}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<24||(this.id=e.getInt32(),this.hp=e.getInt32(),this.sp=e.getInt32(),this.type=e.getInt32(),this.distance=e.getInt32(),this.roleIdentity=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.id),e.setInt32(this.hp),e.setInt32(this.sp),e.setInt32(this.type),e.setInt32(this.distance),e.setInt32(this.roleIdentity)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Fight_Monster_Info_Struct=be;var we=function(){function e(){this.roleID=a.fromValue(0),this.action=0,this.monsterVec=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<16)return!1;this.roleID=e.getLong(),this.action=e.getInt32();var t=e.getUint32();if(e.getLen()-e.getPos()<24*t)return!1;this.monsterVec=[];for(var o=0;o<t;++o){var i=new be;if(!i.read(e))return!1;this.monsterVec.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setLong(this.roleID),e.setInt32(this.action),e.setUint32(this.monsterVec.length),this.monsterVec.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Fight_Monster_Info_SYNC=we;var Ee=function(){function e(){this.roleID=a.fromValue(0),this.action=0,this.monsterVec=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<16)return!1;this.roleID=e.getLong(),this.action=e.getInt32();var t=e.getUint32();if(e.getLen()-e.getPos()<24*t)return!1;this.monsterVec=[];for(var o=0;o<t;++o){var i=new be;if(!i.read(e))return!1;this.monsterVec.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setLong(this.roleID),e.setInt32(this.action),e.setUint32(this.monsterVec.length),this.monsterVec.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Fight_Monster_Info_SYNC=Ee;var Pe=function(){function e(){this.roleID=a.fromValue(0),this.positionVec=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<12)return!1;this.roleID=e.getLong();var t=e.getUint32();if(e.getLen()-e.getPos()<4*t)return!1;this.positionVec=[];for(var o=0;o<t;++o){var i;i=e.getInt32(),this.positionVec.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setLong(this.roleID),e.setUint32(this.positionVec.length),this.positionVec.forEach(function(t){e.setInt32(t)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Fight_Meteor_Position_SYNC=Pe;var Re=function(){function e(){this.roleID=a.fromValue(0),this.positionVec=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<12)return!1;this.roleID=e.getLong();var t=e.getUint32();if(e.getLen()-e.getPos()<4*t)return!1;this.positionVec=[];for(var o=0;o<t;++o){var i;i=e.getInt32(),this.positionVec.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setLong(this.roleID),e.setUint32(this.positionVec.length),this.positionVec.forEach(function(t){e.setInt32(t)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Fight_Meteor_Position_SYNC=Re;var Le=function(){function e(){this.roleID=a.fromValue(0),this.isIntoVoIPChat=!1,this.isInvitation=!1}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<10||(this.roleID=e.getLong(),this.isIntoVoIPChat=e.getBool(),this.isInvitation=e.getBool(),0))},e.prototype.writeNoEnd=function(e){e.setLong(this.roleID),e.setBool(this.isIntoVoIPChat),e.setBool(this.isInvitation)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Fight_Chat_Mute_Config_SYNC=Le;var Ae=function(){function e(){this.roleID=a.fromValue(0),this.isIntoVoIPChat=!1,this.isInvitation=!1}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<10||(this.roleID=e.getLong(),this.isIntoVoIPChat=e.getBool(),this.isInvitation=e.getBool(),0))},e.prototype.writeNoEnd=function(e){e.setLong(this.roleID),e.setBool(this.isIntoVoIPChat),e.setBool(this.isInvitation)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Fight_Chat_Mute_Config_SYNC=Ae;var De=function(){function e(){this.roleID=a.fromValue(0),this.killValue=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<12||(this.roleID=e.getLong(),this.killValue=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setLong(this.roleID),e.setInt32(this.killValue)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Fight_Player_Kill_Value_SYNC=De;var Me=function(){function e(){this.roleID=a.fromValue(0),this.killValue=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<12||(this.roleID=e.getLong(),this.killValue=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setLong(this.roleID),e.setInt32(this.killValue)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Fight_Player_Kill_Value_SYNC=Me;var Be=function(){function e(){this.type=0,this.buffVec=[],this.param1=0,this.towerData=new y}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.type=e.getInt32();var t=e.getUint32();if(e.getLen()-e.getPos()<4*t)return!1;this.buffVec=[];for(var o=0;o<t;++o){var i;i=e.getInt32(),this.buffVec.push(i)}return!(e.getLen()-e.getPos()<24||(this.param1=e.getInt32(),!this.towerData.read(e)))},e.prototype.writeNoEnd=function(e){e.setInt32(this.type),e.setUint32(this.buffVec.length),this.buffVec.forEach(function(t){e.setInt32(t)}),e.setInt32(this.param1),this.towerData.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Notice_Other_Effect_Struct=Be;var ke=function(){function e(){this.roleID=a.fromValue(0),this.effectVec=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<12)return!1;this.roleID=e.getLong();var t=e.getUint32();this.effectVec=[];for(var o=0;o<t;++o){var i=new Be;if(!i.read(e))return!1;this.effectVec.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setLong(this.roleID),e.setUint32(this.effectVec.length),this.effectVec.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Fight_Notice_Other_Effect_SYNC=ke;var Ge=function(){function e(){this.roleID=a.fromValue(0),this.effectVec=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<12)return!1;this.roleID=e.getLong();var t=e.getUint32();this.effectVec=[];for(var o=0;o<t;++o){var i=new Be;if(!i.read(e))return!1;this.effectVec.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setLong(this.roleID),e.setUint32(this.effectVec.length),this.effectVec.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Fight_Notice_Other_Effect_SYNC=Ge;var Oe=function(){function e(){this.heroId=0,this.level=0,this.attr=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<12)return!1;this.heroId=e.getInt32(),this.level=e.getInt32();var t=e.getUint32();this.attr=[];for(var o=0;o<t;++o){var i=new s;if(!i.read(e))return!1;this.attr.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.heroId),e.setInt32(this.level),e.setUint32(this.attr.length),this.attr.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Guard_TableData_BattleLevelupTableData_Struct=Oe;var He=function(){function e(){this.npcId=0,this.npcLv=0,this.dropMoney=0,this.attr=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<16)return!1;this.npcId=e.getInt32(),this.npcLv=e.getInt32(),this.dropMoney=e.getInt32();var t=e.getUint32();this.attr=[];for(var o=0;o<t;++o){var i=new s;if(!i.read(e))return!1;this.attr.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.npcId),e.setInt32(this.npcLv),e.setInt32(this.dropMoney),e.setUint32(this.attr.length),this.attr.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Guard_TableData_BattleNpcMoneyTableData_Struct=He;var Ve=function(){function e(){this.carID=0,this.lvUpCostVec=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.carID=e.getInt32();var t=e.getUint32();if(e.getLen()-e.getPos()<4*t)return!1;this.lvUpCostVec=[];for(var o=0;o<t;++o){var i;i=e.getInt32(),this.lvUpCostVec.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.carID),e.setUint32(this.lvUpCostVec.length),this.lvUpCostVec.forEach(function(t){e.setInt32(t)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Guard_TableData_BattleCarCfgTableData_Struct=Ve;var Fe=function(){function e(){this.id=0,this.min=0,this.max=0,this.pvpCost=0,this.coopCost=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<20||(this.id=e.getInt32(),this.min=e.getInt32(),this.max=e.getInt32(),this.pvpCost=e.getInt32(),this.coopCost=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.id),e.setInt32(this.min),e.setInt32(this.max),e.setInt32(this.pvpCost),e.setInt32(this.coopCost)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Guard_TableData_BattleCardRefreshTableData_Struct=Fe;var Ue=function(){function e(){this.skillID=0,this.attr=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.skillID=e.getInt32();var t=e.getUint32();this.attr=[];for(var o=0;o<t;++o){var i=new s;if(!i.read(e))return!1;this.attr.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.skillID),e.setUint32(this.attr.length),this.attr.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Guard_TableData_BattleSkillTableData_Struct=Ue;var xe=function(){function e(){this.BuffID=0,this.BuffValue=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.BuffID=e.getInt32(),this.BuffValue=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.BuffID),e.setInt32(this.BuffValue)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Guard_TableData_BattleBuffTableData_Struct=xe;var Ye=function(){function e(){this.vecBattleLevelupTableData=[],this.vecBattleNpcMoneyTableData=[],this.vecBattleCarCfgTableData=[],this.vecBattleCardRefreshTableData=[],this.vecBattleSkillTableData=[],this.vecBattleBuffTableData=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();this.vecBattleLevelupTableData=[];for(var o=0;o<t;++o){var i=new Oe;if(!i.read(e))return!1;this.vecBattleLevelupTableData.push(i)}if(e.getLen()-e.getPos()<4)return!1;var a=e.getUint32();this.vecBattleNpcMoneyTableData=[];for(var n=0;n<a;++n){var r=new He;if(!r.read(e))return!1;this.vecBattleNpcMoneyTableData.push(r)}if(e.getLen()-e.getPos()<4)return!1;var s=e.getUint32();this.vecBattleCarCfgTableData=[];for(var c=0;c<s;++c){var l=new Ve;if(!l.read(e))return!1;this.vecBattleCarCfgTableData.push(l)}if(e.getLen()-e.getPos()<4)return!1;var d=e.getUint32();if(e.getLen()-e.getPos()<20*d)return!1;this.vecBattleCardRefreshTableData=[];for(var u=0;u<d;++u){var h=new Fe;if(!h.read(e))return!1;this.vecBattleCardRefreshTableData.push(h)}if(e.getLen()-e.getPos()<4)return!1;var p=e.getUint32();this.vecBattleSkillTableData=[];for(var f=0;f<p;++f){var g=new Ue;if(!g.read(e))return!1;this.vecBattleSkillTableData.push(g)}if(e.getLen()-e.getPos()<4)return!1;var m=e.getUint32();if(e.getLen()-e.getPos()<8*m)return!1;this.vecBattleBuffTableData=[];for(var _=0;_<m;++_){var y=new xe;if(!y.read(e))return!1;this.vecBattleBuffTableData.push(y)}return!0},e.prototype.writeNoEnd=function(e){e.setUint32(this.vecBattleLevelupTableData.length),this.vecBattleLevelupTableData.forEach(function(t){t.writeNoEnd(e)}),e.setUint32(this.vecBattleNpcMoneyTableData.length),this.vecBattleNpcMoneyTableData.forEach(function(t){t.writeNoEnd(e)}),e.setUint32(this.vecBattleCarCfgTableData.length),this.vecBattleCarCfgTableData.forEach(function(t){t.writeNoEnd(e)}),e.setUint32(this.vecBattleCardRefreshTableData.length),this.vecBattleCardRefreshTableData.forEach(function(t){t.writeNoEnd(e)}),e.setUint32(this.vecBattleSkillTableData.length),this.vecBattleSkillTableData.forEach(function(t){t.writeNoEnd(e)}),e.setUint32(this.vecBattleBuffTableData.length),this.vecBattleBuffTableData.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Guard_TableData_Main_Struct=Ye;var je=function(){function e(){this.fightGuard=new Ye}return e.prototype.read=function(e){return!!this.fightGuard.read(e)},e.prototype.writeNoEnd=function(e){this.fightGuard.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Fight_Guard_TableData_SYNC=je;var We=function(){function e(){this.camp=0,this.level=0,this.addHPPercent=0,this.addMaxHPPercent=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<16||(this.camp=e.getInt32(),this.level=e.getInt32(),this.addHPPercent=e.getInt32(),this.addMaxHPPercent=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.camp),e.setInt32(this.level),e.setInt32(this.addHPPercent),e.setInt32(this.addMaxHPPercent)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Update_Car_Struct=We;var ze=function(){function e(){this.roleID=a.fromValue(0),this.updateCar=new We}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<24||(this.roleID=e.getLong(),!this.updateCar.read(e)))},e.prototype.writeNoEnd=function(e){e.setLong(this.roleID),this.updateCar.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Fight_Update_Car_SYNC=ze;var Ke=function(){function e(){this.roleID=a.fromValue(0),this.updateCar=new We}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<24||(this.roleID=e.getLong(),!this.updateCar.read(e)))},e.prototype.writeNoEnd=function(e){e.setLong(this.roleID),this.updateCar.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Fight_Update_Car_SYNC=Ke;var qe=function(){function e(){this.camp=0,this.pos=0,this.heroTemplateId=0,this.heroLv=0,this.heroNpcId=0,this.heroTrainLv=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<24||(this.camp=e.getInt32(),this.pos=e.getInt32(),this.heroTemplateId=e.getInt32(),this.heroLv=e.getInt32(),this.heroNpcId=e.getInt32(),this.heroTrainLv=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.camp),e.setInt32(this.pos),e.setInt32(this.heroTemplateId),e.setInt32(this.heroLv),e.setInt32(this.heroNpcId),e.setInt32(this.heroTrainLv)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Update_Hero_Struct=qe;var Qe=function(){function e(){this.roleID=a.fromValue(0),this.updateHero=new qe}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<32||(this.roleID=e.getLong(),!this.updateHero.read(e)))},e.prototype.writeNoEnd=function(e){e.setLong(this.roleID),this.updateHero.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Fight_Update_Hero_SYNC=Qe;var Xe=function(){function e(){this.roleID=a.fromValue(0),this.updateHero=new qe}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<32||(this.roleID=e.getLong(),!this.updateHero.read(e)))},e.prototype.writeNoEnd=function(e){e.setLong(this.roleID),this.updateHero.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Fight_Update_Hero_SYNC=Xe;var Je=function(){function e(){this.camp=0,this.pos=0,this.equipId=0,this.equipLv=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<16||(this.camp=e.getInt32(),this.pos=e.getInt32(),this.equipId=e.getInt32(),this.equipLv=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.camp),e.setInt32(this.pos),e.setInt32(this.equipId),e.setInt32(this.equipLv)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Update_Equip_Struct=Je;var Ze=function(){function e(){this.roleID=a.fromValue(0),this.updateCar=new Je}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<24||(this.roleID=e.getLong(),!this.updateCar.read(e)))},e.prototype.writeNoEnd=function(e){e.setLong(this.roleID),this.updateCar.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Fight_Update_Equip_SYNC=Ze;var $e=function(){function e(){this.roleID=a.fromValue(0),this.updateCar=new Je}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<24||(this.roleID=e.getLong(),!this.updateCar.read(e)))},e.prototype.writeNoEnd=function(e){e.setLong(this.roleID),this.updateCar.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Fight_Update_Equip_SYNC=$e;var et=function(){function e(){this.timeFrame=0,this.playerBlood=new i.ObjMap,this.monsterGid=0}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.timeFrame=e.getInt32();var t=e.getUint32();if(e.getLen()-e.getPos()<44*t)return!1;this.playerBlood.clear();for(var o=0;o<t;++o){var i;i=e.getLong();var a=new g;if(!a.read(e))return!1;this.playerBlood.set(i,a)}return!(e.getLen()-e.getPos()<4||(this.monsterGid=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.timeFrame),e.setUint32(this.playerBlood.size),this.playerBlood.forEach(function(t,o){e.setLong(o),t.writeNoEnd(e)}),e.setInt32(this.monsterGid)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Fight_Car_Blood_SYNC=et;var tt=function(){function e(){this.timeFrame=0,this.syncRoleID=a.fromValue(0),this.playerBlood=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<16)return!1;this.timeFrame=e.getInt32(),this.syncRoleID=e.getLong();var t=e.getUint32();if(e.getLen()-e.getPos()<44*t)return!1;this.playerBlood.clear();for(var o=0;o<t;++o){var i;i=e.getLong();var a=new g;if(!a.read(e))return!1;this.playerBlood.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.timeFrame),e.setLong(this.syncRoleID),e.setUint32(this.playerBlood.size),this.playerBlood.forEach(function(t,o){e.setLong(o),t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Fight_Car_Blood_SYNC=tt;var ot=function(){function e(){this.Silver=0,this.SilverChange=0,this.type=0,this.SilverChangeType=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<16||(this.Silver=e.getInt32(),this.SilverChange=e.getInt32(),this.type=e.getInt32(),this.SilverChangeType=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.Silver),e.setInt32(this.SilverChange),e.setInt32(this.type),e.setInt32(this.SilverChangeType)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Fight_Silver_Struct=ot;var it=function(){function e(){this.roleID=a.fromValue(0),this.silver=new ot,this.timeFrame=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<28||(this.roleID=e.getLong(),!this.silver.read(e)||(this.timeFrame=e.getInt32(),0)))},e.prototype.writeNoEnd=function(e){e.setLong(this.roleID),this.silver.writeNoEnd(e),e.setInt32(this.timeFrame)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Fight_Silver_SYNC=it;var at=function(){function e(){this.roleID=a.fromValue(0),this.silver=new ot,this.timeFrame=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<28||(this.roleID=e.getLong(),!this.silver.read(e)||(this.timeFrame=e.getInt32(),0)))},e.prototype.writeNoEnd=function(e){e.setLong(this.roleID),this.silver.writeNoEnd(e),e.setInt32(this.timeFrame)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Fight_Silver_SYNC=at;var nt=function(){function e(){this.camp=0,this.pos=0,this.heroTemplateId=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<12||(this.camp=e.getInt32(),this.pos=e.getInt32(),this.heroTemplateId=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.camp),e.setInt32(this.pos),e.setInt32(this.heroTemplateId)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Sell_Hero_Struct=nt;var rt=function(){function e(){this.roleID=a.fromValue(0),this.sellHero=new nt}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<20||(this.roleID=e.getLong(),!this.sellHero.read(e)))},e.prototype.writeNoEnd=function(e){e.setLong(this.roleID),this.sellHero.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Fight_Sell_Hero_SYNC=rt;var st=function(){function e(){this.roleID=a.fromValue(0),this.sellHero=new nt}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<20||(this.roleID=e.getLong(),!this.sellHero.read(e)))},e.prototype.writeNoEnd=function(e){e.setLong(this.roleID),this.sellHero.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Fight_Sell_Hero_SYNC=st;var ct=function(){function e(){this.id=0,this.camp=0,this.hp=0}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();return!(e.getLen()-e.getPos()<t||(this.id=e.getString(t),e.getLen()-e.getPos()<8||(this.camp=e.getInt32(),this.hp=e.getInt32(),0)))},e.prototype.writeNoEnd=function(e){e.setString(this.id),e.setInt32(this.camp),e.setInt32(this.hp)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Monster_Struct=ct;var lt=function(){function e(){this.timeFrame=0,this.roleID=a.fromValue(0),this.monsterVec=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<16)return!1;this.timeFrame=e.getInt32(),this.roleID=e.getLong();var t=e.getUint32();this.monsterVec=[];for(var o=0;o<t;++o){var i=new ct;if(!i.read(e))return!1;this.monsterVec.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.timeFrame),e.setLong(this.roleID),e.setUint32(this.monsterVec.length),this.monsterVec.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Fight_Monster_SYNC=lt;var dt=function(){function e(){this.timeFrame=0,this.roleID=a.fromValue(0),this.monsterVec=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<16)return!1;this.timeFrame=e.getInt32(),this.roleID=e.getLong();var t=e.getUint32();this.monsterVec=[];for(var o=0;o<t;++o){var i=new ct;if(!i.read(e))return!1;this.monsterVec.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.timeFrame),e.setLong(this.roleID),e.setUint32(this.monsterVec.length),this.monsterVec.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Fight_Monster_SYNC=dt;var ut=function(){function e(){this.roleID=a.fromValue(0),this.heroAttrVec=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<12)return!1;this.roleID=e.getLong();var t=e.getUint32();this.heroAttrVec=[];for(var o=0;o<t;++o){var i=new Q;if(!i.read(e))return!1;this.heroAttrVec.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setLong(this.roleID),e.setUint32(this.heroAttrVec.length),this.heroAttrVec.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Fight_Hero_Attr_SYNC=ut;var ht=function(){function e(){this.roleID=a.fromValue(0),this.heroAttrVec=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<12)return!1;this.roleID=e.getLong();var t=e.getUint32();this.heroAttrVec=[];for(var o=0;o<t;++o){var i=new Q;if(!i.read(e))return!1;this.heroAttrVec.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setLong(this.roleID),e.setUint32(this.heroAttrVec.length),this.heroAttrVec.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Fight_Hero_Attr_SYNC=ht;var pt=function(){function e(){this.roleID=a.fromValue(0),this.refreshNum=0,this.cardIdVec=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<16)return!1;this.roleID=e.getLong(),this.refreshNum=e.getInt32();var t=e.getUint32();if(e.getLen()-e.getPos()<4*t)return!1;this.cardIdVec=[];for(var o=0;o<t;++o){var i;i=e.getInt32(),this.cardIdVec.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setLong(this.roleID),e.setInt32(this.refreshNum),e.setUint32(this.cardIdVec.length),this.cardIdVec.forEach(function(t){e.setInt32(t)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Fight_Refresh_Card_Count_SYNC=pt;var ft=function(){function e(){this.roleID=a.fromValue(0),this.refreshNum=0,this.cardIdVec=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<16)return!1;this.roleID=e.getLong(),this.refreshNum=e.getInt32();var t=e.getUint32();if(e.getLen()-e.getPos()<4*t)return!1;this.cardIdVec=[];for(var o=0;o<t;++o){var i;i=e.getInt32(),this.cardIdVec.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setLong(this.roleID),e.setInt32(this.refreshNum),e.setUint32(this.cardIdVec.length),this.cardIdVec.forEach(function(t){e.setInt32(t)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Fight_Refresh_Card_Count_SYNC=ft;var gt=function(){function e(){this.roleId=a.fromValue(0),this.operateType=0,this.carId=0,this.target=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<20||(this.roleId=e.getLong(),this.operateType=e.getInt32(),this.carId=e.getInt32(),this.target=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setLong(this.roleId),e.setInt32(this.operateType),e.setInt32(this.carId),e.setInt32(this.target)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Fight_Operate_Equip_SYNC=gt;var mt=function(){function e(){this.itemId=0,this.itemNum=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.itemId=e.getInt32(),this.itemNum=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.itemId),e.setInt32(this.itemNum)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.EquipItem=mt;var _t=function(){function e(){this.errorcode=0,this.operateType=0,this.carId=0,this.target=0,this.equipItems=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<20)return!1;this.errorcode=e.getInt32(),this.operateType=e.getInt32(),this.carId=e.getInt32(),this.target=e.getInt32();var t=e.getUint32();if(e.getLen()-e.getPos()<16*t)return!1;this.equipItems.clear();for(var o=0;o<t;++o){var i;i=e.getLong();var a=new mt;if(!a.read(e))return!1;this.equipItems.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setInt32(this.operateType),e.setInt32(this.carId),e.setInt32(this.target),e.setUint32(this.equipItems.size),this.equipItems.forEach(function(t,o){e.setLong(o),t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Fight_Operate_Equip_SYNC=_t;var yt=function(){function e(){this.timerType=0,this.param=""}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.timerType=e.getInt32();var t=e.getUint32();return!(e.getLen()-e.getPos()<t||(this.param=e.getString(t),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.timerType),e.setString(this.param)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Fight_Timer_Notice=yt;var vt=function(){function e(){this.roleId=a.fromValue(0),this.curIndex=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<12||(this.roleId=e.getLong(),this.curIndex=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setLong(this.roleId),e.setInt32(this.curIndex)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Fight_Key_Batch_Sync=vt;var Ct=function(){function e(){this.roleId=a.fromValue(0),this.curIndex=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<12||(this.roleId=e.getLong(),this.curIndex=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setLong(this.roleId),e.setInt32(this.curIndex)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Fight_Key_Batch_Sync=Ct;var St=function(){function e(){this.roleId=a.fromValue(0),this.buffType=0,this.buffId=0,this.buffDuration=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<20||(this.roleId=e.getLong(),this.buffType=e.getInt32(),this.buffId=e.getInt32(),this.buffDuration=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setLong(this.roleId),e.setInt32(this.buffType),e.setInt32(this.buffId),e.setInt32(this.buffDuration)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Fight_Add_Buff_SYNC=St;var Tt=function(){function e(){this.errorcode=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Fight_Add_Buff_SYNC=Tt;var It=function(){function e(){this.roleId=a.fromValue(0),this.buffType=0,this.buffId=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<16||(this.roleId=e.getLong(),this.buffType=e.getInt32(),this.buffId=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setLong(this.roleId),e.setInt32(this.buffType),e.setInt32(this.buffId)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Fight_Remove_Buff_SYNC=It;var Nt=function(){function e(){this.errorcode=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Fight_Remove_Buff_SYNC=Nt;var bt=function(){function e(){this.roleId=a.fromValue(0),this.buffType=0,this.buffId=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<16||(this.roleId=e.getLong(),this.buffType=e.getInt32(),this.buffId=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setLong(this.roleId),e.setInt32(this.buffType),e.setInt32(this.buffId)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Fight_Trigger_Buff_SYNC=bt,cc._RF.pop()},{"./BaseProtocols":"BaseProtocols",DataViewRW:"DataViewRW",ObjCollection:"ObjCollection",long:"long"}],FightReconnectLayer:[function(e,t,o){"use strict";cc._RF.push(t,"9c1e5AhUftJHJzSyt5LLGtr","FightReconnectLayer");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../combat/CombatManager"),s=e("../Global/GameGlobal"),c=e("../network/ClientNetwork"),l=e("../utils/ConstValue"),d=e("../utils/GamePlatform"),u=e("../utils/GameUtils"),h=e("../utils/subUtils/GuideLayer"),p=e("../utils/subUtils/PopLayer"),f=e("../utils/UIManager"),g=e("./FightNetwork"),m=e("../combat/FightResultView"),_=e("./protocol/FightProtocols"),y=e("../utils/TimeOffSetManager"),v=e("./ReconnectLayer"),C=cc._decorator,S=C.ccclass,T=C.property,I=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.m_countDown=null,t.failNum=0,t.reconnectTime=0,t.reconnectTimeOut=5,t.requestVersionTimeOut=3,t.tryCount=3,t}var o;return a(t,e),o=t,t.prototype.update=function(){if(!(this.reconnectTime<=0)&&y.TimeOffSetManager.getServerUTCSecond()-this.reconnectTime>this.reconnectTimeOut){if(this.failNum++,this.failNum>=this.tryCount)return this.reconnectTime=0,c.ClientNetwork.getInstance().Disconnect(),void o.CloseFightReconnectLayer();this.connectToFight()}},t.prototype.onLoad=function(){console.log("FightReconnnect  ReconnectLayer.onLoad");var e=this;g.FightNetwork.getInstance().listenProtocol(_.FIGHT_CLIENT_ENUM.P_Fight_Role_Login,function(e){console.log("FightReconnnect fightserver P_Fight_Role_Logintime"+y.TimeOffSetManager.getMilisecond()),e.resetPos();var t=new _.S_Fight_Role_Login;if(t.read(e)){var o=t.errorcode;if(g.FightNetwork.getInstance().setKey(t.key),0==o){var i=r.default.getInstance().getController();i&&i.battleStart()}}}.bind(this),this),g.FightNetwork.getInstance().listenProtocol(_.FIGHT_CLIENT_ENUM.P_Fight_Loading_Ready,function(t){console.log("FightReconnnect fightserver P_Fight_Role_Logintime"+y.TimeOffSetManager.getMilisecond()),t.resetPos();var o=new _.S_Fight_Loading_Ready;o.read(t)&&0==o.errorcode&&e.reconnectSuccess()}.bind(this),this),u.backgroundFitScreen(this.node.parent,this.node.parent.getChildByName("CCLayerColor")),this.connectToFight()},t.prototype.reconnectSuccess=function(){this.reconnectTime=0,o.CloseFightReconnectLayer()},t.prototype.onDestroy=function(){console.log("FightReconnnect  ReconnectLayer.onDestroy")},t.prototype.reconnectRequestServerList=function(){console.log("FightReconnnect  FightReconnectLayer.reconnectRequestServerList");var e="https://mszcs1.gameserver.iplay11g.com/gmsys/resVer.php?"+Math.random(),t=this;(function(){if(cc.isValid(t)){var o=new XMLHttpRequest;o.timeout=1e3*t.requestVersionTimeOut;var i=e;o.open("GET",i,!0),console.log("FightReconnnect state = "+o.readyState),o.send(),o.onload=function(){if(cc.isValid(t))try{var e=JSON.parse(o.response);t.onReconnectDealRequestServerList(e)}catch(i){console.log("JSON.parse(request.response) error")}},o.ontimeout=function(){cc.isValid(t)&&console.log("fightreconnect ontimeout")},o.onerror=function(){cc.isValid(t)&&console.log("fightreconnect onerror")},o.onabort=function(){cc.isValid(t)&&console.log("fightreconnect abort")}}})()},t.prototype.onReconnectDealRequestServerList=function(e){console.log("FightReconnnect  ReconnectLayer.onReconnectDealRequestServerList"),console.log("FightReconnnect data = "),console.log(e),e&&(console.log(e.gameVer),console.log(e.resVer)),e.length<=0||(d.GamePlatform.isWechat()?v.default.compareVer(e.gameVer)?wx.showModal({title:"\u6e29\u99a8\u63d0\u793a~",content:"\u68c0\u6d4b\u5230\u65b0\u7248\u672c\uff0c\u9000\u51fa\u540e\u8bf7\u91cd\u65b0\u8fdb\u5165\u5c0f\u6e38\u620f\u4f53\u9a8c~",showCancel:!1,confirmText:"\u786e\u5b9a\u9000\u51fa",success:function(e){e.confirm&&wx.exitMiniProgram()}}):g.FightNetwork.getInstance().Connect(o.fightUrl):d.GamePlatform.isQQMiniGame()&&v.default.compareVer(e.gameVer)?qq.showModal({title:"\u6e29\u99a8\u63d0\u793a~",content:"\u68c0\u6d4b\u5230\u65b0\u7248\u672c\uff0c\u9000\u51fa\u540e\u8bf7\u91cd\u65b0\u8fdb\u5165\u5c0f\u6e38\u620f\u4f53\u9a8c~",showCancel:!1,confirmText:"\u786e\u5b9a\u9000\u51fa",success:function(e){e.confirm&&qq.exitMiniProgram()}}):g.FightNetwork.getInstance().Connect(o.fightUrl))},t.prototype.connectToFight=function(){this.reconnectTime=y.TimeOffSetManager.getServerUTCSecond(),this.reconnectRequestServerList()},t.setFightUrl=function(e){o.fightUrl=e},t.ShowFightReconnectLayer=function(e,t,i){var a=this;if(void 0===e&&(e=0),void 0===t&&(t=!1),void 0===i&&(i=!1),!(v.default.reconnectLayerShowing||o.fightReconnectShowing||o.fight_game_back_ground||(console.log("FightReconnnect  ReconnectLayer.ShowFightReconnectLayer"),console.log(e),console.log(t),console.log(i),m.default._isShow))){s.G.UIManager.isFinghtingScene()&&(r.default.getInstance().gameState=l.Game_State.Reconnect),o.fightReconnectShowing=!0;var n=s.G.UIManager.getRunningScene(),c=new f.PopLayerParam;if(c.isLeftAnimation=!1,c.m_popType=p.POPLYAERSTATE.POPLYAERSTATE_OPER,c.isZoomAnimation=!0,n.getComponentInChildren(o)){var d=s.G.UIManager.getMask(f.PopNodeTag.FightReconnectLayer);d&&(d.active=!0)}else s.G.UIManager.showPopLayer(f.PrefabUrl.FightReconnectLayer,!0,!1,f.PopNodeTag.FightReconnectLayer,f.PopNodeType.Normal,c).then(function(e){if(console.log("FightReconnnect  ReconnectLayer.ShowReconnectLayer.showPopLayer"),e&&cc.isValid(a)&&cc.isValid(n)){var t=s.G.UIManager.getMask(f.PopNodeTag.FightReconnectLayer);t&&(t.active=!0)}}).catch(function(e){cc.error(e)}),s.G.StringManager.PopStringOnceEnd()}},t.CloseFightReconnectLayer=function(){o.fightReconnectShowing=!1,console.log("FightReconnnect  ReconnectLayer.CloseFightReconnectLayer"),s.G.UIManager.getRunningScene().getComponentInChildren(o)&&s.G.UIManager.popPopNode(f.PopNodeTag.FightReconnectLayer)},t.fightReconnectShowing=!1,t.fightUrl="",t.fight_game_back_ground=!1,t.fight_game_front_ground=!0,n([T(cc.Label)],t.prototype,"m_countDown",void 0),o=n([S],t)}(h.NodeNameLayer);o.default=I,cc._RF.pop()},{"../Global/GameGlobal":"GameGlobal","../combat/CombatManager":"CombatManager","../combat/FightResultView":"FightResultView","../network/ClientNetwork":"ClientNetwork","../utils/ConstValue":"ConstValue","../utils/GamePlatform":"GamePlatform","../utils/GameUtils":"GameUtils","../utils/TimeOffSetManager":"TimeOffSetManager","../utils/UIManager":"UIManager","../utils/subUtils/GuideLayer":"GuideLayer","../utils/subUtils/PopLayer":"PopLayer","./FightNetwork":"FightNetwork","./ReconnectLayer":"ReconnectLayer","./protocol/FightProtocols":"FightProtocols"}],FightResultView:[function(e,t,o){"use strict";cc._RF.push(t,"55884diDc1FhbxxyhGrfGKP","FightResultView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../Global/GameGlobal"),s=e("../network/protocol/RoleProtocols"),c=e("../network/protocol/TypeProtocols"),l=e("../utils/GameTools"),d=e("../utils/GameUtils"),u=e("../common/CombatModule"),h=e("./CombatManager"),p=e("../common/PlayerModule"),f=e("../modules/base/GameView"),g=e("../utils/LogUtil"),m=e("../JsonExportToCSV"),_=e("../utils/GamePlatform"),y=e("../StaticData/SoundTableData"),v=e("../utils/Tools"),C=e("../network/ClientNetwork"),S=e("../view/skyCastle/SkyCastleModule"),T=e("../utils/ConstValue"),I=e("../modules/manager/LoadResManager"),N=e("../network/ReconnectLayer"),b=e("../utils/WechatUtils"),w=e("../StaticData/TaskTableData"),E=e("../network/FightReconnectLayer"),P=e("../utils/ConfigUtils"),R=e("../utils/UIManager"),L=e("../view/battleDetails/BattleDetailsView"),A=e("../utils/ByteDanceMiniGameUtils"),D=e("../utils/ResourcesManager"),M=e("../StaticData/RobotNickNameTableData"),B=e("../StaticData/ActivityTableData"),k=e("../network/protocol/ActivityProtocols"),G=e("../common/CommandValue"),O=e("../utils/KSMinigameUtils"),H=e("../common/NetworkProtocolCommon"),V=e("../network/LocalMessage"),F=e("../view/activity/ActivityModule"),U=e("../view/sociaty/SociatyModel"),x=e("../view/anniversary/AnniversaryModule"),Y=e("../view/fogHidden/FogHiddenModel"),j=e("../view/machineryCityActivity/MachineryCityModel"),W=e("../view/machineryCityActivity/MachineryCityCtrl"),z=cc._decorator,K=z.ccclass,q=z.property,Q=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.playerName1=null,t.playerName2=null,t.playerData1=null,t.playerData11=null,t.playerData2=null,t.playerData22=null,t.playerhead1=null,t.playerhead2=null,t.playerWin1=null,t.playerWin2=null,t.RewardLayout=null,t.quitNode=null,t.playerReward1=null,t.playerReward2=null,t.playerseriesWinNode1=null,t.playerseriesWinNode2=null,t.reportNode=null,t.wudaohuiNode1=null,t.wudaohuiNode2=null,t.chickenDinnerTimerLab=null,t.playerPet1=null,t.playerPet2=null,t.sociatyFightNodeArr=[],t.NavigationRewardLayout=null,t.NavigationRankLab=null,t.isBehaviorRecord=!0,t._bGuide=!1,t._bWin=!1,t._reportName="",t._isGuard=!1,t._details={},t}var o;return a(t,e),o=t,t.prototype.onLoad=function(){this.playerWin1.node.active=!1,this.playerWin2.node.active=!1,this.reportNode.active=!1,d.backgroundFitScreen(this.node,this.node.getChildByName("bantou")),d.backgroundFitScreen(this.node,this.node.getChildByName("TipPopWindow").getChildByName("bantou")),this.node.setPosition(0,0),o._isShow=!0,this.node.getChildByName("node").active=!1,this.node.getChildByName("quit").active=!1,this.playerhead2.node.scaleX=-1},t.prototype.createShareBtn=function(){this.btn_share=new cc.Node,this.btn_share.anchorX=.5,this.btn_share.anchorX=.5,this.btn_share.x=this.node.getChildByName("detail").x+10,this.btn_share.y=this.node.getChildByName("detail").y+70,this.btn_share.addComponent(cc.Widget),this.btn_share.getComponent(cc.Widget).alignMode=cc.Widget.AlignMode.ON_WINDOW_RESIZE,this.btn_share.getComponent(cc.Widget).right=60,this.btn_share.getComponent(cc.Widget).isAlignRight=!0,this.btn_share.getComponent(cc.Widget).isAlignRight=!0,this.node.addChild(this.btn_share),this.btn_share.addComponent(cc.Button),this.btn_share.addComponent(cc.Sprite),D.default.loadSprite("ui/sociaty/image/sociaty_honganniuxiao",this.btn_share.getComponent(cc.Sprite));var e=new cc.Node;e.addComponent(cc.Label),e.getComponent(cc.Label).fontSize=26,e.getComponent(cc.Label).enableBold=!0,e.getComponent(cc.Label).string="\u5206\u4eab",e.addComponent(cc.LabelOutline),e.getComponent(cc.LabelOutline).color=cc.Color.BLACK,e.y=-7,this.btn_share.addChild(e),null!=this.btn_share&&(_.GamePlatform.isByteDanceMiniGame()?(this.btn_share.active=!0,this.btn_share.on("click",function(){A.default.getInstance().shareVideoRecording()})):_.GamePlatform.isKuaishouMiniGame()&&(this.btn_share.active=!0,this.btn_share.on("click",function(){O.KSMinigameUtils.getInstance().shareVideoRecording()})))},t.prototype.onEnable=function(){!0===this.isBehaviorRecord&&this.putBehaviorRecord()},t.prototype.onDestroy=function(){o._isShow=!1,_.GamePlatform.isWechat()&&b.WechatUtils.getInstance().m_wxShareVideoBtn&&b.WechatUtils.getInstance().m_wxShareVideoBtn.hide()},t.prototype.start=function(){var e=f.default.getViewByName("TipPopWindowView");e&&e.view&&e.view.closeView();var t=f.default.getViewByName("MatchMainView");t&&t.view&&t.view.closeView();var o=f.default.getViewByName("SociatyFightMatchView");o&&o.view&&o.view.closeView();var i=this.node.getChildByName("wxShare");i.active=!1,C.ClientNetwork.getInstance().listenLocalMessage(V.LOCAL_MESSAGE.LocalMsg_ShowGameRecorderBtn,function(){i.active=!0},this),this.onlistenProtocol(),_.GamePlatform.isByteDanceMiniGame()?(A.default.getInstance().stopVideoRecording(),this.createShareBtn()):_.GamePlatform.isKuaishouMiniGame()?(O.KSMinigameUtils.getInstance().stopVideoRecording(),this.createShareBtn()):_.GamePlatform.isWechat()&&b.WechatUtils.getInstance().m_isClickVideoRecord&&(b.WechatUtils.getInstance().stopVideoRecording(),this.scheduleOnce(function(){1!=i.active&&(i.active=!0)},2.5),l.default.registerTouchEvent(i,function(){b.WechatUtils.getInstance().onVideoShareBtnToGameClub()}),b.WechatUtils.getInstance().m_isClickVideoRecord=!1)},t.prototype.onlistenProtocol=function(){C.ClientNetwork.getInstance().listenProtocol(s.ROLE_CLIENT_ENUM.P_Role_Fight_Report,function(e){e.resetPos();var t=new s.S_Role_Fight_Report;t.read(e)&&(0===t.errorcode?r.G.StringManager.PopString(r.G.StringManager.getString("REPORT_SUCCESS")):3===t.errorcode?r.G.StringManager.PopString(r.G.StringManager.getString("REPORT_ERROR3")):4===t.errorcode&&r.G.StringManager.PopString(r.G.StringManager.getString("REPORT_ERROR4")))},this)},t.prototype.setData=function(e){var t=this;console.log("\u6218\u6597\u7ed3\u7b97   ",e);try{null!=this.playerPet1&&(this.playerPet1.active=!1),null!=this.playerPet2&&(this.playerPet2.active=!1);var o=this.node.getChildByName("jiesuan").getComponent(sp.Skeleton),i=this.node.getChildByName("heibingjiesuan"),a=this.node.getChildByName("jiesuan_hanghai"),n=this.node.getChildByName("tiankong_jiesuan"),s=this.node.getChildByName("zhounian_jiesuan"),g=this.node.getChildByName("fogHiddenjiesuan"),m=this.node.getChildByName("jiesuan_jixie");1==e.bWin||e.type==c.FIGHT_TYPE.FIGHT_TYPE_COOPERATION||e.type==c.FIGHT_TYPE.FIGHT_TYPE_BATTLE_GREAT_SAILING||e.type==c.FIGHT_TYPE.FIGHT_TYPE_WEEK_COOPERATION||e.type==c.FIGHT_TYPE.FIGHT_TYPE_MACHINARIUM?e.type==c.FIGHT_TYPE.FIGHT_TYPE_BATTLE_GREAT_SAILING?(this.node.getChildByName("jiesuan").active=!1,a&&(a.active=!0,a.getComponent(sp.Skeleton).setAnimation(0,"win",!1)),n&&(n.active=!1),i&&(i.active=!1),s&&(s.active=!1),g&&(g.active=!1),m&&(m.active=!1)):e.type==c.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE?(this.node.getChildByName("jiesuan").active=!1,n&&(n.active=!0,n.getComponent(sp.Skeleton).setAnimation(0,"win",!1)),i&&(i.active=!1),s&&(s.active=!1),g&&(g.active=!1),m&&(m.active=!1)):e.type==c.FIGHT_TYPE.FIGHT_TYPE_FOG_HIDDEN?(this.node.getChildByName("jiesuan").active=!1,n&&(n.active=!1),i&&(i.active=!1),s&&(s.active=!1),a&&(a.active=!1),g&&(g.active=!0,g.getComponent(sp.Skeleton).setAnimation(0,"win",!1)),m&&(m.active=!1)):e.type==c.FIGHT_TYPE.FIGHT_TYPE_WEEK_COOPERATION?(i&&i.getComponent(sp.Skeleton).setAnimation(0,"win",!1),i.active=!0,this.node.getChildByName("jiesuan").active=!1,n&&(n.active=!1),a&&(a.active=!1),s&&(s.active=!1),g&&(g.active=!1),m&&(m.active=!1)):e.type==c.FIGHT_TYPE.FIGHT_TYPE_MACHINARIUM?(this.node.getChildByName("jiesuan").active=!1,n&&(n.active=!1),a&&(a.active=!1),s&&(s.active=!1),g&&(g.active=!1),i&&(i.active=!1),m&&(m.active=!0,m.getComponent(sp.Skeleton).setAnimation(0,"win",!1))):e.type==c.FIGHT_TYPE.FIGHT_TYPE_ANNIVERSARY_TRIAL?(this.node.getChildByName("jiesuan").active=!1,a&&(a.active=!1),n&&(n.active=!1),i&&(i.active=!1),s&&(s.active=!0,s.getComponent(sp.Skeleton).setAnimation(0,"win",!1),this.node.getChildByName("shengliLab")&&(this.node.getChildByName("shengliLab").active=!1)),g&&(g.active=!1),m&&(m.active=!1)):(this.node.getChildByName("jiesuan").active=!0,o.setAnimation(0,"win",!1),a&&(a.active=!1),n&&(n.active=!1),i&&(i.active=!1),s&&(s.active=!1),g&&(g.active=!1),m&&(m.active=!1)):e.type==c.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE?(this.node.getChildByName("jiesuan").active=!1,a&&(a.active=!1),n&&(n.active=!0,n.getComponent(sp.Skeleton).setAnimation(0,"lose",!1)),i&&(i.active=!1),g&&(g.active=!1),m&&(m.active=!1)):e.type==c.FIGHT_TYPE.FIGHT_TYPE_WEEK_COOPERATION?(this.node.getChildByName("jiesuan").active=!1,a&&(a.active=!1),n&&(n.active=!1),i&&(i.active=!0,i.getComponent(sp.Skeleton).setAnimation(0,"lose",!1)),g&&(g.active=!1),m&&(m.active=!1)):e.type==c.FIGHT_TYPE.FIGHT_TYPE_MACHINARIUM?(this.node.getChildByName("jiesuan").active=!1,a&&(a.active=!1),n&&(n.active=!1),i&&(i.active=!1),g&&(g.active=!1),s&&(s.active=!1),m&&(m.active=!0,m.getComponent(sp.Skeleton).setAnimation(0,"lose",!1))):e.type==c.FIGHT_TYPE.FIGHT_TYPE_FOG_HIDDEN?(this.node.getChildByName("jiesuan").active=!1,a&&(a.active=!1),n&&(n.active=!1),i&&(i.active=!1),g&&(g.active=!0,g.getComponent(sp.Skeleton).setAnimation(0,"lose",!1)),m&&(m.active=!1)):e.type==c.FIGHT_TYPE.FIGHT_TYPE_ANNIVERSARY_TRIAL?(this.node.getChildByName("jiesuan").active=!1,a&&(a.active=!1),n&&(n.active=!1),i&&(i.active=!1),s&&(s.active=!0,s.getComponent(sp.Skeleton).setAnimation(0,"lose",!1)),g&&(g.active=!1),m&&(m.active=!1)):(o.setAnimation(0,"lose",!1),this.node.getChildByName("jiesuan").active=!0,a&&(a.active=!1),n&&(n.active=!1),i&&(i.active=!1),s&&(s.active=!1),g&&(g.active=!1),m&&(m.active=!1)),this.node.getChildByName("SkyNode")&&(this.node.getChildByName("SkyNode").active=!1),this.node.getChildByName("node").active=!0,this.scheduleOnce(function(){t.node.getChildByName("quit").active=!0,e.type==c.FIGHT_TYPE.FIGHT_TYPE_BATTLE_EAT_CHICKEN&&(t.node.getChildByName("quit").active=!1)},.5),h.default.getInstance().gameState=T.Game_State.End,h.default.getInstance().controller&&h.default.getInstance().controller.showResultUI(e.bWin),N.default.show()&&1==N.default.getReconnectReason()&&N.default.CloseReconnectLayer(),E.default.fightReconnectShowing&&E.default.CloseFightReconnectLayer()}catch(we){(oe=[])[0]="fightresultview Error",oe[1]=we.message,_.GamePlatform.reportWXLog(oe)}var C=this,b=e.bWin,w=e.type,R=0,L=0,A=0;this._combatType=w,this._details={win:b,type:w};try{if(b){var G=y.SoundTableData.getById(5).res;v.playAudioEffect(G)}else w==c.FIGHT_TYPE.FIGHT_TYPE_COOPERATION||w==c.FIGHT_TYPE.FIGHT_TYPE_WEEK_COOPERATION||w==c.FIGHT_TYPE.FIGHT_TYPE_MACHINARIUM?(G=y.SoundTableData.getById(5).res,v.playAudioEffect(G)):(G=y.SoundTableData.getById(6).res,v.playAudioEffect(G))}catch(we){(oe=[])[0]="fightresultview1 Error",oe[1]=we.message,_.GamePlatform.reportWXLog(oe)}this._bWin=b;var O=0,V=0,F=0,U=0,x=0,Y=0,j=0,W=0,z=0,K=0,q="",Q="",X=0,J=0,Z=0,$=0,ee=0,te=0;try{e.roles.forEach(function(e){if(e.roleAbstract.roleID.equals(p.default.UUID)){if(C.playerName1.string=e.roleAbstract.nickName,L=Number(e.totalHarm),R+=Number(e.totalHarm),ee=e.statisticInfo.carLevel?e.statisticInfo.carLevel:0,C._details.myName=e.roleAbstract.nickName,C._details.myTotalHarm=Number(e.statisticInfo.totalDamage),C._details.myTotalHeal=Number(e.statisticInfo.totalHeal),C._details.myMaxHarm=Number(e.statisticInfo.maxDamage),C._details.myMaxHarmHero=Number(e.statisticInfo.heroId),C._details.myTotalSp=Number(e.statisticInfo.cumulativeSp),C._details.myTotalRef=Number(e.statisticInfo.cumulativeRef),C._details.myTeam=e.statisticInfo.team,d.setRemoteHeadIcon(e.roleAbstract.headUrl,e.roleAbstract.headID,C.playerhead1),((a=e.roleAbstract.headFrameID)<=0||a>=2e3)&&(a=200),I.default.loadSpriteFrame("ui/headFrame/frame_"+a).then(function(e){C.playerhead1.node.getChildByName("headframe1").getComponent(cc.Sprite).spriteFrame=e}),O=e.roleAbstract.score,Z=e.roleAbstract.score,e.roleAbstract.fightType.forEach(function(e,t){1==t&&(F=e.seriesWinNum+1),t==c.FIGHT_TYPE.FIGHT_TYPE_BATTLE_GOLDENLEAGUE&&(x=e.winNum),t==c.FIGHT_TYPE.FIGHT_TYPE_BATTLE_SOCIATY_WAR&&(j=e.seriesWinNum+1,z=e.maxRound),t==c.FIGHT_TYPE.FIGHT_TYPE_ANNIVERSARY_TRIAL&&(X=e.seriesWinNum+1)}),1==e.isGuard){var t=new cc.Node;t.y-=170,t.parent=C.node;var o=t.addComponent(cc.Label),i=o.addComponent(cc.LabelOutline);o.fontSize=22,o.font=cc.resources.get("font/zsh",cc.Font),i.color=cc.Color.BLACK,i.width=2,o.string=r.G.StringManager.getString("BATTLE_ISGUARD"),C._isGuard=!0}q=e.roleAbstract.sociatyName?e.roleAbstract.sociatyName:""}else{var a;C.playerName2.string=e.roleAbstract.nickName,C._reportName=e.roleAbstract.nickName,C._reportId=e.roleAbstract.roleID,A=Number(e.totalHarm),R+=Number(e.totalHarm),te=e.statisticInfo.carLevel?e.statisticInfo.carLevel:0,C._details.otherName=e.roleAbstract.nickName,C._details.otherTotalHarm=Number(e.statisticInfo.totalDamage),C._details.otherTotalHeal=Number(e.statisticInfo.totalHeal),C._details.otherMaxHarm=Number(e.statisticInfo.maxDamage),C._details.otherMaxHarmHero=Number(e.statisticInfo.heroId),C._details.otherTotalSp=Number(e.statisticInfo.cumulativeSp),C._details.otherTotalRef=Number(e.statisticInfo.cumulativeRef),C._details.otherTeam=e.statisticInfo.team,d.setRemoteHeadIcon(e.roleAbstract.headUrl,e.roleAbstract.headID,C.playerhead2),((a=e.roleAbstract.headFrameID)<=0||a>=2e3)&&(a=200),I.default.loadSpriteFrame("ui/headFrame/frame_"+a).then(function(e){C.playerhead2.node.getChildByName("headframe2").getComponent(cc.Sprite).spriteFrame=e,C.playerhead2.node.getChildByName("headframe2").scaleX=-1}),V=e.roleAbstract.score,$=e.roleAbstract.score,e.roleAbstract.fightType.forEach(function(e,t){1==t&&(U=e.seriesWinNum+1),t==c.FIGHT_TYPE.FIGHT_TYPE_BATTLE_GOLDENLEAGUE&&(Y=e.winNum),t==c.FIGHT_TYPE.FIGHT_TYPE_BATTLE_SOCIATY_WAR&&(W=e.seriesWinNum+1,K=e.maxRound),t==c.FIGHT_TYPE.FIGHT_TYPE_ANNIVERSARY_TRIAL&&(J=e.seriesWinNum+1)}),1==e.isGuard&&(C._isGuard=!0),Q=e.roleAbstract.sociatyName?e.roleAbstract.sociatyName:""}})}catch(we){var oe;(oe=[])[0]="fightresultview2 Error",oe[1]=we.message,_.GamePlatform.reportWXLog(oe)}if(this.RewardLayout.node.removeAllChildren(),w==c.FIGHT_TYPE.FIGHT_TYPE_BATTLE_EAT_CHICKEN){this.playerReward1.active=!1,this.playerReward2.active=!1,this.playerseriesWinNode1.active=!1,this.playerseriesWinNode2.active=!1,this.playerWin1.node.active=!!b,this.playerWin2.node.active=!b,this.quitNode.active=!1;var ie=3;return this.chickenDinnerTimerLab.string=r.G.StringManager.getString("CHICKENDINNER_TIP14",ie),void this.schedule(function(){t.quitNode.active=!1,ie--,t.chickenDinnerTimerLab.string=r.G.StringManager.getString("CHICKENDINNER_TIP14",ie),ie<=0&&t.onBackToMainScene()},1,2,1)}if(w!=c.FIGHT_TYPE.FIGHT_TYPE_BATTLE_GOLDENLEAGUE){if(w==c.FIGHT_TYPE.FIGHT_TYPE_BATTLE||w==c.FIGHT_TYPE.FIGHT_TYPE_DUEL_BATTLE||w==c.FIGHT_TYPE.FIGHT_TYPE_BATTLE_EAT_CHICKEN||w==c.FIGHT_TYPE.FIGHT_TYPE_BATTLE_SOCIATY_WAR||w==c.FIGHT_TYPE.FIGHT_TYPE_ANNIVERSARY_TRIAL){if(this.playerWin1.node.active=!!b,this.playerWin2.node.active=!b,this.playerseriesWinNode1.active=!!b,this.playerseriesWinNode2.active=!!b,w==c.FIGHT_TYPE.FIGHT_TYPE_DUEL_BATTLE)return this.playerReward1.active=!1,this.playerReward2.active=!1,this.playerseriesWinNode1.active=!1,void(this.playerseriesWinNode2.active=!1);if(w==c.FIGHT_TYPE.FIGHT_TYPE_ANNIVERSARY_TRIAL){if(this.playerReward1.active=!1,this.playerReward2.active=!1,this.playerReward1.parent.getChildByName("AnniversaryNode").active=!0,this.playerReward2.parent.getChildByName("AnniversaryNode").active=!0,b){this.playerReward1.parent.getChildByName("AnniversaryNode").children[1].getComponent(cc.Label).string=String(Z);var ae=this.getAnniversaryBattleScore(e.battle.get(0).winner.prize);ae+=this.getAnniversaryBattleScore(e.battle.get(0).winner.encouragePrize),ae+=this.getAnniversaryBattleScore(e.battle.get(0).winner.seriesWinPrize),this.playerReward1.parent.getChildByName("AnniversaryNode").children[2].getComponent(cc.Label).string="+"+String(ae),this.playerReward2.parent.getChildByName("AnniversaryNode").children[1].getComponent(cc.Label).string=String($),ae=this.getAnniversaryBattleScore(e.battle.get(0).loster.lostDec),this.playerReward2.parent.getChildByName("AnniversaryNode").children[2].getComponent(cc.Label).string="-"+String(ae),X>1?this.playerseriesWinNode1.children[0].getComponent(cc.Label).string=X+" \u8fde\u80dc":this.playerseriesWinNode1.active=!1,J-1>1?(this.playerseriesWinNode2.children[0].getComponent(cc.Label).string=J-1+"\u8fde\u80dc",this.playerseriesWinNode2.children[1].getComponent(cc.Label).string="\u7ec8\u7ed3"):this.playerseriesWinNode2.active=!1,this.setRewards(e.battle.get(0).winner.prize,this.RewardLayout),this.setRewards(e.battle.get(0).winner.encouragePrize,this.RewardLayout),this.setRewards(e.battle.get(0).winner.seriesWinPrize,this.RewardLayout)}else this.playerReward1.parent.getChildByName("AnniversaryNode").children[1].getComponent(cc.Label).string=String(Z),ae=this.getAnniversaryBattleScore(e.battle.get(0).loster.lostDec),this.playerReward1.parent.getChildByName("AnniversaryNode").children[2].getComponent(cc.Label).string="-"+String(ae),this.playerReward2.parent.getChildByName("AnniversaryNode").children[1].getComponent(cc.Label).string=String($),ae=this.getAnniversaryBattleScore(e.battle.get(0).winner.prize),ae+=this.getAnniversaryBattleScore(e.battle.get(0).winner.encouragePrize),ae+=this.getAnniversaryBattleScore(e.battle.get(0).winner.seriesWinPrize),this.playerReward2.parent.getChildByName("AnniversaryNode").children[2].getComponent(cc.Label).string="+"+String(ae),this.setRewards(e.battle.get(0).loster.lostPrize,this.RewardLayout),J>1?this.playerseriesWinNode2.children[0].getComponent(cc.Label).string=J+" \u8fde\u80dc":this.playerseriesWinNode2.active=!1;return}if(w==c.FIGHT_TYPE.FIGHT_TYPE_BATTLE_SOCIATY_WAR){this.playerseriesWinNode1.active=!1,this.playerseriesWinNode2.active=!1,this.playerReward1.active=!1,this.playerReward2.active=!1,this.playerPet1.parent.active=!1,this.playerPet2.parent.active=!1,this.sociatyFightNodeArr.forEach(function(e){e.active=!0});var ne=B.ActivityTableData.getById(k.ACTIVITY_ID_ENUM.P_Activity_SociatyWar),re=p.default.getServersTime(),se=ne.param5.toString().slice(0,-2),ce=ne.param5.toString().slice(-2),le=new Date(1e3*re),de=le.getDate(),ue=le.getFullYear()+"-"+(le.getMonth()+1)+"-"+de+" "+se+":"+ce+":00";if(re>l.default.timeToTimestamp(ue)&&r.G.StringManager.PopWorldString("sociaty_war_tip5"),this.sociatyFightNodeArr[0].children[4].children[0].getComponent(cc.Label).string=q,Q.length<=0){var he=l.default.getRandomInt(10,M.RobotNickNameTableData.getDataMap().size-1);Q=M.RobotNickNameTableData.getDataMap().get(he).nickName}if(this.sociatyFightNodeArr[1].children[4].children[0].getComponent(cc.Label).string=Q,(z=(z=p.default.getRoleAttrValByKey(c.ROLE_ATTR_VALUES.ROLE_ATTR_SOCIATY_WAR_SCORE))||0)<0&&(z=0),this.sociatyFightNodeArr[0].children[1].getComponent(cc.Label).string=z.toString(),this.sociatyFightNodeArr[1].children[1].getComponent(cc.Label).string=K.toString(),1==b){j>1?(this.sociatyFightNodeArr[0].children[3].children[0].getComponent(cc.Label).string=j+" \u8fde\u80dc",this.sociatyFightNodeArr[0].children[3].active=!0):this.sociatyFightNodeArr[0].children[3].active=!1,W-1>1?(this.sociatyFightNodeArr[1].children[3].active=!0,this.sociatyFightNodeArr[1].children[3].children[0].getComponent(cc.Label).string="\u7ec8\u7ed3"+(W-1)+"\u8fde\u80dc"):this.sociatyFightNodeArr[1].children[3].active=!1,this.sociatyFightNodeArr[1].children[2].getComponent(cc.Label).string="",fe=(fe=(j-1)*Number(d.getConfigIntValue("sociatywar_continuouwin_add_score")))>Number(d.getConfigIntValue("sociatywar_continuouswin_max_score"))?Number(d.getConfigIntValue("sociatywar_continuouswin_max_score")):fe;var pe=Number(d.getConfigIntValue("sociatywar_win_score"))+fe;this.sociatyFightNodeArr[0].children[2].getComponent(cc.Label).string="+ "+pe,re<l.default.timeToTimestamp(ue)?this.sociatyFightNodeArr[0].children[1].getComponent(cc.Label).string=(z-pe).toString():this.sociatyFightNodeArr[0].children[2].getComponent(cc.Label).string=""}else{var fe;W>1?(this.sociatyFightNodeArr[1].children[3].active=!0,this.sociatyFightNodeArr[1].children[3].children[0].getComponent(cc.Label).string=W+" \u8fde\u80dc"):this.sociatyFightNodeArr[1].children[3].active=!1,this.sociatyFightNodeArr[0].children[3].active=!1,this.sociatyFightNodeArr[0].children[2].getComponent(cc.Label).string="",fe=(fe=(W-1)*Number(d.getConfigIntValue("sociatywar_continuouwin_add_score")))>Number(d.getConfigIntValue("sociatywar_continuouswin_max_score"))?Number(d.getConfigIntValue("sociatywar_continuouswin_max_score")):fe,pe=Number(d.getConfigIntValue("sociatywar_win_score"))+fe,this.sociatyFightNodeArr[1].children[2].getComponent(cc.Label).string="+ "+pe}return}var ge,me;if(b)C.playerData1.string=String(O),ae=this.getBattleScore(e.battle.get(0).winner.prize),ae+=this.getBattleScore(e.battle.get(0).winner.encouragePrize),ae+=this.getBattleScore(e.battle.get(0).winner.seriesWinPrize),C.playerData11.string="+"+String(ae),C.playerData2.string=String(V),ae=this.getBattleScore(e.battle.get(0).loster.lostDec),C.playerData22.string="-"+String(ae),this.setRewards(e.battle.get(0).winner.prize,this.RewardLayout),this.setRewards(e.battle.get(0).winner.encouragePrize,this.RewardLayout),this.setRewards(e.battle.get(0).winner.seriesWinPrize,this.RewardLayout),F>1?this.playerseriesWinNode1.children[0].getComponent(cc.Label).string=F+" \u8fde\u80dc":this.playerseriesWinNode1.active=!1,U-1>1?(this.playerseriesWinNode2.children[0].getComponent(cc.Label).string=U-1+"\u8fde\u80dc",this.playerseriesWinNode2.children[1].getComponent(cc.Label).string="\u7ec8\u7ed3"):this.playerseriesWinNode2.active=!1,w==c.FIGHT_TYPE.FIGHT_TYPE_BATTLE&&(ge=u.default.getPetId(!0))>100&&(me=P.default.getInstance().getItemByID(ge))&&me.type==c.TYPE_ITEM.TYPE_ITEM_PET&&(this.playerPet1.active=!0);else C.playerData1.string=String(O),ae=this.getBattleScore(e.battle.get(0).loster.lostDec),C.playerData11.string="-"+String(ae),this._losterScore=ae,C.playerData2.string=String(V),ae=this.getBattleScore(e.battle.get(0).winner.prize),ae+=this.getBattleScore(e.battle.get(0).winner.encouragePrize),ae+=this.getBattleScore(e.battle.get(0).winner.seriesWinPrize),C.playerData22.string="+"+String(ae),this.setRewards(e.battle.get(0).loster.lostDec,this.RewardLayout),U>1&&!d.checkPvPOverLimit()?this.playerseriesWinNode2.children[0].getComponent(cc.Label).string=U+" \u8fde\u80dc":this.playerseriesWinNode2.active=!1,w==c.FIGHT_TYPE.FIGHT_TYPE_BATTLE&&(ge=u.default.getPetId(!1))>100&&(me=P.default.getInstance().getItemByID(ge))&&me.type==c.TYPE_ITEM.TYPE_ITEM_PET&&(this.playerPet2.active=!0)}else if(w==c.FIGHT_TYPE.FIGHT_TYPE_COOPERATION||w==c.FIGHT_TYPE.FIGHT_TYPE_BATTLE_GREAT_SAILING||w==c.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE||w==c.FIGHT_TYPE.FIGHT_TYPE_WEEK_COOPERATION||w==c.FIGHT_TYPE.FIGHT_TYPE_FOG_HIDDEN||w==c.FIGHT_TYPE.FIGHT_TYPE_MACHINARIUM){if(w==c.FIGHT_TYPE.FIGHT_TYPE_COOPERATION||w==c.FIGHT_TYPE.FIGHT_TYPE_WEEK_COOPERATION||w==c.FIGHT_TYPE.FIGHT_TYPE_MACHINARIUM){if((Ne=this.node.getChildByName("wave").getComponent(cc.Label)).string=String(e.round),this.playerData1.string=String(Math.ceil(L/R*100))+"%",this.playerData2.string=String(Math.floor(A/R*100))+"%",0===R&&(this.playerData1.string="0%",this.playerData2.string="0%"),this.setRewards(e.coopration.get(0).prize,this.RewardLayout),this.setRewards(e.coopration.get(0).extraprize,this.RewardLayout),w==c.FIGHT_TYPE.FIGHT_TYPE_MACHINARIUM&&(this.node.getChildByName("node").children[0].y-=30),w==c.FIGHT_TYPE.FIGHT_TYPE_COOPERATION&&e.coopration.get(0).prize.length<=0&&e.coopration.get(0).extraprize.length<=0&&0==this._isGuard){(Te=new cc.Node).y-=170,Te.parent=this.node;var _e=(Ie=Te.addComponent(cc.Label)).addComponent(cc.LabelOutline);Ie.fontSize=22,Ie.font=cc.resources.get("font/zsh",cc.Font),_e.color=cc.Color.BLACK,_e.width=2,Ie.string="\u6bcf\u65e5\u52a9\u6218"+d.getConfigIntValue("cooperation_help_day_max_count")+"\u6b21\u540e\u65e0\u6cd5\u83b7\u5f97\u5956\u52b1!"}}else if(w==c.FIGHT_TYPE.FIGHT_TYPE_BATTLE_GREAT_SAILING)this.NavigationRewardLayout.node.parent.active=!0,this.node.getChildByName("node").active=!1,this.node.getChildByName("detail").active=!1,this.node.getChildByName("repot")&&(this.node.getChildByName("repot").active=!1),(Ne=this.node.getChildByName("wave").getComponent(cc.Label)).string=String(e.round),e.coopration.get(0)&&(e.coopration.get(0).prize&&this.setRewards(e.coopration.get(0).prize,this.NavigationRewardLayout),e.coopration.get(0).extraprize&&this.setRewards(e.coopration.get(0).extraprize,this.NavigationRewardLayout));else if(w==c.FIGHT_TYPE.FIGHT_TYPE_FOG_HIDDEN){this.node.getChildByName("node").children.forEach(function(e){e.active=!1}),(Ne=this.node.getChildByName("wave").getComponent(cc.Label)).string="",0==b?(this.node.getChildByName("fogHiddenNode").active=!1,this.RewardLayout.node.y=-120):this.node.getChildByName("fogHiddenNode").active=!0,this.node.getChildByName("fogHiddenNode").getComponent(cc.Label).string=r.G.StringManager.getString("FOG_HIDDEN_ACTIVITY_TIPS5"),this.RewardLayout.node.active=!0,this.setRewards(e.coopration.get(0).prize,this.RewardLayout),this.setRewards(e.coopration.get(0).extraprize,this.RewardLayout);var ye=ee,ve=te;switch(Math.max(ye,ve)){case 1:case 2:D.default.loadSprite("ui/star/0",this.node.getChildByName("fogHiddenNode").children[0].getComponent(cc.Sprite));break;case 3:D.default.loadSprite("ui/star/4",this.node.getChildByName("fogHiddenNode").children[0].getComponent(cc.Sprite));break;case 4:D.default.loadSprite("ui/star/3",this.node.getChildByName("fogHiddenNode").children[0].getComponent(cc.Sprite));break;case 5:D.default.loadSprite("ui/star/2",this.node.getChildByName("fogHiddenNode").children[0].getComponent(cc.Sprite));break;case 6:D.default.loadSprite("ui/star/1",this.node.getChildByName("fogHiddenNode").children[0].getComponent(cc.Sprite))}}else if(w==c.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE){this.node.getChildByName("node").active=!1,this.node.getChildByName("shengliLab")&&(this.node.getChildByName("shengliLab").active=!1),this.node.getChildByName("repot")&&(this.node.getChildByName("repot").active=!1);var Ce=this.node.getChildByName("SkyNode");if(Ce){Ce.active=!0,S.default.Instance.getCurCastleSkyType();var Se=Ce.getChildByName("roundNode");Se&&(Se.children.forEach(function(e){e.active=!1}),Se.children[e.round-1].active=!0,console.log(e.extraData,e.round)),e.coopration.size>0&&(e.coopration.get(0).prize&&this.setRewards(e.coopration.get(0).prize,Ce.children[1].getComponent(cc.Layout)),e.coopration.get(0).extraprize&&this.setRewards(e.coopration.get(0).extraprize,Ce.children[1].getComponent(cc.Layout)))}}var Te,Ie;if(1==this._isGuard)(Te=new cc.Node).y-=170,Te.parent=C.node,_e=(Ie=Te.addComponent(cc.Label)).addComponent(cc.LabelOutline),Ie.fontSize=22,Ie.font=cc.resources.get("font/zsh",cc.Font),_e.color=cc.Color.BLACK,_e.width=2,Ie.string=r.G.StringManager.getString("BATTLE_ISGUARD"),C._isGuard=!0}if(e.roles.size<=0){var Ne,be=this.node.getChildByName("wave");be.y=0,(Ne=be.getComponent(cc.Label)).fontSize=20,Ne.string=r.G.StringManager.getString("BATTLE_ISEXCEPTION"),this.node.getChildByName("node").active=!1,this.node.getChildByName("detail").active=!1}try{this.onStatisticsLiveData(e)}catch(we){H.default.callRoleClientLog(p.default.UUID.toString()+" onStatisticsLiveData Wrong")}}else this.playerReward1.active=!1,this.playerReward2.active=!1,this.playerseriesWinNode1.active=!1,this.playerseriesWinNode2.active=!1,this.wudaohuiNode1.active=!0,this.wudaohuiNode2.active=!0,b?(this.wudaohuiNode1.children[1].active=!0,this.wudaohuiNode2.children[1].active=!1):(this.wudaohuiNode1.children[1].active=!1,this.wudaohuiNode2.children[1].active=!0),this.wudaohuiNode1.children[0].getComponent(cc.Label).string=x.toString(),this.wudaohuiNode2.children[0].getComponent(cc.Label).string=Y.toString(),f.default.getViewByName("MainSceneView")||u.default.wudaohuiEndTime>0&&p.default.getServersTime()>u.default.wudaohuiEndTime&&r.G.StringManager.PopString(r.G.StringManager.getString("WUDAOHUI_TIP3"))},t.prototype.onBackToMainScene=function(){var e=this;h.default.getInstance().gameState=T.Game_State.End,p.default.setFightReconnectData(null),u.default.matchReconnectData=null,u.default.destroy();try{h.default.getInstance().exitMap()}catch(a){var t=[];t[0]="exitMap Error",t[1]=a.message,_.GamePlatform.reportWXLog(t)}if(p.default.setFightBalanceData(null),this._bGuide)r.G.UIManager.gotoMainScene(null,function(){f.default.addLayerView("BaseCtrl","MainSceneView","MainSceneView")});else{var i=f.default.getViewByName("MainSceneView");if(i&&i.view)return this.node.removeFromParent(),void(o._isShow=!1);r.G.UIManager.gotoMainScene(null,function(){o._isShow=!1,f.default.addLayerView("BaseCtrl","MainSceneView","MainSceneView",null,null,function(){if(d.setTouchEnabled(!1),e._combatType==c.FIGHT_TYPE.FIGHT_TYPE_BATTLE)e.scheduleOnce(function(){f.default.addPopView("BaseCtrl","DetainmentView","DetainmentView",{bWin:e._bWin,losterScore:e._losterScore},null,function(){d.setTouchEnabled(!0)})});else if(e._combatType==c.FIGHT_TYPE.FIGHT_TYPE_BATTLE_GOLDENLEAGUE)e.scheduleOnce(function(){f.default.addPopView("BaseCtrl","ActivityMainView","ActivityMainView",null,null,function(){d.setTouchEnabled(!0),f.default.addPopView("BaseCtrl","ActivityGoldenLeagueView","ActivityGoldenLeagueView")})});else if(e._combatType==c.FIGHT_TYPE.FIGHT_TYPE_BATTLE_EAT_CHICKEN)1==p.default.checkModulerOnOffState(G.ModulerViewOnOff.ChickenDinnerView)?f.default.addPopView("BaseCtrl","ActivityMainView","ActivityMainView",null,null,function(){d.setTouchEnabled(!0),f.default.addPopView("BaseCtrl","ChickenDinnerMainView","ChickenDinnerMainView")}):f.default.addPopView("BaseCtrl","ActivityMainView","ActivityMainView");else if(e._combatType==c.FIGHT_TYPE.FIGHT_TYPE_BATTLE_SOCIATY_WAR)e.scheduleOnce(function(){f.default.addPopView("BaseCtrl","SociatyMainView","SociatyMainView",{selectTabIdx:4},null,function(){d.setTouchEnabled(!0)})});else if(e._combatType==c.FIGHT_TYPE.FIGHT_TYPE_BATTLE_GREAT_SAILING)e.scheduleOnce(function(){1==p.default.checkModulerOnOffState(G.ModulerViewOnOff.NavigationView)?f.default.addPopView("BaseCtrl","NavigationMainView","NavigationMainView",null,null,function(){d.setTouchEnabled(!0)}):f.default.addPopView("BaseCtrl","ActivityMainView","ActivityMainView",null,null,function(){d.setTouchEnabled(!0)})});else if(e._combatType==c.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE)e.scheduleOnce(function(){1==S.default.Instance.checkSkyCastleOpenState()?f.default.addPopView("BaseCtrl","SkyCastleArenaView","SkyCastleArenaView",null,null,function(){d.setTouchEnabled(!0)}):d.setTouchEnabled(!0)});else if(e._combatType==c.FIGHT_TYPE.FIGHT_TYPE_WEEK_COOPERATION)e.scheduleOnce(function(){1==F.default.getWeekCooperationIsOpen()?f.default.addPopView("BaseCtrl","WeekCooperationReliveMainView","WeekCooperationReliveMainView",null,null,function(){d.setTouchEnabled(!0)}):d.setTouchEnabled(!0)});else if(e._combatType==c.FIGHT_TYPE.FIGHT_TYPE_FOG_HIDDEN)1==Y.default.Instance.checkFogHiddenOpenState()&&1==p.default.checkModulerOnOffState(G.ModulerViewOnOff.FogHidden)?f.default.addPopView("BaseCtrl","FogHiddenMainView","FogHiddenMainView",null,null,function(){d.setTouchEnabled(!0)}):d.setTouchEnabled(!0);else if(e._combatType==c.FIGHT_TYPE.FIGHT_TYPE_MACHINARIUM)if(1==j.default.Instance.getMachineryCityIsOpen()){var t=U.default.instance().SociatyPlayerData;t.sociatyID.length<=0||0==Number(t.sociatyID)?d.setTouchEnabled(!0):(W.default.callSociatyRoleGetMachinariumData(),d.setTouchEnabled(!0))}else d.setTouchEnabled(!0);else e._combatType==c.FIGHT_TYPE.FIGHT_TYPE_ANNIVERSARY_TRIAL?e.scheduleOnce(function(){1==x.default.Instance.checkAnniversaryOpenState()?f.default.addPopView("BaseCtrl","AnniversaryMainView","AnniversaryMainView",null,null,function(){d.setTouchEnabled(!0)}):(d.setTouchEnabled(!0),r.G.StringManager.PopString("\u5468\u5e74\u5e86\u6d3b\u52a8\u5df2\u7ed3\u675f\uff01"))}):d.setTouchEnabled(!0)})})}},t.prototype.onReportOthers=function(){this.reportNode.setSiblingIndex(this.node.childrenCount+9),this.reportNode.active=!0},t.prototype.cancelReportOthers=function(){this.reportNode.active=!1},t.prototype.confirmReportOthers=function(){var e=new s.C_Role_Fight_Report;e.roleid=this._reportId,e.nickname=this._reportName,e.fighttype=this._combatType,e.fightTime=0,this.node.getChildByName("repot").getComponent(cc.Button).interactable=!1,this.node.getChildByName("repot").getComponent(cc.Button).enableAutoGrayEffect=!0,this.reportNode.active=!1;var t=u.default.getMatchBattleInfo(!1);t&&1==t.bRobot?r.G.StringManager.PopString(r.G.StringManager.getString("REPORT_SUCCESS")):C.ClientNetwork.getInstance().Send(s.ROLE_CLIENT_ENUM.P_Role_Fight_Report,e)},t.prototype.onShowBattleDetails=function(){var e=this;r.G.UIManager.showPopLayer(R.PrefabUrl.BattleDetails,!0,!0,R.PopNodeTag.BattleDetails,R.PopNodeType.FullScreen,null).then(function(t){if(t&&cc.isValid(e)){var o=t.getComponent(L.default);o&&o.setData(e._details)}}).catch(function(e){cc.error(e)})},t.prototype.setPlayerInfo=function(){},t.prototype.setRewards=function(e,t){if(1!=this._isGuard)for(var o in e){var i=e[o];1004==i.dropID||i.dropNum<=0||1021==i.dropID||l.default.createNormalItems(i.dropID,i.dropNum,t.node,function(e){e.getChildByName("gailv").active=!1})}},t.prototype.getBattleScore=function(e){var t=0;for(var o in e){var i=e[o];1004==i.dropID&&(console.log("FightResultView, getBattleScore, \u5956\u52b1\u676f\u6570="+i.dropNum),t+=i.dropNum)}return t},t.prototype.getAnniversaryBattleScore=function(e){var t=0;for(var o in e){var i=e[o];1021==i.dropID&&(t+=i.dropNum)}return t},t.prototype.putBehaviorRecord=function(){var e;if((e=h.default.getInstance().getPlayerModelByCamp(T.PLAYER_CAMP.myPlayer)).behaviorRecord&&e.behaviorRecord.length>0){var t=JSON.stringify(e.behaviorRecord);if(g.default.info(t),_.GamePlatform.isAndroid()||_.GamePlatform.isIOS())return;m.JSonToCSV.setDataConver({data:e.behaviorRecord,fileName:"downloadFile",columns:{title:["\u6b65\u9aa4","\u95f4\u9694\uff08\u6beb\u79d2\uff09","\u6218\u8f66\u7b49\u7ea7","\u82f1\u96c4\u4fe1\u606f","\u5237\u65b0\u6b21\u6570"],key:["index","time","carLevel","heroInfo","refresh"]}})}},t.prototype.saveForBrowser=function(e,t){if(cc.sys.isBrowser){g.default.log("\u6d4f\u89c8\u5668");var o=new Blob([e],{type:"application/json"}),i=document.createElement("a");i.download=t,i.innerHTML="Download File",null!=window.webkitURL?i.href=window.webkitURL.createObjectURL(o):(i.href=window.URL.createObjectURL(o),i.style.display="none",document.body.appendChild(i)),i.click()}},t.prototype.sendToServer=function(e){var t=new XMLHttpRequest,o=r.G.StringManager.getString("AI_URL");t.open("POST",o,!0),t.send("aidata="+e)},t.prototype.onDoubleRewardsCallBack=function(){u.default.destroy(),h.default.getInstance().exitMap(),r.G.UIManager.gotoMainScene(null,function(){f.default.addLayerView("BaseCtrl","MainSceneView","MainSceneView",null,null,function(){var e=new s.C_Role_GetPVPDoubleReward;C.ClientNetwork.getInstance().Send(s.ROLE_CLIENT_ENUM.P_Role_GetPVPDoubleReward,e)})})},t.prototype.findTask=function(){var e=[];return Array.from(p.default.getRoleTaskData().tasks.values()).forEach(function(t){w.TaskTableData.getById(t.taskID).type==c.TASK_TYPE.TASK_TYPE_COUNT_CLIENT&&e.push(t)}),e},t.prototype.onStatisticsLiveData=function(e){if(_.GamePlatform.isWechat()){var t=[],o=this.findTask();if(b.WechatUtils.getInstance().wxGetGameLiveState()){if(e.type==c.FIGHT_TYPE.FIGHT_TYPE_BATTLE){if(e.bWin){var i=[];o.forEach(function(e){var t=w.TaskTableData.getById(e.taskID);t.clientType==c.TASK_CLIENT_TYPE.TASK_CLIENT_TYPE_ACHIEVEMENT_BATTLE_WIN&&i.push({taskId:t.id,taskCount:e.taskCount})}),i.forEach(function(e){e.taskCount=e.taskCount+1}),i.forEach(function(e){t.push(e)})}var a=[];o.forEach(function(e){var t=w.TaskTableData.getById(e.taskID);t.clientType==c.TASK_CLIENT_TYPE.TASK_CLIENT_TYPE_ACHIEVEMENT_BATTLE&&a.push({taskId:t.id,taskCount:e.taskCount})}),a.forEach(function(e){e.taskCount=e.taskCount+1}),a.forEach(function(e){t.push(e)})}else if(e.type==c.FIGHT_TYPE.FIGHT_TYPE_COOPERATION){var n=[];o.forEach(function(e){var t=w.TaskTableData.getById(e.taskID);t.clientType==c.TASK_CLIENT_TYPE.TASK_CLIENT_TYPE_ACHIEVEMENT_COOP_TOTAL&&n.push({taskId:t.id,taskCount:e.taskCount})}),n.forEach(function(t){t.taskCount=t.taskCount+e.round}),n.forEach(function(e){t.push(e)});var r=[];o.forEach(function(e){var t=w.TaskTableData.getById(e.taskID);t.clientType==c.TASK_CLIENT_TYPE.TASK_CLIENT_TYPE_ACHIEVEMENT_COOP_MAX&&r.push({taskId:t.id,taskCount:e.taskCount})}),r.forEach(function(t){e.round>t.taskCount&&(t.taskCount=e.round)}),r.forEach(function(e){t.push(e)})}for(var l=0;l<t.length;l++){var d=new s.C_Role_ClientTaskUpdateCount;d.taskID=t[l].taskId,d.count=t[l].taskCount,C.ClientNetwork.getInstance().Send(s.ROLE_CLIENT_ENUM.P_Role_ClientTaskUpdateCount,d,!1)}}}},t._isShow=!1,n([q(cc.Label)],t.prototype,"playerName1",void 0),n([q(cc.Label)],t.prototype,"playerName2",void 0),n([q(cc.Label)],t.prototype,"playerData1",void 0),n([q(cc.Label)],t.prototype,"playerData11",void 0),n([q(cc.Label)],t.prototype,"playerData2",void 0),n([q(cc.Label)],t.prototype,"playerData22",void 0),n([q(cc.Sprite)],t.prototype,"playerhead1",void 0),n([q(cc.Sprite)],t.prototype,"playerhead2",void 0),n([q(cc.Sprite)],t.prototype,"playerWin1",void 0),n([q(cc.Sprite)],t.prototype,"playerWin2",void 0),n([q(cc.Layout)],t.prototype,"RewardLayout",void 0),n([q(cc.Node)],t.prototype,"quitNode",void 0),n([q(cc.Node)],t.prototype,"playerReward1",void 0),n([q(cc.Node)],t.prototype,"playerReward2",void 0),n([q(cc.Node)],t.prototype,"playerseriesWinNode1",void 0),n([q(cc.Node)],t.prototype,"playerseriesWinNode2",void 0),n([q(cc.Node)],t.prototype,"reportNode",void 0),n([q(cc.Node)],t.prototype,"wudaohuiNode1",void 0),n([q(cc.Node)],t.prototype,"wudaohuiNode2",void 0),n([q(cc.Label)],t.prototype,"chickenDinnerTimerLab",void 0),n([q(cc.Node)],t.prototype,"playerPet1",void 0),n([q(cc.Node)],t.prototype,"playerPet2",void 0),n([q(cc.Node)],t.prototype,"sociatyFightNodeArr",void 0),n([q(cc.Layout)],t.prototype,"NavigationRewardLayout",void 0),n([q(cc.Label)],t.prototype,"NavigationRankLab",void 0),n([q({displayName:"\u4e0b\u8f7dAI\u884c\u4e3a\u6587\u4ef6"})],t.prototype,"isBehaviorRecord",void 0),o=n([K],t)}(cc.Component);o.default=Q,cc._RF.pop()},{"../Global/GameGlobal":"GameGlobal","../JsonExportToCSV":"JsonExportToCSV","../StaticData/ActivityTableData":"ActivityTableData","../StaticData/RobotNickNameTableData":"RobotNickNameTableData","../StaticData/SoundTableData":"SoundTableData","../StaticData/TaskTableData":"TaskTableData","../common/CombatModule":"CombatModule","../common/CommandValue":"CommandValue","../common/NetworkProtocolCommon":"NetworkProtocolCommon","../common/PlayerModule":"PlayerModule","../modules/base/GameView":"GameView","../modules/manager/LoadResManager":"LoadResManager","../network/ClientNetwork":"ClientNetwork","../network/FightReconnectLayer":"FightReconnectLayer","../network/LocalMessage":"LocalMessage","../network/ReconnectLayer":"ReconnectLayer","../network/protocol/ActivityProtocols":"ActivityProtocols","../network/protocol/RoleProtocols":"RoleProtocols","../network/protocol/TypeProtocols":"TypeProtocols","../utils/ByteDanceMiniGameUtils":"ByteDanceMiniGameUtils","../utils/ConfigUtils":"ConfigUtils","../utils/ConstValue":"ConstValue","../utils/GamePlatform":"GamePlatform","../utils/GameTools":"GameTools","../utils/GameUtils":"GameUtils","../utils/KSMinigameUtils":"KSMinigameUtils","../utils/LogUtil":"LogUtil","../utils/ResourcesManager":"ResourcesManager","../utils/Tools":"Tools","../utils/UIManager":"UIManager","../utils/WechatUtils":"WechatUtils","../view/activity/ActivityModule":"ActivityModule","../view/anniversary/AnniversaryModule":"AnniversaryModule","../view/battleDetails/BattleDetailsView":"BattleDetailsView","../view/fogHidden/FogHiddenModel":"FogHiddenModel","../view/machineryCityActivity/MachineryCityCtrl":"MachineryCityCtrl","../view/machineryCityActivity/MachineryCityModel":"MachineryCityModel","../view/skyCastle/SkyCastleModule":"SkyCastleModule","../view/sociaty/SociatyModel":"SociatyModel","./CombatManager":"CombatManager"}],FightTopView:[function(e,t){"use strict";cc._RF.push(t,"dbf24TNrNlHJLEcXI073Y/m","FightTopView");var o=e("../network/protocol/FightProtocols"),i=b(e("../combat/CombatManager")),a=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=N();if(t&&t.has(e))return t.get(e);var o={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var n=i?Object.getOwnPropertyDescriptor(e,a):null;n&&(n.get||n.set)?Object.defineProperty(o,a,n):o[a]=e[a]}return o.default=e,t&&t.set(e,o),o}(e("../common/CombatModule")),n=(e("../network/ClientNetwork"),e("../network/FightNetwork")),r=e("../network/LocalMessage"),s=(e("../network/protocol/RoleProtocols"),e("../StaticData/SoloSilverTableData"),e("../utils/TimeOffSetManager")),c=e("../utils/GameUtils"),l=b(e("../common/PlayerModule")),d=e("../network/protocol/TypeProtocols"),u=e("../utils/ConstValue"),h=b(e("../utils/ConfigUtils")),p=b(e("../controller/Guide/GuideController")),f=b(e("../modules/manager/EventManager")),g=b(e("../common/EventConst")),m=b(e("../utils/ResourcesManager")),_=b(e("../modules/base/GameView")),y=e("../Global/GameGlobal"),v=b(e("../modules/manager/LoadResManager")),C=(e("../utils/StringManager"),b(e("./mainScene/CarSkinUtils"))),S=e("../../load"),T=e("../utils/GamePlatform"),I=b(e("../common/NetworkProtocolCommon"));function N(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return N=function(){return e},e}function b(e){return e&&e.__esModule?e:{default:e}}cc.Class({extends:cc.Component,properties:{myBlood:cc.ProgressBar,myBloodNum:cc.Label,myHeadIcon:cc.Sprite,myName:cc.Label,enemyBolld:cc.ProgressBar,enemyBloodNum:cc.Label,enemyHeadIcon:cc.Sprite,enemyName:cc.Label,enemyHeadWnd:cc.Sprite,enemyBloodWnd:cc.Sprite,enemyBloodWndLabel:cc.Node,fightTimes:cc.Label,fightNumber:cc.Label,exitBtn:cc.Node,LeftPassiveLayoutNode:cc.Node,RightPassiveLayoutNode:cc.Node,LeftPassiveTipsLayout:cc.Node,RightPassiveTipsLayout:cc.Node,SkillTipsTemplateNode:cc.Node,BossTipsBtn:cc.Node,BossTips:cc.Node,NextBossTips:cc.Node},onLoad:function(){f.default.Instance.on(g.default.BattleChangeHero,this.onBattleChangeHero,this),T.GamePlatform.isByteDanceMiniGame()&&!0===(0,S.getSubmitReviewState)()?(this.RightPassiveTipsLayout.opacity=0,this.RightPassiveLayoutNode.opacity=0):(this.RightPassiveTipsLayout.opacity=255,this.RightPassiveLayoutNode.opacity=255)},start:function(){var e=this;this._beginUpdate=!0,this.LeftPassiveLayoutNode.on(cc.Node.EventType.TOUCH_END,function(){e.LeftPassiveLayoutNode.children.length<=0||(e.LeftPassiveLayoutNode.active=!1,e.createPassiveSkillTipsNode(e.LeftPassiveTipsLayout,e.LeftPassiveLayoutNode))}),(i.default.getInstance().isPvP()||i.default.getInstance().isSkyCastle())&&this.RightPassiveLayoutNode.on(cc.Node.EventType.TOUCH_END,function(){e.RightPassiveLayoutNode.children.length<=0||(e.RightPassiveLayoutNode.active=!1,e.createPassiveSkillTipsNode(e.RightPassiveTipsLayout,e.RightPassiveLayoutNode))})},init:function(e){this.myPlayer=i.default.getInstance().getPlayerModelByCamp(u.PLAYER_CAMP.myPlayer),this.playerMode=i.default.getInstance().getSelfCar(),this.opponents=a.default.getMatchBattleInfo(!1),a.default.matchType==d.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE&&(this.opponentsAI=a.default.getMatchBattleAIInfo(u.PLAYER_CAMP.opponents),this.opponentsAICoop=a.default.getMatchBattleAIInfo(u.PLAYER_CAMP.opponentsCoop)),this.myBloodNum.string=i.default.getInstance().getSelfCar().maxHp,this.myBlood.progress=1,this.enemyBloodNum.string=i.default.getInstance().batchModel.getTotalBossHp(),this.enemyHeadIcon.node.scaleX=-1,this.enemyBolld.progress=1,this.playerBatchModel=i.default.getInstance().batchModel,this.fightTimes.string=y.G.StringManager.getString("CUR_ROUND",this.playerBatchModel.getIndexTip()),this.fightNumber.string="\u5269\u4f59"+this.playerBatchModel.getMemCnt()+"\u4eba",this.ExitNode=this.node.getChildByName("ExitButton"),i.default.getInstance().isCoop()&&(this.ExitNode.active=!1),this.gameController=e,this.enemyHeadWnd.node.active=!0,this.enemyBloodWnd.node.active=!1,this.enemyBloodWndLabel.active=!1,this.pvpTimeNode=this.node.getChildByName("fight_time");var t=this.node.getChildByName("fight_timeLabels");this.pvpTimeLabel=t.getChildByName("fight_time_number").getComponent(cc.Label),this.pvpTimeNum=0,this.dt=0,this.bSummonBoss=!1,this.summonBossTime=Number((0,c.getConfigIntValue)("client_pvp_boss_refresh_time")),this.pveBatchNode=this.node.getChildByName("fight_icon");var o=this.node.getChildByName("fight_iconLabels");i.default.getInstance().isPvP()||i.default.getInstance().isSkyCastle()||a.default.matchType==d.FIGHT_TYPE.FIGHT_TYPE_FOG_HIDDEN?(this.pvpTimeNode.active=!0,t.active=!0,this.setEnemyBlood()):(this.pveBatchNode.active=!0,o.active=!0),this.aiMoney=this.node.getChildByName("aimoney").getComponent(cc.Label),this.refHeadIconAndName(),i.default.getInstance().isCoop()?(this.checkCarPassiveSkill_coop(u.PLAYER_CAMP.myPlayer),a.default.matchType==d.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE&&this.checkCarPassiveSkill_coop(u.PLAYER_CAMP.opponents)):(this.checkCarPassiveSkill(u.PLAYER_CAMP.myPlayer),this.checkCarPassiveSkill(u.PLAYER_CAMP.opponents)),n.FightNetwork.getInstance().listenLocalMessage(r.LOCAL_MESSAGE.LocalMsg_FightBloodSync,function(){if(i.default.getInstance().isCoop()){if(i.default.getInstance().getCoopCarByCamp(this.playerMode.camp)){var e=this.playerMode.hp+i.default.getInstance().getCoopCarByCamp(this.playerMode.camp).hp,t=e/(this.playerMode.maxHp+i.default.getInstance().getCoopCarByCamp(this.playerMode.camp).maxHp),o=e;this.myBlood.progress=t,this.myBloodNum.string=o}}else{var a=i.default.getInstance().getSelfCar();if(a){var n=a.hp/a.maxHp,r=a.hp;this.myBlood.progress=n,this.myBloodNum.string=r}var s=i.default.getInstance().getCarByCamp(u.PLAYER_CAMP.opponents);if(s){this.enemyHeadWnd.node.active=!0,this.enemyBloodWnd.node.active=!0,this.enemyBloodWndLabel.active=!0;var c=s.hp/s.maxHp;this.enemyBolld.progress=c,this.enemyBloodNum.string=s.hp}}}.bind(this),this),n.FightNetwork.getInstance().listenLocalMessage(r.LOCAL_MESSAGE.LocalMsg_CoopBossDead,function(e){i.default.getInstance().isCoop()&&a.default.matchType!=d.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE&&(0==e[0]?(this.NextBossTips.active=!1,this.BossTipsBtn.active=!1,this.BossTips.active=!1,this.enemyHeadWnd.node.active=!1,this.enemyBloodWnd.node.active=!1,this.enemyBloodWndLabel.active=!1):this.setCoopBossInfo())}.bind(this),this);var s=a.default.matchReconnectData;null!=s&&(this.pvpTimeNum=s.waveTimelineIndexPassTime,this.onBattleChangeHero(this.playerMode.camp),i.default.getInstance().isCoop()?(this.onBattleChangeHero(u.PLAYER_CAMP.coopPlayer),a.default.matchType==d.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE&&(this.onBattleChangeHero(u.PLAYER_CAMP.opponents),this.onBattleChangeHero(u.PLAYER_CAMP.opponentsCoop))):this.onBattleChangeHero(u.PLAYER_CAMP.opponents))},refTimesAndMemCnt:function(){this.myPlayer.combatStatistic.maxRound=this.playerBatchModel.getIndexTip(),this.fightTimes.string=y.G.StringManager.getString("CUR_ROUND",this.playerBatchModel.getIndexTip())},refHeadIconAndName:function(){var e=this,t=0;if(this.myName.string=l.default.roleName,this.opponents)if(i.default.getInstance().isCoop())a.default.matchType!=d.FIGHT_TYPE.FIGHT_TYPE_COOPERATION&&a.default.matchType!=d.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE&&a.default.matchType!=d.FIGHT_TYPE.FIGHT_TYPE_WEEK_COOPERATION&&a.default.matchType!=d.FIGHT_TYPE.FIGHT_TYPE_FOG_HIDDEN&&a.default.matchType!=d.FIGHT_TYPE.FIGHT_TYPE_MACHINARIUM||(this.myName.string+=" && "+this.opponents.nickName),a.default.matchType==d.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE?(this.BossTipsBtn.active=!1,this.enemyName.string=this.opponentsAI.nickName+" && "+this.opponentsAICoop.nickName,t=this.opponentsAI.headID,(0,c.setRemoteHeadIcon)(this.opponentsAI.headUrl,t,this.enemyHeadIcon)):this.BossTipsBtn.active=!0;else{this.enemyName.string=this.opponents.nickName,t=this.opponents.headID,(0,c.setRemoteHeadIcon)(this.opponents.headUrl,t,this.enemyHeadIcon);var o=this.opponents.headFrameID;(o<=0||o>=2e3)&&(o=200),v.default.loadSpriteFrame("ui/headFrame/frame_"+o).then(function(t){e.enemyHeadIcon.node.parent.getChildByName("headframe2").getComponent(cc.Sprite).spriteFrame=t})}t=l.default.getRoleAttrValByKey(d.ROLE_ATTR_VALUES.ROLE_ATTR_HEADID),(0,c.setRemoteHeadIcon)(l.default.getHeadUrl(),t,this.myHeadIcon);var n=l.default.getRoleAttrValByKey(d.ROLE_ATTR_VALUES.ROLE_ATTR_HEADFRAMEID);n<=0&&(n=200),v.default.loadSpriteFrame("ui/headFrame/frame_"+n).then(function(t){e.myHeadIcon.node.parent.getChildByName("headframe1").getComponent(cc.Sprite).spriteFrame=t}),this.setCoopBossInfo()},setEnemyBlood:function(){if((i.default.getInstance().isPvP()||i.default.getInstance().isSkyCastle())&&(this.NpcModel=i.default.getInstance().getCarByCamp(u.PLAYER_CAMP.opponents),this.NpcModel)){this.enemyHeadWnd.node.active=!0,this.enemyBloodWnd.node.active=!0,this.enemyBloodWndLabel.active=!0;var e=this.NpcModel.hp/this.NpcModel.maxHp;this.enemyBolld.progress=e,this.enemyBloodNum.string=this.NpcModel.hp}},onFightend:function(e){i.default.getInstance().isPvP()||i.default.getInstance().isSkyCastle()||a.default.matchType==d.FIGHT_TYPE.FIGHT_TYPE_FOG_HIDDEN?e?(this.enemyBolld&&(this.enemyBolld.progress=0),this.enemyBloodNum&&(this.enemyBloodNum.string=0)):(this.myBlood&&(this.myBlood.progress=0),this.myBloodNum&&(this.myBloodNum.string=0)):i.default.getInstance().isCoop()&&(e||(this.myBlood&&(this.myBlood.progress=0),this.myBloodNum&&(this.myBloodNum.string=0)))},setCoopBossInfo:function(){var e=this;i.default.getInstance().isCoop()&&a.default.matchType!=d.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE&&(this.enemyBloodNum.string=0,this.enemyBolld.progress=0,cc.tween(this.enemyBloodWnd.node).to(1,{opacity:0},{easing:"quadOut"}).call(function(){e.NextBossTips.active=!0,e.BossTips.active&&(e.BossTipsBtn.active=!e.BossTipsBtn.active,e.BossTips.active=!e.BossTips.active);var t=e.playerBatchModel.getBossConf();t?(e.enemyName.string=t.name,e.enemyBloodNum.string=Math.floor(e.playerBatchModel.getTotalBossHp()),e.enemyBolld.progress=1,(0,c.setTexture)(e.enemyHeadIcon,t.npc_image),e.enemyBloodWnd.node.active=!0):(e.NextBossTips.active=!1,e.BossTipsBtn.active=!1,e.BossTips.active=!1,e.enemyHeadWnd.node.active=!1,e.enemyBloodWnd.node.active=!1)}).to(1,{opacity:255},{easing:"quadIn"}).start(),cc.tween(this.enemyBloodWndLabel).to(1,{opacity:0},{easing:"quadOut"}).call(function(){var t=e.playerBatchModel.getBossConf();e.enemyBloodWndLabel.active=!!t}).to(1,{opacity:255},{easing:"quadIn"}).start())},setCoopBossBlood:function(){if(i.default.getInstance().isCoop()&&a.default.matchType!=d.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE&&this.playerBatchModel.lastTime<0&&this.playerBatchModel.bossId>0){this.NextBossTips.active=!1;var e=i.default.getInstance().getNpcList()[this.playerBatchModel.bossId];if(e){var t=e.hp/e.maxHp;this.enemyBolld.progress=t,this.enemyBloodNum.string=Math.floor(e.hp)}}},setCarryUpdate:function(e){this._beginUpdate=e},update:function(e){if(this._beginUpdate&&1!=p.default.Instance._bPauseGame)if(this.setCoopBossBlood(),this.opponents&&1==this.opponents.bRobot){if(this.playerMode&&i.default.getInstance().gameState==u.Game_State.Fighting){var t=this.playerMode.hp/this.playerMode.maxHp,o=this.playerMode.hp;if(i.default.getInstance().isCoop()&&i.default.getInstance().getCoopCarByCamp(this.playerMode.camp)){var a=this.playerMode.hp+i.default.getInstance().getCoopCarByCamp(this.playerMode.camp).hp;t=a/(this.playerMode.maxHp+i.default.getInstance().getCoopCarByCamp(this.playerMode.camp).maxHp),o=a}o<=0&&(o=0),this.myBlood.progress=t,this.myBloodNum.string=o,this.setEnemyBlood(),this.pvpTimeNode&&1==this.pvpTimeNode.active?(this.dt+=e,this.dt>1&&(this.pvpTimeNum++,this.myPlayer.combatStatistic.maxRound=this.pvpTimeNum,this.dt=0,this.pvpTimeLabel.string=s.TimeOffSetManager.getSecondStr3(this.pvpTimeNum))):this.refTimesAndMemCnt()}}else i.default.getInstance().gameState==u.Game_State.Fighting&&(this.pvpTimeNode&&1==this.pvpTimeNode.active?(this.dt+=e,this.dt>1&&(this.pvpTimeNum++,this.myPlayer.combatStatistic.maxRound=this.pvpTimeNum,this.dt=0,this.pvpTimeLabel.string=s.TimeOffSetManager.getSecondStr3(this.pvpTimeNum),this.pvpTimeNum>=this.summonBossTime&&!this.bSummonBoss&&(this.bSummonBoss=!0,this.checkSummonBossOnOff()&&(this.summonBoss(u.PLAYER_CAMP.myPlayer),this.summonBoss(u.PLAYER_CAMP.opponents))))):this.refTimesAndMemCnt(),i.default.getInstance().isSkyCastle()&&this.setEnemyBlood())},onExitBattleCallBack:function(){_.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:y.G.StringManager.getString("EXIT_BATTLE_PROMPT"),confirmCb:function(){if(1==a.default.getMatchBattleInfo(!1).bRobot)i.default.getInstance().onGameEnd(!1,!0);else{var e=new o.C_Fight_Give_Up;n.FightNetwork.getInstance().Send(o.FIGHT_CLIENT_ENUM.P_Fight_Give_Up,e)}}})},gameSpeedCallBack:function(e,t){for(var o in this.tSpeedBtn)this.tSpeedBtn[o].active=o==t;cc.director.kSpeed=this.tSpeedBtn[t].speed},onBattleChangeHero:function(e){if(this.deletePassiveSkillNode(e),i.default.getInstance().isCoop())return this.onCoopPassiveSkill(e),void this.checkCarPassiveSkill_coop(e);this.onBattlePassiveSkill(e),this.checkCarPassiveSkill(e)},onCoopPassiveSkill:function(e){var t=[],o=i.default.getInstance().getCarByCamp(e),n=i.default.getInstance().getCoopCarByCamp(e);if(o&&n){for(var r in o.heroList){var s=o.heroList[r];if(s){var c=u.PLAYER_CAMP.myPlayer;a.default.matchType!=d.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE||e!=u.PLAYER_CAMP.opponents&&e!=u.PLAYER_CAMP.opponentsCoop||(c=u.PLAYER_CAMP.opponents),t.push({HeroObj:s,Camp:c})}}for(var l in n.heroList){var p=n.heroList[l];if(p){var f=u.PLAYER_CAMP.myPlayer;a.default.matchType!=d.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE||e!=u.PLAYER_CAMP.opponents&&e!=u.PLAYER_CAMP.opponentsCoop||(f=u.PLAYER_CAMP.opponents),t.push({HeroObj:p,Camp:f})}}for(var g=function(e,t,o){var i=h.default.getInstance().getPassiveSkillConfig(t);if(!i||i.icon.length<=0)return!1;if(i.buff&&i.buff>0){var a=!1;for(var n in o.buffList)if(o.buffList[n]&&o.buffList[n].templateId==i.buff){a=!0;break}return a}return!0},m=0;m<t.length;m++){for(var _ in t[m].HeroObj.pPassiveSkillObjList)t[m].HeroObj.pPassiveSkillObjList[_]&&1==g.call(this,t,_,t[m].HeroObj)&&this.createPassiveSkillNode(t[m].Camp,_,t[m].HeroObj,!1);if(t[m].HeroObj.maxPassiveSkillObjList)for(var y in t[m].HeroObj.maxPassiveSkillObjList)if(t[m].HeroObj.maxPassiveSkillObjList[y]){var v=t[m].HeroObj.maxPassiveSkillObjList[y].templateId;1==g.call(this,t,v,t[m].HeroObj)&&this.createPassiveSkillNode(t[m].Camp,v,t[m].HeroObj,!0)}}}},onBattlePassiveSkill:function(e){var t=i.default.getInstance().getCarByCamp(e);if(t)for(var o in t.heroList){var a=t.heroList[o];if(a){for(var n in a.pPassiveSkillObjList)a.pPassiveSkillObjList[n]&&1==this.checkShowPassiveSkill(n,a.occupation,t)&&this.createPassiveSkillNode(e,n,a,!1);if(a.maxPassiveSkillObjList)for(var r in a.maxPassiveSkillObjList)if(a.maxPassiveSkillObjList[r]){var s=a.maxPassiveSkillObjList[r].templateId;1==this.checkShowPassiveSkill(s,a.occupation,t)&&this.createPassiveSkillNode(e,s,a,!0)}}}},checkCarPassiveSkill:function(e){var t=i.default.getInstance().getCarByCamp(e);if(t){var o=t.pPassiveSkillObjList;if(null!=o&&o.length>0)for(var a in o)o[a]&&this.createPassiveSkillNode(e,a,t,!1,!0)}},checkCarPassiveSkill_coop:function(e){var t=i.default.getInstance().getCarByCamp(e),o=i.default.getInstance().getCoopCarByCamp(e);if(null!=t&&null!=o){var a=t.pPassiveSkillObjList,n=o.pPassiveSkillObjList,r=[];if(null==a||0==a.length)r=n;else if(null==n||0==n.length)r=a;else for(var s in r=a,n){var c=h.default.getInstance().getPassiveSkillConfig(s).buff,l=h.default.getInstance().getBuffConfig(c),d=!1;for(var u in r){var p=h.default.getInstance().getPassiveSkillConfig(u).buff,f=h.default.getInstance().getBuffConfig(p);if(f&&l&&f.kind==l.kind&&(d=!0,f.index<l.index)){delete r[u],r[s]=n[s];break}}0==d&&(r[s]=n[s])}for(var g in r)this.createPassiveSkillNode(e,g,t,!1,!0)}},checkShowPassiveSkill:function(e,t,o){var i=h.default.getInstance().getPassiveSkillConfig(e);if(null==i||i.icon.length<=0)return!1;if(i.buff&&i.buff>0){var a=!1;for(var n in o.heroList){var r=o.heroList[n];if(r)for(var s in r.buffList)if(r.buffList[s]&&r.buffList[s].templateId==i.buff){a=!0;break}}return a}return!0},createPassiveSkillNode:function(e,t,o,n,r){void 0===r&&(r=!1);var s=h.default.getInstance().getPassiveSkillConfig(t);if(!s||s.icon.length<=0)return!1;var c;if((c=i.default.getInstance().isCoop()?a.default.matchType==d.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE?e==u.PLAYER_CAMP.myPlayer||e==u.PLAYER_CAMP.coopPlayer?this.LeftPassiveLayoutNode:this.RightPassiveLayoutNode:this.LeftPassiveLayoutNode:e==u.PLAYER_CAMP.myPlayer?this.LeftPassiveLayoutNode:this.RightPassiveLayoutNode)&&1!=function(e){for(var t=!1,o=0;o<e.children.length;o++){var i=e.children[o];if(i.passiveSkillIconStr&&i.passiveSkillIconStr==s.icon){t=!0;break}}return t}.call(this,c)){if(i.default.getInstance().isCoop()&&1==function(e){for(var t=0;t<c.children.length;t++){var o=c.children[t];if(o.nPassiveSkillId&&Number(o.nPassiveSkillId)==Number(e))return!0}return!1}.call(this,t))return!1;var l=new cc.Node("passiveSkillNode"+t);i.default.getInstance().isCoop()?(l.parent=c,l.camp=e):l.parent=e==u.PLAYER_CAMP.myPlayer?this.LeftPassiveLayoutNode:this.RightPassiveLayoutNode,l.nHeroTemplateId=0==r?o.heroTemplateId:-1,l.nHeroLevel=o.level,l.nPassiveSkillId=t,l.bMaxSatrSkill=n,l.passiveSkillIconStr=s.icon;var f=l.addComponent(cc.Sprite);m.default.loadSprite("ui/passiveSkill/"+s.icon,f,function(e){f=e}),p.default._Instance.getGuideStatus()?this.LeftPassiveLayoutNode.width=45*this.LeftPassiveLayoutNode.children.length:this.LeftPassiveLayoutNode.width=410}},deletePassiveSkillNode:function(e){if(i.default.getInstance().isCoop()){var t=null;(t=e==u.PLAYER_CAMP.myPlayer||e==u.PLAYER_CAMP.coopPlayer?this.LeftPassiveLayoutNode:this.RightPassiveLayoutNode)&&t.removeAllChildren()}else(e==u.PLAYER_CAMP.myPlayer?this.LeftPassiveLayoutNode:this.RightPassiveLayoutNode).removeAllChildren()},createPassiveSkillTipsNode:function(e,t){var o=this;e.removeAllChildren();var i=5,a=t.children.length,n=0;this.schedule(function(){var a=t.children[n];if("undefined"!=a&&a){var r=h.default.getInstance().getHeroConfig(a.nHeroTemplateId);if(r||-1==a.nHeroTemplateId){var s=h.default.getInstance().getPassiveSkillConfig(a.nPassiveSkillId);if(s&&s.icon.length>0){var c=cc.instantiate(o.SkillTipsTemplateNode);c.active=!0,c.parent=e,m.default.loadSprite("ui/passiveSkill/"+s.icon,c.getChildByName("SkillIconNode").getComponent(cc.Sprite));var l=s.name,d=a.nHeroLevel;if(!d||d<=0)return void n++;var u;u=-1==a.nHeroTemplateId?"\u3010"+C.default.Instance.getCarNameByPassiveId(a.nPassiveSkillId)+"\u3011":"\u3010"+r.name+"\u3011";var p=l;c.getChildByName("SkillLabel").getComponent(cc.Label).string=u+p,c.getChildByName("SkillLabel").getComponent(cc.Label)._forceUpdateRenderData(),c.getChildByName("SkillLabel").height>32&&(c.height=52),i+=c.height+e.getComponent(cc.Layout).spacingY}}++n>=t.children.length&&(e.height=i+5,e.getComponent(cc.Layout).updateLayout(),e.active=!0)}else n++},0,a-1,0)},showBossTips:function(){if(i.default.getInstance().isCoop()&&a.default.matchType!=d.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE){var e=this.playerBatchModel.getBossConf();if(e){var t=e.npc_desc.split("|"),o=this.BossTips.getChildByName("attack").getComponent(cc.Label);o.string=t[0],o._forceUpdateRenderData();var n=this.BossTips.getChildByName("defence").getComponent(cc.Label);n.string=t[1].replace(/\\n/g,"\n");var r=n.node.height;n._forceUpdateRenderData();var s=n.node.height-r,c=this.BossTips.getChildByName("skill").getComponent(cc.Label),l=this.BossTips.getChildByName("skillLabel").getComponent(cc.Label);c.string=t[2].replace(/\\n/g,"\n"),l.node.y-=s,c.node.y-=s,c._forceUpdateRenderData(),this.BossTips.height+=s,this.BossTips.height=o.node.height+n.node.height+c.node.height+10,this.BossTipsBtn.active=!this.BossTipsBtn.active,this.BossTips.active=!this.BossTips.active}}},checkSummonBossOnOff:function(){return l.default.checkModulerOnOffState(53)&&(i.default.getInstance().isPvP()||i.default.getInstance().isSkyCastle())},summonBoss:function(e){var t=Number((0,c.getConfigIntValue)("pvp_boss_id")),o=Number((0,c.getConfigIntValue)("pvp_boss_star"));if(a.default.matchType==d.FIGHT_TYPE.FIGHT_TYPE_BATTLE_EAT_CHICKEN&&(t=Number((0,c.getConfigIntValue)("pvp_boss_id_eatchicken")),o=Number((0,c.getConfigIntValue)("pvp_boss_star_eatchicken"))),t&&o){I.default.callRoleClientLog("fighttop summonBoss");var n,r=h.default.getInstance().getStarParam(o),s=.01*r.starParam_att,l=.01*r.starParam_hp,p=9990001+1e3*(0,c.getRoleIdentity)(e);n=e==u.PLAYER_CAMP.myPlayer||i.default.getInstance().isCoop()&&a.default.matchType==d.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE&&(0,c.getRoleIdentity)(this.camp)==PLAYER_IDENTITY.away?175:-175,i.default.getInstance().summon(t,1,e,n,0,!1,s,l,p)}},onDestroy:function(){f.default.Instance.off(this,g.default.BattleChangeHero)}}),cc._RF.pop()},{"../../load":"load","../Global/GameGlobal":"GameGlobal","../StaticData/SoloSilverTableData":"SoloSilverTableData","../combat/CombatManager":"CombatManager","../common/CombatModule":"CombatModule","../common/EventConst":"EventConst","../common/NetworkProtocolCommon":"NetworkProtocolCommon","../common/PlayerModule":"PlayerModule","../controller/Guide/GuideController":"GuideController","../modules/base/GameView":"GameView","../modules/manager/EventManager":"EventManager","../modules/manager/LoadResManager":"LoadResManager","../network/ClientNetwork":"ClientNetwork","../network/FightNetwork":"FightNetwork","../network/LocalMessage":"LocalMessage","../network/protocol/FightProtocols":"FightProtocols","../network/protocol/RoleProtocols":"RoleProtocols","../network/protocol/TypeProtocols":"TypeProtocols","../utils/ConfigUtils":"ConfigUtils","../utils/ConstValue":"ConstValue","../utils/GamePlatform":"GamePlatform","../utils/GameUtils":"GameUtils","../utils/ResourcesManager":"ResourcesManager","../utils/StringManager":"StringManager","../utils/TimeOffSetManager":"TimeOffSetManager","./mainScene/CarSkinUtils":"CarSkinUtils"}],FirstCharge:[function(e,t,o){"use strict";cc._RF.push(t,"830b466rEtJ+b1MuLjAhaIc","FirstCharge");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../utils/ConfigUtils"),s=e("../../modules/base/BaseView"),c=e("../../utils/GameTools"),l=e("../../modules/base/GameView"),d=e("../../common/PlayerModule"),u=e("../../network/protocol/TypeProtocols"),h=e("../../StaticData/RechargeTableData"),p=e("../../modules/base/Decorators"),f=e("../../network/ClientNetwork"),g=e("../../network/protocol/RoleProtocols"),m=cc._decorator,_=m.ccclass,y=m.property,v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.RewardsNode=null,t.GotoChangeLab=null,t.GetRewardLab=null,t}return a(t,e),t.path=function(){return"ui/first_charge/FirstCharge"},t.prototype.onLoad=function(){},t.prototype.start=function(){var e=this;h.RechargeTableData.getById(102).firstPrize.forEach(function(t){c.default.createNormalItems(t.dropID,t.dropNum,e.RewardsNode,function(e){2===r.default.getInstance().getItemByID(t.dropID).type&&e.on(cc.Node.EventType.TOUCH_END,function(){l.default.addPopView("BaseCtrl","DrawNewHeroCardView","DrawNewHeroCardView",{heroId:t.dropID,bShowNew:!0,bAction:!1})})})}),d.default.getRoleAttrValByKey(u.ROLE_ATTR_VALUES.ROLE_ATTR_RECHARGENUM)>0?(this.GetRewardLab.active=!0,this.GotoChangeLab.active=!1):(this.GetRewardLab.active=!1,this.GotoChangeLab.active=!0),f.ClientNetwork.getInstance().listenProtocol(g.ROLE_CLIENT_ENUM.P_Role_GetFirstRechargeReward,function(e){e.resetPos();var t=new g.S_Role_GetFirstRechargeReward;if(t.read(e)&&0===t.errorcode){l.default.addPopView("BaseCtrl","AcquirePopupView","AcquirePopupView",{items:t.prize});var o=l.default.getViewByName("MainSceneView");o&&o.view&&o.view.onRefreshFirstRechargeNode()}},this)},t.prototype.onChangeCallBack=function(){if(!0===this.GotoChangeLab.active)l.default.addPopView("ShopMainCtrl","ShopMainView","ShopMainView",{skipType:"Diamond"});else{var e=new g.C_Role_GetFirstRechargeReward;f.ClientNetwork.getInstance().Send(g.ROLE_CLIENT_ENUM.P_Role_GetFirstRechargeReward,e)}this.closeView()},t.prototype.onDestroy=function(){f.ClientNetwork.getInstance().removeMessageTarget(this)},n([y(cc.Node)],t.prototype,"RewardsNode",void 0),n([y(cc.Node)],t.prototype,"GotoChangeLab",void 0),n([y(cc.Node)],t.prototype,"GetRewardLab",void 0),n([p.Register_Class,p.Register_Button_Sound,_],t)}(s.default);o.default=v,cc._RF.pop()},{"../../StaticData/RechargeTableData":"RechargeTableData","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/base/GameView":"GameView","../../network/ClientNetwork":"ClientNetwork","../../network/protocol/RoleProtocols":"RoleProtocols","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/ConfigUtils":"ConfigUtils","../../utils/GameTools":"GameTools"}],FlyingObj:[function(e,t,o){"use strict";cc._RF.push(t,"637b35di2VAHbvY6tlViCsH","FlyingObj"),o.__esModule=!0,o.default=void 0;var i=c(e("../../common/CombatModule")),a=c(e("../../utils/ConfigUtils")),n=e("../../utils/ConstValue"),r=e("../../utils/GameUtils"),s=c(e("../CombatManager"));function c(e){return e&&e.__esModule?e:{default:e}}var l=function(e){var t,o;function c(){var t;return(t=e.call(this)||this).targetNpc=null,t.targetPos=cc.v2(0,0),t.behitOffset=null,t.cd=0,t.hurtTimes=0,t.bCheckRect=!1,t.emitterNpc=null,t.castSkillCount=0,t}o=e,(t=c).prototype=Object.create(o.prototype),t.prototype.constructor=t,t.__proto__=o;var l=c.prototype;return l.destroy=function(){this.behitOffset=null,this.emitterNpc=null,this.castSkillCount=0,e.prototype.destroy.call(this)},l.init=function(t,o,i,s,c,l,d){this.emitterNpc=i,this.emitterNpc&&(this.castSkillCount=this.emitterNpc.getCastSkillCount()),this.setCamp(i.getCamp()),this.initCampParam();var u=(0,r.getRoleIdentity)(i.getCamp());this.setOwnerId(i.id+u),this.prof=i.prof,this.behitOffset=l,this.damageParam=d,this.config=a.default.getInstance().getFlyingObjConfig(o),this.type=this.config.type,this.targetNpc=s,this.targetNpc&&(this.targetPos=s.getWorldPos()),this.lifeTime=this.config.lifeTime;var h=this.getAttackFram();Number(h[0])>0&&(this.bCheckRect=!0);var p=i.node.convertToWorldSpaceAR(cc.v2(0,0));p=c.convertToNodeSpaceAR(p),e.prototype.init.call(this,t,o,c,this.getStartPos(this.config,p,c)),this.cloneAttr(i),this.initRes(this.config.res_id),this.config.speedType!=n.Speed_Type.Speed_ShuiPing&&this.config.speedType!=n.Speed_Type.Speed_ShuiPing_Hero&&(this.node.scaleX=this.node.scaleX*this.campParam),this.initSpeed(this.config,s),this.cd=this.config.intervalTime,this.damageType=this.config.damage_type,this.onBorn(),this.targetNpc&&s.aimed(this),this.node.zIndex=0},l.isFlyingobj=function(){return!0},l.onLoadRes=function(t){e.prototype.onLoadRes.call(this,t),this.spineNode&&this.spineNode.setAnimation(0,"idle",!0)},l.getStartPos=function(e,t,o){var i=cc.v2(0,0);if(e.speedType==n.Speed_Type.Speed_JiaoDu||e.speedType==n.Speed_Type.Speed_Acc)i=cc.v2(t.x+e.offsetX*this.campParam,t.y+e.offsetY);else if(e.speedType==n.Speed_Type.Speed_ShuiPing){var a=s.default.getInstance().getCarByCamp(this.camp);if(a){i=a.node.convertToWorldSpaceAR(cc.v2(0,0));var r=o.convertToNodeSpaceAR(i);i=cc.v2(r.x+e.pointX*this.campParam,r.y+e.pointY),s.default.getInstance().isSkyCastle()&&e.pointX>=1100&&(i=cc.v2(r.x+(e.pointX-165)*this.campParam,r.y+e.pointY))}else i=cc.v2(t.x+e.pointX*this.campParam,t.y+e.pointY)}else e.speedType==n.Speed_Type.Speed_ShuZhi?(i=this.targetNpc.node.convertToWorldSpaceAR(cc.v2(0,0)),r=o.convertToNodeSpaceAR(i),i=cc.v2(r.x,e.pointY)):e.speedType==n.Speed_Type.Speed_ShuiPing_Hero&&(i=cc.v2(t.x+e.offsetX*this.campParam,t.y+e.offsetY));return i},l.initSpeed=function(e,t){if(e.speedType==n.Speed_Type.Speed_JiaoDu){(c=t.getWorldPos()).y=c.y+.5*t.height+20;var o=this.getWorldPos(),i=c.x-o.x,a=c.y-o.y,r=Math.sqrt(i*i+a*a)/e.speed;this.setSpeed(i/r,a/r);var s=Math.atan2(a,i)*(180/Math.PI);this.node.angle=s}else if(e.speedType==n.Speed_Type.Speed_ShuiPing)this.setSpeed(e.speed*this.campParam,0);else if(e.speedType==n.Speed_Type.Speed_ShuZhi)(c=t.getWorldPos()).y=c.y+.5*t.height+20,this.setSpeed(0,e.speed),s=Math.atan2(c.y-o.y,c.x-o.x)*(180/Math.PI),this.node.angle=s;else if(e.speedType==n.Speed_Type.Speed_Acc){var c;(c=t.getWorldPos()).y=c.y+.5*t.height+20,o=this.getWorldPos(),i=c.x-o.x,a=c.y-o.y;var l=i/(r=Math.sqrt(i*i+a*a)/e.speed),d=(a-.5*e.accY*r*r)/r,u=e.accY;Math.abs(d)>1.5*Math.abs(l)&&(d=a/r,u=0),this.setSpeed(l,d),this.setAccSpeed(0,u),this.updateAngle()}},l.update=function(t){if(e.prototype.update.call(this,t),this.config.speedType==n.Speed_Type.Speed_Acc&&this.updateAngle(),this.type==n.FlyingObj_Type.Repeat||this.type==n.FlyingObj_Type.Repeat_AddHp){if(this.lifeTime=this.lifeTime-1e3*t,this.lifeTime<=0)return void this.toDie();this.cd=this.cd-1e3*t,this.cd<=0&&(this.config.hurtTimes?this.hurtTimes<this.config.hurtTimes&&this.chkRect(0):this.chkRect(0),this.cd=this.config.intervalTime,this.hurtTimes=this.hurtTimes+1)}else{if(this.chkOffScreen())return;this.chkCollide()}},l.updateAngle=function(){var e=Math.atan2(this.speed.y,this.speed.x)*(180/Math.PI);this.node&&cc.isValid(this.node)&&(this.node.angle=e)},l.chkCollide=function(){if(!this.targetNpc||this.targetNpc.isDead()||this.targetNpc.bDestory){var e=this.getWorldPos();Math.abs(e.x-this.targetPos.x)<=100&&(this.chkRect(0),this.toDie())}else this.checkPointCollide(this.targetNpc,this.config.speedType)&&(this.attackTarget(this.targetNpc,!1,this.behitOffset),this.chkRect(this.targetNpc.getId()),this.toDie())},l.chkRect=function(e){if(this.bCheckRect){var t=this.getWorldPos(),o=this.getAttackFram(),i=.5*o[0],a=.5*o[1],r=s.default.getInstance().getNpcList();for(var c in r)if(c!=e){var l=r[c];if(l&&0==l.isDead())if(this.type==n.FlyingObj_Type.Repeat_AddHp){if(this.camp==l.camp||s.default.getInstance().isCoopPartner(this.camp,l.camp)){var d=l.getWorldPos();Math.abs(d.x-t.x)<i&&Math.abs(d.y-t.y)<a&&this.attackTarget(l,!0,this.behitOffset)}}else if(this.camp!=l.camp){if(1==s.default.getInstance().isCoopPartner(this.camp,l.camp))continue;d=l.getWorldPos(),Math.abs(d.x-t.x)<i&&Math.abs(d.y-t.y)<a&&this.attackTarget(l,!1,this.behitOffset)}}}},l.attackTarget=function(t,o,a){if(this.config.obstacleId>0)s.default.getInstance().createObstacle(this.config.obstacleId,this,t,a,this.damageParam);else{var r=this.getTbBuff();for(var c in r)if(0!=r[c]){if(t.addBuff(r[c],this.emitterNpc),this.type!=n.FlyingObj_Type.Once)continue;if(s.default.getInstance().isCoop()&&t.isCar()){var l=s.default.getInstance().getCoopCarByCamp(t.camp);l&&l.addBuff(r[c],this.emitterNpc)}}if(s.default.getInstance().isCoop()&&t.isCar()&&(this.camp==n.PLAYER_CAMP.myPlayer||this.camp==n.PLAYER_CAMP.coopPlayer)&&(i.default.matchRoleIdentity==n.PLAYER_IDENTITY.home&&t.camp==n.PLAYER_CAMP.myPlayer||i.default.matchRoleIdentity==n.PLAYER_IDENTITY.away&&t.camp==n.PLAYER_CAMP.coopPlayer))return;e.prototype.attackTarget.call(this,t,o,a,this.damageParam)}},l.chkOffScreen=function(){var e=this.node.convertToWorldSpaceAR(cc.v2(0,0));return(e.x>=2048||e.x<=0||e.y>=2048||e.y<=0)&&(this.toDie(),!0)},l.toDie=function(){this.onDie()},l.onDie=function(){s.default.getInstance().onFlyingObjDie(this.id),this.targetNpc&&this.targetNpc.shooted(this),this.destroy()},l.getTriggerCritDebufType=function(){return this.emitterNpc?this.emitterNpc.getTriggerCritDebufType():0},l.getPassiveDamage=function(){return this.emitterNpc?this.emitterNpc.getPassiveDamage():0},l.getKillRewardPlus=function(e){return this.emitterNpc?this.emitterNpc.getKillRewardPlus(e):0},l.getTargetHPDamagePlus=function(e){return this.emitterNpc?this.emitterNpc.getTargetHPDamagePlus(e):0},l.getTargetHPExtraDamage=function(e){return this.emitterNpc?this.emitterNpc.getTargetHPExtraDamage(e):0},l.getDamageMultiple=function(e){return this.emitterNpc?this.emitterNpc.getDamageMultiple(e):1},l.getHealPercent=function(e){return this.emitterNpc?this.emitterNpc.getHealPercent(e):0},l.getEnemyHeroProfValue=function(){return this.emitterNpc?this.emitterNpc.getEnemyHeroProfValue():1},l.getEnemyPopulationAddValue=function(){return this.emitterNpc&&this.emitterNpc.getNextSkillIndex()>0?this.emitterNpc.getEnemyPopulationAddValue():1},l.getAttackFram=function(){return this.config.attackFram.split("|")},l.getTbBuff=function(){return this.config.buffId.split("|")},l.getCritSeedRandom=function(){return this.emitterNpc&&this.emitterNpc.critSeedRandom?this.emitterNpc.critSeedRandom.randomMinMaxInt(1,n.AttrParam):n.AttrParam},l.getCastSkillCount=function(){return this.castSkillCount+this.hurtTimes},l.getId=function(){if(this.emitterNpc)return this.emitterNpc.id},c}(c(e("./CombatObj")).default);o.default=l,t.exports=o.default,cc._RF.pop()},{"../../common/CombatModule":"CombatModule","../../utils/ConfigUtils":"ConfigUtils","../../utils/ConstValue":"ConstValue","../../utils/GameUtils":"GameUtils","../CombatManager":"CombatManager","./CombatObj":"CombatObj"}],FogHiddenBattlePassBuyView:[function(e,t,o){"use strict";cc._RF.push(t,"62740T0tAxFX5Y76nIq0BKg","FogHiddenBattlePassBuyView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=e("../../StaticData/CostGetTableData"),l=e("../../Global/GameGlobal"),d=e("../../common/NetworkProtocolCommon"),u=e("../../common/PlayerModule"),h=cc._decorator,p=h.ccclass,f=h.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.m_costLab=null,t.m_getLab=null,t}return a(t,e),t.path=function(){return"ui/fogHidden/prefab/FogHiddenBattlePassBuyView"},t.prototype.start=function(){var e=c.CostGetTableData.getById(7),t=l.G.StringManager.m_pDict.COMMON_COSTGET_LAB.split("|")[0],o=l.G.StringManager.formatStr(t,[e.cost[0].itemNum]);this.m_costLab.string=o;var i=l.G.StringManager.m_pDict.COMMON_COSTGET_LAB.split("|")[1],a=l.G.StringManager.formatStr(i,[e.get[0].itemNum]);this.m_getLab.string=a},t.prototype.onClickConfirmCallBack=function(){if(u.default.diamondNum<c.CostGetTableData.getById(7).cost[0].itemNum)return l.G.StringManager.PopWorldString("common_prompt_diamond_insufficient");d.default.callRoleCostGet(7)},n([f(cc.Label)],t.prototype,"m_costLab",void 0),n([f(cc.Label)],t.prototype,"m_getLab",void 0),n([s.Register_Class,p],t)}(r.default);o.default=g,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/CostGetTableData":"CostGetTableData","../../common/NetworkProtocolCommon":"NetworkProtocolCommon","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators"}],FogHiddenBattlePassItem:[function(e,t,o){"use strict";cc._RF.push(t,"cc335wgs1RMaIrsv3N069q2","FogHiddenBattlePassItem");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/manager/LoadResManager"),s=e("../../utils/GameTools"),c=e("../../modules/base/GameView"),l=e("../../Global/GameGlobal"),d=e("../../network/protocol/TypeProtocols"),u=e("../../common/PlayerModule"),h=e("../../utils/ConfigUtils"),p=e("../../network/protocol/ActivityProtocols"),f=e("../../network/ClientNetwork"),g=e("../../view/fogHidden/FogHiddenModel"),m=cc._decorator.ccclass,_=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.show=function(e,t){this.initCoinInfo(e,t),this.initFreeBoxInof(e,t),this.initLuxuryBoxInfo(e,t)},t.prototype.initLuxuryBoxInfo=function(e,t){var o=this,i=this.node.getChildByName("ExtraRewardsNode");i.reawds=e.extraPrize,i.coinNum=e.coinNum,i.id=e.id,r.default.loadSpriteFrame(e.extraItemIcon).then(function(t){cc.isValid(o.node)&&(i.getChildByName("ExtraRewardsIcon").scale=i.getChildByName("ExtraRewardsIcon").scale*e.extraItemScale/100,i.getChildByName("ExtraRewardsIcon").getComponent(cc.Sprite).spriteFrame=t)}).catch(function(e){cc.error(e)}),i.getChildByName("ExtraRewardsName").getComponent(cc.Label).string=e.extraItemName;var a=this.checkLuxuryRewardLockState();i.getChildByName("suo").active=!a,0==a&&s.default.registerTouchEvent(i.getChildByName("suo"),function(){l.G.StringManager.PopString(l.G.StringManager.getString("FOGHIDDEN_BATTLEPASS_SUO"))});var n=0,h=t;1==this.checkBoxReceiveState(e.id,2)?n=2:h>=e.coinNum&&1==a&&(n=1),2==n?(s.default.setNodeBright(i,!1),this.node.getChildByName("waifaguang").active=!1):this.node.getChildByName("waifaguang").active=1==n,i.receiveState=n,s.default.registerTouchEvent(i,function(e){var t=e.target;if(t.reawds)if(t.reawds.length>1)c.default.addPopView("BaseCtrl","BattlePassRewardPreview","BattlePassRewardPreview",{cb:function(){if(1!=u.default.getRoleAttrValByKey(d.ROLE_ATTR_VALUES.ROLE_ATTR_FogHidden_BATTLEPASS))return l.G.StringManager.PopString(l.G.StringManager.getString("FOGHIDDEN_BATTLEPASS_SUO"));var e=new p.T_Activity_FogHiddenGetBoxsData;e.index=t.id,e.type=2;var o=new p.C_Activity_FogHiddenGetBoxsReward;o.getRewardsVec=[e],f.ClientNetwork.getInstance().Send(p.ACTIVITY_CLIENT_ENUM.P_Activity_FogHiddenGetBoxsReward,o)},rewards:t.reawds,rewardState:t.receiveState});else{if(2==t.receiveState)return l.G.StringManager.PopString(l.G.StringManager.getWorldString("common_prompt_receive_over"));if(1==t.receiveState){if(1!=u.default.getRoleAttrValByKey(d.ROLE_ATTR_VALUES.ROLE_ATTR_FogHidden_BATTLEPASS))return l.G.StringManager.PopString(l.G.StringManager.getString("FOGHIDDEN_BATTLEPASS_SUO"));var i=new p.T_Activity_FogHiddenGetBoxsData;i.index=t.id,i.type=2;var a=new p.C_Activity_FogHiddenGetBoxsReward;a.getRewardsVec=[i],f.ClientNetwork.getInstance().Send(p.ACTIVITY_CLIENT_ENUM.P_Activity_FogHiddenGetBoxsReward,a)}else o.checkRewardIsHero(t.reawds[0])&&c.default.addPopView("BaseCtrl","DrawNewHeroCardView","DrawNewHeroCardView",{heroId:t.reawds[0].itemID,bShowNew:!0,bAction:!0})}})},t.prototype.initCoinInfo=function(e){var t=this;this.node.getChildByName("CoinBg").getChildByName("CoinNum").getComponent(cc.Label).string=e.coinNum.toString(),0>=e.coinNum&&r.default.loadSpriteFrame("ui/battle_pass/res/bei1").then(function(e){cc.isValid(t.node)&&(t.node.getChildByName("CoinBg").getComponent(cc.Sprite).spriteFrame=e)})},t.prototype.initFreeBoxInof=function(e,t){var o=this,i=this.node.getChildByName("RewardsNode");i.reawds=e.prize,i.coinNum=e.coinNum,i.id=e.id,r.default.loadSpriteFrame(e.itemIcon).then(function(t){cc.isValid(o.node)&&(i.getChildByName("RewardsIcon").scale=i.getChildByName("RewardsIcon").scale*e.itemScale/100,i.getChildByName("RewardsIcon").getComponent(cc.Sprite).spriteFrame=t)}).catch(function(e){cc.error(e)}),i.getChildByName("RewardsName").getComponent(cc.Label).string=e.itemName;var a=0,n=t;1==this.checkBoxReceiveState(e.id,1)?a=2:n>=e.coinNum&&(a=1),2==a?(s.default.setNodeBright(i,!1),this.node.getChildByName("waifaguangReward").active=!1):this.node.getChildByName("waifaguangReward").active=1==a,i.receiveState=a,s.default.registerTouchEvent(i,function(e){var t=e.target;if(t.reawds.length>1)c.default.addPopView("BaseCtrl","BattlePassRewardPreview","BattlePassRewardPreview",{cb:function(){var e=new p.T_Activity_FogHiddenGetBoxsData;e.index=t.id,e.type=1;var o=new p.C_Activity_FogHiddenGetBoxsReward;o.getRewardsVec=[e],f.ClientNetwork.getInstance().Send(p.ACTIVITY_CLIENT_ENUM.P_Activity_FogHiddenGetBoxsReward,o)},rewards:t.reawds,rewardState:t.receiveState});else{if(2==t.receiveState)return l.G.StringManager.PopString(l.G.StringManager.getWorldString("common_prompt_receive_over"));if(1==t.receiveState){var i=new p.T_Activity_FogHiddenGetBoxsData;i.index=t.id,i.type=1;var a=new p.C_Activity_FogHiddenGetBoxsReward;a.getRewardsVec=[i],f.ClientNetwork.getInstance().Send(p.ACTIVITY_CLIENT_ENUM.P_Activity_FogHiddenGetBoxsReward,a)}else o.checkRewardIsHero(t.reawds[0])&&c.default.addPopView("BaseCtrl","DrawNewHeroCardView","DrawNewHeroCardView",{heroId:t.reawds[0].itemID,bShowNew:!0,bAction:!0})}})},t.prototype.checkLuxuryRewardLockState=function(){var e=!1;return 1==u.default.getRoleAttrValByKey(d.ROLE_ATTR_VALUES.ROLE_ATTR_FogHidden_BATTLEPASS)&&(e=!0),e},t.prototype.checkBoxReceiveState=function(e,t){var o=g.default.Instance.FogHiddenBoxData().normalPrize;return 2==t&&(o=g.default.Instance.FogHiddenBoxData().superprize),!!o.has(e)&&o.get(e)},t.prototype.checkRewardIsHero=function(e){return!!h.default.getInstance().data["StaticData/HeroTableData"].hasOwnProperty(e.itemID)},n([m],t)}(cc.Component);o.default=_,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../common/PlayerModule":"PlayerModule","../../modules/base/GameView":"GameView","../../modules/manager/LoadResManager":"LoadResManager","../../network/ClientNetwork":"ClientNetwork","../../network/protocol/ActivityProtocols":"ActivityProtocols","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/ConfigUtils":"ConfigUtils","../../utils/GameTools":"GameTools","../../view/fogHidden/FogHiddenModel":"FogHiddenModel"}],FogHiddenBattlePassView:[function(e,t,o){"use strict";cc._RF.push(t,"028b57syptO06bs4KoIat+h","FogHiddenBattlePassView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../StaticData/FogHiddenBoxTableData"),s=e("../../common/PlayerModule"),c=e("../../modules/base/GameView"),l=e("../../Global/GameGlobal"),d=e("../../common/EventConst"),u=e("../../modules/manager/EventManager"),h=e("../../utils/GameUtils"),p=e("../../network/protocol/TypeProtocols"),f=e("../../network/protocol/RoleProtocols"),g=e("../../network/ClientNetwork"),m=e("../../modules/base/BaseView"),_=e("../../modules/base/Decorators"),y=e("../../StaticData/ActivityTableData"),v=e("../../network/protocol/RechargeProtocols"),C=e("../../network/protocol/ActivityProtocols"),S=e("../../StaticData/RechargeTableData"),T=e("../../utils/GameTools"),I=e("../../view/fogHidden/FogHiddenModel"),N=cc._decorator,b=N.ccclass,w=N.property,E=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.itemPrefab=null,t.ScrollView=null,t.progressBarNode=null,t.curTrophyNode=null,t.curGetWayLab=null,t._scrollViewChildNode=[],t._curSeasonData=[],t._boxItemSpacing=300,t.m_ItemId=1024,t.m_itemNum=0,t.rewardCount=0,t.nSeasonLeftTime=0,t}return a(t,e),t.path=function(){return"ui/fogHidden/prefab/FoxHiddenBattlePass"},t.prototype.onLoad=function(){var e=this;this.m_ItemId=Number(h.getConfigIntValue("FogHidden_box_coin_itemId")),g.ClientNetwork.getInstance().listenProtocol(f.ROLE_CLIENT_ENUM.P_Role_Get_Item_Num,function(t){t.resetPos();var o=new f.S_Role_Get_Item_Num;o.read(t)&&0===o.errorcode&&o.itemId==e.m_ItemId&&(e.m_itemNum=o.itemNum,e.initBoxInfo())},this),g.ClientNetwork.getInstance().listenProtocol(C.ACTIVITY_CLIENT_ENUM.P_Activity_FogHiddenGetBoxsReward,function(t){t.resetPos();var o=new C.S_Activity_FogHiddenGetBoxsReward;o.read(t)&&(0==o.errorcode&&o.rewards.length>0&&(e.initBoxInfo(),e.showRewards(o.rewards),u.default.Instance.emit(d.default.RefreshFogHiddenBoxRedpoint)),0!=o.errorcode&&l.G.StringManager.PopString("S_Activity_FogHiddenGetBoxsReward ERROR "+o.errorcode))},this),g.ClientNetwork.getInstance().listenProtocol(v.RECHARGE_CLIENT_ENUM.P_Recharge_Role_Recharge,function(){console.log("P_Recharge_Role_Recharge===================="),e.initBoxInfo(),1==s.default.getRoleAttrValByKey(p.ROLE_ATTR_VALUES.ROLE_ATTR_FogHidden_BATTLEPASS)&&(e.node.getChildByName("BuyButton").active=!1)},this)},t.prototype.start=function(){var e=this,t=new f.C_Role_Get_Item_Num;t.itemId=this.m_ItemId,g.ClientNetwork.getInstance().Send(f.ROLE_CLIENT_ENUM.P_Role_Get_Item_Num,t),r.FogHiddenBoxTableData.getDataMap().forEach(function(t){e._curSeasonData.push(t)});var o=Number(h.getConfigIntValue("FogHidden_box_rechargeid")),i=S.RechargeTableData.getById(o),a=T.default.getRechargeMoneyByPlatform(i)/100;this.node.getChildByName("BuyButton").getChildByName("label").getComponent(cc.Label).string="\uffe5"+a;var n=this._curSeasonData;this.progressBarNode.width=n[n.length-1].pointX,this.ScrollView.content.width=this.progressBarNode.width+n[0].pointX-this.itemPrefab.width/2+100,1==s.default.getRoleAttrValByKey(p.ROLE_ATTR_VALUES.ROLE_ATTR_FogHidden_BATTLEPASS)&&(this.node.getChildByName("BuyButton").active=!1)},t.prototype.initCurGetWayInfo=function(){this.curGetWayLab.string=s.default.getRoleAttrValByKey(p.ROLE_ATTR_VALUES.ROLE_ATTR_FogHidden_BOX_COIN_NUM)+"/"+h.getConfigIntValue("FogHidden_box_coin_day_max")},t.prototype.initBoxProgress=function(){var e=null;this.curTrophyNode.x=5;var t,o=this._curSeasonData,i=0,a=this.m_itemNum;if(o.forEach(function(t,o){a>=t.coinNum&&(e=t,i=o)}),e)if(t=o[i+1]){var n=a-e.coinNum,r=t.coinNum-e.coinNum,s=(t.pointX-e.pointX)*(n/r),c=e.pointX+s;this.curTrophyNode.x=c,isNaN(this.curTrophyNode.x)&&(this.curTrophyNode.x=5),this.progressBarNode.getChildByName("bar").width=c}else this.progressBarNode.getChildByName("bar").width=this.progressBarNode.width,this.curTrophyNode.x=this.progressBarNode.width-5;else(t=o[i])?(n=a,r=t.coinNum,c=s=t.pointX*(n/r),this.curTrophyNode.x=c,isNaN(this.curTrophyNode.x)&&(this.curTrophyNode.x=5),this.progressBarNode.getChildByName("bar").width=c):(this.progressBarNode.getChildByName("bar").width=this.progressBarNode.width,this.curTrophyNode.x=this.progressBarNode.width-5);this.curTrophyNode.getChildByName("CoinLabel").getComponent(cc.Label).string=a.toString()},t.prototype.onRefreshSociatySeasonEndTime=function(){var e=this.node.getChildByName("sociatyEndTimeLab").getComponent(cc.Label),t=y.ActivityTableData.getById(C.ACTIVITY_ID_ENUM.P_Activity_Anniversary),o=s.default.getServersTime(),i=t.param9-o;if(i<=0)return e.node.active=!1,void this.unschedule(this.onRefreshSociatySeasonEndTime);e.string="\u8ddd\u79bb\u6d3b\u52a8\u7ed3\u675f\u8fd8\u6709:"+function(e){var t=e%864e5/36e5,o=e%36e5/6e4,i=e%6e4/1e3;return parseInt((e/864e5).toString())+" \u5929 "+parseInt(t.toString())+" \u5c0f\u65f6 "+parseInt(o.toString())+" \u5206\u949f "+parseInt(i.toString())+" \u79d2 "}.call(this,1e3*i),0==e.node.active&&(e.node.active=!0)},t.prototype.initBoxInfo=function(){var e=this;this._scrollViewChildNode.forEach(function(e){e.destroy()}),this._scrollViewChildNode=[];var t=c.default.getViewByName("BattlePassRewardPreview");t&&t.view&&(t.view.node.active=!1,t.view.closeView());var o=this._curSeasonData,i=o.length,a=0;this.progressBarNode.active=!1,T.default.startFraming(i,function(){var t=cc.instantiate(e.itemPrefab);t.parent=e.progressBarNode,t.getComponent("FogHiddenBattlePassItem").show(o[a],e.m_itemNum),t.x=o[a].pointX,t.y=-50,t.active=!0,e._scrollViewChildNode.push(t),e.curTrophyNode.setSiblingIndex(99),++a==i&&(e.onScrollToPoint(),e.progressBarNode.active=!0)});var n=I.default.Instance.checkReceiveSociatyBoxPrize();this.node.getChildByName("DrawButton").getComponent(cc.Button).interactable=n.length>0,this.node.getChildByName("DrawButton").getComponent(cc.Button).enableAutoGrayEffect=!(n.length>0),this.initBoxProgress(),this.initCurGetWayInfo()},t.prototype.showRewards=function(e){var t=this,o=function(){var e=t.tRewards.slice(6*t.rewardCount,6*(t.rewardCount+1));e.length>0&&c.default.addPopView("BaseCtrl","AcquirePopupView","AcquirePopupView",{items:e,closeCb:function(){t.rewardCount++,o.call(t)}})};this.rewardCount=0,this.tRewards=e,o.call(this)},t.prototype.onTotalGetRewardCallBack=function(){var e=I.default.Instance.checkReceiveSociatyBoxPrize();if(e.length<=0)return l.G.StringManager.PopString(l.G.StringManager.getWorldString("common_prompt_not_rewards"));var t=new C.C_Activity_FogHiddenGetBoxsReward;t.getRewardsVec=e,g.ClientNetwork.getInstance().Send(C.ACTIVITY_CLIENT_ENUM.P_Activity_FogHiddenGetBoxsReward,t)},t.prototype.onBuyBattlePass=function(){var e={rechargeID:Number(h.getConfigIntValue("FogHidden_box_rechargeid")),rechargeNum:1};this.sendEvent("SendProtocolRecharge",e)},t.prototype.onScrollToPoint=function(){for(var e=!1,t=this.m_itemNum,o=0,i=this._curSeasonData.length;o<i;o++){var a=(m=this._curSeasonData[o]).coinNum,n=m.id;if(a){var r=this.m_itemNum,c=0,l=I.default.Instance.checkBoxReceiveState(n,1);0!=l&&l||r>=a&&(c=1);var d=0,u=I.default.Instance.checkBoxReceiveState(n,2);if(0!=u&&u||r>=a&&1==s.default.getRoleAttrValByKey(p.ROLE_ATTR_VALUES.ROLE_ATTR_FogHidden_BATTLEPASS)&&(d=1),1==c||1==d){var h=this.ScrollView.getMaxScrollOffset(),f=m.pointX>h.x?h.x:m.pointX;this.ScrollView.setContentPosition(cc.v2(-f+this.itemPrefab.width-180,0)),e=!0;break}}}if(0==e){var g=null;for(o=0,i=this._curSeasonData.length;o<i;o++){var m;(m=this._curSeasonData[o]).coinNum&&t>=m.coinNum&&(g=m)}g&&(h=this.ScrollView.getMaxScrollOffset(),f=g.pointX>h.x?h.x:g.pointX,this.ScrollView.setContentPosition(cc.v2(-f+this.itemPrefab.width-180,0)))}},t.prototype.onClickAddCallBack=function(){c.default.addPopView("BaseCtrl","FogHiddenBattlePassBuyView","FogHiddenBattlePassBuyView")},t.prototype.onCloseView=function(){this.closeView()},t.prototype.onHelpCallBack=function(){c.default.addPopView("BaseCtrl","FogHiddenBoxIntroduceView","FogHiddenBoxIntroduceView")},t.prototype.update_pass_currency=function(){if(this.node){var e=new f.C_Role_Get_Item_Num;e.itemId=this.m_ItemId,g.ClientNetwork.getInstance().Send(f.ROLE_CLIENT_ENUM.P_Role_Get_Item_Num,e);var t=c.default.getViewByName("FogHiddenBattlePassBuyView");t&&t.view&&t.view.closeView()}},t.prototype.onDestroy=function(){},n([w(cc.Node)],t.prototype,"itemPrefab",void 0),n([w(cc.ScrollView)],t.prototype,"ScrollView",void 0),n([w(cc.Node)],t.prototype,"progressBarNode",void 0),n([w(cc.Node)],t.prototype,"curTrophyNode",void 0),n([w(cc.Label)],t.prototype,"curGetWayLab",void 0),n([_.Register_Class,b],t)}(m.default);o.default=E,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/ActivityTableData":"ActivityTableData","../../StaticData/FogHiddenBoxTableData":"FogHiddenBoxTableData","../../StaticData/RechargeTableData":"RechargeTableData","../../common/EventConst":"EventConst","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/base/GameView":"GameView","../../modules/manager/EventManager":"EventManager","../../network/ClientNetwork":"ClientNetwork","../../network/protocol/ActivityProtocols":"ActivityProtocols","../../network/protocol/RechargeProtocols":"RechargeProtocols","../../network/protocol/RoleProtocols":"RoleProtocols","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils","../../view/fogHidden/FogHiddenModel":"FogHiddenModel"}],FogHiddenBoxIntroduceView:[function(e,t,o){"use strict";cc._RF.push(t,"069852aqLhC0IKCr6SW6svp","FogHiddenBoxIntroduceView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=cc._decorator,l=c.ccclass,d=(c.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.path=function(){return"ui/fogHidden/prefab/FoxHiddenBoxIntroduce"},n([s.Register_Class,l],t)}(r.default));o.default=d,cc._RF.pop()},{"../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators"}],FogHiddenBoxTableData:[function(e,t,o){"use strict";cc._RF.push(t,"da378mhSBBC06zKMJ/vVoWL","FogHiddenBoxTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.FogHiddenBoxTableData=void 0;var i=e("../TableReader"),a=e("./BaseTableData"),n=function(){function e(){this.id=0,this.coinNum=0,this.itemName="",this.itemIcon="",this.itemScale=0,this.extraItemName="",this.extraItemIcon="",this.extraItemScale=0,this.prize=new Array,this.extraPrize=new Array,this.pointX=0}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.coinNum=e.getNumber(),this.itemName=e.getString(),this.itemIcon=e.getString(),this.itemScale=e.getNumber(),this.extraItemName=e.getString(),this.extraItemIcon=e.getString(),this.extraItemScale=e.getNumber();for(var o=e.getString(),n=new i.TableReader(o);n.getPos()<n.getLen();)(s=new a.ItemInfo).readOriginal(n),this.prize.push(s);o=e.getString();for(var r=new i.TableReader(o);r.getPos()<r.getLen();){var s;(s=new a.ItemInfo).readOriginal(r),this.extraPrize.push(s)}this.pointX=e.getNumber()},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"FogHiddenBoxTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.FogHiddenBoxTableData=n,cc._RF.pop()},{"../TableReader":"TableReader","./BaseTableData":"BaseTableData"}],FogHiddenCtrl:[function(e,t,o){"use strict";cc._RF.push(t,"8a980Od0IJOibKg+4IjLlli","FogHiddenCtrl");var i=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var a=e("../../network/ClientNetwork"),n=e("../../network/protocol/ActivityProtocols"),r=e("../../Global/GameGlobal"),s=e("./FogHiddenModel"),c=e("../../common/EventConst"),l=e("../../modules/manager/EventManager"),d=cc._decorator.ccclass,u=function(){function e(){}return e.registerFogHiddenProtocol=function(){a.ClientNetwork.getInstance().listenProtocol(n.ACTIVITY_CLIENT_ENUM.P_Activity_SyncFogHiddenData,this.syncFogHiddenData,this)},e.syncFogHiddenData=function(e){e.resetPos();var t=new n.S_Activity_SyncFogHiddenData;t.read(e)&&(0==t.error?(s.default.Instance.syncFogHiddenData(t),l.default.Instance.emit(c.default.FogHidden_RefreshSurplusCount),l.default.Instance.emit(c.default.RefreshFogHiddenMainNodeInfo)):r.G.StringManager.PopString("\u540c\u6b65\u96fe\u9690\u4e4b\u5883\u6570\u636e\u9519\u8bef Error "+t.error))},i([d],e)}();o.default=u,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../common/EventConst":"EventConst","../../modules/manager/EventManager":"EventManager","../../network/ClientNetwork":"ClientNetwork","../../network/protocol/ActivityProtocols":"ActivityProtocols","./FogHiddenModel":"FogHiddenModel"}],FogHiddenHelpView:[function(e,t,o){"use strict";cc._RF.push(t,"06bb13afuZA9Zs16GGp1Y0L","FogHiddenHelpView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=cc._decorator,l=c.ccclass,d=(c.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.path=function(){return"ui/fogHidden/prefab/FogHiddenHelp"},n([s.Register_Class,l],t)}(r.default));o.default=d,cc._RF.pop()},{"../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators"}],FogHiddenMainView:[function(e,t,o){"use strict";cc._RF.push(t,"14a8eEmIHdG+pZTbqKf4RWr","FogHiddenMainView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=e("../../modules/manager/EventManager"),l=e("../../common/EventConst"),d=e("../../common/CommandValue"),u=e("../../modules/base/GameView"),h=e("../../network/protocol/TypeProtocols"),p=e("./FogHiddenModel"),f=e("../../Global/GameGlobal"),g=e("../../StaticData/ActivityTableData"),m=e("../../network/protocol/ActivityProtocols"),_=e("../../common/PlayerModule"),y=e("../../utils/GameUtils"),v=e("../../common/CommandValue"),C=cc._decorator,S=C.ccclass,T=C.property,I=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.m_chatNode=null,t.m_matchNode=null,t.m_assistBattleNode=null,t.m_surplusCountLab=null,t.m_surplusTimeLab=null,t.m_BoxRedpointNode=null,t.m_rankNode=null,t.m_bInitChatNode=!1,t}return a(t,e),t.path=function(){return"ui/fogHidden/prefab/FogHiddenMain"},t.prototype.onLoad=function(){var e=this;this.hideMainChatView(),c.default.Instance.on(l.default.FogHidden_RefreshSurplusCount,this.refreshAssistAndSurplusCount,this),c.default.Instance.on(l.default.RefreshFogHiddenBoxRedpoint,this.showBoxRedPoint,this),c.default.Instance.on(l.default.SyncFogHiddenRankOffState,function(t){e.m_rankNode.active=t},this)},t.prototype.start=function(){this.setChatViewVisible(!0),this.refreshAssistAndSurplusCount(),this.showBoxRedPoint(),this.onRefreshFogHiddenEndTime(),this.schedule(this.onRefreshFogHiddenEndTime,1),y.setLocalData("SaveFogHiddenRedFlag","1"),c.default.Instance.emit(l.default.SyncFogHiddenRankOffState,_.default.checkModulerOnOffState(v.ModulerViewOnOff.FogHiddenRank))},t.prototype.refreshAssistAndSurplusCount=function(){var e=p.default.Instance.getFogHiddenSurplusCount();e=e<0?0:e,this.m_surplusCountLab.string=e+"",this.m_matchNode.active=e>0,this.m_assistBattleNode.active=e<=0},t.prototype.showBoxRedPoint=function(){var e;e=p.default.Instance.checkBoxRedPoint(),this.m_BoxRedpointNode.active=e},t.prototype.onRefreshFogHiddenEndTime=function(){var e=this.m_surplusTimeLab,t=_.default.getServersTime(),o=g.ActivityTableData.getById(m.ACTIVITY_ID_ENUM.P_Activity_FogHidden).param9-t;if(o<=0)return this.unschedule(this.onRefreshFogHiddenEndTime),e.string="\u6d3b\u52a8\u5df2\u7ed3\u675f";e.string=f.G.StringManager.getString("ROYALE_ACTIVITY_END_TIME_TIP")+function(e){var t=e%864e5/36e5,i=e%36e5/6e4,a=e%6e4/1e3;return o>=86400?parseInt((e/864e5).toString())+" \u5929 "+parseInt(t.toString())+" \u5c0f\u65f6 "+parseInt(i.toString())+" \u5206 ":o>=3600?parseInt(t.toString())+" \u5c0f\u65f6 "+parseInt(i.toString())+" \u5206 "+parseInt(a.toString())+" \u79d2 ":o>=60?parseInt(i.toString())+" \u5206 "+parseInt(a.toString())+" \u79d2 ":parseInt(a.toString())+" \u79d2 "}.call(this,1e3*o)},t.prototype.hideMainChatView=function(){c.default.Instance.emit(l.default.SyncChatViewChange,d.ChatViewVisible.Retracting)},t.prototype.setChatViewVisible=function(e){1==e?this.initChatView():this.destroyChatView()},t.prototype.initChatView=function(){var e=u.default.getViewByName("MainSceneView");if(e&&e.view){e.view.onSetChatBtnNodeActive(!1);var t=e.view.getMainChatNode();if(cc.isValid(t)){t.parent=this.node;var o=t.getChildByName("chatMain").getComponent("ChatMainView");o.setShowChannelTab([h.CHAT_CHANNEL_GROUP_TYPE.CHAT_CHANNEL_ACTICITY_GROUP,h.CHAT_CHANNEL_GROUP_TYPE.CHAT_CHANNEL_PRIVATE_GROUP]),o.setChatChannel(h.CHAT_CHANNEL_GROUP_TYPE.CHAT_CHANNEL_ACTICITY_GROUP),this.m_bInitChatNode=!0}}this.m_chatNode.active=!0},t.prototype.destroyChatView=function(){this.m_chatNode.active=!1},t.prototype.onClickChatBtnCallBack=function(){0!=this.m_bInitChatNode&&c.default.Instance.emit(l.default.SyncChatViewChange,[d.ChatViewVisible.Popup,h.CHAT_CHANNEL_GROUP_TYPE.CHAT_CHANNEL_ACTICITY_GROUP])},t.prototype.onSetChatMsg=function(e){if(e.length<=0)return this.m_chatNode.getChildByName("msgNode").active=!1;var t=this.m_chatNode.getChildByName("msgNode"),o=t.getChildByName("label_chat"),i=t.getChildByName("label_chatDotLab");o.getComponent(cc.Label).string=e,i.active=!1,e.length>9&&(i.active=!0),t.active=!0},t.prototype.onSetChatRedpoint=function(e){this.m_chatNode.getChildByName("msgNode").parent.children[1].children[0].active=e},t.prototype.checkActivityIsEnd=function(){var e=_.default.getServersTime(),t=p.default.Instance.getFogHiddenTime();return!t||t.length<=0||t[1]-e<=0},t.prototype.onClickMatchCallBack=function(){var e=g.ActivityTableData.getById(m.ACTIVITY_ID_ENUM.P_Activity_FogHidden).param1;return _.default.getRoleAttrValByKey(h.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE)<e?f.G.StringManager.PopString(f.G.StringManager.getString("FOG_HIDDEN_ACTIVITY_TIPS1",e)):0==p.default.Instance.checkFogHiddenOpenState()?f.G.StringManager.PopString(f.G.StringManager.getString("FOG_HIDDEN_ACTIVITY_TIPS2")):1==this.checkActivityIsEnd()?f.G.StringManager.PopString(f.G.StringManager.getString("FOG_HIDDEN_ACTIVITY_TIPS2")):void u.default.addPopView("BaseCtrl","BattleRoomMainView","BattleRoomMainView",{CombatType:4})},t.prototype.onClickAssistBattleCallBack=function(){if(0==p.default.Instance.checkFogHiddenOpenState())return f.G.StringManager.PopString(f.G.StringManager.getString("FOG_HIDDEN_ACTIVITY_TIPS2"));if(1==this.checkActivityIsEnd())return f.G.StringManager.PopString(f.G.StringManager.getString("FOG_HIDDEN_ACTIVITY_TIPS2"));var e=f.G.StringManager.getString("FOG_HIDDEN_ACTIVITY_TIPS4");u.default.addPopView("BaseCtrl","AssistBattleView","AssistBattleView",{fightType:h.FIGHT_TYPE.FIGHT_TYPE_FOG_HIDDEN,title:e.split("|")[0],tips:e.split("|")[1]})},t.prototype.onClickCloseCallBack=function(){this.destroyChatView(),this.hideMainChatView(),this.closeView()},t.prototype.onClickHelpCallBack=function(){u.default.addPopView("BaseCtrl","FogHiddenHelpView","FogHiddenHelpView")},t.prototype.onClickRewardPreviewCallBack=function(){u.default.addPopView("BaseCtrl","FogHiddenRewardsView","FogHiddenRewardsView")},t.prototype.onClickShopCallBack=function(){u.default.addPopView("BaseCtrl","FogHiddenShopView","FogHiddenShopView")},t.prototype.onClickRankCallBack=function(){u.default.addPopView("BaseCtrl","FogHiddenRankView","FogHiddenRankView")},t.prototype.onClickBoxCallBack=function(){u.default.addPopView("ShopMainCtrl","FogHiddenBattlePassView","FogHiddenBattlePassView")},t.prototype.onClickRechargeCallBack=function(){u.default.addPopView("ShopMainCtrl","FogHiddenRechargeView","FogHiddenRechargeView")},t.prototype.update=function(){0==this.m_bInitChatNode&&this.initChatView()},t.prototype.onDestroy=function(){c.default.Instance.emit(l.default.RefreshFogHiddenMainNodeInfo),c.default.Instance.off(this,l.default.FogHidden_RefreshSurplusCount),c.default.Instance.off(this,l.default.RefreshFogHiddenBoxRedpoint),c.default.Instance.off(this,l.default.SyncFogHiddenRankOffState)},n([T(cc.Node)],t.prototype,"m_chatNode",void 0),n([T(cc.Node)],t.prototype,"m_matchNode",void 0),n([T(cc.Node)],t.prototype,"m_assistBattleNode",void 0),n([T(cc.Label)],t.prototype,"m_surplusCountLab",void 0),n([T(cc.Label)],t.prototype,"m_surplusTimeLab",void 0),n([T(cc.Node)],t.prototype,"m_BoxRedpointNode",void 0),n([T(cc.Node)],t.prototype,"m_rankNode",void 0),n([s.Register_Class,S],t)}(r.default);o.default=I,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/ActivityTableData":"ActivityTableData","../../common/CommandValue":"CommandValue","../../common/EventConst":"EventConst","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/base/GameView":"GameView","../../modules/manager/EventManager":"EventManager","../../network/protocol/ActivityProtocols":"ActivityProtocols","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/GameUtils":"GameUtils","./FogHiddenModel":"FogHiddenModel"}],FogHiddenModel:[function(e,t,o){"use strict";cc._RF.push(t,"04c0ejTAedJurQx/xy4fRYG","FogHiddenModel");var i=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var a=e("../../common/PlayerModule"),n=e("../../common/CommandValue"),r=e("../../StaticData/ActivityTableData"),s=e("../../StaticData/FogHiddenBoxTableData"),c=e("../../network/protocol/ActivityProtocols"),l=e("../../utils/GameUtils"),d=e("../../network/protocol/TypeProtocols"),u=e("../../network/protocol/ActivityProtocols"),h=e("../../utils/GameUtils"),p=cc._decorator.ccclass,f=function(){function e(){this.m_tFogHiddenData=null}var t;return t=e,Object.defineProperty(e,"Instance",{get:function(){return null==t._instance&&(t._instance=new t),t._instance},enumerable:!1,configurable:!0}),e.prototype.syncFogHiddenData=function(e){this.m_tFogHiddenData=e},e.prototype.FogHiddenBoxData=function(){return this.m_tFogHiddenData},e.prototype.getFogHiddenTime=function(){var e=new Array,t=r.ActivityTableData.getById(c.ACTIVITY_ID_ENUM.P_Activity_FogHidden);return e.push(t.param8),e.push(t.param9),e},e.prototype.checkFogHiddenOpenState=function(){return!!this.m_tFogHiddenData&&this.m_tFogHiddenData.isOpen},e.prototype.getFogHiddenSurplusCount=function(){return this.m_tFogHiddenData?r.ActivityTableData.getById(c.ACTIVITY_ID_ENUM.P_Activity_FogHidden).param3-this.m_tFogHiddenData.failcount:0},e.prototype.getFogHiddenButtonActiveState=function(){var e=this.checkFogHiddenOpenState(),t=a.default.checkModulerOnOffState(n.ModulerViewOnOff.FogHidden);return 1==e&&1==t},e.prototype.checkBoxRedPoint=function(){if(0==this.m_tFogHiddenData.isOpen)return!1;var e=this.checkReceiveSociatyBoxPrize();return!!e&&e.length>0},e.prototype.checkReceiveSociatyBoxPrize=function(){var e=this,t=[],o=Number(l.getConfigIntValue("FogHidden_box_coin_itemId")),i=a.default.getItemCountByBag(o),n=[];return s.FogHiddenBoxTableData.getDataMap().forEach(function(e){n.push(e)}),n.forEach(function(o){var n=0,r=e.checkBoxReceiveState(o.id,1);0!=r&&r||i>=o.coinNum&&(n=1);var s,c=0,l=e.checkBoxReceiveState(o.id,2);0!=l&&l||i>=o.coinNum&&1==a.default.getRoleAttrValByKey(d.ROLE_ATTR_VALUES.ROLE_ATTR_FogHidden_BATTLEPASS)&&(c=1),1==n&&((s=new u.T_Activity_FogHiddenGetBoxsData).index=o.id,s.type=1,t.push(s)),1==c&&((s=new u.T_Activity_FogHiddenGetBoxsData).index=o.id,s.type=2,t.push(s))}),t},e.prototype.checkBoxReceiveState=function(e,t){if(!this.m_tFogHiddenData)return!1;var o=this.m_tFogHiddenData.normalPrize;return 2==t&&(o=this.m_tFogHiddenData.superprize),!!o.has(e)&&o.get(e)},e.prototype.checkFogHiddenRedpointState=function(){if(0==this.checkFogHiddenOpenState())return!1;if(this.getFogHiddenSurplusCount()>0){var e=h.getLocalData("SaveFogHiddenRedFlag");if(e&&"0"==e)return!0}return 1==this.checkBoxRedPoint()},e._instance=null,t=i([p],e)}();o.default=f,cc._RF.pop()},{"../../StaticData/ActivityTableData":"ActivityTableData","../../StaticData/FogHiddenBoxTableData":"FogHiddenBoxTableData","../../common/CommandValue":"CommandValue","../../common/PlayerModule":"PlayerModule","../../network/protocol/ActivityProtocols":"ActivityProtocols","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/GameUtils":"GameUtils"}],FogHiddenPrizeTableData:[function(e,t,o){"use strict";cc._RF.push(t,"0b7f1D9IdtF3IKzzwQvQS+K","FogHiddenPrizeTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.FogHiddenPrizeTableData=void 0;var i=e("../TableReader"),a=e("./BaseTableData"),n=function(){function e(){this.id=0,this.winPrize=new Array,this.lostPrize=new Array,this.helpPrize=new Array}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber();for(var o=e.getString(),n=new i.TableReader(o);n.getPos()<n.getLen();)(c=new a.DropItem).readOriginal(n),this.winPrize.push(c);o=e.getString();for(var r=new i.TableReader(o);r.getPos()<r.getLen();)(c=new a.DropItem).readOriginal(r),this.lostPrize.push(c);o=e.getString();for(var s=new i.TableReader(o);s.getPos()<s.getLen();){var c;(c=new a.DropItem).readOriginal(s),this.helpPrize.push(c)}},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"FogHiddenPrizeTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.FogHiddenPrizeTableData=n,cc._RF.pop()},{"../TableReader":"TableReader","./BaseTableData":"BaseTableData"}],FogHiddenRankView:[function(e,t,o){"use strict";cc._RF.push(t,"2e49bZo5c5LBpdfxlkv7iHv","FogHiddenRankView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=e("../../utils/GameTools"),l=e("../../network/protocol/TypeProtocols"),d=e("../../common/PlayerModule"),u=e("../../utils/List"),h=e("../../Global/GameGlobal"),p=cc._decorator,f=p.ccclass,g=p.property,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.m_RankListPanelNode=null,t.m_MyRankInfoNode=null,t.m_selectRankTabName="",t.m_tRankListData=[],t.m_nRankPageIdx=1,t.m_nRankMaxPage=0,t.m_curRankType=l.RANKLIST_TYPE.RANKLIST_TYPE_FOGHIDDEN3,t}return a(t,e),t.path=function(){return"ui/fogHidden/prefab/FoxHiddenRank"},t.prototype.start=function(){this.callRank(),this.m_RankListPanelNode.node.on("bounce-bottom",this.onScrollBottom,this)},t.prototype.onScrollBottom=function(){this.m_nRankPageIdx>=this.m_nRankMaxPage||(this.m_nRankPageIdx++,this.callRank())},t.prototype.callRank=function(){var e=this,t=c.default.getDevelopRankListUrl(),o=d.default.uuidTransformRoieId();t+="?",t+="ranktype="+this.m_curRankType,t+="&roleid="+o,t+="&page="+this.m_nRankPageIdx;var i=new XMLHttpRequest;i.onreadystatechange=function(){if(4==i.readyState&&i.status>=200&&i.status<400){var t=i.responseText.toString();t=(t=(t=t.replace('"','"')).replace("\ufeff","")).replace(" ","");var o=JSON.parse(t),a=o.page;e.m_nRankMaxPage=o.maxpage,0!=a&&0!=e.m_nRankMaxPage||(e.m_MyRankInfoNode.active=!1),Number(o.ranktype)==e.m_curRankType&&Number(a)==e.m_nRankPageIdx&&e.resolvingRankData(o)}},i.timeout=3e3,i.ontimeout=function(){cc.isValid(e)&&h.G.StringManager.PopString("\u6392\u884c\u699c\u8bf7\u6c42\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\uff01")},i.onerror=function(){cc.isValid(e)&&h.G.StringManager.PopString("\u6392\u884c\u699c\u8bf7\u6c42\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\uff01")},i.open("GET",t,!0),i.send()},t.prototype.resolvingRankData=function(e){1==Number(e.page)&&(this.m_tRankListData=[]),this.m_MyRankInfoNode.active=!0;var t=this.m_MyRankInfoNode.getChildByName("my_rank_num").getComponent(cc.Label);t.string=h.G.StringManager.getString("NO_RANK");var o=this.m_MyRankInfoNode.getChildByName("my_score_label").getComponent(cc.Label),i=0;if("playerrank"in e&&(t.string=e.playerrank,"playerdata"in e&&(i=JSON.parse(e.playerdata).totaltime)),o.string=function(e){var t=e%864e5/36e5,o=e%36e5/6e4,i=e%6e4/1e3;return parseInt(t.toString())>0?parseInt(t.toString())+" \u65f6 "+parseInt(o.toString())+" \u5206 "+i+" \u79d2 ":parseInt(o.toString())+" \u5206 "+i+" \u79d2 "}.call(this,1e3*i),o.node.active=!(i<=0),this.m_curRankType==l.RANKLIST_TYPE.RANKLIST_TYPE_FOGHIDDEN1?(this.m_MyRankInfoNode.getChildByName("my_score_sprite1").active=!0,this.m_MyRankInfoNode.getChildByName("my_score_sprite2").active=!1,this.m_MyRankInfoNode.getChildByName("my_score_sprite3").active=!1,i<=0&&(this.m_MyRankInfoNode.getChildByName("my_score_sprite1").active=!1)):this.m_curRankType==l.RANKLIST_TYPE.RANKLIST_TYPE_FOGHIDDEN2?(this.m_MyRankInfoNode.getChildByName("my_score_sprite1").active=!1,this.m_MyRankInfoNode.getChildByName("my_score_sprite2").active=!0,this.m_MyRankInfoNode.getChildByName("my_score_sprite3").active=!1,i<=0&&(this.m_MyRankInfoNode.getChildByName("my_score_sprite2").active=!1)):this.m_curRankType==l.RANKLIST_TYPE.RANKLIST_TYPE_FOGHIDDEN2&&(this.m_MyRankInfoNode.getChildByName("my_score_sprite1").active=!1,this.m_MyRankInfoNode.getChildByName("my_score_sprite2").active=!1,this.m_MyRankInfoNode.getChildByName("my_score_sprite3").active=!0,i<=0&&(this.m_MyRankInfoNode.getChildByName("my_score_sprite3").active=!1)),"ranklist"in e){var a=e.ranklist;for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&this.m_tRankListData.push(a[n])}this.m_RankListPanelNode.numItems=this.m_tRankListData.length},t.prototype.onRefreshRankEvent=function(e,t){var o=this.m_tRankListData[t];e.getComponent("RankListItem").initData(this.m_curRankType,t+1,o)},t.prototype.onClickRedStarRankTabCallBack=function(){"RedStarRank"!=this.m_selectRankTabName&&(this.m_selectRankTabName="RedStarRank",this.m_curRankType=l.RANKLIST_TYPE.RANKLIST_TYPE_FOGHIDDEN3,this.m_nRankPageIdx=1,this.m_RankListPanelNode.scrollTo(-1,.1),this.m_RankListPanelNode.numItems=0,this.callRank())},t.prototype.onClickGoldStarRankTabCallBack=function(){"GoldStarRank"!=this.m_selectRankTabName&&(this.m_selectRankTabName="GoldStarRank",this.m_curRankType=l.RANKLIST_TYPE.RANKLIST_TYPE_FOGHIDDEN1,this.m_nRankPageIdx=1,this.m_RankListPanelNode.scrollTo(-1,.1),this.m_RankListPanelNode.numItems=0,this.callRank())},t.prototype.onClickPurpleStarRankTabCallBack=function(){"PurpleStarRank"!=this.m_selectRankTabName&&(this.m_selectRankTabName="PurpleStarRank",this.m_curRankType=l.RANKLIST_TYPE.RANKLIST_TYPE_FOGHIDDEN2,this.m_nRankPageIdx=1,this.m_RankListPanelNode.scrollTo(-1,.1),this.m_RankListPanelNode.numItems=0,this.callRank())},n([g(u.default)],t.prototype,"m_RankListPanelNode",void 0),n([g(cc.Node)],t.prototype,"m_MyRankInfoNode",void 0),n([s.Register_Class,f],t)}(r.default);o.default=m,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/GameTools":"GameTools","../../utils/List":"List"}],FogHiddenRechargeView:[function(e,t,o){"use strict";cc._RF.push(t,"f7363S8w0JN56h7OnC1CPa8","FogHiddenRechargeView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../common/PlayerModule"),s=e("../../Global/GameGlobal"),c=e("../../modules/base/BaseView"),l=e("../../modules/base/Decorators"),d=e("../../modules/base/GameView"),u=e("../../network/ClientNetwork"),h=e("../../network/protocol/RechargeProtocols"),p=e("../../network/protocol/RoleProtocols"),f=e("../../StaticData/LuckyGiftSelectTableData"),g=e("../../StaticData/RechargeTableData"),m=e("../../utils/ConfigUtils"),_=e("../../utils/GameTools"),y=e("../../utils/GameUtils"),v=cc._decorator,C=v.ccclass,S=v.property,T=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.m_btn_buy=null,t.m_btn_buy2=null,t.m_btn_buy3=null,t.m_box1=null,t.m_box2=null,t.m_box3=null,t.rechargeId_buy1=0,t.rechargeId_buy2=0,t.rechargeId_buy3=0,t.select_index=0,t}return a(t,e),t.path=function(){return"ui/fogHidden/prefab/FoxHiddenRecharge"},t.prototype.onLoad=function(){},t.prototype.start=function(){var e=this;u.ClientNetwork.getInstance().listenProtocol(h.RECHARGE_CLIENT_ENUM.P_Recharge_Role_Recharge,function(){e.initBuyViewDay1(),e.initBuyViewDay2(),e.initBuyViewDay3()},this),u.ClientNetwork.getInstance().listenProtocol(p.ROLE_CLIENT_ENUM.P_Role_SetSelfSelect,function(){1==e.select_index?e.initBuyViewDay1():2==e.select_index?e.initBuyViewDay2():e.initBuyViewDay3()},this),this.initBuyViewDay1(),this.initBuyViewDay2(),this.initBuyViewDay3();for(var t=function(t){_.default.registerTouchEvent(o.node.getChildByName("newBoxRechargeNode").getChildByName("box"+t).getChildByName("select"),function(){var o=35+t,i=r.default.getRoleRechargeData().get(o),a=g.RechargeTableData.getById(o);if(i&&i.dayNum>a.limitMaxDayNum)return s.G.StringManager.PopString("\u60a8\u5df2\u8d2d\u4e70\u8fc7\u8be5\u793c\u5305\uff0c\u65e0\u6cd5\u9009\u62e9");var n=y.getConfigIntValue("battlePass_choose_gold");2==t&&(n="6003");var c=f.LuckyGiftSelectTableData.getById(Number(n)).prize;c=y.clone(c),e.select_index=t,c.forEach(function(e){var t=Number(y.getConfigIntValue("SelfSelect_"+o));e.itemNum=null!=t?t:1});for(var l=c.length-1;l>=0;l--)2!=m.default.getInstance().getItemByID(c[l].itemID).type&&c.splice(l,1);d.default.addPopView("BaseCtrl","LuckyGiftSelectRewardView","LuckyGiftSelectRewardView",{tRewards:c,index:o,isEveryDayReacharge:!1,parent:e,callBack:function(e,t){if(0!=e){var o=new p.C_Role_SetSelfSelect;o.type=t,o.selectItemId=e,u.ClientNetwork.getInstance().Send(p.ROLE_CLIENT_ENUM.P_Role_SetSelfSelect,o)}else s.G.StringManager.PopString("\u672a\u9009\u62e9\u91d1\u5361")}})})},o=this,i=1;i<4;i++)t(i)},t.prototype.initBuyViewDay1=function(){var e=this;this.m_box1.getChildByName("boxReward").removeAllChildren();var t=g.RechargeTableData.getById(36);if(null!=t){t.prize.forEach(function(t){var o=m.default.getInstance().getDorpItemsByID(t.dropID);if(o)for(var i=o.dropRandom.split("|"),a=function(t){var o=i[t].split("#"),a=o[0],n=o[1]!=o[2]?"x"+o[1]+"~"+o[2]:"x"+o[1];_.default.createNormalItemsWithNames(a,-1,e.m_box1.getChildByName("boxReward"),function(e){e.getChildByName("txt_name").getComponent(cc.Label).string=n})},n=0;n<i.length;n++)a(n)});var o=_.default.getRechargeMoneyByPlatform(t)/100;this.rechargeId_buy1=36;var i=r.default.getRoleRechargeData().get(this.rechargeId_buy1);null!=i&&i.dayNum>t.limitMaxDayNum?(this.m_btn_buy.getComponent(cc.Button).interactable=!1,this.m_btn_buy.getChildByName("label").getComponent(cc.Label).string=s.G.StringManager.getWorldString("word_yishouwan")):(this.m_btn_buy.getComponent(cc.Button).interactable=!0,this.m_btn_buy.getChildByName("label").getComponent(cc.Label).string=s.G.StringManager.getString("SUPER_SALE_MONEY",o));var a=t.limitMaxNum;if(a<=0)this.node.getChildByName("newBoxRechargeNode").getChildByName("limit1").active=!1;else{var n=null!=i?i.totalNum:0;this.node.getChildByName("newBoxRechargeNode").getChildByName("limit1").active=!0,this.node.getChildByName("newBoxRechargeNode").getChildByName("limit1").getChildByName("label_limit").getComponent(cc.Label).string=s.G.StringManager.getWorldString("word_xiangou")+a+"\u6b21("+n+"/"+a+")"}var c=r.default.getRoleInfoData().selfSelectMap.get(36);if(null==c||c<=0)this.m_box1.getChildByName("select").getChildByName("player").active=!0,this.m_box1.getChildByName("select").getChildByName("changeIcon").active=!1,this.m_box1.getChildByName("select").getChildByName("txt").getComponent(cc.Label).string="";else{this.m_box1.getChildByName("select").getChildByName("player").active=!1,this.m_box1.getChildByName("select").getChildByName("changeIcon").active=!0;var l=m.default.getInstance().getItemByID(c);y.setTexture(this.m_box1.getChildByName("select").getChildByName("headframe").getComponent(cc.Sprite),l.icon);var d=y.getConfigIntValue("SelfSelect_36");this.m_box1.getChildByName("select").getChildByName("txt").getComponent(cc.Label).string="x"+d}}},t.prototype.showSecectRwd=function(e,t){if(0!=e){var o=e;if(o<=0)this.node.getChildByName("newBoxRechargeNode").getChildByName("box"+t).getChildByName("select").getChildByName("player").active=!0,this.node.getChildByName("newBoxRechargeNode").getChildByName("box"+t).getChildByName("select").getChildByName("changeIcon").active=!1,this.node.getChildByName("newBoxRechargeNode").getChildByName("box"+t).getChildByName("select").getChildByName("txt").getComponent(cc.Label).string="";else{this.node.getChildByName("newBoxRechargeNode").getChildByName("box"+t).getChildByName("select").getChildByName("player").active=!1,this.node.getChildByName("newBoxRechargeNode").getChildByName("box"+t).getChildByName("select").getChildByName("changeIcon").active=!0;var i=m.default.getInstance().getItemByID(o);y.setTexture(this.node.getChildByName("newBoxRechargeNode").getChildByName("box"+t).getChildByName("select").getChildByName("headframe").getComponent(cc.Sprite),i.icon);var a=y.getConfigIntValue("skyCastle_select_recharge_rewardNum");this.node.getChildByName("newBoxRechargeNode").getChildByName("box"+t).getChildByName("select").getChildByName("txt").getComponent(cc.Label).string="x"+a}}},t.prototype.initBuyViewDay2=function(){var e=this;this.m_box2.getChildByName("boxReward").removeAllChildren();var t=g.RechargeTableData.getById(37);if(null!=t){t.prize.forEach(function(t){var o=m.default.getInstance().getDorpItemsByID(t.dropID);if(o)for(var i=o.dropRandom.split("|"),a=function(t){var o=i[t].split("#"),a=o[0],n=o[1]!=o[2]?"x"+o[1]+"~"+o[2]:"x"+o[1];_.default.createNormalItemsWithNames(a,-1,e.m_box2.getChildByName("boxReward"),function(e){e.getChildByName("txt_name").getComponent(cc.Label).string=n})},n=0;n<i.length;n++)a(n)});var o=_.default.getRechargeMoneyByPlatform(t)/100;this.rechargeId_buy2=37;var i=r.default.getRoleRechargeData().get(this.rechargeId_buy2);null!=i&&i.dayNum>t.limitMaxDayNum?(this.m_btn_buy2.getComponent(cc.Button).interactable=!1,this.m_btn_buy2.getChildByName("label").getComponent(cc.Label).string=s.G.StringManager.getWorldString("word_yishouwan")):(this.m_btn_buy2.getComponent(cc.Button).interactable=!0,this.m_btn_buy2.getChildByName("label").getComponent(cc.Label).string=s.G.StringManager.getString("SUPER_SALE_MONEY",o));var a=t.limitMaxNum;if(a<=0)this.node.getChildByName("newBoxRechargeNode").getChildByName("limit2").active=!1;else{var n=null!=i?i.totalNum:0;this.node.getChildByName("newBoxRechargeNode").getChildByName("limit2").active=!0,this.node.getChildByName("newBoxRechargeNode").getChildByName("limit2").getChildByName("label_limit").getComponent(cc.Label).string=s.G.StringManager.getWorldString("word_xiangou")+a+"\u6b21("+n+"/"+a+")"}var c=r.default.getRoleInfoData().selfSelectMap.get(37);if(null==c||c<=0)this.m_box2.getChildByName("select").getChildByName("player").active=!0,this.m_box2.getChildByName("select").getChildByName("changeIcon").active=!1,this.m_box2.getChildByName("select").getChildByName("txt").getComponent(cc.Label).string="";else{this.m_box2.getChildByName("select").getChildByName("player").active=!1,this.m_box2.getChildByName("select").getChildByName("changeIcon").active=!0;var l=m.default.getInstance().getItemByID(c);y.setTexture(this.m_box2.getChildByName("select").getChildByName("headframe").getComponent(cc.Sprite),l.icon);var d=y.getConfigIntValue("SelfSelect_37");this.m_box2.getChildByName("select").getChildByName("txt").getComponent(cc.Label).string="x"+d}}},t.prototype.initBuyViewDay3=function(){var e=this;this.m_box3.getChildByName("boxReward").removeAllChildren();var t=g.RechargeTableData.getById(38);if(null!=t){t.prize.forEach(function(t){var o=m.default.getInstance().getDorpItemsByID(t.dropID);if(o)for(var i=o.dropRandom.split("|"),a=function(t){var o=i[t].split("#"),a=o[0],n=o[1]!=o[2]?"x"+o[1]+"~"+o[2]:"x"+o[1];_.default.createNormalItemsWithNames(a,-1,e.m_box3.getChildByName("boxReward"),function(e){e.getChildByName("txt_name").getComponent(cc.Label).string=n})},n=0;n<i.length;n++)a(n)});var o=_.default.getRechargeMoneyByPlatform(t)/100;this.rechargeId_buy3=38;var i=r.default.getRoleRechargeData().get(this.rechargeId_buy3);null!=i&&i.dayNum>t.limitMaxDayNum?(this.m_btn_buy3.getComponent(cc.Button).interactable=!1,this.m_btn_buy3.getChildByName("label").getComponent(cc.Label).string=s.G.StringManager.getWorldString("word_yishouwan")):(this.m_btn_buy3.getComponent(cc.Button).interactable=!0,this.m_btn_buy3.getChildByName("label").getComponent(cc.Label).string=s.G.StringManager.getString("SUPER_SALE_MONEY",o));var a=t.limitMaxNum;if(a<=0)this.node.getChildByName("newBoxRechargeNode").getChildByName("limit3").active=!1;else{var n=null!=i?i.totalNum:0;this.node.getChildByName("newBoxRechargeNode").getChildByName("limit3").active=!0,this.node.getChildByName("newBoxRechargeNode").getChildByName("limit3").getChildByName("label_limit").getComponent(cc.Label).string="\u9650\u8d2d"+a+"\u6b21("+n+"/"+a+")"}var c=r.default.getRoleInfoData().selfSelectMap.get(38);if(null==c||c<=0)this.m_box3.getChildByName("select").getChildByName("player").active=!0,this.m_box3.getChildByName("select").getChildByName("changeIcon").active=!1,this.m_box3.getChildByName("select").getChildByName("txt").getComponent(cc.Label).string="";else{this.m_box3.getChildByName("select").getChildByName("player").active=!1,this.m_box3.getChildByName("select").getChildByName("changeIcon").active=!0;var l=m.default.getInstance().getItemByID(c);y.setTexture(this.m_box3.getChildByName("select").getChildByName("headframe").getComponent(cc.Sprite),l.icon);var d=y.getConfigIntValue("SelfSelect_38");this.m_box3.getChildByName("select").getChildByName("txt").getComponent(cc.Label).string="x"+d}}},t.prototype.onClickBuy=function(){var e=this,t=this.rechargeId_buy1,o=(r.default.getRoleRechargeData().get(t),r.default.getRoleInfoData().selfSelectMap.get(t));if(null==o||o<=0)return s.G.StringManager.PopString(s.G.StringManager.getString("EVERYDAY_RECHARGE"));var i=function(){var o={rechargeID:t,rechargeNum:1};e.sendEvent("SendProtocolRecharge",o)};d.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:s.G.StringManager.getString("BUY_EVERYDAYRECHARGE_LASTDAY"),confirmCb:function(){i.call(e)}})},t.prototype.onClickBuy2=function(){var e=this,t=this.rechargeId_buy2,o=(r.default.getRoleRechargeData().get(t),r.default.getRoleInfoData().selfSelectMap.get(t));if(null==o||o<=0)return s.G.StringManager.PopString(s.G.StringManager.getString("EVERYDAY_RECHARGE"));var i=function(){var o={rechargeID:t,rechargeNum:1};e.sendEvent("SendProtocolRecharge",o)};d.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:s.G.StringManager.getString("BUY_EVERYDAYRECHARGE_LASTDAY"),confirmCb:function(){i.call(e)}})},t.prototype.onClickBuy3=function(){var e=this,t=this.rechargeId_buy3,o=(r.default.getRoleRechargeData().get(t),r.default.getRoleInfoData().selfSelectMap.get(t));if(null==o||o<=0)return s.G.StringManager.PopString(s.G.StringManager.getString("EVERYDAY_RECHARGE"));var i=function(){var o={rechargeID:t,rechargeNum:1};e.sendEvent("SendProtocolRecharge",o)};d.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:s.G.StringManager.getString("BUY_EVERYDAYRECHARGE_LASTDAY"),confirmCb:function(){i.call(e)}})},n([S(cc.Node)],t.prototype,"m_btn_buy",void 0),n([S(cc.Node)],t.prototype,"m_btn_buy2",void 0),n([S(cc.Node)],t.prototype,"m_btn_buy3",void 0),n([S(cc.Node)],t.prototype,"m_box1",void 0),n([S(cc.Node)],t.prototype,"m_box2",void 0),n([S(cc.Node)],t.prototype,"m_box3",void 0),n([l.Register_Class,C],t)}(c.default);o.default=T,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/LuckyGiftSelectTableData":"LuckyGiftSelectTableData","../../StaticData/RechargeTableData":"RechargeTableData","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/base/GameView":"GameView","../../network/ClientNetwork":"ClientNetwork","../../network/protocol/RechargeProtocols":"RechargeProtocols","../../network/protocol/RoleProtocols":"RoleProtocols","../../utils/ConfigUtils":"ConfigUtils","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils"}],FogHiddenRewardsView:[function(e,t,o){"use strict";cc._RF.push(t,"ee223/mJjxF9aCr2mDQgagK","FogHiddenRewardsView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=e("../../StaticData/FogHiddenPrizeTableData"),l=e("../../utils/ResourcesManager"),d=e("../../utils/GameTools"),u=cc._decorator,h=u.ccclass,p=u.property,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.m_scrollViewItemNode=null,t.m_scrollView=null,t}return a(t,e),t.path=function(){return"ui/fogHidden/prefab/FogHiddenRewards"},t.prototype.start=function(){this.initScrollRewardList()},t.prototype.initScrollRewardList=function(){var e=this,t=new Map;c.FogHiddenPrizeTableData.getDataMap().forEach(function(e,o){o>=2&&t.set(e.id+"",e.winPrize)}),t.set("\u672a\u901a\u5173",c.FogHiddenPrizeTableData.getById(c.FogHiddenPrizeTableData.getDataMap().size-1).lostPrize),t.forEach(function(t,o){e.initItemInfo(t,o)})},t.prototype.initItemInfo=function(e,t){var o=cc.instantiate(this.m_scrollViewItemNode);o.parent=this.m_scrollView.content,o.active=!0;var i=o.children[1];t.length<=1&&l.default.loadSprite(["ui/star/0","ui/star/0","ui/star/0","ui/star/4","ui/star/3","ui/star/2","ui/star/1"][Number(t)],i.children[0].getComponent(cc.Sprite)),"\u672a\u901a\u5173"==t?(i.children[0].active=!1,i.children[1].active=!1,i.children[2].active=!1,i.children[3].active=!0):(i.children[0].active=!0,i.children[1].active=!0,i.children[2].active=!0,i.children[3].active=!1),i.children[2].getComponent(cc.Label).string=t;for(var a=0;a<e.length;a++)d.default.createNormalItems(e[a].dropID,e[a].dropNum,o.children[0],function(e){e.scale=.8})},n([p(cc.Node)],t.prototype,"m_scrollViewItemNode",void 0),n([p(cc.ScrollView)],t.prototype,"m_scrollView",void 0),n([s.Register_Class,h],t)}(r.default);o.default=f,cc._RF.pop()},{"../../StaticData/FogHiddenPrizeTableData":"FogHiddenPrizeTableData","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../utils/GameTools":"GameTools","../../utils/ResourcesManager":"ResourcesManager"}],FogHiddenShopIntroduceView:[function(e,t,o){"use strict";cc._RF.push(t,"60049cr42tHlLcPuhyOozke","FogHiddenShopIntroduceView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=cc._decorator,l=c.ccclass,d=(c.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.path=function(){return"ui/fogHidden/prefab/FoxHiddenShopIntroduce"},n([s.Register_Class,l],t)}(r.default));o.default=d,cc._RF.pop()},{"../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators"}],FogHiddenShopView:[function(e,t,o){"use strict";cc._RF.push(t,"1497c2Zr1RML75SmQswXwLH","FogHiddenShopView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=e("../../network/protocol/RoleProtocols"),l=e("../../network/ClientNetwork"),d=e("../../Global/GameGlobal"),u=e("../../modules/base/GameView"),h=e("../../common/PlayerModule"),p=cc._decorator,f=p.ccclass,g=p.property,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.m_MoneyCountLabel=null,t.m_ShopItemLayout=null,t.m_ShopItemPrefab=null,t.m_nGetRandShopId=9,t.m_consumeItemId=1025,t}return a(t,e),t.path=function(){return"ui/fogHidden/prefab/FoxHiddenShop"},t.prototype.start=function(){var e=this,t=new c.C_Role_GetRandShop;t.shopID=this.m_nGetRandShopId,l.ClientNetwork.getInstance().Send(c.ROLE_CLIENT_ENUM.P_Role_GetRandShop,t),l.ClientNetwork.getInstance().listenProtocol(c.ROLE_CLIENT_ENUM.P_Role_SynRandShopData,function(t){t.resetPos();var o=new c.S_Role_SynRandShopData;o.read(t)&&o.shopID===e.m_nGetRandShopId&&e.initShopListInfo(o.shopData)},this),l.ClientNetwork.getInstance().listenProtocol(c.ROLE_CLIENT_ENUM.P_Role_RandShopBuy,function(t){t.resetPos();var o=new c.S_Role_RandShopBuy;if(o.read(t))if(0===o.errorcode&&o.prize.length>0){u.default.addPopView("BaseCtrl","AcquirePopupView","AcquirePopupView",{items:o.prize});var i=u.default.getViewByName("ShopConfirmBuy");i&&i.view&&(i.view.node.active=!1,i.view.closeView()),e.m_MoneyCountLabel.string=h.default.getItemCountByBag(e.m_consumeItemId)}else d.G.StringManager.PopString("S_Role_RandShopBuy ERROR  "+o.errorcode)},this)},t.prototype.initShopListInfo=function(e){var t=this;this.m_ShopItemLayout.node.destroyAllChildren(),this.scheduleOnce(function(){e.positions.forEach(function(e,o){var i=cc.instantiate(t.m_ShopItemPrefab);i.parent=t.m_ShopItemLayout.node,i.getComponent("NavigationShopItem").init(e,o,t.callRoleRandShopBuy),i.scale=.8})}),this.m_MoneyCountLabel.string=h.default.getItemCountByBag(this.m_consumeItemId)},t.prototype.callRoleRandShopBuy=function(e){var t=new c.C_Role_RandShopBuy;t.shopID=9,t.shopPosition=e.shopPosition,t.shopItemID=e.shopItemID,l.ClientNetwork.getInstance().Send(c.ROLE_CLIENT_ENUM.P_Role_RandShopBuy,t)},t.prototype.onHelpCallBack=function(){u.default.addPopView("BaseCtrl","FogHiddenShopIntroduceView","FogHiddenShopIntroduceView")},n([g(cc.Label)],t.prototype,"m_MoneyCountLabel",void 0),n([g(cc.Layout)],t.prototype,"m_ShopItemLayout",void 0),n([g(cc.Prefab)],t.prototype,"m_ShopItemPrefab",void 0),n([s.Register_Class,f],t)}(r.default);o.default=m,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/base/GameView":"GameView","../../network/ClientNetwork":"ClientNetwork","../../network/protocol/RoleProtocols":"RoleProtocols"}],FontsManager:[function(e,t,o){"use strict";cc._RF.push(t,"352e28aQF1GW7+BY7DHsfGQ","FontsManager");var i=this&&this.__awaiter||function(e,t,o,i){return new(o||(o=Promise))(function(a,n){function r(e){try{c(i.next(e))}catch(t){n(t)}}function s(e){try{c(i.throw(e))}catch(t){n(t)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(r,s)}c((i=i.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){var o,i,a,n,r={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return n={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function s(e){return function(t){return c([e,t])}}function c(n){if(o)throw new TypeError("Generator is already executing.");for(;r;)try{if(o=1,i&&(a=2&n[0]?i.return:n[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return r.label++,{value:n[1],done:!1};case 5:r.label++,i=n[1],n=[0];continue;case 7:n=r.ops.pop(),r.trys.pop();continue;default:if(!(a=(a=r.trys).length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){r=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){r.label=n[1];break}if(6===n[0]&&r.label<a[1]){r.label=a[1],a=n;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(n);break}a[2]&&r.ops.pop(),r.trys.pop();continue}n=t.call(e,r)}catch(s){n=[6,s],i=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.FontsManager=o.ccFontDefinition=o.ccFontStroke=void 0;var n=e("../network/protocol/ObjCollection"),r=e("./subUtils/SubpackageTools"),s=function(){function e(){this.m_strokeEnabled=!1,this.m_strokeColor=cc.color(0,0,0),this.m_strokeSize=0,this.m_strokeEnabled=!1}return e.prototype.clone=function(){var t=new e;return t.m_strokeEnabled=this.m_strokeEnabled,t.m_strokeColor=this.m_strokeColor.clone(),t.m_strokeSize=this.m_strokeSize,t},e}();o.ccFontStroke=s;var c=function(){this.m_fontName="",this.m_fontSize=0,this.m_alignment=cc.Label.HorizontalAlign.CENTER,this.m_vertAlignment=cc.Label.VerticalAlign.CENTER,this.m_dimensions=cc.Size.ZERO,this.m_fontFillColor=cc.color(0,0,0),this.m_stroke=null,this.m_alignment=cc.Label.HorizontalAlign.CENTER,this.m_vertAlignment=cc.Label.VerticalAlign.TOP,this.m_fontFillColor=cc.color(0,0,0),this.m_dimensions=cc.Size.ZERO};o.ccFontDefinition=c;var l=function(){function e(){}return e.getParentKey=function(e){for(var t=0;t<e.key.length;t++)if("FontParent"==e.key[t])return e.value[t];return null},e.copyFontDefinition=function(e){var t=new c;return e?(t.m_fontName=e.m_fontName,t.m_fontSize=e.m_fontSize,t.m_alignment=e.m_alignment,t.m_vertAlignment=e.m_vertAlignment,t.m_dimensions=e.m_dimensions.clone(),t.m_fontFillColor=e.m_fontFillColor.clone(),t.m_stroke=e.m_stroke.clone(),t):t},e.getFontDefinition=function(e,t){var o=null;if(null!=this.getParentKey(t)){var i=this.fontsMap.get(e);o=this.copyFontDefinition(i)}else o=new c;return o},e.getColorFromString=function(e){var t=(e=e.substring(1,e.length-2)).split(","),o=new cc.Color;return o.r=Number(t[0]),o.g=Number(t[1]),o.b=Number(t[2]),o},e.setFillColor=function(e,t){var o=this.getColorFromString(t);e.m_fontFillColor=o},e.setFontStroke=function(e,t){if(t){null==e.m_stroke&&(e.m_stroke=new s),e.m_stroke.m_strokeEnabled=!0;for(var o=0;o<t.key.length;o++){var i=t.key[o],a=t.value[o];if("StrokeColor"==i){var n=this.getColorFromString(a);e.m_stroke.m_strokeColor=n}else"StrokeAlpha"==i?e.m_stroke.m_strokeSize=Number(a):console.log("HHHHHH unknow key = "+i)}}},e.addOutline=function(e,t,o,i){if(void 0===t&&(t=2),void 0===o&&(o=new cc.Color(0,0,0)),void 0===i&&(i=255),e){var a=e.node.getComponent(cc.LabelOutline);a||(a=e.node.addComponent(cc.LabelOutline)),a.color=o,a.width=t}},e.SetFont=function(e,t){var o=this;if(e.node){var i=null;if(e instanceof cc.Button?(i=e.getComponent(cc.Label))||(i=e.getComponentInChildren(cc.Label)):e instanceof cc.Label&&(i=e),i){var a=this.fontsMap.get(t);a&&cc.resources.load("fonts/msyhbd",cc.Font,function(e,t){i&&i.node&&(i.useSystemFont=!1,i.font=t,i.fontSize=a.m_fontSize,i.node.color=a.m_fontFillColor,a.m_stroke&&a.m_stroke.m_strokeEnabled&&o.addOutline(i,2,a.m_stroke.m_strokeColor,a.m_stroke.m_strokeSize))})}else console.log("HHHHHHHHHHHH Label is null")}},e.init=function(){return i(this,void 0,void 0,function(){var e,t,o,i,s,c,l,d=this;return a(this,function(a){switch(a.label){case 0:return this.fontsMap?[2]:(this.fontsMap=new n.ObjMap,[4,r.LoadResAsync("config/Fonts",cc.JsonAsset).then(function(e){d.jsonFile=e}).catch(function(e){cc.error(e)})]);case 1:if(a.sent(),!this.jsonFile)return[2];for(e=0;e<this.jsonFile.json.key.length;e++){for(t=this.jsonFile.json.key[e],o=this.jsonFile.json.value[e],i=this.getFontDefinition(t,o),s=0;s<o.key.length;s++)c=o.key[s],l=o.value[s],"FontName"==c?i.m_fontName=l:"FontSize"==c?i.m_fontSize=Number(l):"FontFillColor"==c?this.setFillColor(i,l):"FontStroke"==c?this.setFontStroke(i,l):"FontParent"==c||console.log("HHHHHH unknow key = "+c);this.fontsMap.set(t,i)}return[2]}})})},e.SetLabelFont=function(e,t,o,i){var a=cc.resources.get(t,cc.Font);a?(e.font=a,o&&(i?o.call(i):o())):cc.resources.load(t,cc.Font,function(t,a){t||(e.font=a,o&&(i?o.call(i):o()))})},e.SetDefaultFontName=function(t){e.SetLabelFont(t,"fonts/msyhbd")},e.fontsMap=null,e.jsonFile=null,e}();o.FontsManager=l,cc._RF.pop()},{"../network/protocol/ObjCollection":"ObjCollection","./subUtils/SubpackageTools":"SubpackageTools"}],FriendApplyItem:[function(e,t,o){"use strict";cc._RF.push(t,"9da7eazBthJj767JZCUvLOp","FriendApplyItem");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../Global/GameGlobal"),s=e("../../network/ClientNetwork"),c=e("../../network/protocol/FriendProtocls"),l=e("../../network/protocol/FriendProtocls"),d=e("../../network/protocol/FriendProtocls"),u=e("../../utils/GameUtils"),h=e("../../modules/manager/LoadResManager"),p=cc._decorator,f=p.ccclass,g=p.property,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.m_labelFriendName=null,t.m_spFriendIcon=null,t.m_spFriendFrame=null,t.m_labelFriendScore=null,t.m_labelFriendCoopTime=null,t.m_nFriendShowId="",t}return a(t,e),t.prototype.onLoad=function(){},t.prototype.start=function(){},t.prototype.onDestroy=function(){},t.prototype.onClickAgreeApply=function(){var e=new l.C_Friend_AgreeApply;e.agreeRoleShowID=this.m_nFriendShowId,s.ClientNetwork.getInstance().Send(d.FRIEND_CLIENT_ENUM.P_Friend_AgreeApply,e)},t.prototype.onClickDelApply=function(){var e=new c.C_Friend_DelApply;e.applyRoleShowID=this.m_nFriendShowId,s.ClientNetwork.getInstance().Send(d.FRIEND_CLIENT_ENUM.P_Friend_DelApply,e)},t.prototype.initData=function(e){var t=this;this.m_labelFriendName.string=e.nickName,this.m_nFriendShowId=e.showID,this.m_labelFriendScore.string=e.score+"",u.setRemoteHeadIcon(e.headUrl,e.headID,this.m_spFriendIcon);var o=e.headFrameID;(o<=0||o>=2e3)&&(o=200),h.default.loadSpriteFrame("ui/headFrame/frame_"+o).then(function(e){t.m_spFriendFrame.getComponent(cc.Sprite).spriteFrame=e}),this.m_labelFriendCoopTime.string=r.G.StringManager.getString("FRIEND_COOP_TIMES",1)},n([g(cc.Label)],t.prototype,"m_labelFriendName",void 0),n([g(cc.Sprite)],t.prototype,"m_spFriendIcon",void 0),n([g(cc.Sprite)],t.prototype,"m_spFriendFrame",void 0),n([g(cc.Label)],t.prototype,"m_labelFriendScore",void 0),n([g(cc.Label)],t.prototype,"m_labelFriendCoopTime",void 0),n([f],t)}(cc.Component);o.default=m,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../modules/manager/LoadResManager":"LoadResManager","../../network/ClientNetwork":"ClientNetwork","../../network/protocol/FriendProtocls":"FriendProtocls","../../utils/GameUtils":"GameUtils"}],FriendChatPanel:[function(e,t,o){"use strict";cc._RF.push(t,"2689eYUAMxHQLIBOALbCc55","FriendChatPanel");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../common/PlayerModule"),s=e("../../modules/cores/UISuperLayout"),c=e("./ChatItem"),l=e("../../modules/base/GameView"),d=e("../../modules/manager/LoadResManager"),u=e("../../utils/GameUtils"),h=e("../../network/ClientNetwork"),p=e("../../Global/GameGlobal"),f=e("../../utils/UIManager"),g=e("../../network/LocalMessage"),m=e("../../network/protocol/ChatProtocols"),_=cc._decorator,y=_.ccclass,v=_.property,C=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.layout=null,t.friendListNode=null,t.friendListPrefNode=null,t.datas=[],t}return a(t,e),t.prototype.onLoad=function(){this.onListenProtocolEvent(),this.initFriendListInfo()},t.prototype.onEnable=function(){var e=this,t=function(){var t=[],o=e.friendListNode.getComponent(cc.ScrollView).content.children,i=r.default.getPrivateChatSimData();return i.size>o.length&&i.forEach(function(e,i){for(var a=!0,n=0;n<o.length;n++)if(1==o[n].roleID.equals(i)){a=!1;break}1==a&&(e.roleID=i,t.push(e))}),t}.call(this);t.length>0&&t.forEach(function(t){e.createFriendNode(t,t.roleID,!1)});for(var o=function(e){var t=0;return r.default.getPrivateChatSimData().forEach(function(o,i){1==i.equals(e)&&(t=o.noReadNum)}),t},i=null,a=this.friendListNode.getComponent(cc.ScrollView).content.children,n=0;n<a.length;n++){var s=a[n];1==s.getChildByName("select").active&&this.onCallGetPrivateChatData(s.roleID);var c=o.call(this,s.roleID);s.getChildByName("redpoint").active=c>0,c>0&&(i||(i=s))}i&&setTimeout(function(){var t=i.x/e.friendListNode.getComponent(cc.ScrollView).content.width;e.friendListNode.getComponent(cc.ScrollView).scrollToPercentHorizontal(t,.2)},100),0==function(){for(var t=!1,o=e.friendListNode.getComponent(cc.ScrollView).content.children,i=0;i<o.length;i++)if(1==o[i].getChildByName("select").active){t=!0;break}return t}.call(this)&&(this.friendListNode.getComponent(cc.ScrollView).content.children.length>0?(this.friendListNode.getComponent(cc.ScrollView).content.children[0].getChildByName("select").active=!0,this.onCallGetPrivateChatData(this.friendListNode.getComponent(cc.ScrollView).content.children[0].roleID)):(this.datas=[],this.layout.total(this.datas.length)))},t.prototype.onDisable=function(){this._curSelectRoleID=null,this._removeRoleId=null},t.prototype.initFriendListInfo=function(){var e=this;this.friendListNode.getComponent(cc.ScrollView).content.children.length>0&&(this.friendListNode.getComponent(cc.ScrollView).content.removeAllChildren(),this.datas=[],this.layout.total(this.datas.length),this._curSelectRoleID=null);var t=r.default.getPrivateChatSimData(),o=0;t.forEach(function(t,i){e.createFriendNode(t,i,0==o),o++})},t.prototype.createFriendNode=function(e,t,o){var i=this,a=cc.instantiate(this.friendListPrefNode);a.parent=this.friendListNode.getComponent(cc.ScrollView).content,a.active=!0,a.roleID=t,a.getChildByName("name").getComponent(cc.Label).string=e.nickName,u.setRemoteHeadIcon(e.headUrl,e.headID,a.getChildByName("icon").getComponent(cc.Sprite)),e.headFrameID<=0&&(e.headFrameID=200),d.default.loadSpriteFrame("ui/headFrame/frame_"+e.headFrameID).then(function(e){a.getChildByName("frame").getComponent(cc.Sprite).spriteFrame=e}),a.getChildByName("redpoint").active=e.noReadNum>0,a.getChildByName("select").active=o,o&&this.onCallGetPrivateChatData(t),a.getChildByName("close").on(cc.Node.EventType.TOUCH_START,function(e){i.onDeletePrivateChatCallBack(e)}),a.on(cc.Node.EventType.TOUCH_END,function(e){for(var t=i.friendListNode.getComponent(cc.ScrollView).content.children,o=0;o<t.length;o++){var a=t[o];a.getChildByName("select").active=!1,a==e.target&&(a.getChildByName("select").active=!0,i.onCallGetPrivateChatData(e.target.roleID))}})},t.prototype.addChatTargetData=function(e){for(var t=this.friendListNode.getComponent(cc.ScrollView).content.children,o=null,i=0;i<t.length;i++)if(1==(a=t[i]).roleID.equals(e.roleID)){o=a;break}if(o){if(1==o.getChildByName("select").active)return void(this.selectFriendId=o.roleID);for(i=0;i<t.length;i++)(a=t[i]).getChildByName("select").active=!1;return o.getChildByName("select").active=!0,void this.onCallGetPrivateChatData(e.roleID)}for(i=0;i<t.length;i++){var a;(a=t[i]).getChildByName("select").active=!1}this.createFriendNode(e,e.roleID,!0)},t.prototype.onCallGetPrivateChatData=function(e){if(!this._curSelectRoleID||1!=this._curSelectRoleID.equals(e)){this.layout.total(0),this.layout.node.opacity=0,this._curSelectRoleID=e;var t=new m.C_Chat_GetPrivateChatData;t.roleID=e,h.ClientNetwork.getInstance().Send(m.CHAT_CLIENT_ENUM.P_Chat_GetPrivateChatData,t)}},t.prototype.onRefreshEvent=function(e,t){var o=this.datas[t];e.getComponent(c.default).show(o)},t.prototype.removeMessage=function(e){this.datas.splice(0,e),this.layout.total(this.datas.length)},t.prototype.addMessage=function(e){var t=this;if(1==r.default.UUID.equals(e.roleID))return this.datas.push(e),this.layout.total(this.datas.length),void setTimeout(function(){cc.isValid(t)&&t.layout.scrollToFooter(.1)},100);for(var o=this.friendListNode.getComponent(cc.ScrollView).content.children,i=null,a=0;a<o.length;a++){var n=o[a];if(1==n.roleID.equals(e.roleID)){i=n;break}}if(i)return 1==i.getChildByName("select").active?(this.selectFriendId=i.roleID,this.datas.push(e),this.layout.total(this.datas.length),setTimeout(function(){cc.isValid(t)&&t.layout.scrollToFooter(.15)},50),void this.onCallSetPrivateChatRead(i.roleID)):void(i.getChildByName("redpoint").active=!0);this.createFriendNode(e,e.roleID,!1);var s=1;this.friendListNode.getComponent(cc.ScrollView).content.children.slice(-1)[0].getChildByName("redpoint").active=!0,o.length<=1&&(this.onCallGetPrivateChatData(e.roleID),this.friendListNode.getComponent(cc.ScrollView).content.children[0].getChildByName("select").active=!0,s=0);var c=r.default.getPrivateChatSimData(),l=new m.T_Chat_PrivateChatSimData;l.nickName=e.nickName,l.headID=e.headID,l.headUrl=e.headUrl,l.headFrameID=e.headFrameID,l.noReadNum=s,c.set(e.roleID,l)},t.prototype.onCallSetPrivateChatRead=function(e){var t=new m.C_Chat_SetPrivateChatRead;t.roleID=e,h.ClientNetwork.getInstance().Send(m.CHAT_CLIENT_ENUM.P_Chat_SetPrivateChatRead,t);for(var o=this.friendListNode.getComponent(cc.ScrollView).content.children,i=0;i<o.length;i++){var a=o[i];if(1==a.roleID.equals(e)){a.getChildByName("redpoint").active=!1;break}}var n=r.default.getPrivateChatSimData();n.forEach(function(t,o){1==o.equals(e)&&(t.noReadNum=0,n.set(o,t))});var s=l.default.getViewByName("MainSceneView");s&&s.view&&s.view.onShowChatRedpoint(),p.G.UIManager.getCurSceneName()!=f.SceneName.MainScene&&h.ClientNetwork.getInstance().pushLocalMessage(g.LOCAL_MESSAGE.LocalMsg_RefreshCoopFriendChatRed)},t.prototype.onDeletePrivateChatCallBack=function(e){if(this._removeRoleId=e.target.parent.roleID,this.datas.length<=0)this.onDeletePrivateChat();else{var t=new m.C_Chat_DeletePrivateChatData;t.roleID=this._removeRoleId,h.ClientNetwork.getInstance().Send(m.CHAT_CLIENT_ENUM.P_Chat_DeletePrivateChatData,t)}},t.prototype.onDeletePrivateChat=function(){var e=this;if(this._removeRoleId){var t=r.default.getPrivateChatSimData();t.forEach(function(o,i){1==i.equals(e._removeRoleId)&&t.delete(i)}),this.initFriendListInfo(),this._removeRoleId=null}},t.prototype.onListenProtocolEvent=function(){var e=this;h.ClientNetwork.getInstance().listenProtocol(m.CHAT_CLIENT_ENUM.P_Chat_GetPrivateChatData,function(t){t.resetPos();var o=new m.S_Chat_GetPrivateChatData;o.read(t)&&(e.datas=o.chatData,e.layout.total(e.datas.length),e.selectFriendId=o.roleID,setTimeout(function(){cc.isValid(e)&&(e.layout.scrollToFooter(),e.layout.node.opacity=255)},250),e.onCallSetPrivateChatRead(o.roleID))},this),h.ClientNetwork.getInstance().listenProtocol(m.CHAT_CLIENT_ENUM.P_Chat_DeletePrivateChatData,function(t){t.resetPos();var o=new m.S_Chat_DeletePrivateChatData;if(o.read(t))if(0==o.errorcode){if(!e._removeRoleId)return;e.onDeletePrivateChat()}else p.G.StringManager.PopString("\u51fa\u9519\u4e86"+o.errorcode)},this)},n([v(s.default)],t.prototype,"layout",void 0),n([v(cc.Node)],t.prototype,"friendListNode",void 0),n([v(cc.Node)],t.prototype,"friendListPrefNode",void 0),n([y],t)}(cc.Component);o.default=C,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../common/PlayerModule":"PlayerModule","../../modules/base/GameView":"GameView","../../modules/cores/UISuperLayout":"UISuperLayout","../../modules/manager/LoadResManager":"LoadResManager","../../network/ClientNetwork":"ClientNetwork","../../network/LocalMessage":"LocalMessage","../../network/protocol/ChatProtocols":"ChatProtocols","../../utils/GameUtils":"GameUtils","../../utils/UIManager":"UIManager","./ChatItem":"ChatItem"}],FriendInfoView:[function(e,t,o){"use strict";cc._RF.push(t,"b00d0UtPRhMT53qBzFV4sMU","FriendInfoView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=e("../../utils/LogUtil"),l=e("../../network/ClientNetwork"),d=e("../../network/protocol/RoleProtocols"),u=e("../../modules/base/GameView"),h=e("../../utils/GameUtils"),p=cc._decorator,f=p.ccclass,g=p.property,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.headNode=null,t.playerNameLab=null,t.playerUUIDLab=null,t.playerCupLab=null,t.playerWinNumLab=null,t.playerLoseNumLab=null,t.playerRateLab=null,t.playerMaxCupLab=null,t.playerMaxRoundLab=null,t._friendShowId="",t}return a(t,e),t.path=function(){return"ui/friend/friendDetail"},t.prototype.onLoad=function(){},t.prototype.init=function(e){this.onListenProtocolEvent(),this.onReqGetRoleSimpleInfo(e.friendShowId)},t.prototype.onReqGetRoleSimpleInfo=function(e){this._friendShowId=e;var t=new d.C_Role_GetRoleSimpleInfo;t.showID=this._friendShowId,l.ClientNetwork.getInstance().Send(d.ROLE_CLIENT_ENUM.P_Role_GetRoleSimpleInfo,t)},t.prototype.onListenProtocolEvent=function(){var e=this;l.ClientNetwork.getInstance().listenProtocol(d.ROLE_CLIENT_ENUM.P_Role_GetRoleSimpleInfo,function(t){t.resetPos();var o=new d.S_Role_GetRoleSimpleInfo;o.read(t)&&(0===o.errorcode?e.onSetPlayerInfoView(o.roleAbstract):c.default.info(o))},this)},t.prototype.onSetPlayerInfoView=function(e){this.playerNameLab.string=e.nickName,this.onRefreshPlayerHead(e.headID,e.headUrl);var t=this._friendShowId;this.playerUUIDLab.string=t.toString(),this.playerCupLab.string=e.score,this.playerMaxCupLab.string=e.maxScore;var o=function(){var t=0,o=0,i=0;return e.fightType.forEach(function(e,a){1==a?(e.winNum>o&&(o=e.winNum),e.lostNum>i&&(i=e.lostNum)):2==a&&e.maxRound>t&&(t=e.maxRound)}),[t,o,i]}.call(this);this.playerMaxRoundLab.string=o[0].toString(),this.playerWinNumLab.string=o[1].toString(),this.playerLoseNumLab.string=o[2].toString();var i=Math.floor(o[1]/(o[1]+o[2])*100);isNaN(i)&&(i=0),this.playerRateLab.string=0===i?i.toString():i+"%"},t.prototype.onClickHeadCallBack=function(){u.default.addPopView("BaseCtrl","PlayerHeadView","PlayerHeadView")},t.prototype.onRefreshPlayerHead=function(e,t){h.setRemoteHeadIcon(t,e,this.headNode.getComponent(cc.Sprite))},t.prototype.onDestroy=function(){l.ClientNetwork.getInstance().removeMessageTarget(this)},n([g({type:cc.Node,displayName:"\u73a9\u5bb6\u5934\u50cf"})],t.prototype,"headNode",void 0),n([g({type:cc.Label,displayName:"\u73a9\u5bb6\u540d\u79f0"})],t.prototype,"playerNameLab",void 0),n([g({type:cc.Label,displayName:"\u73a9\u5bb6UUID"})],t.prototype,"playerUUIDLab",void 0),n([g({type:cc.Label,displayName:"\u73a9\u5bb6\u676f\u6570"})],t.prototype,"playerCupLab",void 0),n([g({type:cc.Label,displayName:"\u80dc\u5229"})],t.prototype,"playerWinNumLab",void 0),n([g({type:cc.Label,displayName:"\u5931\u8d25"})],t.prototype,"playerLoseNumLab",void 0),n([g({type:cc.Label,displayName:"\u80dc\u7387"})],t.prototype,"playerRateLab",void 0),n([g({type:cc.Label,displayName:"\u6700\u9ad8\u676f\u6570"})],t.prototype,"playerMaxCupLab",void 0),n([g({type:cc.Label,displayName:"\u6700\u9ad8\u56de\u5408"})],t.prototype,"playerMaxRoundLab",void 0),n([s.Register_Class,f],t)}(r.default);o.default=m,cc._RF.pop()},{"../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/base/GameView":"GameView","../../network/ClientNetwork":"ClientNetwork","../../network/protocol/RoleProtocols":"RoleProtocols","../../utils/GameUtils":"GameUtils","../../utils/LogUtil":"LogUtil"}],FriendItem:[function(e,t,o){"use strict";cc._RF.push(t,"5ae99m4GjJEb4E4Zcl9XPIo","FriendItem");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../network/protocol/FriendProtocls"),s=e("../../utils/GameUtils"),c=e("../../modules/manager/LoadResManager"),l=e("../../network/ClientNetwork"),d=e("../../common/PlayerModule"),u=cc._decorator,h=u.ccclass,p=u.property,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.m_labelFriendIndex=null,t.m_labelFriendName=null,t.m_labelFriendLastTime=null,t.m_labelFriendScore=null,t.m_spFriendIcon=null,t.m_spFriendFrame=null,t.m_nodeOffline=null,t.m_spOnLine=null,t.m_nIndex=0,t.m_nFriendShowId="",t.m_pFriendInfo=null,t.m_pParent=null,t}return a(t,e),t.prototype.onLoad=function(){var e=this;this.node.on(cc.Node.EventType.TOUCH_END,function(t){e.node.getBoundingBoxToWorld().contains(t.getLocation())&&e.m_pParent&&e.m_pParent.setPopupWindowState(t.getLocation(),e.m_nFriendShowId,{roleID:e.m_lRoleId,headID:e.m_headID,headFrameID:e.m_headFrameID,headUrl:e.m_headUrl,nickName:e.m_nickName})})},t.prototype.start=function(){},t.prototype.onDestroy=function(){l.ClientNetwork.getInstance().removeMessageTarget(this)},t.prototype.deleteBlackFriend=function(){var e=d.default.otherUUidTransformRoieId(this.m_lRoleId),t=new r.C_Friend_DelBlackList;t.blackRoleShowID=e.toString(),l.ClientNetwork.getInstance().Send(r.FRIEND_CLIENT_ENUM.P_Friend_DelBlackList,t)},t.prototype.initData=function(e,t,o){var i=this;this.m_nIndex=e,this.m_labelFriendIndex.string=e+"",this.m_pFriendInfo=t,this.m_pParent=o,this.m_labelFriendName.string=t.nickName,this.m_nFriendShowId=t.showID,this.m_lRoleId=t.roleID,this.m_headID=t.headID,this.m_headFrameID=t.headFrameID,this.m_headUrl=t.headUrl,this.m_nickName=t.nickName,s.setRemoteHeadIcon(t.headUrl,t.headID,this.m_spFriendIcon);var a=t.headFrameID;if((a<=0||a>=2e3)&&(a=200),c.default.loadSpriteFrame("ui/headFrame/frame_"+a).then(function(e){i.m_spFriendFrame&&(i.m_spFriendFrame.getComponent(cc.Sprite).spriteFrame=e)}),t.offlineTime<=0)this.m_spOnLine.node.active=!0,this.m_nodeOffline.active=!1;else{var n=0;t.offlineTime>=86400?(n=Math.floor(t.offlineTime/86400),this.m_labelFriendLastTime.string=n+"\u5929\u524d"):(n=Math.floor(t.offlineTime/3600),this.m_labelFriendLastTime.string=n+"\u5c0f\u65f6\u524d")}this.m_labelFriendScore.string=t.score+""},n([p(cc.Label)],t.prototype,"m_labelFriendIndex",void 0),n([p(cc.Label)],t.prototype,"m_labelFriendName",void 0),n([p(cc.Label)],t.prototype,"m_labelFriendLastTime",void 0),n([p(cc.Label)],t.prototype,"m_labelFriendScore",void 0),n([p(cc.Sprite)],t.prototype,"m_spFriendIcon",void 0),n([p(cc.Sprite)],t.prototype,"m_spFriendFrame",void 0),n([p(cc.Node)],t.prototype,"m_nodeOffline",void 0),n([p(cc.Sprite)],t.prototype,"m_spOnLine",void 0),n([h],t)}(cc.Component);o.default=f,cc._RF.pop()},{"../../common/PlayerModule":"PlayerModule","../../modules/manager/LoadResManager":"LoadResManager","../../network/ClientNetwork":"ClientNetwork","../../network/protocol/FriendProtocls":"FriendProtocls","../../utils/GameUtils":"GameUtils"}],FriendMainView:[function(e,t,o){"use strict";cc._RF.push(t,"dda5fiD6JRIbaZViSqdX/Mv","FriendMainView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0}),o.T_FriendRecommendData=o.FRIEND_ERROR_CODE_START=o.FRIEND_TAB_TYPE=void 0;var r,s,c=e("../../modules/base/Decorators"),l=e("../../modules/base/BaseView"),d=e("../../common/PlayerModule"),u=e("../../network/ClientNetwork"),h=e("../../utils/LogUtil"),p=e("../../modules/manager/LoadResManager"),f=e("../../modules/base/GameView"),g=e("../../network/protocol/FriendProtocls"),m=e("../../network/protocol/FriendProtocls"),_=e("../../utils/GameUtils"),y=e("../../network/protocol/FriendProtocls"),v=e("../../network/protocol/FriendProtocls"),C=e("../../network/protocol/FriendProtocls"),S=e("../../network/protocol/FriendProtocls"),T=e("../../network/protocol/ObjCollection"),I=e("../../utils/GameTools"),N=e("../../network/protocol/FriendProtocls"),b=e("../../network/protocol/FriendProtocls"),w=e("../../network/protocol/FriendProtocls"),E=e("../../network/protocol/FriendProtocls"),P=e("../../network/protocol/FriendProtocls"),R=e("./FriendPopupTips"),L=e("../../network/protocol/RoleProtocols"),A=e("../../network/protocol/RoleProtocols"),D=e("../../network/protocol/RoleProtocols"),M=e("../../network/LocalMessage"),B=e("../../Global/GameGlobal"),k=e("../../network/protocol/RoleProtocols"),G=e("../../utils/GamePlatform"),O=e("../../utils/GameUtils"),H=e("../../common/EventConst"),V=e("../../modules/manager/EventManager"),F=e("../../common/CommandValue");(function(e){e[e.FRIEND_TAB_TYPE_FRIEND_LIST=1]="FRIEND_TAB_TYPE_FRIEND_LIST",e[e.FRIEND_TAB_TYPE_RECOMMEND_FRIEND=2]="FRIEND_TAB_TYPE_RECOMMEND_FRIEND",e[e.FRIEND_TAB_TYPE_FRIEND_REQUEST=3]="FRIEND_TAB_TYPE_FRIEND_REQUEST",e[e.FRIEND_TAB_TYPE_FRIEND_RANK=4]="FRIEND_TAB_TYPE_FRIEND_RANK",e[e.FRIEND_TAB_TYPE_BLACK_FRIEND=5]="FRIEND_TAB_TYPE_BLACK_FRIEND"})(r=o.FRIEND_TAB_TYPE||(o.FRIEND_TAB_TYPE={})),function(e){e[e.FRIEND_ERROR_CODE_START_FRIEND_LIST=1]="FRIEND_ERROR_CODE_START_FRIEND_LIST",e[e.FRIEND_ERROR_CODE_START_BLACK_LIST=6]="FRIEND_ERROR_CODE_START_BLACK_LIST",e[e.FRIEND_ERROR_CODE_START_APPLY_LIST=11]="FRIEND_ERROR_CODE_START_APPLY_LIST",e[e.FRIEND_ERROR_CODE_START_SET_APPLY=15]="FRIEND_ERROR_CODE_START_SET_APPLY",e[e.FRIEND_ERROR_CODE_START_APPLY=19]="FRIEND_ERROR_CODE_START_APPLY",e[e.FRIEND_ERROR_CODE_START_AGREE_APPLY=30]="FRIEND_ERROR_CODE_START_AGREE_APPLY",e[e.FRIEND_ERROR_CODE_START_DEL_APPLY=44]="FRIEND_ERROR_CODE_START_DEL_APPLY",e[e.FRIEND_ERROR_CODE_START_ADD_BLACK=56]="FRIEND_ERROR_CODE_START_ADD_BLACK",e[e.FRIEND_ERROR_CODE_START_DEL_BLACK=64]="FRIEND_ERROR_CODE_START_DEL_BLACK"}(s=o.FRIEND_ERROR_CODE_START||(o.FRIEND_ERROR_CODE_START={}));var U=function(){function e(){}return e.prototype.setData=function(e){this.roleID=e.roleID,this.showID=e.showID,this.nickName=e.nickName,this.headID=e.headID,this.headUrl=e.headUrl,this.headFrameID=e.headFrameID,this.score=e.score,this.coopTimes=1},Object.defineProperty(e.prototype,"coopTime",{get:function(){return this.coopTimes},set:function(e){this.coopTimes+=e},enumerable:!1,configurable:!0}),e}();o.T_FriendRecommendData=U;var x=cc._decorator,Y=x.ccclass,j=x.property,W=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.m_NodeNoFriendTips=null,t.m_NodeNoApplyTips=null,t.m_labelMyUUID=null,t.m_spriteRedPoint0=null,t.m_spriteRedPoint1=null,t.m_scrollView=null,t.m_nodePopupWindow=null,t.m_editBox=null,t.m_friendRankNode=null,t.m_nCurSelectType=r.FRIEND_TAB_TYPE_FRIEND_LIST,t.m_pFriendListData=null,t.m_pRecommendData=new T.ObjMap,t.m_pApplyData=null,t.m_strFriendUUID=null,t.m_strFriendShowId="",t.m_goodFriendNum=0,t}return a(t,e),t.path=function(){return"ui/friend/friendMain"},t.prototype.onLoad=function(){var e=this,t=this.node.getChildByName("bg").getChildByName("ToggleContainer1");this.m_spriteRedPoint=this.m_spriteRedPoint0,t.active=!1,(G.GamePlatform.getMiYa()||G.GamePlatform.isByteDanceMiniGame()||G.GamePlatform.isQQGameRoom()||G.GamePlatform.IsSmallBag()||G.GamePlatform.IsH5SmallBag()||G.GamePlatform.IsMiYaIosH5()||G.GamePlatform.isKuaishouMiniGame())&&(t.active=!0,this.m_spriteRedPoint=this.m_spriteRedPoint1),u.ClientNetwork.getInstance().listenProtocol(g.FRIEND_CLIENT_ENUM.P_Friend_GetGoodFriend,function(t){if(this.m_nCurSelectType==r.FRIEND_TAB_TYPE_FRIEND_LIST){t.resetPos();var o=new y.S_Friend_GetGoodFriend;if(o.read(t)){if(0!=o.errorcode)return void _.ERRORTIPS(s.FRIEND_ERROR_CODE_START_FRIEND_LIST+o.errorcode);var i=Array.from(o.goodfriend.keys());this.m_goodFriendNum=i.length,e.refreshData(e.m_nCurSelectType,o.goodfriend)}else cc.log("\u8bfb\u53d6\u5931\u8d25")}},this),u.ClientNetwork.getInstance().listenProtocol(g.FRIEND_CLIENT_ENUM.P_Friend_GetApplyData,function(t){if(this.m_nCurSelectType==r.FRIEND_TAB_TYPE_FRIEND_REQUEST){t.resetPos();var o=new C.S_Friend_GetApplyData;if(o.read(t)){if(0!=o.errorcode)return void _.ERRORTIPS(s.FRIEND_ERROR_CODE_START_APPLY_LIST+o.errorcode);e.refreshData(e.m_nCurSelectType,o.applyData)}else cc.log("\u8bfb\u53d6\u5931\u8d25")}},this),u.ClientNetwork.getInstance().listenProtocol(L.ROLE_CLIENT_ENUM.P_Role_Get_Fight_Record_Cooperation,function(t){t.resetPos();var o=new A.S_Role_Get_Fight_Record_Cooperation;if(o.read(t)){if(0!=o.errorcode)return;this.m_nCurSelectType==r.FRIEND_TAB_TYPE_RECOMMEND_FRIEND?e.refreshData(e.m_nCurSelectType,o.record):e.setRecommendData(o.record)}else cc.log("\u8bfb\u53d6\u5931\u8d25")},this),u.ClientNetwork.getInstance().listenProtocol(g.FRIEND_CLIENT_ENUM.P_Friend_GetBlackList,function(t){if(this.m_nCurSelectType==r.FRIEND_TAB_TYPE_BLACK_FRIEND){t.resetPos();var o=new g.S_Friend_GetBlackList;o.read(t)&&0==o.errorcode&&(e.refreshData(e.m_nCurSelectType,o.blacklist),d.default.setBlackFriendsData(o.blacklist))}},this),u.ClientNetwork.getInstance().listenProtocol(g.FRIEND_CLIENT_ENUM.P_Friend_ApplyFriend,function(e){e.resetPos();var t=new m.S_Friend_ApplyFriend;if(t.read(e)){if(0!=t.errorcode)return void _.ERRORTIPS(s.FRIEND_ERROR_CODE_START_APPLY+t.errorcode);_.ERRORTIPS(s.FRIEND_ERROR_CODE_START_APPLY)}else cc.log("\u8bfb\u53d6\u5931\u8d25")},this),u.ClientNetwork.getInstance().listenProtocol(g.FRIEND_CLIENT_ENUM.P_Friend_DelFriend,function(t){t.resetPos();var o=new N.S_Friend_DelFriend;if(o.read(t)){if(_.ERRORTIPS(s.FRIEND_ERROR_CODE_START_FRIEND_LIST+o.errorcode),0!=o.errorcode)return;e.getFriendsList()}else cc.log("\u8bfb\u53d6\u5931\u8d25")},this),u.ClientNetwork.getInstance().listenProtocol(g.FRIEND_CLIENT_ENUM.P_Friend_AgreeApply,function(t){t.resetPos();var o=new b.S_Friend_AgreeApply;if(o.read(t)){if(0!=o.errorcode)return void _.ERRORTIPS(s.FRIEND_ERROR_CODE_START_AGREE_APPLY+o.errorcode);d.default.getFriendsData().applyNum--,e.refreshMainRedPoint(),d.default.getFriendsData().applyNum>0?this.m_spriteRedPoint.node.active=!0:this.m_spriteRedPoint.node.active=!1,e.getFriendReqList()}else cc.log("\u8bfb\u53d6\u5931\u8d25")},this),u.ClientNetwork.getInstance().listenProtocol(g.FRIEND_CLIENT_ENUM.P_Friend_DelApply,function(t){t.resetPos();var o=new w.S_Friend_DelAllApply;if(o.read(t)){if(0!=o.errorcode)return void _.ERRORTIPS(s.FRIEND_ERROR_CODE_START_DEL_APPLY+o.errorcode);d.default.getFriendsData().applyNum--,e.refreshMainRedPoint(),d.default.getFriendsData().applyNum>0?this.m_spriteRedPoint.node.active=!0:this.m_spriteRedPoint.node.active=!1,e.getFriendReqList()}else cc.log("\u8bfb\u53d6\u5931\u8d25")},this),u.ClientNetwork.getInstance().listenProtocol(g.FRIEND_CLIENT_ENUM.P_Friend_BeAgreeApply,function(t){t.resetPos(),(new E.S_Friend_BeAgreeApply).read(t)?e.m_nCurSelectType==r.FRIEND_TAB_TYPE_FRIEND_LIST&&e.getFriendsList():cc.log("\u8bfb\u53d6\u5931\u8d25")},this),u.ClientNetwork.getInstance().listenLocalMessage(M.LOCAL_MESSAGE.LocalMsg_Friend_BeApply,function(){e.m_nCurSelectType==r.FRIEND_TAB_TYPE_FRIEND_REQUEST&&e.getFriendReqList(),e.m_spriteRedPoint.node.active=!0},this),u.ClientNetwork.getInstance().listenProtocol(g.FRIEND_CLIENT_ENUM.P_Friend_DelBlackList,function(t){t.resetPos();var o=new g.S_Friend_DelBlackList;if(o.read(t)){if(0!=o.errorcode)return void _.ERRORTIPS(s.FRIEND_ERROR_CODE_START_DEL_BLACK+o.errorcode);e.getBlackFriendsList(),B.G.StringManager.PopString(B.G.StringManager.getString("DELETE_BLACKSUCC"))}},this),d.default.getFriendsData().applyNum>0&&(this.m_spriteRedPoint.node.active=!0)},t.prototype.start=function(){var e,t;this.initTopView(),this.getFriendsList(),this.m_pRecommendData.clear(),this.getRecommonedFriendsList(),this.m_labelMyUUID.string=d.default.uuidTransformRoieId(),G.GamePlatform.isWechat()?null===(e=wx.getOpenDataContext())||void 0===e||e.postMessage({event:"getRank",rankType:1}):G.GamePlatform.isQQMiniGame()&&(null===(t=qq.getOpenDataContext())||void 0===t||t.postMessage({event:"getRank",rankType:1}))},t.prototype.initTopView=function(){var e=this;p.default.loadPrefab("ui/CommonPrefab/TopView").then(function(t){t.parent=e.node,t.getComponent("TopView").bindExitEvent(function(){e.closeView()})}).catch(function(e){h.default.info(e)})},t.prototype.onDestroy=function(){},t.prototype.onClose=function(){this.refreshMainRedPoint(),u.ClientNetwork.getInstance().removeMessageTarget(this),this.closeView()},t.prototype.getFriendsList=function(){var e=new v.C_Friend_GetGoodFriend;u.ClientNetwork.getInstance().Send(g.FRIEND_CLIENT_ENUM.P_Friend_GetGoodFriend,e)},t.prototype.getRecommonedFriendsList=function(){var e=new D.C_Role_Get_Fight_Record_Cooperation;u.ClientNetwork.getInstance().Send(L.ROLE_CLIENT_ENUM.P_Role_Get_Fight_Record_Cooperation,e,!1)},t.prototype.getBlackFriendsList=function(){var e=new g.C_Friend_GetBlackList;u.ClientNetwork.getInstance().Send(g.FRIEND_CLIENT_ENUM.P_Friend_GetBlackList,e)},t.prototype.getFriendReqList=function(){var e=new S.C_Friend_GetApplyData;u.ClientNetwork.getInstance().Send(g.FRIEND_CLIENT_ENUM.P_Friend_GetApplyData,e)},t.prototype.getWXFriendRank=function(){this.m_friendRankNode.active=!0,1==this.m_NodeNoFriendTips.active&&(this.m_NodeNoFriendTips.active=!1),1==this.m_NodeNoApplyTips.active&&(this.m_NodeNoApplyTips.active=!1);var e=this.m_friendRankNode.getChildByName("FriendRankTabNode").getChildByName("SoloRankTabNode"),t=this.m_friendRankNode.getChildByName("FriendRankTabNode").getChildByName("CoopRankTabNode");I.default.registerTouchEvent(e,function(){var o,i;1!=e.children[0].active&&(e.children[0].active=!0,t.children[0].active=!1,G.GamePlatform.isWechat()?null===(o=wx.getOpenDataContext())||void 0===o||o.postMessage({event:"getRank",rankType:1}):G.GamePlatform.isQQMiniGame()&&(null===(i=qq.getOpenDataContext())||void 0===i||i.postMessage({event:"getRank",rankType:1})))}),I.default.registerTouchEvent(t,function(){var o,i;1!=t.children[0].active&&(e.children[0].active=!1,t.children[0].active=!0,G.GamePlatform.isWechat()?null===(o=wx.getOpenDataContext())||void 0===o||o.postMessage({event:"getRank",rankType:2}):G.GamePlatform.isQQMiniGame()&&(null===(i=qq.getOpenDataContext())||void 0===i||i.postMessage({event:"getRank",rankType:2})))})},t.prototype.onClickFriendListTab=function(){this.m_nCurSelectType!=r.FRIEND_TAB_TYPE_FRIEND_LIST&&(this.m_nCurSelectType=r.FRIEND_TAB_TYPE_FRIEND_LIST,this.getFriendsList(),this.m_scrollView.node.active=!0,this.m_friendRankNode.active=!1)},t.prototype.onClickRecommendFriendTab=function(){this.m_nCurSelectType!=r.FRIEND_TAB_TYPE_RECOMMEND_FRIEND&&(this.hidePopupWindow(),this.m_nCurSelectType=r.FRIEND_TAB_TYPE_RECOMMEND_FRIEND,this.getRecommonedFriendsList(),this.m_scrollView.node.active=!0,this.m_friendRankNode.active=!1)},t.prototype.onClickBlackFriendTab=function(){this.m_nCurSelectType!=r.FRIEND_TAB_TYPE_BLACK_FRIEND&&(this.hidePopupWindow(),this.m_nCurSelectType=r.FRIEND_TAB_TYPE_BLACK_FRIEND,this.getBlackFriendsList(),this.m_scrollView.node.active=!0,this.m_friendRankNode.active=!1)},t.prototype.onClickFriendRequestTab=function(){this.m_nCurSelectType!=r.FRIEND_TAB_TYPE_FRIEND_REQUEST&&(this.hidePopupWindow(),this.m_nCurSelectType=r.FRIEND_TAB_TYPE_FRIEND_REQUEST,this.getFriendReqList(),this.m_scrollView.node.active=!0,this.m_friendRankNode.active=!1)},t.prototype.onClickFriendRankTab=function(){this.m_nCurSelectType!=r.FRIEND_TAB_TYPE_FRIEND_RANK&&(this.hidePopupWindow(),this.m_nCurSelectType=r.FRIEND_TAB_TYPE_FRIEND_RANK,this.getWXFriendRank(),this.m_scrollView.node.active=!1)},t.prototype.onUUIDEditDidEnded=function(e){this.m_strFriendUUID=e.string},t.prototype.onClickAddFriend=function(){var e=new g.C_Friend_ApplyFriend;if(this.m_strFriendUUID){if(e.applyRoleShowID=this.m_strFriendUUID,d.default.uuidTransformRoieId().toString()===this.m_strFriendUUID)return B.G.StringManager.PopString(B.G.StringManager.getString("APPLY_MYSELF")),this.m_editBox.string="",void(this.m_strFriendUUID="");parseInt(O.getConfigIntValue("friend_max_friend_list_num"))-1<this.m_goodFriendNum?B.G.StringManager.PopString(B.G.StringManager.getString("APPLY_MAX")):u.ClientNetwork.getInstance().Send(g.FRIEND_CLIENT_ENUM.P_Friend_ApplyFriend,e)&&(this.m_editBox.string="",this.m_strFriendUUID="")}else _.ERRORTIPS(s.FRIEND_ERROR_CODE_START_APPLY+3)},t.prototype.onClickRemoveFriend=function(){var e=this;f.default.addPopView("BaseCtrl","FriendPopupTips","FriendPopupTips",{type:R.FRIEND_TIP_TYPE.TIP_TYPE_DEL_FRIEND,showId:this.m_strFriendShowId,cb:function(){var t=new P.C_Friend_DelFriend;t.friendRoleShowID=e.m_strFriendShowId,u.ClientNetwork.getInstance().Send(g.FRIEND_CLIENT_ENUM.P_Friend_DelFriend,t),e.hidePopupWindow()}})},t.prototype.onClickShowFriendInfo=function(){var e=new k.C_Role_GetRoleSimpleInfo;e.showID=this.m_strFriendShowId,u.ClientNetwork.getInstance().Send(L.ROLE_CLIENT_ENUM.P_Role_GetRoleSimpleInfo,e),this.hidePopupWindow()},t.prototype.onClickChat=function(){this.closeView();var e=f.default.getViewByName("MainSceneView");e&&e.view&&V.default.Instance.emit(H.default.SyncChatViewChange,[F.ChatViewVisible.Popup,3,this.m_pRoleData])},t.prototype.showBlackFriend=function(e){var t=this;this.m_NodeNoFriendTips.active=!1,this.m_NodeNoApplyTips.active=!1,this.m_scrollView.content.removeAllChildren();var o=Array.from(e.keys());if(0!=o.length){var i=Array.from(e.values());i.sort(function(e,t){return t.base.score-e.base.score}),I.default.startFraming(o.length,function(e){_.LoadNode("ui/friend/blackInfo").then(function(o){if(o){t.m_scrollView.content.addChild(o);var a=i[e];o.getComponent("FriendItem").initData(e+1,a.base,t),t.m_scrollView.scrollToTop()}})})}},t.prototype.showFriendList=function(e){var t=this;if(this.m_pFriendListData=e,this.m_NodeNoApplyTips.active=!1,this.m_NodeNoFriendTips.active=!1,this.m_scrollView.content.removeAllChildren(),0!=Array.from(e.keys()).length){var o=Array.from(e.values());o.sort(function(e,t){return t.base.score-e.base.score}),I.default.startFraming(o.length,function(e){_.LoadNode("ui/friend/friendInfo").then(function(i){if(i){t.m_scrollView.content.addChild(i);var a=o[e];i.getComponent("FriendItem").initData(e+1,a.base,t),t.m_scrollView.scrollToTop()}})})}else this.m_NodeNoFriendTips.active=!0},t.prototype.setRecommendData=function(e){for(var t=this,o=1;o<=20;o++){var i=e[e.length-o];i&&i.roleInfo.forEach(function(e,o){if(!e.showData.bRobot&&!o.equals(d.default.UUID)){var i=new U;i.setData(e.showData),t.m_pRecommendData&&1==t.m_pRecommendData.has(e.showData.showID)&&(i.coopTime=1),t.m_pRecommendData.set(e.showData.showID,i)}})}},t.prototype.showRecommendFriend=function(e){var t=this;if(this.m_scrollView.content.removeAllChildren(),this.m_NodeNoFriendTips.active=!1,this.m_NodeNoApplyTips.active=!1,this.setRecommendData(e),this.m_pRecommendData){var o=Array.from(this.m_pRecommendData.keys());I.default.startFraming(o.length,function(e){_.LoadNode("ui/friend/friendRecommend").then(function(i){if(i){t.m_scrollView.content.addChild(i);var a=t.m_pRecommendData.get(o[e]);i.getComponent("FriendRecommendItem").initData(a),t.m_scrollView.scrollToTop()}})})}},t.prototype.showFriendReq=function(e){var t=this;this.m_pApplyData=e,this.m_NodeNoFriendTips.active=!1,this.m_scrollView.content.removeAllChildren();var o=Array.from(e.keys());if(0==o.length)return this.m_spriteRedPoint.node.active=!1,void(d.default.getFriendsData().applyNum=0);I.default.startFraming(o.length,function(i){_.LoadNode("ui/friend/friendRequest").then(function(a){if(a){t.m_scrollView.content.addChild(a);var n=e.get(o[i]);a.getComponent("FriendApplyItem").initData(n.base),t.m_scrollView.scrollToTop()}})})},t.prototype.refreshData=function(e,t){this.m_nCurSelectType=e,e==r.FRIEND_TAB_TYPE_FRIEND_LIST?this.showFriendList(t):e==r.FRIEND_TAB_TYPE_RECOMMEND_FRIEND?this.showRecommendFriend(t):e==r.FRIEND_TAB_TYPE_BLACK_FRIEND?this.showBlackFriend(t):this.showFriendReq(t),d.default.getFriendsData().applyNum>0&&(this.m_spriteRedPoint.node.active=!0)},t.prototype.setPopupWindowState=function(e,t,o){this.m_nCurSelectType!=r.FRIEND_TAB_TYPE_BLACK_FRIEND&&(this.m_nodePopupWindow.y=this.node.getChildByName("bg").convertToNodeSpaceAR(e).y,this.m_nodePopupWindow.y+this.m_nodePopupWindow.height/2>this.m_scrollView.node.height/2?this.m_nodePopupWindow.y-=this.m_nodePopupWindow.y+this.m_nodePopupWindow.height/2-this.m_scrollView.node.height/2:this.m_nodePopupWindow.y-this.m_nodePopupWindow.height/2<-this.m_scrollView.node.height/2&&(this.m_nodePopupWindow.y+=-this.m_scrollView.node.height/2-(this.m_nodePopupWindow.y-this.m_nodePopupWindow.height/2)),t!=this.m_strFriendShowId?(this.m_strFriendShowId=t,this.m_nodePopupWindow.active=!0):this.m_strFriendShowId="",this.m_pRoleData=o)},t.prototype.hidePopupWindow=function(){1==this.m_nodePopupWindow.active&&(this.m_nodePopupWindow.active=!1,this.m_strFriendShowId="")},t.prototype.refreshMainRedPoint=function(){var e=f.default.getViewByName("MainSceneView");e&&e.view&&e.view.onShowFriendRedPoint()},t.showRedPoint=function(){return d.default.getFriendsData().applyNum>0},n([j(cc.Node)],t.prototype,"m_NodeNoFriendTips",void 0),n([j(cc.Node)],t.prototype,"m_NodeNoApplyTips",void 0),n([j(cc.Label)],t.prototype,"m_labelMyUUID",void 0),n([j(cc.Sprite)],t.prototype,"m_spriteRedPoint0",void 0),n([j(cc.Sprite)],t.prototype,"m_spriteRedPoint1",void 0),n([j(cc.ScrollView)],t.prototype,"m_scrollView",void 0),n([j(cc.Node)],t.prototype,"m_nodePopupWindow",void 0),n([j(cc.EditBox)],t.prototype,"m_editBox",void 0),n([j(cc.Node)],t.prototype,"m_friendRankNode",void 0),n([c.Register_Class,Y],t)}(l.default);o.default=W,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../common/CommandValue":"CommandValue","../../common/EventConst":"EventConst","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/base/GameView":"GameView","../../modules/manager/EventManager":"EventManager","../../modules/manager/LoadResManager":"LoadResManager","../../network/ClientNetwork":"ClientNetwork","../../network/LocalMessage":"LocalMessage","../../network/protocol/FriendProtocls":"FriendProtocls","../../network/protocol/ObjCollection":"ObjCollection","../../network/protocol/RoleProtocols":"RoleProtocols","../../utils/GamePlatform":"GamePlatform","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils","../../utils/LogUtil":"LogUtil","./FriendPopupTips":"FriendPopupTips"}],FriendPopupTips:[function(e,t,o){"use strict";cc._RF.push(t,"c23c5MMJEBBK6oJxl06GOiO","FriendPopupTips");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0}),o.FRIEND_TIP_TYPE=void 0;var r,s=e("../../modules/base/BaseView"),c=e("../../modules/base/Decorators");(function(e){e[e.TIP_TYPE_DEL_FRIEND=1]="TIP_TYPE_DEL_FRIEND",e[e.TIP_TYPE_FRIEND_INFO=2]="TIP_TYPE_FRIEND_INFO"})(r=o.FRIEND_TIP_TYPE||(o.FRIEND_TIP_TYPE={}));var l=cc._decorator,d=l.ccclass,u=l.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.m_nodeRemoveFriend=null,t.m_nodeFriendInfo=null,t.gotoCb=null,t}return a(t,e),t.path=function(){return"ui/friend/confirmDelete"},t.prototype.init=function(e){e.type==r.TIP_TYPE_DEL_FRIEND?this.m_nodeRemoveFriend.active=!0:e.type==r.TIP_TYPE_FRIEND_INFO&&(this.m_nodeFriendInfo.active=!0,this.initFriendInfo(e.friendInfo)),e.cb&&(this.gotoCb=e.cb)},t.prototype.exitCallBack=function(){this.closeView()},t.prototype.gotoCallBack=function(){this.gotoCb&&(this.gotoCb(),this.exitCallBack())},t.prototype.initFriendInfo=function(){},n([u(cc.Node)],t.prototype,"m_nodeRemoveFriend",void 0),n([u(cc.Node)],t.prototype,"m_nodeFriendInfo",void 0),n([c.Register_Class,d],t)}(s.default);o.default=h,cc._RF.pop()},{"../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators"}],FriendProtocls:[function(e,t,o){"use strict";cc._RF.push(t,"090e7tMVLpNpqrPN9sVAc/F","FriendProtocls"),e("DataViewRW");var i=e("ObjCollection"),a=e("long");(function(e){e[e.P_Friend_Begin=7e6]="P_Friend_Begin",e[e.P_Friend_SynLoginData=7000001]="P_Friend_SynLoginData",e[e.P_Friend_GetGoodFriend=7000002]="P_Friend_GetGoodFriend",e[e.P_Friend_GetBlackList=7000003]="P_Friend_GetBlackList",e[e.P_Friend_GetApplyData=7000004]="P_Friend_GetApplyData",e[e.P_Friend_SetApplyOpen=7000005]="P_Friend_SetApplyOpen",e[e.P_Friend_ApplyFriend=7000006]="P_Friend_ApplyFriend",e[e.P_Friend_BeApplyFriend=7000007]="P_Friend_BeApplyFriend",e[e.P_Friend_AgreeApply=7000008]="P_Friend_AgreeApply",e[e.P_Friend_BeAgreeApply=7000009]="P_Friend_BeAgreeApply",e[e.P_Friend_DelApply=7000010]="P_Friend_DelApply",e[e.P_Friend_DelAllApply=7000011]="P_Friend_DelAllApply",e[e.P_Friend_DelFriend=7000012]="P_Friend_DelFriend",e[e.P_Friend_BeDelFriend=7000013]="P_Friend_BeDelFriend",e[e.P_Friend_AddBlackList=7000014]="P_Friend_AddBlackList",e[e.P_Friend_DelBlackList=7000015]="P_Friend_DelBlackList"})(o.FRIEND_CLIENT_ENUM||(o.FRIEND_CLIENT_ENUM={}));var n=function(){function e(){this.roleID=a.fromValue(0),this.showID=0,this.nickName="",this.isOnline=!1,this.offlineTime=0,this.headID=0,this.headUrl="",this.headFrameID=0,this.score=0,this.sociatyName=""}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<12)return!1;this.roleID=e.getLong();var t=e.getUint32();if(e.getLen()-e.getPos()<t)return!1;if(this.showID=e.getString(t),e.getLen()-e.getPos()<4)return!1;var o=e.getUint32();if(e.getLen()-e.getPos()<o)return!1;if(this.nickName=e.getString(o),e.getLen()-e.getPos()<13)return!1;this.isOnline=e.getBool(),this.offlineTime=e.getInt32(),this.headID=e.getInt32();var i=e.getUint32();if(e.getLen()-e.getPos()<i)return!1;if(this.headUrl=e.getString(i),e.getLen()-e.getPos()<12)return!1;this.headFrameID=e.getInt32(),this.score=e.getInt32();var a=e.getUint32();return!(e.getLen()-e.getPos()<a||(this.sociatyName=e.getString(a),0))},e.prototype.writeNoEnd=function(e){e.setLong(this.roleID),e.setString(this.showID),e.setString(this.nickName),e.setBool(this.isOnline),e.setInt32(this.offlineTime),e.setInt32(this.headID),e.setString(this.headUrl),e.setInt32(this.headFrameID),e.setInt32(this.score),e.setString(this.sociatyName)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Friend_Base_Info=n;var r=function(){function e(){this.base=new n}return e.prototype.read=function(e){return!!this.base.read(e)},e.prototype.writeNoEnd=function(e){this.base.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Friend_Good_Info=r;var s=function(){function e(){this.base=new n}return e.prototype.read=function(e){return!!this.base.read(e)},e.prototype.writeNoEnd=function(e){this.base.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Friend_Black_Info=s;var c=function(){function e(){this.base=new n,this.applyTime=0}return e.prototype.read=function(e){return!(!this.base.read(e)||e.getLen()-e.getPos()<4||(this.applyTime=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){this.base.writeNoEnd(e),e.setInt32(this.applyTime)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Friend_Apply_Info=c;var l=function(){function e(){this.isApplyOpen=!1,this.applyNum=0,this.goodfriend=[],this.blacklist=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<9)return!1;this.isApplyOpen=e.getBool(),this.applyNum=e.getInt32();var t=e.getUint32();this.goodfriend=[];for(var o=0;o<t;++o){var i;if(e.getLen()-e.getPos()<4)return!1;var a=e.getUint32();if(e.getLen()-e.getPos()<a)return!1;i=e.getString(a),this.goodfriend.push(i)}if(e.getLen()-e.getPos()<4)return!1;var n=e.getUint32();this.blacklist=[];for(var r=0;r<n;++r){var s;if(e.getLen()-e.getPos()<4)return!1;var c=e.getUint32();if(e.getLen()-e.getPos()<c)return!1;s=e.getString(c),this.blacklist.push(s)}return!0},e.prototype.writeNoEnd=function(e){e.setBool(this.isApplyOpen),e.setInt32(this.applyNum),e.setUint32(this.goodfriend.length),this.goodfriend.forEach(function(t){e.setString(t)}),e.setUint32(this.blacklist.length),this.blacklist.forEach(function(t){e.setString(t)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Friend_SynLoginData=l;var d=function(){function e(){}return e.prototype.read=function(){return!0},e.prototype.writeNoEnd=function(){},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Friend_GetGoodFriend=d,function(e){e[e.ErrorCode_Friend_GetGoodFriend_Success=0]="ErrorCode_Friend_GetGoodFriend_Success",e[e.ErrorCode_Friend_GetGoodFriend_Failed=1]="ErrorCode_Friend_GetGoodFriend_Failed",e[e.ErrorCode_Friend_GetGoodFriend_NoOpen=2]="ErrorCode_Friend_GetGoodFriend_NoOpen",e[e.ErrorCode_Friend_GetGoodFriend_NoFriendData=3]="ErrorCode_Friend_GetGoodFriend_NoFriendData",e[e.ErrorCode_Friend_GetGoodFriend_NoCompleteData=4]="ErrorCode_Friend_GetGoodFriend_NoCompleteData"}(o.ErrorCode_Friend_GetGoodFriend||(o.ErrorCode_Friend_GetGoodFriend={}));var u=function(){function e(){this.errorcode=0,this.goodfriend=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.errorcode=e.getInt32();var t=e.getUint32();this.goodfriend.clear();for(var o=0;o<t;++o){var i;i=e.getLong();var a=new r;if(!a.read(e))return!1;this.goodfriend.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setUint32(this.goodfriend.size),this.goodfriend.forEach(function(t,o){e.setLong(o),t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Friend_GetGoodFriend=u;var h=function(){function e(){}return e.prototype.read=function(){return!0},e.prototype.writeNoEnd=function(){},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Friend_GetBlackList=h,function(e){e[e.ErrorCode_Friend_GetBlackList_Success=0]="ErrorCode_Friend_GetBlackList_Success",e[e.ErrorCode_Friend_GetBlackList_Failed=1]="ErrorCode_Friend_GetBlackList_Failed",e[e.ErrorCode_Friend_GetBlackList_NoOpen=2]="ErrorCode_Friend_GetBlackList_NoOpen",e[e.ErrorCode_Friend_GetBlackList_NoFriendData=3]="ErrorCode_Friend_GetBlackList_NoFriendData",e[e.ErrorCode_Friend_GetBlackList_NoCompleteData=4]="ErrorCode_Friend_GetBlackList_NoCompleteData"}(o.ErrorCode_Friend_GetBlackList||(o.ErrorCode_Friend_GetBlackList={}));var p=function(){function e(){this.errorcode=0,this.blacklist=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.errorcode=e.getInt32();var t=e.getUint32();this.blacklist.clear();for(var o=0;o<t;++o){var i;i=e.getLong();var a=new s;if(!a.read(e))return!1;this.blacklist.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setUint32(this.blacklist.size),this.blacklist.forEach(function(t,o){e.setLong(o),t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Friend_GetBlackList=p;var f=function(){function e(){}return e.prototype.read=function(){return!0},e.prototype.writeNoEnd=function(){},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Friend_GetApplyData=f,function(e){e[e.ErrorCode_Friend_GetApplyData_Success=0]="ErrorCode_Friend_GetApplyData_Success",e[e.ErrorCode_Friend_GetApplyData_Failed=1]="ErrorCode_Friend_GetApplyData_Failed",e[e.ErrorCode_Friend_GetApplyData_NoOpen=2]="ErrorCode_Friend_GetApplyData_NoOpen",e[e.ErrorCode_Friend_GetApplyData_NoFriendData=3]="ErrorCode_Friend_GetApplyData_NoFriendData"}(o.ErrorCode_Friend_GetApplyData||(o.ErrorCode_Friend_GetApplyData={}));var g=function(){function e(){this.errorcode=0,this.applyData=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.errorcode=e.getInt32();var t=e.getUint32();this.applyData.clear();for(var o=0;o<t;++o){var i;i=e.getLong();var a=new c;if(!a.read(e))return!1;this.applyData.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setUint32(this.applyData.size),this.applyData.forEach(function(t,o){e.setLong(o),t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Friend_GetApplyData=g;var m=function(){function e(){this.isOpen=!1}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<1||(this.isOpen=e.getBool(),0))},e.prototype.writeNoEnd=function(e){e.setBool(this.isOpen)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Friend_SetApplyOpen=m,function(e){e[e.ErrorCode_Friend_SetApplyOpen_Success=0]="ErrorCode_Friend_SetApplyOpen_Success",e[e.ErrorCode_Friend_SetApplyOpen_Failed=1]="ErrorCode_Friend_SetApplyOpen_Failed",e[e.ErrorCode_Friend_SetApplyOpen_NoOpen=2]="ErrorCode_Friend_SetApplyOpen_NoOpen",e[e.ErrorCode_Friend_SetApplyOpen_NoFriendData=3]="ErrorCode_Friend_SetApplyOpen_NoFriendData"}(o.ErrorCode_Friend_SetApplyOpe||(o.ErrorCode_Friend_SetApplyOpe={}));var _=function(){function e(){this.errorcode=0,this.isOpen=!1}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<5||(this.errorcode=e.getInt32(),this.isOpen=e.getBool(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setBool(this.isOpen)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Friend_SetApplyOpen=_;var y=function(){function e(){this.applyRoleShowID=0}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();return!(e.getLen()-e.getPos()<t||(this.applyRoleShowID=e.getString(t),0))},e.prototype.writeNoEnd=function(e){e.setString(this.applyRoleShowID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Friend_ApplyFriend=y,function(e){e[e.ErrorCode_Friend_ApplyFriend_Success=0]="ErrorCode_Friend_ApplyFriend_Success",e[e.ErrorCode_Friend_ApplyFriend_Failed=1]="ErrorCode_Friend_ApplyFriend_Failed",e[e.ErrorCode_Friend_ApplyFriend_NoOpen=2]="ErrorCode_Friend_ApplyFriend_NoOpen",e[e.ErrorCode_Friend_ApplyFriend_NoFriendData=3]="ErrorCode_Friend_ApplyFriend_NoFriendData",e[e.ErrorCode_Friend_ApplyFriend_NoApplyFriendData=4]="ErrorCode_Friend_ApplyFriend_NoApplyFriendData",e[e.ErrorCode_Friend_ApplyFriend_InGoodFriend=5]="ErrorCode_Friend_ApplyFriend_InGoodFriend",e[e.ErrorCode_Friend_ApplyFriend_InBlackList=6]="ErrorCode_Friend_ApplyFriend_InBlackList",e[e.ErrorCode_Friend_ApplyFriend_InApplyApplyList=7]="ErrorCode_Friend_ApplyFriend_InApplyApplyList",e[e.ErrorCode_Friend_ApplyFriend_InApplyGoodFriend=8]="ErrorCode_Friend_ApplyFriend_InApplyGoodFriend",e[e.ErrorCode_Friend_ApplyFriend_InApplyBlackList=9]="ErrorCode_Friend_ApplyFriend_InApplyBlackList",e[e.ErrorCode_Friend_ApplyFriend_ApplyClose=10]="ErrorCode_Friend_ApplyFriend_ApplyClose"}(o.ErrorCode_Friend_ApplyFriend||(o.ErrorCode_Friend_ApplyFriend={}));var v=function(){function e(){this.errorcode=0,this.applyRoleShowID=0}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.errorcode=e.getInt32();var t=e.getUint32();return!(e.getLen()-e.getPos()<t||(this.applyRoleShowID=e.getString(t),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setString(this.applyRoleShowID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Friend_ApplyFriend=v;var C=function(){function e(){this.base=new n}return e.prototype.read=function(e){return!!this.base.read(e)},e.prototype.writeNoEnd=function(e){this.base.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Friend_BeApplyFriend=C;var S=function(){function e(){this.agreeRoleShowID=0}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();return!(e.getLen()-e.getPos()<t||(this.agreeRoleShowID=e.getString(t),0))},e.prototype.writeNoEnd=function(e){e.setString(this.agreeRoleShowID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Friend_AgreeApply=S,function(e){e[e.ErrorCode_Friend_AgreeApply_Success=0]="ErrorCode_Friend_AgreeApply_Success",e[e.ErrorCode_Friend_AgreeApply_Failed=1]="ErrorCode_Friend_AgreeApply_Failed",e[e.ErrorCode_Friend_AgreeApply_NoOpen=2]="ErrorCode_Friend_AgreeApply_NoOpen",e[e.ErrorCode_Friend_AgreeApply_NoFriendData=3]="ErrorCode_Friend_AgreeApply_NoFriendData",e[e.ErrorCode_Friend_AgreeApply_NoAgreeFriendData=4]="ErrorCode_Friend_AgreeApply_NoAgreeFriendData",e[e.ErrorCode_Friend_AgreeApply_NoCompleteData=5]="ErrorCode_Friend_AgreeApply_NoCompleteData",e[e.ErrorCode_Friend_AgreeApply_NoAgreeCompleteData=6]="ErrorCode_Friend_AgreeApply_NoAgreeCompleteData",e[e.ErrorCode_Friend_AgreeApply_FriendListMax=7]="ErrorCode_Friend_AgreeApply_FriendListMax",e[e.ErrorCode_Friend_AgreeApply_AgreeFriendListMax=8]="ErrorCode_Friend_AgreeApply_AgreeFriendListMax",e[e.ErrorCode_Friend_AgreeApply_InGoodFriend=9]="ErrorCode_Friend_AgreeApply_InGoodFriend",e[e.ErrorCode_Friend_AgreeApply_InBlackList=10]="ErrorCode_Friend_AgreeApply_InBlackList",e[e.ErrorCode_Friend_AgreeApply_InAgreeGoodFriend=11]="ErrorCode_Friend_AgreeApply_InAgreeGoodFriend",e[e.ErrorCode_Friend_AgreeApply_InAgreeBlackList=12]="ErrorCode_Friend_AgreeApply_InAgreeBlackList",e[e.ErrorCode_Friend_AgreeApply_NoInApplyList=13]="ErrorCode_Friend_AgreeApply_NoInApplyList"}(o.ErrorCode_Friend_AgreeApply||(o.ErrorCode_Friend_AgreeApply={}));var T=function(){function e(){this.errorcode=0,this.agreeRoleShowID=0}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.errorcode=e.getInt32();var t=e.getUint32();return!(e.getLen()-e.getPos()<t||(this.agreeRoleShowID=e.getString(t),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setString(this.agreeRoleShowID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Friend_AgreeApply=T;var I=function(){function e(){this.base=new n}return e.prototype.read=function(e){return!!this.base.read(e)},e.prototype.writeNoEnd=function(e){this.base.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Friend_BeAgreeApply=I;var N=function(){function e(){this.applyRoleShowID=0}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();return!(e.getLen()-e.getPos()<t||(this.applyRoleShowID=e.getString(t),0))},e.prototype.writeNoEnd=function(e){e.setString(this.applyRoleShowID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Friend_DelApply=N,function(e){e[e.ErrorCode_Friend_DelApply_Success=0]="ErrorCode_Friend_DelApply_Success",e[e.ErrorCode_Friend_DelApply_Failed=1]="ErrorCode_Friend_DelApply_Failed",e[e.ErrorCode_Friend_DelApply_NoOpen=2]="ErrorCode_Friend_DelApply_NoOpen",e[e.ErrorCode_Friend_DelApply_NoFriendData=3]="ErrorCode_Friend_DelApply_NoFriendData",e[e.ErrorCode_Friend_DelApply_NoInApplyList=4]="ErrorCode_Friend_DelApply_NoInApplyList"}(o.ErrorCode_Friend_DelApply||(o.ErrorCode_Friend_DelApply={}));var b=function(){function e(){this.errorcode=0,this.applyRoleShowID=0}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.errorcode=e.getInt32();var t=e.getUint32();return!(e.getLen()-e.getPos()<t||(this.applyRoleShowID=e.getString(t),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setString(this.applyRoleShowID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Friend_DelApply=b;var w=function(){function e(){}return e.prototype.read=function(){return!0},e.prototype.writeNoEnd=function(){},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Friend_DelAllApply=w,function(e){e[e.ErrorCode_Friend_DelAllApply_Success=0]="ErrorCode_Friend_DelAllApply_Success",e[e.ErrorCode_Friend_DelAllApply_Failed=1]="ErrorCode_Friend_DelAllApply_Failed",e[e.ErrorCode_Friend_DelAllApply_NoOpen=2]="ErrorCode_Friend_DelAllApply_NoOpen",e[e.ErrorCode_Friend_DelAllApply_NoFriendData=3]="ErrorCode_Friend_DelAllApply_NoFriendData"}(o.ErrorCode_Friend_DelAllApply||(o.ErrorCode_Friend_DelAllApply={}));var E=function(){function e(){this.errorcode=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Friend_DelAllApply=E;var P=function(){function e(){this.friendRoleShowID=0}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();return!(e.getLen()-e.getPos()<t||(this.friendRoleShowID=e.getString(t),0))},e.prototype.writeNoEnd=function(e){e.setString(this.friendRoleShowID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Friend_DelFriend=P,function(e){e[e.ErrorCode_Friend_DelFriend_Success=0]="ErrorCode_Friend_DelFriend_Success",e[e.ErrorCode_Friend_DelFriend_Failed=1]="ErrorCode_Friend_DelFriend_Failed",e[e.ErrorCode_Friend_DelFriend_NoOpen=2]="ErrorCode_Friend_DelFriend_NoOpen"}(o.ErrorCode_Friend_DelFriend||(o.ErrorCode_Friend_DelFriend={}));var R=function(){function e(){this.errorcode=0,this.friendRoleShowID=0}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.errorcode=e.getInt32();var t=e.getUint32();return!(e.getLen()-e.getPos()<t||(this.friendRoleShowID=e.getString(t),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setString(this.friendRoleShowID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Friend_DelFriend=R;var L=function(){function e(){this.friendRoleShowID=0}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();return!(e.getLen()-e.getPos()<t||(this.friendRoleShowID=e.getString(t),0))},e.prototype.writeNoEnd=function(e){e.setString(this.friendRoleShowID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Friend_BeDelFriend=L;var A=function(){function e(){this.blackRoleShowID=0}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();return!(e.getLen()-e.getPos()<t||(this.blackRoleShowID=e.getString(t),0))},e.prototype.writeNoEnd=function(e){e.setString(this.blackRoleShowID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Friend_AddBlackList=A,function(e){e[e.ErrorCode_Friend_AddBlackList_Success=0]="ErrorCode_Friend_AddBlackList_Success",e[e.ErrorCode_Friend_AddBlackList_Failed=1]="ErrorCode_Friend_AddBlackList_Failed",e[e.ErrorCode_Friend_AddBlackList_NoOpen=2]="ErrorCode_Friend_AddBlackList_NoOpen",e[e.ErrorCode_Friend_AddBlackList_NoFriendData=3]="ErrorCode_Friend_AddBlackList_NoFriendData",e[e.ErrorCode_Friend_AddBlackList_NoCompleteData=4]="ErrorCode_Friend_AddBlackList_NoCompleteData",e[e.ErrorCode_Friend_AddBlackList_InBlackList=5]="ErrorCode_Friend_AddBlackList_InBlackList",e[e.ErrorCode_Friend_AddBlackList_BlackListMax=6]="ErrorCode_Friend_AddBlackList_BlackListMax",e[e.ErrorCode_Friend_AddBlackList_NoBlackFriendData=7]="ErrorCode_Friend_AddBlackList_NoBlackFriendData"}(o.ErrorCode_Friend_AddBlackList||(o.ErrorCode_Friend_AddBlackList={}));var D=function(){function e(){this.errorcode=0,this.blackRoleShowID=0}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.errorcode=e.getInt32();var t=e.getUint32();return!(e.getLen()-e.getPos()<t||(this.blackRoleShowID=e.getString(t),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setString(this.blackRoleShowID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Friend_AddBlackList=D;var M=function(){function e(){this.blackRoleShowID=0}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();return!(e.getLen()-e.getPos()<t||(this.blackRoleShowID=e.getString(t),0))},e.prototype.writeNoEnd=function(e){e.setString(this.blackRoleShowID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Friend_DelBlackList=M,function(e){e[e.ErrorCode_Friend_DelBlackList_Success=0]="ErrorCode_Friend_DelBlackList_Success",e[e.ErrorCode_Friend_DelBlackList_Failed=1]="ErrorCode_Friend_DelBlackList_Failed",e[e.ErrorCode_Friend_DelBlackList_NoOpen=2]="ErrorCode_Friend_DelBlackList_NoOpen",e[e.ErrorCode_Friend_DelBlackList_NoFriendData=3]="ErrorCode_Friend_DelBlackList_NoFriendData",e[e.ErrorCode_Friend_DelBlackList_NoCompleteData=4]="ErrorCode_Friend_DelBlackList_NoCompleteData",e[e.ErrorCode_Friend_DelBlackList_NoInBlackList=5]="ErrorCode_Friend_DelBlackList_NoInBlackList"}(o.ErrorCode_Friend_DelBlackList||(o.ErrorCode_Friend_DelBlackList={}));var B=function(){function e(){this.errorcode=0,this.blackRoleShowID=0}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.errorcode=e.getInt32();var t=e.getUint32();return!(e.getLen()-e.getPos()<t||(this.blackRoleShowID=e.getString(t),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setString(this.blackRoleShowID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Friend_DelBlackList=B,cc._RF.pop()},{DataViewRW:"DataViewRW",ObjCollection:"ObjCollection",long:"long"}],FriendRecommendItem:[function(e,t,o){"use strict";cc._RF.push(t,"c0cdec/HJBNZrshWAXkP5Ep","FriendRecommendItem");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../Global/GameGlobal"),s=e("../../network/ClientNetwork"),c=e("../../network/protocol/FriendProtocls"),l=e("../../utils/GameUtils"),d=e("../../modules/manager/LoadResManager"),u=cc._decorator,h=u.ccclass,p=u.property,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.m_labelFriendName=null,t.m_spFriendIcon=null,t.m_spFriendFrame=null,t.m_labelFriendScore=null,t.m_labelFriendCoopTime=null,t.m_nFriendShowId="",t}return a(t,e),t.prototype.onLoad=function(){},t.prototype.start=function(){},t.prototype.onDestroy=function(){},t.prototype.onClickApply=function(){var e=new c.C_Friend_ApplyFriend;e.applyRoleShowID=this.m_nFriendShowId,s.ClientNetwork.getInstance().Send(c.FRIEND_CLIENT_ENUM.P_Friend_ApplyFriend,e)},t.prototype.initData=function(e){var t=this;this.m_labelFriendName.string=e.nickName,this.m_nFriendShowId=e.showID,this.m_labelFriendScore.string=e.score+"",l.setRemoteHeadIcon(e.headUrl,e.headID,this.m_spFriendIcon);var o=e.headFrameID;(o<=0||o>=2e3)&&(o=200),d.default.loadSpriteFrame("ui/headFrame/frame_"+o).then(function(e){t.m_spFriendFrame.getComponent(cc.Sprite).spriteFrame=e}),this.m_labelFriendCoopTime.string=r.G.StringManager.getString("FRIEND_COOP_TIMES",e.coopTimes)},n([p(cc.Label)],t.prototype,"m_labelFriendName",void 0),n([p(cc.Sprite)],t.prototype,"m_spFriendIcon",void 0),n([p(cc.Sprite)],t.prototype,"m_spFriendFrame",void 0),n([p(cc.Label)],t.prototype,"m_labelFriendScore",void 0),n([p(cc.Label)],t.prototype,"m_labelFriendCoopTime",void 0),n([h],t)}(cc.Component);o.default=f,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../modules/manager/LoadResManager":"LoadResManager","../../network/ClientNetwork":"ClientNetwork","../../network/protocol/FriendProtocls":"FriendProtocls","../../utils/GameUtils":"GameUtils"}],FriendTips:[function(e,t,o){"use strict";cc._RF.push(t,"5937cFYG1xOvZp/LqxE+8pU","FriendTips");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=e("../../utils/ConfigUtils"),l=e("../../utils/GameTools"),d=cc._decorator,u=d.ccclass,h=d.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.m_nodeRemoveFriend=null,t.m_nodeTaskBox=null,t.m_nodeTaskVideo=null,t.m_layoutBoxRewards=null,t.gotoCb=null,t}return a(t,e),t.path=function(){return"ui/friend/friendPrefabs/FriendPopupTips"},t.prototype.init=function(e){e.type==TIP_TYPE.TIP_TYPE_VIDEO?this.m_nodeTaskVideo.active=!0:e.type==TIP_TYPE.TIP_TYPE_BOX?(this.m_nodeTaskBox.active=!0,this.initBoxData(e.id)):this.m_nodeTaskRefresh.active=!0,e.cb&&(this.gotoCb=e.cb)},t.prototype.exitCallBack=function(){this.closeView()},t.prototype.gotoCallBack=function(){this.gotoCb&&(this.gotoCb(),this.exitCallBack())},t.prototype.initBoxData=function(e){var t=this;TaskBoxTableData.getDataMap().forEach(function(o){if(o.boxID==e){var i=c.default.getInstance().getDorpItemsByID(o.prizeID).dropRandom.split("|");for(var a in i){var n=i[a].split("#"),r=n[0];c.default.getInstance().getItemByID(r).icon,l.default.createNormalItems(r,n[1],t.m_layoutBoxRewards.node)}}})},n([h(cc.Node)],t.prototype,"m_nodeRemoveFriend",void 0),n([h(cc.Node)],t.prototype,"m_nodeTaskBox",void 0),n([h(cc.Node)],t.prototype,"m_nodeTaskVideo",void 0),n([h(cc.Layout)],t.prototype,"m_layoutBoxRewards",void 0),n([s.Register_Class,u],t)}(r.default);o.default=p,cc._RF.pop()},{"../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../utils/ConfigUtils":"ConfigUtils","../../utils/GameTools":"GameTools"}],GameClubTaskItem:[function(e,t,o){"use strict";cc._RF.push(t,"33647T3R+JGdphL4dX+LZi/","GameClubTaskItem");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../StaticData/TaskTableData"),s=e("../utils/ConfigUtils"),c=e("../network/protocol/TypeProtocols"),l=e("../utils/GameTools"),d=e("../Global/GameGlobal"),u=cc._decorator,h=u.ccclass,p=u.property,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.TaskProgressBar=null,t.TaskDescLab=null,t.FinishNode=null,t.ReceiveBtnNode=null,t.NoFinishLabNode=null,t}return a(t,e),t.prototype.init=function(e,t){var o=r.TaskTableData.getById(e.taskID);this._taskId=o.id,this.TaskDescLab.string=d.G.StringManager.getWorldString(o.info,o.finishCount);var i=s.default.getInstance().getDorpItemsByID(o.prizeID).dropRandom.split("|");for(var a in i){var n=i[a].split("#");n[0],l.default.createNormalItems(n[0],n[1],this.node.getChildByName("ItemNode"),function(e){e.scale=.8}),this.node.getChildByName("ItemNode").active=!0}this.TaskProgressBar.progress=e.taskCount/o.finishCount,this.TaskProgressBar.progress>=1?this.TaskProgressBar.node.getChildByName("num").getComponent(cc.Label).string=o.finishCount+"/"+o.finishCount:this.TaskProgressBar.node.getChildByName("num").getComponent(cc.Label).string=e.taskCount+"/"+o.finishCount,e.taskState==c.TASK_STATE.TASK_STATE_FINISH?(this.FinishNode.active=!0,this.TaskProgressBar.progress=1,this.TaskProgressBar.node.getChildByName("num").getComponent(cc.Label).string=o.finishCount+"/"+o.finishCount):this.TaskProgressBar.progress>=1?this.ReceiveBtnNode.active=!0:this.NoFinishLabNode.active=!0,this._view=t},t.prototype.onReceiveBtnCallBack=function(){this._view.onReceiveTakeTask(this._taskId)},n([p(cc.ProgressBar)],t.prototype,"TaskProgressBar",void 0),n([p(cc.Label)],t.prototype,"TaskDescLab",void 0),n([p(cc.Node)],t.prototype,"FinishNode",void 0),n([p(cc.Node)],t.prototype,"ReceiveBtnNode",void 0),n([p(cc.Node)],t.prototype,"NoFinishLabNode",void 0),n([h],t)}(cc.Component);o.default=f,cc._RF.pop()},{"../Global/GameGlobal":"GameGlobal","../StaticData/TaskTableData":"TaskTableData","../network/protocol/TypeProtocols":"TypeProtocols","../utils/ConfigUtils":"ConfigUtils","../utils/GameTools":"GameTools"}],GameClubView:[function(e,t,o){"use strict";cc._RF.push(t,"aa03am/OOlHz7VRyQiLYFBd","GameClubView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r,s=e("../modules/base/BaseView"),c=e("../modules/base/Decorators"),l=e("../network/protocol/RoleProtocols"),d=e("../common/PlayerModule"),u=e("../StaticData/TaskTableData"),h=e("../network/protocol/TypeProtocols"),p=e("../utils/ConfigUtils"),f=e("../utils/GameTools"),g=e("../utils/WechatUtils"),m=e("../network/ClientNetwork"),_=e("../network/LocalMessage"),y=e("../modules/base/GameView"),v=e("../utils/GamePlatform"),C=e("../utils/GameUtils"),S=e("../utils/ResourcesManager");(function(e){e[e.First_tab=1]="First_tab",e[e.second_tab=2]="second_tab",e[e.Third_tab=3]="Third_tab",e[e.Forth_tab=4]="Forth_tab"})(r||(r={}));var T=cc._decorator,I=T.ccclass,N=T.property,b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.TaskProgressBar=null,t.TaskScrollView=null,t.TaskItemPrefab=null,t.Gameclub=null,t.BgNode=null,t.signNode=null,t.PostNode=null,t.DayRwdItemPrefab=null,t.taskRedpoint=[],t.newerNode=null,t.newerGetBtnNode=null,t.newerTabBtn=null,t._curTouchTab=r.First_tab,t.nTaskId=0,t.openGameLink="",t}return a(t,e),t.path=function(){return"ui/gameClub/GameClubMain"},t.prototype.onLoad=function(){var e=this,t=this;if(this.initGameClubCfgData(),this.canShowNewerTab(),v.GamePlatform.isWechat()){var o=this.Gameclub.convertToWorldSpaceAR(cc.Vec2.UP);g.WechatUtils.getInstance().onCreatGameClubBtn(this.Gameclub,o),g.WechatUtils.getInstance().m_gameClubBtn&&(g.WechatUtils.getInstance().m_gameClubBtn.show(),g.WechatUtils.getInstance().m_gameClubBtn.onTap(function(){console.log("club on tag"),cc.isValid(t,!0)&&t.clickGameClubBtn()}))}m.ClientNetwork.getInstance().listenProtocol(l.ROLE_CLIENT_ENUM.P_Role_TakeTask,function(t){t.resetPos();var o=new l.S_Role_TakeTask;e.initGameClubCfgData(),e.onRefreshTaskRedpoint(),o.read(t)&&0==o.errorcode&&(o.prize.length>0&&y.default.addPopView("BaseCtrl","AcquirePopupView","AcquirePopupView",{items:o.prize}),r.second_tab==e._curTouchTab?e.initSingView():r.Third_tab==e._curTouchTab?e.initGameClubPostTaskInfo():r.Forth_tab==e._curTouchTab?e.initNewerTab():(r.First_tab,e._curTouchTab))},this),m.ClientNetwork.getInstance().listenProtocol(l.ROLE_CLIENT_ENUM.P_Role_ClientTaskAddCount,function(t){t.resetPos();var o=new l.S_Role_ClientTaskAddCount;e.initGameClubCfgData(),o.read(t)&&0==o.errorcode&&(r.second_tab==e._curTouchTab?e.initSingView():r.Third_tab==e._curTouchTab?e.initGameClubPostTaskInfo():r.Forth_tab==e._curTouchTab&&e.initNewerTab(),e.onRefreshTaskRedpoint())},this),m.ClientNetwork.getInstance().listenLocalMessage(_.LOCAL_MESSAGE.LocalMsg_Game_FrontGround,function(){this.initGameClubCfgData(),this.requestGameClubData(),r.second_tab==this._curTouchTab?this.initSingView():r.Third_tab==this._curTouchTab?this.initGameClubPostTaskInfo():r.Forth_tab==this._curTouchTab&&this.initNewerTab(),this.onRefreshTaskRedpoint()}.bind(this),this)},t.prototype.requestGameClubData=function(){var e=[];this._gameClubPostTaskCfgData.forEach(function(t){var o=u.TaskTableData.getById(t.taskID);if(t.taskState!=h.TASK_STATE.TASK_STATE_FINISH){var i={type:o.showType};e.push(i)}}),e.length>0&&g.WechatUtils.getInstance().getGameClubTaskInfo(e)},t.prototype.start=function(){var e=this;g.WechatUtils.getInstance().requestGameClubOpenlink(),this.initBg(),this.onRefreshTaskRedpoint(),this.returnRedPointStatus()&&(this.Gameclub.getChildByName("redpoint").active=!0),cc.sys.os==cc.sys.OS_WINDOWS?this.setGameClubBtnStatus(!0):this.setGameClubBtnStatus(!1),f.default.registerTouchEvent(this.Gameclub,function(){if(r.First_tab==e._curTouchTab&&cc.sys.os!=cc.sys.OS_WINDOWS){var t=g.WechatUtils.getInstance().getGameOpenLink(),o=e;wx.openPage({openlink:t,success:function(e){console.log("get openlink success"+e),cc.isValid(o,!0)&&o.clickGameClubBtn()},fail:function(e){console.log("get openlink fail"+e)},complete:function(e){console.log("get openlink complete =========================================",e)}})}})},t.prototype.init=function(){},t.prototype.initBg=function(){var e=this,t="https://tfjl-1300944069.file.myqcloud.com/gameClub.png?"+Math.random();cc.assetManager.loadRemote(t,{ext:".png"},function(t,o){if(cc.isValid(e.BgNode,!0)){var i=e.BgNode.getComponent(cc.Sprite);i&&(i.spriteFrame=new cc.SpriteFrame(o))}})},t.prototype.clickGameClubBtn=function(){if(this._gameClubSingTaskCfgData)for(var e=0;e<this._gameClubSingTaskCfgData.length;e++){var t=new l.C_Role_ClientTaskAddCount;t.taskID=this._gameClubSingTaskCfgData[e].taskID,t.count=1,m.ClientNetwork.getInstance().Send(l.ROLE_CLIENT_ENUM.P_Role_ClientTaskAddCount,t)}console.log("club 2");var o=d.default.getServersTime();C.setLocalData("lastClickGameClubTime",o),this.Gameclub.getChildByName("redpoint").active=!1;var i=y.default.getViewByName("MainSceneView");i&&i.view&&i.view.onShowGameClubRedPointNode(!1)},t.prototype.initGameClubCfgData=function(){var e=this,t=[];e._gameClubSingTaskCfgData=[],e._gameClubPostTaskCfgData=[],e._gameClubNewerTaskCfgData=[],Array.from(d.default.getRoleTaskData().tasks.values()).forEach(function(o){var i=u.TaskTableData.getById(o.taskID);55==i.clientType?t.push(o):56==i.clientType?e._gameClubPostTaskCfgData.push(o):60==i.clientType&&e._gameClubNewerTaskCfgData.push(o)});for(var o=t.length-5;o<t.length;o++)e._gameClubSingTaskCfgData.push(t[o])},t.prototype.setGameClubBtnStatus=function(e){g.WechatUtils.getInstance().m_gameClubBtn&&(e?g.WechatUtils.getInstance().m_gameClubBtn.show():g.WechatUtils.getInstance().m_gameClubBtn.hide())},t.prototype.clickFirstTab=function(){r.First_tab!=this._curTouchTab&&(this.BgNode.active=!0,this.initBg(),this.signNode.active=!1,this.PostNode.active=!1,this.newerNode.active=!1,this._curTouchTab=r.First_tab,cc.sys.os==cc.sys.OS_WINDOWS?this.setGameClubBtnStatus(!0):this.setGameClubBtnStatus(!1))},t.prototype.clickSecondTab=function(){r.second_tab!=this._curTouchTab&&(this.BgNode.active=!1,this.signNode.active=!0,this._curTouchTab=r.second_tab,this.PostNode.active=!1,this.newerNode.active=!1,this.setGameClubBtnStatus(!0),this.initSingView())},t.prototype.clickThirdTab=function(){r.Third_tab!=this._curTouchTab&&(this.BgNode.active=!1,this.signNode.active=!1,this.PostNode.active=!0,this.newerNode.active=!1,this._curTouchTab=r.Third_tab,this.setGameClubBtnStatus(!0),this.initGameClubPostTaskInfo())},t.prototype.clickForthTab=function(){r.Forth_tab!=this._curTouchTab&&(this.BgNode.active=!1,this.signNode.active=!1,this.PostNode.active=!1,this.newerNode.active=!0,this._curTouchTab=r.Forth_tab,this.setGameClubBtnStatus(!0),this.initNewerTab())},t.prototype.jumpAppointGameClub=function(){},t.prototype.returnRedPointStatus=function(){var e=d.default.getServersTime(),t=C.getLocalData("lastClickGameClubTime"),o=function(e){var t=new Date(1e3*e);return t.getFullYear()+"-"+(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-"+(t.getDate()<10?"0"+t.getDate():t.getDate())};return o.call(this,e)!=o.call(this,t)},t.prototype.initSingView=function(){var e=this;this.signNode.getChildByName("rwdLayout").removeAllChildren();for(var t=this._gameClubSingTaskCfgData,o=0,i=[],a=function(a){var r=cc.instantiate(n.DayRwdItemPrefab);r.parent=n.signNode.getChildByName("rwdLayout"),o=t[a].taskCount;var s=u.TaskTableData.getById(t[a].taskID);r.getChildByName("day").getComponent(cc.Label).string=s.finishCount+"\u5929",i.push(s.finishCount),n.signNode.getChildByName("sprite"+(a+1)).getChildByName("desc").getComponent(cc.Label).string=s.finishCount,r.getChildByName("selectBg").active=!1;var c=p.default.getInstance().getDorpItemsByID(s.prizeID).dropRandom.split("|");for(var l in c){var d=c[l].split("#");d[0],f.default.createNormalItems(d[0],d[1],r.getChildByName("ItemNode"),function(e){e.scale=.8})}t[a].taskState==h.TASK_STATE.TASK_STATE_FINISH?r.getChildByName("finishNode").active=!0:t[a].taskCount/s.finishCount>=1&&(r.getChildByName("selectBg").active=!0,f.default.registerTouchEvent(r,function(){e.onReceiveTakeTask(t[a].taskID)})),S.default.loadSprite("ui/activity/image/firstRecharge/bg1",n.signNode.getChildByName("sprite"+(a+1)).getComponent(cc.Sprite),function(e){e.addRef()})},n=this,r=0;r<t.length;r++)a(r);for(var s=0,c=0;c<i.length&&!(o<i[0]);c++){if(o>=i[4]){s=6;break}if(o<i[c]){s=c+1;break}}for(r=1;r<s;r++)S.default.loadSprite("ui/activity/image/firstRecharge/bg4",this.signNode.getChildByName("sprite"+r).getComponent(cc.Sprite),function(e){e.addRef()});this.signNode.getChildByName("culDay").getComponent(cc.Label).string="\u5f53\u524d\u767b\u5f55\u5929\u6570:"+o.toString(),this.TaskProgressBar.progress=o%28/28,o%28<=3?o>=i[i.length-1]?this.TaskProgressBar.progress=1:this.TaskProgressBar.progress=0:o>=i[i.length-1]&&(this.TaskProgressBar.progress=1)},t.prototype.initGameClubPostTaskInfo=function(){this.TaskScrollView.content.removeAllChildren();var e=this._gameClubPostTaskCfgData;e=e.sort(function(e,t){var o=u.TaskTableData.getById(e.taskID),i=u.TaskTableData.getById(t.taskID),a=e.taskState,n=t.taskState;return a!=n?a<n?-1:1:o.finishCount<i.finishCount?-1:void 0});for(var t=0;t<e.length;t++){var o=cc.instantiate(this.TaskItemPrefab);o.parent=this.TaskScrollView.content,o.scale=.7,o.getComponent("GameClubTaskItem").init(e[t],this)}},t.prototype.onReceiveTakeTask=function(e){var t=new l.C_Role_TakeTask;t.taskID=e,m.ClientNetwork.getInstance().Send(l.ROLE_CLIENT_ENUM.P_Role_TakeTask,t)},t.prototype.onClickClose=function(){g.WechatUtils.getInstance().m_gameClubBtn&&g.WechatUtils.getInstance().m_gameClubBtn.hide(),this.closeView()},t.prototype.goToGameClub=function(){},t.prototype.onDestroy=function(){m.ClientNetwork.getInstance().removeMessageTarget(this),m.ClientNetwork.getInstance().removeLocalMessage(_.LOCAL_MESSAGE.LocalMsg_Game_FrontGround,this)},t.prototype.onRefreshTaskRedpoint=function(){var e=this;if(this.taskRedpoint[0].active=!1,this.taskRedpoint[1].active=!1,this.taskRedpoint[2].active=!1,this._gameClubSingTaskCfgData.forEach(function(t){var o=u.TaskTableData.getById(t.taskID);t.taskState!=h.TASK_STATE.TASK_STATE_FINISH&&t.taskCount/o.finishCount>=1&&(e.taskRedpoint[0].active=!0)}),this._gameClubPostTaskCfgData.forEach(function(t){var o=u.TaskTableData.getById(t.taskID);t.taskState!=h.TASK_STATE.TASK_STATE_FINISH&&t.taskCount/o.finishCount>=1&&(e.taskRedpoint[1].active=!0)}),this._gameClubNewerTaskCfgData&&this._gameClubNewerTaskCfgData[0]){var t=this._gameClubNewerTaskCfgData[0],o=u.TaskTableData.getById(t.taskID);t.taskState!=h.TASK_STATE.TASK_STATE_FINISH&&t.taskCount/o.finishCount>=1&&(this.taskRedpoint[2].active=!0)}},t.prototype.initNewerTab=function(){var e=this;this.canShowNewerTab();var t=this._gameClubNewerTaskCfgData[0];if(null!=t){this.newerNode.getChildByName("reward").removeAllChildren();var o=u.TaskTableData.getById(t.taskID),i=p.default.getInstance().getDorpItemsByID(o.prizeID).dropRandom.split("|"),a=i.length;for(var n in i){var r=i[n].split("#");r[0],f.default.createNormalItems(r[0],r[1],this.newerNode.getChildByName("reward"),function(t){t.scale=.8,e.newerNode.getChildByName("reward").childrenCount>a&&(t.active=!1)})}t.taskCount<o.finishCount?this.newerGetBtnNode.getComponent(cc.Button).interactable=!1:this.newerGetBtnNode.getComponent(cc.Button).interactable=!0}else console.log("GameClubView, initNewerTab, no task data..!")},t.prototype.canShowNewerTab=function(){var e=this._gameClubNewerTaskCfgData[0];return null==e?(this.newerTabBtn.active=!1,void console.log("GameClubView, initNewerTab, no task data!")):e.taskState==h.TASK_STATE.TASK_STATE_FINISH?(1==this.newerTabBtn.active&&this.clickFirstTab(),void(this.newerTabBtn.active=!1)):void(this.newerTabBtn.active=!0)},t.prototype.onClickNewerGetBtn=function(){var e=this._gameClubNewerTaskCfgData[0];null!=e&&this.onReceiveTakeTask(e.taskID)},n([N(cc.ProgressBar)],t.prototype,"TaskProgressBar",void 0),n([N(cc.ScrollView)],t.prototype,"TaskScrollView",void 0),n([N(cc.Prefab)],t.prototype,"TaskItemPrefab",void 0),n([N(cc.Node)],t.prototype,"Gameclub",void 0),n([N(cc.Node)],t.prototype,"BgNode",void 0),n([N(cc.Node)],t.prototype,"signNode",void 0),n([N(cc.Node)],t.prototype,"PostNode",void 0),n([N(cc.Prefab)],t.prototype,"DayRwdItemPrefab",void 0),n([N(cc.Node)],t.prototype,"taskRedpoint",void 0),n([N(cc.Node)],t.prototype,"newerNode",void 0),n([N(cc.Node)],t.prototype,"newerGetBtnNode",void 0),n([N(cc.Node)],t.prototype,"newerTabBtn",void 0),n([c.Register_Class,I],t)}(s.default);o.default=b,cc._RF.pop()},{"../StaticData/TaskTableData":"TaskTableData","../common/PlayerModule":"PlayerModule","../modules/base/BaseView":"BaseView","../modules/base/Decorators":"Decorators","../modules/base/GameView":"GameView","../network/ClientNetwork":"ClientNetwork","../network/LocalMessage":"LocalMessage","../network/protocol/RoleProtocols":"RoleProtocols","../network/protocol/TypeProtocols":"TypeProtocols","../utils/ConfigUtils":"ConfigUtils","../utils/GamePlatform":"GamePlatform","../utils/GameTools":"GameTools","../utils/GameUtils":"GameUtils","../utils/ResourcesManager":"ResourcesManager","../utils/WechatUtils":"WechatUtils"}],GameController:[function(e,t){"use strict";cc._RF.push(t,"098bai/N+lFNIy8UIYzeM4I","GameController");var o=O(e("../combat/CombatManager")),i=O(e("../combat/unit/DropEquipObj")),a=O(e("../combat/unit/DropMaterialsObj")),n=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=G();if(t&&t.has(e))return t.get(e);var o={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var n=i?Object.getOwnPropertyDescriptor(e,a):null;n&&(n.get||n.set)?Object.defineProperty(o,a,n):o[a]=e[a]}return o.default=e,t&&t.set(e,o),o}(e("../common/CombatModule")),r=e("../network/ClientNetwork"),s=e("../network/FightNetwork"),c=e("../network/protocol/FightProtocols"),l=e("../network/protocol/RoleProtocols"),d=O(e("../utils/ConfigUtils")),u=O(e("../utils/Debug")),h=O(e("../utils/Tools")),p=O(e("../utils/ResourcesManager")),f=O(e("../utils/GameTools")),g=O(e("../common/PlayerModule")),m=e("../network/LocalMessage"),_=e("../Global/GameGlobal"),y=O(e("../utils/GameLoading")),v=e("../network/protocol/TypeProtocols"),C=O(e("../modules/manager/LoadResManager")),S=e("../utils/GameUtils"),T=O(e("../controller/Guide/GuideController")),I=O(e("../controller/Guide/GuideConfig/GuideConst")),N=e("../utils/GamePlatform"),b=O(e("../modules/base/GameView")),w=e("../utils/TimeOffSetManager"),E=O(e("../modules/manager/cheat/CheatValue")),P=O(e("../utils/LogUtil")),R=e("../network/protocol/MatchProtocols"),L=O(e("../utils/ByteDanceMiniGameUtils")),A=O(e("../view/mainScene/CarSkinUtils")),D=O(e("../network/FightReconnectLayer")),M=e("../common/CommandValue"),B=e("../utils/KSMinigameUtils"),k=e("../modules/manager/cheat/SafeNumber");function G(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return G=function(){return e},e}function O(e){return e&&e.__esModule?e:{default:e}}function H(e,t){var o;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(o=V(e))||t&&e&&"number"==typeof e.length){o&&(e=o);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(o=e[Symbol.iterator]()).next.bind(o)}function V(e,t){if(e){if("string"==typeof e)return F(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?F(e,t):void 0}}function F(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,i=new Array(t);o<t;o++)i[o]=e[o];return i}var U=e("../utils/ConstValue"),x=U.Game_State,Y=(U.NPC_TYPE,U.CAR_TEMPLATE_ID),j=U.PLAYER_CAMP,W=U.Enum_Elf_Card,z=U.DROPBOXSPRITE,K=U.DROPBOXSPINEID;cc.Class({extends:cc.Component,onDestroy:function(){cc.assetManager.releaseAsset(this.MapSpriteFrame),this.bloodNodePool.clear(),this.effectNodePool.clear(),this.npcNodePool.clear(),this.flyNodePool.clear(),console.log("setFrameRate="+cc.game.getFrameRate()),r.ClientNetwork.getInstance().removeMessageTarget(this),this.combatObjResFail=null,this.myPlayerSilver=new k.SafeNumber(0),this.sailingSendPhaseNum=0},onLoad:function(){this.playerNode1=cc.find("Map/Player1",this.node),this.playerNode2=cc.find("Map/Player2",this.node),this.RightNpcBloodShadow=cc.find("Map/RightNpcBloodShadow",this.node),this.enemyCarNode=cc.find("Map/ZhanChe",this.node),this.coCarNode1=cc.find("Map/CoPlayer1",this.node),this.coCarNode2=cc.find("Map/CoPlayer2",this.node),this.coCarSkyNode1=cc.find("Map/SkyPlayer1",this.node),this.coCarSkyNode2=cc.find("Map/SkyPlayer2",this.node),this.coCarEnemyNode1=cc.find("Map/EnemyPlayer1",this.node),this.coCarEnemyNode2=cc.find("Map/EnemyPlayer2",this.node),this.playerNpcNode=cc.find("Map/PlayerNpc",this.node),this.LeftNpcBloodShadow=cc.find("Map/LeftNpcBloodShadow",this.node),this.coPlayerNpcNode=cc.find("Map/CoPlayerNpc",this.node),this.skyPlayerNpcNode=cc.find("Map/SkyPlayerNpc",this.node),this.mapNode=cc.find("Map",this.node),this.bloodNode=cc.find("Blood",this.node),this.uiRootNode=cc.find("UIRoot",this.node),this.downNode=cc.find("Down",this.node),this.popBloodNode=cc.find("bloodNode",this.node),this.behitNode=cc.find("behitNode",this.node),this.effectNode=cc.find("effectNode",this.node),this.waitNode=cc.find("waitNode",this.node),this.waitNodeTimeLabel=cc.find("time",this.waitNode).getComponent(cc.Label),this.dt=0,this.waitTime=0;var e=(0,S.getConfigIntValue)("match_fight_wait_report_time"),t=(0,S.getConfigIntValue)("match_fight_wait_loading_time");this.timeOut=Number(e)+Number(t),this.onlistenEvent(),this.onScreenTouchEvent(),this.initBloodNodePool(),this.initEffectNodePool(),this.initNpcNodePool(),this.initFlyNodePool(),this.carResLoadCount=0,this.bShowFightResult=!1,this.node.addComponent(E.default),this.bCheat=!1,this.bCheatTable=!1,this.bCheatTableFile=!1,this.bCheatTableFileNum=0,this.bCheat8094=!1,this.bCheat8096=!1,this.reconnectLoadingComplete=!1,this.reconnectSyncSceneTime=0;var o={sprite:z,spineId:K};this.dropBoxConfig=o,this.monkeyDropBoxConfig=[],this.monkeyDropBoxConfig[j.myPlayer]=o,this.monkeyDropBoxConfig[j.opponents]=o,this.monkeyDropBoxConfig[j.coopPlayer]=o,this.monkeyDropBoxConfig[j.opponentsCoop]=o,p.default.releaseAssets(0),this.combatObjResFail=new Map,this.myPlayerSilver=new k.SafeNumber(0),this.sailingSendPhaseNum=0,this.setBloodAndShadowPos()},setBloodAndShadowPos:function(){if(n.default.getCombatType()==n.CombatType.COOP){var e=this.coPlayerNpcNode.getComponent(cc.Widget),t=this.LeftNpcBloodShadow.getComponent(cc.Widget);e&&t&&(t.left=e.left)}},getCheatValueCom:function(){var e;return null==(e=this.node)?void 0:e.getComponent(E.default)},onGamePause:function(){cc.director.pause()},onGameResume:function(){cc.director.resume()},onScreenTouchEvent:function(){var e=cc.director.getScene(),t=e.getChildByName("clickEffectNode");t&&t.removeFromParent();var i=cc.winSize,a=new cc.Node;a.name="clickEffectNode",a.setContentSize(i),a.setPosition(cc.Vec2.ZERO),a.setAnchorPoint(0,0),a.zIndex=400,a.on("touchend",function(e){if(!(this.downNode.children.length<=0)){var t=this.downNode.children[0].getChildByName("EquipBag").getChildByName("EquipList"),i=this.downNode.children[0].getChildByName("EquipBagLabel").getChildByName("EquipDetail"),a=this.downNode.children[0].getChildByName("EquipBag_b").getChildByName("EquipList_b"),r=this.downNode.children[0].getChildByName("EquipBag_bLabel").getChildByName("EquipDetail_b");cc.rect(t.getBoundingBoxToWorld()).contains(e.getLocation())&&cc.rect(i.getBoundingBoxToWorld()).contains(e.getLocation())&&cc.rect(a.getBoundingBoxToWorld()).contains(e.getLocation())&&cc.rect(r.getBoundingBoxToWorld()).contains(e.getLocation())||(1==i.active&&(i.active=!1),1==r.active&&(r.active=!1));var s=this.fightTopObjViewScript.LeftPassiveTipsLayout,c=this.fightTopObjViewScript.LeftPassiveLayoutNode;cc.rect(s.getBoundingBoxToWorld()).contains(e.getLocation())||(s.active=!1,c.active=!0);var l=this.fightTopObjViewScript.RightPassiveTipsLayout,d=this.fightTopObjViewScript.RightPassiveLayoutNode;if(cc.rect(l.getBoundingBoxToWorld()).contains(e.getLocation())||(l.active=!1,d.active=!0),o.default.getInstance().isCoop()&&n.default.matchType!=v.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE){var u=this.fightTopObjViewScript.BossTipsBtn,h=this.fightTopObjViewScript.BossTips;cc.rect(h.getBoundingBoxToWorld()).contains(e.getLocation())||(u.active=!0,h.active=!1)}if(!T.default._Instance.getGuideStatus()&&n.default.matchType!=v.FIGHT_TYPE.FIGHT_TYPE_BATTLE_GREAT_SAILING){var p=this.downNode.children[0].getChildByName("EmojiNode"),f=this.downNode.children[0].getChildByName("btn_emoji");cc.rect(p.getBoundingBoxToWorld()).contains(e.getLocation())||(f.active=!0,p.active=!1)}}},this),a._touchListener.swallowTouches=!1,e.addChild(a)},loadMapBg:function(){var e=n.default.getBattleMapId(),t=d.default.getInstance().getBattleCfg();for(var o in t)if(t[o].id==e){var i=cc.find("bg",this.node.parent);p.default.loadPrefab(t[o].battle_res,i,function(e){var t=cc.view.getVisibleSize(),o=t.width/1440,i=t.height/720;o>1&&(e.scaleX=o),e.scaleY=i}),h.default.playAudioMusic("music/"+t[o].music);break}},getUIRootNode:function(){return this.node},initBloodNodePool:function(){this.bloodNodePool=new cc.NodePool;for(var e=0;e<50;e++){var t=new cc.Node,o=t.addComponent(cc.Label);o.fontSize=23,o.spacingX=-7,o.horizontalAlign=cc.Label.HorizontalAlign.LEFT,this.bloodNodePool.put(t)}},getBloodNode:function(){return this.popBloodNode},getBloodLabelNode:function(){var e=null;if(this.bloodNodePool.size()>0)e=this.bloodNodePool.get();else{var t=(e=new cc.Node).addComponent(cc.Label);t.fontSize=23,t.spacingX=-7,t.horizontalAlign=cc.Label.HorizontalAlign.LEFT}return e},putBloodLabelNode:function(e){e.x=0,e.y=0,e.scaleX=1,e.scaleY=1,this.bloodNodePool.put(e)},initEffectNodePool:function(){var e=this;this.effectNodePool=new cc.NodePool;for(var t=function(){var t=new cc.Node,o=t.addComponent(sp.Skeleton);o.enableBatch=!0,o.setCompleteListener(function(o){"idle"===(o.animation?o.animation.name:"")&&e.putEffectNode(t)}),e.effectNodePool.put(t)},o=0;o<50;o++)t()},getEffectSpNode:function(){var e=this,t=null;if(this.effectNodePool.size()>0)t=this.effectNodePool.get();else{var o=(t=new cc.Node).addComponent(sp.Skeleton);o.enableBatch=!0,o.setCompleteListener(function(o){"idle"===(o.animation?o.animation.name:"")&&e.putEffectNode(t)})}return t},putEffectNode:function(e){e.x=0,e.y=0,e.scaleX=1,e.scaleY=1,this.effectNodePool.put(e)},getBehitNode:function(){return this.behitNode},getEffectNode:function(){return this.effectNode},initNpcNodePool:function(){this.npcNodePool=new cc.NodePool;for(var e=0;e<50;e++){var t=new cc.Node;t.addComponent(sp.Skeleton).enableBatch=!0,this.npcNodePool.put(t)}},getNpcSpNode:function(){var e=null;return this.npcNodePool.size()>0?e=this.npcNodePool.get():(e=new cc.Node).addComponent(sp.Skeleton).enableBatch=!0,e},putNpcNode:function(e){e.x=0,e.y=0,e.scaleX=1,e.scaleY=1,this.npcNodePool.put(e)},initFlyNodePool:function(){this.flyNodePool=new cc.NodePool;for(var e=0;e<50;e++){var t=new cc.Node;t.addComponent(sp.Skeleton).enableBatch=!0,this.flyNodePool.put(t)}},getFlySpNode:function(){var e=null;return this.flyNodePool.size()>0?e=this.flyNodePool.get():(e=new cc.Node).addComponent(sp.Skeleton).enableBatch=!0,e},putFlyNode:function(e){e.x=0,e.y=0,e.scaleX=1,e.scaleY=1,this.flyNodePool.put(e)},setPlayerNpcNode:function(){var e=this.playerNpcNode;o.default.getInstance().isSkyCastle()?e=this.skyPlayerNpcNode:o.default.getInstance().isCoop()&&(e=this.coPlayerNpcNode),o.default.getInstance().playerNpcNode=e},battleStart:function(){var e=this;if(o.default.getInstance().gameState==x.Reconnect){this.sendFightReadyToServer(),this.reconnectLoadingComplete=!0;var t=new c.C_Fight_Monster_Blood_SYNC;s.FightNetwork.getInstance().Send(c.FIGHT_CLIENT_ENUM.P_Fight_Monster_Blood_SYNC,t)}else{o.default.getInstance().gameState,x.Prepare,this.setPlayerNpcNode(),o.default.getInstance().isPvP()?(o.default.getInstance().initMap(n.default.getBattleMapId(),this.mapNode,this.playerNode1,this.playerNode2,this,this.enemyCarNode,this.coCarNode),o.default.getInstance().summonCar(Y.pvp,j.opponents,1,!0)):o.default.getInstance().isCoop()?(n.default.matchType==v.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE?(o.default.getInstance().initMap(n.default.getBattleMapId(),this.mapNode,this.coCarSkyNode1,this.coCarEnemyNode1,this,this.coCarEnemyNode2,this.coCarSkyNode2),o.default.getInstance().summonCar(Y.coop_front,j.opponents,1,!0),o.default.getInstance().summonCar(Y.coop_back,j.opponentsCoop,1,!0)):o.default.getInstance().initMap(n.default.getBattleMapId(),this.mapNode,this.coCarNode1,this.playerNode2,this,this.enemyCarNode,this.coCarNode2),o.default.getInstance().summonCar(Y.coop_front,j.coopPlayer,1,!0)):o.default.getInstance().initMap(n.default.getBattleMapId(),this.mapNode,this.playerNode1,this.playerNode2,this,this.enemyCarNode,this.coCarNode);var i=n.default.getMatchBattleInfo();if(i&&1==i.bRobot&&(this.scheduleOnce(function(){o.default.getInstance().beginGame()},1),n.default.getCombatType()==n.CombatType.SOLO)){var a=[],r=d.default.getInstance().data["StaticData/ItemTableData"];for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&6===r[l].type&&a.push(r[l]);this.emojiTimer&&(clearInterval(this.emojiTimer),this.emojiTimer=null);var u=32+f.default.getRandomInt(0,25);this.emojiTimer=setInterval(function(){if(!T.default._Instance.getGuideStatus()&&cc.isValid(e,!0)&&f.default.getRandomInt(1,101)>50&&e.fightCardViewScript){var t=f.default.getRand(a.length);e.fightCardViewScript.onShowEmoji(a[t].id,!1)}},1e3*u)}}},start:function(){this.loadMapBg(),this.showCarAppearance(this.battleStart.bind(this))},showCarAppearance:function(e){var t=this,i=_.G.gameLoading.getComponentInChildren(y.default);if(i&&i.hideGameLoading(),this.appearanceCard=[],o.default.getInstance().isCoop())if(n.default.matchType==v.FIGHT_TYPE.FIGHT_TYPE_COOPERATION||n.default.matchType==v.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE||n.default.matchType==v.FIGHT_TYPE.FIGHT_TYPE_WEEK_COOPERATION||n.default.matchType==v.FIGHT_TYPE.FIGHT_TYPE_FOG_HIDDEN||n.default.matchType==v.FIGHT_TYPE.FIGHT_TYPE_MACHINARIUM){var a=A.default.Instance.getCarSpineUrl(A.default.TYPE_COOP_ENTER);C.default.loadSpineNode(a).then(function(o){o.parent=t.coCarNode2,o.getComponent(sp.Skeleton).setAnimation(0,"walk",!0),o.scale=.4,t.appearanceCard.push(o),o.x=.4*-o.width/2,o.y=7;var i=1==n.default.matchRoleIdentity?n.default.getPetId(!0):n.default.getPetId(!1);if(i){var a=d.default.getInstance().getItemByID(i);a&&(0,S.showCombatPet)(o,a.spineId,"chongwu2")}if(i=2==n.default.matchRoleIdentity?n.default.getPetId(!0):n.default.getPetId(!1)){var r=d.default.getInstance().getItemByID(i);r&&(0,S.showCombatPet)(o,r.spineId,"chongwu1")}cc.tween(o).to(1.5,{x:104}).call(function(){e&&e()}).start()}).catch(function(e){P.default.info(e)})}else{var r=A.default.Instance.getCarSpineUrl(A.default.TYPE_ENTER);C.default.loadSpineNode(r).then(function(o){if(p.default.loadSpine("ui/ui_effects/zhanche_shuihua",function(e){e.parent=o,e.getComponent(sp.Skeleton).setAnimation(0,"idle",!0),e.y=-25,e.x=-78}),o.parent=t.playerNode1,o.getComponent(sp.Skeleton).setAnimation(0,"walk",!0),o.scale=.4,t.appearanceCard.push(o),o.x=.4*-o.width/2,o.y=4,n.default.matchType!=v.FIGHT_TYPE.FIGHT_TYPE_COOPERATION&&n.default.matchType!=v.FIGHT_TYPE.FIGHT_TYPE_COOPERATION_GUIDE){var i=g.default.getRoleAttrValByKey(v.ROLE_ATTR_VALUES.ROLE_ATTR_PETID),a=d.default.getInstance().getItemByID(i);a&&(0,S.showCombatPet)(o,a.spineId,(0,S.getSlotNameByCarLv)(1))}cc.tween(o).to(1.5,{x:82}).call(function(){e&&e()}).start()}).catch(function(e){P.default.info(e)})}else{var s=A.default.Instance.getCarSpineUrl(A.default.TYPE_ENTER);C.default.loadSpineNode(s).then(function(o){if(o.parent=t.playerNode1,o.getComponent(sp.Skeleton).setAnimation(0,"walk",!0),o.scale=.4,t.appearanceCard.push(o),o.x=.4*-o.width/2,o.y=4,n.default.matchType!=v.FIGHT_TYPE.FIGHT_TYPE_COOPERATION&&n.default.matchType!=v.FIGHT_TYPE.FIGHT_TYPE_COOPERATION_GUIDE){var i=g.default.getRoleAttrValByKey(v.ROLE_ATTR_VALUES.ROLE_ATTR_PETID),a=d.default.getInstance().getItemByID(i);a&&(0,S.showCombatPet)(o,a.spineId,(0,S.getSlotNameByCarLv)(1))}cc.tween(o).to(1.5,{x:32}).call(function(){e&&e()}).start()}).catch(function(e){P.default.info(e)});var c=n.default.getCarSkinId(j.opponents),l=A.default.Instance.getCarSpineUrl(A.default.TYPE_ENTER,c);C.default.loadSpineNode(l).then(function(e){if(e.parent=t.enemyCarNode,e.getComponent(sp.Skeleton).setAnimation(0,"walk",!0),e.scaleY=.4,e.scaleX=-.4,t.appearanceCard.push(e),e.x=.4*e.width/2,e.y=4,n.default.matchType!=v.FIGHT_TYPE.FIGHT_TYPE_COOPERATION&&n.default.matchType!=v.FIGHT_TYPE.FIGHT_TYPE_COOPERATION_GUIDE){var o=n.default.getPetId(!1);if(o){var i=d.default.getInstance().getItemByID(o);i&&(0,S.showCombatPet)(e,i.spineId,(0,S.getSlotNameByCarLv)(1))}}cc.tween(e).to(1.5,{x:-32}).start()}).catch(function(e){P.default.info(e)})}},initTopUI:function(){var e=this;this.bloodNode.destroyAllChildren(),this.bloodNode.removeAllChildren(),cc.resources.load("ui/blood/fight_top",cc.Prefab,function(t,o){if(t)u.default.err("err----------------------------",t);else if(cc.isValid(e,!0)){var i=cc.instantiate(o);i.parent=e.bloodNode,i.name="FightTopView",f.default.setAdaptiveScreen(i),e.fightTopObjViewScript=i.getComponent("FightTopView"),e.fightTopObjViewScript.init(e),T.default._Instance.getGuideStatus()&&(i.getChildByName("ExitButton").active=!1),e.onLoadResComplete()}})},initDownUI:function(){var e=this;this.downNode.removeAllChildren(),cc.resources.load("ui/down/Down",cc.Prefab,function(t,o){if(t)u.default.err("err----------------------------",t);else if(cc.isValid(e,!0)){var i=cc.instantiate(o);i.parent=e.downNode,f.default.setAdaptiveScreen(i),e._downPrefabNode=i,e.fightCardViewScript=i.getComponent("FightCardView"),e.fightCardViewScript.init(e),e.onLoadResComplete()}})},showResultUI:function(e){this.fightTopObjViewScript&&this.fightTopObjViewScript.onFightend(e)},beginGame:function(){if(N.GamePlatform.isByteDanceMiniGame()?L.default.getInstance().startVideoRecording():N.GamePlatform.isKuaishouMiniGame()?B.KSMinigameUtils.getInstance().startVideoRecording():N.GamePlatform.isKuaishouMiniGame()&&B.KSMinigameUtils.getInstance().startVideoRecording(),this.unscheduleAllCallbacks(),this.waitNode.active=!1,g.default.getRoleAttrValByKey(v.ROLE_ATTR_VALUES.ROLE_ATTR_GUIDE)+1==I.default.BattleGuide.guideId&&r.ClientNetwork.getInstance().pushLocalMessage(m.LOCAL_MESSAGE.LocalMsg_START_GUIDE,I.default.BattleGuide.guideId),g.default.getRoleAttrValByKey(v.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE)<50&&n.default.getCombatType()==n.CombatType.SOLO&&g.default.getRoleAttrValByKey(v.ROLE_ATTR_VALUES.ROLE_ATTR_GUIDE)+1==I.default.BattleSecondGuide.guideId&&r.ClientNetwork.getInstance().pushLocalMessage(m.LOCAL_MESSAGE.LocalMsg_START_GUIDE,I.default.BattleSecondGuide.guideId),o.default.getInstance().gameState!=x.Reconnect&&(this.initTopUI(),this.initDownUI()),T.default._Instance.getGuideStatus()){var e=o.default.getInstance().getPlayerModelByCamp(1);g.default.getRoleAttrValByKey(v.ROLE_ATTR_VALUES.ROLE_ATTR_GUIDE)+1==I.default.BattleSecondGuide.guideId?e.setMoney(150):e.setMoney(100)}this.onShowResidualBloodEffect()},restart:function(){o.default.getInstance().restart(),cc.audioEngine.play(this.backgroundAudio,!0),this.initTopUI(),this.initDownUI()},enterBattleTimeout:function(){if(this.waitNode){var e=!1;this.waitNode.active=!1;var t=_.G.StringManager.getString("ENTER_BATTLE_TIMEOUT");n.default.matchType==v.FIGHT_TYPE.FIGHT_TYPE_BATTLE_EAT_CHICKEN&&(t=_.G.StringManager.getString("CHICKENDINNER_TIP18"),e=!0),b.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:t,onlyConfirmBtn:!0,confirmCb:function(){o.default.getInstance().gameState=x.End,n.default.matchReconnectData=null,n.default.destroy(),o.default.getInstance().exitMap(),g.default.setFightBalanceData(null),_.G.UIManager.isFinghtingScene()&&_.G.UIManager.gotoMainScene(null,function(){if(b.default.addLayerView("BaseCtrl","MainSceneView","MainSceneView"),1==e){var t=new R.C_Match_Chicken_Quit;r.ClientNetwork.getInstance().Send(R.MATCH_CLIENT_ENUM.P_Match_Chicken_Quit,t)}})}})}},update:function(e){if(n.default.getCombatType()==n.CombatType.COOP&&n.default.matchType==v.FIGHT_TYPE.FIGHT_TYPE_BATTLE_GREAT_SAILING){var t=o.default.getInstance().getSelfCar(),i=o.default.getInstance().getCarByCamp(j.coopPlayer);t&&t.node&&(t.node.active=!0),i&&i.node&&(i.node.active=!1)}if(g.default.getFightBalanceData())return this.waitNode.active=!1,void(0==this.bShowFightResult&&(this.bShowFightResult=!0,o.default.getInstance().showFightResult(g.default.getFightBalanceData())));if(o.default.getInstance().gameState==x.Fighting){if(this.waitTime=0,1!=T.default.Instance._bPauseGame)return o.default.getInstance().update(e),!!this.playerBatchModel&&void 0}else if(this.dt+=e,this.dt>=1&&(this.waitTime++,this.dt-=1),o.default.getInstance().gameState==x.Prepare)this.waitTime>=5&&(this.waitNode.active||(this.waitNode.active=!0,o.default.getInstance().gameState=x.Wait));else if(o.default.getInstance().gameState==x.Wait)this.waitNodeTimeLabel.string=String(this.timeOut-this.waitTime),this.waitTime>=this.timeOut&&1==this.waitNode.active&&this.enterBattleTimeout();else if(o.default.getInstance().gameState==x.Reconnect&&this.reconnectLoadingComplete&&(this.reconnectSyncSceneTime+=e,this.reconnectSyncSceneTime>=.5)){this.reconnectSyncSceneTime-=.5;var a=new c.C_Fight_Monster_Blood_SYNC;s.FightNetwork.getInstance().Send(c.FIGHT_CLIENT_ENUM.P_Fight_Monster_Blood_SYNC,a)}},getRandom:function(e,t,o,i){var a=Math.random()*(t-e+1)+e;if(a=Math.floor(a),o.length<i){for(var n=0;n<=o.length&&a!=o[n];n++)if(n==o.length){o.push(a);break}this.getRandom(e,t,o,i)}},onShowDropEquip:function(e,t,r,s,c){if(o.default.getInstance().gameState!=x.End&&o.default.getInstance().gameState!=x.Reconnect)if(s||(s=1),1!==d.default.getInstance().getItemByID(e).type){for(var l=n.default.getDropEquipList(),u=l[r]?l[r]:[],h=!1,p=0;p<u.length;p++)u[p]._templateId!=e&&(h=!0);1==h&&(e=u[u.length-1]._templateId);for(var f=0,g=d.default.getInstance().getEquipByID(e),m=0;m<g.length;m++)g[m].star>f&&(f=g[m].star);for(var _=!1,y=0;y<u.length;y++)if(u[y]._templateId==e&&u[y].starNum>=f){_=!0;break}var v=n.default.getCombatType();if(v==n.CombatType.COOP&&0==_){var C=function(e){if(!e||e.length<=0)return!1;for(var t=e[e.length-1]._templateId,o=0,i=d.default.getInstance().getEquipByID(t),a=0;a<i.length;a++)i[a].star>o&&(o=i[a].star);for(var n=0;n<e.length;n++)if(e[n]._templateId==t&&e[n].starNum>=o)return!0;return!1},S=!1,T=!1;!o.default.getInstance().isSkyCastle()||r!=j.opponents&&r!=j.opponentsCoop?(S=C.call(this,l[1]),T=C.call(this,l[3])):(S=C.call(this,l[2]),T=C.call(this,l[4])),1!=S&&1!=T||(_=!0)}if(1!=_){for(var I=0;I<u.length;I++)u[I]._templateId==e&&u[I].destroy();var N=new i.default;if(N.init(e,t,this.node,r,this._downPrefabNode,c),n.default.pushDropEquipList(N),v==n.CombatType.COOP){var b=n.default.getDropEquipList();r==j.myPlayer?b[j.coopPlayer]=b[r]:!o.default.getInstance().isSkyCastle()||r!=j.opponents&&r!=j.opponentsCoop?b[j.myPlayer]=b[r]:r==j.opponents?b[j.opponentsCoop]=b[r]:b[j.opponents]=b[r]}}else(new a.default).init(1003,t,this.node,r,this._downPrefabNode,100,c)}else(new a.default).init(e,t,this.node,r,this._downPrefabNode,s,c)},onChangeEquip:function(e,t){for(var o=n.default.getDropEquipList(),i=o[e]?o[e]:[],a=t,r=0,s=0;s<i.length;s++)i[s].destroy(),i[s].starNum>r&&(r=i[s].starNum);for(var c=0;c<i.length;c++)i[c].starNum==r?(i[c].onReconnectInit(a,e,r),this._downPrefabNode.getComponent("FightCardView").onRefreshDropEquip(a,r,e)):i[c]._templateId=a},onRefreshEquipNodeName:function(e){for(var t=n.default.getDropEquipList(),i=t[e]?t[e]:[],a=0;a<i.length;a++){var r=d.default.getInstance().getEquipByID(i[a]._templateId);if(r){for(var s=null,c=0;c<r.length;c++)if(r[c].star===i[a].starNum){s=r[c];break}if(!s)continue;var l=null,u=o.default.getInstance().getController()._downPrefabNode;u&&(l=e==j.myPlayer?u.getChildByName("EquipBag").getChildByName("EquipList").getChildByName("EquipNode"+s.equipType):u.getChildByName("EquipBag_b").getChildByName("EquipList_b").getChildByName("EquipNode"+s.equipType+"_b"),i[a].equipNodeName=l.name)}}},onParachuteAct:function(e,t,i,a){var r=this;void 0===i&&(i=1),void 0===a&&(a=1),this.onSaveEquipInfo(e,t,i);var s=new cc.Node,c=e;s.parent=this.node,s.name="balloonNode",s.nEquipId=e,t===j.myPlayer?s.x=-270:s.x=270,n.default.getCombatType()==n.CombatType.COOP&&(t==j.myPlayer||t==j.coopPlayer?s.x=-150:s.x=150),s.y=cc.view.getVisibleSize().height/2,s.addComponent(cc.Sprite),this.dropBoxConfig||(this.dropBoxConfig={sprite:z,spineId:K});var l=this.dropBoxConfig.sprite;if(a%1e3==2||a%1e3==3)if(Math.floor(a/1e3)==n.default.matchRoleIdentity)l=this.monkeyDropBoxConfig[t].sprite;else{var d=t;n.default.getCombatType()==n.CombatType.COOP&&(d=o.default.getInstance().getCoopCarCamp(t)),l=this.monkeyDropBoxConfig[d].sprite}p.default.loadSprite(l,s.getComponent(cc.Sprite),function(){var e=!1;t===j.myPlayer&&s.on(cc.Node.EventType.TOUCH_END,function(o){1!=e&&(e=!0,o.target.stopAllActions(),o.target.removeComponent(cc.Sprite),r.onShowDropEquip(c,o.target.position,t,i,a),o.target.destroy())});var o=cc.callFunc(function(){s.stopAllActions(),s.removeComponent(cc.Sprite),this.onShowDropEquip(c,s.position,t,i,a),s.destroy()},r),n=cc.rotateBy(.5,10),l=cc.rotateBy(.5,-10),d=cc.moveTo(3,s.x,-50),u=cc.spawn(cc.sequence(d,o),cc.repeat(cc.sequence(n,l),10));s.runAction(u)})},onlistenEvent:function(){r.ClientNetwork.getInstance().listenProtocol(l.ROLE_CLIENT_ENUM.P_Role_SoloDropItems,function(){},this),r.ClientNetwork.getInstance().listenLocalMessage(m.LOCAL_MESSAGE.LocalMsg_MatchReconnectSuccess,function(){var e=o.default.getInstance().getMyPlayerSilver();this.setMyPlayerSilver(e),this.reconnectLoadingComplete=!1,this.reconnectSyncSceneTime=0;for(var t=cc.find("balloonNode",this.node);t&&t.isValid;)console.log("balloonNode removed"),t.stopAllActions(),t.removeComponent(cc.Sprite),t.destroy(),t.removeFromParent(!0),t=cc.find("balloonNode",this.node);for(var i=cc.find("materialsNode",this.node);i&&i.isValid;)console.log("materialsNode removed"),i.stopAllActions(),i.removeComponent(cc.Sprite),i.destroy(),i.removeFromParent(!0),i=cc.find("materialsNode",this.node);this.carResLoadCount=0,this.setPlayerNpcNode(),o.default.getInstance().isPvP()?(o.default.getInstance().initMap(n.default.getBattleMapId(),this.mapNode,this.playerNode1,this.playerNode2,this,this.enemyCarNode,this.coCarNode),o.default.getInstance().summonCar(Y.pvp,j.opponents,1,!0)):o.default.getInstance().isCoop()&&(n.default.matchType==v.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE?(o.default.getInstance().initMap(n.default.getBattleMapId(),this.mapNode,this.coCarSkyNode1,this.coCarEnemyNode1,this,this.coCarEnemyNode2,this.coCarSkyNode2),o.default.getInstance().summonCar(Y.coop_front,j.opponents,1,!0),o.default.getInstance().summonCar(Y.coop_back,j.opponentsCoop,1,!0)):o.default.getInstance().initMap(n.default.getBattleMapId(),this.mapNode,this.coCarNode1,this.playerNode2,this,this.enemyCarNode,this.coCarNode2),o.default.getInstance().summonCar(Y.coop_front,j.coopPlayer,1,!0)),this.initTopUI(),this.initDownUI()}.bind(this),this),r.ClientNetwork.getInstance().listenLocalMessage(m.LOCAL_MESSAGE.LocalMsg_CheatValue,function(){this.bCheat=!0,o.default.getInstance().reqFightResult(!1,!0)}.bind(this),this),r.ClientNetwork.getInstance().listenLocalMessage(m.LOCAL_MESSAGE.LocalMsg_CheatTable,function(){var e=Number((0,S.getConfigIntValue)("cheat_table_memory_num"));this.bCheatTableFileNum++,this.bCheatTableFileNum>=e&&(this.bCheatTable=!0,o.default.getInstance().reqFightResult(!1,!0))}.bind(this),this),r.ClientNetwork.getInstance().listenLocalMessage(m.LOCAL_MESSAGE.LocalMsg_CheatTableFile,function(){this.bCheatTableFile=!0,o.default.getInstance().reqFightResult(!1,!0)}.bind(this),this),r.ClientNetwork.getInstance().listenLocalMessage(m.LOCAL_MESSAGE.LocalMsg_Cheat8094,function(){this.bCheat8094=!0,o.default.getInstance().reqFightResult(!1,!0)}.bind(this),this),r.ClientNetwork.getInstance().listenLocalMessage(m.LOCAL_MESSAGE.LocalMsg_Cheat8096,function(){1==g.default.checkModulerOnOffState(M.ModulerViewOnOff.FightCheat8096)&&(this.bCheat8096=!0,o.default.getInstance().reqFightResult(!1,!0))}.bind(this),this),r.ClientNetwork.getInstance().listenLocalMessage(m.LOCAL_MESSAGE.LocalMsg_Game_BackGround,function(){if(o.default.getInstance().gameState==x.Fighting||o.default.getInstance().gameState==x.Reconnect){var e=n.default.getMatchBattleInfo();e&&!e.bRobot&&(D.default.fight_game_back_ground=!0,D.default.fight_game_front_ground=!1,D.default.CloseFightReconnectLayer(),s.FightNetwork.getInstance().Disconnect())}}.bind(this),this),r.ClientNetwork.getInstance().listenLocalMessage(m.LOCAL_MESSAGE.LocalMsg_Game_FrontGround,function(){if(o.default.getInstance().gameState==x.Fighting||o.default.getInstance().gameState==x.Reconnect){var e=n.default.getMatchBattleInfo();e&&!e.bRobot&&(D.default.fight_game_back_ground=!1,D.default.fight_game_front_ground=!0,s.FightNetwork.getInstance().Disconnect(),D.default.ShowFightReconnectLayer())}}.bind(this),this)},sendFightReadyToServer:function(){var e=new c.C_Fight_Loading_Ready;e.fightToken=n.default.matchToken,e.roleID=g.default.UUID,console.log("HHHHHHHHHHHHHHHHHHH fightserver P_Fight_Role_Login req.fightToken start"+e.fightToken+"time"+w.TimeOffSetManager.getMilisecond()),s.FightNetwork.getInstance().Send(c.FIGHT_CLIENT_ENUM.P_Fight_Loading_Ready,e),console.log("HHHHHHHHHHHHHHHHHHH fightserver P_Fight_Role_Login req.fightToken end"+e.fightToken+"time"+w.TimeOffSetManager.getMilisecond())},sendGetEquipToServer:function(e,t,i){if(n.default.getCombatType()!=n.CombatType.PVE&&o.default.getInstance().isPvP()){var a=new c.C_Fight_Update_Equip_SYNC;a.roleID=g.default.UUID,a.updateCar.camp=j.opponents,a.updateCar.equipId=e,a.updateCar.equipLv=t,a.updateCar.pos=i,s.FightNetwork.getInstance().Send(c.FIGHT_CLIENT_ENUM.P_Fight_Update_Equip_SYNC,a)}},onShowReconncetEquip:function(e){var t=o.default.getInstance().getPlayerModelByCamp(e);if(Object.keys(t.carInfo.tbEquipInfo).length>0)for(var i in t.carInfo.tbEquipInfo)this.fightCardViewScript.onRefreshDropEquip(i,t.carInfo.tbEquipInfo[i],e)},onLoadResComplete:function(){if(o.default.getInstance().gameState==x.Reconnect){var e=4;this.carResLoadCount++,o.default.getInstance().isSkyCastle()&&(e=6),this.carResLoadCount==e&&(o.default.getInstance().setReconnectData(),s.FightNetwork.getInstance().Send(c.FIGHT_CLIENT_ENUM.P_Fight_Scene_SYNC_Finish),o.default.getInstance().clearNpcBlood(),o.default.getInstance().beginGame(),this.fightCardViewScript.initReconnectEquip(!0),o.default.getInstance().resumeReconnectMsg(),_.G.UIManager.hideWaitingLayer())}else{var t=2;this.carResLoadCount++,o.default.getInstance().isSkyCastle()&&(t=4),this.carResLoadCount==t&&this.sendFightReadyToServer()}},onSaveEquipInfo:function(e,t){if(1!==d.default.getInstance().getItemByID(e).type){for(var i=0,a=0,r=d.default.getInstance().getEquipByID(e),s=0;s<r.length;s++)r[s].star>i&&(i=r[s].star);var c=n.default.getCombatType(),l=o.default.getInstance().getPlayerModelByCamp(t);if(l){if(Object.keys(l.carInfo.tbEquipInfo).length>0){var u=!1;for(var h in l.carInfo.tbEquipInfo)l.carInfo.tbEquipInfo[h]>=i&&(u=!0),a=l.carInfo.tbEquipInfo[h];if(u){if(t==j.myPlayer){var p=o.default.getInstance().getPlayerModelByCamp(t);if(p){p.sendSliverToServer(100,1,v.SP_CHANGE_TYPE.SP_CHANGE_TYPE_ADD_MINE),p.carInfo.boxSliveNum.value+=100;var f=o.default.getInstance().getCoopPlayerByCamp(t);f&&f.addMoney(100,v.SP_CHANGE_TYPE.SP_CHANGE_TYPE_ADD_MINE)}}return}}if(l.carInfo.tbEquipInfo={},l.carInfo.tbEquipInfo[e]>=i?l.carInfo.tbEquipInfo[e]=i:l.carInfo.tbEquipInfo[e]=a+1,c==n.CombatType.COOP){var g=j.coopPlayer;t!=j.myPlayer&&(g=j.myPlayer),!o.default.getInstance().isSkyCastle()||t!=j.opponents&&t!=j.opponentsCoop||(g=j.opponentsCoop,t!=j.opponents&&(g=j.opponents)),o.default.getInstance().getPlayerModelByCamp(g).carInfo.tbEquipInfo[e]=l.carInfo.tbEquipInfo[e]}}}else if(t==j.myPlayer){var m=o.default.getInstance().getPlayerModelByCamp(t);if(m){m.sendSliverToServer(100,1,v.SP_CHANGE_TYPE.SP_CHANGE_TYPE_ADD_MINE),m.carInfo.boxSliveNum.value+=100;var _=o.default.getInstance().getCoopPlayerByCamp(t);_&&_.addMoney(100,v.SP_CHANGE_TYPE.SP_CHANGE_TYPE_ADD_MINE)}}},onSaveChangeEquip:function(e,t){var i=o.default.getInstance().getPlayerModelByCamp(e),a=0;if(Object.keys(i.carInfo.tbEquipInfo).length>0){for(var r in i.carInfo.tbEquipInfo)i.carInfo.tbEquipInfo[r]>a&&(a=i.carInfo.tbEquipInfo[r]);if(i.carInfo.tbEquipInfo={},i.carInfo.tbEquipInfo[t]=a,n.default.getCombatType()==n.CombatType.COOP){var s=j.coopPlayer;e!=j.myPlayer&&(s=j.myPlayer),!o.default.getInstance().isSkyCastle()||e!=j.opponents&&e!=j.opponentsCoop||(s=j.opponentsCoop,e!=j.opponents&&(s=j.opponents));var c=o.default.getInstance().getPlayerModelByCamp(s);c.carInfo.tbEquipInfo={},c.carInfo.tbEquipInfo[t]=i.carInfo.tbEquipInfo[t]}}},onScheduleOnce:function(e,t,i,a){void 0===i&&(i=0),void 0===a&&(a=!1),this.scheduleOnce(function(){var i=o.default.getInstance().getPlayerModelByCamp(t);if(i){var n=i.reqHeroLevelUp(e,!1,0,0,!0,a);if(1==n){a&&(e=W.rainbowElf+e);var r=i.nHeroLvUpAdditionParam;r?(i.sendHeroLvUpToServer(e,r,0,0),i.nHeroLvUpAdditionParam=null):i.sendHeroLvUpToServer(e,0,0,0)}else-4==n&&(e!=W.guangElf&&e!=W.anElf||(a&&(e=W.rainbowElf+e),i.sendHeroLvUpToServer(e,0,1,0)))}},i)},onShowResidualBloodEffect:function(){var e=this;this.schedule(function t(){var i=e.node.getChildByName("ResidualBloodEffect");if(o.default.getInstance().gameState==x.End)return e.unschedule(t),void(i&&(i.active=!1));var a=!1,n=o.default.getInstance().getSelfCar();o.default.getInstance().isCoop()?n&&o.default.getInstance().getCoopCarByCamp(n.camp)&&(n.hp+o.default.getInstance().getCoopCarByCamp(n.camp).hp)/(n.maxHp+o.default.getInstance().getCoopCarByCamp(n.camp).maxHp)<=.2&&(a=!0):n&&n.hp/n.maxHp<=.2&&(a=!0),i?i.active=a:p.default.loadSpine("ui/ui_effects/shanhong",function(t){if(!cc.isValid(e.node))return t.destroy();t.parent=e.node,t.getComponent(sp.Skeleton).setAnimation(0,"idle",!0),t.name="ResidualBloodEffect",t.active=a;var o=cc.view.getVisibleSize(),i=o.width/1280;o.height,t.scaleX=i})},1)},delayEvent:function(e,t){this.scheduleOnce(function(){e&&e()},t)},combatResFail:function(e){if(0!=g.default.checkModulerOnOffState(47)){this.combatObjResFail.set(e,!0);var t=Number((0,S.getConfigIntValue)("fight_res_fail_max_num"));if(this.combatObjResFail.size>t){var o=_.G.StringManager.getString("RESOURCE_FAIL_MAX");N.GamePlatform.showModalRestartAlert(o)}}},setMyPlayerSilver:function(e){this.myPlayerSilver.value=e,console.log("silversync setMyPlayerSilver="+e)},getMyPlayerSilver:function(){return this.myPlayerSilver.value},getNpcBloodNode:function(e,t){var o=null;return e==j.myPlayer?o=this.LeftNpcBloodShadow.getChildByName(t):e==j.opponents&&(o=this.RightNpcBloodShadow.getChildByName(t)),o},setNpcBloodNode:function(e,t){t==j.myPlayer?e.parent=this.LeftNpcBloodShadow:t==j.opponents&&(e.parent=this.RightNpcBloodShadow);for(var o,i=0,a=H(this.LeftNpcBloodShadow.children);!(o=a()).done;)o.value.name.includes("blood")&&i++;for(var n,r=H(this.RightNpcBloodShadow.children);!(n=r()).done;)n.value.name.includes("blood")&&i++;console.log("bloodNode len="+i)},getNpcShadowNode:function(e,t){var o=null;return null==(o=this.LeftNpcBloodShadow.getChildByName(t))&&(o=this.RightNpcBloodShadow.getChildByName(t)),o},setNpcShadowNode:function(e,t){t==j.myPlayer?e.parent=this.LeftNpcBloodShadow:t==j.opponents&&(e.parent=this.RightNpcBloodShadow);for(var o,i=0,a=H(this.LeftNpcBloodShadow.children);!(o=a()).done;)o.value.name.includes("shadow")&&i++;for(var n,r=H(this.RightNpcBloodShadow.children);!(n=r()).done;)n.value.name.includes("shadow")&&i++;console.log("shadowNode len="+i)}}),cc._RF.pop()},{"../Global/GameGlobal":"GameGlobal","../combat/CombatManager":"CombatManager","../combat/unit/DropEquipObj":"DropEquipObj","../combat/unit/DropMaterialsObj":"DropMaterialsObj","../common/CombatModule":"CombatModule","../common/CommandValue":"CommandValue","../common/PlayerModule":"PlayerModule","../controller/Guide/GuideConfig/GuideConst":"GuideConst","../controller/Guide/GuideController":"GuideController","../modules/base/GameView":"GameView","../modules/manager/LoadResManager":"LoadResManager","../modules/manager/cheat/CheatValue":"CheatValue","../modules/manager/cheat/SafeNumber":"SafeNumber","../network/ClientNetwork":"ClientNetwork","../network/FightNetwork":"FightNetwork","../network/FightReconnectLayer":"FightReconnectLayer","../network/LocalMessage":"LocalMessage","../network/protocol/FightProtocols":"FightProtocols","../network/protocol/MatchProtocols":"MatchProtocols","../network/protocol/RoleProtocols":"RoleProtocols","../network/protocol/TypeProtocols":"TypeProtocols","../utils/ByteDanceMiniGameUtils":"ByteDanceMiniGameUtils","../utils/ConfigUtils":"ConfigUtils","../utils/ConstValue":"ConstValue","../utils/Debug":"Debug","../utils/GameLoading":"GameLoading","../utils/GamePlatform":"GamePlatform","../utils/GameTools":"GameTools","../utils/GameUtils":"GameUtils","../utils/KSMinigameUtils":"KSMinigameUtils","../utils/LogUtil":"LogUtil","../utils/ResourcesManager":"ResourcesManager","../utils/TimeOffSetManager":"TimeOffSetManager","../utils/Tools":"Tools","../view/mainScene/CarSkinUtils":"CarSkinUtils"}],GameGlobal:[function(e,t,o){"use strict";cc._RF.push(t,"bd003eekQ5BV6geZoPqp7d3","GameGlobal"),Object.defineProperty(o,"__esModule",{value:!0}),o.G=o.GameGlobal=void 0;var i=function(){function e(){this._gameInstance=null}return Object.defineProperty(e.prototype,"gameInstance",{get:function(){return this._gameInstance},set:function(e){this._gameInstance=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"StringManager",{get:function(){return this._gameInstance.stringManager},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"UIManager",{get:function(){return this._gameInstance.uiManager},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"waitingLayer",{get:function(){return this._gameInstance.waitingLayer},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mask",{get:function(){return this._gameInstance.mask},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"gameLoading",{get:function(){return this._gameInstance.gameLoading},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"CheatTables",{get:function(){return this._gameInstance.cheatTables},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"LoopRollMsg",{get:function(){return this._gameInstance.loopRollMsg},enumerable:!1,configurable:!0}),e.gameHide=!1,e.Instance=new e,e}();o.GameGlobal=i,o.G=i.Instance,cc._RF.pop()},{}],GameInstance:[function(e,t,o){"use strict";cc._RF.push(t,"c6fb59Sl5dLnIDYSvJ16XOP","GameInstance");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,s=r.ccclass,c=r.property,l=e("../Global/GlobalMsgListener"),d=e("../modules/manager/cheat/CheatTables"),u=e("../view/LoopRollMsg"),h=e("../utils/StringManager"),p=e("../utils/UIManager"),f=e("./GameGlobal"),g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.stringManager=null,t.globalMsgListener=null,t.uiManager=null,t.waitingLayer=null,t.mask=null,t.gameLoading=null,t.cheatTables=null,t.loopRollMsg=null,t}return a(t,e),t.prototype.onLoad=function(){cc.game.addPersistRootNode(this.node),f.G.gameInstance=this},t.prototype.initData=function(){},n([c(h.StringManager)],t.prototype,"stringManager",void 0),n([c(l.GlobalMsgListener)],t.prototype,"globalMsgListener",void 0),n([c(p.UIManager)],t.prototype,"uiManager",void 0),n([c(cc.Node)],t.prototype,"waitingLayer",void 0),n([c(cc.SpriteFrame)],t.prototype,"mask",void 0),n([c(cc.Node)],t.prototype,"gameLoading",void 0),n([c(d.default)],t.prototype,"cheatTables",void 0),n([c(u.default)],t.prototype,"loopRollMsg",void 0),n([s],t)}(cc.Component);o.default=g,cc._RF.pop()},{"../Global/GlobalMsgListener":"GlobalMsgListener","../modules/manager/cheat/CheatTables":"CheatTables","../utils/StringManager":"StringManager","../utils/UIManager":"UIManager","../view/LoopRollMsg":"LoopRollMsg","./GameGlobal":"GameGlobal"}],GameLoading:[function(e,t,o){"use strict";cc._RF.push(t,"b0b76RSH4ND9bwJ8Lhb5ZsC","GameLoading");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r},r=this&&this.__awaiter||function(e,t,o,i){return new(o||(o=Promise))(function(a,n){function r(e){try{c(i.next(e))}catch(t){n(t)}}function s(e){try{c(i.throw(e))}catch(t){n(t)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(r,s)}c((i=i.apply(e,t||[])).next())})},s=this&&this.__generator||function(e,t){var o,i,a,n,r={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return n={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function s(e){return function(t){return c([e,t])}}function c(n){if(o)throw new TypeError("Generator is already executing.");for(;r;)try{if(o=1,i&&(a=2&n[0]?i.return:n[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return r.label++,{value:n[1],done:!1};case 5:r.label++,i=n[1],n=[0];continue;case 7:n=r.ops.pop(),r.trys.pop();continue;default:if(!(a=(a=r.trys).length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){r=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){r.label=n[1];break}if(6===n[0]&&r.label<a[1]){r.label=a[1],a=n;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(n);break}a[2]&&r.ops.pop(),r.trys.pop();continue}n=t.call(e,r)}catch(s){n=[6,s],i=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=e("../Global/GameGlobal"),l=e("../StaticData/LoadingTipsTableData"),d=e("../TableReader"),u=e("../utils/GameUtils"),h=e("./ConfigUtils"),p=e("./ResourceLoader"),f=e("./ResourcesManager"),g=e("./subUtils/GuideLayer"),m=e("./subUtils/SpineMaker"),_=e("./subUtils/SubpackageTools"),y=e("./UIManager"),v=cc._decorator,C=v.ccclass,S=v.property,T=["InstanceTableData","SkillTableData","FlyingObjTableData","HeroTableData","NpcTemplateTableData","BatchTableData","CarTableData","BuffTableData","ResTableData","FightTempTableData","RandomConstTableData","PassiveSkillTableData","SummonTableData","AITableData","ObstacleTableData","ShopTableData","ShopBoxTableData","ShopDropTableData","ShopTavernTableData","StarTableData","AIDataTableData","NameTableData","ItemTableData","EquipTableData","DropTableData","BattleTableData","StringValueTableData","RoleScoreTableData","RankListTypeTableData","LegendTableData","LoadingBgTableData","LoadingTipsTableData","SoloSilverTableData","StringValueTableData","TaskTableData","TaskGroupTableData","TaskBoxTableData","RandShopItemTableData","RandShopPositionTableData","RechargeTableData","LuckyGiftSelectTableData","WorldTableData","RandShopTableData","ErrorCodeTableData","ChatChannelTableData","HeroBubbleTableData","GuidePlotTableData","ConfigIntTableData","DrawPrizeTableData","DrawPrizePoolTableData","SoundTableData","RandRechargeGroupTableData","DiscountRechargeTableData","TotalWatchADBoxTableData","TotalWatchADBoxInfoClientTableData","RankListPrizeTableData","SeasonTableData","RobotTableData","BattlePassTableData","RecruitTableData","CostGetTableData","ActivityDayPrizeTableData","ActivityTableData","ClientIntDataTableData","GoldenLeagueRewardTableData","GoldenLeagueRankListTableData","SociatyLevelTableData","EatChickenRankListTableData","PetTableData","SociatyDonateTableData","SociatyBoxTableData","SociatyCourageMedalGainWayTableData","SociatyDonateNumTableData","QQHallRewardTableData","SociatyRedEnvelopeTableData","SociatyWarRewardTableData","SociatyWarReliveTableData","SociatyWarRankListTableData","RobotNickNameTableData","PushGiftTableData","SociatyAuctionTableData","CarTalentTableData","GreatSailingTableData","GreatSailingRankListTableData","GreatSailingReliveTableData","OnOffTableData","VoucherRechargeTableData","GreatSailingRefreshTableData","SubGameTableData","ProficiencyTableData","SkyCastlePrizeTableData","CastleSkyBoxTableData","HeroSkinTableData","WeekCooperationRankListTableData","WeekCooperationReliveTableData","RoyaleRankListTableData","RoyaleRoomTableData","RoyaleBattlePassTableData","RoyaleRangeTableData","AnniversaryCardTableData","AnniversaryRankListTableData","PetPrizeTableData","AnniversaryBattlePassTableData","FogHiddenPrizeTableData","FogHiddenBoxTableData","RoleScoreFundTableData","NewerThreeDaysGiftTableData","OccupationRankListTableData","MachinariumCardTableData","MachinariumRankListTableData","MachinariumBattlePassTableData","MachinariumRotationTableData","MachinariumRewardTableData"],I=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ProgressField=null,t.ProgressBar=null,t.ProgressBarEffectNode=null,t.BackImg=null,t.TipText=null,t.Percentage=null,t.LoadingTips=null,t.zgtz_LOGO=null,t.bwnsg_LOGO=null,t.IMGBg=null,t.progressBarImg=null,t.effectNode=null,t.loadingTips=new Array,t.currProgress=0,t.tableprogress=0,t.resProgress=0,t.tableprogressWeight=0,t.resProgressWeight=0,t.loading=!1,t}var o;return a(t,e),o=t,t.setCallBack=function(e,t){this.target=e,this.callbackFunction=t},t.path=function(){return"ui/CommonPrefab/GameLoadingNew"},t.prototype.start=function(){},t.prototype.autoAddPregress=function(){if(!(this.currProgress>.95)){this.currProgress+=.01,this.ProgressBar.progress=this.currProgress,this.Percentage.string=Math.ceil(100*this.currProgress)+"";var e=this.progressBarImg.node.getContentSize().width-5,t=this.effectNode.getPosition().y;this.effectNode.setPosition(e,t)}},t.prototype.showUI=function(){this.loading=!1,this.getLoadingTip(),o.bgSpriteFrame&&(this.IMGBg.spriteFrame=o.bgSpriteFrame),this.ProgressBar.progress=0,this.effectNode.destroyAllChildren(),m.SpineMaker.createSpineV2(20002).then(function(e){e&&cc.isValid(this.effectNode)&&(this.effectNode.addChild(e.node),e.setAnimation(0,"idle",!0))}.bind(this)).catch(function(e){cc.error(e)})},t.prototype.showTips=function(){if(this.loadingTips.length<=0)this.TipText.node.active=!1;else{this.TipText.node.active=!0,this.TipText.node.runAction(cc.fadeIn(0));var e=u.getRand(this.loadingTips.length),t=this.loadingTips[e];this.loadingTips.splice(e,1),this.TipText.string=t.tips;var o=Math.floor(t.milisec/1e3),i=cc.callFunc(this.showTips,this),a=cc.sequence(cc.delayTime(o),cc.sequence(p.ResourceLoaderLayer.getRandAction(t.actionType),i));a.setTag(6666),this.TipText.node.stopActionByTag(6666),this.TipText.node.runAction(a)}},t.show=function(){return r(this,void 0,void 0,function(){var e,t,i,a,n,r,l=this;return s(this,function(s){switch(s.label){case 0:return this.isShow=!0,e=p.ResourceLoaderLayer.randomImgBg(),t=0,i=this,a=function(){if(t>=2){if(0==i.isShow)return;cc.log("HHHHHHHHHHHHHHHHHHHHH gameLoading show");var e=c.G.gameLoading;e.active=!0,e.name="gameLoadingNode",e.parent.zIndex=y.GameMainLayerZorder.GMZ_GAMELOADING;var a=e.getComponentInChildren(o);a.initProgressWeight(),a.showUI(),a.showTips(),u.backgroundFitScreen(e,a.IMGBg.node),p.ResourceLoaderLayer.getState()==p.ResoureGameState.ResoureGameState_Main?a.loadStaticData():a.addResource()}},[4,_.LoadResAsync(u.removeFileSuffix(e),cc.SpriteFrame).then(function(o){o?l.bgSpriteFrame=o:cc.error("HHHHHHHHHHHHHH NO BgImg: "+e),t++,a()}).catch(function(e){cc.error(e)})];case 1:return s.sent(),cc.isValid(this)?(n=h.default.getInstance().getResConfig(20002))?(r=u.removeFileSuffix(n.animation),[4,_.LoadResAsync(u.removeFileSuffix(r),sp.SkeletonData).then(function(e){e||cc.error("HHHHHHHHHHHHHH NO jsonFile: "+r),t++,a()}).catch(function(e){cc.error(e)})]):[3,3]:[2];case 2:s.sent(),s.label=3;case 3:return[2]}})})},t.getSceneTagByState=function(){switch(p.ResourceLoaderLayer.getState()){case p.ResoureGameState.ResoureGameState_Main:return y.SceneTag.MainScene;case p.ResoureGameState.ResoureGameState_Pve:return y.SceneTag.PveFightScene;case p.ResoureGameState.ResoureGameState_Pvp:return y.SceneTag.PvpFightScene}return y.SceneTag.NONE},t.prototype.initProgressWeight=function(){p.ResourceLoaderLayer.getState()==p.ResoureGameState.ResoureGameState_Main?(this.resProgressWeight=.7,this.tableprogressWeight=1-this.resProgressWeight):p.ResourceLoaderLayer.getState()==p.ResoureGameState.ResoureGameState_Pve?(this.resProgressWeight=1,this.tableprogressWeight=0):p.ResourceLoaderLayer.getState()==p.ResoureGameState.ResoureGameState_Pvp?(this.resProgressWeight=1,this.tableprogressWeight=0):p.ResourceLoaderLayer.getState()==p.ResoureGameState.ResourceGameState_subgame?(this.resProgressWeight=1,this.tableprogressWeight=0):(this.resProgressWeight=1,this.tableprogressWeight=0,cc.error("HHHHHHHHHHHHHHHH WRONG TYPE"))},t.prototype.addResource=function(){return r(this,void 0,void 0,function(){var e,t,i,a,n,r,c,l,d,u,h,g;return s(this,function(s){switch(s.label){case 0:return p.ResourceLoaderLayer.getState()!=p.ResoureGameState.ResoureGameState_Main?[3,2]:[4,p.ResourceLoaderLayer.getMainNeedResource()];case 1:return s.sent(),cc.isValid(this)?[3,5]:[2];case 2:return p.ResourceLoaderLayer.getState()!=p.ResoureGameState.ResoureGameState_Pve?[3,4]:[4,p.ResourceLoaderLayer.getPveFightNeedResource()];case 3:return s.sent(),cc.isValid(this)?[3,5]:[2];case 4:p.ResourceLoaderLayer.getState()==p.ResoureGameState.ResoureGameState_Pvp?p.ResourceLoaderLayer.getPvpFightNeedResource():p.ResourceLoaderLayer.getState()==p.ResoureGameState.ResourceGameState_subgame?p.ResourceLoaderLayer.getSubGameNeedResource():cc.error("HHHHHHHHHHHHHHHH WRONG TYPE"),s.label=5;case 5:if(e=p.ResourceLoaderLayer.m_PngResources,p.ResourceLoaderLayer.m_Plist_Png_Resources,t=p.ResourceLoaderLayer.allSounds,i=p.ResourceLoaderLayer.allSpineData,a=p.ResourceLoaderLayer.allJson,n=p.ResourceLoaderLayer.allPrefab,r=p.ResourceLoaderLayer.allFont,c=p.ResourceLoaderLayer.allBundle,l=e.size+t.length+i.length+a.length+n.length+r.length+c.length,d=0,this.loading=!0,u=this,l<=0)return u.resProgress=1,u.setProgressData(),[2];h=o.getSceneTagByState(),e.forEach(function(e){_.LoadResAsync(e,cc.SpriteFrame).then(function(){y.SceneTag.MainScene,d++,u.resProgress=d/l,u.setProgressData()}).catch(function(e){cc.error(e)})}),g=0,s.label=6;case 6:return g<t.length?[4,_.LoadResAsync(t[g],cc.AudioClip).then(function(){y.SceneTag.MainScene,d++,u.resProgress=d/l,u.setProgressData()}).catch(function(e){cc.error(e)})]:[3,9];case 7:s.sent(),s.label=8;case 8:return g++,[3,6];case 9:g=0,s.label=10;case 10:return g<n.length?[4,_.LoadResAsync(n[g],cc.Prefab).then(function(){y.SceneTag.MainScene,d++,u.resProgress=d/l,u.setProgressData()}).catch(function(e){cc.error(e)})]:[3,13];case 11:s.sent(),s.label=12;case 12:return g++,[3,10];case 13:g=0,s.label=14;case 14:return g<r.length?[4,_.LoadResAsync(r[g],cc.Font).then(function(){y.SceneTag.MainScene,d++,u.resProgress=d/l,u.setProgressData()}).catch(function(e){cc.error(e)})]:[3,17];case 15:s.sent(),s.label=16;case 16:return g++,[3,14];case 17:g=0,s.label=18;case 18:return g<i.length?[4,_.LoadResAsync(i[g],sp.SkeletonData).then(function(){y.SceneTag.MainScene,d++,u.resProgress=d/l,u.setProgressData()}).catch(function(e){cc.error(e)})]:[3,21];case 19:s.sent(),s.label=20;case 20:return g++,[3,18];case 21:g=0,s.label=22;case 22:return g<a.length?[4,_.LoadResAsync(a[g],cc.JsonAsset).then(function(e){h==y.SceneTag.MainScene&&e.addRef(),d++,u.resProgress=d/l,u.setProgressData()}).catch(function(e){cc.error(e)})]:[3,25];case 23:s.sent(),s.label=24;case 24:return g++,[3,22];case 25:g=0,s.label=26;case 26:return g<c.length?[4,f.default.loadBundleAsync(c[g],function(){d++,u.resProgress=d/l,u.setProgressData()}).catch(function(e){cc.error(e)})]:[3,29];case 27:s.sent(),s.label=28;case 28:return++g,[3,26];case 29:return[2]}})})},t.prototype.setProgressData=function(){if(this.loading){this.unschedule(this.autoAddPregress),this.schedule(this.autoAddPregress,.8);var e=this.tableprogress*this.tableprogressWeight+this.resProgress*this.resProgressWeight;if(!(e<this.currProgress)){this.currProgress=e,this.currProgress>=1&&(this.currProgress=1,this.scheduleOnce(this.stop,.5)),this.ProgressBar.progress=this.currProgress,this.Percentage.string=Math.ceil(100*this.currProgress)+"";var t=this.progressBarImg.node.getContentSize().width-5,o=this.effectNode.getPosition().y;this.effectNode.setPosition(t,o)}}},t.prototype.getLoadingTip=function(){var e=this;l.LoadingTipsTableData.getDataMap().forEach(function(t){e.loadingTips.push(t)})},t.isShowing=function(){return this.isShow},t.prototype.hideGameLoading=function(){cc.log("HHHHHHHHHHHHHHHHHHHHHHHH hideGameLoading hide"),console.log("HHHHHHHHHHHHHHHHHHHHH gameLoading Hide"),c.G.gameLoading.active=!1,o.isShow=!1,this.ProgressBar.progress=0,this.currProgress=0,this.tableprogress=0,this.resProgress=0,o.target=null,o.callbackFunction=null,p.ResourceLoaderLayer.setGameStateOther(),p.ResourceLoaderLayer.clearResourceData()},t.hide=function(){var e=c.G.gameLoading.getComponentInChildren(o);e&&e.hideGameLoading()},t.prototype.resume=function(){this.loading||(this.unschedule(this.autoResume),this.addResource())},t.prototype.autoResume=function(){this.resume()},t.prototype.pause=function(){this.stop(),this.scheduleOnce(this.autoResume,3)},t.prototype.stop=function(){this.loading=!1,o.callbackFunction&&o.callbackFunction.call(o.target)},t.prototype.loadStaticData=function(){return r(this,void 0,void 0,function(){var e,t,o,i,a,n;return s(this,function(){if(!cc.isValid(this))return[2];for(this.loading=!0,e=T.length,t=0,o=this,i=function(i){i&&i.addRef(),t++,o.tableprogress=t/e,o.setProgressData(),t==e&&(o.loading=!1,o.scheduleOnce(o.autoResume,1))},a=0;a<e;a++)n=T[a],d.PreLoadCsvSync(n,i);return[2]})})},t.bgSpriteFrame=null,t.isShow=!1,t.target=null,t.callbackFunction=null,n([S(cc.Sprite)],t.prototype,"ProgressField",void 0),n([S(cc.ProgressBar)],t.prototype,"ProgressBar",void 0),n([S(cc.ScrollView)],t.prototype,"ProgressBarEffectNode",void 0),n([S(cc.Sprite)],t.prototype,"BackImg",void 0),n([S(cc.Label)],t.prototype,"TipText",void 0),n([S(cc.Label)],t.prototype,"Percentage",void 0),n([S(cc.Label)],t.prototype,"LoadingTips",void 0),n([S(cc.Sprite)],t.prototype,"zgtz_LOGO",void 0),n([S(cc.Sprite)],t.prototype,"bwnsg_LOGO",void 0),n([S(cc.Sprite)],t.prototype,"IMGBg",void 0),n([S(cc.Sprite)],t.prototype,"progressBarImg",void 0),n([S(cc.Node)],t.prototype,"effectNode",void 0),o=n([C],t)}(g.NodeNameLayer);o.default=I,cc._RF.pop()},{"../Global/GameGlobal":"GameGlobal","../StaticData/LoadingTipsTableData":"LoadingTipsTableData","../TableReader":"TableReader","../utils/GameUtils":"GameUtils","./ConfigUtils":"ConfigUtils","./ResourceLoader":"ResourceLoader","./ResourcesManager":"ResourcesManager","./UIManager":"UIManager","./subUtils/GuideLayer":"GuideLayer","./subUtils/SpineMaker":"SpineMaker","./subUtils/SubpackageTools":"SubpackageTools"}],GamePlatform:[function(require,module,exports){"use strict";cc._RF.push(module,"3df4f0nWu5PWrjPi3WNPWfi","GamePlatform"),Object.defineProperty(exports,"__esModule",{value:!0}),exports.GamePlatform=exports.PLATFORM_NONE=void 0;var ClientNetwork_1=require("../network/ClientNetwork"),LocalMessage_1=require("../network/LocalMessage"),RechargeTableData_1=require("../StaticData/RechargeTableData"),PlayerModule_1=require("../common/PlayerModule"),TypeProtocols_1=require("../network/protocol/TypeProtocols"),Long=require("../network/protocol/long"),GameUtils_1=require("../utils/GameUtils");exports.PLATFORM_NONE=10;var GamePlatform=function(){function GamePlatform(){}return GamePlatform.ReLogin=function(){},GamePlatform.getInstance=function(){return null==this._instance&&(this._instance=new GamePlatform),this._instance},GamePlatform.Logout=function(){cc.log("Logout"),cc.sys.os==cc.sys.OS_IOS&&(GamePlatform.autoSDK_login=!1),GamePlatform.JsToNative("logout")},GamePlatform.onSDK_AccountSwitch=function(e){console.log("onSDK_AccountSwitch:",e)},GamePlatform.isSDK=function(){},GamePlatform.JsToNative=function(e,t){void 0===t&&(t=""),console.log("jsToNative action:"+e+", params:"+t),GamePlatform.isSDK(),cc.sys.os==cc.sys.OS_IOS&&jsb.reflection.callStaticMethod("SdkManager","messageFromJs:param:",e,t),cc.sys.os==cc.sys.OS_ANDROID&&jsb.reflection.callStaticMethod("SdkManager","messageFromJs","(Ljava/lang/String;Ljava/lang/String;)V",e,t)},GamePlatform.clearWelcomeImage=function(){cc.sys.os==cc.sys.OS_ANDROID&&jsb.reflection.callStaticMethod("SdkManager","clearWelcomeImage","()V"),cc.log("clearWelcomeImage")},GamePlatform.IsH5ByAnnounce=function(){return!(!GamePlatform.is_bigBlueH5&&!GamePlatform.is_bigBlueNoVideoH5)},GamePlatform.IsH5MYByAnnounce=function(){return!!(GamePlatform.is_miyaIosH5||GamePlatform.is_mayiH5yl||GamePlatform.is_mayiH5my||GamePlatform.is_lyH5sq||GamePlatform.is_lyH5dysb||GamePlatform.is_ly5add7||GamePlatform.is_hykb||GamePlatform.is_meituan)},GamePlatform.NativeToJs=function(e,t){console.log("NativeToJs id:"+e+", param:"+t),ClientNetwork_1.ClientNetwork.getInstance().pushLocalMessage(Number(e),t)},GamePlatform.IsMiYa=function(){return!!(GamePlatform.is_mayiH5yl||GamePlatform.is_mayiH5my||GamePlatform.is_lyH5sq||GamePlatform.is_lyH5dysb||GamePlatform.is_ly5add7)||!!cc.sys.isNative&&(GamePlatform.isAndroid()?GamePlatform.is_miya=jsb.reflection.callStaticMethod("org/cocos2dx/javascript/AppActivity","IsMiYaPlatform","()Z"):GamePlatform.isIOS()&&(GamePlatform.is_miya=jsb.reflection.callStaticMethod("AppController","IsTFJLGamePlatform")),GamePlatform.is_miya)},GamePlatform.isQQGameRoom=function(){return this.is_platform_qqGameHall&&cc.sys.platform==cc.sys.DESKTOP_BROWSER},GamePlatform.isNoVideoBag=function(){return GamePlatform.isQQGameRoom()||GamePlatform.IsH5SmallBag()||GamePlatform.IsMiYaIosH5()||GamePlatform.IsDysbSmallBag()||GamePlatform.Is5Add7SmallBag()},GamePlatform.getQQGameUrlParam=function(e){var t=location.href;if(console.log("getQQGameObjectt, url: "+t),-1!=t.indexOf("?"))for(var o=t.substring(t.indexOf("?")+1).split("&"),i=0;i<o.length;i++){var a=o[i].split("=");if(a[0].toLowerCase()==e.toLowerCase())return console.log("getQQGameUrlParam succ, key="+a[0]+", value="+a[1]),a[1]}return""},GamePlatform.getMiYaVideoType=function(){return GamePlatform.is_bigBlueH5||GamePlatform.is_bigBlueNoVideoH5||GamePlatform.is_miyaIosH5||GamePlatform.is_mayiH5yl||GamePlatform.is_mayiH5my||GamePlatform.is_lyH5sq||GamePlatform.is_lyH5dysb||GamePlatform.is_ly5add7?GamePlatform.video_type:cc.sys.isNative?(GamePlatform.isAndroid()?GamePlatform.video_type=jsb.reflection.callStaticMethod("org/cocos2dx/javascript/AppActivity","getVideoTYpe","()Ljava/lang/String;"):GamePlatform.isIOS()&&(GamePlatform.video_type=jsb.reflection.callStaticMethod("AppController","getVideoTYpe")),GamePlatform.video_type):""},GamePlatform.getMiYaVideoTypeNoSet=function(){return GamePlatform.video_type},GamePlatform.getMiYaAnchorType=function(){return GamePlatform.anchor_type},GamePlatform.RequestIsSmallBag=function(){AppActivity.JSToBigBlueH5()},GamePlatform.prototype.setSmallBag=function(e){"smallBag"==e&&(GamePlatform.is_bigBlueH5=!0,GamePlatform.video_type="smallBag",cc.director.emit("javaBridgeSmallBagLoginSuccess"))},GamePlatform.prototype.login=function(loginResult){if(GamePlatform.is_mayiH5my){var vA=loginResult.split("&"),loginData=vA[0],token=vA[1],uid=vA[2];ClientNetwork_1.ClientNetwork.getInstance().pushLocalMessage(LocalMessage_1.LOCAL_MESSAGE.LocalMsg_SmallBagLogin,loginData,token,uid)}else{var data=eval("("+loginResult+")");ClientNetwork_1.ClientNetwork.getInstance().pushLocalMessage(LocalMessage_1.LOCAL_MESSAGE.LocalMsg_SmallBagLogin,data.result,data.token,data.uid)}},GamePlatform.IsYLSmallBag=function(){return GamePlatform.is_mayiH5yl},GamePlatform.IsLYSmallBag=function(){return GamePlatform.is_lyH5sq},GamePlatform.IsMYSmallBag=function(){return GamePlatform.is_mayiH5my},GamePlatform.IsSmallBag=function(){return GamePlatform.is_bigBlueH5},GamePlatform.IsDysbSmallBag=function(){return GamePlatform.is_lyH5dysb},GamePlatform.Is5Add7SmallBag=function(){return GamePlatform.is_ly5add7},GamePlatform.IsH5SmallBag=function(){return GamePlatform.is_bigBlueNoVideoH5},GamePlatform.IsMiYaIosH5=function(){return GamePlatform.is_miyaIosH5},GamePlatform.getMiYaPlatformType=function(){return cc.sys.isNative?(GamePlatform.isAndroid()?GamePlatform.platform_type=jsb.reflection.callStaticMethod("org/cocos2dx/javascript/AppActivity","getPlatformTYpe","()Ljava/lang/String;"):GamePlatform.isIOS()&&(GamePlatform.platform_type="ly"),GamePlatform.platform_type):GamePlatform.platform_type},GamePlatform.getMiYa=function(){return GamePlatform.is_miya},GamePlatform.setLY5Add7Pid=function(e){GamePlatform.pid=e},GamePlatform.setMiYaVideoRwd=function(e){GamePlatform.m_MiYaVideoRwd=null,GamePlatform.m_MiYaVideoRwd=e},GamePlatform.setVideoShowTime=function(e){GamePlatform.videoShowTime=e},GamePlatform.setAppPayTime=function(e){GamePlatform.payTime=e},GamePlatform.prototype.setPlayVideoStatus=function(){cc.audioEngine.resumeMusic(),GamePlatform.is_play_video&&setTimeout(function(){GamePlatform.is_play_video=!1},1e3)},GamePlatform.prototype.playVideoError=function(){console.log("play video error"),ClientNetwork_1.ClientNetwork.getInstance().pushLocalMessage(LocalMessage_1.LOCAL_MESSAGE.LocalMsg_BuyVideoByGold)},GamePlatform.prototype.GrantMiYaVideoRwd=function(){var e=(new Date).getTime();console.log("currentTime==========================",e),GamePlatform.m_MiYaVideoRwd.finishCb&&e-GamePlatform.videoShowTime>=6e3&&GamePlatform.m_MiYaVideoRwd.finishCb(),GamePlatform.m_MiYaVideoRwd=null},GamePlatform.prototype.GrantTFJLGameVideoRwd=function(){var e=(new Date).getTime();GamePlatform.m_MiYaVideoRwd.finishCb&&e-GamePlatform.videoShowTime>=6e3&&GamePlatform.m_MiYaVideoRwd.finishCb(),GamePlatform.m_MiYaVideoRwd=null},GamePlatform.sendLogin=function(){},GamePlatform.MiYaToPay=function(e){var t=RechargeTableData_1.RechargeTableData.getById(e.rechargeID),o=e.rechargeValue,i=GamePlatform.m_MiYaLoginData.zone,a=t.money/100,n="com.miya.tfjl.apple."+a,r=t.info,s=t.info,c=e.rechargeNum,l=PlayerModule_1.default.roleName,d=PlayerModule_1.default.uuidTransformRoieId(),u=i+"\u670d",h=GamePlatform.getOnlineTime()[2],p=PlayerModule_1.default.getRoleAttrValByKey(TypeProtocols_1.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE);if("bigBlue"==GamePlatform.video_type&&GamePlatform.isIOS()&&(n="tfshz"+a),GamePlatform.is_bigBlueH5||GamePlatform.is_mayiH5yl||GamePlatform.is_mayiH5my||GamePlatform.is_lyH5sq||GamePlatform.is_lyH5dysb||GamePlatform.is_ly5add7)AppActivity.purchase(o,i,a,n,r,s,c,"1",l,d,u,"","1");else if(GamePlatform.is_bigBlueNoVideoH5||GamePlatform.is_miyaIosH5){var f={orderId:o,goods:r,money:a,ext:1,uid:GameUtils_1.getLocalData("uid"),token:GameUtils_1.getLocalData("token"),roleId:d,roleName:l,level:"1",serverId:i,goodsId:n,goodsDecs:s,serverName:u,num:c,vip:"1",giftNum:1,power:p};TGESDK.pay(f,function(e){console.log("pay info",e,e.info)})}else GamePlatform.isAndroid()?jsb.reflection.callStaticMethod("org/cocos2dx/javascript/AppActivity","purchase","(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V",o,i,a,n,r,s,c,"1",l,d,u,"","1"):GamePlatform.isIOS()&&("bigBlue"==GamePlatform.video_type?jsb.reflection.callStaticMethod("AppController","charge:goodName:orderId:price:roleLv:vipLevel:roleId:roleName:serverId:onlineTime:",n,r,o,a,"1","1",d,l,i,h):jsb.reflection.callStaticMethod("AppController","charge:goodName:orderId:price:roleLv:vipLevel:roleId:roleName:",n,r,o,a,"1","1",d,l))},GamePlatform.sendInfoGame=function(e,t,o){void 0===t&&(t=Long.fromNumber(0)),void 0===o&&(o="");var i=PlayerModule_1.default.getServersTime(),a=GamePlatform.m_MiYaLoginData.zone||"",n=a+"\u670d",r=PlayerModule_1.default.uuidTransformRoieId(),s=PlayerModule_1.default.roleName,c=PlayerModule_1.default.getRoleAttrValByKey(TypeProtocols_1.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE)||"1",l=i,d=i;if("bigBlue"==GamePlatform.video_type&&("createrole"==e?(r=PlayerModule_1.default.otherUUidTransformRoieId(t),s=o,l=i=((new Date).getTime()/1e3).toFixed(0),d=i):r=PlayerModule_1.default.uuidTransformRoieId()),!GamePlatform.IsSmallBag()&&!GamePlatform.IsLYSmallBag()&&"lyH5sq"!=GamePlatform.video_type&&"lyH5dysb"!=GamePlatform.video_type&&"ly5add7"!=GamePlatform.video_type||GamePlatform.is_hykb)if(GamePlatform.is_mayiH5my||GamePlatform.is_mayiH5yl||GamePlatform.is_hykb)AppActivity.sendInfoGame(a,n,r,s,c,l,d,"1");else if(GamePlatform.is_bigBlueNoVideoH5||GamePlatform.is_miyaIosH5){if("enterGame"==e){var u={appver:1,uid:GameUtils_1.getLocalData("uid"),server:a,roleLevel:c,role:s,power:c,roleId:r},h={gold:PlayerModule_1.default.diamondNum,uid:GameUtils_1.getLocalData("uid"),roleId:r,roleName:s,serverid:a,servername:n,roleCTime:"",roleLevel:c,arrver:1,role:s,power:c,virtual_one:PlayerModule_1.default.diamondNum,virtual_two:PlayerModule_1.default.goldNum},p={appver:1,uid:GameUtils_1.getLocalData("uid"),server:a,roleLevel:c,role:s,power:c};TGESDK.loginsuccess({},function(e){console.log("TGESDK.loginsuccess",e)}),TGESDK.loginView(p,function(e){console.log("TGESDK.loginLog",e)}),TGESDK.loginLog(h,function(e){console.log("TGESDK.loginLog",e)}),TGESDK.entry(u,function(e){console.log("TGESDK.entry enterGame",e)})}else if("createrole"==e||"lvUp"==e){var f=3;"createrole"==e&&(f=2),u={appver:1,uid:GameUtils_1.getLocalData("uid"),token:GameUtils_1.getLocalData("token"),roleId:r,roleName:s,roleLevel:c,zoneId:a,zoneName:n,roleCTime:l,type:f,vip:"1",serverName:n,serverId:a,virtual_one:0,virtual_two:0,power:1},TGESDK.setdata(u,function(e){console.log("TGESDK.entry setdata",e)})}}else GamePlatform.isAndroid()?"bigBlue"==GamePlatform.video_type?jsb.reflection.callStaticMethod("org/cocos2dx/javascript/AppActivity","sendInfoGame","(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V",e,a,n,r,s,c,l,d,"1"):jsb.reflection.callStaticMethod("org/cocos2dx/javascript/AppActivity","sendInfoGame","(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V",a,n,r,s,c,l,d,"1"):GamePlatform.isIOS()&&("bigBlue"==GamePlatform.video_type?jsb.reflection.callStaticMethod("AppController","enterGameReport:roleLv:roleId:roleName:serverName:vip:type:",a,c,r,s,n,"1",e):jsb.reflection.callStaticMethod("AppController","enterGameReport:roleId:",a,r));else AppActivity.sendInfoGame(e,a,n,r,s,c,l,d,"1")},GamePlatform.setMiYaLoginData=function(e){GamePlatform.m_MiYaLoginData=e},GamePlatform.setcodeSit=function(e){GamePlatform.isIOS()&&(GamePlatform.ios_update=e)},GamePlatform.getcodeSit=function(){return GamePlatform.ios_update},GamePlatform.setOnlineLoginTime=function(){GamePlatform.onlineLoginTime=(new Date).getTime(),console.log("GamePlatform.onlineLoginTime==========================",GamePlatform.onlineLoginTime)},GamePlatform.getOnlineTime=function(){var e=(new Date).getTime()-GamePlatform.onlineLoginTime,t=e%864e5,o=t%36e5,i=o%6e4;return[Math.floor(e/864e5),Math.floor(t/36e5),Math.floor(o/6e4),Math.round(i/1e3)]},GamePlatform.getMiYaLoginData=function(){return GamePlatform.m_MiYaLoginData},GamePlatform.isAndroid=function(){return cc.sys.os==cc.sys.OS_ANDROID},GamePlatform.isIOS=function(){return cc.sys.os==cc.sys.OS_IOS},GamePlatform.isWechat=function(){return cc.sys.platform==cc.sys.WECHAT_GAME&&"undefined"==typeof qq&&"undefined"==typeof tt&&"undefined"==typeof ks},GamePlatform.isPC=function(){return cc.sys.os==cc.sys.OS_WINDOWS},GamePlatform.isQQMiniGame=function(){return"undefined"!=typeof qq},GamePlatform.isKuaishouMiniGame=function(){return"undefined"!=typeof ks},GamePlatform.isByteDanceMiniGame=function(){return"undefined"!=typeof tt},GamePlatform.getWechatSysInfoSync=function(){return GamePlatform.wechatSysInfo||(GamePlatform.wechatSysInfo=wx.getSystemInfoSync()),GamePlatform.wechatSysInfo},GamePlatform.reportWXLog=function(e){try{if(GamePlatform.isWechat()){var t=wx.getRealtimeLogManager?wx.getRealtimeLogManager():null;t&&t.error.apply(t,e)}}catch(o){}},GamePlatform.safeJsonParse=function(e){var t=null;try{t=JSON.parse(e)}catch(o){t=null,console.error("safeJsonParse fail:",e)}return t},GamePlatform.showModalRestartAlert=function(e,t){if(GamePlatform.isWechat())ClientNetwork_1.ClientNetwork.getInstance().stopSendPing(),wx.showModal({title:"\u63d0\u793a",content:e,showCancel:!1,complete:function(){console.log("clickreboot"),t&&t(),wx.exitMiniProgram()}});else if(GamePlatform.isQQMiniGame())ClientNetwork_1.ClientNetwork.getInstance().stopSendPing(),qq.showModal({title:"\u63d0\u793a",content:e,showCancel:!1,complete:function(){console.log("clickreboot"),qq.exitMiniProgram()}});else if(GamePlatform.isByteDanceMiniGame())ClientNetwork_1.ClientNetwork.getInstance().stopSendPing(),tt.showModal({title:"\u63d0\u793a",content:e,showCancel:!1,complete:function(){console.log("clickreboot"),tt.exitMiniProgram()}});else{if(!GamePlatform.isKuaishouMiniGame())return!1;ClientNetwork_1.ClientNetwork.getInstance().stopSendPing(),ks.showModal({title:"\u63d0\u793a",content:e,showCancel:!1,complete:function(){console.log("clickreboot"),ks.exitMiniProgram()}})}return!0},GamePlatform._instance=null,GamePlatform.GAME_PLATFORM=exports.PLATFORM_NONE,GamePlatform.SERVER_GROUP_ID=0,GamePlatform.videoShowTime=0,GamePlatform.payTime=0,GamePlatform.wechatSysInfo=null,GamePlatform.onlineLoginTime=0,GamePlatform.isIOS_preview=!1,GamePlatform.is_miya=!1,GamePlatform.ios_update=!1,GamePlatform.is_play_video=!1,GamePlatform.video_type="",GamePlatform.anchor_type="",GamePlatform.platform_type="",GamePlatform.m_MiYaLoginData=null,GamePlatform.m_MiYaVideoRwd=null,GamePlatform.is_bigBlueH5=!1,GamePlatform.is_bigBlueNoVideoH5=!1,GamePlatform.is_miyaIosH5=!1,GamePlatform.is_mayiH5yl=!1,GamePlatform.is_mayiH5my=!1,GamePlatform.is_lyH5sq=!1,GamePlatform.is_lyH5dysb=!1,GamePlatform.is_ly5add7=!1,GamePlatform.pid=0,GamePlatform.miyaIospid=0,GamePlatform.is_hykb=!1,GamePlatform.is_meituan=!1,GamePlatform.is_platform_qqGameHall=!1,GamePlatform.qqGameHall_openId="",GamePlatform.qqGameHall_openKey="",GamePlatform.isSDK_init=!1,GamePlatform.autoSDK_login=!0,GamePlatform}();exports.GamePlatform=GamePlatform,window.gamePlatforms=GamePlatform.getInstance(),cc._RF.pop()},{"../StaticData/RechargeTableData":"RechargeTableData","../common/PlayerModule":"PlayerModule","../network/ClientNetwork":"ClientNetwork","../network/LocalMessage":"LocalMessage","../network/protocol/TypeProtocols":"TypeProtocols","../network/protocol/long":"long","../utils/GameUtils":"GameUtils"}],GameScheduler:[function(e,t,o){"use strict";cc._RF.push(t,"63bb9zrzcBIUZkx9E6ZrP0u","GameScheduler");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,s=r.ccclass,c=(r.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._funcMap=new Map,t.updateFunc=null,t}return a(t,e),t.prototype.update=function(e){this.updateFunc&&this.updateFunc.call(this.node,e)},t.prototype.onDestroy=function(){this._funcMap.clear()},t.prototype.scheduleUpdate=function(e){this.updateFunc=e},t.prototype.unscheduleUpdate=function(){this.updateFunc=null},t.prototype.schedule=function(t,o,i,a){void 0===o&&(o=0);var n=this._funcMap.get(t);n||(n=t.bind(this.node),this._funcMap.set(t,n)),e.prototype.schedule.call(this,n,o,i,a)},t.prototype.scheduleOnce=function(e,t){this.schedule(e,0,0,t)},t.prototype.unschedule=function(t){var o=this._funcMap.get(t);o?e.prototype.unschedule.call(this,o):e.prototype.unschedule.call(this,t)},n([s],t)}(cc.Component));o.default=c,cc._RF.pop()},{}],GameTools:[function(e,t,o){"use strict";cc._RF.push(t,"11d10lzNbtPY4uBBdkQMKYO","GameTools");var i=this&&this.__awaiter||function(e,t,o,i){return new(o||(o=Promise))(function(a,n){function r(e){try{c(i.next(e))}catch(t){n(t)}}function s(e){try{c(i.throw(e))}catch(t){n(t)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(r,s)}c((i=i.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){var o,i,a,n,r={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return n={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function s(e){return function(t){return c([e,t])}}function c(n){if(o)throw new TypeError("Generator is already executing.");for(;r;)try{if(o=1,i&&(a=2&n[0]?i.return:n[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return r.label++,{value:n[1],done:!1};case 5:r.label++,i=n[1],n=[0];continue;case 7:n=r.ops.pop(),r.trys.pop();continue;default:if(!(a=(a=r.trys).length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){r=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){r.label=n[1];break}if(6===n[0]&&r.label<a[1]){r.label=a[1],a=n;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(n);break}a[2]&&r.ops.pop(),r.trys.pop();continue}n=t.call(e,r)}catch(s){n=[6,s],i=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var n=e("../utils/ResourcesManager"),r=e("../utils/ConfigUtils"),s=e("./GameUtils"),c=e("./LogUtil"),l=e("../modules/manager/LoadResManager"),d=e("./GamePlatform"),u=e("../utils/Tools"),h=e("../StaticData/SoundTableData"),p=e("./subUtils/TypeDef"),f=e("../Global/GameGlobal"),g=e("../../load"),m=e("../common/PlayerModule"),_=["ui/common_res/quality1","ui/common_res/quality2","ui/common_res/quality3","ui/common_res/quality4"],y=function(){function e(){}return e.timeToTimestamp=function(e){d.GamePlatform.isIOS()&&(e=e.replace(/-/g,"/"));var t=Date.parse(e);return Math.ceil(t/1e3)},e.timestampToTime=function(e){var t=e?new Date(1e3*e):new Date;return t.getFullYear()+"-"+(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-"+(t.getDate()<10?"0"+t.getDate():t.getDate())+" "+(t.getHours()<10?"0"+t.getHours():t.getHours())+":"+(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+":"+(t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds())},e.getRandomInt=function(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e))+e},e.getRand=function(e){return Math.floor(Math.random()*e)},e.getSeedRandom=function(e,t,o){return(o=o||0)+(e=(9301*e+49297)%233280)/233280*((t=t||1)-o)},e.setAdaptiveScreen=function(e){e.width=cc.winSize.width,e.height=cc.winSize.height,e.width>1440&&(e.width=1440),e.height>1440&&(e.height=1440)},e.registerTouchEvent=function(e,t,o){for(var i=[],a=3;a<arguments.length;a++)i[a-3]=arguments[a];e.hasEventListener(cc.Node.EventType.TOUCH_START)&&e.off(cc.Node.EventType.TOUCH_START),e.hasEventListener(cc.Node.EventType.TOUCH_MOVE)&&e.off(cc.Node.EventType.TOUCH_MOVE),e.hasEventListener(cc.Node.EventType.TOUCH_END)&&e.off(cc.Node.EventType.TOUCH_END),e.hasEventListener(cc.Node.EventType.TOUCH_CANCEL)&&e.off(cc.Node.EventType.TOUCH_CANCEL);var n=e.scale;e.on(cc.Node.EventType.TOUCH_START,function(){if(e.scale=.92*n,1!=u.checkGameMuteVolume()){var t=h.SoundTableData.getById(1).res,o=cc.resources.get(t,cc.AudioClip);o&&(e.audioId&&cc.audioEngine.stopEffect(e.audioId),e.audioId=cc.audioEngine.playEffect(o,!1),cc.audioEngine.setFinishCallback(e.audioId,function(){e.audioId=null}))}}),e.on(cc.Node.EventType.TOUCH_MOVE,function(){}),e.on(cc.Node.EventType.TOUCH_END,function(a){e.scale=n,t&&(o?t.call(o,i):t(a))}),e.on(cc.Node.EventType.TOUCH_CANCEL,function(){e.scale=n})},e.checkNodeInVisible=function(e,t){void 0===t&&(t=null);var o=null;if(e instanceof cc.Node){if(!e||!cc.isValid(e))return void c.default.error("GameHelper | checkNodeInVisible | node \u5f02\u5e38");o=e.getBoundingBoxToWorld()}else e&&(o=e);var i=null,a=cc.winSize.width,n=cc.winSize.height;if(cc.winSize.width,cc.winSize.height,t){var r=t.getBoundingBoxToWorld();i=cc.rect(r.x,r.y,a,n)}else i=cc.rect(0,0,a,n);return o.intersects(i)},e.setNodeBright=function(e,t,o){var i=this;void 0===o&&(o=!0),e instanceof cc.Component&&(e=e.node),e instanceof cc.Node&&(o?e.getComponentsInChildren(cc.RenderComponent||cc.Sprite).forEach(function(e){i._setSpriterBright(e,t)}):e.getComponents(cc.RenderComponent||cc.Sprite).forEach(function(e){i._setSpriterBright(e,t)}))},e._setSpriterBright=function(e,t){if(e.setMaterial){var o=cc.Material.getBuiltinMaterial(t?cc.Material.BUILTIN_NAME.SPRITE:cc.Material.BUILTIN_NAME.GRAY_SPRITE);e.setMaterial(0,o)}else e instanceof cc.Sprite&&e.setState?e.setState(t?cc.Sprite.State.NORMAL:cc.Sprite.State.GRAY):e._sgNode&&e._sgNode.setState(t?0:1)},e.createNormalItems=function(e,t,o,i){void 0===i&&(i=null),l.default.loadPrefab("ui/CommonPrefab/PropItem").then(function(a){o&&(a.parent=o);var s=r.default.getInstance().getItemByID(e);s?cc.isValid(a)&&(n.default.loadSprite(_[s.quality-1],a.getChildByName("bg").getComponent(cc.Sprite)),n.default.loadSprite(s.icon,a.getChildByName("icon").getComponent(cc.Sprite)),1013==e&&(t/=100),a.getChildByName("num").getComponent(cc.Label).string=t.toString(),t<0&&(a.getChildByName("num").active=!1),a.getChildByName("name").getComponent(cc.Label).string=s.name,a.getChildByName("name").active=!1,s.isChance&&s.isChance>0&&(a.getChildByName("gailv").active=!0,a.getChildByName("gailv").children[0].getComponent(cc.Label).string=s.isChance+"%"),i&&i(a)):console.log("read ItemTableData nill")}).catch(function(e){cc.error(e)})},e.createNormalItemsWithNames=function(t,o,i,a){void 0===a&&(a=null),e.createNormalItems(t,o,i,function(e){var o=new cc.Node;o.parent=i,o.width=e.width,e.parent=o;var n=new cc.Node;n.name="txt_name",n.addComponent(cc.Label),n.addComponent(cc.LabelOutline),n.getComponent(cc.Label).font=cc.resources.get("font/zsh",cc.Font),n.getComponent(cc.Label).fontSize=24,n.color=new cc.Color(255,225,144);var s=r.default.getInstance().getItemByID(t);n.getComponent(cc.Label).string=s.name,n.parent=o,n.y=-85,n.getComponent(cc.LabelOutline).color=cc.color(0,0,0),n.getComponent(cc.LabelOutline).width=2,a(o)})},e.createRedPointNode=function(e){var t=new cc.Node("redPointNode"),o=t.addComponent(cc.Sprite);s.setTexture(o,"ui/common_res/redpoint",function(){var o=t.addComponent(cc.Widget);o.alignMode=cc.Widget.AlignMode.ON_WINDOW_RESIZE,o.isAlignBottom=!1,o.isAlignLeft=!1,o.isAlignRight=!0,o.isAlignTop=!0,o.bottom=0,o.top=0,o.left=0,o.right=0,e&&e(t)})},e.startFraming=function(e,t){this.framingLoad(e,t)},e.framingLoad=function(e,t){return i(this,void 0,void 0,function(){return a(this,function(o){switch(o.label){case 0:return[4,this.executePreFrame(this._getItemGenerator(e,t),1)];case 1:return o.sent(),[2]}})})},e.executePreFrame=function(e,t){return new Promise(function(o){var i=e,a=function(){for(var e=(new Date).getTime(),n=function(i){if(null==i||i.done)return o(i),{value:void 0};if((new Date).getTime()-e>t){var n=setTimeout(function(){a(),window.clearTimeout(n)});return{value:void 0}}},r=i.next();;r=i.next()){var s=n(r);if("object"==typeof s)return s.value}};a()})},e._getItemGenerator=function(e,t){var o;return a(this,function(i){switch(i.label){case 0:o=0,i.label=1;case 1:return o<e?[4,t(o)]:[3,4];case 2:i.sent(),i.label=3;case 3:return o++,[3,1];case 4:return[2]}})},e.storageData=function(e,t){cc.sys.localStorage.setItem(e,t)},e.getData=function(e){return cc.sys.localStorage.getItem(e)},e.removeData=function(e){cc.sys.localStorage.removeItem(e)},e.hasData=function(e){return!(null==cc.sys.localStorage.getItem(e)||cc.sys.localStorage.getItem(e).length<=0)},e.getDevelopRankListUrl=function(e){void 0===e&&(e="");var t="";return p.GlobalVar.getServerGroup()<=0?(t=f.G.StringManager.getString("RANKLIST_URL"),e&&"SociatyRank"==e&&(t="https://mszctest.gameserver.iplay11g.com/gmsys/weblogic/webc/ranklistgetranklistsociaty.php")):7==p.GlobalVar.getServerGroup()?(t="http://192.168.1.242/gmsys_mszc_zjx/weblogic/webc/ranklistgetranklist.php",e&&"SociatyRank"==e&&(t="http://192.168.1.242/gmsys_mszc_zjx/weblogic/webc/ranklistgetranklistsociaty.php")):8==p.GlobalVar.getServerGroup()?(t="http://192.168.1.242/gmsys_mszc_lzy/weblogic/webc/ranklistgetranklist.php",e&&"SociatyRank"==e&&(t="http://192.168.1.242/gmsys_mszc_lzy/weblogic/webc/ranklistgetranklistsociaty.php")):1==p.GlobalVar.getServerGroup()?(t="http://192.168.1.29/mszc/weblogic/webc/ranklistgetranklist.php",e&&"SociatyRank"==e&&(t="http://192.168.1.29/mszc/weblogic/webc/ranklistgetranklistsociaty.php")):(t="http://192.168.1.242/gmsys_mszc/weblogic/webc/ranklistgetranklist.php",e&&"SociatyRank"==e&&(t="http://192.168.1.242/gmsys_mszc/weblogic/webc/ranklistgetranklistsociaty.php")),(d.GamePlatform.isWechat()||d.GamePlatform.isQQMiniGame()||d.GamePlatform.isByteDanceMiniGame()||d.GamePlatform.isKuaishouMiniGame())&&(g.getSubmitReviewState()?(t=f.G.StringManager.getString("RANKLIST_URL"),e&&"SociatyRank"==e&&(t="https://mszctest.gameserver.iplay11g.com/gmsys/weblogic/webc/ranklistgetranklistsociaty.php")):(t=f.G.StringManager.getString("RANKLIST_URL_MOBILE"),e&&"SociatyRank"==e&&(t="https://mszcs1.gameserver.iplay11g.com/gmsys/weblogic/webc/ranklistgetranklistsociaty.php"))),(d.GamePlatform.getMiYa()||d.GamePlatform.isQQGameRoom()||d.GamePlatform.IsMiYaIosH5())&&(t=f.G.StringManager.getString("RANKLIST_URL_MOBILE"),e&&"SociatyRank"==e&&(t="https://mszcs1.gameserver.iplay11g.com/gmsys/weblogic/webc/ranklistgetranklistsociaty.php")),"bigBlue"==d.GamePlatform.getMiYaVideoTypeNoSet()&&(t=f.G.StringManager.getString("RANKLIST_URL_MOBILE_BIGBLUE"),e&&"SociatyRank"==e&&(t="https://mszcappphp.gameserver.iplay11g.com/gmsys/weblogic/webc/ranklistgetranklistsociaty.php")),"ly5add7"==d.GamePlatform.getMiYaVideoTypeNoSet()&&(t=f.G.StringManager.getString("RANKLIST_URL_MOBILE_ADDCHANNEL"),e&&"SociatyRank"==e&&(t="https://mszcs1.gameserver.iplay11g.com/gmsys/weblogic/webc/ranklistgetranklistsociaty.php")),t},e.getRechargeMoneyByPlatform=function(e){return null==e?0:d.GamePlatform.isQQGameRoom()?e.moneyQQ:e.money},e.getAddShortcutTaskId=function(){return Number(s.getConfigIntValue("douyin_desktop_id"))},e.getSystemCheckChatUrl=function(){var e="";return e=p.GlobalVar.getServerGroup()<=0?"https://mszctest.gameserver.iplay11g.com/gmsys/weblogic/webc/checkChat.php":7==p.GlobalVar.getServerGroup()?"http://192.168.1.242/gmsys_mszc_zjx/weblogic/webc/checkChat.php":8==p.GlobalVar.getServerGroup()?"http://192.168.1.242/gmsys_mszc_lzy/weblogic/webc/checkChat.php":1==p.GlobalVar.getServerGroup()?"http://192.168.1.29/mszc/weblogic/webc/checkChat.php":"http://192.168.1.242/gmsys_mszc/weblogic/webc/checkChat.php",(d.GamePlatform.isWechat()||d.GamePlatform.isQQMiniGame()||d.GamePlatform.isByteDanceMiniGame()||d.GamePlatform.isKuaishouMiniGame())&&(e=g.getSubmitReviewState()?"https://mszctest.gameserver.iplay11g.com/gmsys/weblogic/webc/checkChat.php":"https://mszcs1.gameserver.iplay11g.com/gmsys/weblogic/webc/checkChat.php"),(d.GamePlatform.getMiYa()||d.GamePlatform.isQQGameRoom()||d.GamePlatform.IsMiYaIosH5())&&(e="https://mszcs1.gameserver.iplay11g.com/gmsys/weblogic/webc/checkChat.php"),"bigBlue"==d.GamePlatform.getMiYaVideoTypeNoSet()&&(e="https://mszcappphp.gameserver.iplay11g.com/gmsys/weblogic/webc/checkChat.php"),e},e.getSystemaddBlackChatUrl=function(){var e="";return e=p.GlobalVar.getServerGroup()<=0?"https://mszctest.gameserver.iplay11g.com/gmsys/weblogic/webc/addBlackChat.php":7==p.GlobalVar.getServerGroup()?"http://192.168.1.242/gmsys_mszc_zjx/weblogic/webc/addBlackChat.php":8==p.GlobalVar.getServerGroup()?"http://192.168.1.242/gmsys_mszc_lzy/weblogic/webc/addBlackChat.php":1==p.GlobalVar.getServerGroup()?"http://192.168.1.29/mszc/weblogic/webc/addBlackChat.php":"http://192.168.1.242/gmsys_mszc/weblogic/webc/addBlackChat.php",(d.GamePlatform.isWechat()||d.GamePlatform.isQQMiniGame()||d.GamePlatform.isByteDanceMiniGame()||d.GamePlatform.isKuaishouMiniGame())&&(e=g.getSubmitReviewState()?"https://mszctest.gameserver.iplay11g.com/gmsys/weblogic/webc/addBlackChat.php":"https://mszcs1.gameserver.iplay11g.com/gmsys/weblogic/webc/addBlackChat.php"),(d.GamePlatform.getMiYa()||d.GamePlatform.isQQGameRoom()||d.GamePlatform.IsMiYaIosH5())&&(e="https://mszcs1.gameserver.iplay11g.com/gmsys/weblogic/webc/addBlackChat.php"),"bigBlue"==d.GamePlatform.getMiYaVideoTypeNoSet()&&(e="https://mszcappphp.gameserver.iplay11g.com/gmsys/weblogic/webc/addBlackChat.php"),e},e.callSystemCheckChatCount=function(e,t,o){var i=this.getSystemCheckChatUrl();m.default.uuidTransformRoieId(),i+="?",i+="score="+e,i+="&recharge="+t,i+="&channel="+o;var a=new XMLHttpRequest;a.onreadystatechange=function(){if(4==a.readyState&&a.status>=200&&a.status<400){var e=a.responseText.toString();e=(e=(e=e.replace('"','"')).replace("\ufeff","")).replace(" ","");var t=JSON.parse(e);isNaN(t)||m.default.setSystemChatCount(t,o)}},a.open("GET",i,!0),a.send()},e.callSystemAddBlackList=function(e,t,o){var i=this.getSystemaddBlackChatUrl();i+="?",i+="roleid="+e,i+="&whoaddblack="+m.default.uuidTransformRoieId(),i+="&rolename="+t,i+="&score="+o,i+="&recharge=0&registertime=0";var a=new XMLHttpRequest;a.onreadystatechange=function(){if(4==a.readyState&&a.status>=200&&a.status<400){var e=a.responseText.toString();console.log(e)}},a.open("GET",i,!0),a.send()},e}();o.default=y,cc._RF.pop()},{"../../load":"load","../Global/GameGlobal":"GameGlobal","../StaticData/SoundTableData":"SoundTableData","../common/PlayerModule":"PlayerModule","../modules/manager/LoadResManager":"LoadResManager","../utils/ConfigUtils":"ConfigUtils","../utils/ResourcesManager":"ResourcesManager","../utils/Tools":"Tools","./GamePlatform":"GamePlatform","./GameUtils":"GameUtils","./LogUtil":"LogUtil","./subUtils/TypeDef":"TypeDef"}],GameUtils:[function(e,t,o){"use strict";cc._RF.push(t,"914e9nhXDBMGYVGp+kYFPap","GameUtils");var i=this&&this.__awaiter||function(e,t,o,i){return new(o||(o=Promise))(function(a,n){function r(e){try{c(i.next(e))}catch(t){n(t)}}function s(e){try{c(i.throw(e))}catch(t){n(t)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(r,s)}c((i=i.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){var o,i,a,n,r={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return n={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function s(e){return function(t){return c([e,t])}}function c(n){if(o)throw new TypeError("Generator is already executing.");for(;r;)try{if(o=1,i&&(a=2&n[0]?i.return:n[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return r.label++,{value:n[1],done:!1};case 5:r.label++,i=n[1],n=[0];continue;case 7:n=r.ops.pop(),r.trys.pop();continue;default:if(!(a=(a=r.trys).length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){r=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){r.label=n[1];break}if(6===n[0]&&r.label<a[1]){r.label=a[1],a=n;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(n);break}a[2]&&r.ops.pop(),r.trys.pop();continue}n=t.call(e,r)}catch(s){n=[6,s],i=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.getBattleEffectOnOff=o.setBattleEffectOnOff=o.isNumber=o.getMatchPlayerCard=o.getProficiencyIcon=o.checkPvPOverLimit=o.checkOpenVoucher=o.updateDropEquipTime=o.checkDropEquipTimeOffset=o.isSpirit=o.snapshot=o.StringToUint8Array=o.Uint8ArrayToString=o.getSpineNameByResId=o.getItemTotalNumByItemId=o.getSlotNameByCarLv=o.showCombatPet=o.getSafeArea=o.getTableVersion=o.isReplaced=o.isRobot=o.getRoleIdentity=o.getConfigVersion=o.compareVersion=o.getConfigIntValue=o.setRemoteHeadIcon=o.setIconByItemId=o.backgroundFitScreen=o.IsChinese=o.normalize=o.getRecentSvrKey=o.getHeadLevelSvrKey=o.getDeviceID=o.clone=o.getPercentNumber=o.removeZero=o.ReLogin=o.formatZero=o.isShareEnable=o.utf8_trim=o.utf8_is_space=o.split_utf8_string=o.CC_RADIANS_TO_DEGREES=o.ccpRotateByAngle=o.CC_DEGREES_TO_RADIANS=o.ccpDistanceSQ=o.ArrayEquals=o.ERRORTIPS=o.MESSAGETIPS=o.removeFileSuffix=o.loadJsonObj=o.removeChildByTag=o.getChildByTag=o.getTag=o.setTag=o.getComponentByChild=o.setAnchorPoint=o.setTouchEnabled=o.getSeedRandom=o.getRand=o.getRandomInt=o.LoadResDirAsync=o.setTextureBtn=o.setTexture=o.LoadPreNode=o.LoadJson=o.LoadNode=o.LoadResAsync=o.createPreNode=o.getBoolForKey=o.setBoolForKey=o.setLocalData=o.getLocalData=o.isTest=o.getEnterBattleTimeoutTime=o.getCoopMaxKills=o.getMaxDamageLimit=o.isEnableClick=o.setEnableClick=o.getForceCheckGame=o.setForceCheckGame=void 0;var n=e("../../load"),r=e("../combat/CombatManager"),s=e("../common/CombatModule"),c=e("../common/PlayerModule"),l=e("../Global/GameGlobal"),d=e("../modules/manager/cheat/SafeNumber"),u=e("../network/protocol/TypeProtocols"),h=e("../StaticData/ConfigIntTableData"),p=e("../StaticData/ErrorCodeTableData"),f=e("../StaticData/ProficiencyTableData"),g=e("./ConfigUtils"),m=e("./ConstValue"),_=e("./GamePlatform"),y=e("./LogUtil"),v=e("./ResourcesManager"),C=e("./TimeOffSetManager"),S=!0,T=null,I=null,N=null,b=!1;function w(e,t){void 0===t&&(t=!1);var o=cc.sys.localStorage.getItem(e);return null===o?t:"true"==o}function E(e,t,o,i){return void 0===o&&(o=!1),new Promise(function(a){cc.resources.load(e,t,i,function(e,t){if(e){if(o)throw e;cc.error(e),a(null)}else a(t)})})}function P(e){return i(this,void 0,Promise,function(){var t,o,i;return a(this,function(a){switch(a.label){case 0:return console.log(e),[4,E(e,cc.Prefab)];case 1:return(t=a.sent())?(console.log("LoadNode:"+e),null!=(o=cc.instantiate(t))?[3,3]:[4,E(e,cc.Prefab)]):[3,4];case 2:i=a.sent(),o=cc.instantiate(i),a.label=3;case 3:return[2,o];case 4:return[2,null]}})})}function R(e,t,o,n){return void 0===n&&(n=!0),i(this,void 0,void 0,function(){var i;return a(this,function(a){switch(a.label){case 0:return t.localeCompare("")?(t=L(t),(i=cc.resources.get(t,cc.SpriteFrame))?[3,2]:[4,E(t,cc.SpriteFrame)]):[2];case 1:if(i=a.sent(),!e||!e.node||!cc.isValid(e.node,!0))return[2];a.label=2;case 2:e.spriteFrame&&!n||(e.spriteFrame=i);try{o&&o(i)}catch(r){cc.error(r)}return[2]}})})}function L(e){if(!e)return null;var t=e.split("."),o="";if(t.length>=2)for(var i=0;i<t.length-1;++i)o+=t[i];else o=t[0];return o}function A(e){var t=new Array;if(e.length<=0)return t;for(var o=0,i=e.length;o!=i;){var a=e.charCodeAt(o),n=0;if(0==(128&a))n=1;else if(192==(224&a))n=2;else if(224==(240&a))n=3;else if(240==(248&a))n=4;else if(248==(252&a))n=5;else{if(252!=(254&a))break;n=6}if(i-o<n)break;var r="";r+=e.charAt(o);for(var s=!1,c=1;c<n;++c){if(128!=(192&e.charCodeAt(o+n))){s=!0;break}r+=e.charAt(o+n)}if(s)break;t.push(r),o+=n}return t}function D(e){return e>=9&&e<=13||32==e||133==e||160==e||5760==e||e>=8192&&e<=8202||8232==e||8233==e||8239==e||8287==e||12288==e}function M(e,t){void 0===t&&(t=2);var o=e.toFixed(t);if(-1==o.indexOf("."))return Number(o);for(var i=0,a=o.length-1;a>0;a--){if("0"!==o.charAt(a))return o=o.substring(0,o.length-i),Number(o);i++}}function B(e,t){var o=g.default.getInstance().getItemByID(e);o&&R(t,o.icon)}function k(e){var t=h.ConfigIntTableData.getDataMap();if(t){var o="";return t.forEach(function(t){t.name===e&&(o=t.value)}),o}return""}o.setForceCheckGame=function(e){b=e},o.getForceCheckGame=function(){return b},o.setEnableClick=function(e){S=e},o.isEnableClick=function(){return S},o.getMaxDamageLimit=function(){return T?T.value:(T=new d.SafeNumber(Number(k("battle_max_damage")))).value},o.getCoopMaxKills=function(){return I?I.value:(I=new d.SafeNumber(Number(k("coop_max_kill")))).value},o.getEnterBattleTimeoutTime=function(){return N?N.value:(N=new d.SafeNumber(Number(k("enter_battle_time_out_time")))).value},o.isTest=function(){return!1},o.getLocalData=function(e,t){return void 0===t&&(t=""),cc.sys.localStorage.getItem(e)||t},o.setLocalData=function(e,t){cc.sys.localStorage.setItem(e,t)},o.setBoolForKey=function(e,t){cc.sys.localStorage.setItem(e,t)},o.getBoolForKey=w,o.createPreNode=function(e,t){var o=cc.resources.get(e,cc.Prefab);return o?cc.instantiate(o).getComponent(t):null},o.LoadResAsync=E,o.LoadNode=P,o.LoadJson=function(e){return i(this,void 0,Promise,function(){var t;return a(this,function(o){switch(o.label){case 0:return[4,E(e,cc.JsonAsset)];case 1:return(t=o.sent())?[2,t]:[2,null]}})})},o.LoadPreNode=function(e,t){return i(this,void 0,Promise,function(){var o;return a(this,function(i){switch(i.label){case 0:return[4,P(e)];case 1:return(o=i.sent())?[2,o.getComponentInChildren(t)]:[2,null]}})})},o.setTexture=R,o.setTextureBtn=function(e,t,o,n,r,s){return i(this,void 0,void 0,function(){var i;return a(this,function(a){switch(a.label){case 0:return t=L(t),o=L(o),n=L(n),r=L(r),t&&t.localeCompare("")?(i=cc.resources.get(t,cc.SpriteFrame))?[3,2]:[4,E(t,cc.SpriteFrame)]:[3,3];case 1:if(i=a.sent(),!e||!e.node||!cc.isValid(e.node,!0))return[2];a.label=2;case 2:e.normalSprite=i,a.label=3;case 3:return o&&o.localeCompare("")?(i=cc.resources.get(o,cc.SpriteFrame))?[3,5]:[4,E(o,cc.SpriteFrame)]:[3,6];case 4:if(i=a.sent(),!e||!e.node||!cc.isValid(e.node,!0))return[2];a.label=5;case 5:e.hoverSprite=i,a.label=6;case 6:return n&&n.localeCompare("")?(i=cc.resources.get(n,cc.SpriteFrame))?[3,8]:[4,E(n,cc.SpriteFrame)]:[3,9];case 7:if(i=a.sent(),!e||!e.node||!cc.isValid(e.node,!0))return[2];a.label=8;case 8:e.pressedSprite=i,a.label=9;case 9:return r&&r.localeCompare("")?(i=cc.resources.get(r,cc.SpriteFrame))?[3,11]:[4,E(r,cc.SpriteFrame)]:[3,12];case 10:if(i=a.sent(),!e||!e.node||!cc.isValid(e.node,!0))return[2];a.label=11;case 11:e.disabledSprite=i,a.label=12;case 12:return s&&s(),[2]}})})},o.LoadResDirAsync=function(e,t,o){return void 0===o&&(o=!0),new Promise(function(i){cc.resources.loadDir(e,t,function(e,t){if(e){if(o)throw e;cc.error(e.message),i(null)}else i(t)})})},o.getRandomInt=function(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e))+e},o.getRand=function(e){return Math.floor(Math.random()*e)},o.getSeedRandom=function(e,t,o){return(o=o||0)+(e=(9301*e+49297)%233280)/233280*((t=t||1)-o)},o.setTouchEnabled=function(e,t){if(console.log("setTouchEnabled"+e),void 0!==t||(t=cc.director.getScene()))if(e)(o=t.getChildByName("TouchMask"))&&(o.active=!1);else{var o;if(!(o=t.getChildByName("TouchMask"))){(o=new cc.Node).name="TouchMask";var i=o.addComponent(cc.Widget);i.alignMode=cc.Widget.AlignMode.ON_WINDOW_RESIZE,i.isAlignBottom=!0,i.isAlignLeft=!0,i.isAlignRight=!0,i.isAlignTop=!0,i.bottom=0,i.top=0,i.left=0,i.right=0,o.addComponent(cc.BlockInputEvents),t.addChild(o),o.setContentSize(cc.winSize)}o.zIndex=cc.macro.MAX_ZINDEX,o.active=!0}},o.setAnchorPoint=function(e,t,o){var i=(t-e.anchorX)*e.width,a=(o-e.anchorY)*e.height;e.x+=i,e.y+=a;for(var n=0,r=e.children;n<r.length;n++){var s=r[n];s.x-=i,s.y-=a}e.setAnchorPoint(new cc.Vec2(t,o))},o.getComponentByChild=function e(t,o){if(!cc.isValid(t,!0))return null;var i=null;if(t instanceof cc.Scene||(i=t.getComponent(o)),i)return i;for(var a=0,n=Array.from(t.children.entries());a<n.length;a++){var r=n[a],s=(r[0],e(r[1],o));if(s)return s}return null},o.setTag=function(e,t){e.name=t+""},o.getTag=function(e){return e.name},o.getChildByTag=function(e,t){return e.getChildByName(t+"")},o.removeChildByTag=function(e,t){e.getChildByName(t+"").removeFromParent(!0)},o.loadJsonObj=function(e){return i(this,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return[4,E(e,cc.JsonAsset)];case 1:return[2,t.sent()]}})})},o.removeFileSuffix=L,o.MESSAGETIPS=function(e){l.G.StringManager.PopString(l.G.StringManager.getString(e))},o.ERRORTIPS=function(e){var t=p.ErrorCodeTableData.getById(e);t&&l.G.StringManager.PopString(t.dec)},o.ArrayEquals=function e(t,o){if(t===o)return!0;if(!t||!o)return!1;if(t.length!=o.length)return!1;for(var i=0;i<t.length;++i)if(t[i]instanceof Array&&o[i]instanceof Array){if(!e(t[i],o[i]))return!1}else if(t[i]!=o[i])return!1;return!0},o.ccpDistanceSQ=function(e,t){var o=e.x-t.x,i=e.y-t.y;return o*o+i*i},o.CC_DEGREES_TO_RADIANS=function(e){return.01745329252*e},o.ccpRotateByAngle=function(e,t,o){var i=e.x-t.x,a=e.y-t.y,n=new cc.Vec2(i,a),r=new cc.Vec2(Math.cos(o),Math.sin(o)),s=new cc.Vec2(n.x*r.x-n.y*r.y,n.x*r.y+n.y*r.x);return new cc.Vec2(t.x+s.x,t.y+s.y)},o.CC_RADIANS_TO_DEGREES=function(e){return 57.29577951*e},o.split_utf8_string=A,o.utf8_is_space=D,o.utf8_trim=function(e,t){if(!(e.length<=0)){for(var o=A(e),i=0;i<o.length&&1==o[i].length&&D(o[i].charCodeAt(0));++i);for(var a=o.length-1;a>i&&1==o[a].length&&D(o[a].charCodeAt(0));--a);t>0&&a-i+1>t&&(a=i+t-1);for(var n=i;n<=a;++n)o[n]}},o.isShareEnable=function(){return!0},o.formatZero=function(e,t){return String(e).length>t?e:(Array(t).join("0")+e).slice(-t)},o.ReLogin=function(){},o.removeZero=M,o.getPercentNumber=function(e,t){return void 0===t&&(t=2),M(e,t)+"%"},o.clone=function e(t){var o;if("object"==typeof t)if(null===t)o=null;else if(t instanceof Array){o=[];for(var i=0,a=t.length;i<a;i++)o.push(e(t[i]))}else for(var n in o={},t)o[n]=e(t[n]);else o=t;return o},o.getDeviceID=function(){return""},o.getHeadLevelSvrKey=function(e){var t="HEADLEVELID_";return(t+=e)+"_"},o.getRecentSvrKey=function(e){var t="ZONEID_";return(t+=e)+"_"},o.normalize=function(e){var t=Math.sqrt(e.x*e.x+e.y*e.y);return 0==t?new cc.Vec2(1,0):new cc.Vec2(e.x/t,e.y/t)},o.IsChinese=function(e){return new RegExp("^[\u4e00-\u9fff]+$").test(e)},o.backgroundFitScreen=function(e,t){e.setContentSize(cc.winSize),.5==e.anchorX&&e.setPosition(cc.winSize.width/2,e.position.y),.5==e.anchorY&&e.setPosition(e.position.x,cc.winSize.height/2);var o=cc.view.getDesignResolutionSize(),i=e.width/o.width,a=e.height/o.height;if(t){var n=e.height/t.height;i>a&&(n=e.width/t.width,t.width*=n)}},o.setIconByItemId=B,o.setRemoteHeadIcon=function(e,t,o,i){void 0===i&&(i=null),o.sizeMode=cc.Sprite.SizeMode.CUSTOM,0!=t&&1!=t?B(t,o):""!=e&&cc.assetManager.loadRemote(e,{ext:".jpg"},function(e,t){o&&(o.spriteFrame=new cc.SpriteFrame(t)),i&&i(t)})},o.getConfigIntValue=k,o.compareVersion=function(e,t){e=e.split("."),t=t.split(".");for(var o=Math.max(e.length,t.length);e.length<o;)e.push("0");for(;t.length<o;)t.push("0");for(var i=0;i<o;i++){var a=parseInt(e[i]),n=parseInt(t[i]);if(a>n)return 1;if(a<n)return-1}return 0},o.getConfigVersion=function(){return Number(k("client_version"))},o.getRoleIdentity=function(e){var t=m.PLAYER_IDENTITY.home;return e===m.PLAYER_CAMP.myPlayer?t=s.default.matchRoleIdentity:!r.default.getInstance().isCoop()||e!=m.PLAYER_CAMP.opponents&&e!=m.PLAYER_CAMP.opponentsCoop?t=s.default.matchRoleIdentity===m.PLAYER_IDENTITY.home?m.PLAYER_IDENTITY.away:m.PLAYER_IDENTITY.home:(t=e,e==m.PLAYER_CAMP.opponents&&(t=e+1)),t},o.isRobot=function(e){if(e!=m.PLAYER_CAMP.myPlayer){var t;if(t=r.default.getInstance().isSkyCastleEnemy(e)?s.default.getMatchBattleAIInfo(e):s.default.getMatchBattleInfo(!1))return t.bRobot}return!1},o.isReplaced=function(e){return e!=m.PLAYER_CAMP.myPlayer&&(!!r.default.getInstance().isSkyCastleEnemy(e)||s.default.opponentsReplaced)},o.getTableVersion=function(){var e="";return _.GamePlatform.isWechat()?(e+=n.wechatminiLoaclGameVer,e+="_",e+=wx.getStorageSync("resVer").toString()):_.GamePlatform.isQQMiniGame()?(e+=n.wechatminiLoaclGameVer,e+="_",e+=qq.getStorageSync("resVer").toString()):_.GamePlatform.isByteDanceMiniGame()?(e+=n.wechatminiLoaclGameVer,e+="_",e+=tt.getStorageSync("resVer").toString()):_.GamePlatform.isKuaishouMiniGame()?(e+=n.wechatminiLoaclGameVer,e+="_",e+=ks.getStorageSync("resVer").toString()):cc.sys.localStorage.getItem("clentVersion")?e+=cc.sys.localStorage.getItem("clentVersion"):e+=n.wechatminiLoaclGameVer,e},o.getSafeArea=function(){return _.GamePlatform.isQQMiniGame()?{width:cc.winSize.width,height:cc.winSize.height,x:0,y:0}:cc.sys.getSafeAreaRect()},o.showCombatPet=function(e,t,o,i){if(void 0===t&&(t=0),void 0===o&&(o=""),void 0===i&&(i=!1),!r.default.getInstance().isSkyCastle()){var a=o;if(t<=0||null==g.default.getInstance().getResConfig(t)){var n=e.getComponent(sp.Skeleton).attachUtil;n.generateAllAttachedNodes();var s=n.getAttachedNodes(a);s[0]&&s[0].removeAllChildren()}else{var c=g.default.getInstance().getResConfig(t).animation,l=e.getComponent(sp.Skeleton).attachUtil;l.generateAllAttachedNodes();var d=l.getAttachedNodes(a);d[0]&&d[0].removeAllChildren();var u=new cc.Node;u.parent=d[0],v.default.loadSpine(c,function(e){if(e){e.parent=u,e.getComponent(sp.Skeleton).setAnimation(0,"idle",!0);var t=10+20*Math.random();e.getComponent(sp.Skeleton).schedule(function(){e.getComponent(sp.Skeleton).setAnimation(0,"idle2",!1),e.getComponent(sp.Skeleton).setCompleteListener(function(){e.getComponent(sp.Skeleton).setAnimation(0,"idle",!0)})},t),i&&e.on(cc.Node.EventType.TOUCH_END,function(){var t=e.getComponent(sp.Skeleton).getCurrent(0),o="idle";t&&(o=t.animation?t.animation.name:"idle"),"idle"==o&&(e.getComponent(sp.Skeleton).setAnimation(0,"idle2",!1),e.getComponent(sp.Skeleton).setCompleteListener(function(){e.getComponent(sp.Skeleton).setAnimation(0,"idle",!0)}))})}})}}},o.getSlotNameByCarLv=function(e){return y.default.log("#######getSlotNameByCarLv,lv=",e),e>=5?"chongwu3":e>=3?"chongwu2":"chongwu1"},o.getItemTotalNumByItemId=function(e){return c.default.getItemCountByBag(e)},o.getSpineNameByResId=function(e){var t=g.default.getInstance().getResConfig(e);return t?L(t.animation):(console.log("cannot find spine id "+e),null)},o.Uint8ArrayToString=function(e){for(var t="",o=0;o<e.length;o++)t+=String.fromCharCode(e[o]);return t},o.StringToUint8Array=function(e){for(var t=[],o=0,i=e.length;o<i;++o)t.push(e.charCodeAt(o));return new Uint8Array(t)},o.snapshot=function(){try{var e=new cc.Node;e.width=cc.winSize.width,e.height=cc.winSize.height,e.parent=cc.find("Canvas"),e.anchorX=.5,e.anchorY=.5;var t=e.addComponent(cc.Camera);t.backgroundColor=cc.Color.TRANSPARENT,t.clearFlags=cc.Camera.ClearFlags.DEPTH|cc.Camera.ClearFlags.STENCIL|cc.Camera.ClearFlags.COLOR,t.cullingMask=4294967295,t.enabled=!1,l.G.UIManager.renderTexture&&(t.targetTexture=l.G.UIManager.renderTexture),t.render(),e.removeComponent(cc.Camera),e.removeFromParent(),e.destroy()}catch(o){}},o.isSpirit=function(e){return 2==g.default.getInstance().getHeroConfig(e).hero_type},o.checkDropEquipTimeOffset=function(e){return!r.default.getInstance().dropEquipTime[e]||C.TimeOffSetManager.getMilisecond()-r.default.getInstance().dropEquipTime[e]>1e3},o.updateDropEquipTime=function(e,t){r.default.getInstance().dropEquipTime[e]=t},o.checkOpenVoucher=function(){return c.default.getRoleAttrValByKey(u.ROLE_ATTR_VALUES.ROLE_ATTR_RECHARGENUM)>=Number(k("voucher_shop_need_recharge_num"))},o.checkPvPOverLimit=function(){return c.default.getRoleAttrValByKey(u.ROLE_ATTR_VALUES.ROLE_ATTR_DAY_BATTLE_NUM)>=Number(k("battle_num_day"))},o.getProficiencyIcon=function(e){var t=1,o=null;return f.ProficiencyTableData.getDataMap().forEach(function(i,a){e>=i.minProficiency&&(t=a,o=i)}),{lv:t,data:o}},o.getMatchPlayerCard=function(e,t){return r.default.getInstance().isSkyCastleEnemy(t)?s.default.getMatchBattleAICardInfo(t,Number(e)):s.default.getMatchPlayerCard(Number(e))},o.isNumber=function(e){return!!/^[0-9]*$/.test(e)},o.setBattleEffectOnOff=function(e){var t=e?"true":"false";cc.sys.localStorage.setItem("battleEffectOnOff",t)},o.getBattleEffectOnOff=function(){return!c.default.checkModulerOnOffState(59)||!cc.sys.localStorage.getItem("battleEffectOnOff")||w("battleEffectOnOff")},cc._RF.pop()},{"../../load":"load","../Global/GameGlobal":"GameGlobal","../StaticData/ConfigIntTableData":"ConfigIntTableData","../StaticData/ErrorCodeTableData":"ErrorCodeTableData","../StaticData/ProficiencyTableData":"ProficiencyTableData","../combat/CombatManager":"CombatManager","../common/CombatModule":"CombatModule","../common/PlayerModule":"PlayerModule","../modules/manager/cheat/SafeNumber":"SafeNumber","../network/protocol/TypeProtocols":"TypeProtocols","./ConfigUtils":"ConfigUtils","./ConstValue":"ConstValue","./GamePlatform":"GamePlatform","./LogUtil":"LogUtil","./ResourcesManager":"ResourcesManager","./TimeOffSetManager":"TimeOffSetManager"}],GameView:[function(e,t,o){"use strict";cc._RF.push(t,"e3531T2XOdFU5EVlem+l73f","GameView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0});var n=e("../manager/ModelManager"),r=e("../manager/ViewManager"),s=e("../../utils/LogUtil"),c=e("./BaseSingle"),l=e("./Configuration"),d=e("../../Global/GameGlobal"),u=e("../../utils/WechatUtils"),h=e("../../utils/UIManager"),p=e("../../utils/GamePlatform"),f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.clsMap=null,t}return a(t,e),t.prototype.onCreate=function(){var e=this;this.clsMap=new Map,cc.game.on(cc.game.EVENT_SHOW,function(){r.default.showOrHide("show"),e._timeOutId=setTimeout(e.pauseAudio,.05),e._pauseId=setTimeout(e.resumeAudio,.1)}),cc.game.on(cc.game.EVENT_HIDE,function(){r.default.showOrHide("hide")})},t.prototype.resumeAudio=function(){cc.sys.OS_IOS,cc.sys.os},t.prototype.pauseAudio=function(){},t.prototype.onDestroy=function(){this.clsMap=null,clearTimeout(this._timeOutId),clearTimeout(this._pauseId)},t.prototype.registerCls=function(e,t,o){e?o||!this.clsMap.get(t)&&!this.clsMap.get(e.name)?this.clsMap.set(t||e.name,e):s.default.error("cls \u6ce8\u518c\u5931\u8d25, cls name \u91cd\u590d,",t," ctor.name => ",e.name):s.default.error("cls \u6ce8\u518c\u5931\u8d25 ctor \u4e0d\u80fd\u4e3a\u7a7a, | ",e)},t.prototype.unregisterCls=function(e){e?this.clsMap.delete("string"==typeof e?e:e.name):s.default.warn("cls \u53d6\u6d88\u6ce8\u518c\u5931\u8d25 ctor \u4e0d\u80fd\u4e3a\u7a7a, | ",e)},t.prototype.registerModel=function(e){n.default.registerModel(e)},t.prototype.unregisterModel=function(e){n.default.unregisterModel(e)},t.prototype.getModel=function(e,t){void 0===t&&(t=!0);var o=this.autoConvertModelType(e);if(o)return n.default.getModel(o,t);s.default.warn("GameView | Model dont find",e,o)},t.prototype.autoConvertCtrlType=function(e){var t=null;if("string"==typeof e){if(!(t=this.clsMap.get(e)))return void s.default.error("\u63a7\u5236\u5668\u672a\u88ab\u6ce8\u518c | \u8bf7\u4f7f\u7528\u6ce8\u89e3 Register_Class")}else t=e;return t},t.prototype.autoConvertViewType=function(e){var t=null;if("string"==typeof e){if(!(t=this.clsMap.get(e)))return void s.default.error("\u63a7\u5236\u5668\u672a\u88ab\u6ce8\u518c | \u8bf7\u4f7f\u7528\u6ce8\u89e3 Register_Class")}else t=e;return t},t.prototype.autoConvertModelType=function(e){var t=null;if("string"==typeof e){if(!(t=this.clsMap.get(e)))return void s.default.error("\u63a7\u5236\u5668\u672a\u88ab\u6ce8\u518c | \u8bf7\u4f7f\u7528\u6ce8\u89e3 Z_Register_Class")}else t=e;return t},t.prototype.addPopView=function(e,t,o,i,a,n,c,f){var g=this.autoConvertCtrlType(e);if(g){var m=this.autoConvertViewType(t);if(m){if("ShopMainView"==o){var _=this.getViewByName("MainSceneView");if(_&&_.view&&0==_.view.getShopNodeShowState())return void(p.GamePlatform.isKuaishouMiniGame()&&d.G.StringManager.PopStringOnce("\u5f53\u524d\u7248\u672c\u4e0d\u652f\u6301\u652f\u4ed8"))}var y=this.getViewByName(o);if(y&&y.view){y.view.node.active=!0;var v=y.view.maskNode;v&&(v.active=!0)}else{if(p.GamePlatform.isWechat()&&d.G.UIManager.getCurSceneName()==h.SceneName.MainScene){var C=this.getViewByName("MainSceneView");C&&C.view&&0==C.view._moreNode.active&&u.WechatUtils.getInstance().m_gameClubBtn&&u.WechatUtils.getInstance().m_gameClubBtn.hide()}r.default.__showView__(g,m,o,i,l.VIEW_OPTION.OVERLAY,a,n,c,f)}}else s.default.warn("GameView | View dont find",t,m)}else s.default.warn("GameView | Ctrl dont find",e,g)},t.prototype.addLayerView=function(e,t,o,i,a,n,c){var d=this.autoConvertCtrlType(e);if(d){var u=this.autoConvertViewType(t);u?r.default.__showView__(d,u,o,i,l.VIEW_OPTION.LAYER,a,n,c,!1):s.default.warn("GameView | View dont find",t,u)}else s.default.warn("GameView | Ctrl dont find",e,d)},t.prototype.getViewByName=function(e){for(var t=0,o=r.default.layerCtrlList;t<o.length;t++){var i=o[t];if(i.cName===e)return i}for(var a=0,n=r.default.popCtrlList;a<n.length;a++){var s=n[a];if(s.cName===e)return s}return null},t.prototype.entryScene=function(e,t,o,i){r.default.__showScene__(e,t,o,i)},t.prototype.getViewNodeByName=function(e){for(var t=r.default.viewNodeList,o=0;o<t.length;o++)if(e==t[o].name)return t[o];return null},t}(c.BaseSingle);o.default=c.SingleFactory.getInstance(f),cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../utils/GamePlatform":"GamePlatform","../../utils/LogUtil":"LogUtil","../../utils/UIManager":"UIManager","../../utils/WechatUtils":"WechatUtils","../manager/ModelManager":"ModelManager","../manager/ViewManager":"ViewManager","./BaseSingle":"BaseSingle","./Configuration":"Configuration"}],GlobalMsgListener:[function(e,t,o){"use strict";cc._RF.push(t,"a55a4ww+VZGa4PYS1JUam65","GlobalMsgListener");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0}),o.GlobalMsgListener=void 0;var r=e("../combat/CombatManager"),s=e("../common/CombatModule"),c=e("../common/PlayerModule"),l=e("../network/ClientNetwork"),d=e("../network/FightNetwork"),u=e("../network/LocalMessage"),h=e("../network/protocol/FightProtocols"),p=e("../network/protocol/LoginProtocols"),f=e("../network/protocol/MatchProtocols"),g=e("../network/protocol/RoleProtocols"),m=e("../network/protocol/TypeProtocols"),_=e("../network/ReconnectLayer"),y=e("../utils/TimeOffSetManager"),v=e("../utils/UIManager"),C=e("./GameGlobal"),S=e("../network/protocol/long"),T=e("../utils/ConfigUtils"),I=e("../network/protocol/FightProtocols"),N=e("../utils/GameUtils"),b=e("../network/protocol/BaseProtocols"),w=e("../utils/ConstValue"),E=e("../network/protocol/FriendProtocls"),P=e("../modules/base/GameView"),R=e("../network/protocol/ChatProtocols"),L=e("../utils/NameManager"),A=e("../utils/GamePlatform"),D=e("../network/protocol/RechargeProtocols"),M=e("../StaticData/StringValueTableData"),B=e("../utils/RewardedVideoAd"),k=e("../utils/ResourceLoader"),G=e("../utils/GameLoading"),O=e("../network/protocol/ActivityProtocols"),H=e("../TalkingDataAPI"),V=e("../StaticData/TaskTableData"),F=e("../network/FightReconnectLayer"),U=e("../utils/WechatUtils"),x=e("../StaticData/RechargeTableData"),Y=e("../view/sociaty/SociatyCtrl"),j=e("../modules/manager/EventManager"),W=e("../common/EventConst"),z=e("../view/activity/ActivityModule"),K=e("../utils/QQMiniGameUtils"),q=e("../controller/Guide/GuideConfig/GuideConst"),Q=e("../Global"),X=e("../utils/LogUtil"),J=e("../utils/ByteDanceMiniGameUtils"),Z=e("../utils/QQGameHallUtils"),$=e("../view/pushGift/PushGiftUtils"),ee=e("../utils/GameTools"),te=e("../utils/LeniuGameUtils"),oe=e("../combat/unit/DropEquipObj"),ie=e("../common/CommandValue"),ae=e("../utils/KSMinigameUtils"),ne=e("../network/protocol/RoleProtocols"),re=e("../network/protocol/RoleProtocols"),se=e("../view/skyCastle/SkyCastleCtrl"),ce=e("../modules/manager/ViewManager"),le=e("../model/ServerAddrInfo"),de=e("../view/heroCardBag/HeroSkinUtils"),ue=e("../view/anniversary/AnniversaryCtrl"),he=e("../view/fogHidden/FogHiddenCtrl"),pe=e("../view/pushGift/NewerThreeDaysGiftUtils"),fe=e("../view/machineryCityActivity/MachineryCityCtrl"),ge=e("../network/protocol/FightProtocols"),me=e("../network/protocol/FightProtocols"),_e=cc._decorator.ccclass,ye=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.onLoad=function(){var e=this;cc.log("HHHHHHHHHHHHHHHH GlobalMsgListener.onLoad"),Y.default.registerSociatyProtocol(),se.default.registerSkyCastleProtocol(),ue.default.registerAnniversaryProtocol(),he.default.registerFogHiddenProtocol(),fe.default.registerMachinariumProtocol(),A.GamePlatform.isWechat()&&U.WechatUtils.getInstance().wxOnGameLiveStateChange(),l.ClientNetwork.getInstance().listenExtraMsg(l.EXTRA_MSG.EXTRA_MSG_CLOSE,function(e){console.log("HHHHHHHHHHHHHHHHHHH close"),_.default.setReconnectReason(0),C.G.UIManager.showReconnectLayer(C.G.UIManager.getRunningScene());var t=P.default.getViewByName("NavigationMainView");if(t&&t.view){var o=t.view.getReadNode();o&&o.destroy()}var i=P.default.getViewByName("SociatyFightMatchView");i&&i.view&&i.view.onClickCloseCallBack();var a=P.default.getViewByName("DetainmentView");a&&a.view&&a.view.closeView();var n=P.default.getViewByName("ChickenDinnerMainView");n&&n.view&&n.view.closeView(),$.default.Instance.clearAllGift();var r=P.default.getViewByName("MainSceneView");try{r&&r.view&&r.view.checkPushGiftBtn()}catch(l){}if((A.GamePlatform.isWechat()||A.GamePlatform.isQQMiniGame())&&!C.GameGlobal.gameHide){var s;if(A.GamePlatform.isWechat()?s=wx.getRealtimeLogManager?wx.getRealtimeLogManager():null:A.GamePlatform.isQQMiniGame()&&(s=qq.getRealtimeLogManager?qq.getRealtimeLogManager():null),s){console.log("getRealtimeLogManager~~~~~"+e.reason);var c=[];c[0]="logic onClose",c[1]=y.TimeOffSetManager.getMilisecond(),c[2]=e.code,null!=this.m_Ws&&(c[3]=this.m_Ws.bufferedAmount),s.error.apply(s,c)}H.TalkingDataAPI.event("client_socket_close",{code:e.code,reason:e.reason,time:y.TimeOffSetManager.getMilisecond(),brand:A.GamePlatform.getWechatSysInfoSync().brand})}}.bind(this),this),l.ClientNetwork.getInstance().listenExtraMsg(l.EXTRA_MSG.EXTRA_MSG_CONNCET_SUCCEED,function(){console.log("HHHHHHHHHHHHHHHHHHH open"),_.default.show()}.bind(this),this),l.ClientNetwork.getInstance().listenExtraMsg(l.EXTRA_MSG.EXTRA_MSG_PING_FAIL,function(){try{if(0==c.default.checkModulerOnOffState(46))return}catch(t){return}if(!_.default.show()){var e=C.G.StringManager.getString("SOCKET_CLOSE");A.GamePlatform.showModalRestartAlert(e)}}.bind(this),this),d.FightNetwork.getInstance().listenExtraMsg(d.FIGHTSERVER_EXTRA_MSG.EXTRA_MSG_FIGHTSEVER_CLOSE,function(e){if(console.log("HHHHHHHHHHHHHHHHHHH FightNetwork connect close"),C.G.UIManager.isFinghtingScene()&&r.getInstance().gameState==w.Game_State.Fighting&&F.default.ShowFightReconnectLayer(),(A.GamePlatform.isWechat()||A.GamePlatform.isQQMiniGame())&&!C.GameGlobal.gameHide&&r.getInstance().gameState==w.Game_State.Fighting){var t;if(A.GamePlatform.isWechat()?t=wx.getRealtimeLogManager?wx.getRealtimeLogManager():null:A.GamePlatform.isQQMiniGame()&&(t=qq.getRealtimeLogManager?qq.getRealtimeLogManager():null),console.log("fightnework onClose~~~~~"+t),t){console.log("fightnework onClose~~~~~"+e.reason);var o=[];o[0]="fight onClose",o[1]=y.TimeOffSetManager.getMilisecond(),o[2]=e.code,null!=this.m_Ws&&(o[3]=this.m_Ws.bufferedAmount),t.error.apply(t,o)}H.TalkingDataAPI.event("fight_socket_close",{code:e.code,reason:e.reason,time:y.TimeOffSetManager.getMilisecond(),brand:A.GamePlatform.getWechatSysInfoSync().brand})}}.bind(this),this),l.ClientNetwork.getInstance().listenProtocol(p.LOGIN_CLIENT_ENUM.P_Login_Ping,function(){console.log("recieve ping"),l.ClientNetwork.getInstance().m_SendPingTime=0},this),l.ClientNetwork.getInstance().listenLocalMessage(u.LOCAL_MESSAGE.LocalMsg_Begin,function(){}.bind(this),this),l.ClientNetwork.getInstance().listenProtocol(p.LOGIN_CLIENT_ENUM.P_Login_Validate,function(e){e.resetPos();var t=new p.S_Login_Validate;if(t.read(e)){if(l.ClientNetwork.getInstance().setKey(t.key),y.TimeOffSetManager.ProofTime(t.serverUTCTime),t.isSucceed){var o=new p.C_Login_RequestRole;return void(l.ClientNetwork.getInstance().Send(p.LOGIN_CLIENT_ENUM.P_Login_RequestRole,o)||(cc.error("SendData NC_LOGIN_VALIDATE Error!"),l.ClientNetwork.getInstance().Disconnect()))}C.G.UIManager.getRunningScene().name!=v.SceneName.LoginScene?(C.G.StringManager.PopString(C.G.StringManager.getString("LOGIN_WECHAT_SESSION_EXPIRE")),_.default.ShowReconnectLayer()):(cc.log("LOGIN_INPUT_ERROR"),C.G.StringManager.PopString(C.G.StringManager.getString("LOGIN_INPUT_ERROR")))}},this),l.ClientNetwork.getInstance().listenProtocol(p.LOGIN_CLIENT_ENUM.P_Login_RequestRole,function(e){if(!_.default.show()){e.resetPos();var t=new p.S_Login_RequestRole;if(t.read(e)){if(this._m_EnterGameStartTime=0,t.bIndulge&&(console.log("rsp.forbidLoginTimeRemaining========22222====================",t.forbidLoginTimeRemaining),t.forbidLoginTimeRemaining<=0))return console.log("\u5b9e\u540d\u8ba4\u8bc1================================================"),void P.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:C.G.StringManager.getString("REAL_TIP"),onlyConfirmBtn:!0,confirmCb:function(){C.G.UIManager.getRunningScene().name!=v.SceneName.LoginScene&&(cc.audioEngine.stopAll(),C.G.UIManager.LoadScene(v.SceneName.LoginScene,v.SceneTag.LoginScene,v.SceneType.Type0,null))}});if(t.roles.size>0){if(console.log("\u6709\u89d2\u8272"),t.forbidLoginTimeRemaining>0)return void P.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:C.G.StringManager.getString("ENTER_GAME_FORBID",y.TimeOffSetManager.getSecondStr(t.forbidLoginTimeRemaining)),onlyConfirmBtn:!0,confirmCb:function(){C.G.StringManager.PopStringOnce(C.G.StringManager.getString("ENTER_GAME_FORBID_COMFIRE"))}});var o=new p.C_Login_ChooseRole,i=Array.from(t.roles.values());o.roleId=i[0].roleID,l.ClientNetwork.getInstance().Send(p.LOGIN_CLIENT_ENUM.P_Login_ChooseRole,o),this._m_EnterGameStartTime=y.TimeOffSetManager.getServerUTCSecond()}else if(t.roles.size<=0){var a=new p.C_Login_CreateRole;a.headID=2003,a.name=L.default.getInstance().getName(0),console.log("\u521b\u5efa\u82f1\u96c4:"+a.name),a.sex=1,l.ClientNetwork.getInstance().Send(p.LOGIN_CLIENT_ENUM.P_Login_CreateRole,a)}}}},this),l.ClientNetwork.getInstance().listenProtocol(p.LOGIN_CLIENT_ENUM.P_Login_CreateRole,function(e){e.resetPos();var t=new p.S_Login_CreateRole;if(t.read(e))if(0==t.result){console.log("\u521b\u89d2\u6210\u529f",t.name);var o=new p.C_Login_ChooseRole;o.roleId=t.roleId,l.ClientNetwork.getInstance().Send(p.LOGIN_CLIENT_ENUM.P_Login_ChooseRole,o),A.GamePlatform.isWechat()?(wx.getStorageSync("createrole")||(wx.setStorage({key:"createrole",data:1}),H.TalkingDataAPI.event("createrole",{})),0==le.ServerAddrInfo.getInstance().getLastLoginGroup()&&(U.WechatUtils.getInstance().onSendFeishuConversionInfo(U.FeishuPostEventType.Active_Type),U.WechatUtils.getInstance().onSendFeishuConversionInfo(U.FeishuPostEventType.Active_Register_Type)),U.WechatUtils.getInstance().onSendBiliConversionInfo(U.BiliPostEventType.FORM_SUBMIT),U.WechatUtils.getInstance().onSendUcConversionInfo(U.UcPostEventType.APP_FIRST_ACTIVE),U.WechatUtils.getInstance().onSendUcConversionInfo(U.UcPostEventType.FORM_SUBMIT),U.WechatUtils.getInstance().onSendXTConversionInfo(U.XTPostEventType.APP_FIRST_ACTIVE),U.WechatUtils.getInstance().onSendXTConversionInfo(U.XTPostEventType.FORM_SUBMIT),U.WechatUtils.getInstance().onSendKSConversionInfo(U.KSPostEventType.APP_FIRST_ACTIVE),U.WechatUtils.getInstance().onSendKSConversionInfo(U.KSPostEventType.FORM_SUBMIT),U.WechatUtils.getInstance().onSendKSConversionInfo(U.KSPostEventType.ACTION_VALID),U.WechatUtils.getInstance().onSendAQiYiConversionInfo(U.AQYPostEventType.APP_FIRST_ACTIVE),U.WechatUtils.getInstance().onSendAiQiYiConversionInfo(U.AQYPostEventType.APP_FIRST_ACTIVE),U.WechatUtils.getInstance().returnBack_360dianjing(U.Wechat360dianjing.ROLE_CREAT,"")):A.GamePlatform.isQQMiniGame()?(qq.getStorageSync("createrole")||(qq.setStorage({key:"createrole",data:1}),H.TalkingDataAPI.event("createrole",{})),K.QQMiniGameUtils.getInstance().onSendDouYinConversionInfo(K.DanceJumpPostEventType.Active_Register_Type)):A.GamePlatform.isByteDanceMiniGame()?tt.getStorageSync("createrole")||(tt.setStorage({key:"createrole",data:1}),H.TalkingDataAPI.event("createrole",{})):"bigBlue"==A.GamePlatform.getMiYaVideoTypeNoSet()||"ly5add7"==A.GamePlatform.getMiYaVideoTypeNoSet()?A.GamePlatform.sendInfoGame("createrole",t.roleId,t.name):A.GamePlatform.isQQGameRoom()?Z.QQGameHallUtils.Instance.reprot_createPlayer():A.GamePlatform.isKuaishouMiniGame(),y.TimeOffSetManager.getServerUTCSecond()}else if(-1==t.result)console.log("message_name_exist"),C.G.StringManager.PopString(C.G.StringManager.getString("CREATE_ROLE_NAME_CONFLICT"));else{console.log("\u540d\u5b57\u4e0d\u5408\u6cd5"),C.G.StringManager.PopString(C.G.StringManager.getString("ROLE_NAME_BAD_TEXT"));var i=new p.C_Login_CreateRole;i.headID=2003;var a=L.default.getInstance().getName(0),n=0;if(A.GamePlatform.isWechat())(r=wx.getStorageSync("wxSex"))&&2==r&&(n=1),a=L.default.getInstance().getName(n);else if(A.GamePlatform.isQQMiniGame())(r=qq.getStorageSync("wxSex"))&&2==r&&(n=1),a=L.default.getInstance().getName(n);else if(A.GamePlatform.isByteDanceMiniGame())(r=tt.getStorageSync("wxSex"))&&2==r&&(n=1),a=L.default.getInstance().getName(n);else if(A.GamePlatform.isQQGameRoom())n=0,a=L.default.getInstance().getName(n);else if(A.GamePlatform.isKuaishouMiniGame()){var r;(r=wx.getStorageSync("wxSex"))&&2==r&&(n=1),a=L.default.getInstance().getName(n)}N.setLocalData("accountName",a),console.log("\u521b\u5efa\u82f1\u96c4:"+a),i.name=a,i.sex=n,l.ClientNetwork.getInstance().Send(p.LOGIN_CLIENT_ENUM.P_Login_CreateRole,i)}else console.log("\u5931\u8d25")},this),l.ClientNetwork.getInstance().listenProtocol(p.LOGIN_CLIENT_ENUM.P_Login_ChooseRole,function(e){if(!_.default.show()){e.resetPos();var t=new p.S_Login_ChooseRole;t.read(e)&&(this._m_EnterGameStartTime=0,t.result),A.GamePlatform.isQQGameRoom()&&(Z.QQGameHallUtils.getInstance().refreshBlueVipData(),Z.QQGameHallUtils.Instance.reprot_playerLogin())}},this),l.ClientNetwork.getInstance().listenProtocol(g.ROLE_CLIENT_ENUM.P_Role_RoleEnterLogic,function(e){if(e.resetPos(),(new g.S_Role_RoleEnterLogic).read(e)){console.log("P_Role_RoleEnterLogic ok"),this.requestLocalInfo();var t=new g.C_Role_SynRoleData;t.clientVer="1.0",l.ClientNetwork.getInstance().Send(g.ROLE_CLIENT_ENUM.P_Role_SynRoleData,t)}else console.log("P_Role_RoleEnterLogic error")},this),l.ClientNetwork.getInstance().listenProtocol(g.ROLE_CLIENT_ENUM.P_Role_SynItemData,function(e){e.resetPos();var t=new g.S_Role_SynItemData;t.read(e)?c.default.changeRoleBagItem(t):cc.error("P_Role_SynItemData error!!")},this),l.ClientNetwork.getInstance().listenProtocol(g.ROLE_CLIENT_ENUM.P_Role_SynRoleData,function(e){e.resetPos();var t=new g.S_Role_SynRoleData;if(t.read(e)){if(c.default.synData(t),ce.default.closeAllPopView(),A.GamePlatform.isWechat()&&0!=le.ServerAddrInfo.getInstance().getLastLoginGroup()){var o=le.ServerAddrInfo.getInstance().getLastLoginServerInfo(),i=c.default.getRoleAttrValByKey(m.ROLE_ATTR_VALUES.ROLE_ATTR_LOGOUTTIME),a=o.loginTime,n=wx.getLaunchOptionsSync().query;a-i>=1209600&&n.clue_token&&(console.log("old account onSendFeishuConversionInfo================",i,"currTime===",a),U.WechatUtils.getInstance().onSendFeishuConversionInfo(U.FeishuPostEventType.Active_Type),U.WechatUtils.getInstance().onSendFeishuConversionInfo(U.FeishuPostEventType.Active_Register_Type))}C.G.UIManager.hideWaitingLayer(""),l.ClientNetwork.getInstance().pushLocalMessage(u.LOCAL_MESSAGE.LocalMsg_EnterMainScene);var r=c.default.getRoleAttrValByKey(m.ROLE_ATTR_VALUES.ROLE_ATTR_ONLINE_DAYNUM),s=c.default.getRoleAttrValByKey(m.ROLE_ATTR_VALUES.ROLE_ATTR_DAY_LOGINNUM);if(1==r&&1==s)if(A.GamePlatform.isWechat())U.WechatUtils.getInstance().onSendFeishuConversionInfo(U.FeishuPostEventType.Next_Day_Open),U.WechatUtils.getInstance().onSendUcConversionInfo(U.UcPostEventType.RETENTION),U.WechatUtils.getInstance().onSendKSConversionInfo(U.KSPostEventType.RETENTION);else if(A.GamePlatform.isQQMiniGame()){var d=qq.getStorageSync("isDancejumpQQ");d&&(console.log("qq\u5c0f\u6e38\u620f\u6b21\u7559",d),K.QQMiniGameUtils.getInstance().onSyncDanceJumpQQturnback(d,K.DanceJumpPostEventType.Next_Day_Open))}if(A.GamePlatform.isWechat()){var h=U.WechatUtils.getInstance().getGameLiveFeedId(),p=U.WechatUtils.getInstance().wxGetGameLiveState();h&&h.length>0&&0==p&&U.WechatUtils.getInstance().wxGetUserRecentGameLiveInfo()}else if(A.GamePlatform.isQQMiniGame());else if(A.GamePlatform.isByteDanceMiniGame());else if(A.GamePlatform.isKuaishouMiniGame());else if("ly"==A.GamePlatform.getMiYaPlatformType()){var f=P.default.getViewByName("MainSceneView");f&&f.view&&(f.view.onShowPlayerName(),f.view.onShowPlayerHeadFrame(),f.view.onShowPlayerHead(),f.view._playerCup.string=c.default.getRoleAttrValByKey(m.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE))}}else cc.error("role sync read error!!")},this),l.ClientNetwork.getInstance().listenProtocol(g.ROLE_CLIENT_ENUM.P_Role_SyncProficiencyData,function(e){e.resetPos();var t=new ne.S_Role_SyncProficiencyData;t.read(e)&&(console.log("P_Role_SyncProficiencyData:",t),c.default.setHeroProficiencyData(t.roleProficiency.proficiencyInfoMap))},this),l.ClientNetwork.getInstance().listenProtocol(g.ROLE_CLIENT_ENUM.P_Role_FightBalance,function(e){e.resetPos();var t=new g.S_Role_FightBalance;if(t.read(e))if(console.log("P_Role_FightBalance errorcode\uff1a%d",t.bWin),C.G.UIManager.getCurSceneName()==v.SceneName.PveFightScene)r.getInstance().showFightResult(t),r.getInstance().sendFightResultMsg=!1;else{c.default.setFightBalanceData(t);var o=P.default.getViewByName("MainSceneView");o&&o.view&&o.view.onCheckFightResult()}},this),l.ClientNetwork.getInstance().listenProtocol(g.ROLE_CLIENT_ENUM.P_Role_SynRoleAttrValue,function(e){e.resetPos();var t=new g.S_Role_SynRoleAttrValue;t.read(e)&&c.default.setRoleAttrValByKey(t.index,t.value)},this),l.ClientNetwork.getInstance().listenProtocol(g.ROLE_CLIENT_ENUM.P_Role_SynRoleInformationData,function(e){e.resetPos();var t=new g.S_Role_SynRoleInformationData;t.read(e)&&c.default.setRoleInfoData(t._data)},this),l.ClientNetwork.getInstance().listenProtocol(g.ROLE_CLIENT_ENUM.P_Role_UpdateChapter,function(){},this),l.ClientNetwork.getInstance().listenProtocol(g.ROLE_CLIENT_ENUM.P_Role_SynTaskData,function(e){e.resetPos();var t=new g.S_Role_SynTaskData;if(t.read(e)){c.default.refreshRoleTaskDate(t.changeTask),c.default.deleteRoleTaskDate(t.deleteTask),l.ClientNetwork.getInstance().pushLocalMessage(u.LOCAL_MESSAGE.LocalMsg_RefreshTask);var o=P.default.getViewByName("MainSceneView");o&&o.view&&o.view.onShowTaskRedPoint()}else cc.log("\u8bfb\u53d6\u5931\u8d25")},this),l.ClientNetwork.getInstance().listenProtocol(g.ROLE_CLIENT_ENUM.P_Role_SynTaskExtraData,function(e){e.resetPos();var t=new g.S_Role_SynTaskExtraData;if(t.read(e)){c.default.refreshRoleExtraTaskData(t._data);var o=P.default.getViewByName("MainSceneView");o&&o.view&&o.view.onShowTaskRedPoint()}else cc.log("\u8bfb\u53d6\u5931\u8d25")},this),l.ClientNetwork.getInstance().listenProtocol(E.FRIEND_CLIENT_ENUM.P_Friend_SynLoginData,function(e){e.resetPos();var t=new E.S_Friend_SynLoginData;t.read(e)?c.default.setFriendsData(t):cc.log("\u8bfb\u53d6\u5931\u8d25")},this),l.ClientNetwork.getInstance().listenProtocol(E.FRIEND_CLIENT_ENUM.P_Friend_BeApplyFriend,function(e){if(e.resetPos(),(new E.S_Friend_BeAgreeApply).read(e)){c.default.getFriendsData().applyNum++;var t=P.default.getViewByName("MainSceneView");t&&t.view&&t.view.onShowFriendRedPoint(),l.ClientNetwork.getInstance().pushLocalMessage(u.LOCAL_MESSAGE.LocalMsg_Friend_BeApply)}else cc.log("\u8bfb\u53d6\u5931\u8d25")},this),l.ClientNetwork.getInstance().listenProtocol(D.RECHARGE_CLIENT_ENUM.P_Recharge_Role_Recharge,function(e){e.resetPos();var t=new D.S_Recharge_Role_Recharge;if(t.read(e))if(X.default.log("\u5145\u503c\u534f\u8bae\u8fd4\u56de",t),console.log("wxPayChange serverret e = "+t.errorcode),2===t.errorcode)if(A.GamePlatform.isWechat())U.WechatUtils.getInstance().pay(t.rechargeID,t.rechargeNum,t.rechargeValue,t.wxPayType);else if(A.GamePlatform.isQQMiniGame())K.QQMiniGameUtils.getInstance().pay(t.rechargeID,t.rechargeNum,t.rechargeValue);else if(A.GamePlatform.isByteDanceMiniGame())J.default.getInstance().pay(t.rechargeID,t.rechargeNum,t.rechargeValue);else if(A.GamePlatform.isQQGameRoom())Z.QQGameHallUtils.getInstance().pay(t.rechargeID,t.rechargeNum,t.rechargeValue);else if(A.GamePlatform.isKuaishouMiniGame())ae.KSMinigameUtils.getInstance().pay(t.rechargeID,t.rechargeNum,t.rechargeValue);else{var o=(new Date).getTime();o-A.GamePlatform.payTime>=2e3&&(A.GamePlatform.MiYaToPay(t),A.GamePlatform.setAppPayTime(o))}else if(0===t.errorcode){if(A.GamePlatform.isWechat()){var i=x.RechargeTableData.getById(t.rechargeID),a=1*i.money,n=String(i.money/100);U.WechatUtils.getInstance().onSendFeishuConversionInfo(U.FeishuPostEventType.Active_Pay_Type,a),U.WechatUtils.getInstance().onSendBiliConversionInfo(U.BiliPostEventType.USER_COST,a),U.WechatUtils.getInstance().onSendUcConversionInfo(U.UcPostEventType.USER_COST,n),U.WechatUtils.getInstance().onSendXTConversionInfo(U.XTPostEventType.USER_COST,a),U.WechatUtils.getInstance().onSendKSConversionInfo(U.KSPostEventType.USER_COST,.01*i.money),U.WechatUtils.getInstance().onSendAQiYiConversionInfo(U.AQYPostEventType.APP_FIRST_ACTIVE),U.WechatUtils.getInstance().onSendAQiYiConversionInfo(U.AQYPostEventType.USER_COST,a),U.WechatUtils.getInstance().returnBack_360dianjing(U.Wechat360dianjing.ORDER,a+""),c.default.checkModulerOnOffState(ie.ModulerViewOnOff.rechargeProtect)&&(console.log("retryNoticeServerPay clearLocal"),N.setLocalData("userPayRechargeInfo","")),(r=wx.getStorageSync("isAIQIYI"))&&(console.log("aiqiyi===================",r),U.WechatUtils.getInstance().onSyncAIQIYIturnback(r,U.AQYPostEventType.USER_COST,a))}else if(A.GamePlatform.isQQMiniGame()){var r;(r=qq.getStorageSync("isDancejumpQQ"))&&(console.log("qq\u5c0f\u6e38\u620f\u5145\u503c",r),K.QQMiniGameUtils.getInstance().onSyncDanceJumpQQturnback(r,K.DanceJumpPostEventType.Active_Pay_Type))}if(console.log("P_Recharge_Role_Recharge"),t.prize.length>0){var s=P.default.getViewByName("MainSceneView");if(s&&s.view){P.default.addPopView("BaseCtrl","AcquirePopupView","AcquirePopupView",{items:t.prize});var l=P.default.getViewByName("SociatyCreateRedEnvelopeView");return void(l&&l.view&&l.view.closeView())}c.default.setRechargePrizeData(t.prize)}te.LeniuGameUtils.Instance.reportPlayerInfo()}},this),l.ClientNetwork.getInstance().listenProtocol(g.ROLE_CLIENT_ENUM.P_Role_IndulgeArrivalTime,function(e){e.resetPos(),(new g.S_Role_IndulgeArrivalTime).read(e)&&(console.log("\u9632\u6c89\u8ff7-------\u6e38\u620f\u65f6\u95f4\u5230================================================"),P.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:C.G.StringManager.getString("REAL_TIME"),onlyConfirmBtn:!0,confirmCb:function(){C.G.UIManager.getRunningScene().name!=v.SceneName.LoginScene&&(cc.audioEngine.stopAll(),C.G.UIManager.LoadScene(v.SceneName.LoginScene,v.SceneTag.LoginScene,v.SceneType.Type0,null))}},9999))},this),cc.director.on("endGameTip",function(){console.log("endGameTip---------------------"),P.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:C.G.StringManager.getString("REPACK_TIP"),onlyConfirmBtn:!0,confirmCb:function(){cc.director.pause(),cc.audioEngine.stopAll(),cc.director.isPaused()&&cc.game.end()}},9999)},this),cc.director.on("LoginFailReLogin",function(){P.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:"\u767b\u5f55\u9a8c\u8bc1\u5931\u8d25\uff0c\u8bf7\u9000\u51fa\u6e38\u620f\u91cd\u65b0\u767b\u5f55!",onlyConfirmBtn:!0,confirmCb:function(){AppActivity.exitGame()}},9999)},this),cc.director.on("logoutOrChangeAccount",function(){c.default.getRoleAttrValByKey(m.ROLE_ATTR_VALUES.ROLE_ATTR_GUIDE)<q.default.BattleGuide.guideId&&0==Q.default.Instance.jumpGuide||(console.log("logoutOrChangeAccount---------------------"),cc.audioEngine.stopAll(),C.G.UIManager.LoadScene(v.SceneName.LoginScene,v.SceneTag.LoginScene,v.SceneType.Type0,null),A.GamePlatform.IsH5SmallBag()&&C.G.StringManager.PopStringOnce("\u9519\u8bef\u78011..."))},this),cc.director.on("changeAccountOrLogoutBigBlue",function(){console.log("changeAccountOrLogoutBigBlue-------------------"),cc.audioEngine.stopAll(),C.G.UIManager.LoadScene(v.SceneName.LoginScene,v.SceneTag.LoginScene,v.SceneType.Type0,null),A.GamePlatform.IsH5SmallBag()&&C.G.StringManager.PopStringOnce("\u9519\u8bef\u78012..."),A.GamePlatform.IsLYSmallBag()||A.GamePlatform.Is5Add7SmallBag()?C.G.UIManager.getRunningScene().name==v.SceneName.LoginScene&&AppActivity.RequestLogin():A.GamePlatform.IsSmallBag()?AppActivity.RequestLogin():A.GamePlatform.isAndroid()&&jsb.reflection.callStaticMethod("org/cocos2dx/javascript/AppActivity","RequestLogin","()V")},this),cc.director.on("changeAccountOrLogoutBigBlue2",function(){console.log("changeAccountOrLogoutBigBlue2-------------------"),C.G.UIManager.getRunningScene().name!=v.SceneName.LoginScene?(cc.audioEngine.stopAll(),C.G.UIManager.LoadScene(v.SceneName.LoginScene,v.SceneTag.LoginScene,v.SceneType.Type0,null),A.GamePlatform.IsH5SmallBag()&&C.G.StringManager.PopStringOnce("\u9519\u8bef\u78013...")):jsb.reflection.callStaticMethod("AppController","RequestLogin")},this),cc.director.on("payResultTip",function(e){console.log("payResultTip==========="),C.G.StringManager.PopString(e)},this),l.ClientNetwork.getInstance().listenProtocol(g.ROLE_CLIENT_ENUM.P_Role_SynRoleRechargeData,function(e){e.resetPos();var t=new g.S_Role_SynRoleRechargeData;t.read(e)&&(c.default.setRoleRechargeData(t._data),l.ClientNetwork.getInstance().pushLocalMessage(u.LOCAL_MESSAGE.LocalMsg_RechargeSuccess))},this),cc.director.on("wechatOnShow",function(e){console.log("\u6e38\u620f\u8fdb\u5165\u524d\u53f0"),A.GamePlatform.isWechat()?U.WechatUtils.getInstance().checkInviteInfo(e):A.GamePlatform.isQQMiniGame()?K.QQMiniGameUtils.getInstance().checkInviteInfo(e):A.GamePlatform.isByteDanceMiniGame()?J.default.getInstance().checkInviteInfo(e):A.GamePlatform.isKuaishouMiniGame()&&ae.KSMinigameUtils.getInstance().checkInviteInfo(e);var t=new g.C_Role_Get_Server_Time;l.ClientNetwork.getInstance().Send(g.ROLE_CLIENT_ENUM.P_Role_Get_Server_Time,t),C.GameGlobal.gameHide=!1},this),cc.director.on("wechatOnHide",function(){console.log("\u6e38\u620f\u8fdb\u5165\u540e\u53f0"),C.GameGlobal.gameHide=!0},this),cc.director.on("wechatOnMemoryWarning",function(){console.log("\u6e38\u620f\u5185\u5b58\u544a\u8b66"),A.GamePlatform.isWechat()&&wx.triggerGC()},this),cc.director.on("underAgeTip",function(e){P.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:C.G.StringManager.getString(e),onlyConfirmBtn:!0,confirmCb:function(){C.G.UIManager.getRunningScene().name!=v.SceneName.LoginScene&&(cc.audioEngine.stopAll(),C.G.UIManager.LoadScene(v.SceneName.LoginScene,v.SceneTag.LoginScene,v.SceneType.Type0,null))}},9999)},this),l.ClientNetwork.getInstance().listenProtocol(f.MATCH_CLIENT_ENUM.P_Match_Result,function(e){e.resetPos();var t=new f.S_Match_Result;if(t.read(e)){var o=t.ret;if(0==o){if(r.getInstance().gameState==w.Game_State.Reconnect)return;if(t.matchRoles.forEach(function(e,o){e.roleID.equals(c.default.UUID)?s.default.setMatchBattleInfo(!0,e):t.fightType==m.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE&&o.isNegative()?s.default.setMatchBattleAIInfo(o,e):(s.default.setMatchBattleInfo(!1,e),s.default.setMatchPlayerCards(e.heros))}),s.default.matchModule=t.fightModule,s.default.matchType=t.fightType,s.default.matchToken=t.fightToken,s.default.matchPattern=t.fightPattern,s.default.matchRoleIdentity=t.roleIdentity,s.default.matchSeedIds=t.seedId,s.default.coopBossIdIndexs=t.bossIdIndexs,s.default.matchType==m.FIGHT_TYPE.FIGHT_TYPE_BATTLE||s.default.matchType==m.FIGHT_TYPE.FIGHT_TYPE_BATTLE_GOLDENLEAGUE||s.default.matchType==m.FIGHT_TYPE.FIGHT_TYPE_BATTLE_EAT_CHICKEN||s.default.matchType==m.FIGHT_TYPE.FIGHT_TYPE_BATTLE_SOCIATY_WAR||s.default.matchType==m.FIGHT_TYPE.FIGHT_TYPE_ANNIVERSARY_TRIAL?s.default.setCombatType(s.CombatType.SOLO):s.default.matchType==m.FIGHT_TYPE.FIGHT_TYPE_COOPERATION||s.default.matchType==m.FIGHT_TYPE.FIGHT_TYPE_BATTLE_GREAT_SAILING||s.default.matchType==m.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE||s.default.matchType==m.FIGHT_TYPE.FIGHT_TYPE_WEEK_COOPERATION||s.default.matchType==m.FIGHT_TYPE.FIGHT_TYPE_FOG_HIDDEN||s.default.matchType==m.FIGHT_TYPE.FIGHT_TYPE_MACHINARIUM?s.default.setCombatType(s.CombatType.COOP):s.default.matchType==m.FIGHT_TYPE.FIGHT_TYPE_DUEL_BATTLE&&s.default.setCombatType(s.CombatType.DUEL),s.default.matchType==m.FIGHT_TYPE.FIGHT_TYPE_BATTLE_GOLDENLEAGUE){var i=P.default.getViewByName("ActivityGoldenLeagueView");if(i&&i.view){var a=i.view.getActivityEndTime();a>0&&(s.default.wudaohuiEndTime=a)}}l.ClientNetwork.getInstance().pushLocalMessage(u.LOCAL_MESSAGE.LocalMsg_MatchSuccess,t);var n=0;if(s.default.getCombatType()==s.CombatType.SOLO||s.default.getCombatType()==s.CombatType.DUEL){var h=c.default.getRoleAttrValByKey(m.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE),p=0;if((p=s.default.getCombatType()==s.CombatType.DUEL?101:s.default.matchType==m.FIGHT_TYPE.FIGHT_TYPE_BATTLE_GOLDENLEAGUE?11:s.default.matchType==m.FIGHT_TYPE.FIGHT_TYPE_BATTLE_EAT_CHICKEN?z.default.getChickenDinneBattleMapIdByDate():s.default.matchType==m.FIGHT_TYPE.FIGHT_TYPE_BATTLE_SOCIATY_WAR?13:s.default.matchType==m.FIGHT_TYPE.FIGHT_TYPE_ANNIVERSARY_TRIAL?17:T.default.getInstance().getRoleScoreByScore(h).battleId)>0&&s.default.setBattleMapId(p),(b=T.default.getInstance().getBattleCfg())[p]){var g=b[p].summon_id.split("|");for(var _ in g){var y=g[_].split("#");s.default.setCarSummonId(y[0],y[1])}}}else{var S=0,I=T.default.getInstance().getBattleCfg();if(s.default.matchType==m.FIGHT_TYPE.FIGHT_TYPE_COOPERATION)S=10;else if(s.default.matchType==m.FIGHT_TYPE.FIGHT_TYPE_BATTLE_GREAT_SAILING)S=14;else if(s.default.matchType==m.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE){var b;if(S=15,(b=T.default.getInstance().getBattleCfg())[S])for(var _ in g=b[S].summon_id.split("|"))y=g[_].split("#"),s.default.setCarSummonId(y[0],y[1])}else s.default.matchType==m.FIGHT_TYPE.FIGHT_TYPE_WEEK_COOPERATION?S=16:s.default.matchType==m.FIGHT_TYPE.FIGHT_TYPE_FOG_HIDDEN?S=18:s.default.matchType==m.FIGHT_TYPE.FIGHT_TYPE_MACHINARIUM&&(S=19);s.default.setBattleMapId(S),n=I[S].bath_id}if(n&&n>0&&s.default.setBatchMonsterId(n),""!=t.fightServerIp&&0!=t.fightServerPort||""!=t.fightServerIpSSL&&0!=t.fightServerPortSSL){if(A.GamePlatform.isWechat()||A.GamePlatform.isQQMiniGame()||A.GamePlatform.isByteDanceMiniGame()||A.GamePlatform.isQQGameRoom()||A.GamePlatform.IsSmallBag()||A.GamePlatform.IsH5SmallBag()||A.GamePlatform.IsMiYaIosH5()||A.GamePlatform.IsLYSmallBag()||A.GamePlatform.IsMYSmallBag()||A.GamePlatform.IsYLSmallBag()||A.GamePlatform.isKuaishouMiniGame()||A.GamePlatform.IsDysbSmallBag()||A.GamePlatform.Is5Add7SmallBag()){(A.GamePlatform.IsSmallBag()||A.GamePlatform.IsH5SmallBag())&&(t.fightServerPortSSL=t.fightServerPortSSL%1e3+3e4),console.log("fightServerPortSSL wss"+t.fightServerIpSSL+t.fightServerPortSSL);var E="ws://"+t.fightServerIpSSL;d.FightNetwork.getInstance().Connect(E),F.default.setFightUrl(E)}else console.log("fightServerPortSSL ws"+t.fightServerIp+t.fightServerPort),E="ws://"+t.fightServerIp,d.FightNetwork.getInstance().Connect(E),F.default.setFightUrl(E);this.scheduleOnce(this.checkEnterBattleTimeOut,N.getEnterBattleTimeoutTime())}else s.default.matchType==m.FIGHT_TYPE.FIGHT_TYPE_BATTLE||s.default.matchType==m.FIGHT_TYPE.FIGHT_TYPE_DUEL_BATTLE||s.default.matchType==m.FIGHT_TYPE.FIGHT_TYPE_BATTLE_SOCIATY_WAR||s.default.matchType==m.FIGHT_TYPE.FIGHT_TYPE_ANNIVERSARY_TRIAL?k.ResourceLoaderLayer.setType(v.ResourceType.fight_pvp_from_main):s.default.matchType!=m.FIGHT_TYPE.FIGHT_TYPE_COOPERATION&&s.default.matchType!=m.FIGHT_TYPE.FIGHT_TYPE_BATTLE_GREAT_SAILING&&s.default.matchType!=m.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE&&s.default.matchType!=m.FIGHT_TYPE.FIGHT_TYPE_WEEK_COOPERATION&&s.default.matchType!=m.FIGHT_TYPE.FIGHT_TYPE_FOG_HIDDEN||k.ResourceLoaderLayer.setType(v.ResourceType.fight_pve_from_main),this.scheduleOnce(function(){G.default.setCallBack(null,function(){C.G.UIManager.LoadScene(v.SceneName.PveFightScene,v.SceneTag.PveFightScene)}),G.default.show()},.5)}else console.log("P_Match_Result errorcode\uff1a%d",o)}else console.log("P_Match_Result error"),C.G.StringManager.PopString(C.G.StringManager.getString("MATCH_FAIL",t.ret)),l.ClientNetwork.getInstance().pushLocalMessage(u.LOCAL_MESSAGE.LocalMsg_MatchFail)},this),l.ClientNetwork.getInstance().listenProtocol(g.ROLE_CLIENT_ENUM.P_Role_Fight_Reconnect,function(e){console.log("P_Role_Fight_Reconnect start"),e.resetPos();var t=new g.S_Role_Fight_Reconnect;if(t.read(e)){var o=t.ret;if(0==o)if(r.getInstance().gameState=w.Game_State.Reconnect,c.default.setFightReconnectData(null),c.default.setFightReconnectData(t),C.G.UIManager.isFinghtingScene())r.getInstance().exitMap(),C.G.UIManager.gotoMainScene(null,function(){P.default.addLayerView("BaseCtrl","MainSceneView","MainSceneView")});else{s.CombatType.SOLO,t.fightType==m.FIGHT_TYPE.FIGHT_TYPE_BATTLE||t.fightType==m.FIGHT_TYPE.FIGHT_TYPE_BATTLE_SOCIATY_WAR||t.fightType==m.FIGHT_TYPE.FIGHT_TYPE_BATTLE_GOLDENLEAGUE||t.fightType==m.FIGHT_TYPE.FIGHT_TYPE_BATTLE_EAT_CHICKEN||t.fightType==m.FIGHT_TYPE.FIGHT_TYPE_ANNIVERSARY_TRIAL?s.CombatType.SOLO:t.fightType==m.FIGHT_TYPE.FIGHT_TYPE_COOPERATION||t.fightType==m.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE||t.fightType==m.FIGHT_TYPE.FIGHT_TYPE_WEEK_COOPERATION||t.fightType==m.FIGHT_TYPE.FIGHT_TYPE_FOG_HIDDEN||t.fightType==m.FIGHT_TYPE.FIGHT_TYPE_MACHINARIUM?s.CombatType.COOP:t.fightType==m.FIGHT_TYPE.FIGHT_TYPE_DUEL_BATTLE&&s.CombatType.DUEL;var i=P.default.getViewByName("MainSceneView"),a=P.default.getViewByName("MatchMainView");if(i&&i.view){var n=0;return a&&a.view&&a.view.node.active&&(a.view.closeView(),n=.5),N.setTouchEnabled(!1),i.view.removeFightReconnectDataDelay(),void this.scheduleOnce(function(){P.default.addPopView("BaseCtrl","MatchMainView","MatchMainView",{ntype:t.fightType})},n)}}else console.log("P_Role_Fight_Reconnect errorcode\uff1a%d",o)}else console.log("P_Role_Fight_Reconnect error")},this),l.ClientNetwork.getInstance().listenProtocol(h.FIGHT_CLIENT_ENUM.P_Fight_Help_Scene_SYNC,function(e){console.log("P_Fight_Help_Scene_SYNC start"),e.resetPos();var t=new I.S_Fight_Help_Scene_SYNC;try{if(t.read(e))if(t.roleID.equals(c.default.UUID)){var o=new I.C_Fight_Scene_SYNC;o.wave=r.getInstance().batchModel.getIndexTip(),o.waveTimelineIndex=r.getInstance().batchModel.getCurIndex(),o.bossIDIndex=r.getInstance().batchModel.npcId,console.log("P_Fight_Help_Scene_SYNC start1"),r.getInstance().getController().fightTopObjViewScript&&r.getInstance().getController().fightTopObjViewScript.pvpTimeNum&&(o.waveTimelineIndexPassTime=r.getInstance().getController().fightTopObjViewScript.pvpTimeNum),r.getInstance().isCoop()&&(o.battleState=r.getInstance().batchModel.lastTime,-1==o.battleState?o.sceneTime=r.getInstance().batchModel.nBatchDelayTime:-2==o.battleState||(o.sceneTime=r.getInstance().batchModel.lastTime-r.getInstance().batchModel.deltaTime));var i=r.getInstance().getSelfCombatModel(),a=w.PLAYER_CAMP.opponents;r.getInstance().isCoop()&&(a=w.PLAYER_CAMP.coopPlayer);var n=r.getInstance().getPlayerModelByCamp(a),l=function(e,t){if(t){if(t instanceof oe.default)return;t.isFlyingobj()?t.emitterNpc.isHero()?(e.towerData.heroID=t.emitterNpc.heroTemplateId,e.towerData.roleIdentity=N.getRoleIdentity(t.getCamp())):e.sourceGid=Number(t.emitterNpc.id):t.isHero()?(e.towerData.heroID=t.heroTemplateId,e.towerData.roleIdentity=N.getRoleIdentity(t.getCamp())):e.sourceGid=Number(t.id)}},u=function(e,t){var o=r.getInstance().getPlayerModelByCamp(e);o&&o.setChangeSpritRS(t)},p=function(e,t){var o=r.getInstance().getPlayerModelByCamp(e);o&&o.setBossChangeSpritRS(t)};console.log("P_Fight_Help_Scene_SYNC start2");var f=s.default.getMatchBattleInfo(!0),g=s.default.getMatchBattleInfo(!1);o.reportData.isWin=!1,s.default.getCombatType()==s.CombatType.SOLO?s.default.matchType==m.FIGHT_TYPE.FIGHT_TYPE_BATTLE_GOLDENLEAGUE?o.reportData.fightType=m.FIGHT_TYPE.FIGHT_TYPE_BATTLE_GOLDENLEAGUE:s.default.matchType==m.FIGHT_TYPE.FIGHT_TYPE_BATTLE_EAT_CHICKEN?o.reportData.fightType=m.FIGHT_TYPE.FIGHT_TYPE_BATTLE_EAT_CHICKEN:s.default.matchType==m.FIGHT_TYPE.FIGHT_TYPE_BATTLE_SOCIATY_WAR?o.reportData.fightType=m.FIGHT_TYPE.FIGHT_TYPE_BATTLE_SOCIATY_WAR:s.default.matchType==m.FIGHT_TYPE.FIGHT_TYPE_ANNIVERSARY_TRIAL?o.reportData.fightType=m.FIGHT_TYPE.FIGHT_TYPE_ANNIVERSARY_TRIAL:o.reportData.fightType=m.FIGHT_TYPE.FIGHT_TYPE_BATTLE:s.default.getCombatType()==s.CombatType.COOP?s.default.matchType==m.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE?o.reportData.fightType=m.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE:s.default.matchType==m.FIGHT_TYPE.FIGHT_TYPE_WEEK_COOPERATION?o.reportData.fightType=m.FIGHT_TYPE.FIGHT_TYPE_WEEK_COOPERATION:s.default.matchType==m.FIGHT_TYPE.FIGHT_TYPE_FOG_HIDDEN?o.reportData.fightType=m.FIGHT_TYPE.FIGHT_TYPE_FOG_HIDDEN:s.default.matchType==m.FIGHT_TYPE.FIGHT_TYPE_MACHINARIUM?o.reportData.fightType=m.FIGHT_TYPE.FIGHT_TYPE_MACHINARIUM:o.reportData.fightType=m.FIGHT_TYPE.FIGHT_TYPE_COOPERATION:s.default.getCombatType()==s.CombatType.DUEL&&(o.reportData.fightType=m.FIGHT_TYPE.FIGHT_TYPE_DUEL_BATTLE),o.reportData.fightModule=s.default.matchModule;var _=new b.T_Fight_Role_Detail_Info;_.roleID=c.default.UUID,_.round=r.getInstance().batchModel.getIndexTip(),_.roleAbstract=f,_.maxSp=i.combatStatistic.maxSlivers,_.heros=i.combatStatistic.heros,_.cumulativeSp=i.combatStatistic.slivers,(E=i.carInfo.boxSliveNum.value)>0&&(_.cumulativeSp+=E),_.typeMonster=i.combatStatistic.mosters,o.reportData.fightRoleInfo.set(c.default.UUID,_);var y=new b.T_Fight_Role_Detail_Info;y.roleID=g.roleID,y.round=r.getInstance().batchModel.getIndexTip(),y.roleAbstract=g,y.maxSp=n.combatStatistic.maxSlivers,y.cumulativeSp=n.combatStatistic.slivers,y.heros=n.combatStatistic.heros,y.typeMonster=n.combatStatistic.mosters,o.reportData.fightRoleInfo.set(g.roleID,y);var v,C=r.getInstance().getSelfCar();v=r.getInstance().isCoop()?r.getInstance().getCoopCarByCamp(C.camp):r.getInstance().getCarByCamp(w.PLAYER_CAMP.opponents),console.log("P_Fight_Help_Scene_SYNC start5");var T=new I.T_Reconnect_Player_Info_Struct;T.sp=Number(i.getCurMoney());var E=i.carInfo.boxSliveNum.value;for(var P in E>0&&(T.sp+=E),T.spRand=Number(i.getCarRefreshCount()),T.cardIdVec=i.getCardIdVec(),T.hp=C.hp,T.maxHp=C.maxHp,T.carLevel=i.carInfo.level,T.roleIdentity=s.default.matchRoleIdentity,C.summonList)T.carSummonIndex=Number(1e4*C.summonList[P].nBatchIndex+C.summonList[P].index),Number(C.summonList[P].lastTime<0)?(T.combosNum=C.summonList[P].lastTime,T.killValue=Number(C.summonList[P].delayLoadTime)):(T.combosNum=0,T.killValue=Number(C.summonList[P].lastTime-C.summonList[P].cd));for(var R in i.carInfo.tbHeroSummonedNum)T.heroSummonedIdVec.push(i.carInfo.tbHeroSummonedNum[R]);console.log("P_Fight_Help_Scene_SYNC start6");var L=C.getHeroList();for(var D in L){var M=L[D];if(M){var B=new I.T_Reconnect_Hero_Info_Struct;for(var R in B.heroID=Number(M.heroTemplateId),B.heroPos=Number(D),B.starLevel=i.carInfo.tbHeroList[B.heroID].starLevel,B.level=M.level,M.attr)B.attr[R]=M.attr[R];if(B.attr[0]=0,B.attr.push(M.summonMonsterCount),B.attr.push(M.getCastSkillCount()),M.pSkillObjList)for(var k in M.pSkillObjList)M.pSkillObjList[k]&&((q=new h.T_Reconnect_skill_Struct).skillID=M.pSkillObjList[k].templateId,q.cdtime=M.pSkillObjList[k].deltaTime,M.pSkillObjList[k].randomSeed&&M.pSkillObjList[k].randomSeed.RandomSeed(M.getCastSkillCount()),B.skillVector.push(q));if(M.buffList)for(var R in M.buffList)M.buffList[R]&&((Q=new h.T_Reconnect_Buff_Struct).buffID=M.buffList[R].templateId,Q.lifetime=M.buffList[R]._LastTime,Q.continueIntervalTime=M.buffList[R]._continueIntervalTime,l(Q,M.buffList[R].ReleaseTarget),B.buffVector.push(Q));57==B.heroID&&(r.getInstance().isCoop()?(u(w.PLAYER_CAMP.opponents,B.heroID),r.getInstance().isSkyCastle()&&u(w.PLAYER_CAMP.opponentsCoop,B.heroID)):n.setChangeSpritRS(M.getCastSkillCount())),T.heroVector.push(B)}}var G=new I.T_Reconnect_Equip_Info_Struct,O=s.default.getDropEquipList(),H=O[C.camp]?O[C.camp]:[],V=0;for(var k in H)V=H[k].equipStar>V?H[k].equipStar:V;for(var R in i.carInfo.tbEquipInfo)G.equipID=Number(R),G.starLevel=V,G.equipPos=i.carInfo.tbEquipInfo[R];Object.keys(i.carInfo.tbEquipInfo).length>0&&T.equipVector.push(G),r.getInstance().isSkyCastle()&&i.randomSeed.RandomSeed(N.getRoleIdentity(i.camp)),console.log("P_Fight_Help_Scene_SYNC start7"),o.playerInfo.push(T);var F=function(e,t){if(e){var a=new I.T_Reconnect_Player_Info_Struct;for(var n in a.sp=Number(t.getCurMoney()),a.spRand=Number(t.getCarRefreshCount()),a.cardIdVec=t.getCardIdVec(),a.hp=e.hp,a.maxHp=e.maxHp,a.carLevel=t.carInfo.level,a.roleIdentity=s.default.matchRoleIdentity==w.PLAYER_IDENTITY.home?w.PLAYER_IDENTITY.away:w.PLAYER_IDENTITY.home,e.summonList)a.carSummonIndex=Number(1e4*e.summonList[n].nBatchIndex+e.summonList[n].index),Number(e.summonList[n].lastTime<0)?(a.combosNum=e.summonList[n].lastTime,a.killValue=Number(e.summonList[n].delayLoadTime)):(a.combosNum=0,a.killValue=Number(e.summonList[n].lastTime-e.summonList[n].cd));for(var c in t.carInfo.tbHeroSummonedNum)a.heroSummonedIdVec.push(t.carInfo.tbHeroSummonedNum[c]);console.log("P_Fight_Help_Scene_SYNC start8");var d=e.getHeroList();for(var f in d){var g=d[f];if(g){var _=new I.T_Reconnect_Hero_Info_Struct;for(var c in _.heroID=Number(g.heroTemplateId),_.heroPos=Number(f),_.starLevel=t.carInfo.tbHeroList[_.heroID].starLevel,_.level=g.level,g.attr)_.attr[c]=g.attr[c];if(_.attr[0]=0,_.attr.push(g.summonMonsterCount),_.attr.push(g.getCastSkillCount()),g.pSkillObjList)for(var y in g.pSkillObjList)if(g.pSkillObjList[y]){var v=new h.T_Reconnect_skill_Struct;v.skillID=g.pSkillObjList[y].templateId,v.cdtime=g.pSkillObjList[y].deltaTime,g.pSkillObjList[y].randomSeed&&g.pSkillObjList[y].randomSeed.RandomSeed(g.getCastSkillCount()),_.skillVector.push(v)}if(g.buffList)for(var c in g.buffList)if(g.buffList[c]){var S=new h.T_Reconnect_Buff_Struct;S.buffID=g.buffList[c].templateId,S.lifetime=g.buffList[c]._LastTime,S.continueIntervalTime=g.buffList[c]._continueIntervalTime,l(S,g.buffList[c].ReleaseTarget),_.buffVector.push(S)}57==_.heroID&&(r.getInstance().isCoop()?e.camp==w.PLAYER_CAMP.opponentsCoop||e.camp==w.PLAYER_CAMP.opponents?(p(w.PLAYER_CAMP.coopPlayer,_.heroID),p(w.PLAYER_CAMP.myPlayer,_.heroID)):e.camp==w.PLAYER_CAMP.coopPlayer&&(u(w.PLAYER_CAMP.opponents,_.heroID),u(w.PLAYER_CAMP.opponentsCoop,_.heroID)):i.setChangeSpritRS(g.getCastSkillCount())),a.heroVector.push(_)}}var T=e.camp;r.getInstance().isCoop()&&(T=!r.getInstance().isSkyCastle()||T!=w.PLAYER_CAMP.opponents&&T!=w.PLAYER_CAMP.opponentsCoop?C.camp:w.PLAYER_CAMP.opponents);var b=r.getInstance().getPlayerModelByCamp(T),E=new I.T_Reconnect_Equip_Info_Struct,P=s.default.getDropEquipList(),R=P[T]?P[T]:[],L=0;for(var y in R)L=R[y].equipStar>L?R[y].equipStar:L;for(var c in b.carInfo.tbEquipInfo)E.equipID=Number(c),E.starLevel=L,E.equipPos=b.carInfo.tbEquipInfo[c];Object.keys(b.carInfo.tbEquipInfo).length>0&&a.equipVector.push(E),!r.getInstance().isCoop()||t.camp!=w.PLAYER_CAMP.opponents&&t.camp!=w.PLAYER_CAMP.opponentsCoop||(a.roleIdentity=t.camp==w.PLAYER_CAMP.opponents?w.PLAYER_CAMP.opponents+1:w.PLAYER_CAMP.opponentsCoop,s.default.matchType==m.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE&&e.bAI&&e.pAI&&(a.aiInfo.delta=e.pAI.delta,a.aiInfo.index=e.pAI.index,a.aiInfo.nRefreshTime=e.pAI.nRefreshTime,a.aiInfo.usedheroList=e.pAI.usedheroList,a.aiInfo.autoManaged=e.pAI.autoManaged,a.aiInfo.delayAction=e.pAI.delayAction)),r.getInstance().isSkyCastle()&&t.randomSeed.RandomSeed(N.getRoleIdentity(t.camp)),o.playerInfo.push(a)}};if(F(v,n),r.getInstance().isCoop()){var U=r.getInstance().getPlayerModelByCamp(w.PLAYER_CAMP.opponents),x=r.getInstance().getCarByCamp(w.PLAYER_CAMP.opponents);if(x&&F(x,U),s.default.matchType==m.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE){var Y=r.getInstance().getPlayerModelByCamp(w.PLAYER_CAMP.opponentsCoop);F(r.getInstance().getCarByCamp(w.PLAYER_CAMP.opponentsCoop),Y)}}console.log("P_Fight_Help_Scene_SYNC start10");var j=r.getInstance().getNpcList();for(var W in j){var z=j[W];if(z&&z.node&&cc.isValid(z.node)){var K=new I.T_Reconnect_Monster_Info_Struct;if(K.id=z.templateId,K.gid=Number(W),K.speed=z.level,K.distanceX=Math.floor(z.getPos().x),K.distanceY=Math.floor(z.getPos().y),K.blood.curBlood=z.hp,K.blood.maxBlood=z.maxHp,K.blood.type=z.npcType,z.npcType==w.NPC_TYPE.Car&&(K.sp=z.model.templateId),z.pSkillObjList)for(var k in z.pSkillObjList){var q;z.pSkillObjList[k]&&((q=new h.T_Reconnect_skill_Struct).skillID=z.pSkillObjList[k].templateId,q.cdtime=z.pSkillObjList[k].deltaTime,z.pSkillObjList[k].randomSeed&&z.pSkillObjList[k].randomSeed.RandomSeed(z.getCastSkillCount()),K.skillVector.push(q),z.state!=w.NPC_STATE.Attack||z.pSkillObjList[k].bDoSkill||(K.physicalReduce=1))}if(z.buffList)for(var R in z.buffList){var Q;z.buffList[R]&&((Q=new h.T_Reconnect_Buff_Struct).buffID=z.buffList[R].templateId,Q.lifetime=z.buffList[R]._LastTime,Q.continueIntervalTime=z.buffList[R]._continueIntervalTime,l(Q,z.buffList[R].ReleaseTarget),K.buffVector.push(Q))}for(var R in r.getInstance().isCoop()?z.camp==w.PLAYER_CAMP.myPlayer||z.camp==w.PLAYER_CAMP.coopPlayer?(K.roleIdentity=s.default.matchRoleIdentity,K.roleID=c.default.UUID):K.roleID=S.fromNumber(2):r.getInstance().isPvP()&&(z.camp==w.PLAYER_CAMP.myPlayer?(K.roleIdentity=s.default.matchRoleIdentity,K.roleID=c.default.UUID):(K.roleIdentity=s.default.matchRoleIdentity==w.PLAYER_IDENTITY.away?w.PLAYER_IDENTITY.home:w.PLAYER_IDENTITY.away,g=s.default.getMatchBattleInfo(!1),K.roleID=g.roleID)),z.attr)K.attr[R]=z.attr[R];for(var R in K.attr[0]=0,K.attr.push(z.getCastSkillCount()),K.attr.push(z.getWhosyourdaddyState()),K.attr.push(z.summonedSustainTime),K.attr.push(z.getNextSkillIndex()),K.attr.push(z.bTheSummonerIdentity),K.attr.push(z.theSummonerId),K.attr.push(z.bTheSummonerIsHero?1:0),console.log("s helpscene curblood"+z.hp+"npcObj.maxHp:"+z.maxHp+"npcid "+Number(W)),console.log("P_Fight_Help_Scene_SYNC start11"),z.behitCount)z.behitCount[R]&&K.behitCount.set(Number(R),z.behitCount[R]);if(10044==z.resId&&r.getInstance().isCoop()){var X=r.getInstance().getPlayerModelByCamp(w.PLAYER_CAMP.myPlayer),J=r.getInstance().getPlayerModelByCamp(w.PLAYER_CAMP.coopPlayer);X&&X.setBossChangeSpritRS(z.getCastSkillCount()),J&&J.setBossChangeSpritRS(z.getCastSkillCount())}z.setCritSeedRandom(z.getCastSkillCount()),z.setDodgeSeedRandom(z.getCastSkillCount()),o.monsters.push(K)}}(Z=[]).push("P_Fight_Help_Scene_SYNC player:"+c.default.UUID+"success!"),A.GamePlatform.reportWXLog(Z),d.FightNetwork.getInstance().Send(h.FIGHT_CLIENT_ENUM.P_Fight_Scene_SYNC,o)}else console.log("P_Fight_Help_Scene_SYNC errorcode");else console.log("P_Role_Fight_Reconnect error")}catch($){var Z;(Z=[]).push("P_Fight_Help_Scene_SYNC player:"+c.default.UUID+" error:"+$),A.GamePlatform.reportWXLog(Z)}},this),l.ClientNetwork.getInstance().listenProtocol(h.FIGHT_CLIENT_ENUM.P_Fight_Scene_SYNC,function(e){console.log("P_Fight_Scene_SYNC start"),e.resetPos();var t=new I.S_Fight_Scene_SYNC;t.read(e)&&(t.roleID.equals(c.default.UUID)||(console.log("P_Fight_Scene_SYNC start2"),console.log("P_Fight_Scene_SYNC start3"),r.getInstance().gameState=w.Game_State.Reconnect,s.default.matchReconnectData=t,l.ClientNetwork.getInstance().pushLocalMessage(u.LOCAL_MESSAGE.LocalMsg_MatchReconnectSuccess)))}.bind(this),this),l.ClientNetwork.getInstance().listenProtocol(g.ROLE_CLIENT_ENUM.P_Role_Call_Php,function(e){e.resetPos();var t=new g.S_Role_Call_Php;t.read(e)&&1==t.type&&l.ClientNetwork.getInstance().pushLocalMessage(u.LOCAL_MESSAGE.LocalMsg_ServerCheckTableMd5,t.result)}.bind(this),this),l.ClientNetwork.getInstance().listenProtocol(h.FIGHT_CLIENT_ENUM.P_Fight_Report_Phase_Result_To_Logic,function(){s.default.matchType==m.FIGHT_TYPE.FIGHT_TYPE_BATTLE_GREAT_SAILING&&r.getInstance().getController().sailingSendPhaseNum>0&&(r.getInstance().getController().sailingSendPhaseNum--,console.log("phasereportnum recv = "+r.getInstance().getController().sailingSendPhaseNum))}.bind(this),this),d.FightNetwork.getInstance().listenExtraMsg(d.FIGHTSERVER_EXTRA_MSG.EXTRA_MSG_FIGHTSEVER_CONNCET_SUCCEED,function(){console.log("HHHHHHHHHHHHHHHHHHH fightserver open");var e=new h.C_Fight_Role_Login,t=s.default.getMatchBattleInfo(!1),o=s.default.getMatchBattleInfo(!0);e.roleID=c.default.UUID,e.matchRoles.set(e.roleID,o),e.matchRoles.set(t.roleID,t),e.fightToken=s.default.matchToken,e.fightPattern=s.default.matchPattern,s.default.getCombatType()==s.CombatType.SOLO?s.default.matchType==m.FIGHT_TYPE.FIGHT_TYPE_BATTLE_GOLDENLEAGUE?e.fightType=m.FIGHT_TYPE.FIGHT_TYPE_BATTLE_GOLDENLEAGUE:s.default.matchType==m.FIGHT_TYPE.FIGHT_TYPE_BATTLE_EAT_CHICKEN?e.fightType=m.FIGHT_TYPE.FIGHT_TYPE_BATTLE_EAT_CHICKEN:s.default.matchType==m.FIGHT_TYPE.FIGHT_TYPE_BATTLE_SOCIATY_WAR?e.fightType=m.FIGHT_TYPE.FIGHT_TYPE_BATTLE_SOCIATY_WAR:s.default.matchType==m.FIGHT_TYPE.FIGHT_TYPE_ANNIVERSARY_TRIAL?e.fightType=m.FIGHT_TYPE.FIGHT_TYPE_ANNIVERSARY_TRIAL:e.fightType=m.FIGHT_TYPE.FIGHT_TYPE_BATTLE:s.default.getCombatType()==s.CombatType.COOP?s.default.matchType==m.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE?e.fightType=m.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE:s.default.matchType==m.FIGHT_TYPE.FIGHT_TYPE_WEEK_COOPERATION?e.fightType=m.FIGHT_TYPE.FIGHT_TYPE_WEEK_COOPERATION:s.default.matchType==m.FIGHT_TYPE.FIGHT_TYPE_FOG_HIDDEN?e.fightType=m.FIGHT_TYPE.FIGHT_TYPE_FOG_HIDDEN:s.default.matchType==m.FIGHT_TYPE.FIGHT_TYPE_MACHINARIUM?e.fightType=m.FIGHT_TYPE.FIGHT_TYPE_MACHINARIUM:e.fightType=m.FIGHT_TYPE.FIGHT_TYPE_COOPERATION:s.default.getCombatType()==s.CombatType.DUEL&&(e.fightType=m.FIGHT_TYPE.FIGHT_TYPE_DUEL_BATTLE),d.FightNetwork.getInstance().Send(h.FIGHT_CLIENT_ENUM.P_Fight_Role_Login,e)}.bind(this),this),d.FightNetwork.getInstance().listenProtocol(h.FIGHT_CLIENT_ENUM.P_Fight_Role_Login,function(e){if(!F.default.fightReconnectShowing){console.log("HHHHHHHHHHHHHHHHHHH fightserver P_Fight_Role_Logintime"+y.TimeOffSetManager.getMilisecond()),e.resetPos();var t=new h.S_Fight_Role_Login;if(t.read(e)){var o=t.errorcode;d.FightNetwork.getInstance().setKey(t.key),0==o&&(s.default.matchType==m.FIGHT_TYPE.FIGHT_TYPE_BATTLE||s.default.matchType==m.FIGHT_TYPE.FIGHT_TYPE_DUEL_BATTLE||s.default.matchType==m.FIGHT_TYPE.FIGHT_TYPE_BATTLE_GOLDENLEAGUE||s.default.matchType==m.FIGHT_TYPE.FIGHT_TYPE_BATTLE_SOCIATY_WAR||s.default.matchType==m.FIGHT_TYPE.FIGHT_TYPE_BATTLE_EAT_CHICKEN||s.default.matchType==m.FIGHT_TYPE.FIGHT_TYPE_ANNIVERSARY_TRIAL?k.ResourceLoaderLayer.setType(v.ResourceType.fight_pvp_from_main):s.default.matchType!=m.FIGHT_TYPE.FIGHT_TYPE_COOPERATION&&s.default.matchType!=m.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE&&s.default.matchType!=m.FIGHT_TYPE.FIGHT_TYPE_WEEK_COOPERATION&&s.default.matchType!=m.FIGHT_TYPE.FIGHT_TYPE_FOG_HIDDEN&&s.default.matchType!=m.FIGHT_TYPE.FIGHT_TYPE_MACHINARIUM||k.ResourceLoaderLayer.setType(v.ResourceType.fight_pve_from_main),l.ClientNetwork.getInstance().pushLocalMessage(u.LOCAL_MESSAGE.LocalMsg_LoginFightServerSuccess),G.default.setCallBack(null,function(){var e=d.FightNetwork.getInstance().getWebSocket();if(e)if(e.readyState!=WebSocket.OPEN){var t=P.default.getViewByName("MainSceneView");t&&t.view&&(t.view.onCheckFightResult(),G.default.hide())}else c.default.setFightReconnectData(null),C.G.UIManager.LoadScene(v.SceneName.PveFightScene,v.SceneTag.PveFightScene)}),G.default.show(),this.cancelEnterBattleTimeOut())}}}.bind(this),this),d.FightNetwork.getInstance().listenProtocol(h.FIGHT_CLIENT_ENUM.P_Fight_FightStart,function(e){if(console.log("HHHHHHHHHHHHHHHHHHH fightserver P_Fight_FightStart"),e.resetPos(),(new h.S_Fight_FightStart).read(e))if(r.getInstance().gameState==w.Game_State.Reconnect){var t=new I.C_Fight_Monster_Blood_SYNC;d.FightNetwork.getInstance().Send(h.FIGHT_CLIENT_ENUM.P_Fight_Monster_Blood_SYNC,t)}else{r.getInstance().beginGame();var o=r.getInstance().getSelfCombatModel();o&&o.sendBeginSilverToServer()}}.bind(this),this),d.FightNetwork.getInstance().listenProtocol(h.FIGHT_CLIENT_ENUM.P_Fight_Update_Car_SYNC,function(e){if(console.log("HHHHHHHHHHHHHHHHHHH fightserver P_Fight_Update_Car_SYNC"),r.getInstance().gameState==w.Game_State.Fighting){e.resetPos();var t=new h.S_Fight_Update_Car_SYNC;if(t.read(e)){var o=null;if(t.roleID.equals(c.default.UUID)||(r.getInstance().isCoop()?o=r.getInstance().getCoopPlayerByCamp(t.updateCar.camp):r.getInstance().isPvP()&&(o=r.getInstance().getPlayerModelByCamp(w.PLAYER_CAMP.opponents))),o&&o.carInfo.level<t.updateCar.level){o.bIsSyncCarLvUp=!0;var i=o.reqCarLevelUp(!0);console.log("HHHHHHHHHHHHHHHHHHH fightserver P_Fight_Update_Car_SYNC ret: "+i)}}}else this.saveReconnectMsg(h.FIGHT_CLIENT_ENUM.P_Fight_Update_Car_SYNC,e)}.bind(this),this),d.FightNetwork.getInstance().listenProtocol(h.FIGHT_CLIENT_ENUM.P_Fight_Update_Hero_SYNC,function(e){if(console.log("HHHHHHHHHHHHHHHHHHH fightserver P_Fight_Update_Hero_SYNC"),r.getInstance().gameState==w.Game_State.Fighting){e.resetPos();var t=new h.S_Fight_Update_Hero_SYNC;if(t.read(e)&&!t.roleID.equals(c.default.UUID)){var o=null;if(r.getInstance().isCoop()?o=r.getInstance().getCoopPlayerByCamp(t.updateHero.camp):r.getInstance().isPvP()&&(o=r.getInstance().getPlayerModelByCamp(w.PLAYER_CAMP.opponents)),o){var i=o.reqHeroLevelUp(t.updateHero.heroTemplateId,!0,t.updateHero.pos,t.updateHero.heroNpcId);console.log("HHHHHHHHHHHHHHHHHHH fightserver P_Fight_Update_Hero_SYNC ret: "+i)}}}else this.saveReconnectMsg(h.FIGHT_CLIENT_ENUM.P_Fight_Update_Hero_SYNC,e)}.bind(this),this),d.FightNetwork.getInstance().listenProtocol(h.FIGHT_CLIENT_ENUM.P_Fight_Sell_Hero_SYNC,function(e){if(console.log("HHHHHHHHHHHHHHHHHHH fightserver P_Fight_Sell_Hero_SYNC"),r.getInstance().gameState==w.Game_State.Fighting){e.resetPos();var t=new h.S_Fight_Sell_Hero_SYNC;if(t.read(e)){var o=w.PLAYER_CAMP.myPlayer;if(!t.roleID.equals(c.default.UUID)){var i=null;if(r.getInstance().isCoop()?i=r.getInstance().getCoopPlayerByCamp(t.sellHero.camp):r.getInstance().isPvP()&&(i=r.getInstance().getPlayerModelByCamp(w.PLAYER_CAMP.opponents)),i){var a=i.reqSellHero(t.sellHero.heroTemplateId,!0);o=i.camp,console.log("HHHHHHHHHHHHHHHHHHH fightserver P_Fight_Sell_Hero_SYNC ret: "+a)}}cc.director.emit("Event_SellHero",o,t.sellHero.heroTemplateId)}}else this.saveReconnectMsg(h.FIGHT_CLIENT_ENUM.P_Fight_Sell_Hero_SYNC,e)}.bind(this),this),d.FightNetwork.getInstance().listenProtocol(h.FIGHT_CLIENT_ENUM.P_Fight_Refresh_Card_Count_SYNC,function(e){if(console.log("HHHHHHHHHHHHHHHHHHH fightserver P_Fight_Refresh_Card_Count_SYNC"),r.getInstance().gameState==w.Game_State.Fighting){e.resetPos();var t=new I.S_Fight_Refresh_Card_Count_SYNC;if(t.read(e)&&!t.roleID.equals(c.default.UUID)){var o=null;r.getInstance().isCoop()?o=r.getInstance().getPlayerModelByCamp(w.PLAYER_CAMP.coopPlayer):r.getInstance().isPvP()&&(o=r.getInstance().getPlayerModelByCamp(w.PLAYER_CAMP.opponents)),o&&(o.setCarRefreshCount(t.refreshNum+1),o.combatStatistic.refreshTimes=t.refreshNum,o.setCardIdVec(t.cardIdVec))}}else this.saveReconnectMsg(h.FIGHT_CLIENT_ENUM.P_Fight_Refresh_Card_Count_SYNC,e)}.bind(this),this),d.FightNetwork.getInstance().listenProtocol(h.FIGHT_CLIENT_ENUM.P_Fight_Skill_SYNC,function(e){if(console.log("HHHHHHHHHHHHHHHHHHH fightserver P_Fight_Refresh_Card_Count_SYNC"),r.getInstance().gameState==w.Game_State.Fighting){e.resetPos();var t=new I.S_Fight_Skill_SYNC;if(t.read(e)&&!t.roleID.equals(c.default.UUID)){var o=null;if(r.getInstance().isSkyCastle()){var i=s.default.getMatchBattleInfo(!1);o=t.roleID.equals(i.roleID)?r.getInstance().getPlayerModelByCamp(w.PLAYER_CAMP.coopPlayer):r.getInstance().getPlayerModelByCamp(w.PLAYER_CAMP.opponents)}else r.getInstance().isCoop()?o=r.getInstance().getPlayerModelByCamp(w.PLAYER_CAMP.coopPlayer):r.getInstance().isPvP()&&(o=r.getInstance().getPlayerModelByCamp(w.PLAYER_CAMP.opponents));o&&o.onHandleSkillSync(t)}}else this.saveReconnectMsg(h.FIGHT_CLIENT_ENUM.P_Fight_Skill_SYNC,e)}.bind(this),this),d.FightNetwork.getInstance().listenProtocol(h.FIGHT_CLIENT_ENUM.P_Fight_FightEnd,function(e){console.log("HHHHHHHHHHHHHHHHHHH fightserver P_Fight_FightEnd"),e.resetPos();var t=new I.S_Fight_FightEnd,o=!1;if(t.read(e)){if(t.winRoleID.equals(c.default.UUID))1==t.reason&&C.G.StringManager.PopStringOnce(C.G.StringManager.getString("BATTLE_OTHER_PLAYER_GIVE_UP")),o=!0;else{if(r.getInstance().isSkyCastle()){var i=s.default.getMatchBattleInfo(!1);t.winRoleID.equals(i.roleID)&&(o=!0)}r.getInstance().isFogHidden()&&(i=s.default.getMatchBattleInfo(!1),t.winRoleID.equals(i.roleID)&&(o=!0))}r.getInstance().onGameEnd(o)}}.bind(this),this),d.FightNetwork.getInstance().listenProtocol(h.FIGHT_CLIENT_ENUM.P_Fight_Replace,function(e){console.log("HHHHHHHHHHHHHHHHHHH fightserver P_Fight_Replace"),e.resetPos();var t=new I.S_Fight_Replace;t.read(e)&&(t.roleID.equals(c.default.UUID)||(s.default.opponentsReplaced=t.replaced,console.log("HHHHHHHHHHHHHHHHHHH fightserver P_Fight_Replace opponentsReplaced")))}.bind(this),this),l.ClientNetwork.getInstance().listenProtocol(g.ROLE_CLIENT_ENUM.P_Role_SynMailData,function(e){e.resetPos();var t=new g.S_Role_SynMailData;if(t.read(e)){if(t.deleteMail.length>0){var o=c.default.getRoleMailData();t.deleteMail.forEach(function(e){o.forEach(function(t,i){1==t.mailUUID.equals(e)&&o.delete(i)})});var i=P.default.getViewByName("MailView");t.deleteMail.forEach(function(e){i&&i.view&&i.view.refreshMailListView(e)})}var a=c.default.getRoleMailData();t.changeMail.length>0&&t.changeMail.forEach(function(e){a.set(e.mailUUID,e)});var n=P.default.getViewByName("MainSceneView");n&&n.view&&n.view.onShowMailRedPointNode()}},this),l.ClientNetwork.getInstance().listenProtocol(g.ROLE_CLIENT_ENUM.P_Role_SynHistoryWorldChat,function(e){e.resetPos();var t=new g.S_Role_SynHistoryWorldChat;t.read(e)&&c.default.setHistoryWorldChats(t)},this),l.ClientNetwork.getInstance().listenProtocol(R.CHAT_CLIENT_ENUM.P_Chat_SynPrivateChatSimData,function(e){e.resetPos();var t=new R.S_Chat_SynPrivateChatSimData;t.read(e)&&c.default.setSynPrivateChatSimData(t)},this),l.ClientNetwork.getInstance().listenProtocol(g.ROLE_CLIENT_ENUM.P_Role_GetPVPDoubleReward,function(e){e.resetPos();var t=new g.S_Role_GetPVPDoubleReward;t.read(e)&&0===t.errorcode&&P.default.addPopView("BaseCtrl","AcquirePopupView","AcquirePopupView",{items:t.prize})},this),l.ClientNetwork.getInstance().listenProtocol(g.ROLE_CLIENT_ENUM.P_Role_SynShareData,function(e){e.resetPos();var t=new g.S_Role_SynShareData;if(t.read(e)&&t.shareData.players.size>0){c.default.setShareData(t.shareData);var o=P.default.getViewByName("MainSceneView");o&&o.view&&o.view.onInviteFriendRedPoint();var i=P.default.getViewByName("InviteFriendView");i&&i.view&&i.view.onRefreshInviteInfo()}},this),l.ClientNetwork.getInstance().listenProtocol(g.ROLE_CLIENT_ENUM.P_Role_TotalWatchADBoxData,function(e){e.resetPos();var t=new g.S_Role_TotalWatchADBoxData;if(t.read(e)&&t.totalwatchadbox){c.default.setWatchadboxData(t.totalwatchadbox);var o=P.default.getViewByName("MainSceneView");o&&o.view&&o.view.onAdvertisingGiftsRedPoint()}},this),l.ClientNetwork.getInstance().listenProtocol(g.ROLE_CLIENT_ENUM.P_Role_GetRoleSimpleInfo,function(e){e.resetPos();var t=new g.S_Role_GetRoleSimpleInfo;t.read(e)&&(0===t.errorcode?P.default.addPopView("BaseCtrl","PlayerInfoView","PlayerInfoView",{data:t.roleAbstract,proficiencyData:t.roleProficiency.proficiencyInfoMap}):C.G.StringManager.PopString(M.StringValueTableData.getById(19).string_value))},this),l.ClientNetwork.getInstance().listenProtocol(g.ROLE_CLIENT_ENUM.P_Role_WatchADCostGold,function(e){e.resetPos();var t=new g.S_Role_WatchADCostGold;t.read(e)&&(0===t.errorcode||C.G.StringManager.PopString("\u83b7\u53d6\u5956\u52b1\u5931\u8d25 "+t.errorcode))},this),l.ClientNetwork.getInstance().listenProtocol(g.ROLE_CLIENT_ENUM.P_Role_SynSeasonData,function(e){e.resetPos();var t=new g.S_Role_SynSeasonData;if(t.read(e)&&t.seasonData&&(c.default.setSeasonData(t.seasonData),t.legendData)){c.default.setLegendData(t.legendData);var o=P.default.getViewByName("MainSceneView");if(o&&o.view){var i=o.view._playerCup;i&&(i.string=c.default.getRoleAttrValByKey(m.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE)),o.view.onRefreshLegendRedPoint()}}},this),l.ClientNetwork.getInstance().listenProtocol(g.ROLE_CLIENT_ENUM.P_Role_SyncDrawPrize,function(e){e.resetPos();var t=new g.S_Role_SyncDrawPrize;if(t.read(e)){c.default.setDrawPrizeData(t.detail);var o=P.default.getViewByName("DrawCardMainView");o&&o.view&&o.view.initRecruitProgress();var i=P.default.getViewByName("MainSceneView");i&&i.view&&i.view.onDrawBoxRewardRedpoint()}},this),d.FightNetwork.getInstance().listenProtocol(h.FIGHT_CLIENT_ENUM.P_Fight_Expression,function(e){e.resetPos();var t=new h.S_Fight_Expression;if(t.read(e)){if(0!=t.errorcode&&1==c.default.UUID.equals(t.roleID))return C.G.StringManager.PopString(C.G.StringManager.getString("SEND_MESSAGE_FAIL"));if(0==t.errorcode){var o=r.getInstance().getController().fightCardViewScript;if(o){var i=!1;1==c.default.UUID.equals(t.roleID)&&(i=!0),0===t.type?o.onShowEmoji(t.contentId,i):1!==t.type&&2!==t.type||o.onAddTeamChatMsg(t,i)}}}}.bind(this),this),l.ClientNetwork.getInstance().listenProtocol(O.ACTIVITY_CLIENT_ENUM.P_Activity_SynAllActivityData,function(e){e.resetPos();var t=new O.S_Activity_SynAllActivityData;t.read(e)&&c.default.setActivityData(t.activityData)},this),l.ClientNetwork.getInstance().listenProtocol(O.ACTIVITY_CLIENT_ENUM.P_Activity_SynActivityData,function(e){e.resetPos();var t=new O.S_Activity_SynActivityData;t.read(e)&&c.default.setActivityDataSingle(t.data)},this),l.ClientNetwork.getInstance().listenProtocol(O.ACTIVITY_CLIENT_ENUM.P_Activity_CloseActivity,function(e){e.resetPos();var t=new O.S_Activity_CloseActivity;t.read(e)&&c.default.setActivityClose(t.activityID)},this),l.ClientNetwork.getInstance().listenProtocol(g.ROLE_CLIENT_ENUM.P_Role_WeiXinAnalyzingMessage,function(e){e.resetPos();var t=new g.S_Role_WeiXinAnalyzingMessage;if(t.read(e))if(0==t.errorcode){var o=JSON.parse(t.info);if(o.liveInfoList){N.setLocalData("GameLiveFeedId","");for(var i=0,a=0,n=0;n<o.liveInfoList.length;n++)i=o.liveInfoList[n].totalCheerCount,a=o.liveInfoList[n].totalAudienceCount;var r=[];(h=Array.from(c.default.getRoleTaskData().tasks.values())).forEach(function(e){V.TaskTableData.getById(e.taskID).type==m.TASK_TYPE.TASK_TYPE_COUNT_CLIENT&&r.push(e)});var s=[],d=[];for(r.forEach(function(e){var t=V.TaskTableData.getById(e.taskID);14!=t.clientType&&15!=t.clientType||s.push({taskId:t.id,taskCount:e.taskCount})}),s.forEach(function(e){var t=V.TaskTableData.getById(e.taskId);14==t.clientType&&(e.taskCount=e.taskCount+i),15==t.clientType&&(e.taskCount=e.taskCount+a)}),s.forEach(function(e){d.push(e)}),n=0;n<d.length;n++){var u=new g.C_Role_ClientTaskUpdateCount;u.taskID=d[n].taskId,u.count=d[n].taskCount,l.ClientNetwork.getInstance().Send(g.ROLE_CLIENT_ENUM.P_Role_ClientTaskUpdateCount,u,!1)}}else if(o.dataList){var h=Array.from(c.default.getRoleTaskData().tasks.values()),p=function(e){console.log("value================================",o.dataList[e].value,"-----",o.dataList[e].dataType.type,"index===",e),h.forEach(function(t){var i=V.TaskTableData.getById(t.taskID);if(56==i.clientType&&i.showType==o.dataList[e].dataType.type){var a=t.taskCount;t.taskCount!=o.dataList[e].value&&((n=new g.C_Role_ClientTaskAddCount).taskID=t.taskID,n.count=o.dataList[e].value-a,l.ClientNetwork.getInstance().Send(g.ROLE_CLIENT_ENUM.P_Role_ClientTaskAddCount,n))}else if(60==i.clientType&&i.showType==o.dataList[e].dataType.type){var n;a=t.taskCount,(n=new g.C_Role_ClientTaskAddCount).taskID=t.taskID,n.count=o.dataList[e].value-a,l.ClientNetwork.getInstance().Send(g.ROLE_CLIENT_ENUM.P_Role_ClientTaskAddCount,n)}})};for(n=0;n<o.dataList.length;n++)p(n)}}else C.G.StringManager.PopString("\u89e3\u6790\u6570\u636e\u5931\u8d25"+t.errorcode),wx.showModal({title:"\u63d0\u793a",content:"\u89e3\u6790\u5fae\u4fe1\u6570\u636e\u5931\u8d25\uff0c\u9519\u8bef\u7801 "+t.errorcode})},this),d.FightNetwork.getInstance().listenProtocol(h.FIGHT_CLIENT_ENUM.P_Fight_Operate_Equip_SYNC,function(t){t.resetPos();var o=new h.S_Fight_Operate_Equip_SYNC;if(o.read(t))if(o.operateType==h.OPERATE_TYPE.OPERATE_TYPE_DROP_EQUIP){if(!r.getInstance().getController())return;r.getInstance().isCoop()?o.equipItems.forEach(function(e,t){if(N.checkDropEquipTimeOffset(o.target)){console.log("OPERATE_TYPE_DROP_EQUIP equip isCoop: "+e.itemId+" "+o.target);var i=w.PLAYER_CAMP.myPlayer;r.getInstance().isSkyCastle()&&S.fromNumber(w.PLAYER_CAMP.opponents).equals(t)&&(i=w.PLAYER_CAMP.opponents),r.getInstance().getController().onParachuteAct(e.itemId,i,e.itemNum,o.target),N.updateDropEquipTime(o.target,y.TimeOffSetManager.getMilisecond())}}):o.equipItems.forEach(function(e,t){1==c.default.UUID.equals(t)?N.checkDropEquipTimeOffset(o.target)&&(console.log("OPERATE_TYPE_DROP_EQUIP equip myPlayer: "+e.itemId+" "+o.target),r.getInstance().getController().onParachuteAct(e.itemId,r.getInstance().getSelfCar().camp,e.itemNum,o.target),N.updateDropEquipTime(o.target,y.TimeOffSetManager.getMilisecond())):N.checkDropEquipTimeOffset(o.target)&&(console.log("OPERATE_TYPE_DROP_EQUIP equip otherPlayer: "+e.itemId+" "+o.target),r.getInstance().getController().onParachuteAct(e.itemId,2,e.itemNum,o.target),N.updateDropEquipTime(o.target,y.TimeOffSetManager.getMilisecond()))})}else if(o.operateType==h.OPERATE_TYPE.OPERATE_TYPE_HERO_LVDOWN){if(console.log("HHHHHHHHHHHHHHHHHHH fightserver OPERATE_TYPE_HERO_LVDOWN"),r.getInstance().gameState!=w.Game_State.Fighting)return void e.saveReconnectMsg(h.FIGHT_CLIENT_ENUM.P_Fight_Operate_Equip_SYNC,t);var i=null;if(s.default.matchRoleIdentity!=o.carId&&(r.getInstance().isCoop()?i=r.getInstance().getPlayerModelByCamp(w.PLAYER_CAMP.coopPlayer):r.getInstance().isPvP()&&(i=r.getInstance().getPlayerModelByCamp(w.PLAYER_CAMP.opponents)),i)){var a=i.reqHeroLevelDown(o.target);console.log("HHHHHHHHHHHHHHHHHHH fightserver OPERATE_TYPE_HERO_LVDOWN ret: "+a)}}else if(o.operateType==h.OPERATE_TYPE.OPERATE_TYPE_SPECIAL_EFFECT){if(console.log("HHHHHHHHHHHHHHHHHHH fightserver OPERATE_TYPE_SPECIAL_EFFECT"),r.getInstance().gameState!=w.Game_State.Fighting)return void e.saveReconnectMsg(h.FIGHT_CLIENT_ENUM.P_Fight_Operate_Equip_SYNC,t);if(i=null,s.default.matchRoleIdentity!=o.carId){if(r.getInstance().isCoop()){var n=w.PLAYER_CAMP.coopPlayer;s.default.matchRoleIdentity==w.PLAYER_IDENTITY.away&&(n=w.PLAYER_CAMP.myPlayer),i=r.getInstance().getCarByCamp(n)}else r.getInstance().isPvP()&&(i=r.getInstance().getCarByCamp(w.PLAYER_CAMP.opponents));if(i&&1==o.target&&1==i.getWhosyourdaddyState()){i.addWhosyourdaddyBuff(),i.setWhosyourdaddyState(0),i.addBuff(814,null),console.log("HHHHHHHHHHHHHHHHHHH fightserver OPERATE_TYPE_SPECIAL_EFFECT success");try{console.log("xiaoye tongbu chufa"),r.getInstance().recordXiaoYe(0,0,i.carTmpHp,i.tmpHp,i.hp)}catch(l){}}}}else o.carId==w.Enum_Elf_Card.huanElf&&o.equipItems.forEach(function(e,t){if(1==c.default.UUID.equals(t))r.getInstance().getSelfCombatModel().onElfModifyEquip(o.carId,null,e.itemId,!1),console.log("Enum_Elf_Card.huanElf equip myPlayer: "+e.itemId);else{var i=null;r.getInstance().isSkyCastle()?1==s.default.getMatchBattleInfo(!1).roleID.equals(t)?(console.log("Enum_Elf_Card.huanElf equip otherPlayer: "+e.itemId),i=r.getInstance().getCoopPlayerByCamp(w.PLAYER_CAMP.coopPlayer)):(console.log("Enum_Elf_Card.huanElf equip AIPlayer: "+e.itemId),i=r.getInstance().getPlayerModelByCamp(w.PLAYER_CAMP.opponents)):r.getInstance().isPvP()?i=r.getInstance().getPlayerModelByCamp(w.PLAYER_CAMP.opponents):r.getInstance().isCoop()&&(i=r.getInstance().getCoopPlayerByCamp(w.PLAYER_CAMP.coopPlayer)),i&&(console.log("Enum_Elf_Card.huanElf equip otherPlayer: "+e.itemId),i.onElfModifyEquip(o.carId,null,e.itemId,!1))}})},this),l.ClientNetwork.getInstance().listenProtocol(g.ROLE_CLIENT_ENUM.P_Role_SyncCostGet,function(e){e.resetPos();var t=new g.S_Role_SyncCostGet;t.read(e)?c.default.SyncCostGet(t):cc.error("Role SyncCostGet error!!")},this),l.ClientNetwork.getInstance().listenProtocol(g.ROLE_CLIENT_ENUM.P_Role_Cost_Get,function(e){e.resetPos();var t=new g.S_Role_Cost_Get;if(t.read(e))if(0==t.errorcode){t.prize.length>0&&P.default.addPopView("BaseCtrl","AcquirePopupView","AcquirePopupView",{items:t.prize});var o=P.default.getViewByName("BattlePassView");o&&o.view&&o.view.update_pass_currency();var i=P.default.getViewByName("RoyaleBattlePassView");i&&i.view&&i.view.update_pass_currency();var a=P.default.getViewByName("AnniversaryBattlePassView");a&&a.view&&a.view.update_pass_currency();var n=P.default.getViewByName("FogHiddenBattlePassView");n&&n.view&&n.view.update_pass_currency();var r=P.default.getViewByName("MachineryCityBattlePassView");r&&r.view&&r.view.update_pass_currency()}else C.G.StringManager.PopString("\u9053\u5177\u4f7f\u7528\u5f02\u5e38"+t.errorcode)},this),d.FightNetwork.getInstance().listenProtocol(h.FIGHT_CLIENT_ENUM.P_Fight_Timer_Notice,function(e){e.resetPos(),(new I.S_Fight_Timer_Notice).read(e)&&d.FightNetwork.getInstance().pushLocalMessage(u.LOCAL_MESSAGE.LocalMsg_PvpBossRefresh)},this),l.ClientNetwork.getInstance().listenProtocol(O.ACTIVITY_CLIENT_ENUM.P_Activity_SyncEatChickenData,function(e){e.resetPos();var t=new O.S_Activity_SyncEatChickenData;t.read(e)&&(0==t.error?(z.default.setChickenDinnerData(t),j.default.Instance.emit(W.default.ChickenDinnerSync)):C.G.StringManager.PopString("\u8bd5\u70bc\u573a\u83b7\u53d6\u6570\u636e\u9519\u8bef  "+t.error))},this),l.ClientNetwork.getInstance().listenProtocol(f.MATCH_CLIENT_ENUM.P_Match_Chicken_Result,function(e){e.resetPos();var t=new f.S_Match_Chicken_Result;if(t.read(e)&&0==t.ranklistdata.isLive){z.default.setChickenDinnerResultData(t);var o=P.default.getViewByName("MainSceneView");if(o&&o.view){var i=P.default.getViewByName("MatchMainView");i&&i.view&&i.view.closeView(),P.default.addPopView("BaseCtrl","ChickenDinnerSettlementView","ChickenDinnerSettlementView",null,99)}}},this),l.ClientNetwork.getInstance().listenProtocol(g.ROLE_CLIENT_ENUM.P_Role_BroadcastGameNotice,function(e){e.resetPos();var t=new g.S_Role_BroadcastGameNotice;t.read(e)&&C.G.LoopRollMsg.startScroll(t.noticeData.noticeMsg)},this),l.ClientNetwork.getInstance().listenProtocol(g.ROLE_CLIENT_ENUM.P_Role_Get_Server_Time,function(e){e.resetPos();var t=new g.S_Role_Get_Server_Time;if(t.read(e)){c.default.setGameTime(t.tGameTime);var o=t.tGameTime.year+"-"+t.tGameTime.month+"-"+t.tGameTime.day+" "+t.tGameTime.hour+":"+t.tGameTime.minnute+":"+t.tGameTime.second;console.log("\u540c\u6b65\u6e38\u620f\u65f6\u95f4  ",o,ee.default.timeToTimestamp(o)),c.default.setServersTime(ee.default.timeToTimestamp(o))}},this),l.ClientNetwork.getInstance().listenLocalMessage(u.LOCAL_MESSAGE.LocalMsg_itemChange_pet,function(e){e[0].isNew&&1==e[0].isNew&&(c.default.setPetRedDot(!0),l.ClientNetwork.getInstance().pushLocalMessage(u.LOCAL_MESSAGE.LocalMsg_RefreshPetRedDot)),l.ClientNetwork.getInstance().pushLocalMessage(u.LOCAL_MESSAGE.LocalMsg_ClientTaskUpdateCount,{classifyId:2,valueCount:e[0].itemTotalNum})},this),l.ClientNetwork.getInstance().listenLocalMessage(u.LOCAL_MESSAGE.LocalMsg_itemChange_carSkin,function(e){e[0].isNew&&1==e[0].isNew&&(c.default.setCarSkinRed(!0),l.ClientNetwork.getInstance().pushLocalMessage(u.LOCAL_MESSAGE.LocalMsg_RefreshRedDot_carSkin)),l.ClientNetwork.getInstance().pushLocalMessage(u.LOCAL_MESSAGE.LocalMsg_ClientTaskUpdateCount,{classifyId:4,valueCount:e[0].itemTotalNum})},this),l.ClientNetwork.getInstance().listenLocalMessage(u.LOCAL_MESSAGE.LocalMsg_itemChange_heroSkin,function(e){e[0]&&e[0].itemId&&de.default.Instance.onAddSkinItem(e[0].itemId)},this),l.ClientNetwork.getInstance().listenProtocol(g.ROLE_CLIENT_ENUM.P_Role_SynBattleArrayData,function(e){e.resetPos();var t=new g.S_Role_SynBattleArrayData;t.read(e)&&t.battlearray&&(c.default.fightHeroArrayIndex=t.battlearray.defineID-1,c.default.setBattleHeroCards(t),l.ClientNetwork.getInstance().pushLocalMessage(u.LOCAL_MESSAGE.LocalMsg_RefreshHeroCardMainView))},this),l.ClientNetwork.getInstance().listenLocalMessage(u.LOCAL_MESSAGE.LocalMsg_SynRoleAttrVal,function(e){if(parseInt(e[0])==m.ROLE_ATTR_VALUES.ROLE_ATTR_RECHARGENUM){var t=e[1],o=e[2],i=parseInt(N.getConfigIntValue("vipService_show_btn"));"bigBlue"==A.GamePlatform.getMiYaVideoTypeNoSet()&&(i=parseInt(N.getConfigIntValue("vipService_show_btn_bigBlue"))),t<i&&o>=i&&l.ClientNetwork.getInstance().pushLocalMessage(u.LOCAL_MESSAGE.LocalMsg_RefreshPetRedDot)}},this),l.ClientNetwork.getInstance().listenProtocol(g.ROLE_CLIENT_ENUM.P_Role_Reboot_Client,function(){var e=C.G.StringManager.getString("REBOOT_CLIENT");A.GamePlatform.isWechat()?wx.showModal({title:"\u63d0\u793a",content:e,showCancel:!1,complete:function(){wx.exitMiniProgram()}}):A.GamePlatform.isQQMiniGame()?qq.showModal({title:"\u63d0\u793a",content:e,showCancel:!1,complete:function(){qq.exitMiniProgram()}}):P.default.addPopView("BaseCtrl","RebootClientView","RebootClientView"),this.scheduleOnce(function(){A.GamePlatform.isWechat()?wx.exitMiniProgram():A.GamePlatform.isQQMiniGame()?qq.exitMiniProgram():(cc.director.pause(),cc.audioEngine.stopAll(),cc.director.isPaused()&&(C.G.StringManager.PopStringOnce("\u91cd\u542f\u5ba2\u6237\u7aef1..."),cc.game.end()))},10)},this),l.ClientNetwork.getInstance().listenProtocol(g.ROLE_CLIENT_ENUM.P_Role_QQHall_GetReward,function(e){e.resetPos();var t=new g.S_Role_QQHall_GetReward;t.read(e)&&(X.default.log("QQHallUtils, P_Role_QQHall_GetReward=",t),0==t.errorcode?P.default.addPopView("BaseCtrl","AcquirePopupView","AcquirePopupView",{items:t.prize}):-1==t.errorcode?C.G.StringManager.PopString("\u5956\u52b1\u5df2\u9886\u8fc7"):-6==t.errorcode&&C.G.StringManager.PopString("\u676f\u6570\u4e0d\u8db3"))},this),l.ClientNetwork.getInstance().listenProtocol(g.ROLE_CLIENT_ENUM.P_Role_UpdateClientInt,function(e){e.resetPos();var t=new g.S_Role_UpdateClientInt;if(t.read(e)){var o=c.default.getClientData();o.has(t.intKey),o.set(t.intKey,t.intValue)}},this),l.ClientNetwork.getInstance().listenProtocol(g.ROLE_CLIENT_ENUM.P_Role_Push_Gift,function(e){console.log("\u6536\u5230\u63a8\u9001\u793c\u5305"),e.resetPos();var t=new g.S_Role_Push_Gift;if(t.read(e)&&(console.log("\u6536\u5230\u63a8\u9001\u793c\u5305\uff0crsp=",t),0==t.errorcode)){$.default.Instance.updateData(t.list);var o=P.default.getViewByName("MainSceneView");o&&o.view&&o.view.checkPushGiftBtn()}},this),l.ClientNetwork.getInstance().listenProtocol(g.ROLE_CLIENT_ENUM.P_Role_SyncNewerThreeDaysGift,function(e){console.log("\u6536\u5230\u63a8\u9001\u65b0\u4eba\u5927\u795e\u793c\u5305"),e.resetPos();var t=new g.S_Role_SyncNewerThreeDaysGift;if(t.read(e)&&(console.log("\u6536\u5230\u63a8\u9001\u65b0\u4eba\u5927\u795e\u793c\u5305\uff0crsp=",t),0==t.errorcode)){pe.default.Instance.updateData(t);var o=P.default.getViewByName("MainSceneView");o&&o.view&&o.view.checkNewerGiftBtn()}},this),l.ClientNetwork.getInstance().listenLocalMessage(u.LOCAL_MESSAGE.LocalMsg_close_view,function(){1!=pe.default.Instance.checkPopUp()&&$.default.Instance.checkPopUpView()},this),l.ClientNetwork.getInstance().listenProtocol(g.ROLE_CLIENT_ENUM.P_Role_OnOffDataInfo,function(e){e.resetPos();var t=new g.S_Role_OnOffDataInfo;if(t.read(e)){var o=c.default.getPlayerOnOffDataInfo(),i=!1;o&&o.size>0&&!c.default.checkModulerOnOffState(ie.ModulerViewOnOff.ForceAPPCheckGame)&&(i=!0),c.default.setPlayerOnOffDataInfo(t.onoff),j.default.Instance.emit(W.default.SyncModuleViewEvent),i&&c.default.checkModulerOnOffState(ie.ModulerViewOnOff.ForceAPPCheckGame)&&l.ClientNetwork.getInstance().pushLocalMessage(u.LOCAL_MESSAGE.LocalMsg_ForceCheckGame)}},this),l.ClientNetwork.getInstance().listenLocalMessage(u.LOCAL_MESSAGE.LocalMsg_ClientTaskUpdateCount,function(t){var o=.5;Array.from(c.default.getRoleTaskData().tasks.values()).forEach(function(i){var a=V.TaskTableData.getById(i.taskID);a&&i.taskState==m.TASK_STATE.TASK_STATE_EXECUTING&&a.showType==m.TASK_SHOW_TYPE.TASK_SHOW_TYPE_ACHIEVEMENT&&a.type==m.TASK_TYPE.TASK_TYPE_COUNT_CLIENT&&a.functionTriggerId==t[0].classifyId&&(e.scheduleOnce(function(){var e=new g.C_Role_ClientTaskUpdateCount;e.taskID=a.id,e.count=t[0].valueCount,l.ClientNetwork.getInstance().Send(g.ROLE_CLIENT_ENUM.P_Role_ClientTaskUpdateCount,e)},o),o+=.5)})},this),l.ClientNetwork.getInstance().listenProtocol(g.ROLE_CLIENT_ENUM.P_Role_TakeTask,function(e){e.resetPos();var t=new g.S_Role_TakeTask;if(t.read(e))if(0==t.errorcode){var o=ee.default.getAddShortcutTaskId();if(A.GamePlatform.isQQMiniGame()&&(o=402),t.taskID==o||403==t.taskID){t.prize.length>0&&P.default.addPopView("BaseCtrl","AcquirePopupView","AcquirePopupView",{items:t.prize});var i=P.default.getViewByName("MainSceneView");try{i&&i.view&&i.view.checkAddShortcutButton(),i&&i.view&&i.view.checkAddCollectButton()}catch(a){}}}else C.G.StringManager.PopString("S_Role_TakeTask Error "+t.errorcode)},this),l.ClientNetwork.getInstance().listenLocalMessage(u.LOCAL_MESSAGE.LocalMsg_ForceCheckGame,function(){var t=C.G.StringManager.getString("REBOOT_CLIENT");A.GamePlatform.isWechat()?wx.showModal({title:"\u63d0\u793a",content:t,showCancel:!1,complete:function(){console.log("clickreboot"),wx.exitMiniProgram()}}):A.GamePlatform.isQQMiniGame()?qq.showModal({title:"\u63d0\u793a",content:t,showCancel:!1,complete:function(){console.log("clickreboot"),qq.exitMiniProgram()}}):A.GamePlatform.isByteDanceMiniGame()?tt.showModal({title:"\u63d0\u793a",content:t,showCancel:!1,complete:function(){console.log("clickreboot"),tt.exitMiniProgram()}}):A.GamePlatform.isKuaishouMiniGame()?ks.showModal({title:"\u63d0\u793a",content:t,showCancel:!1,complete:function(){console.log("clickreboot"),ks.exitMiniProgram()}}):P.default.addPopView("BaseCtrl","RebootClientView","RebootClientView"),e.scheduleOnce(function(){console.log("clickreboot10"),cc.director.pause(),cc.audioEngine.stopAll(),C.G.StringManager.PopStringOnce("\u91cd\u542f\u5ba2\u6237\u7aef2..."),cc.game.end()},10)},this),l.ClientNetwork.getInstance().listenLocalMessage(u.LOCAL_MESSAGE.LocalMsg_BuyVideoByGold,function(){B.default.buyVideoByGold()},this),l.ClientNetwork.getInstance().listenProtocol(g.ROLE_CLIENT_ENUM.P_Role_ProficiencyShare,function(e){e.resetPos();var t=new g.S_Role_ProficiencyShare;if(t.read(e))if(0==t.errorCode&&t.prize.length>0){P.default.addPopView("BaseCtrl","AcquirePopupView","AcquirePopupView",{items:t.prize});var o=P.default.getViewByName("HeroCardInfoView");if(o&&o.view){var i=o.view.node.getChildByName("proficiencyNode");i&&(i.getChildByName("proficiencyIcon").children[0].active=!1)}var a=P.default.getViewByName("ProficiencyHelp");a&&a.view&&(a.view.node.getChildByName("shareNode").active=!1);var n=P.default.getViewByName("HeroCardsMainView");n&&n.view&&n.view.hideCardShareRedpoint();var r=P.default.getViewByName("MainSceneView");r&&r.view&&r.view.onRefreshHeroRedPoint()}else console.log("S_Role_ProficiencyShare error  ",t.errorCode)},this),l.ClientNetwork.getInstance().listenProtocol(O.ACTIVITY_CLIENT_ENUM.P_Activity_SyncWeekCooperationData,function(e){e.resetPos();var t=new O.S_Activity_SyncWeekCooperationData;if(t.read(e)){if(0!=t.error)return C.G.StringManager.PopString("SyncWeekCooperationData ERROR "+t.error);z.default.syncWeekCooperationData(t)}},this),l.ClientNetwork.getInstance().listenProtocol(g.ROLE_CLIENT_ENUM.P_Role_SynChapterData,function(e){e.resetPos();var t=new g.S_Role_SynChapterData;t.read(e)&&(c.default.setPlayerScoreFundData(t.scoreFundData),j.default.Instance.emit(W.default.SyncShopScoreFund))},this),l.ClientNetwork.getInstance().listenProtocol(h.FIGHT_CLIENT_ENUM.P_Fight_Trigger_Buff_SYNC,function(t){if(console.log("HHHHHHHHHHHHHHHHHHH fightserver P_Fight_Trigger_Buff_SYNC start"),r.getInstance().gameState==w.Game_State.Fighting){t.resetPos();var o=new ge.S_Fight_Trigger_Buff_SYNC;if(o.read(t)){var i=w.PLAYER_CAMP.myPlayer;r.getInstance().isCoop()?s.default.matchRoleIdentity==w.PLAYER_IDENTITY.home&&(i=w.PLAYER_CAMP.coopPlayer):r.getInstance().isPvP()&&(o.roleId.equals(c.default.UUID)||(i=w.PLAYER_CAMP.opponents));var a=r.getInstance().getCarByCamp(i);if(a&&o.buffType==me.BUFF_TYPE.BUFF_TYPE_INJURY_FREE){a.setWhosyourdaddyState(0),a.addBuff(o.buffId,null),a.addBuff(814,null),console.log("HHHHHHHHHHHHHHHHHHH fightserver P_Fight_Trigger_Buff_SYNC success");try{console.log("xiaoye tongbu chufa"),r.getInstance().recordXiaoYe(0,0,a.carTmpHp,a.tmpHp,a.hp)}catch(n){}}}}else e.saveReconnectMsg(h.FIGHT_CLIENT_ENUM.P_Fight_Trigger_Buff_SYNC,t)},this)},t.prototype.checkEnterBattleTimeOut=function(){_.default.setEnterBattleTimeout(!0),_.default.ShowReconnectLayer()},t.prototype.cancelEnterBattleTimeOut=function(){_.default.setEnterBattleTimeout(!1),this.unschedule(this.checkEnterBattleTimeOut)},t.prototype.requestLocalInfo=function(){var e=new XMLHttpRequest;e.onload=function(){if(e.status>=200&&e.status<400){console.log("requestLocalInfo success",e);var t=e.responseText;if(t){var o=JSON.parse(t),i=new re.C_Role_SetLocaltionInfo;i.country=o.country,i.province=o.province,i.city=o.city,i.isp=o.isp,console.log("requestLocalInfo region",i.country+i.province+i.city+i.isp),l.ClientNetwork.getInstance().Send(g.ROLE_CLIENT_ENUM.P_Role_SetLocaltionInfo,i)}}},e.onerror=function(){console.log("requestLocalInfo Error")},e.open("GET","",!0),e.timeout=1e4,e.send()},t.prototype.saveReconnectMsg=function(e,t){r.getInstance().gameState==w.Game_State.Reconnect&&r.getInstance().reconnectMsgList.push({ptl:e,message:t})},n([_e],t)}(cc.Component);o.GlobalMsgListener=ye,cc._RF.pop()},{"../Global":"Global","../StaticData/RechargeTableData":"RechargeTableData","../StaticData/StringValueTableData":"StringValueTableData","../StaticData/TaskTableData":"TaskTableData","../TalkingDataAPI":"TalkingDataAPI","../combat/CombatManager":"CombatManager","../combat/unit/DropEquipObj":"DropEquipObj","../common/CombatModule":"CombatModule","../common/CommandValue":"CommandValue","../common/EventConst":"EventConst","../common/PlayerModule":"PlayerModule","../controller/Guide/GuideConfig/GuideConst":"GuideConst","../model/ServerAddrInfo":"ServerAddrInfo","../modules/base/GameView":"GameView","../modules/manager/EventManager":"EventManager","../modules/manager/ViewManager":"ViewManager","../network/ClientNetwork":"ClientNetwork","../network/FightNetwork":"FightNetwork","../network/FightReconnectLayer":"FightReconnectLayer","../network/LocalMessage":"LocalMessage","../network/ReconnectLayer":"ReconnectLayer","../network/protocol/ActivityProtocols":"ActivityProtocols","../network/protocol/BaseProtocols":"BaseProtocols","../network/protocol/ChatProtocols":"ChatProtocols","../network/protocol/FightProtocols":"FightProtocols","../network/protocol/FriendProtocls":"FriendProtocls","../network/protocol/LoginProtocols":"LoginProtocols","../network/protocol/MatchProtocols":"MatchProtocols","../network/protocol/RechargeProtocols":"RechargeProtocols","../network/protocol/RoleProtocols":"RoleProtocols","../network/protocol/TypeProtocols":"TypeProtocols","../network/protocol/long":"long","../utils/ByteDanceMiniGameUtils":"ByteDanceMiniGameUtils","../utils/ConfigUtils":"ConfigUtils","../utils/ConstValue":"ConstValue","../utils/GameLoading":"GameLoading","../utils/GamePlatform":"GamePlatform","../utils/GameTools":"GameTools","../utils/GameUtils":"GameUtils","../utils/KSMinigameUtils":"KSMinigameUtils","../utils/LeniuGameUtils":"LeniuGameUtils","../utils/LogUtil":"LogUtil","../utils/NameManager":"NameManager","../utils/QQGameHallUtils":"QQGameHallUtils","../utils/QQMiniGameUtils":"QQMiniGameUtils","../utils/ResourceLoader":"ResourceLoader","../utils/RewardedVideoAd":"RewardedVideoAd","../utils/TimeOffSetManager":"TimeOffSetManager","../utils/UIManager":"UIManager","../utils/WechatUtils":"WechatUtils","../view/activity/ActivityModule":"ActivityModule","../view/anniversary/AnniversaryCtrl":"AnniversaryCtrl","../view/fogHidden/FogHiddenCtrl":"FogHiddenCtrl","../view/heroCardBag/HeroSkinUtils":"HeroSkinUtils","../view/machineryCityActivity/MachineryCityCtrl":"MachineryCityCtrl","../view/pushGift/NewerThreeDaysGiftUtils":"NewerThreeDaysGiftUtils","../view/pushGift/PushGiftUtils":"PushGiftUtils","../view/skyCastle/SkyCastleCtrl":"SkyCastleCtrl","../view/sociaty/SociatyCtrl":"SociatyCtrl","./GameGlobal":"GameGlobal"}],Global:[function(e,t,o){"use strict";cc._RF.push(t,"7f22ecc85xO17UOFaQH325G","Global"),Object.defineProperty(o,"__esModule",{value:!0});var i=function(){function e(){this.bundleResources="resources",this._bJumpGuide=!1,this.version="",this._isShowQQExchange=!1}return Object.defineProperty(e,"Instance",{get:function(){return e._instance||(e._instance=new e),e._instance},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"jumpGuide",{get:function(){return this._bJumpGuide},set:function(e){this._bJumpGuide=e},enumerable:!1,configurable:!0}),e}();o.default=i,cc._RF.pop()},{}],GoldenLeagueRankListTableData:[function(e,t,o){"use strict";cc._RF.push(t,"782ebx+z4lDZqkckbWj/4bj","GoldenLeagueRankListTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.GoldenLeagueRankListPrizeTableData=void 0;var i=e("../TableReader"),a=e("./BaseTableData"),n=function(){function e(){this.id=0,this.rankMin=0,this.rankMax=0,this.seasonId=0,this.mailid=0,this.prize=new Array}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.rankMin=e.getNumber(),this.rankMax=e.getNumber(),this.seasonId=e.getNumber(),this.mailid=e.getNumber();for(var o=e.getString(),n=new i.TableReader(o);n.getPos()<n.getLen();){var r=new a.DropItem;r.readOriginal(n),this.prize.push(r)}},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"GoldenLeagueRankListTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.GoldenLeagueRankListPrizeTableData=n,cc._RF.pop()},{"../TableReader":"TableReader","./BaseTableData":"BaseTableData"}],GoldenLeagueRewardTableData:[function(e,t,o){"use strict";cc._RF.push(t,"9d0eakSOc1LppTls2mFYcnD","GoldenLeagueRewardTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.GoldenLeagueRewardTableData=void 0;var i=e("../TableReader"),a=e("./BaseTableData"),n=function(){function e(){this.seasonId=0,this.winNum=0,this.prize=new Array,this.heroId=0,this.heroScale=0}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.seasonId=e.getNumber(),this.winNum=e.getNumber();for(var o=e.getString(),n=new i.TableReader(o);n.getPos()<n.getLen();){var r=new a.DropItem;r.readOriginal(n),this.prize.push(r)}this.heroId=e.getNumber(),this.heroScale=e.getNumber()},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"GoldenLeagueRewardTableData"},e.prototype.isAutoId=function(){return!0},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.GoldenLeagueRewardTableData=n,cc._RF.pop()},{"../TableReader":"TableReader","./BaseTableData":"BaseTableData"}],GreatSailingRankListTableData:[function(e,t,o){"use strict";cc._RF.push(t,"4945dh0RdtIzpprrtA59AYF","GreatSailingRankListTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.GreatSailingRankListTableData=void 0;var i=e("../TableReader"),a=e("./BaseTableData"),n=function(){function e(){this.id=0,this.rankMin=0,this.rankMax=0,this.seasonId=0,this.mailid=0,this.prize=new Array}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.rankMin=e.getNumber(),this.rankMax=e.getNumber(),this.seasonId=e.getNumber(),this.mailid=e.getNumber();for(var o=e.getString(),n=new i.TableReader(o);n.getPos()<n.getLen();){var r=new a.DropItem;r.readOriginal(n),this.prize.push(r)}},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"GreatSailingRankListTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.GreatSailingRankListTableData=n,cc._RF.pop()},{"../TableReader":"TableReader","./BaseTableData":"BaseTableData"}],GreatSailingRefreshTableData:[function(e,t,o){"use strict";cc._RF.push(t,"932b6k5KqRP6r/uLfav7qdI","GreatSailingRefreshTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.GreatSailingRefreshTableData=void 0;var i=e("../TableReader"),a=e("./BaseTableData"),n=function(){function e(){this.id=0,this.refreshNum=0,this.reliveCost=new Array}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.refreshNum=e.getNumber();for(var o=e.getString(),n=new i.TableReader(o);n.getPos()<n.getLen();){var r=new a.DropItem;r.readOriginal(n),this.reliveCost.push(r)}},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"GreatSailingRefreshTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.GreatSailingRefreshTableData=n,cc._RF.pop()},{"../TableReader":"TableReader","./BaseTableData":"BaseTableData"}],GreatSailingReliveTableData:[function(e,t,o){"use strict";cc._RF.push(t,"99203PA/ktLg6uGUITEahIM","GreatSailingReliveTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.GreatSailingReliveTableData=void 0;var i=e("../TableReader"),a=e("./BaseTableData"),n=function(){function e(){this.id=0,this.reliveNum=0,this.reliveCost=new Array}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.reliveNum=e.getNumber();for(var o=e.getString(),n=new i.TableReader(o);n.getPos()<n.getLen();){var r=new a.DropItem;r.readOriginal(n),this.reliveCost.push(r)}},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"GreatSailingReliveTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.GreatSailingReliveTableData=n,cc._RF.pop()},{"../TableReader":"TableReader","./BaseTableData":"BaseTableData"}],GreatSailingTableData:[function(e,t,o){"use strict";cc._RF.push(t,"04a55loqftG9oeP5lxUOe3C","GreatSailingTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.GreatSailingTableData=void 0;var i=e("../TableReader"),a=function(){function e(){this.id=0,this.cardGroup=new Array,this.weight=0}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber();for(var o=e.getString(),a=new i.TableReader(o);a.getPos()<a.getLen();){var n;n=a.getNumber(),this.cardGroup.push(n)}this.weight=e.getNumber()},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"GreatSailingTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.GreatSailingTableData=a,cc._RF.pop()},{"../TableReader":"TableReader"}],GuideCommand:[function(e,t,o){"use strict";cc._RF.push(t,"b1c09bsSfNFlrGDA4CgwQ0c","GuideCommand"),Object.defineProperty(o,"__esModule",{value:!0}),o.resumeAllChildrenSchedule=o.pauseAllChildrenSchedule=o.showDialog=o.sendGuideStep=o.createJinfenStep=o.createClickTask=o.createPveFightTask=o.GuideCommand=o.SkipCommand=o.WaitCustomEvent=o.CheckPopLayer=o.WaitPoplayerClose=o.WaitPoplayer=o.CheckAnyOfScenes=o.CheckScene=o.WaitAnyOfScenes=o.WaitScene=o.Command=void 0;var i,a=e("../../network/LocalMessage"),n=e("../../utils/UIManager"),r=e("../../Global/GameGlobal"),s=e("../../network/ClientNetwork"),c=e("../../StaticData/GuidePlotTableData"),l=e("../../view/guide/GuidePlot"),d=e("./GuideController"),u=e("../../modules/base/GameView");function h(e){return r.G.UIManager.getCurSceneTag()==e}function p(e){for(var t=r.G.UIManager.getCurSceneTag(),o=0,i=e;o<i.length;o++)if(t==i[o])return!0;return!1}function f(e){var t=e+"",o=r.G.UIManager.popNode;if(o&&o.children)for(var i=0,a=o.children;i<a.length;i++)if(a[i].name==t)return!0;return!1}(function(e){e[e.Click=0]="Click",e[e.Dialogue=1]="Dialogue",e[e.Tips=2]="Tips",e[e.Audio=3]="Audio",e[e.ClickWithoutEffect=4]="ClickWithoutEffect",e[e.ClickAnyWhere=5]="ClickAnyWhere",e[e.None=6]="None",e[e.CallBack=7]="CallBack",e[e.onlyTouch=8]="onlyTouch",e[e.playBigCircle=9]="playBigCircle",e[e.ClickWithoutOpacity=10]="ClickWithoutOpacity"})(i=o.Command||(o.Command={})),o.WaitScene=function(e,t,o){if(void 0===o&&(o=0),h(e))t();else{var i=d.default.Instance.node,n=!0;o>0&&setTimeout(function(){n&&(s.ClientNetwork.getInstance().removeLocalMessage(a.LOCAL_MESSAGE.LocalMsg_SceneLoaded,i),n=!1,t("WaitScene "+e+" timeout!!"))},o),s.ClientNetwork.getInstance().listenLocalMessage(a.LOCAL_MESSAGE.LocalMsg_SceneLoaded,function(o){e==o.loadScene&&(n=!1,s.ClientNetwork.getInstance().removeLocalMessage(a.LOCAL_MESSAGE.LocalMsg_SceneLoaded,i),t())},i)}},o.WaitAnyOfScenes=function(e,t,o){if(void 0===o&&(o=0),p(e))t();else{var i=d.default.Instance.node,n=!0;o>0&&setTimeout(function(){n&&(s.ClientNetwork.getInstance().removeLocalMessage(a.LOCAL_MESSAGE.LocalMsg_SceneLoaded,i),n=!1,t("WaitScene "+e+" timeout!!"))},o),s.ClientNetwork.getInstance().listenLocalMessage(a.LOCAL_MESSAGE.LocalMsg_SceneLoaded,function(){p(e)&&(n=!1,s.ClientNetwork.getInstance().removeLocalMessage(a.LOCAL_MESSAGE.LocalMsg_SceneLoaded,i),t())},i)}},o.CheckScene=h,o.CheckAnyOfScenes=p,o.WaitPoplayer=function(e,t,o){if(void 0===o&&(o=0),f(e))t();else{var i=d.default.Instance.node,n=!0;o>0&&setTimeout(function(){n&&(s.ClientNetwork.getInstance().removeLocalMessage(a.LOCAL_MESSAGE.LocalMsg_ShowPopLayer,i),n=!1,t("WaitPoplayer "+e+" timeout!!"))},o),s.ClientNetwork.getInstance().listenLocalMessage(a.LOCAL_MESSAGE.LocalMsg_ShowPopLayer,function(o){e==o.popNodeTag&&(n=!1,s.ClientNetwork.getInstance().removeLocalMessage(a.LOCAL_MESSAGE.LocalMsg_ShowPopLayer,i),t())},i)}},o.WaitPoplayerClose=function(e,t,o){void 0===o&&(o=0);var i=d.default.Instance.node,n=!0;o>0&&setTimeout(function(){n&&(s.ClientNetwork.getInstance().removeLocalMessage(a.LOCAL_MESSAGE.LocalMsg_ClosePopLayer,i),n=!1,t("WaitPoplayer "+e+" timeout!!"))},o),s.ClientNetwork.getInstance().listenLocalMessage(a.LOCAL_MESSAGE.LocalMsg_ClosePopLayer,function(o){e==o&&(n=!1,s.ClientNetwork.getInstance().removeLocalMessage(a.LOCAL_MESSAGE.LocalMsg_ClosePopLayer,i),t())},i)},o.CheckPopLayer=f,o.WaitCustomEvent=function(e,t){var o=d.default.Instance.node;s.ClientNetwork.getInstance().listenLocalMessage(e,function(){t(),s.ClientNetwork.getInstance().removeLocalMessage(e,o)},o)},o.SkipCommand=function(e){console.log("SkipCommand"+e.desc),e.skip_cmd=!0};var g=function(){function e(){}return e.getFunc=function(t){var o;switch(t){case i.Click:o=e.click;break;case i.Dialogue:o=e.dialogue;break;case i.Tips:o=e.tips;break;case i.Audio:o=e.audio;break;case i.ClickWithoutEffect:o=e.clickWithoutEffect;break;case i.ClickWithoutOpacity:o=e.ClickWithoutOpacity;break;case i.ClickAnyWhere:o=e.clickAnyWhere;break;case i.None:o=e.none;break;case i.CallBack:o=e.CallBack;break;case i.onlyTouch:o=e.onlyTouch;break;case i.playBigCircle:o=e.playBigCircle}return o},e.click=function(t,o,i,a,n){var r;void 0===a&&(a=!0),void 0===n&&(n=!0),t.TargetNode=null,r=Array.isArray(o)?o[0]:o,t.find(r,function(r,s){if(s)i(s);else{e.playBigCircleByNode(t,r,null),t.TargetNode=r,t.fingerToNode(r,a,n),t.setMaskVisible(!0,r);for(var c=void 0,l=r.parent;l&&!(l instanceof cc.Scene);l=l.parent)if(c=l.getComponent(cc.ScrollView)){c.enabled=!1;break}var d=function(){c&&(c.enabled=!0),t.node.getChildByName("guideGQNode").destroyAllChildren(),i()};Array.isArray(o)?cc.director.once(o[1],function(){console.log("\u76d1\u542c\u6d88\u606f\u6536\u5230\u4e86"),d(),t.TargetNode=null},t.node):r.once(cc.Node.EventType.TOUCH_END,function(){console.log("\u8282\u70b9\u88ab\u70b9\u51fb"),d(),t.TargetNode=null,r.targetOff(r),t.pGuidePlot&&(t.pGuidePlot.removeFromParent(!0),t.pGuidePlot.triggerCallBack(),t.pGuidePlot=null),"guideHeroClickNode"==r.name&&u.default.addPopView("BaseCtrl","BattleCardInfo","BattleCardInfo",{nHeroId:10,camp:1})},r)}})},e.clickWithoutEffect=function(t,o,i){e.click(t,o,i,!1,!1)},e.ClickWithoutOpacity=function(t,o,i){e.click(t,o,i,!0,!1)},e.playBigCircleByNode=function(){console.log("playBigCircleByNode")},e.playBigCircle=function(){console.log("playBigCircle")},e.onlyTouch=function(t,o,i){t.TargetNode=null,t.find(o[0],function(a,n){if(n)i(n);else{e.playBigCircleByNode(t,a,null);var r=!1,s=!1;o.length>2&&(r=o[3]),o.length>3&&(s=o[4]),t.fingerToNode(a,r,s),t.TargetNode=a,cc.director.once(o[1],function(){i(),t.TargetNode=null})}})},e.clickAnyWhere=function(e,t,o){var i=new cc.Node;i.setContentSize(cc.view.getDesignResolutionSize()),i.setAnchorPoint(cc.Vec2.ZERO),cc.director.getScene().addChild(i,99999),i.once(cc.Node.EventType.TOUCH_END,function(){i.destroy(),o()})},e.dialogue=function(e,t,o){var i=r.G.UIManager.getCurSceneTag(),a=0,s=!0;if(Array.isArray(t)?(a=Number(t[0]),s=t[1]):a=Number(t),e._bPauseGame=s,i!=n.SceneTag.PveFightScene){d.default.Instance.setMaskVisible(!1);var u=!0,h="",p=c.GuidePlotTableData.getById(a);p&&(h=p.soundStr,u=p.spineMove);var f=l.GuidePlot.create(a,!0,u,h,!1),g=d.default.Instance.node;f.setCallBackFunc(g,o,null),r.G.UIManager.getRunningScene().addChild(f,n.GameMainLayerZorder.GMZ_NEW_TALK),e.pGuidePlot=f}else m(a,s,o)},e.tips=function(e,t,o){e.showTips(t),o()},e.audio=function(e,t,o){e.playSound(t),o()},e.none=function(e,t,o){e.setMaskVisible(!1),cc.sys.os==cc.sys.OS_IOS?(console.log("\u5ef6\u65f6"+t),o()):setTimeout(function(){console.log("\u5ef6\u65f6"+t),o()},t)},e.CallBack=function(e,t,o){t&&t(o)},e}();function m(e,t,o){void 0===t&&(t=!0);var i=c.GuidePlotTableData.getById(e);if(i){t&&(_(cc.find("Canvas/GameScene")),d.default.Instance._bPauseGame=!0);var a=l.GuidePlot.create(e,!0,i.spineMove,i.soundStr,!0);a.setCallBackFunc(this,function(){if(console.log("guideCallback 1"),t){var e=cc.find("Canvas/GameScene");console.log("guideCallback 2"),y(e),console.log("guideCallback 3"),d.default.Instance._bPauseGame=!1}console.log("guideCallback 4"),o(),console.log("guideCallback 5")},null),r.G.UIManager.getRunningScene().addChild(a,n.GameMainLayerZorder.GMZ_FLYWORD),a.setPosition(cc.Vec2.ZERO),d.default.Instance.pGuidePlot=a}}function _(e){if(e.pauseAllActions(),cc.director.getScheduler().pauseTarget(e),e.getComponents(cc.Component).forEach(function(e){cc.director.getScheduler().pauseTarget(e),e instanceof sp.Skeleton&&(e.paused=!0)}),e.getChildByName("Blood")){var t=e.getChildByName("Blood").getChildByName("FightTopView");t&&t.getComponent("FightTopView").setCarryUpdate(!1)}var o=e.getChildByName("Map").getChildByName("Player1"),i=e.getChildByName("Map").getChildByName("Player2");o.children.forEach(function(e){e.getComponent(sp.Skeleton)&&(e.getComponent(sp.Skeleton).paused=!0,e.getComponent(sp.Skeleton).timeScale=0,e.childrenCount>0&&e.children.forEach(function(e){e.getComponent(sp.Skeleton)&&(e.getComponent(sp.Skeleton).paused=!0,e.getComponent(sp.Skeleton).timeScale=0)}))}),i.children.forEach(function(e){e.getComponent(sp.Skeleton)&&(e.getComponent(sp.Skeleton).paused=!0,e.getComponent(sp.Skeleton).timeScale=0,e.childrenCount>0&&e.children.forEach(function(e){e.getComponent(sp.Skeleton)&&(e.getComponent(sp.Skeleton).paused=!0,e.getComponent(sp.Skeleton).timeScale=0)}))});var a=o.getChildByName("car1");a&&((n=a.getComponent(sp.Skeleton).attachUtil).generateAllAttachedNodes(),n.getAttachedNodes("bone")[0].children.forEach(function(e){var t=e.getChildByName("HeroNode");t&&(t.getComponent(sp.Skeleton).paused=!0,t.getComponent(sp.Skeleton).timeScale=0)}));var n,r=e.getChildByName("Map").getChildByName("ZhanChe").getChildByName("car2");r&&(r.children.forEach(function(e){e.getComponent(sp.Skeleton)&&(e.getComponent(sp.Skeleton).paused=!0,e.getComponent(sp.Skeleton).timeScale=0)}),(n=r.getComponent(sp.Skeleton).attachUtil).generateAllAttachedNodes(),n.getAttachedNodes("bone")[0].children.forEach(function(e){var t=e.getChildByName("HeroNode");t&&(t.getComponent(sp.Skeleton).paused=!0,t.getComponent(sp.Skeleton).timeScale=0)})),e.getChildByName("Map").children.forEach(function(e){e.getComponent(sp.Skeleton)&&(e.getComponent(sp.Skeleton).paused=!0,e.getComponent(sp.Skeleton).timeScale=0)})}function y(e){if(e.resumeAllActions(),cc.director.getScheduler().resumeTarget(e),e.getComponents(cc.Component).forEach(function(e){cc.director.getScheduler().resumeTarget(e),e instanceof sp.Skeleton&&(e.paused=!1)}),e.getChildByName("Blood")){var t=e.getChildByName("Blood").getChildByName("FightTopView");t&&t.getComponent("FightTopView").setCarryUpdate(!0)}var o=e.getChildByName("Map").getChildByName("Player1"),i=e.getChildByName("Map").getChildByName("Player2");o.children.forEach(function(e){e.getComponent(sp.Skeleton)&&(e.getComponent(sp.Skeleton).paused=!1,e.getComponent(sp.Skeleton).timeScale=1,e.childrenCount>0&&e.children.forEach(function(e){e.getComponent(sp.Skeleton)&&(e.getComponent(sp.Skeleton).paused=!1,e.getComponent(sp.Skeleton).timeScale=1)}))}),i.children.forEach(function(e){e.getComponent(sp.Skeleton)&&(e.getComponent(sp.Skeleton).paused=!1,e.getComponent(sp.Skeleton).timeScale=1,e.childrenCount>0&&e.children.forEach(function(e){e.getComponent(sp.Skeleton)&&(e.getComponent(sp.Skeleton).paused=!1,e.getComponent(sp.Skeleton).timeScale=1)}))});var a=o.getChildByName("car1");a&&((n=a.getComponent(sp.Skeleton).attachUtil).generateAllAttachedNodes(),n.getAttachedNodes("bone")[0].children.forEach(function(e){var t=e.getChildByName("HeroNode");t&&t.getComponent(sp.Skeleton)&&(t.getComponent(sp.Skeleton).paused=!1,t.getComponent(sp.Skeleton).timeScale=1)}));var n,r=e.getChildByName("Map").getChildByName("ZhanChe").getChildByName("car2");r&&(r.children.forEach(function(e){e.getComponent(sp.Skeleton)&&(e.getComponent(sp.Skeleton).paused=!1,e.getComponent(sp.Skeleton).timeScale=1)}),(n=r.getComponent(sp.Skeleton).attachUtil).generateAllAttachedNodes(),n.getAttachedNodes("bone")[0].children.forEach(function(e){var t=e.getChildByName("HeroNode");t&&t.getComponent(sp.Skeleton)&&(t.getComponent(sp.Skeleton).paused=!1,t.getComponent(sp.Skeleton).timeScale=1)})),e.getChildByName("Map").children.forEach(function(e){e.getComponent(sp.Skeleton)&&(e.getComponent(sp.Skeleton).paused=!1,e.getComponent(sp.Skeleton).timeScale=1)})}o.GuideCommand=g,o.createPveFightTask=function(e,t){return{name:"\u901a\u5173\u7b2c"+e+"\u57ce\u7b2c"+(t+1)+"\u5173",debug:!1,skip:function(){},steps:[]}},o.createClickTask=function(e,t){return void 0===t&&(t=.5),{name:"\u70b9\u51fb\u5f15\u5bfc",debug:!1,steps:[{desc:"\u70b9\u51fb"+e,command:[{cmd:i.Click,args:e}],delayTime:t}]}},o.createJinfenStep=function(e){return{name:"\u4e0a\u62a5\u6b65\u9aa4"+e,onStart:function(t){console.log("\u4e0a\u62a5\u6b65\u9aa4"+e),t()},command:[{cmd:i.CallBack,args:function(e){e()}}],onEnd:function(e){e()}}},o.sendGuideStep=function(){},o.showDialog=m,o.pauseAllChildrenSchedule=_,o.resumeAllChildrenSchedule=y,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/GuidePlotTableData":"GuidePlotTableData","../../modules/base/GameView":"GameView","../../network/ClientNetwork":"ClientNetwork","../../network/LocalMessage":"LocalMessage","../../utils/UIManager":"UIManager","../../view/guide/GuidePlot":"GuidePlot","./GuideController":"GuideController"}],GuideConst:[function(e,t,o){"use strict";cc._RF.push(t,"ac2bfvVIkRKYJV7+3OWeQrG","GuideConst"),Object.defineProperty(o,"__esModule",{value:!0}),o.default={BattleGuide:{info:"BattleGuideCfg",filename:"BattleGuideCfg",guideId:1},MatchingGuide:{info:"MatchingGuideCfg",filename:"MatchingGuideCfg",guideId:2},BattleSecondGuide:{info:"BattleSecondGuideCfg",filename:"BattleSecondGuideCfg",guideId:3}},cc._RF.pop()},{}],GuideController:[function(e,t,o){"use strict";cc._RF.push(t,"ad44eb8ugBAU6qCm9hRAdkH","GuideController");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r},r=this&&this.__awaiter||function(e,t,o,i){return new(o||(o=Promise))(function(a,n){function r(e){try{c(i.next(e))}catch(t){n(t)}}function s(e){try{c(i.throw(e))}catch(t){n(t)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(r,s)}c((i=i.apply(e,t||[])).next())})},s=this&&this.__generator||function(e,t){var o,i,a,n,r={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return n={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function s(e){return function(t){return c([e,t])}}function c(n){if(o)throw new TypeError("Generator is already executing.");for(;r;)try{if(o=1,i&&(a=2&n[0]?i.return:n[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return r.label++,{value:n[1],done:!1};case 5:r.label++,i=n[1],n=[0];continue;case 7:n=r.ops.pop(),r.trys.pop();continue;default:if(!(a=(a=r.trys).length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){r=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){r.label=n[1];break}if(6===n[0]&&r.label<a[1]){r.label=a[1],a=n;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(n);break}a[2]&&r.ops.pop(),r.trys.pop();continue}n=t.call(e,r)}catch(s){n=[6,s],i=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=e("../../network/ClientNetwork"),l=e("../../network/protocol/RoleProtocols"),d=e("../../utils/subUtils/SpineMaker"),u=e("./GuideCommand"),h=e("./GuideTrigger"),p=e("./Locator"),f=e("../../modules/base/GameView"),g=e("../../Global"),m=e("../../common/PlayerModule"),_=e("../../network/protocol/TypeProtocols"),y=cc._decorator,v=y.ccclass,C=y.property,S=function(t){function o(){var e=null!==t&&t.apply(this,arguments)||this;return e.FINGER_PREFAB=null,e.recordBtn=null,e.runningCB=null,e._task=null,e.defaultObbs=.4,e.scaleObbs=e.defaultObbs,e.offsetPos=null,e._spineLoaded=!1,e._bPauseGame=!1,e}var i;return a(o,t),i=o,Object.defineProperty(o,"Instance",{get:function(){return i._Instance},set:function(e){if(i._Instance&&!cc.sys.isNative)throw"GuideController is already created";i._Instance=e;var t=new cc.Node;t.name="guideGQNode",e.node.addChild(t)},enumerable:!1,configurable:!0}),o.Release=function(){if(i._Instance){h.default.bPassForceGuide=!0,i._Instance.passThisTask();var e=i._Instance.getComponent(h.default);e&&e.removeListens(),i._Instance.TargetNode&&i._Instance.TargetNode.off(cc.Node.EventType.TOUCH_END),cc.director.targetOff(i._Instance.node),cc.game.removePersistRootNode(i._Instance.node),i._Instance.node.destroy(),i._Instance=void 0}},o.prototype.getGuideStatus=function(){return this.node.getComponent(h.default).getGuideStatus()},Object.defineProperty(o.prototype,"TargetNode",{get:function(){return this._targetNode},set:function(e){this._targetNode=e},enumerable:!1,configurable:!0}),o.prototype.isGuiding=function(){return null!==this._task},o.prototype.isGuidingTask=function(e){return this._task&&this._task.file&&this._task.file==e},o.prototype.passThisTask=function(){i.bPassThisTask=!0,this.runningCB&&(this.runningCB(),this.runningCB=null)},o.prototype.passDialog=function(){i.bPassDialog=!0},o.prototype.onLoad=function(){console.log("GuideController onLoad"),i.Instance=this,this.node.addComponent(cc.Graphics),this.init()},o.prototype.onDestroy=function(){cc.director.targetOff(this)},o.prototype.reset=function(){console.log("GuideController reset"),i.guideIndex=0,this._task=null,this.TargetNode=null,this._bPauseGame=!1,this.resetTouchMask(),this.setBlackBgVisible(!1),this.setMaskVisible(!1),this._finger&&(this._finger.active=!1)},o.prototype.blockTouches=function(e){this.node._touchListener.setSwallowTouches(e)},o.prototype.drawNodeRect=function(e,t,o){void 0===t&&(t=(new cc.Color).fromHEX("#0000ff")),void 0===o&&(o=new cc.Vec2(0,0));var i=e.getBoundingBoxToWorld(),a=this.node.getComponent(cc.Graphics);a.lineWidth=3,a.strokeColor=t,a.rect(i.x+o.x,i.y+o.y,i.width,i.height),a.stroke()},o.prototype.clickOutside=function(){},o.prototype.setBlackBgVisible=function(){},o.prototype.setMaskVisible=function(e,t){if(void 0===t&&(t=null),this._mask.node.active=e,!0===e){this._mask._graphics.clear();var o=t.getBoundingBoxToWorld(),i=this.node.convertToNodeSpaceAR(o.origin);o.x=i.x,o.y=i.y,this._mask._graphics.fillRect(o.x,o.y,o.width,o.height)}else this._mask._graphics&&this._mask._graphics.clear()},o.prototype.init=function(){var e=this;this.node.setContentSize(cc.winSize),this.TargetNode=null,this._mask=this.node.getComponentInChildren(cc.Mask),this._mask.inverted=!0,this._mask.node.active=!1;var t=this._mask.node.getChildByName("bg"),o=cc.winSize.width/2+cc.winSize.width;t.setContentSize(cc.size(o,cc.winSize.height)),this._haloNode=this.node.getChildByName("haloNode"),this.FINGER_PREFAB&&(this._finger=cc.instantiate(this.FINGER_PREFAB),this._finger.parent=this.node,this._finger.active=!1),this.node.on(cc.Node.EventType.TOUCH_START,function(t){return e._dispatchEvent?(e.blockTouches(!1),void console.log("\u5f55\u5236\u4e2d\uff0c\u653e\u884c")):e._mask.node.active?cc.isValid(e._targetNode,!0)?void(e._targetNode.getBoundingBoxToWorld().contains(t.getLocation())?(e.blockTouches(!1),console.log("\u547d\u4e2d\u76ee\u6807\u8282\u70b9\uff0c\u653e\u884c")):(e.blockTouches(!0),console.log("\u672a\u547d\u4e2d\u76ee\u6807\u8282\u70b9\uff0c\u62e6\u622a"))):(e.blockTouches(!0),void console.log("\u76ee\u6807\u8282\u70b9\u4e0d\u5b58\u5728\uff0c\u62e6\u622a")):(e.blockTouches(!1),void console.log("\u65e0\u906e\u7f69\uff0c\u653e\u884c"))},this),this.resetTouchMask(),this.node.getChildByName("recored").on(cc.Node.EventType.TOUCH_START,this.onRecordClick,this),c.ClientNetwork.getInstance().listenProtocol(l.ROLE_CLIENT_ENUM.P_Role_SetGuide,function(t){t.resetPos();var o=new l.S_Role_SetGuide;if(o.read(t)&&0===o.errorcode){if(1==m.default.getRoleAttrValByKey(_.ROLE_ATTR_VALUES.ROLE_ATTR_GUIDE))return;e.node.getComponent(h.default).reset()}},this)},o.prototype.run=function(e){var t=this;this._task?(this.resetTouchMaskDebugColor(),i.bPassThisTask=!1,i.bPassDialog=!1,async.eachSeries(this._task.steps,function(e,o){i.guideIndex++,i.bPassThisTask?o():(e.skip_cmd=!1,t._processStep(e,o))},function(o){o?t.log("task ["+t._task.name+"] error: "+o):t.log("task ["+t._task.name+"] complete"),t._task=null,t._finger&&(t._finger.active=!1),t._mask.node.active=!1,e&&e(o)})):console.log("\u4e0a\u4e00\u6b65\u5f15\u5bfc\u5c1a\u672a\u5b8c\u6210")},o.prototype.runTaskFile=function(t,o){var i=e(t).task;this.runTask(i,o)},o.prototype.runTask=function(e,t){this._task||(this._task=e,this.run(t))},o.prototype._processStep=function(e,t){var o=this,a=this;cc.isValid(a._task)&&(a._task.hasOwnProperty("mask")?(a._mask.node.active=a._task.mask||!0,console.log("\u5b9a\u4e49\u4e86mask\u5c5e\u6027\uff0c\u503c\u4e3a",a._task.mask)):(a._mask.node.active=!0,console.log("\u672a\u5b9a\u4e49mask\u5c5e\u6027")),a.resetTouchMask(),async.series({stepStart:function(t){a.runningCB=t,e.onStart?(a.log("step ["+e.desc+"] onStart"),e.onStart(t,a)):(t(),a.runningCB=null)},stepCommand:function(t){if(e.skip_cmd||i.bPassThisTask)t();else{if(e.delayTime>0){var n=new cc.Node("shieldNode");n.zIndex=999,n.parent=o.node,0==e.delayClick&&n.addComponent(cc.BlockInputEvents),n.setContentSize(cc.winSize)}a.scheduleOnce(function(){var i=o.node.getChildByName("shieldNode");i&&i.destroy(),!e.condition||e.condition()?a._processStepCommand(e,function(e){t(e)}):t()},e.delayTime)}},taskEnd:function(t){a.runningCB=t,o.setMaskVisible(!1),o._finger.active=!1,e.onEnd&&!i.bPassThisTask?(a.log("step ["+e.desc+"] onEnd"),e.onEnd(t,o)):(t(),a.runningCB=null),e.bSendGuideEnd&&o.onSendSetGuide(o._task.guideId)}},function(o){a.resetTouchMask(),o?a.log("step ["+e.desc+"] error: "+o):a.log("step ["+e.desc+"] complete"),t(o)}))},o.prototype.fingerToNode=function(e,t,o){void 0===t&&(t=!0),void 0===o&&(o=!0),this.focusToNode(this.TargetNode)},o.prototype.updateFingerPos=function(){this.focusToNode(this.TargetNode)},o.prototype.getRealSize=function(e){for(var t=e.scaleX,o=e.scaleY,i=e.getContentSize();e.getParent();)t*=(e=e.getParent()).scaleX,o*=e.scaleY;return t<0&&(t=-t),o<0&&(o=-o),i.width*=t,i.height*=o,i},o.prototype.focusToNode=function(e){if(e&&cc.isValid(e)){if(!this._finger)return;var t=e.getBoundingBoxToWorld(),o=this._mask.node.convertToNodeSpaceAR(t.center);this.offsetPos&&(o.x+=this.offsetPos.x,o.y+=this.offsetPos.y);var i=f.default.getViewByName("BattleCardInfo");i&&i.view&&i.view.closeView(),this._haloNode.active=!0,this._haloNode.setPosition(o),this._finger.active=!0;var a=this.node.convertToNodeSpaceAR(e.parent.convertToWorldSpaceAR(e.position)),n=a.sub(this._finger.position).mag()/cc.winSize.width;n>.2&&(n=.2);var r=cc.moveTo(n,cc.v2(a.x-e.width/2,a.y+e.height/2));this._finger.runAction(r)}},o.prototype.isDebug=function(){return this._task&&this._task.debug},o.prototype.log=function(e){console.log(e)},o.prototype.error=function(e){this.isDebug()&&cc.error(e)},o.prototype._processStepCommand=function(e,t){var o=this;e.command?Array.isArray(e.command)?async.each(e.command,function(e,t){i.bPassThisTask?t():o._processCommand(e.cmd,e.args,t)},function(i){i?cc.error("step ["+e.desc+"] failed! ["+i+"]"):o.log("step ["+e.desc+"] complete"),t(i)}):this._processCommand(e.command.cmd,e.command.args,function(i){o.log("step ["+e.desc+"] complete"),t(i)}):t()},o.prototype._processCommand=function(e,t,o){var a=this;if(this.runningCB=o,1==i.bPassDialog&&u.Command.Dialogue==e)return this.log("pass dialog"),o(),void(this.runningCB=null);1==i.bPassDialog&&u.Command.Click==e&&(i.bPassDialog=!1,this.log("pass dialog end"));var n=u.GuideCommand.getFunc(e);n?n(this,t,function(){o(),a.runningCB=null}):(o(new Error("cmd ["+e+"] not exist")),this.runningCB=null)},o.prototype.find=function(e,t){var o=this,i=cc.director.getScene();p.Locator.locateNode(i,e,function(e,i){e?t(null,e):(o.log("find succeed"),t(i))})},o.prototype.getNodeFullPath=function(e){var t=[],o=e;do{t.unshift(o.name),o=o.parent}while(o&&"Canvas"!==o.name);return t.join(">")},o.prototype.isGuideNode=function(e){var t=!1,o=e;do{if(o===this.node){t=!0;break}}while(o=o.parent);return t},o.prototype.onRecordClick=function(){if(this._dispatchEvent)cc.Node.prototype.dispatchEvent=this._dispatchEvent,this._dispatchEvent=null,console.log("\u751f\u6210\u4efb\u52a1\uff1a",JSON.stringify(this._recordSteps)),this.saveForBrowser(JSON.stringify(this._recordSteps),"guideSteps");else{this._dispatchEvent=cc.Node.prototype.dispatchEvent,this._recordSteps=[];var e=this,t=Date.now();cc.Node.prototype.dispatchEvent=function(o){if(e._dispatchEvent.call(this,o),!e.isGuideNode(this)&&o.type===cc.Node.EventType.TOUCH_END){var i=Date.now(),a=(i-t)/1e3;t=i;var n=e.getNodeFullPath(this);e._recordSteps.push({desc:"\u70b9\u51fb"+n,command:{cmd:u.Command.Click,args:n},delay:a})}}}},o.prototype.saveForBrowser=function(e,t){if(cc.sys.isBrowser){var o=new Blob([e],{type:"application/json"}),i=document.createElement("a");i.download=t,i.innerHTML="Download File",null!=window.webkitURL?i.href=window.webkitURL.createObjectURL(o):(i.href=window.URL.createObjectURL(o),i.style.display="none",document.body.appendChild(i)),i.click()}},o.prototype.resetTouchMask=function(){this._mask.node.active=!1,this._haloNode.active=!1,this.stopSound()},o.prototype.showTips=function(){},o.prototype.playSound=function(){return r(this,void 0,void 0,function(){return s(this,function(){return[2]})})},o.prototype.stopSound=function(){},o.prototype.resetTouchMaskDebugColor=function(){this.isDebug()},o.prototype.getAnimate=function(e,t,o){void 0===o&&(o="idle"),cc.isValid(t)&&d.SpineMaker.createSpineV2(e,t).then(function(e){e&&e.setAnimation(0,o,!0)}.bind(this)).catch(function(e){cc.error(e)})},o.prototype.onSendSetGuide=function(e){if(1!=g.default.Instance.jumpGuide&&!(e<m.default.getRoleAttrValByKey(_.ROLE_ATTR_VALUES.ROLE_ATTR_GUIDE))){var t=new l.C_Role_SetGuide;t.guide=e,c.ClientNetwork.getInstance().Send(l.ROLE_CLIENT_ENUM.P_Role_SetGuide,t)}},o.bPassThisTask=!1,o.bPassDialog=!1,o.guideIndex=0,n([C(cc.Prefab)],o.prototype,"FINGER_PREFAB",void 0),n([C(cc.Button)],o.prototype,"recordBtn",void 0),i=n([v],o)}(cc.Component);o.default=S,cc._RF.pop()},{"../../Global":"Global","../../common/PlayerModule":"PlayerModule","../../modules/base/GameView":"GameView","../../network/ClientNetwork":"ClientNetwork","../../network/protocol/RoleProtocols":"RoleProtocols","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/subUtils/SpineMaker":"SpineMaker","./GuideCommand":"GuideCommand","./GuideTrigger":"GuideTrigger","./Locator":"Locator"}],GuideFinish:[function(e,t,o){"use strict";cc._RF.push(t,"ae64bZnJd9OipheMwDcNWSU","GuideFinish"),Object.defineProperty(o,"__esModule",{value:!0}),o.PASSNEWHANDSTEP=o.GuideFinish=void 0,function(e){e[e.GuideFinish_Min=0]="GuideFinish_Min"}(o.GuideFinish||(o.GuideFinish={})),o.PASSNEWHANDSTEP=99,cc._RF.pop()},{}],GuideLayer:[function(e,t,o){"use strict";cc._RF.push(t,"8b28c5/WstLzp0I04uyG37V","GuideLayer");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0}),o.GuideCallBack=o.NodeNameLayer=o.AutoCleanLayer=o.TAG_PLOT_MASK=o.GUIDEBRANCHSTORYPLOTTAG=o.GUIDEBUTTONPLOTTAG=o.GUIDEBUTTONTAG=o.GUIDEPLOTTAG=o.MARKLAYERRADIOVALUE=o.MAXGUIDECOUNT=o.ENDSHOWSPEED=o.BEGINSHOWSPEED=void 0;var r=e("../../Global/GameGlobal"),s=e("../../network/ClientNetwork"),c=e("../../network/protocol/ObjCollection"),l=e("./GameScheduler");o.BEGINSHOWSPEED=.025,o.ENDSHOWSPEED=.001,o.MAXGUIDECOUNT=512,o.MARKLAYERRADIOVALUE=1,o.GUIDEPLOTTAG=9001,o.GUIDEBUTTONTAG=9002,o.GUIDEBUTTONPLOTTAG=9003,o.GUIDEBRANCHSTORYPLOTTAG=9004,o.TAG_PLOT_MASK=6142;var d=cc._decorator,u=d.ccclass,h=(d.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.bDelByHide=!1,t.tag=-1,t}var o;return a(t,e),o=t,t.prototype.setTag=function(e){this.tag=e},t.prototype.getTag=function(){return this.tag},t.prototype.setVisible=function(e){this.node.active=e,this.bDelByHide&&(e?o.setDel.remove(this):o.setDel.push_front(this))},t.prototype.cleanup=function(){},t.prototype.enableDelByHide=function(){this.bDelByHide=!0},t.prototype.onDestroy=function(){s.ClientNetwork.getInstance().removeMessageTarget(this)},t.bClearPNG=!1,t.setDel=new c.ObjList,o=n([u],t)}(cc.Component));o.AutoCleanLayer=h;var p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.m_MapNode=new c.ObjMap,t}return a(t,e),t.insertClassName=function(e,o){t.m_MapClassName[o]=e},t.getClassByName=function(e){return this.m_MapClassName.forEach(function(t,o){if(o==e)return t}),null},t.isGuideLayerVisible=function(){return!1},t.isGuidePass=function(){return!0},t.isGuidePassGuideMarkButton=function(){var e=o.GUIDEBUTTONTAG.toString(),t=r.G.UIManager.getRunningScene().getChildByName(e);return!t||!t.active},t.getNodeByName=function(){return new cc.Node},t.getButtonByName=function(){return new cc.Button},t.prototype.setVisible=function(t){e.prototype.setVisible.call(this,t),t&&this.enableGuide()},t.prototype.enableGuide=function(){},t.prototype.onEnterTransitionDidFinish=function(){},t.m_MapClassName=new c.ObjMap,t.m_BEnableGuide=!0,t.m_BNext=!0,t.m_CanGuild=!1,t}(h);o.NodeNameLayer=p;var f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.m_pFunc=null,t.m_pCallObject=null,t.m_pData=null,t._scheduler=null,t}return a(t,e),t.prototype.init=function(){this._scheduler=this.addComponent(l.default)},t.prototype.setCallBackFunc=function(e,t,o){this.m_pFunc=t,this.m_pCallObject=e,this.m_pData=o},t.prototype.triggerCallBack=function(){this.m_pFunc&&this.m_pFunc()},t}(cc.Node);o.GuideCallBack=f,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../network/ClientNetwork":"ClientNetwork","../../network/protocol/ObjCollection":"ObjCollection","./GameScheduler":"GameScheduler"}],GuidePlotTableData:[function(e,t,o){"use strict";cc._RF.push(t,"0ec68WtZZdCPJYTrzyxcWAa","GuidePlotTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.GuidePlotTableData=void 0;var i=e("../TableReader"),a=function(){function e(){this.id=0,this.bLeft=!1,this.heroIcon="",this.heroSpineId=0,this.spineScale=0,this.isFlipX=!1,this.spineMove=!1,this.heroName="",this.plotInfo=new Array,this.soundStr="",this.plotPoint=""}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.bLeft=e.getBoolean(),this.heroIcon=e.getString(),this.heroSpineId=e.getNumber(),this.spineScale=e.getNumber(),this.isFlipX=e.getBoolean(),this.spineMove=e.getBoolean(),this.heroName=e.getString();for(var o=e.getString(),a=new i.TableReader(o);a.getPos()<a.getLen();){var n;n=a.getString(),this.plotInfo.push(n)}this.soundStr=e.getString(),this.plotPoint=e.getString()},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"GuidePlotTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.GuidePlotTableData=a,cc._RF.pop()},{"../TableReader":"TableReader"}],GuidePlot:[function(e,t,o){"use strict";cc._RF.push(t,"58180azAj5OKrBjSjG70vby","GuidePlot");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__awaiter||function(e,t,o,i){return new(o||(o=Promise))(function(a,n){function r(e){try{c(i.next(e))}catch(t){n(t)}}function s(e){try{c(i.throw(e))}catch(t){n(t)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(r,s)}c((i=i.apply(e,t||[])).next())})},r=this&&this.__generator||function(e,t){var o,i,a,n,r={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return n={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function s(e){return function(t){return c([e,t])}}function c(n){if(o)throw new TypeError("Generator is already executing.");for(;r;)try{if(o=1,i&&(a=2&n[0]?i.return:n[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return r.label++,{value:n[1],done:!1};case 5:r.label++,i=n[1],n=[0];continue;case 7:n=r.ops.pop(),r.trys.pop();continue;default:if(!(a=(a=r.trys).length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){r=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){r.label=n[1];break}if(6===n[0]&&r.label<a[1]){r.label=a[1],a=n;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(n);break}a[2]&&r.ops.pop(),r.trys.pop();continue}n=t.call(e,r)}catch(s){n=[6,s],i=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.GuidePlot=o.GuidePlotFont=o.GuidePlotType=void 0;var s=e("../../utils/FontsManager"),c=e("../../utils/Sound"),l=e("../../network/protocol/ObjCollection"),d=e("../../StaticData/GuidePlotTableData"),u=e("../../utils/GameUtils"),h=e("../../controller/Guide/GuideController"),p=e("../../utils/subUtils/GuideLayer"),f=e("./GuideTalk"),g=e("../../utils/subUtils/TypeDef");(function(e){e[e.GPT_NULL=0]="GPT_NULL",e[e.GPT_FIGHTOUTER=1]="GPT_FIGHTOUTER",e[e.GPT_FIGHTINSIDE=2]="GPT_FIGHTINSIDE"})(o.GuidePlotType||(o.GuidePlotType={}));var m=function(){this.info="",this.fontColor=null,this.fontSize=0};o.GuidePlotFont=m;var _=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.guideType=0,t.m_plotID=0,t.m_fShowSpeed=0,t.m_nShowSize=0,t.m_vecShowString=new Array,t.m_vecTTF=new Array,t.m_TTFPosY=0,t.m_TTFPosX=0,t.m_bNextLine=!1,t.m_FirstTTFPosX=0,t.m_pNewTalk=null,t.m_bBlackMask=!1,t.m_bStartPlot=!1,t.m_bAction=!1,t.m_strSound="",t.m_nSoundId=0,t.m_bIsHideJumpBtn=!1,t}return a(t,e),t.plotSplit=function(e,t){return e.split(t)},t.plotSplitWithForm=function(e){var t={ret:!1,strVec:[]};t.ret=!1;do{if(!e)break;var o=e;if(o.length<=0)break;var i=o.indexOf("{"),a=o.indexOf("}");if(-1==i||-1==a)break;if(i>a)break;var n=o.substr(i+1,a-i-1);if(n.length<=0)break;var r=n.indexOf("{"),s=n.indexOf("}");if(-1!=r||-1!=s)break;t.strVec=this.plotSplit(n,"/"),t.ret=!0}while(0);return t},t.plotColor3BFromString=function(e){var t=cc.color(0,0,0);do{var o=this.plotSplitWithForm(e);if(!o.ret)break;var i=o.strVec,a=parseInt(i[0]),n=parseInt(i[1]),r=parseInt(i[2]);t=cc.color(a,n,r)}while(0);return t},t.create=function(e,o,i,a,n){void 0===o&&(o=!0),void 0===i&&(i=!0),void 0===a&&(a=""),void 0===n&&(n=!1);var r=new t;return r.m_bBlackMask=o,r.m_bAction=i,r.m_strSound=a,r.m_bIsHideJumpBtn=n,r.init().then(function(){r.initData(e)}.bind(r)).catch(function(e){cc.error(e)}),r},t.getUTF8Length=function(e){for(var t=e.length,o=0,i=0;o<t;)i+=e.charCodeAt(o)>=128?2:1,o++;return i},t.getUTF8ByteByFirstChar=function(e){var t=128,o=0;if(e<t)o=1;else for(;e&t;)++o,t>>=1;return o},t.stopAllGuideSound=function(){t.setPlotSoundId.forEach(function(e){c.default.stopSound(e),t.setPlotSoundId.delete(e)})},t.prototype.init=function(){return n(this,void 0,Promise,function(){var t,o,i;return r(this,function(a){switch(a.label){case 0:return e.prototype.init.call(this),t=cc.winSize,this.m_bBlackMask,[4,u.LoadNode("ui/guide/GuideTalk")];case 1:return o=a.sent(),0==cc.isValid(this)?(o.destroy(),[2,!1]):(this.m_pNewTalk=o.getComponentInChildren(f.default),this.m_pNewTalk&&(this.addChild(o),this.m_pNewTalk.setJumpBtnCallback(this,this.jumpGuideStory),this.m_TTFPosY=this.m_pNewTalk.txt.getContentSize().height),this.setContentSize(t),(i=this.m_pNewTalk.node.parent.getChildByName("layout")).setContentSize(cc.size(t.width,t.height)),h.default.Instance.TargetNode?(i.getComponent(cc.Sprite).enabled=!1,i.active=!1):(i.getComponent(cc.Sprite).enabled=!0,i.active=!0),i.on(cc.Node.EventType.TOUCH_END,function(){if(console.log("guideplot new talk click"),!this.m_bStartPlot)return!0;if(this.m_vecShowString.length<=0)this.removeFromParent(!0),console.log("guideplot new talk click1"),this.triggerCallBack(),console.log("guideplot new talk click 2");else{for(this.m_fShowSpeed=p.ENDSHOWSPEED,this._scheduler.unschedule(this.onUpdateTTF);this.m_vecShowString.length>0;)this.onUpdateTTF(0);this.finishTTFUpdate()}return!0}.bind(this),this),[2,!0])}})})},t.prototype.initData=function(e){var t=d.GuidePlotTableData.getById(e);if(t){this.m_pNewTalk.BtnJump.node.active=!this.m_bIsHideJumpBtn,cc.winSize,this.m_nShowSize=0,this.m_pNewTalk.HeadImg.node.active=!0,t.isFlipX&&(this.m_pNewTalk.HeadImg.node.scaleX*=-1);var o=t.plotPoint.split("#");o[0]&&o[0],o[1]&&o[1],this.m_pNewTalk.bustNode.x=Number(o[0]),this.m_pNewTalk.bustNode.y=Number(o[1]),t.heroName;var i=this.m_pNewTalk.node.getParent().getComponent(cc.Animation);if(i){var a="stop",n=0;this.m_bAction&&(a="",n=.3),t.bLeft?a+="left":a+="right",i.play(a),this._scheduler.scheduleOnce(this.startPlot,n)}this.m_FirstTTFPosX=0,this.m_TTFPosX=this.m_FirstTTFPosX,this.initPlotName(e),this.initFontInfo(e)}},t.prototype.initFontInfo=function(e){var t=d.GuidePlotTableData.getById(e);if(t)for(var o=0;o!=t.plotInfo.length;++o){var i,a,n=new m,r=this.getFontSize(t.plotInfo[o]);i=r.findPos,n.fontSize=r.fontSize;var s=this.getFontColor(t.plotInfo[o]);a=s.findPos,n.fontColor=s.fontColor,n.info=this.getRealString(t.plotInfo[o],i,a),this.m_vecShowString.push(n)}},t.prototype.initPlotName=function(e){var t=d.GuidePlotTableData.getById(e);if(t){var o,i,a=new m,n=this.getFontSize(t.heroName);o=n.findPos,a.fontSize=n.fontSize;var r=this.getFontColor(t.heroName);i=r.findPos,a.fontColor=r.fontColor,a.info=this.getRealString(t.heroName,o,i),"###"==a.info&&(a.info=g.GlobalVar.getAccountName()),this.m_pNewTalk.namename.string=a.info,this.m_pNewTalk.npcNameBg.node.active=t.heroName.length>0}},t.prototype.getRealString=function(e,t,o){var i=e.length;return-1!=t&&i>t&&(i=t),-1!=o&&i>o&&(i=o),e.length!=i?e.substr(0,i):e},t.prototype.getFontColor=function(e){var o={findPos:0,fontColor:cc.color(0,0,0)};if(o.findPos=e.indexOf("<color="),-1!=o.findPos){var i=e.indexOf(">",o.findPos);if(-1!=i){var a=e.substr(o.findPos+7,i-o.findPos+7);o.fontColor=t.plotColor3BFromString(a)}}else o.fontColor=cc.color(88,73,69);return o},t.prototype.getFontSize=function(e){var t={findPos:0,fontSize:0};if(t.findPos=e.indexOf("<size="),-1!=t.findPos){var o=e.indexOf(">",t.findPos);if(-1!=o){var i=e.substr(t.findPos+6,o-t.findPos+6);t.fontSize=parseInt(i)}}else t.fontSize=20;return t},t.prototype.triggerCallBack=function(){0!=this.m_nSoundId&&(cc.audioEngine.stopEffect(this.m_nSoundId),console.log("\u5f15\u5bfc\u97f3\u6548\u79fb\u9664",this.m_nSoundId),this.m_nSoundId=0),e.prototype.triggerCallBack.call(this)},t.prototype.onUpdateTTF=function(){if(this.m_vecShowString.length<=0)this.finishTTFUpdate();else{var e=this.m_vecShowString[0].info.substr(0,1);this.m_vecShowString[0].info=this.m_vecShowString[0].info.substr(1,this.m_vecShowString[0].info.length-1);var t=this.addTTFByFontInfo(e,this.m_vecShowString[0].fontSize,this.m_vecShowString[0].fontColor,cc.v2(this.m_TTFPosX,this.m_TTFPosY));0==this.m_vecShowString[0].info.length&&this.m_vecShowString.splice(0,1),t._forceUpdateRenderData();var o=t.node.getContentSize();this.m_TTFPosX+=o.width,this.m_TTFPosX>=this.m_pNewTalk.txt.getContentSize().width+this.m_FirstTTFPosX&&(this.m_TTFPosX=this.m_FirstTTFPosX,this.m_TTFPosY=this.m_TTFPosY-o.height+16)}},t.prototype.finishTTFUpdate=function(){},t.prototype.makeTTFByStrInfo=function(e,o){var i=0,a=this.m_bNextLine,n=this.m_TTFPosY;this.m_bNextLine=!1;var r=o.indexOf("<size=");if(-1!=r){if(-1!=(d=o.indexOf(">",r))){var s=o.substr(r+6,d-(r+6));e.fontSize=parseInt(s)}}else e.fontSize=16;var c=o.indexOf("<color=");-1!=c&&-1!=(d=o.indexOf(">",c))&&(s=o.substr(c+7,d-(c+7)),e.node.color=t.plotColor3BFromString(s));var l=o.indexOf("<br=");-1!=l&&-1!=(d=o.indexOf(">",l))&&(s=o.substr(l+4,d-(l+4)),this.m_TTFPosY-=parseInt(s),this.m_bNextLine=!0);var d,u=o.indexOf("<cr=");-1!=u&&-1!=(d=o.indexOf(">",u))&&(s=o.substr(u+4,d-(u+4)),i=parseInt(s));var h=o.length;-1!=r&&h>r&&(h=r),-1!=c&&h>c&&(h=c),-1!=l&&h>l&&(h=l),-1!=u&&h>u&&(h=u),o.length!=h&&(o=o.substr(0,h)),e.string=o,a?e.node.setPosition(cc.v2(this.m_FirstTTFPosX+i,n)):e.node.setPosition(cc.v2(this.m_vecTTF[this.m_nShowSize-1].node.getPosition().x+this.m_vecTTF[this.m_nShowSize-1].node.getContentSize().width+2+i,n))},t.prototype.setPlotNodePos=function(e){this.m_pNewTalk.node.setPosition(e)},t.prototype.addTTFByFontInfo=function(e,t,o,i){var a=new cc.Node,n=a.addComponent(cc.Label);return this.m_pNewTalk.txt.addChild(a),a.width=this.m_pNewTalk.txt.width,s.FontsManager.SetDefaultFontName(n),n.string=e,n.node.color=o,n.fontSize=t,n.node.setPosition(i),n.node.setAnchorPoint(cc.v2(0,1)),n.verticalAlign=cc.Label.VerticalAlign.CENTER,n},t.prototype.startPlot=function(){if(this.m_bStartPlot=!0,this.m_strSound.length>0){t.stopAllGuideSound();var e=this;c.default.playSound(this.m_strSound,!1,function(o){e.m_nSoundId=o,console.log("\u5f15\u5bfc\u97f3\u6548:",e.m_strSound,e.m_nSoundId),t.setPlotSoundId.add(e.m_nSoundId)})}for(;this.m_vecShowString.length>0;)this.onUpdateTTF()},t.prototype.autoActionGuide=function(){if(this.m_bStartPlot)if(this.m_vecShowString.length<=0)this._scheduler.unschedule(this.autoActionGuide),this.triggerCallBack(),this.removeFromParent(!0);else{for(this.m_fShowSpeed=p.ENDSHOWSPEED,this._scheduler.unschedule(this.onUpdateTTF);this.m_vecShowString.length>0;)this.onUpdateTTF();this.finishTTFUpdate()}},t.prototype.jumpGuideStory=function(){h.default.Instance.passDialog(),this.triggerCallBack(),this.removeFromParent(!0)},t.prototype.addBg=function(){},t.setPlotSoundId=new l.ObjSet,t.TAG_PLOT=12497,t}(p.GuideCallBack);o.GuidePlot=_,cc._RF.pop()},{"../../StaticData/GuidePlotTableData":"GuidePlotTableData","../../controller/Guide/GuideController":"GuideController","../../network/protocol/ObjCollection":"ObjCollection","../../utils/FontsManager":"FontsManager","../../utils/GameUtils":"GameUtils","../../utils/Sound":"Sound","../../utils/subUtils/GuideLayer":"GuideLayer","../../utils/subUtils/TypeDef":"TypeDef","./GuideTalk":"GuideTalk"}],GuideTalk:[function(e,t,o){"use strict";cc._RF.push(t,"66772JTnz1IuIUyK77IsMnt","GuideTalk");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../utils/UIManager"),s=e("../../utils/subUtils/GuideLayer"),c=cc._decorator,l=c.ccclass,d=c.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.npcNameBg=null,t.BtnJump=null,t.HeadImg=null,t.NodeSpine=null,t.blue=null,t.btnMenu=null,t.txt=null,t.namename=null,t.bustNode=null,t.red=null,t.m_pCallBackObj=null,t.m_pfCallBackFunc=null,t}return a(t,e),t.prototype.onLoad=function(){this.node.parent.zIndex=r.GameMainLayerZorder.GMZ_NEW_TALK},t.prototype.setFlipX=function(){},t.prototype.jumpBtnClick=function(){this.m_pCallBackObj&&this.m_pfCallBackFunc&&this.m_pfCallBackFunc.call(this.m_pCallBackObj)},t.prototype.setJumpBtnCallback=function(e,t){this.m_pCallBackObj=e,this.m_pfCallBackFunc=t},n([d(cc.Sprite)],t.prototype,"npcNameBg",void 0),n([d(cc.Button)],t.prototype,"BtnJump",void 0),n([d(cc.Sprite)],t.prototype,"HeadImg",void 0),n([d(cc.Node)],t.prototype,"NodeSpine",void 0),n([d(cc.Sprite)],t.prototype,"blue",void 0),n([d(cc.Button)],t.prototype,"btnMenu",void 0),n([d(cc.Node)],t.prototype,"txt",void 0),n([d(cc.Label)],t.prototype,"namename",void 0),n([d(cc.Node)],t.prototype,"bustNode",void 0),n([l],t)}(s.NodeNameLayer);o.default=u,cc._RF.pop()},{"../../utils/UIManager":"UIManager","../../utils/subUtils/GuideLayer":"GuideLayer"}],GuideTrigger:[function(e,t,o){"use strict";cc._RF.push(t,"d2ae6wLIUFI3KU/NSxLFa7M","GuideTrigger");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0}),o.GuideData=void 0;var r,s=e("../../network/ClientNetwork"),c=e("./GuideController"),l=e("../../network/protocol/TypeProtocols"),d=e("../../network/LocalMessage"),u=e("../../common/PlayerModule"),h=e("./GuideConfig/GuideConst"),p=e("../../Global"),f=cc._decorator,g=f.ccclass;f.property,function(e){e[e.COMPLETE=1]="COMPLETE",e[e.PROTOCOL=2]="PROTOCOL"}(r||(r={}));var m=function(e,t,o){this._info=e,this._filename=t,this._rookieStep=o};o.GuideData=m;var _=function(t){function o(){var e=null!==t&&t.apply(this,arguments)||this;return e._guideRunning=!1,e._guideStatus=!1,e}var i;return a(o,t),i=o,o.prototype.reset=function(){console.log("GuideTrigger reset"),this._guideRunning=!1,this._guideStatus=!1,c.default.Instance.reset()},o.prototype.setGuideRunning=function(e){this._guideRunning=e},o.prototype.setGuideStatus=function(e){1!=p.default.Instance.jumpGuide&&(console.log("setGuideId",e),u.default.getRoleAttrValByKey(l.ROLE_ATTR_VALUES.ROLE_ATTR_GUIDE)<e[0]?this._guideStatus=!0:this._guideStatus=!1,this._guideStatus&&this.checkGuide())},o.prototype.getGuideStatus=function(){return this._guideStatus},o.prototype.onLoad=function(){var e=this;console.log("GuideTrigger onLoad"),s.ClientNetwork.getInstance().listenLocalMessage(d.LOCAL_MESSAGE.LocalMsg_START_GUIDE,function(t){e.setGuideStatus(t)},this),s.ClientNetwork.getInstance().listenLocalMessage(d.LOCAL_MESSAGE.LocalMsg_SceneLoaded,this.onSceneLoaded.bind(this),this),s.ClientNetwork.getInstance().listenLocalMessage(d.LOCAL_MESSAGE.LocalMsg_CHECK_GUIDE,this.checkGuide.bind(this),this),s.ClientNetwork.getInstance().listenLocalMessage(d.LOCAL_MESSAGE.LocalMsg_GUIDE_STOP_OUTSIDE,this.stopOutside.bind(this),this),s.ClientNetwork.getInstance().listenLocalMessage(d.LOCAL_MESSAGE.LocalMsg_GUIDE_RESET,this.reset.bind(this),this)},o.prototype.removeListens=function(){},o.prototype.stopOutside=function(){console.log("stopOutside"),i.bPassForceGuide=!0,this.setGuideRunning(!1)},o.prototype.checkGuide=function(){console.log("GuideTrigger checkGuide"),0!=this._guideStatus?this.runGuide():console.log("GuideTrigger checkGuide _guideStart false")},o.prototype.onSceneLoaded=function(){console.log("GuideTrigger onSceneLoaded"),s.ClientNetwork.getInstance().pushLocalMessage(d.LOCAL_MESSAGE.LocalMsg_GUIDE_MESSAGE)},o.prototype.runGuide=function(){var t=this;console.log("GuideTrigger runGuide"),this._guideRunning?cc.log("GuideTrigger is running..."):(this.setGuideRunning(!0),i.bPassForceGuide=!1,async.eachSeries(i._guideDatas,function(o,a){if(cc.log("guide running :%s",o._filename),i.bPassForceGuide)a(),cc.log("guide pass by bPassForceGuide :%s",o._filename);else try{var n=e(o._filename).task;t.checkSkip(n,o)?(cc.log("guide pass by checkSkip :%s",o._filename),a()):t.checkCondition(n,o)?(cc.log("guide run by checkCondition :%s",o._filename),c.default.Instance.runTask(n,function(){cc.log("guide pass by finish :%s",o._filename)})):s.ClientNetwork.getInstance().listenLocalMessage(d.LOCAL_MESSAGE.LocalMsg_GUIDE_MESSAGE,function(){t.checkCondition(n,o)&&(s.ClientNetwork.getInstance().removeLocalMessage(d.LOCAL_MESSAGE.LocalMsg_GUIDE_MESSAGE,t.node),cc.log("guide run by guide_recv_meg :%s",o._filename),c.default.Instance.runTask(n,function(){cc.log("guide pass by finish 2 :%s",o._filename),a()}))},t.node)}catch(r){a(r)}},function(e){t.setGuideRunning(!1),e&&cc.log(e)}))},o.prototype.checkSkip=function(e,t){return u.default.getRoleAttrValByKey(l.ROLE_ATTR_VALUES.ROLE_ATTR_GUIDE)>=t._rookieStep?(cc.log("guide pass by rookiestep value :%s",t._filename),!0):!(!e.skip||!e.skip())},o.prototype.checkCondition=function(e,t){return!(u.default.getRoleAttrValByKey(l.ROLE_ATTR_VALUES.ROLE_ATTR_GUIDE)+1!=t._rookieStep||e.condition&&!e.condition())},o.prototype.getPreGuide=function(e){for(var t=null,o=0,a=Array.from(i._guideDatas.entries());o<a.length;o++){var n=a[o],r=(n[0],n[1]);if(e._filename==r._filename)return t;t=r}},o.prototype.isPvePassed=function(){return!1},o.prototype.checkNoncoerciveGuide=function(t){if(this._guideRunning)cc.log("GuideTrigger is running...");else{this.setGuideRunning(!0);try{var o=e(t).task;o.id?c.default.Instance.runTask(o,function(){!o.auto_finish||o.auto_finish}):c.default.Instance.runTask(o)}catch(i){cc.log(i)}finally{this.setGuideRunning(!1)}}},o.bPassForceGuide=!1,o._guideDatas=[new m(h.default.BattleGuide.info,h.default.BattleGuide.filename,h.default.BattleGuide.guideId),new m(h.default.MatchingGuide.info,h.default.MatchingGuide.filename,h.default.MatchingGuide.guideId),new m(h.default.BattleSecondGuide.info,h.default.BattleSecondGuide.filename,h.default.BattleSecondGuide.guideId)],i=n([g],o)}(cc.Component);o.default=_,cc._RF.pop()},{"../../Global":"Global","../../common/PlayerModule":"PlayerModule","../../network/ClientNetwork":"ClientNetwork","../../network/LocalMessage":"LocalMessage","../../network/protocol/TypeProtocols":"TypeProtocols","./GuideConfig/GuideConst":"GuideConst","./GuideController":"GuideController"}],Guide:[function(e,t,o){"use strict";cc._RF.push(t,"1bd10YP7hVANZmR2x81C3/C","Guide");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../network/ClientNetwork"),s=e("../../network/LocalMessage"),c=cc._decorator,l=c.ccclass,d=(c.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.onLoad=function(){console.log("Guide onLoad");var e=this.node.getComponentInChildren(cc.Button);e.node.on("click",this.testButtonCallback,this),e.node.active=!1},t.prototype.testButtonCallback=function(){console.log("testButtonCallback"),r.ClientNetwork.getInstance().pushLocalMessage(s.LOCAL_MESSAGE.LocalMsg_START_GUIDE,!0)},n([l],t)}(cc.Component));o.default=d,cc._RF.pop()},{"../../network/ClientNetwork":"ClientNetwork","../../network/LocalMessage":"LocalMessage"}],H5Utils:[function(e,t,o){"use strict";cc._RF.push(t,"7f68eOyVHlM/pdTe4RM7VGF","H5Utils"),Object.defineProperty(o,"__esModule",{value:!0}),o.H5Utils=o.KSPostEventType=o.UcPostEventType=o.BiliPostEventType=o.FeishuPostEventType=o.ShareType=void 0;var i=e("../Global/GameGlobal"),a=e("../network/ClientNetwork"),n=e("../network/LocalMessage"),r=e("./GamePlatform"),s=e("./GameUtils"),c=e("./subUtils/TypeDef"),l=e("../model/ServerAddrInfo");(function(e){e[e.InviteFriend=0]="InviteFriend",e[e.BattleRoom=1]="BattleRoom"})(o.ShareType||(o.ShareType={})),function(e){e.Active_Type="0",e.Active_Register_Type="1",e.Active_Pay_Type="2",e.Next_Day_Open="6",e.Game_Addiction="25"}(o.FeishuPostEventType||(o.FeishuPostEventType={})),function(e){e.APP_FIRST_ACTIVE="APP_FIRST_ACTIVE",e.FORM_SUBMIT="FORM_SUBMIT",e.USER_COST="USER_COST",e.RETENTION="RETENTION",e.ACTION_VALID="ACTION_VALID"}(o.BiliPostEventType||(o.BiliPostEventType={})),function(e){e[e.APP_FIRST_ACTIVE=1]="APP_FIRST_ACTIVE",e[e.FORM_SUBMIT=27]="FORM_SUBMIT",e[e.USER_COST=1e3]="USER_COST",e[e.RETENTION=1001]="RETENTION"}(o.UcPostEventType||(o.UcPostEventType={})),function(e){e[e.APP_FIRST_ACTIVE=1]="APP_FIRST_ACTIVE",e[e.FORM_SUBMIT=2]="FORM_SUBMIT",e[e.USER_COST=3]="USER_COST",e[e.RETENTION=7]="RETENTION",e[e.ACTION_VALID=84]="ACTION_VALID"}(o.KSPostEventType||(o.KSPostEventType={}));var d=function(){function e(){this.m_nPlatformOS=1,this.m_strEncryptedData="",this.m_strIv="",this.gameOpenLink="",this.m_weichatLoginData=null,this.m_gameClubBtn=null,this.m_syncLiveTime=null,this.m_bFeishuConversion=!1,this.m_click_auth=!1,this.m_wxShareVideoBtn=null,this.m_wxVideoRecordTime=0,this.m_isClickVideoRecord=!1,this.m_isRecording=!1}return e.getInstance=function(){return this.Instance||(this.Instance=new e),this.Instance},e.prototype.getWechatLoginData=function(){return this.m_weichatLoginData},e.prototype.getGameOpenLink=function(){return this.gameOpenLink},e.prototype.getWechatOS=function(){return this.m_nPlatformOS},e.prototype.tgH5Init=function(){console.log("H5Utils, tgInit!");var e=this;TGESDK.tginit({},function(t){console.log("tginit===========================================",t),t.status?(console.log("tginit true"),console.log("lastLoginGroup==========================11111========="),TGESDK.login({appver:1,serverId:1,serverName:"",flag:0},function(e){if(console.log("first TGESDK.login",e),e.status){s.setLocalData("token",e.info.token),s.setLocalData("uid",e.info.uid),console.log("uid==================",e.info.uid);var t="";t="miyaIosH5"==r.GamePlatform.getMiYaVideoTypeNoSet()?"https://mszcs1.gameserver.iplay11g.com/gmsys/weblogic/webc/miyaservergroup.php":"https://mszcappphp.gameserver.iplay11g.com/gmsys/weblogic/webc/miyaservergroup.php",t+="?",t+="&open_id="+e.info.uid,t+="&extjson=",console.log("servergroup miya loginCallBack url="+t);var o=new XMLHttpRequest;o.onreadystatechange=function(){if(console.log("xMLHttpRequest.readyState===1==============",o.readyState,"xMLHttpRequest.status=====================",o.status),4==o.readyState&&o.status>=200&&o.status<400){var e=o.responseText.toString(),t=JSON.parse(e);console.log("servergroup MiYaLoginCallBack",e),l.ServerAddrInfo.getInstance().initServerList(t.servers);var i=l.ServerAddrInfo.getInstance().getLastLoginServerInfo();console.log("lastLoginGroup====================111",i),i&&(console.log("lastLoginGroup==================================="),l.ServerAddrInfo.getInstance().getServerInfoByGroupId(i.groupId)),a.ClientNetwork.getInstance().pushLocalMessage(n.LOCAL_MESSAGE.LocalMsg_SDK_LoginRet,{error:0})}},o.open("GET",t,!0),o.send()}else console.log("first TGESDK.login  flag 0 fail"),a.ClientNetwork.getInstance().pushLocalMessage(n.LOCAL_MESSAGE.LocalMsg_SDK_LoginRet,{error:-3}),i.G.StringManager.PopStringOnce("\u767b\u5f55\u5931\u8d25......")})):(console.log("tginit false"),i.G.StringManager.PopStringOnce("\u521d\u59cb\u5316\u5931\u8d25......"),e.tgH5Init())})},e.prototype.startLogin=function(){var e=c.GlobalVar.getServerURL();if(e&&e.length>0)a.ClientNetwork.getInstance().Connect(e),console.log("bigblue h5smallbag enterbtnclick");else{var t=c.GlobalVar.getServerGroup(),o=l.ServerAddrInfo.getInstance().getServerInfoByGroupId(t);console.log("startLogin===========================================",t,"-----",o.name);var i={appver:1,serverId:t,serverName:o.name,flag:1};TGESDK.login(i,function(e){console.log("second TGESDK.login",e),e.status?(s.setLocalData("token",e.info.token),s.setLocalData("uid",e.info.uid),l.ServerAddrInfo.getInstance().requestMiYaServer()):console.log("second TGESDK.login fail")})}},e.Instance=null,e}();o.H5Utils=d,cc._RF.pop()},{"../Global/GameGlobal":"GameGlobal","../model/ServerAddrInfo":"ServerAddrInfo","../network/ClientNetwork":"ClientNetwork","../network/LocalMessage":"LocalMessage","./GamePlatform":"GamePlatform","./GameUtils":"GameUtils","./subUtils/TypeDef":"TypeDef"}],HeroBubbleTableData:[function(e,t,o){"use strict";cc._RF.push(t,"e6803j78eNEkJDFZnK+ErBe","HeroBubbleTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.HeroBubbleTableData=void 0;var i=e("../TableReader"),a=function(){function e(){this.id=0,this.heroId=0,this.contents=new Array}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.heroId=e.getNumber();for(var o=e.getString(),a=new i.TableReader(o);a.getPos()<a.getLen();){var n;n=a.getString(),this.contents.push(n)}},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"HeroBubbleTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.HeroBubbleTableData=a,cc._RF.pop()},{"../TableReader":"TableReader"}],HeroCardEditTabView:[function(e,t,o){"use strict";cc._RF.push(t,"cc33eEN3j5Me7ms7+WNHmWd","HeroCardEditTabView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=e("../../Global/GameGlobal"),l=e("../../network/ClientNetwork"),d=e("../../network/protocol/RoleProtocols"),u=e("../../common/PlayerModule"),h=cc._decorator,p=h.ccclass,f=h.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.m_EditBoxNode=null,t}return a(t,e),t.path=function(){return"ui/heroCardBag/prefab/card_tab_edit"},t.prototype.start=function(){var e=this;l.ClientNetwork.getInstance().listenProtocol(d.ROLE_CLIENT_ENUM.P_Role_SetBattleArrayName,function(t){t.resetPos();var o=new d.S_Role_SetBattleArrayName;o.read(t)&&(0==o.errorcode?e.closeView():1==o.errorcode?c.G.StringManager.PopString("\u5361\u7ec4ID\u9519\u8bef!"):2==o.errorcode&&c.G.StringManager.PopString("\u540d\u79f0\u4e0d\u5408\u6cd5\u6216\u542b\u6709\u975e\u6cd5\u5b57\u7b26!"))},this)},t.prototype.onClickConfirmCallBack=function(){if(this.m_EditBoxNode.string.length<=0)return c.G.StringManager.PopString("\u8bf7\u8f93\u5165\u65b0\u540d\u5b57!");if(this.m_EditBoxNode.string.length>2)return c.G.StringManager.PopString("\u9875\u7b7e\u540d\u5b57\u6700\u591a2\u4e2a\u5b57!");var e=new d.C_Role_SetBattleArrayName;e.battleArrayIndex=u.default.fightHeroArrayIndex+1,e.battleArrayName=this.m_EditBoxNode.string,l.ClientNetwork.getInstance().Send(d.ROLE_CLIENT_ENUM.P_Role_SetBattleArrayName,e)},n([f(cc.EditBox)],t.prototype,"m_EditBoxNode",void 0),n([s.Register_Class,p],t)}(r.default);o.default=g,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../network/ClientNetwork":"ClientNetwork","../../network/protocol/RoleProtocols":"RoleProtocols"}],HeroCardInfoView:[function(e,t,o){"use strict";cc._RF.push(t,"49296x2UdRKkaDxYkUK5STP","HeroCardInfoView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../utils/ConfigUtils"),c=e("../../modules/base/Decorators"),l=e("../../utils/ResourcesManager"),d=e("../../utils/ConstValue"),u=e("../../utils/LogUtil"),h=e("../../common/PlayerModule"),p=e("../../modules/manager/LoadResManager"),f=e("../../network/ClientNetwork"),g=e("../../network/protocol/RoleProtocols"),m=e("../../Global/GameGlobal"),_=e("../../modules/base/GameView"),y=e("../../utils/GameUtils"),v=e("../../StaticData/ProficiencyTableData"),C=e("../../utils/GamePlatform"),S=e("../../common/CommandValue"),T=e("./HeroSkinUtils"),I=e("../../network/LocalMessage"),N=cc._decorator,b=N.ccclass,w=N.property,E=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.scroview=null,t.upgradeScroview=null,t.hero=null,t.heroColor=null,t.heroName=null,t.heroLv=null,t.heroQualityImg=null,t.prof1=null,t.skillName=null,t.skillIcon=null,t.skilldesc=null,t.passsiveSkillName=null,t.passsiveSkilldesc=null,t.passsiveSkillIcon=null,t.maxPasssiveSkilldesc=null,t.cardsAttrfab=null,t.btnWnd=null,t.proBar=null,t.parImg=null,t.proBarNum=null,t.profImage=null,t.heroDescribe=null,t.upgradeTalentfab=null,t.btn_skin=null,t.id=0,t.templateId=0,t._loadAssetArr=[],t._hpPopupNode=null,t}return a(t,e),t.path=function(){return"ui/heroCardBag/prefab/CardInfo"},t.prototype.start=function(){var e=this;f.ClientNetwork.getInstance().listenLocalMessage(I.LOCAL_MESSAGE.LocalMsg_heroSkin_changed,function(){e.freshHeroSkin(),e.showCardAttr()},this),f.ClientNetwork.getInstance().listenLocalMessage(I.LOCAL_MESSAGE.LocalMsg_RefreshRedDot_heroSkin,function(){e.refreshHeroSkinRedpoint()},this),p.default.loadPrefab("ui/CommonPrefab/TopView").then(function(t){t.parent=e.node,t.getChildByName("goldDiamondContent").getChildByName("diamondbg").active=!1,t.getChildByName("goldDiamondContent").getChildByName("hpbg").active=!0;var o=t.getChildByName("goldDiamondContent").getChildByName("hpPopup");e._hpPopupNode=o,e._topViewNode=t,t.getChildByName("goldDiamondContent").getChildByName("emoguobg").active=h.default.getItemCountByBag(1012)>0,e.onRefreshCarHpInfo(),t.getComponent("TopView").bindExitEvent(function(){e._cardBag.node.active=!0,e.closeView()}),t.name="TopView"}).catch(function(e){u.default.info(e)}),this.node.on(cc.Node.EventType.TOUCH_START,function(t){if(e._hpPopupNode){var o=e._hpPopupNode.parent.getChildByName("hpbg").getBoundingBoxToWorld().contains(t.getLocation());e._hpPopupNode.getBoundingBoxToWorld().contains(t.getLocation())||o||(e._hpPopupNode.active=!1)}})},t.prototype.onRefreshCarHpInfo=function(){var e=0;h.default.getHeroCarData().forEach(function(t){if(1==t.bHeroLock){var o=s.default.getInstance().getHeroConfig(t.heroId).npc_id,i=s.default.getInstance().getNpcTemplateConfig(o,t.heroLevel).carhp;e+=i}});var t=s.default.getInstance().getCarConfig(1);if(this._hpPopupNode){this._hpPopupNode.getChildByName("hp_number2").getComponent(cc.Label).string=e.toString(),t&&(this._hpPopupNode.getChildByName("hp_number1").getComponent(cc.Label).string=t.ini_hp);var o=this._topViewNode.getChildByName("goldDiamondContent");if(o){var i=o.getChildByName("hpbg");i&&(i.getChildByName("hp_number").getComponent(cc.Label).string=e+t.ini_hp)}}return Number(e+t.ini_hp)},t.prototype.init=function(e){var t=this;this.initlistenLocalMessage(),this._cardBag=e.cardBag,this._cardBag.node.active=!1,this.id=e.id;var o=s.default.getInstance().getHeroConfig(this.id);this.templateId=s.default.getInstance().getHeroConfig(this.id).npc_id,l.default.loadSprite("ui/bag/img/a"+o.hero_color,this.heroColor,function(e){e.addRef(),t._loadAssetArr.push(e)}),l.default.loadSprite("ui/bag/img/bar"+o.hero_color,this.parImg,function(e){e.addRef(),t._loadAssetArr.push(e)}),l.default.loadSprite("ui/bag/img/"+o.hero_color+"b",this.heroQualityImg,function(e){e.addRef(),t._loadAssetArr.push(e)}),l.default.loadSprite(o.skill_icon,this.skillIcon,function(e){e.addRef(),t._loadAssetArr.push(e)}),l.default.loadSprite(o.passive_icon,this.passsiveSkillIcon,function(e){e.addRef(),t._loadAssetArr.push(e)}),this.heroName.string=o.name,this.skillName.string=o.skill_name,this.passsiveSkillName.string=o.passive_name,this.passsiveSkilldesc.string=o.passive_desc,this.maxPasssiveSkilldesc.string=o.passive_desc2,this.prof1.string=["\u6218\u58eb","\u730e\u4eba","\u6cd5\u5e08","\u7267\u5e08","\u53ec\u5524","\u7cbe\u7075","\u718a\u732b","\u5de5\u7a0b","\u672f\u58eb"][o.occupation-1],l.default.loadSprite("ui/bag/img/prof"+o.hero_color,this.profImage.getComponent(cc.Sprite),function(e){e.addRef(),t._loadAssetArr.push(e)}),l.default.loadSprite("ui/bag/img/"+["zhanshi","lieshou","fashi","mushi","zhaohuan","jingling","xiongmao","gongcheng","renzhe"][o.occupation-1],this.profImage.getChildByName("ProSprite").getComponent(cc.Sprite),function(e){e.addRef(),t._loadAssetArr.push(e)}),this.refreshHeroView(),this.showCardAttr(),this.heroDescribe.string=o.hero_desc,this.onShowUpgradeTalentInfo(),1==this.checkIsUpgrade()?(this.onUpgradePanelCallBack(),this.node.getChildByName("HeroStatus").getChildByName("ToggleContainer").children[1].getComponent(cc.Toggle).isChecked=!0):this.onAttributePanelCallBack();var i=this.node.getChildByName("proficiencyNode");if(i){var a=h.default.getHeroProficiencyDataById(this.id);if(a){i.getChildByName("proficiencyIcon").children[0].active=this.checkIsShare(this.id),i.active=!0;var n=y.getProficiencyIcon(a.proficiency),r=i.getChildByName("proficiencyIcon").getComponent(cc.Sprite);l.default.loadSprite(n.data.icon,r,function(e){e.addRef(),t._loadAssetArr.push(e)}),i&&i.on(cc.Node.EventType.TOUCH_START,function(){t.onProficiencyCallBack(n.lv,n.data)})}}o.hero_color>=3?this.btn_skin.active=!0:this.btn_skin.active=!1,this.freshHeroSkin(),this.refreshHeroSkinRedpoint()},t.prototype.refreshHeroSkinRedpoint=function(){var e=T.default.Instance.getHeroSkinRedPointBy(!1,this.id);this.btn_skin.getChildByName("redPoint").active=e},t.prototype.getNpcTemplateId=function(){var e=0,t=h.default.getHeroCarData();t[this.id]&&(e=t[this.id].heroUUId);var o=T.default.Instance.getCurSkinIdByHeroUUID(e),i=s.default.getInstance().getHeroConfig(this.id);return 0==o?i.npc_id:1e4*o+this.id},t.prototype.freshHeroSkin=function(){var e=this,t=this.getNpcTemplateId(),o=s.default.getInstance().getNpcTemplateConfig(t,1).res_id,i=s.default.getInstance().getResConfig(o).uiScale;l.default.loadSpine(s.default.getInstance().getResConfig(o).animation,function(t){e.hero&&(e.hero.removeAllChildren(),t.parent=e.hero,t.scale=t.scale*i/100,t.getComponent(sp.Skeleton).setAnimation(0,"idle",!0),l.default.pushReleaseAssets(0,{path:s.default.getInstance().getResConfig(o).animation,resType:cc.SpriteFrame}),l.default.pushReleaseAssets(0,{path:s.default.getInstance().getResConfig(o).animation,resType:cc.Texture2D}),l.default.pushReleaseAssets(0,{path:s.default.getInstance().getResConfig(o).animation,resType:sp.SkeletonData}))})},t.prototype.initLockInfo=function(){var e=this,t=h.default.getHeroCarData(),o=this.node.getChildByName("HeroStatus").getChildByName("Use_Btn");if(!0===t[this.id].bHeroLock){this.btnWnd.active=!0,o.active=!0;var i=!1,a=h.default.fightHeroArrayIndex;h.default.getBattleHeroCarData(a).forEach(function(t){t.heroId==e.id&&(i=!0)}),i&&(o.active=!1)}else this.btnWnd.active=!1,o.active=!1},t.prototype.showCardAttr=function(){this.scroview.content.removeAllChildren();var e=this.getNpcTemplateId(),t=h.default.getHeroCarData(),o=1;t[this.id]&&(o=t[this.id].heroLevel);for(var i=s.default.getInstance().getNpcTemplateConfig(e,o),a=s.default.getInstance().getHeroConfig(this.id).occupation,n=s.default.getInstance().getSkillConfig(i.skill_id),r=i.carhp,c=[i.attack,d.cardProfDesc[a],n.cd/1e3+"\u79d2/\u6b21",r],l=0;l<c.length;l++){var u=cc.instantiate(this.cardsAttrfab);u&&(this.setCarAttrInfo(c[l],u,l),this.scroview.content.addChild(u))}this.skilldesc.string=n.skill_desc},t.prototype.setCarAttrInfo=function(e,t,o){var i=this;t.getChildByName("bgSprite").getComponent(cc.Sprite).enabled=!0;var a="ui/card_attricon/"+(o+1),n=t.getChildByName("icon").getComponent(cc.Sprite);l.default.loadSprite(a,n,function(e){e.addRef(),i._loadAssetArr.push(e)}),t.getChildByName("type").getComponent(cc.Label).string=d.cardDescArry[o],t.getChildByName("num").getComponent(cc.Label).string=e,t.getChildByName("num").y+=5},t.prototype.onShowUpgradeTalentInfo=function(){var e=this;this.upgradeScroview.content.removeAllChildren();for(var t=s.default.getInstance().getHeroTalentTableDataCfg(),o=[],i=0,a=Object.keys(t);i<a.length;i++){var n=a[i];t.hasOwnProperty(n)&&t[n].heroId==this.id&&o.push(t[n])}o.length>4?this.upgradeScroview.content.getComponent(cc.Layout).spacingY=30:this.upgradeScroview.content.getComponent(cc.Layout).spacingY=40,o.forEach(function(t){var o=cc.instantiate(e.upgradeTalentfab);o.active=!0,o.parent=e.upgradeScroview.content,o.getChildByName("levelbg").getChildByName("Hero_level").getComponent(cc.Label).string=t.level;var i="";Number(e.heroLv.string)>=t.level?(i="ui/bag/img/"+s.default.getInstance().getHeroConfig(e.id).hero_color+"b",o.getChildByName("lvup_Desc").getComponent(cc.RichText).string="<outline color=black width=2> <color=#F5E6AB>"+t.name+"\uff1a</c><color=#22FF29>"+t.describe+"</color>"):(i="ui/bag/img/0b",o.getChildByName("lvup_Desc").getComponent(cc.RichText).string="<outline color=black width=2> <color=#F5E6AB>"+t.name+"\uff1a</c><color=#FFFFFF>"+t.describe+"</color>"),l.default.loadSprite(i,o.getChildByName("levelbg").getComponent(cc.Sprite),function(t){t.addRef(),e._loadAssetArr.push(t)})})},t.prototype.onUseBtn=function(){this._cardBag.node.active=!0,this._cardBag.onHeroCardBattle(this.id),_.default.getViewByName("HeroCardInfoView").view.node.active=!1,this.node.parent.getChildByName("UI_Mask_HeroCardInfoView").active=!1,this.node.parent.getChildByName("UI_Mask_HeroCardsMainView").active=!0},t.prototype.onClose=function(){this.node.active=!1},t.prototype.onUpLevelBtn=function(){var e=0,t=h.default.getHeroCarData();if(t[this.id]&&(e=t[this.id].heroUUId),e<=0)return m.G.StringManager.PopString(s.default.getInstance().getStringValueCfg(3).string_value);var o=s.default.getInstance().getHeroConfig(this.id).npc_id,i=s.default.getInstance().getNpcTemplateConfig(o,t[this.id].heroLevel).up_res.split("|"),a=h.default.getGoldNum();if(Number(i[1].split("#")[1])>a)return m.G.StringManager.PopString(s.default.getInstance().getStringValueCfg(4).string_value);var n=i[0].split("#");if(h.default.getItemCountByBag(Number(n[0]))<Number(n[1]))return m.G.StringManager.PopString(s.default.getInstance().getStringValueCfg(6).string_value);if(i[2]){var r=i[2].split("#");if(h.default.getItemCountByBag(Number(r[0]))<Number(r[1]))return m.G.StringManager.PopString("\u6076\u9b54\u679c\u6570\u91cf\u4e0d\u8db3\uff01")}var c=new g.C_Role_HeroLevelUp;c.itemUUID=e,f.ClientNetwork.getInstance().Send(g.ROLE_CLIENT_ENUM.P_Role_HeroLevelUp,c)},t.prototype.refreshHeroView=function(){var e=this,t=h.default.getHeroCarData()[this.id].heroLevel;this.heroLv.string=t;var o=s.default.getInstance().getNpcTemplateConfig(this.templateId,t).up_res.split("|"),i=o[0].split("#"),a=h.default.getItemCountByBag(Number(i[0])),n=Number(i[1]);if(this.proBar.progress=a/n,this.proBarNum.string=a+"/"+n,this.btnWnd.getChildByName("Up_const_wnd").getChildByName("Const_num").getComponent(cc.Label).string=o[1].split("#")[1],o[2]){var r=this.btnWnd.getChildByName("Up_const_wnd").children[2],c=s.default.getInstance().getItemByID(o[2].split("#")[0]);l.default.loadSprite(c.icon,r.getComponent(cc.Sprite)),this.btnWnd.getChildByName("Up_const_wnd").getChildByName("Const2_num").getComponent(cc.Label).string=o[2].split("#")[1],this.btnWnd.getChildByName("Up_const_wnd").children[2].active=!0,this.btnWnd.getChildByName("Up_const_wnd").children[3].active=!0,this.btnWnd.getChildByName("Up_const_wnd").children[0].x=-20,this.btnWnd.getChildByName("Up_const_wnd").children[1].x=-2}else this.btnWnd.getChildByName("Up_const_wnd").children[2].active=!1,this.btnWnd.getChildByName("Up_const_wnd").children[3].active=!1,this.btnWnd.getChildByName("Up_const_wnd").children[0].x=30,this.btnWnd.getChildByName("Up_const_wnd").children[1].x=50;this.showCardAttr(),this.onShowUpgradeTalentInfo(),s.default.getInstance().getNpcTemplateConfig(this.templateId,t+1)||(this.node.getChildByName("HeroStatus").getChildByName("ProgressBar").active=!1,this.node.getChildByName("HeroStatus").getChildByName("levelbg").active=!1,this.node.getChildByName("HeroStatus").getChildByName("Btn_Wnd").active=!1,this.node.getChildByName("HeroStatus").getChildByName("Use_Btn").active=!1,this.node.getChildByName("HeroStatus").getChildByName("maxLevelNode").active=!0),this.node.getChildByName("HeroStatus").getChildByName("ToggleContainer").children[1].getChildByName("redPoint").active=this.checkIsUpgrade(),1==this.node.getChildByName("HeroStatus").getChildByName("maxLevelNode").active&&(this.node.getChildByName("HeroStatus").getChildByName("ToggleContainer").children[1].getChildByName("redPoint").active=!1);for(var d=s.default.getInstance().getHeroTalentTableDataCfg(),u=[],p=0,f=Object.keys(d);p<f.length;p++){var g=f[p];d.hasOwnProperty(g)&&d[g].heroId==this.id&&u.push(d[g])}u.forEach(function(t){Number(e.heroLv.string)>=t.level&&(e.passsiveSkilldesc.string=t.passiveSkilldesc,e.maxPasssiveSkilldesc.string=t.maxPassiveSkilldesc)}),this.node.getChildByName("TopView")&&(this.node.getChildByName("TopView").getChildByName("goldDiamondContent").getChildByName("emoguobg").active=h.default.getItemCountByBag(1012)>0)},t.prototype.onAttributePanelCallBack=function(){var e=this;if(0==this.scroview.node.active){this.scroview.node.active=!0,this.upgradeScroview.node.active=!1;var t=this.node.getChildByName("HeroStatus").getChildByName("Use_Btn");if(t.active=!0,this.node.getChildByName("HeroStatus").getChildByName("Btn_Wnd").active=!1,this.node.getChildByName("HeroStatus").getChildByName("levelbg").active=!1,this.node.getChildByName("HeroStatus").getChildByName("ProgressBar").active=!1,!0===h.default.getHeroCarData()[this.id].bHeroLock){var o=!1,i=h.default.fightHeroArrayIndex;h.default.getBattleHeroCarData(i).forEach(function(t){t.heroId==e.id&&(o=!0)}),o&&(t.active=!1)}else t.active=!1;this.node.getChildByName("HeroStatus").getChildByName("maxLevelNode").active=!1}},t.prototype.onUpgradePanelCallBack=function(){if(0==this.upgradeScroview.node.active){this.scroview.node.active=!1,this.upgradeScroview.node.active=!0,this.node.getChildByName("HeroStatus").getChildByName("Use_Btn").active=!1;var e=h.default.getHeroCarData(),t=e[this.id].heroLevel;if(!s.default.getInstance().getNpcTemplateConfig(this.templateId,t+1))return void(this.node.getChildByName("HeroStatus").getChildByName("maxLevelNode").active=!0);this.node.getChildByName("HeroStatus").getChildByName("maxLevelNode").active=!1;var o=this.node.getChildByName("HeroStatus").getChildByName("Btn_Wnd");o.active=!0,this.node.getChildByName("HeroStatus").getChildByName("levelbg").active=!0,this.node.getChildByName("HeroStatus").getChildByName("ProgressBar").active=!0,!1===e[this.id].bHeroLock&&(o.active=!1)}},t.prototype.initlistenLocalMessage=function(){f.ClientNetwork.getInstance().listenProtocol(g.ROLE_CLIENT_ENUM.P_Role_HeroLevelUp,function(e){e.resetPos();var t=new g.S_Role_HeroLevelUp;if(t.read(e))if(0===t.errorcode){_.default.addPopView("BaseCtrl","CardUpgrade","CardUpgrade",{id:this.id}),this.refreshHeroView(),this._cardBag.upgradeRefreshCarfInfo(this.id);var o=this.onRefreshCarHpInfo();this.SendCarHpToServer(o)}else m.G.StringManager.PopString(s.default.getInstance().getStringValueCfg(5).string_value)},this)},t.prototype.checkIsUpgrade=function(){var e=0,t=h.default.getHeroCarData();if(t[this.id]&&(e=t[this.id].heroUUId),e<=0)return!1;var o=s.default.getInstance().getHeroConfig(this.id).npc_id,i=s.default.getInstance().getNpcTemplateConfig(o,t[this.id].heroLevel).up_res.split("|"),a=h.default.getGoldNum();if(Number(i[1].split("#")[1])>a)return!1;var n=i[0].split("#");if(h.default.getItemCountByBag(Number(n[0]))<Number(n[1]))return!1;if(i[2]){var r=i[2].split("#");if(h.default.getItemCountByBag(Number(r[0]))<Number(r[1]))return!1}return!0},t.prototype.onProficiencyCallBack=function(e,t){_.default.addPopView("BaseCtrl","ProficiencyHelp","ProficiencyHelp",{ProficiencyLv:e,ProficiencyData:t,heroId:this.id})},t.prototype.checkIsShare=function(e){if(0==h.default.checkModulerOnOffState(S.ModulerViewOnOff.ProficiencyShare))return!1;if(C.GamePlatform.isWechat()){var t=h.default.getHeroProficiencyDataById(e);if(t){var o=0;if(v.ProficiencyTableData.getDataMap().forEach(function(e){t.proficiency>=e.minProficiency&&t.proficiency<=e.maxProficiency&&(o=e.id)}),o>=Number(y.getConfigIntValue("proficiency_share_level_num")))return 1!=t.shareData.has(o)||1!=t.shareData.get(o)}}return!1},t.prototype.SendCarHpToServer=function(e){var t=new g.C_Role_SendCarHpToServer;t.carHp=e,f.ClientNetwork.getInstance().Send(g.ROLE_CLIENT_ENUM.P_Role_SendCarHpToServer,t)},t.prototype.onClickBtnSkin=function(){var e=0,t=h.default.getHeroCarData();t[this.id]&&(e=t[this.id].heroUUId),_.default.addPopView("BaseCtrl","HeroSkinView","HeroSkinView",{heroUUID:e,heroID:this.id}),T.default.Instance.removeSkinItemRedPoint(this.id)},t.prototype.onDestroy=function(){},n([w(cc.ScrollView)],t.prototype,"scroview",void 0),n([w(cc.ScrollView)],t.prototype,"upgradeScroview",void 0),n([w(cc.Node)],t.prototype,"hero",void 0),n([w(cc.Sprite)],t.prototype,"heroColor",void 0),n([w(cc.Label)],t.prototype,"heroName",void 0),n([w(cc.Label)],t.prototype,"heroLv",void 0),n([w(cc.Sprite)],t.prototype,"heroQualityImg",void 0),n([w(cc.Label)],t.prototype,"prof1",void 0),n([w(cc.Label)],t.prototype,"skillName",void 0),n([w(cc.Sprite)],t.prototype,"skillIcon",void 0),n([w(cc.Label)],t.prototype,"skilldesc",void 0),n([w(cc.Label)],t.prototype,"passsiveSkillName",void 0),n([w(cc.Label)],t.prototype,"passsiveSkilldesc",void 0),n([w(cc.Sprite)],t.prototype,"passsiveSkillIcon",void 0),n([w(cc.Label)],t.prototype,"maxPasssiveSkilldesc",void 0),n([w(cc.Prefab)],t.prototype,"cardsAttrfab",void 0),n([w(cc.Node)],t.prototype,"btnWnd",void 0),n([w(cc.ProgressBar)],t.prototype,"proBar",void 0),n([w(cc.Sprite)],t.prototype,"parImg",void 0),n([w(cc.Label)],t.prototype,"proBarNum",void 0),n([w(cc.Node)],t.prototype,"profImage",void 0),n([w(cc.Label)],t.prototype,"heroDescribe",void 0),n([w(cc.Node)],t.prototype,"upgradeTalentfab",void 0),n([w(cc.Node)],t.prototype,"btn_skin",void 0),n([c.Register_Class,b],t)}(r.default);o.default=E,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/ProficiencyTableData":"ProficiencyTableData","../../common/CommandValue":"CommandValue","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/base/GameView":"GameView","../../modules/manager/LoadResManager":"LoadResManager","../../network/ClientNetwork":"ClientNetwork","../../network/LocalMessage":"LocalMessage","../../network/protocol/RoleProtocols":"RoleProtocols","../../utils/ConfigUtils":"ConfigUtils","../../utils/ConstValue":"ConstValue","../../utils/GamePlatform":"GamePlatform","../../utils/GameUtils":"GameUtils","../../utils/LogUtil":"LogUtil","../../utils/ResourcesManager":"ResourcesManager","./HeroSkinUtils":"HeroSkinUtils"}],HeroCardsMainView:[function(e,t,o){"use strict";cc._RF.push(t,"0b106MqBC1H84qWZPbVgR1/","HeroCardsMainView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../utils/ConfigUtils"),s=e("../../modules/base/BaseView"),c=e("../../modules/manager/LoadResManager"),l=e("../../utils/LogUtil"),d=e("../../modules/base/GameView"),u=e("../../common/PlayerModule"),h=e("../../modules/base/Decorators"),p=e("../../network/protocol/RoleProtocols"),f=e("../../network/ClientNetwork"),g=e("../../utils/GameTools"),m=e("../../network/LocalMessage"),_=e("../../common/EventConst"),y=e("../../modules/manager/EventManager"),v=e("../../utils/GamePlatform"),C=cc._decorator,S=C.ccclass,T=C.property,I=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.cardsPrefab=null,t.scroview=null,t.cancelNode=null,t.visibleNode=null,t.m_cardGroupNode=null,t.m_cardUnlockNode=null,t.m_cardLockNode=null,t.m_CardTabLabArr=[],t.m_SwitchCardNode=null,t._changeHeroId=0,t._loadAssetArr=[],t._bChangeBattleGroup=!1,t.m_switchCardGroupBtnCd=0,t}return a(t,e),t.path=function(){return"ui/heroCardBag/prefab/card_main"},t.prototype.init=function(){},t.prototype.onEnable=function(){this.carHpAdditionNode&&this.onRefreshCarHpInfo(this.carHpAdditionNode,this.carHpAdditionNode.parent)},t.prototype.start=function(){var e=this;f.ClientNetwork.getInstance().listenLocalMessage(m.LOCAL_MESSAGE.LocalMsg_heroSkin_changed,function(){e.refreshBattleHeroCard(),e.refreshUnlockHeroCard()},this),c.default.loadPrefab("ui/CommonPrefab/TopView").then(function(t){0!=e.isVaild()&&(t.parent=e.node,t.getChildByName("goldDiamondContent").active=!1,t.getComponent("TopView").bindExitEvent(function(){e.closeView()}),e._topBackBtn=t.getChildByName("ExitButton"))}).catch(function(e){l.default.info(e)}),this.visibleNode.height=this.scroview.node.height,this.visibleNode.width=this.scroview.node.width,this.initlistenProtocol(),this.initBattleCardGroupInfo(),this.cancelNode.active=!1,this.cancelNode.on(cc.Node.EventType.TOUCH_END,this.onClickCancelCallBack,this),this.adaptiveHeroToggle(),this.refreshCardGroupTabName()},t.prototype.onScrollViewCallBack=function(){var e=this.visibleNode.getBoundingBoxToWorld();if(this._battleNodeLayout)for(var t=0,o=this._battleNodeLayout.children.length;t<o;t++){var i=(a=this._battleNodeLayout.children[t]).getBoundingBoxToWorld().intersects(e);a.isValid&&(a.opacity=i?255:0)}if(this._lockNodeLayout)for(t=0,o=this._lockNodeLayout.children.length;t<o;t++)i=(a=this._lockNodeLayout.children[t]).getBoundingBoxToWorld().intersects(e),a.isValid&&(a.opacity=i?255:0);if(this._unLockNodeLayout)for(t=0,o=this._unLockNodeLayout.children.length;t<o;t++){var a;i=(a=this._unLockNodeLayout.children[t]).getBoundingBoxToWorld().intersects(e),a.isValid&&(a.opacity=i?255:0)}},t.prototype.onClickCancelCallBack=function(){this._changeHeroId=0,this._lockNodeLayout.parent.active=!0,this._unLockNodeLayout.parent.active=!0,this.scroview.enabled=!0,this.cancelNode.active=!1,this._topBackBtn&&(this._topBackBtn.active=!0),this._battleNodeLayout.children.forEach(function(e){e.getComponent("CardView")._playAct=!1,e.angle=0,e.getComponent(cc.Animation).stop()});var e=d.default.getViewByName("HeroCardInfoView");e&&e.view&&e.view.closeView()},t.prototype.initBattleCardGroupInfo=function(){this.setBattleCardInfo(this.m_cardGroupNode),this.initUnlockCardInfo()},t.prototype.setBattleCardInfo=function(e){this._battleHeroCardNode=e,(v.GamePlatform.isByteDanceMiniGame()||v.GamePlatform.isQQMiniGame()||v.GamePlatform.isKuaishouMiniGame())&&(e.getChildByName("cardGroupSelect").x=-100);var t=e.getChildByName("cardGroupSelect").getChildByName("toggleNode"),o=e.getChildByName("cardGroupSelect").getChildByName("toggleNode2");this._toggleNodeArr=[];for(var i=0;i<5;i++){var a=t.getChildByName("toggle"+(i+1));this._toggleNodeArr.push(a),a.opacity=0,a.on(cc.Node.EventType.TOUCH_END,this.onClickToggleCallBack,this)}for(i=0;i<5;i++){var n=o.getChildByName("toggle"+(i+1));this._toggleNodeArr.push(n),n.opacity=0,n.on(cc.Node.EventType.TOUCH_END,this.onClickToggleCallBack,this)}this.refreshSwitchCardInfo(),this.refreshBattleHeroCard()},t.prototype.onClickToggleCallBack=function(e){var t=this;e.target.opacity>0||this._toggleNodeArr.forEach(function(o,i){o.opacity=0,o==e.target&&t.changeBattleArrayIndex(i)})},t.prototype.refreshBattleHeroCard=function(){var e=this,t=this._battleHeroCardNode.getChildByName("cardLayout"),o=t.children,i=u.default.fightHeroArrayIndex,a=u.default.getBattleHeroCarData(i);if(o.forEach(function(e){e.stopAllActions(),e.scale=.8,e.opacity=0}),o.length>0)a.forEach(function(t,i){var a=o[i-1];if(a)if(a.getComponent("CardView")._heroId=t.heroId,a.getComponent("CardView").refreshHeroCardInfo(),1==e._bChangeBattleGroup){var n=a.scale;a.opacity=0,cc.tween(a).delay(.03*i).to(0,{opacity:255}).to(.15,{scale:n+i/60}).to(.15,{scale:n}).start()}else a.opacity=255});else{var n=a.length,r=0;this.schedule(function(){for(var o=0;o<5;o++){if(a[r]){var i=e.createCard(a[r],r);if(null==i)return void r++;t.addChild(i)}r++}},0,Math.ceil((n-1)/5),0)}this._toggleNodeArr[i].opacity=255,this._battleNodeLayout=t,this._selectHeroGroup=i,1==this._bChangeBattleGroup&&(this._bChangeBattleGroup=!1)},t.prototype.refreshUnlockHeroCard=function(){var e=this,t=u.default.getHeroCarData(),o=[];this._lockNodeLayout.removeAllChildren();var i=function(e){var t=!1;return u.default.getBattleHeroCarData(u.default.fightHeroArrayIndex).forEach(function(o){o.heroId==e&&(t=!0)}),t};t.forEach(function(t){1==t.bHeroLock&&0==i.call(e,t.heroId)&&o.push(t)});var a=(o=o.sort(function(e,t){var o=r.default.getInstance().getHeroConfig(e.heroId).hero_color,i=r.default.getInstance().getHeroConfig(t.heroId).hero_color;return o!=i?o<i?1:-1:e.heroId<t.heroId?-1:void 0})).length,n=0;this.subframeTime1&&(clearInterval(this.subframeTime1),this.subframeTime1=null),this.subframeTime1=setInterval(function(){for(var t=0;t<5;t++){if(o[n]){var i=e.createCard(o[n],n);if(null==i)return void n++;e._lockNodeLayout.addChild(i)}if(++n>=a){clearInterval(e.subframeTime1),e.subframeTime1=null;break}}},0)},t.prototype.changeBattleArrayIndex=function(e){if(e!==u.default.fightHeroArrayIndex){this._bChangeBattleGroup=!0;var t=new p.C_Role_BattleArraySetDefine;t.arrayID=e+1,f.ClientNetwork.getInstance().Send(p.ROLE_CLIENT_ENUM.P_Role_BattleArraySetDefine,t)}},t.prototype.initUnlockCardInfo=function(){this.setUnlockCardInfo(this.m_cardUnlockNode),this.initNotUnlockCardInfo()},t.prototype.setUnlockCardInfo=function(e){var t=this,o=e.getChildByName("cardLayout"),i=u.default.getHeroCarData(),a=10,n=[],s=function(e){var t=!1;return u.default.getBattleHeroCarData(u.default.fightHeroArrayIndex).forEach(function(o){o&&o.heroId==e&&(t=!0)}),t};i.forEach(function(e){1==e.bHeroLock&&0==s.call(t,e.heroId)&&(n.push(e),a++)}),n=n.sort(function(e,t){var o=r.default.getInstance().getHeroConfig(e.heroId).hero_color,i=r.default.getInstance().getHeroConfig(t.heroId).hero_color;return o!=i?o<i?1:-1:e.heroId<t.heroId?-1:void 0});var c=Math.ceil(n.length/5),l=Math.floor(this.cardsPrefab.data.height*this.cardsPrefab.data.scale)+o.getComponent(cc.Layout).spacingY;o.height=l*c,e.height+=o.height;var d=this.visibleNode.getBoundingBoxToWorld(),h=n.length,p=0;this.schedule(function(){for(var e=0;e<5;e++){if(n[p]){var i=t.createCard(n[p],p);if(null==i)return void p++;o.addChild(i),o.getComponent(cc.Layout).updateLayout();var a=i.getBoundingBoxToWorld().intersects(d);i.opacity=a?255:0}p++}},0,Math.ceil((h-1)/5),0),this._lockNodeLayout=o,e.getChildByName("card_number").getComponent(cc.Label).string=a+"/"+(i.length-1);var f=e.getChildByName("hpPopup");f.active=!1,this.carHpAdditionNode=f,this.onRefreshCarHpInfo(f,e),g.default.registerTouchEvent(e.getChildByName("hpbg"),function(){f.active=!f.active})},t.prototype.onRefreshCarHpInfo=function(e,t){var o=u.default.getHeroCarData(),i=0;o.forEach(function(e){if(1==e.bHeroLock){var t=r.default.getInstance().getHeroConfig(e.heroId).npc_id,o=r.default.getInstance().getNpcTemplateConfig(t,e.heroLevel).carhp;i+=o}});var a=r.default.getInstance().getCarConfig(1);return e&&(e.getChildByName("hp_number2").getComponent(cc.Label).string=i.toString(),a&&(e.getChildByName("hp_number1").getComponent(cc.Label).string=a.ini_hp),t.getChildByName("hpbg")&&(t.getChildByName("hpbg").getChildByName("hp_number").getComponent(cc.Label).string=i+a.ini_hp)),Number(i+a.ini_hp)},t.prototype.initNotUnlockCardInfo=function(){this.setNotUnlockCardInfo(this.m_cardLockNode)},t.prototype.setNotUnlockCardInfo=function(e){var t=this,o=e.getChildByName("cardLayout"),i=u.default.getHeroCarData(),a=0,n=[];i.forEach(function(e){0==e.bHeroLock&&(n.push(e),a++)}),n=n.sort(function(e,t){var o=r.default.getInstance().getHeroConfig(e.heroId).hero_color,i=r.default.getInstance().getHeroConfig(t.heroId).hero_color;return o!=i?o<i?1:-1:e.heroId<t.heroId?-1:void 0});var s=Math.ceil(n.length/5),c=Math.floor(this.cardsPrefab.data.height*this.cardsPrefab.data.scale)+o.getComponent(cc.Layout).spacingY;o.height=c*s,e.height+=o.height;var l=n.length,d=0,h=this.visibleNode.getBoundingBoxToWorld();this.schedule(function(){for(var e=0;e<5;e++){if(n[d]){var i=t.createCard(n[d],d);if(null==i)return void d++;o.addChild(i),o.getComponent(cc.Layout).updateLayout();var a=i.getBoundingBoxToWorld().intersects(h);i.opacity=a?255:0}d++}},0,Math.ceil((l-1)/5),0),this._unLockNodeLayout=o,e.getChildByName("card_number").getComponent(cc.Label).string=a},t.prototype.createCard=function(e,t){var o=cc.instantiate(this.cardsPrefab);return null==o?null:(o.getComponent("CardView").init(e.heroId,this,t),o.name="card"+t,o)},t.prototype.onHeroCardBattle=function(e){if(this._changeHeroId=e,this._lockNodeLayout.parent.active=!1,this._unLockNodeLayout.parent.active=!1,this.scroview.enabled=!1,this.cancelNode.active=!0,this.scroview.scrollToTop(),this.onScrollViewCallBack(),this._battleNodeLayout)for(var t=0,o=this._battleNodeLayout.children.length;t<o;t++)this._battleNodeLayout.children[t].active=!0;this._topBackBtn&&(this._topBackBtn.active=!1),this._battleNodeLayout.children.forEach(function(e){e.getComponent("CardView").onPlayExchangeAct()})},t.prototype.upgradeRefreshCarfInfo=function(e){this._lockNodeLayout.children.forEach(function(t){var o=t.getComponent("CardView");o._heroId==e&&o.refreshHeroCardInfo()}),this._battleNodeLayout.children.forEach(function(t){var o=t.getComponent("CardView");o._heroId==e&&o.refreshHeroCardInfo()})},t.prototype.battleRefreshCarfInfo=function(){var e=d.default.getViewByName("HeroCardInfoView");if(e&&e.view&&e.view.closeView(),this.refreshCardGroupTabName(),this.refreshSwitchCardInfo(),this._selectHeroGroup!=u.default.fightHeroArrayIndex)return this._selectHeroGroup=u.default.fightHeroArrayIndex,this.refreshBattleHeroCard(),void this.refreshUnlockHeroCard();this._changeHeroId=0,this._lockNodeLayout.parent.active=!0,this._unLockNodeLayout.parent.active=!0,this.scroview.enabled=!0,this.cancelNode.active=!1,this._topBackBtn&&(this._topBackBtn.active=!0),this._battleNodeLayout.children.forEach(function(e){e.getComponent("CardView")._playAct=!1}),this.refreshBattleHeroCard(),this.refreshUnlockHeroCard()},t.prototype.initlistenProtocol=function(){var e=this;f.ClientNetwork.getInstance().listenLocalMessage(m.LOCAL_MESSAGE.LocalMsg_RefreshHeroCardMainView,function(){e.battleRefreshCarfInfo()},this)},t.prototype.hideCardShareRedpoint=function(e){if(!e){var t=d.default.getViewByName("HeroCardInfoView");t&&t.view&&(e=t.view.id)}this._lockNodeLayout.children.forEach(function(t){t.getComponent("CardView")._heroId==e&&(t.getChildByName("redpoint").active=!1)}),this._battleNodeLayout.children.forEach(function(t){t.getComponent("CardView")._heroId==e&&(t.getChildByName("redpoint").active=!1)})},t.prototype.SendCarHpToServer=function(e){var t=new p.C_Role_SendCarHpToServer;t.carHp=e,f.ClientNetwork.getInstance().Send(p.ROLE_CLIENT_ENUM.P_Role_SendCarHpToServer,t)},t.prototype.adaptiveHeroToggle=function(){if(v.GamePlatform.isWechat()){if(v.GamePlatform.isPC())return;if(cc.sys.os==cc.sys.OS_ANDROID)return this.m_cardGroupNode.getChildByName("cardGroupSelect").x=-100;if(this.node.width<1440){var e=this.m_cardGroupNode.getChildByName("cardGroupSelect");if(e){var t=wx.getMenuButtonBoundingClientRect(),o=this.node.width/this.node.height;e.children.forEach(function(e){e.x-=t.width?Math.floor(t.width*o):0})}}}},t.prototype.onClickTabEditCallBack=function(){d.default.addPopView("BaseCtrl","HeroCardEditTabView","HeroCardEditTabView")},t.prototype.refreshCardGroupTabName=function(){this.m_CardTabLabArr.forEach(function(e,t){e.string=u.default.getBattleCardGroupName(t+1)})},t.prototype.onClickSwitchCardGroupCallBack=function(e){if(e.target){var t=(new Date).getTime();if(!(t-this.m_switchCardGroupBtnCd<1e3)){if(this.m_switchCardGroupBtnCd=t,u.default.getCostGetDataByID(8)<=0)return d.default.addPopView("BaseCtrl","HeroUnlockGroupTipView","HeroUnlockGroupTipView");u.default.fightHeroArrayIndex<=4?this.changeBattleArrayIndex(5):u.default.fightHeroArrayIndex<=9&&this.changeBattleArrayIndex(0)}}},t.prototype.refreshSwitchCardInfo=function(){var e=this.m_cardGroupNode.getChildByName("cardGroupSelect").getChildByName("toggleNode"),t=this.m_cardGroupNode.getChildByName("cardGroupSelect").getChildByName("toggleNode2");u.default.fightHeroArrayIndex<=4?(t.active=!1,e.active=!0,this.m_SwitchCardNode.children[0].active=!0,this.m_SwitchCardNode.children[1].active=!1):(e.active=!1,t.active=!0,this.m_SwitchCardNode.children[0].active=!1,this.m_SwitchCardNode.children[1].active=!0),this._toggleNodeArr.forEach(function(e){e.opacity=0})},t.prototype.onDestroy=function(){if(this._loadAssetArr.forEach(function(e){e.decRef(),e=null}),this._toggleNodeArr)for(var e=0;e<this._toggleNodeArr.length;e++)this._toggleNodeArr[e].off(cc.Node.EventType.TOUCH_END,this.onClickToggleCallBack,this);this.cancelNode.off(cc.Node.EventType.TOUCH_END,this.onClickCancelCallBack,this),y.default.Instance.emit(_.default.SycnClientCarHpChangeEvent),this.unscheduleAllCallbacks(),this.subframeTime1&&(clearInterval(this.subframeTime1),this.subframeTime1=null)},n([T(cc.Prefab)],t.prototype,"cardsPrefab",void 0),n([T(cc.ScrollView)],t.prototype,"scroview",void 0),n([T(cc.Node)],t.prototype,"cancelNode",void 0),n([T(cc.Node)],t.prototype,"visibleNode",void 0),n([T(cc.Node)],t.prototype,"m_cardGroupNode",void 0),n([T(cc.Node)],t.prototype,"m_cardUnlockNode",void 0),n([T(cc.Node)],t.prototype,"m_cardLockNode",void 0),n([T(cc.Label)],t.prototype,"m_CardTabLabArr",void 0),n([T(cc.Node)],t.prototype,"m_SwitchCardNode",void 0),n([h.Register_Class,S],t)}(s.default);o.default=I,cc._RF.pop()},{"../../common/EventConst":"EventConst","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/base/GameView":"GameView","../../modules/manager/EventManager":"EventManager","../../modules/manager/LoadResManager":"LoadResManager","../../network/ClientNetwork":"ClientNetwork","../../network/LocalMessage":"LocalMessage","../../network/protocol/RoleProtocols":"RoleProtocols","../../utils/ConfigUtils":"ConfigUtils","../../utils/GamePlatform":"GamePlatform","../../utils/GameTools":"GameTools","../../utils/LogUtil":"LogUtil"}],HeroGroupProficiency:[function(e,t,o){"use strict";cc._RF.push(t,"e2067srpaNHdb6o6IN2d7LE","HeroGroupProficiency");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../utils/ConfigUtils"),s=e("../../utils/ResourcesManager"),c=e("../../modules/base/BaseView"),l=e("../../modules/base/Decorators"),d=e("../../utils/GameUtils"),u=e("../../StaticData/HeroSkinTableData"),h=[{color1:255,color2:205,color3:144},{color1:237,color2:223,color3:255},{color1:255,color2:207,color3:71},{color1:144,color2:255,color3:186},{color1:192,color2:145,color3:255},{color1:245,color2:138,color3:65},{color1:255,color2:83,color3:83}],p=cc._decorator,f=p.ccclass,g=(p.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.path=function(){return"ui/playerInfo/heroGroupProficiency"},t.prototype.start=function(){},t.prototype.init=function(e){var t=this,o=this.node.getChildByName("heroNode");o.active=!1,e.heros.forEach(function(i){var a=cc.instantiate(o);a.parent=t.node.getChildByName("heroLayout"),a.active=!0;var n=r.default.getInstance().getItemByID(i.heroID);if(n){var c=a.getChildByName("heroNodeTemp");if(i.skinId>0){var l=u.HeroSkinTableData.getById(i.skinId),p=r.default.getInstance().data["StaticData/ItemTableData"][l.itemId];s.default.loadSprite(p.icon,c.getChildByName("icon").getComponent(cc.Sprite))}else s.default.loadSprite(n.icon,c.getChildByName("icon").getComponent(cc.Sprite));c.getChildByName("name").getComponent(cc.Label).string=n.name,c.getChildByName("levelNum").getComponent(cc.Label).string=i.heroLevel;var f=e.proficiencyData.get(i.heroID);if(f){var g=d.getProficiencyIcon(f.proficiency),m=c.getChildByName("proficiencyIcon").getComponent(cc.Sprite);s.default.loadSprite(g.data.icon,m);var _=h[g.lv-1];c.getChildByName("proficiencyNum").color=cc.color(_.color1,_.color2,_.color3),c.getChildByName("proficiencyNum").getComponent(cc.Label).string=g.data.lvName}}}),this.node.on(cc.Node.EventType.TOUCH_END,function(){})},n([l.Register_Class,f],t)}(c.default));o.default=g,cc._RF.pop()},{"../../StaticData/HeroSkinTableData":"HeroSkinTableData","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../utils/ConfigUtils":"ConfigUtils","../../utils/GameUtils":"GameUtils","../../utils/ResourcesManager":"ResourcesManager"}],HeroObj:[function(e,t,o){"use strict";cc._RF.push(t,"c1e40ufmz5LaYO9UsgvJPSC","HeroObj"),o.__esModule=!0,o.default=void 0;var i=p(e("../../common/PlayerModule")),a=p(e("../../utils/ConfigUtils")),n=e("../../utils/ConstValue"),r=(p(e("../../utils/Debug")),p(e("../../utils/Tools"))),s=p(e("./NpcObj")),c=e("../../utils/GameUtils"),l=p(e("../../common/CombatModule")),d=p(e("../../modules/base/GameView")),u=p(e("../CombatManager")),h=p(e("../../view/heroCardBag/HeroSkinUtils"));function p(e){return e&&e.__esModule?e:{default:e}}var f=function(e){var t,o;function s(){var t;return(t=e.call(this)||this).heroPos=0,t.levelNode=null,t.star=1,t.heroTemplateId=0,t.summonMonsterCount=1,t.coldDownCD=n.coldDownTime,t}o=e,(t=s).prototype=Object.create(o.prototype),t.prototype.constructor=t,t.__proto__=o;var p=s.prototype;return p.destroy=function(){for(var t in this.levelNode&&(this.levelNode.removeFromParent(),this.levelNode=null),this.buffList){var o=this.buffList[t];this.removeBuffById(o.uId)}this.buffList=null,e.prototype.destroy.call(this)},p.init=function(t,o,i,r,s,c,p){var f=this;this.prof=a.default.getInstance().getHeroConfig(c).prof,this.occupation=a.default.getInstance().getHeroConfig(c).occupation,this.star=p,this.heroTemplateId=c;var g=o,m=l.default.getHeroSkinId(this.camp==n.PLAYER_CAMP.myPlayer,c);if(m>0&&(g=h.default.Instance.getNpcTemplateId(c,m),console.log("\u6218\u6597\u4e2d\u663e\u793a\u7279\u6b8a\u76ae\u80a4\u82f1\u96c4="+a.default.getInstance().getHeroConfig(c).name+"\u76ae\u80a4="+m)),e.prototype.init.call(this,t,g,i,r,s),(!this.heroTemplateId||2!=a.default.getInstance().getHeroConfig(this.heroTemplateId).hero_type)&&(this.initUI(),this.refreshStar(p,c),!u.default.getInstance().isCoop()||u.default.getInstance().isSkyCastle()||this.camp!=n.PLAYER_CAMP.opponents)){var _=new cc.Node;_.x=0,_.y=100,_.parent=this.node,_.height=150,_.width=120,_.on(cc.Node.EventType.TOUCH_END,function(){d.default.addPopView("BaseCtrl","BattleCardInfo","BattleCardInfo",{nHeroId:c,camp:f.camp,coldDowm:f.coldDownCD});var e=["\u5f53\u524d\u8840\u91cf","\u653b\u51fb","\u7269\u9632","\u9b54\u9632","\u8840\u91cf\u4e0a\u9650","\u547d\u4e2d%","\u95ea\u907f%","\u66b4\u51fb%","\u66b4\u6297%","\u66b4\u4f24%","\u66b4\u4f24\u51cf\u514d%","\u653b\u51fb%","\u7269\u9632%","\u9b54\u9632%","\u8840\u91cf%","\u4f24\u5bb3%","\u4f24\u5bb3\u51cf\u514d%","\u79fb\u901f%","\u653b\u901f%","\u7eaf\u9632%","\u6cbb\u7597%","\u53cd\u4f24","\u97e7\u6027","\u5438\u8840","\u7269\u9632\u51cf","\u9b54\u9632\u51cf","\u771f\u5b9e\u51cf\u514d"],t="";for(var o in f.attr)t=t+" "+e[o]+"\uff1a"+f.attr[o]+"  ";console.log("show hero "+a.default.getInstance().getHeroConfig(f.heroTemplateId).name+" Attr"+t)})}},p.hideUI=function(){this.levelNode.active=!1},p.setHeroPos=function(e){this.heroPos=e},p.initUI=function(){this.levelNode=new cc.Node,this.levelNode.parent=this.node,this.levelNode.x=0,this.levelNode.y=10,this.levelNode.scaleX=2/this.scale,this.levelNode.scaleY=2/this.scale,this.levelNode.addComponent(cc.Sprite),this.refreshLevelTip(this.star)},p.refreshStar=function(e,t){this.star=e;var o=.01*a.default.getInstance().getHeroConfig(t).starParam.split("|")[this.star-1],r=o-this.starAttParam,s=1;if(this.camp==n.PLAYER_CAMP.myPlayer){var l=i.default.getHeroCarData()[t];l&&(s=l.heroLevel)}else{var d=(0,c.getMatchPlayerCard)(t,this.camp);d&&(s=d.heroLevel)}var u=a.default.getInstance().getNpcTemplateConfig(this.templateId,s);this.modAttr(n.Npc_Attr_Type.attack,u.attack*r),this.refreshLevelTip(e),this.starAttParam=o,this.starHpParam=this.starAttParam,this.coldDownCD=n.coldDownTime},p.refreshLevelTip=function(e){var t=this;cc.resources.load("ui/hero_star/"+e,cc.SpriteFrame,function(e,o){t.levelNode&&cc.isValid(t.levelNode)&&(t.levelNode.getComponent(cc.Sprite).spriteFrame=o)})},p.levelUp=function(){r.default.playEffect("combat/effect/shengji/shengji",this.node,cc.v2(0,0),1.25),this.refreshLevel()},p.canWalk=function(){return!1},p.update=function(t){this.coldDownCD>0&&(this.coldDownCD=this.coldDownCD-t),e.prototype.update.call(this,t)},p.checkCheat=function(){return!0},s}(s.default);o.default=f,t.exports=o.default,cc._RF.pop()},{"../../common/CombatModule":"CombatModule","../../common/PlayerModule":"PlayerModule","../../modules/base/GameView":"GameView","../../utils/ConfigUtils":"ConfigUtils","../../utils/ConstValue":"ConstValue","../../utils/Debug":"Debug","../../utils/GameUtils":"GameUtils","../../utils/Tools":"Tools","../../view/heroCardBag/HeroSkinUtils":"HeroSkinUtils","../CombatManager":"CombatManager","./NpcObj":"NpcObj"}],HeroSkinTableData:[function(e,t,o){"use strict";cc._RF.push(t,"8c5ee3/DyVBNZj8LyPkoxvE","HeroSkinTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.HeroSkinTableData=void 0;var i=e("../TableReader"),a=function(){function e(){this.id=0,this.itemId=0,this.heroItemId=0,this.level=0,this.describe="",this.skillIdList="",this.EffectType="",this.extraParam="",this.extraParam2="",this.extraParam3=""}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.itemId=e.getNumber(),this.heroItemId=e.getNumber(),this.level=e.getNumber(),this.describe=e.getString(),this.skillIdList=e.getString(),this.EffectType=e.getString(),this.extraParam=e.getString(),this.extraParam2=e.getString(),this.extraParam3=e.getString()},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"HeroSkinTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.HeroSkinTableData=a,cc._RF.pop()},{"../TableReader":"TableReader"}],HeroSkinUtils:[function(e,t,o){"use strict";cc._RF.push(t,"fc9b91PEetKzr7OVD2WX7kb","HeroSkinUtils"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../common/PlayerModule"),a=e("../../StaticData/HeroSkinTableData"),n=e("../../network/ClientNetwork"),r=e("../../network/LocalMessage"),s=e("../../utils/GameUtils"),c=function(){function e(){this.m_skinRedPointMap=null}return Object.defineProperty(e,"Instance",{get:function(){return null==e.g_instance&&(e.g_instance=new e,e.g_instance.init()),e.g_instance},enumerable:!1,configurable:!0}),e.prototype.init=function(){},e.prototype.getCurSkinIdByHeroUUID=function(e,t){var o=this;void 0===t&&(t=0);var a=0;return i.default.getRoleInfoData().heroSkinMap.forEach(function(i,n){null==e&&t>0&&(e=o.getHeroUUIDByHeroID(t)),null!=e&&n.low==e.low&&n.high==e.high&&(a=i)}),a>0?a:0},e.prototype.getHeroUUIDByHeroID=function(e){var t=null;return i.default.getHeroCarData().forEach(function(o){o.heroId==e&&(t=o.heroUUId)}),t},e.prototype.getSkinIdListByHeroID=function(e){var t=[0];return a.HeroSkinTableData.getDataMap().forEach(function(o){o.heroItemId===e&&t.push(o.id)}),t},e.prototype.getNpcTemplateId=function(e,t){return 1e4*t+e},e.prototype.getSkinTableDataBySkinItemId=function(e){var t=null;return a.HeroSkinTableData.getDataMap().forEach(function(o){o.itemId===e&&(t=o)}),t},e.prototype.getSkinTableDataByHeroId=function(e){var t=null;return a.HeroSkinTableData.getDataMap().forEach(function(o){o.heroItemId==e&&(t=o)}),t},e.prototype.onAddSkinItem=function(e){console.log("HeroSkinUtils, onAddSkinItem, \u82f1\u96c4\u76ae\u80a4\u9053\u5177\u53d8\u5316, itemId="+e);var t=this.getSkinTableDataBySkinItemId(e);null!=t&&0!=s.getItemTotalNumByItemId(t.heroItemId)&&(null==this.m_skinRedPointMap&&(this.m_skinRedPointMap=new Map),this.m_skinRedPointMap.set(e,1),n.ClientNetwork.getInstance().pushLocalMessage(r.LOCAL_MESSAGE.LocalMsg_RefreshRedDot_heroSkin))},e.prototype.removeSkinItemRedPoint=function(e){if(console.log("HeroSkinUtils, removeSkinItemRedPoint, \u79fb\u9664\u7ea2\u70b9, heroId="+e),null!=this.m_skinRedPointMap){var t=this.getSkinTableDataByHeroId(e);null!=t&&(this.m_skinRedPointMap.set(t.itemId,0),n.ClientNetwork.getInstance().pushLocalMessage(r.LOCAL_MESSAGE.LocalMsg_RefreshRedDot_heroSkin))}},e.prototype.getHeroSkinRedPointBy=function(e,t){if(void 0===t&&(t=0),e){if(null==this.m_skinRedPointMap)return!1;var o=0;return this.m_skinRedPointMap.forEach(function(e){e>0&&o++}),o>0}if(null==this.m_skinRedPointMap)return!1;var i=this.getSkinTableDataByHeroId(t);if(null==i)return!1;if(null!=i&&0==s.getItemTotalNumByItemId(i.heroItemId))return!1;var a=0;return this.m_skinRedPointMap.forEach(function(e,t){t==i.itemId&&e>0&&a++}),a>0},e}();o.default=c,cc._RF.pop()},{"../../StaticData/HeroSkinTableData":"HeroSkinTableData","../../common/PlayerModule":"PlayerModule","../../network/ClientNetwork":"ClientNetwork","../../network/LocalMessage":"LocalMessage","../../utils/GameUtils":"GameUtils"}],HeroSkinView:[function(e,t,o){"use strict";cc._RF.push(t,"0d35fb7U+RNuIlU7u7w6VUb","HeroSkinView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../common/PlayerModule"),s=e("../../Global/GameGlobal"),c=e("../../modules/base/BaseView"),l=e("../../modules/base/Decorators"),d=e("../../modules/base/GameView"),u=e("../../modules/manager/LoadResManager"),h=e("../../network/ClientNetwork"),p=e("../../network/LocalMessage"),f=e("../../network/protocol/RoleProtocols"),g=e("../../network/protocol/TypeProtocols"),m=e("../../StaticData/HeroSkinTableData"),_=e("../../utils/ConfigUtils"),y=e("../../utils/GameTools"),v=e("../../utils/GameUtils"),C=e("../../utils/LogUtil"),S=e("../../utils/ResourcesManager"),T=e("./HeroSkinUtils"),I=cc._decorator,N=I.ccclass,b=I.property,w=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.scroll2=null,t.listItemPrefab2=null,t.viewNode=null,t.txt_name=null,t.txt_effect=null,t.spineNode=null,t.m_tipBtn=null,t.m_tipPanel=null,t.m_heroUUID=0,t.m_heroID=0,t.m_currentSkinId=0,t.m_currentItemNode=null,t}return a(t,e),t.path=function(){return"ui/heroCardBag/prefab/HeroChangeSkin"},t.prototype.onLoad=function(){var e=this;this.m_tipBtn=this.node.getChildByName("TipsButton"),this.m_tipPanel=this.node.getChildByName("tips"),this.m_tipPanel.active=!1,this.m_tipBtn.on(cc.Node.EventType.TOUCH_END,function(){e.m_tipPanel.active=!0}),this.m_tipPanel.getChildByName("clickNode").on(cc.Node.EventType.TOUCH_END,function(){e.m_tipPanel.active=!1})},t.prototype.start=function(){var t=this;h.ClientNetwork.getInstance().listenProtocol(f.ROLE_CLIENT_ENUM.P_Role_HeroChangeSkin,function(o){o.resetPos();var i=new f.S_Role_HeroChangeSkin;i.read(o)&&(0==i.errorcode?(s.G.StringManager.PopString("\u66f4\u6362\u6210\u529f"),h.ClientNetwork.getInstance().pushLocalMessage(p.LOCAL_MESSAGE.LocalMsg_heroSkin_changed),e.prototype.closeView.call(t)):s.G.StringManager.PopString("\u66f4\u6362\u5931\u8d25"+i.errorcode))},this)},t.prototype.init=function(e){this.m_heroUUID=e.heroUUID,this.m_heroID=e.heroID,this.initList()},t.prototype.initList=function(){var e=this;this.scroll2.content.removeAllChildren();var t=T.default.Instance.getSkinIdListByHeroID(this.m_heroID),o=[];r.default.getRoleBagItems().forEach(function(e){null!=e&&(console.log("\u80cc\u5305\u9053\u5177="+e.itemId),_.default.getInstance().getItemByID(e.itemId).type===g.TYPE_ITEM.TYPE_ITEM_HEROSKIN&&o.push(e))});for(var i=function(e){var t=null;return o.forEach(function(o){o.itemId===e&&(t=o)}),t},a=[],n=0;n<t.length;n++)if(0==t[n]){var s=_.default.getInstance().data["StaticData/ItemTableData"][this.m_heroID];0==v.getItemTotalNumByItemId(this.m_heroID)?s.bHave=0:s.bHave=1,s.skinId=t[n],a.push(s)}else{var c=m.HeroSkinTableData.getById(t[n]),l=(s=_.default.getInstance().data["StaticData/ItemTableData"][c.itemId],i.call(this,s.id));s.bHave=l?1:0,s.skinId=t[n],a.push(s)}a.forEach(function(t){var o=e.createIconNode(t);o.parent=e.scroll2.content;var i=T.default.Instance.getCurSkinIdByHeroUUID(e.m_heroUUID,e.m_heroID);t.skinId==i&&(e.m_currentSkinId=i,e.selectListItem(o),e.changeSkinTo2(i))})},t.prototype.createIconNode=function(e){var t=this,o=cc.instantiate(this.listItemPrefab2);return o.active=!0,o.getChildByName("check").active=!1,o.skinId=e.skinId,u.default.loadSpriteFrame(e.icon).then(function(t){o.getChildByName("icon").getComponent(cc.Sprite).spriteFrame=t,1==e.bHave||y.default.setNodeBright(o,!1)}).catch(function(e){C.default.info(e)}),o.on(cc.Node.EventType.TOUCH_END,function(e){t.m_currentSkinId=e.target.skinId,console.log("\u70b9\u51fb\u4e86\u56fe\u6807\uff0cskinId="+t.m_currentSkinId),t.changeSkinTo2(t.m_currentSkinId),t.selectListItem(e.target)}),o},t.prototype.selectListItem=function(e){this.m_currentItemNode&&(this.m_currentItemNode.getChildByName("check").active=!1),this.m_currentItemNode=e,this.m_currentItemNode.getChildByName("check").active=!0},t.prototype.changeSkinTo2=function(e){var t=this;if(0==e)this.txt_name.string="\u9ed8\u8ba4\u76ae\u80a4",this.txt_effect.string="\u7279\u6027\uff1a\u65e0";else{var o=m.HeroSkinTableData.getById(e),i=_.default.getInstance().getItemByID(o.itemId);this.txt_name.string=i.name,this.txt_effect.string=o.describe,0==v.getItemTotalNumByItemId(o.itemId)&&s.G.StringManager.PopStringOnce(o.extraParam)}var a,n=_.default.getInstance().getHeroConfig(this.m_heroID);a=0==e?n.npc_id:1e4*e+this.m_heroID;var r=_.default.getInstance().getNpcTemplateConfig(a,1).res_id,c=_.default.getInstance().getResConfig(r).uiScale;S.default.loadSpine(_.default.getInstance().getResConfig(r).animation,function(e){t.spineNode.removeAllChildren(),e.parent=t.spineNode,e.scale=e.scale*c/100*.9,e.getComponent(sp.Skeleton).setAnimation(0,"idle",!0)})},t.prototype.closeView=function(){var t=this;if(0!=v.getItemTotalNumByItemId(this.m_heroID))if(this.m_currentSkinId!=T.default.Instance.getCurSkinIdByHeroUUID(this.m_heroUUID)){var o="";if(0==this.m_currentSkinId)o="\u662f\u5426\u5c06\u76ae\u80a4\u66f4\u6362\u6210\u9ed8\u8ba4\u76ae\u80a4\uff1f";else{var i=m.HeroSkinTableData.getById(this.m_currentSkinId);if(v.getItemTotalNumByItemId(i.itemId)<=0)return void e.prototype.closeView.call(this);o="\u662f\u5426\u5c06\u76ae\u80a4\u66f4\u6362\u6210 "+_.default.getInstance().getItemByID(i.itemId).name+"\uff1f"}var a=this;d.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:o,confirmCb:function(){a.callChangeSkin(a.m_currentSkinId)},cancelCb:function(){e.prototype.closeView.call(t)}})}else e.prototype.closeView.call(this);else e.prototype.closeView.call(this)},t.prototype.callChangeSkin=function(e){console.log("callChangeSkin, changeSkinTo\u8bf7\u6c42\u66f4\u6362\u76ae\u80a4, id="+e);var t=new f.C_Role_HeroChangeSkin;t.heroUUId=this.m_heroUUID,t.skinId=e,h.ClientNetwork.getInstance().Send(f.ROLE_CLIENT_ENUM.P_Role_HeroChangeSkin,t)},t.prototype.onDestroy=function(){},n([b(cc.ScrollView)],t.prototype,"scroll2",void 0),n([b(cc.Node)],t.prototype,"listItemPrefab2",void 0),n([b(cc.Node)],t.prototype,"viewNode",void 0),n([b(cc.Label)],t.prototype,"txt_name",void 0),n([b(cc.Label)],t.prototype,"txt_effect",void 0),n([b(cc.Node)],t.prototype,"spineNode",void 0),n([l.Register_Class,N],t)}(c.default);o.default=w,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/HeroSkinTableData":"HeroSkinTableData","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/base/GameView":"GameView","../../modules/manager/LoadResManager":"LoadResManager","../../network/ClientNetwork":"ClientNetwork","../../network/LocalMessage":"LocalMessage","../../network/protocol/RoleProtocols":"RoleProtocols","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/ConfigUtils":"ConfigUtils","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils","../../utils/LogUtil":"LogUtil","../../utils/ResourcesManager":"ResourcesManager","./HeroSkinUtils":"HeroSkinUtils"}],HeroUnlockGroupTipView:[function(e,t,o){"use strict";cc._RF.push(t,"00ea4l70V9HAogQm4716Oq+","HeroUnlockGroupTipView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../common/PlayerModule"),s=e("../../modules/base/BaseView"),c=e("../../modules/base/Decorators"),l=e("../../Global/GameGlobal"),d=e("../../StaticData/CostGetTableData"),u=e("../../network/ClientNetwork"),h=e("../../network/LocalMessage"),p=e("../../common/NetworkProtocolCommon"),f=e("../../modules/base/GameView"),g=cc._decorator,m=g.ccclass,_=g.property,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.m_consumeLab=null,t.nCostGetId=8,t}return a(t,e),t.path=function(){return"ui/heroCardBag/prefab/HeroUnlockGroupTip"},t.prototype.onLoad=function(){var e=this;u.ClientNetwork.getInstance().listenLocalMessage(h.LOCAL_MESSAGE.LocalMsg_SyncCostGet,function(){var t=f.default.getViewNodeByName("HeroCardsMainView");if(t){var o=r.default.getCostGetDataByID(8);o&&o>0&&t.getComponent("HeroCardsMainView").changeBattleArrayIndex(5)}e.closeView()},this)},t.prototype.start=function(){this.m_consumeLab.string=d.CostGetTableData.getById(this.nCostGetId).cost[0].itemNum.toString()},t.prototype.onClickConfirmCallBack=function(){if(r.default.diamondNum<d.CostGetTableData.getById(this.nCostGetId).cost[0].itemNum)return l.G.StringManager.PopWorldString("common_prompt_diamond_insufficient");p.default.callRoleCostGet(this.nCostGetId)},t.prototype.onDestroy=function(){u.ClientNetwork.getInstance().removeLocalMessage(h.LOCAL_MESSAGE.LocalMsg_SyncCostGet,this)},n([_(cc.Label)],t.prototype,"m_consumeLab",void 0),n([c.Register_Class,m],t)}(s.default);o.default=y,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/CostGetTableData":"CostGetTableData","../../common/NetworkProtocolCommon":"NetworkProtocolCommon","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/base/GameView":"GameView","../../network/ClientNetwork":"ClientNetwork","../../network/LocalMessage":"LocalMessage"}],HotUpdatePanel:[function(e,t,o){"use strict";cc._RF.push(t,"d4c33GbAddDmrRo/EcE7I0V","HotUpdatePanel");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("./Global"),s=e("./utils/GamePlatform"),c=cc._decorator,l=c.ccclass,d=c.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.manifestUrl=null,t.infoLabel=null,t.versionLabel=null,t.fileProgress=null,t.fileLabel=null,t.tipNode=null,t._storagePath="",t._isUpdating=!1,t._canRetry=!1,t._retryCount=0,t._retryMaxCount=3,t.requestVersionTimeOut=3,t.hotUpdateUrlCacheKey="appHotUpdateUrl",t}return a(t,e),t.prototype.onLoad=function(){cc.sys.isNative&&(this._storagePath=(jsb.fileUtils?jsb.fileUtils.getWritablePath():"/")+"game-remote-asset",this.initAssetManagerNativeUrl())},t.prototype.start=function(){this.initGetGameVer(),this.backgroundFitScreen(this.node,this.node.getChildByName("bg"))},t.prototype.backgroundFitScreen=function(e,t){e.setContentSize(cc.winSize),.5==e.anchorX&&e.setPosition(cc.winSize.width/2,e.position.y),.5==e.anchorY&&e.setPosition(e.position.x,cc.winSize.height/2);var o=cc.view.getDesignResolutionSize(),i=e.width/o.width,a=e.height/o.height;if(t){var n=e.height/t.height;i>a&&(n=e.width/t.width,t.width*=n)}},t.prototype.initGetGameVer=function(){var e=this,t="https://mszcs1.gameserver.iplay11g.com/gmsys/native_version.php?"+Math.random();if("bigBlue"==s.GamePlatform.getMiYaVideoType()&&(console.log("this is big blue"),t="https://mszcs1.gameserver.iplay11g.com/gmsys/native_bigBlue_version.php?"+Math.random()),cc.isValid(this)){var o=new XMLHttpRequest;o.timeout=1e3*this.requestVersionTimeOut;var i=t;o.open("GET",i,!0),o.send(),o.onload=function(){if(cc.isValid(e))try{var t=JSON.parse(o.response),i=cc.sys.localStorage.getItem("clentVersion");i=i||"",console.log("clentVersion   ",i,t.version);var a=s.GamePlatform.getMiYaVideoType(),n=!0;if(s.GamePlatform.isIOS()&&(n=e.iosIsUpdate(t.isTS)),"testUpdate"==a)return console.log("clentVersion   ",i,t.testVersion,t.testPackageUrl),void e.goupdateTestWay(t,i);if(!n&&s.GamePlatform.isIOS())return console.log("false-------------111-------------"),void e.hotUpdateFinish(!1);if(t.version>i)console.log("\u5ba2\u6237\u7aef\u7248\u672c\u4f4e\u4e8e\u540e\u7aef\u7248\u672c\uff0c \u68c0\u67e5\u66f4\u65b0"),e.modifyAppLoadUrlForManifestFile(t.packageUrl,function(){e.checkUpdate()});else{if(t.version==i)return console.log("\u5ba2\u6237\u7aef\u7248\u672c\u7b49\u4e8e\u540e\u7aef\u7248\u672c\uff0c \u8df3\u8fc7"),void e.hotUpdateFinish(!1);var r=cc.sys.localStorage.getItem("HotUpdateSearchPaths");r?(console.log("\u5ba2\u6237\u7aef\u7248\u672c\u9ad8\u4e8e\u540e\u7aef\u7248\u672c\uff0c \u56de\u6eda,  \u662f\u5426\u627e\u5230path  ==> "+!!r),cc.sys.localStorage.removeItem("HotUpdateSearchPaths"),e.cleanHotUpdateFile()):e.hotUpdateFinish(!0)}}catch(c){console.log("JSON.parse(request.response) error")}},o.ontimeout=function(){cc.isValid(e)&&console.log("hotUpdateHttp ontimeout")},o.onerror=function(){cc.isValid(e)&&console.log("hotUpdateHttp onerror")},o.onabort=function(){cc.isValid(e)&&console.log("hotUpdateHttp abort")}}},t.prototype.goupdateTestWay=function(e,t){var o=this;if(e.testVersion>t)console.log("\u6d4b\u8bd5\u5ba2\u6237\u7aef\u7248\u672c\u4f4e\u4e8e\u540e\u7aef\u7248\u672c\uff0c \u68c0\u67e5\u66f4\u65b0"),this.modifyAppLoadUrlForManifestFile(e.testPackageUrl,function(){o.checkUpdate()});else{if(e.testVersion==t)return console.log("\u6d4b\u8bd5\u5ba2\u6237\u7aef\u7248\u672c\u7b49\u4e8e\u540e\u7aef\u7248\u672c\uff0c \u8df3\u8fc7"),void this.hotUpdateFinish(!1);var i=cc.sys.localStorage.getItem("HotUpdateSearchPaths");i?(console.log("\u6d4b\u8bd5\u5ba2\u6237\u7aef\u7248\u672c\u9ad8\u4e8e\u540e\u7aef\u7248\u672c\uff0c \u56de\u6eda,  \u662f\u5426\u627e\u5230path  ==> "+!!i),cc.sys.localStorage.removeItem("HotUpdateSearchPaths"),this.cleanHotUpdateFile()):this.hotUpdateFinish(!0)}},t.prototype.cleanHotUpdateFile=function(){var e=jsb.fileUtils.getWritablePath();e&&jsb.fileUtils.removeDirectory(e+"/game-remote-asset"),this.scheduleOnce(function(){cc.game.restart()},.5)},t.prototype.initAssetManagerNativeUrl=function(){this._am=new jsb.AssetsManager("",this._storagePath,this.versionCompareHandler),this._am.setVerifyCallback(function(e,t){return t.compressed,t.md5,t.path,!0}),cc.sys.os===cc.sys.OS_ANDROID&&this._am.setMaxConcurrentTask(2)},t.prototype.versionCompareHandler=function(e,t){for(var o=e.split("."),i=t.split("."),a=0;a<o.length;++a){var n=parseInt(o[a]),r=parseInt(i[a]||"0");if(n!==r)return n-r}return i.length>o.length?-1:0},t.prototype.iosIsUpdate=function(e){var t=e.split("&"),o=s.GamePlatform.getMiYaVideoType();console.log("type===============",o);for(var i=0;i<t.length;++i){var a=t[i];if(console.log("a===============",a),a==o)return s.GamePlatform.setIosUpdateSta(!1),!1}return!0},t.prototype.checkUpdate=function(){if(this._isUpdating)cc.log("\u68c0\u6d4b\u66f4\u65b0\u4e2d...");else if(this._am){if(this._am.getState()===jsb.AssetsManager.State.UNINITED){var e=this.manifestUrl.nativeUrl;cc.assetManager.md5Pipe&&(e=cc.assetManager.md5Pipe.transformURL(e)),this._am.loadLocalManifest(e)}this._am.getLocalManifest()&&this._am.getLocalManifest().isLoaded()?(this._am.setEventCallback(this.checkCallback.bind(this)),this._am.checkUpdate(),this._isUpdating=!0,this.disPatchRateEvent(.01),this.versionLabel&&(this.versionLabel.string=this._am.getLocalManifest().getVersion())):console.log("\u52a0\u8f7dmanifest\u6587\u4ef6\u5931\u8d25")}else console.log("\u70ed\u66f4\u7ba1\u7406\u5668\u5df2\u88ab\u91ca\u653e...")},t.prototype.checkCallback=function(e){switch(e.getEventCode()){case jsb.EventAssetsManager.ERROR_NO_LOCAL_MANIFEST:console.log("\u6ca1\u6709\u53d1\u73b0\u672c\u5730manifest\u6587\u4ef6\uff0c\u8df3\u8fc7\u4e86\u70ed\u66f4\u65b0."),this.hotUpdateFinish(!0);break;case jsb.EventAssetsManager.ERROR_DOWNLOAD_MANIFEST:case jsb.EventAssetsManager.ERROR_PARSE_MANIFEST:console.log("\u4e0b\u8f7dmanifest\u6587\u4ef6\u5931\u8d25\uff0c\u8df3\u8fc7\u70ed\u66f4\u65b0."),this.hotUpdateFinish(!1);break;case jsb.EventAssetsManager.ALREADY_UP_TO_DATE:console.log("\u5df2\u66f4\u65b0."),this.hotUpdateFinish(!0);break;case jsb.EventAssetsManager.NEW_VERSION_FOUND:return console.log("\u6709\u65b0\u7248\u672c,\u9700\u8981\u66f4\u65b0"),this._isUpdating=!1,void this.onShowUpdateTip();case jsb.EventAssetsManager.UPDATE_PROGRESSION:var t=e.getPercent();if(isNaN(t))return;var o=e.getMessage();return void console.log("checkCallback\u66f4\u65b0\u8fdb\u5ea6\uff1a"+t+", msg: "+o);default:return void console.log("event.getEventCode():"+e.getEventCode())}this._am.setEventCallback(null),this._isUpdating=!1},t.prototype.startHotUpdate=function(){if(this._am&&!this._isUpdating){if(this._am.setEventCallback(this.updateCallback.bind(this)),this._am.getState()===jsb.AssetsManager.State.UNINITED){var e=this.manifestUrl.nativeUrl;this._am.loadLocalManifest(e)}this._retryCount=0,this._am.update(),this._isUpdating=!0,this.tipNode.active=!1}},t.prototype.updateCallback=function(e){var t=!1,o=!1;switch(console.log("getEventCode",e.getEventCode()),e.getEventCode()){case jsb.EventAssetsManager.ERROR_NO_LOCAL_MANIFEST:this.showLog("\u6ca1\u6709\u53d1\u73b0\u672c\u5730manifest\u6587\u4ef6\uff0c\u8df3\u8fc7\u4e86\u70ed\u66f4\u65b0."),o=!0,this.hotUpdateFinish(!0);break;case jsb.EventAssetsManager.UPDATE_PROGRESSION:0==e.getPercentByFile()?this.fileProgress.progress=.01:this.fileProgress.progress=e.getPercentByFile();var i=Math.floor(e.getDownloadedFiles()/e.getTotalFiles()*100);if(isNaN(i))return;this.fileLabel.string=i+"%";var a=e.getMessage();this.infoLabel.string="\u6b63\u5728\u66f4\u65b0\u4e2d\u2026",this.infoLabel.node.active=!0,this.fileProgress.node.active=!0,this.showLog("updateCallback\u66f4\u65b0\u8fdb\u5ea6\uff1a"+i+", msg: "+a);break;case jsb.EventAssetsManager.ERROR_DOWNLOAD_MANIFEST:case jsb.EventAssetsManager.ERROR_PARSE_MANIFEST:this.showLog("\u4e0b\u8f7dmanifest\u6587\u4ef6\u5931\u8d25\uff0c\u8df3\u8fc7\u70ed\u66f4\u65b0."),o=!0,this.hotUpdateFinish(o);break;case jsb.EventAssetsManager.ALREADY_UP_TO_DATE:this.showLog("\u5df2\u662f\u6700\u65b0\u7248\u672c."),o=!0,this.hotUpdateFinish(!0);break;case jsb.EventAssetsManager.UPDATE_FINISHED:this.showLog("\u66f4\u65b0\u7ed3\u675f."+e.getMessage()),this.disPatchRateEvent(1),t=!0,o=!0;break;case jsb.EventAssetsManager.UPDATE_FAILED:this.showLog("\u66f4\u65b0\u9519\u8bef."+e.getMessage()),this._isUpdating=!1,this._canRetry=!0,this.retryUpdate();break;case jsb.EventAssetsManager.ERROR_UPDATING:this.showLog("\u66f4\u65b0\u8fc7\u7a0b\u4e2d\u9519\u8bef: "+e.getAssetId()+", "+e.getMessage());break;case jsb.EventAssetsManager.ERROR_DECOMPRESS:this.showLog("\u89e3\u538b\u9519\u8bef")}if(console.log("failed ",o),console.log("needRestart",t),o&&(this._am.setEventCallback(null),this._isUpdating=!1),t){this._am.setEventCallback(null);var n=jsb.fileUtils.getSearchPaths(),r=this._am.getLocalManifest().getSearchPaths();Array.prototype.unshift.apply(n,r),cc.sys.localStorage.setItem("HotUpdateSearchPaths",JSON.stringify(n)),jsb.fileUtils.setSearchPaths(n),cc.audioEngine.stopAll(),this.scheduleOnce(function(){cc.game.restart()},.1)}},t.prototype.retryUpdate=function(){if(console.log("retryUpdate ",this._isUpdating,this._canRetry),this._retryCount>=this._retryMaxCount)return console.log("\u66f4\u65b0\u5931\u8d25\uff0c\u8fdb\u5165\u6e38\u620f "),void this.hotUpdateFinish(!1);!this._isUpdating&&this._canRetry&&this._retryCount<this._retryMaxCount&&(this._canRetry=!1,this._retryCount++,this._am.downloadFailedAssets())},t.prototype.hotUpdateFinish=function(e){if(console.log("\u70ed\u66f4\u65b0\u5b8c\u6210======================",e),this._am.getState()===jsb.AssetsManager.State.UNINITED){var t=this.manifestUrl.nativeUrl;this._am.loadLocalManifest(t)}r.default.Instance.version=this._am.getLocalManifest().getVersion(),cc.sys.localStorage.setItem("clentVersion",r.default.Instance.version),this.tipNode.active=!1,this.infoLabel.node.active=!1,this.fileProgress.node.active=!1,cc.tween(this.node).delay(.1).call(function(){cc.director.loadScene("scene/login"),console.log("\u6267\u884c\u8df3\u8f6c\u573a\u666f")}).start()},t.prototype.disPatchRateEvent=function(e){e>1&&(e=1)},t.prototype.onShowUpdateTip=function(){if(this._am.getTotalBytes()<=0)return this.hotUpdateFinish(!0);this.infoLabel.node.active=!1,this.fileProgress.node.active=!1,this.tipNode.active=!0;var e="\u6709\u65b0\u7248\u672c\u66f4\u65b0\uff0c\u66f4\u65b0\u5185\u5bb9\u5927\u5c0f"+this.getUnit(this._am.getTotalBytes());this.tipNode.getChildByName("TipUpdataLabel").getComponent(cc.Label).string=e},t.prototype.getUnit=function(e){if(0==e)return"0 B";for(var t=0,o=0;o<8&&!(e/Math.pow(1024,o)<1);o++)t=o;return(e/Math.pow(1024,t)).toFixed(3)+" "+["B","KB","MB","GB","TB","PB","EB","ZB","YB"][t]},t.prototype.modifyAppLoadUrlForManifestFile=function(e,t){var o=cc.sys.localStorage.getItem(this.hotUpdateUrlCacheKey);if(o&&o==e)return console.log("\u7248\u672c\u76f8\u540c"),void t();if(jsb.fileUtils.isFileExist(this._storagePath+"/project.manifest")){console.log("[HotUpdate] modifyAppLoadUrlForManifestFile: \u6709\u4e0b\u8f7d\u7684manifest\u6587\u4ef6\uff0c\u76f4\u63a5\u4fee\u6539\u70ed\u66f4\u5730\u5740");var i=jsb.fileUtils.getStringFromFile(this._storagePath+"/project.manifest");(n=JSON.parse(i)).packageUrl=e,n.remoteManifestUrl=e+"project.manifest",n.remoteVersionUrl=e+"version.manifest";var a=JSON.stringify(n);(r=jsb.fileUtils.writeStringToFile(a,this._storagePath+"/project.manifest"))&&cc.sys.localStorage.setItem(this.hotUpdateUrlCacheKey,e),console.log("[HotUpdate] \u4fee\u6539\u662f\u5426\u6210\u529f,project.manifest:",r),console.log("[HotUpdate] \u4fee\u6539\u540e\u6587\u4ef6:",n.packageUrl,n.remoteManifestUrl,n.remoteVersionUrl),t()}else{var n,r;console.log("[HotUpdate] modifyAppLoadUrlForManifestFile: \u4e0d\u5b58\u5728\u70ed\u66f4\u6587\u4ef6\u5939\uff0c\u65b0\u5efa\u4e00\u4e2a\uff0c\u7136\u540e\u4fee\u6539\u70ed\u66f4\u5730\u5740"),jsb.fileUtils.isDirectoryExist(this._storagePath)||jsb.fileUtils.createDirectory(this._storagePath),i=jsb.fileUtils.getStringFromFile(this.manifestUrl.nativeUrl),(n=JSON.parse(i)).packageUrl=e,n.remoteManifestUrl=e+"project.manifest",n.remoteVersionUrl=e+"version.manifest",a=JSON.stringify(n),(r=jsb.fileUtils.writeStringToFile(a,this._storagePath+"/project.manifest"))&&cc.sys.localStorage.setItem(this.hotUpdateUrlCacheKey,e),console.log("[HotUpdate] \u4fee\u6539\u662f\u5426\u6210\u529f,project.manifest:",r),console.log("[HotUpdate] \u4fee\u6539\u540e\u6587\u4ef6:",n.packageUrl,n.remoteManifestUrl,n.remoteVersionUrl),t()}},t.prototype.showLog=function(e){cc.log("[HotUpdate][showLog]----"+e)},n([d({type:cc.Asset})],t.prototype,"manifestUrl",void 0),n([d({type:cc.Label})],t.prototype,"infoLabel",void 0),n([d({type:cc.Label})],t.prototype,"versionLabel",void 0),n([d({type:cc.ProgressBar})],t.prototype,"fileProgress",void 0),n([d(cc.Label)],t.prototype,"fileLabel",void 0),n([d(cc.Node)],t.prototype,"tipNode",void 0),n([l],t)}(cc.Component);o.default=u,cc._RF.pop()},{"./Global":"Global","./utils/GamePlatform":"GamePlatform"}],HttpClient:[function(e,t,o){"use strict";cc._RF.push(t,"de123rDwJZCSKYC33jJPFgZ","HttpClient"),Object.defineProperty(o,"__esModule",{value:!0});var i=function(){function e(){}return e.requestForGet=function(e,t,o,i){var a=this,n=cc.loader.getXMLHttpRequest();n.timeout=5e3;var r="?";for(var s in t)"?"!=r&&(r+="&"),r+=s+"="+t[s];null==i&&(i="http://49.233.2.160/alpha_gmsys/");var c=i+e+encodeURI(r);return console.log("RequestURL:"+c),n.open("GET",c,!0),cc.sys.isNative&&n.setRequestHeader("Accept-Encoding","text/html;charset=UTF-8"),n.onreadystatechange=function(){if(4===n.readyState&&n.status>=200&&n.status<300){console.log("http res("+n.responseText.length+"):"+n.responseText);var e=JSON.parse(n.responseText);null!==o&&o(e)}},n.timeout=3e3,n.ontimeout=function(){a.showNetError(),console.error("===========ontimeout===============")},n.onerror=function(){a.showNetError(),console.error("===========onError===============")},n.send(),n},e.showNetError=function(){},e}();o.default=i,cc._RF.pop()},{}],InviteFriendView:[function(e,t,o){"use strict";cc._RF.push(t,"2b944yck9pMxbxGEW74dRL6","InviteFriendView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=e("../../utils/GameTools"),l=e("../../utils/WechatUtils"),d=e("../../utils/GamePlatform"),u=e("../../common/PlayerModule"),h=e("../../StaticData/TaskTableData"),p=e("../../utils/GameUtils"),f=e("../../network/ClientNetwork"),g=e("../../modules/base/GameView"),m=e("../../network/protocol/RoleProtocols"),_=e("../../network/protocol/TypeProtocols"),y=e("../../utils/QQMiniGameUtils"),v=e("../../utils/ByteDanceMiniGameUtils"),C=e("../../utils/QQGameHallUtils"),S=e("../../utils/KSMinigameUtils"),T=e("../../Global/GameGlobal"),I=cc._decorator,N=I.ccclass,b=I.property,w=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.inviteLabel=null,t.drawLabel=null,t.preNode=null,t.tSharePrenticeTask=[],t.taskStrScope=[],t}return a(t,e),t.path=function(){return"ui/invite/inviteFriend"},t.prototype.onLoad=function(){f.ClientNetwork.getInstance().listenProtocol(m.ROLE_CLIENT_ENUM.P_Role_TakeTask,function(e){var t=this;e.resetPos();var o=new m.S_Role_TakeTask;if(o.read(e)){if(0!=o.errorcode)return void T.G.StringManager.PopString("S_Role_TakeTask Error "+o.errorcode);g.default.addPopView("BaseCtrl","AcquirePopupView","AcquirePopupView",{items:o.prize}),setTimeout(function(){t.onRefreshInviteInfo();var e=g.default.getViewByName("MainSceneView");e&&e.view&&e.view.onInviteFriendRedPoint()},200)}else cc.log("\u8bfb\u53d6\u5931\u8d25")},this)},t.prototype.start=function(){var e=this;c.default.registerTouchEvent(this.node.getChildByName("GoToNode"),function(){if(1==e.inviteLabel.node.active)e.onInviteFriendCallBack();else{var t=new m.C_Role_TakeTask;t.taskID=e.getProceedTask().taskID,f.ClientNetwork.getInstance().Send(m.ROLE_CLIENT_ENUM.P_Role_TakeTask,t)}})},t.prototype.init=function(){var e=this;this.onRefreshInviteInfo(),c.default.registerTouchEvent(this.node.getChildByName("baoxiang"),function(){g.default.addPopView("BaseCtrl","AdvertisingBoxPreview","AdvertisingBoxPreview",{strScop:e.taskStrScope})})},t.prototype.getProceedTask=function(){var e=this;this.tSharePrenticeTask=[],Array.from(u.default.getRoleTaskData().tasks.values()).forEach(function(t){h.TaskTableData.getById(t.taskID).type==_.TASK_TYPE.TASK_TYPE_COUNT_SHAREPLAYERNUM&&e.tSharePrenticeTask.push(t)});for(var t=0;t<this.tSharePrenticeTask.length;t++)if(this.tSharePrenticeTask[t].taskState==_.TASK_STATE.TASK_STATE_EXECUTING)return this.tSharePrenticeTask[t];return null},t.prototype.getInviteInfo=function(){var e=u.default.getSharePrenticeData(),t=[];if(e.forEach(function(e){t.push(e)}),t.sort(function(e,t){return e.bindTime-t.bindTime}),this.getProceedTask()){for(var o=0,i=0;i<this.tSharePrenticeTask.length;i++)this.tSharePrenticeTask[i].taskState==_.TASK_STATE.TASK_STATE_FINISH&&(o=h.TaskTableData.getById(this.tSharePrenticeTask[i].taskID).finishCount);return t.splice(0,o),t}},t.prototype.onRefreshInviteInfo=function(){var e=this.getProceedTask();if(!e)return this.closeView();this.drawLabel.node.active=!1,this.inviteLabel.node.active=!1;var t=h.TaskTableData.getById(e.taskID);this.node.getChildByName("number").getComponent(cc.Label).string=t.info3,this.node.getChildByName("friendLayout").removeAllChildren();for(var o=this.getInviteInfo(),i=0;i<Number(t.info3);i++){var a=cc.instantiate(this.preNode);a.active=!0,a.parent=this.node.getChildByName("friendLayout"),a.getComponent(cc.Button).enabled=!0;var n=a.getChildByName("headpic").getComponent(cc.Sprite);n.enabled=!1,o.length>0&&o[i]&&(n.enabled=!0,a.getComponent(cc.Button).enabled=!1,p.setRemoteHeadIcon(o[i].headUrl,o[i].headID,n))}o.length>=Number(t.info3)?this.drawLabel.node.active=!0:this.inviteLabel.node.active=!0;var r=t.ask_achieventment_icon.split("|");for(i=0;i<r.length;i++)this.taskStrScope.push(r[i])},t.prototype.onInviteFriendCallBack=function(){if(d.GamePlatform.isWechat()||d.GamePlatform.isQQMiniGame()||d.GamePlatform.isByteDanceMiniGame()||d.GamePlatform.isQQGameRoom()||d.GamePlatform.isKuaishouMiniGame()){var e="invite="+u.default.uuidTransformRoieId();d.GamePlatform.isWechat()?l.WechatUtils.getInstance().inviteFriend("","HSBZwqsWRHSyH6Qq539BJg","https://mmocgame.qpic.cn/wechatgame/3qxn4AXmzPRtWicLhyOKLIiaIgRxxjMYEw2fAOzf2XEWv5OGIlP53zbR3EoN8GI0LM/0",e,l.ShareType.InviteFriend):d.GamePlatform.isQQMiniGame()?y.QQMiniGameUtils.getInstance().inviteFriend("","HSBZwqsWRHSyH6Qq539BJg","https://mmocgame.qpic.cn/wechatgame/3qxn4AXmzPRtWicLhyOKLIiaIgRxxjMYEw2fAOzf2XEWv5OGIlP53zbR3EoN8GI0LM/0",e,l.ShareType.InviteFriend):d.GamePlatform.isByteDanceMiniGame()?v.default.getInstance().inviteFriend("","HSBZwqsWRHSyH6Qq539BJg","https://mmocgame.qpic.cn/wechatgame/3qxn4AXmzPRtWicLhyOKLIiaIgRxxjMYEw2fAOzf2XEWv5OGIlP53zbR3EoN8GI0LM/0",e,l.ShareType.InviteFriend):d.GamePlatform.isQQGameRoom()?C.QQGameHallUtils.Instance.inviteFriend("","HSBZwqsWRHSyH6Qq539BJg","https://mmocgame.qpic.cn/wechatgame/3qxn4AXmzPRtWicLhyOKLIiaIgRxxjMYEw2fAOzf2XEWv5OGIlP53zbR3EoN8GI0LM/0",e,l.ShareType.InviteFriend):d.GamePlatform.isKuaishouMiniGame()&&S.KSMinigameUtils.Instance.inviteFriend("","HSBZwqsWRHSyH6Qq539BJg","https://mmocgame.qpic.cn/wechatgame/3qxn4AXmzPRtWicLhyOKLIiaIgRxxjMYEw2fAOzf2XEWv5OGIlP53zbR3EoN8GI0LM/0",e,l.ShareType.InviteFriend)}},t.prototype.onDestroy=function(){f.ClientNetwork.getInstance().removeMessageTarget(this)},n([b(cc.Label)],t.prototype,"inviteLabel",void 0),n([b(cc.Label)],t.prototype,"drawLabel",void 0),n([b(cc.Node)],t.prototype,"preNode",void 0),n([s.Register_Class,N],t)}(r.default);o.default=w,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/TaskTableData":"TaskTableData","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/base/GameView":"GameView","../../network/ClientNetwork":"ClientNetwork","../../network/protocol/RoleProtocols":"RoleProtocols","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/ByteDanceMiniGameUtils":"ByteDanceMiniGameUtils","../../utils/GamePlatform":"GamePlatform","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils","../../utils/KSMinigameUtils":"KSMinigameUtils","../../utils/QQGameHallUtils":"QQGameHallUtils","../../utils/QQMiniGameUtils":"QQMiniGameUtils","../../utils/WechatUtils":"WechatUtils"}],JsonExportToCSV:[function(e,t,o){"use strict";cc._RF.push(t,"be03avpPpFCq6r4mdtSnmp6","JsonExportToCSV"),Object.defineProperty(o,"__esModule",{value:!0}),o.JSonToCSV=void 0;var i={setDataConver:function(e){if(!(this.browser().ie<9)){var t,o=e.data,i=void 0===e.showLabel||e.showLabel,a=(e.fileName||"UserExport")+".csv",n=e.columns||{title:[],key:[],formatter:void 0},r="",s="";if(i=void 0===i||i){if(n.title.length)n.title.map(function(e){r+=e+","});else for(t in o[0])r+=t+",";r=r.slice(0,-1),s+=r+"\r\n"}o.map(function(e){if(r="",n.key.length)n.key.map(function(t){r+='"'+("function"==typeof n.formatter&&n.formatter(t,e[t])||e[t])+'",'});else for(t in e)r+='"'+("function"==typeof n.formatter&&n.formatter(t,e[t])||e[t])+'",';r.slice(0,r.length-1),s+=r+"\r\n"}),s&&this.SaveAs(a,s)}},SaveAs:function(e,t){var o=this.browser();if(o.edge&&o.ie)if(o.ie>=10||"edge"==o.edge);else{var i=window.top.open("about:blank","_blank");i.document.write("sep=,\r\n"+t),i.document.close(),i.document.execCommand("SaveAs",!0,e),i.close()}else{var a=document.createElement("a");a.id="linkDwnldLink",a.href=this.getDownloadUrl(t),document.body.appendChild(a);var n=document.getElementById("linkDwnldLink");n.setAttribute("download",e),n.click(),document.body.removeChild(n)}},getDownloadUrl:function(e){if(window.Blob&&window.URL&&window.URL.createObjectURL){var t=new Blob(["\ufeff"+e],{type:"text/csv"});return URL.createObjectURL(t)}},browser:function(){var e,t={},o=navigator.userAgent.toLowerCase();return(e=-1!==o.indexOf("edge")?t.edge="edge":o.match(/rv:([\d.]+)\) like gecko/))?t.ie=e[1]:(e=o.match(/msie ([\d.]+)/))?t.ie=e[1]:(e=o.match(/firefox\/([\d.]+)/))?t.firefox=e[1]:(e=o.match(/chrome\/([\d.]+)/))?t.chrome=e[1]:(e=o.match(/opera.([\d.]+)/))?t.opera=e[1]:(e=o.match(/version\/([\d.]+).*safari/))&&(t.safari=e[1]),t}};o.JSonToCSV=i,cc._RF.pop()},{}],KSMinigameUtils:[function(e,t,o){"use strict";cc._RF.push(t,"503c3StQXhN8YHSYXRkac91","KSMinigameUtils");var i=this&&this.__awaiter||function(e,t,o,i){return new(o||(o=Promise))(function(a,n){function r(e){try{c(i.next(e))}catch(t){n(t)}}function s(e){try{c(i.throw(e))}catch(t){n(t)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(r,s)}c((i=i.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){var o,i,a,n,r={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return n={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function s(e){return function(t){return c([e,t])}}function c(n){if(o)throw new TypeError("Generator is already executing.");for(;r;)try{if(o=1,i&&(a=2&n[0]?i.return:n[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return r.label++,{value:n[1],done:!1};case 5:r.label++,i=n[1],n=[0];continue;case 7:n=r.ops.pop(),r.trys.pop();continue;default:if(!(a=(a=r.trys).length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){r=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){r.label=n[1];break}if(6===n[0]&&r.label<a[1]){r.label=a[1],a=n;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(n);break}a[2]&&r.ops.pop(),r.trys.pop();continue}n=t.call(e,r)}catch(s){n=[6,s],i=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.KSMinigameUtils=void 0;var n=e("../../load"),r=e("../common/NetworkProtocolCommon"),s=e("../common/PlayerModule"),c=e("../Global/GameGlobal"),l=e("../model/ServerAddrInfo"),d=e("../network/ClientNetwork"),u=e("../network/LocalMessage"),h=e("../network/protocol/MatchProtocols"),p=e("../network/protocol/RoleProtocols"),f=e("../StaticData/RechargeTableData"),g=e("../view/activity/ActivityModule"),m=e("./GamePlatform"),_=e("./GameUtils"),y=e("./LogUtil"),v=e("./subUtils/TypeDef"),C=function(){function e(){this.m_nPlatformOS=1,this.m_weichatLoginData=null,this.m_gameRecorderManager=null,this.m_isRecording=!1,this.m_lastVideoPath="",this.m_videoRecordStartTime=0,this.m_videoRecordEndTime=0,this.m_videoRecordIntervalId=-1}return e.getInstance=function(){return this.Instance||(this.Instance=new e),this.Instance},e.prototype.getWechatLoginData=function(){return this.m_weichatLoginData},e.prototype.getWechatOS=function(){return this.m_nPlatformOS},e.prototype.requestServer=function(){var e="https://mszcs1.gameserver.iplay11g.com/gmsys/weblogic/webc/ksminigameloginbygroup.php";!0===n.getSubmitReviewState()&&(e="https://mszctest.gameserver.iplay11g.com/gmsys/weblogic/webc/ksminigameloginbygroup.php");var t=this;ks.request({url:e,data:{accountname:this.m_weichatLoginData.accountname,open_id:this.m_weichatLoginData.openid,systematic:t.m_nPlatformOS,session_key:this.m_weichatLoginData.session_key,ver:n.wechatminiLoaclGameVer,groupid:v.GlobalVar.getServerGroup().toString()},success:function(e){if(e){var o=JSON.stringify(e.data);console.log("requestByteDanceServer res.data="+o),t.m_weichatLoginData.sign=e.data.sign,d.ClientNetwork.getInstance().pushLocalMessage(u.LOCAL_MESSAGE.LocalMsg_GetServerAddr,e.data)}else d.ClientNetwork.getInstance().pushLocalMessage(u.LOCAL_MESSAGE.LocalMsg_GetServerAddr,{error:-2})},fail:function(e){console.log("requestByteDanceServer failed1"+e),d.ClientNetwork.getInstance().pushLocalMessage(u.LOCAL_MESSAGE.LocalMsg_GetServerAddr,{error:-2})}})},e.prototype.userLogin=function(){console.log("KuaishouMiniGameUtils, userLogin!"),this.onLogin()},e.prototype.onLogin=function(){console.log("KuaishouMiniGameUtils, onLogin!");var t=this;cc.sys.os==cc.sys.OS_IOS?this.m_nPlatformOS=2:cc.sys.os==cc.sys.OS_WINDOWS&&(this.m_nPlatformOS=3);var o=l.ServerAddrInfo.getInstance().getServerListUrl();console.log("KuaishouMiniGameUtils, onLogin url="+o),ks.login({success:function(i){y.default.log("onLogin ks.login success",i);var a=i.gameUserId,r=i.gameToken;e.openid=a,ks.request({url:o,data:{gameUserId:a,gameToken:r,systematic:t.m_nPlatformOS,ver:n.wechatminiLoaclGameVer},success:function(e){y.default.log("onLogin getServerListUrl callback succ!",e);var o=JSON.stringify(e.data);console.log("servergroup getserverlist res.data="+o),t.m_weichatLoginData=e.data.data;var i=JSON.stringify(e.data.servers);console.log("servergroup getserverlist servers="+i),l.ServerAddrInfo.getInstance().initServerList(e.data.servers),d.ClientNetwork.getInstance().pushLocalMessage(u.LOCAL_MESSAGE.LocalMsg_SDK_LoginRet,{error:0})},fail:function(e){y.default.log("onLogin failed1",e),d.ClientNetwork.getInstance().pushLocalMessage(u.LOCAL_MESSAGE.LocalMsg_SDK_LoginRet,{error:-2})}})},fail:function(e){y.default.log("onLogin ks.login failed",e),d.ClientNetwork.getInstance().pushLocalMessage(u.LOCAL_MESSAGE.LocalMsg_SDK_LoginRet,{error:-2})}})},e.prototype.getUserInfo=function(){y.default.log("ByteDanceMIniGameUtils, getUserInfo!");var e=this;ks.getUserInfo({success:function(t){console.log("ByteDanceMIniGameUtils, getUserInfo SUCC! res=",t),e.storageUserInfo(t),e.m_strEncryptedData=t.encryptedData,e.m_strIv=t.iv,e.userLogin()},fail:function(){console.log("getUserInfo fail")}})},e.prototype.storageUserInfo=function(e){var t=e.userInfo;console.log("getUserInfo success="+t.nickName+","+t.avatarUrl),ks.setStorage({key:"wxNickName",data:t.nickName}),ks.setStorage({key:"wxImage",data:t.avatarUrl}),ks.setStorage({key:"wxSex",data:t.gender}),ks.setStorage({key:"wxAuth",data:!0})},e.prototype.userInfoSetInSQL=function(e){ks.getStorage({key:"third_Session",success:function(t){ks.request({url:"Our Server ApiUrl",data:{third_Session:t.data,nickName:e.nickName,avatarUrl:e.avatarUrl,gender:e.gender,province:e.province,city:e.city,country:e.country},success:function(){}})}})},e.prototype.userAuth=function(e,t){void 0===e&&(e=null),void 0===t&&(t=null);var o=this,i=ks.getSystemInfoSync(),a=i.screenWidth,n=i.screenHeight;ks.getSetting({success:function(i){if(console.log(i.authSetting),i.authSetting["scope.userInfo"])console.log("\u7528\u6237\u5df2\u6388\u6743"),e&&e();else{console.log("\u7528\u6237\u672a\u6388\u6743");var r=ks.createUserInfoButton({type:"text",text:"",style:{left:0,top:0,width:a,height:n,backgroundColor:"#00000000",color:"#000000",fontSize:0,textAlign:"center",lineHeight:n}});r.offTap(function(){console.log("\u7528\u6237\u6388\u6743:offTap",i)}),r.onTap(function(i){o.m_click_auth||(o.m_click_auth=!0,setTimeout(function(){o.m_click_auth=!1},1e3),i.userInfo?(console.log("\u7528\u6237\u6388\u6743:",i),o.storageUserInfo(i),e&&e(),r.destroy()):(console.log("\u7528\u6237\u62d2\u7edd\u6388\u6743:",i),t&&t(),r.destroy()))})}}})},e.prototype.noticeServerPay=function(){},e.prototype.pay=function(t,o,i){if(cc.sys.os!=cc.sys.OS_IOS){console.log("rechargeId="+t+", rechargeInfo="+i),console.log("GlobalVar.getZoneId()="+v.GlobalVar.getZoneId());var a=f.RechargeTableData.getById(t);if(a)if(console.log("buyQuantity="+a.money),cc.sys.os==cc.sys.OS_ANDROID||cc.sys.os==cc.sys.OS_WINDOWS){var n="android";cc.sys.os==cc.sys.OS_WINDOWS&&(n="windows"),_.setLocalData("userPayRechargeInfo",i),console.log("pay prepare="+_.getLocalData("userPayRechargeInfo",""));var r=e.openid,l=e.appid,d="1_"+s.default.UUID,u=n,h=Math.floor(a.money/10),p="127.0.0.1",g=i,m=a.money.toString();ks.request({url:"https://mszctest.gameserver.iplay11g.com/gmsys/weblogic/webc/ksminigamegetsign.php",data:{game_user_id:r,app_id:l,zone_id:d,os:u,currency_type:"CNY",buy_quantity:h,user_ip:p,third_party_trade_no:g,extension:m},success:function(e){console.log("ksminigame, pay, get sign succ! res=",e);var t=e.data.sign;p=e.data.ip,ks.requestPayment({game_user_id:r,app_id:l,zone_id:d,os:u,currency_type:"CNY",buy_quantity:h,user_ip:p,third_party_trade_no:g,extension:m,sign:t,success:function(e){console.log("\u652f\u4ed8\u6210\u529f, res=",e)},fail:function(e){var t=e.code,o=e.msg;console.log("\u652f\u4ed8\u5931\u8d25",t,o),_.setLocalData("userPayRechargeInfo",""),console.log("pay fail"+_.getLocalData("userPayRechargeInfo",""))}})},fail:function(e){console.log("ksminigame, pay, get sign fail! res=",e),c.G.StringManager.PopString("\u751f\u6210\u7b7e\u540d\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5")}})}else cc.sys.os,cc.sys.OS_IOS;else _.MESSAGETIPS("RECHARGE_ID_NOTEXIST")}else ks.showModal({title:"\u6e29\u99a8\u63d0\u793a~",content:"\u8be5\u7248\u672c\u672a\u5f00\u653e\u5145\u503c\u529f\u80fd",showCancel:!1,confirmText:"OK",success:function(){}})},e.prototype.inviteFriend=function(e,t,o,i,a,n){if(void 0===n&&(n=null),!c.G.UIManager.isFinghtingScene()){ks.shareAppMessage({title:e,imageUrlId:t,imageUrl:o,query:i});var r=new p.C_Role_ClientFinishShare;r.shareID=a,r.is_share=0,d.ClientNetwork.getInstance().Send(p.ROLE_CLIENT_ENUM.P_Role_ClientFinishShare,r),setTimeout(function(){n&&n()},500)}},e.prototype.checkInviteInfo=function(e){if(m.GamePlatform.isKuaishouMiniGame()){var t;for(var o in(t=e||ks.getLaunchOptionsSync()).query){if("battle"==o){var i=t.query.battle;if(i){console.log("checkInviteInfo battleInfo"+i);var a=i.split(".");if((n=new h.C_Match_Duel_Fight).fightType=Number(a[0]),n.useRoom=0,n.roomID=a[1],g.default.isChickenDinnerMatching())return c.G.StringManager.PopString(c.G.StringManager.getString("CHICKENDINNER_MATCHING")),r.default.callRoleClientLog("CHICKENDINNER_MATCHING2"),void console.log("isChickenDinnerMatching code=2");d.ClientNetwork.getInstance().Send(h.MATCH_CLIENT_ENUM.P_Match_Duel_Fight,n,!1)}}if("invite"==o){var n,s=t.query.invite;s&&(console.log("checkInviteInfo inviteInfo"+s),(n=new p.C_Role_ShareBindMaster).masterID=s,d.ClientNetwork.getInstance().Send(p.ROLE_CLIENT_ENUM.P_Role_ShareBindMaster,n,!1))}}}},e.prototype.getChannelID=function(){var e=ks.getLaunchOptionsSync();y.default.log("ByteDanceMIniGameUtils, getChannelID(), ks.getLaunchOptionsSync=",e);var t=e.query,o=(t.gdt_vid,t.weixinadinfo),i=t.channel,a=t.ad_id,n=t.unit_id;if(a)return Number(a)%1e9;if(n)return Number(n);var r=0;return o&&o.split("."),i?(r=Number(i),ks.setStorage({key:"wxaid",data:r}),r):(console.log("getChannelID "+JSON.stringify(e)),5e4)},e.prototype.onCreatGameClubBtn=function(e){if(!this.m_gameClubBtn){var t=ks.getSystemInfoSync(),o=e.getBoundingBoxToWorld(),i=cc.size(e.width+10,e.height+10),a=cc.view.getFrameSize(),n=cc.director.getWinSize(),r=o.x/n.width*a.width+t.safeArea.left+2*t.statusBarHeight,s=(n.height-o.y-i.height)/n.height*a.height,c=i.width/n.width*a.width,l=i.height/n.height*a.height;this.m_gameClubBtn=ks.createGameClubButton({type:"text",text:"",style:{left:r,top:s,width:c,height:l,lineHeight:0,backgroundColor:"",color:"#3296fa",textAlign:"center",fontSize:16,borderRadius:4}})}},e.prototype.wxReportAnalytics=function(e,t){m.GamePlatform.isQQMiniGame()&&ks.reportAnalytics(e,t)},e.prototype.wxOpenChannelsLive=function(){},e.prototype.wxOnGameLiveStateChange=function(){},e.prototype.wxGetUserRecentGameLiveInfo=function(){},e.prototype.wxSyncLiveTimeUpdate=function(){},e.prototype.wxOffGameLiveStateChange=function(){},e.prototype.wxGetGameLiveState=function(){return!1},e.prototype.wxOpenChannelsLiveCollection=function(){},e.prototype.getGameLiveFeedId=function(){var e=_.getLocalData("GameLiveFeedId");return e.length<=0?null:e},e.prototype.setSameLiveFeedId=function(e){_.setLocalData("GameLiveFeedId",e)},e.prototype.onSendUcConversionInfo=function(e,t){var o=this;if(ks.getStorageSync("uc_trackid"))ks.getStorage({key:"uc_trackid",success:function(i){console.log(i.data),o.onSyncUcreturnback(i.data,e,t)}});else{var i=function(){var e=ks.getLaunchOptionsSync().query;return e.uctrackid?(console.log("\u6253\u5370\u53c2\u6570",e.uctrackid),e.uctrackid):null}.call(this);if(!i)return TalkingDataAPI.event("ucNoTrackid"),r.default.callRoleClientLog("ucNoTrackid"),void console.log("not get ucNoTrackid!");ks.setStorage({key:"uc_trackid",data:i,success:function(){o.onSyncUcreturnback(i,e,t)}})}},e.prototype.onSyncUcreturnback=function(e,t,o){console.log("\u6253\u5370\u53c2\u6570Uc  ",e,t,o),e&&(o=o||"1",ks.request({url:"https://mszctest.gameserver.iplay11g.com/gmsys/weblogic/webc/ucreturnback.php",data:{type:t,money:o},success:function(e){console.log("onSendUC success",e.data),TalkingDataAPI.event("onSendUC.success",{code:e.data}),r.default.callRoleClientLog(e.data)},fail:function(e){console.log("onSendUC failed1"+e),TalkingDataAPI.event("onSendUC.failed",{code:e}),r.default.callRoleClientLog("onSendUC.failed")}}))},e.prototype.onSendBiliConversionInfo=function(e,t){var o=this;if(ks.getStorageSync("bili_trackid"))ks.getStorage({key:"bili_trackid",success:function(i){console.log(i.data),o.onSyncBilireturnback(i.data,e,t)}});else{var i=function(){var e=ks.getLaunchOptionsSync().query;return e.trackid?(console.log("\u6253\u5370\u53c2\u6570",e.trackid),e.trackid):null}.call(this);if(!i)return TalkingDataAPI.event("biliNoTrackid"),r.default.callRoleClientLog("biliNoTrackid"),void console.log("not get biliNoTrackid!");ks.setStorage({key:"bili_trackid",data:i,success:function(){o.onSyncBilireturnback(i,e,t)}})}},e.prototype.onSyncBilireturnback=function(e,t,o){console.log("\u6253\u5370\u53c2\u6570B\u7ad9  ",e,t,o),e&&(o=o||1,ks.request({url:"https://mszcs1.gameserver.iplay11g.com/gmsys/weblogic/webc/bilibilireturnback.php",data:{conv_type:t,track_id:e,conv_value:o},success:function(e){console.log("onSendBili success",e.data),TalkingDataAPI.event("onSendBili.success",{code:e.data}),r.default.callRoleClientLog(e.data)},fail:function(e){console.log("onSendBili failed1"+e),TalkingDataAPI.event("onSendBili.failed",{code:e}),r.default.callRoleClientLog("onSendBili.failed")}}))},e.prototype.onSendFeishuConversionInfo=function(e,t){var o=this;if(ks.getStorageSync("feishu_clue_token"))ks.getStorage({key:"feishu_clue_token",success:function(i){console.log(i.data),o.onSyncFeishureturnback(i.data,e,t)}});else{var i=function(){var e=ks.getLaunchOptionsSync().query;return e.clue_token?e.clue_token:null}.call(this);if(!i)return TalkingDataAPI.event("feishuNoClueToken"),r.default.callRoleClientLog("feishuNoClueToken"),console.log("not get clue_token!");ks.setStorage({key:"feishu_clue_token",data:i,success:function(){o.onSyncFeishureturnback(i,e,t)}})}},e.prototype.onSyncFeishureturnback=function(e,t,o){console.log("\u6253\u5370\u53c2\u6570\u6296\u97f3  ",e,this.m_weichatLoginData.accountname,this.m_weichatLoginData.openid),e&&(o=o||0,ks.request({url:"https://mszctest.gameserver.iplay11g.com/gmsys/weblogic/webc/feishureturnback.php",data:{clue_token:e,union_id:this.m_weichatLoginData.accountname,open_id:this.m_weichatLoginData.openid,event_type:t,props:{pay_amount:o}},success:function(e){console.log("onSendFeishu success",e.data),TalkingDataAPI.event("onSendFeishu.success",{code:e.data}),r.default.callRoleClientLog(e.data)},fail:function(e){console.log("onSendFeishu failed1"+e),TalkingDataAPI.event("onSendFeishu.failed",{code:e}),r.default.callRoleClientLog("onSendFeishu.failed")}}))},e.prototype.shareRenderTexture=function(){},e.prototype.startVideoRecording=function(){console.log("\u6296\u97f3\u5f55\u5c4fstartVideoRecording####################");var e=this;null==this.m_gameRecorderManager&&(this.m_gameRecorderManager=ks.getGameRecorder(),this.m_gameRecorderManager.on("start",function(){console.log("onStart \u5f55\u5c4f\u5f00\u59cb"),e.m_isRecording=!0}),this.m_gameRecorderManager.on("stop",function(t){e.m_isRecording=!1,e.m_lastVideoPath=t.videoID,console.log("onStop \u5f55\u5c4f\u505c\u6b62",e.m_lastVideoPath)}),this.m_gameRecorderManager.on("pause",function(){console.log("onPause \u5f55\u5c4f\u6682\u505c")}),this.m_gameRecorderManager.on("resume",function(){console.log("onInterruptionEnd \u76d1\u542c\u5f55\u5c4f\u4e2d\u65ad\u7ed3\u675f\u3002")}),this.m_gameRecorderManager.on("abort",function(){console.log("onInterruptionBegin \u76d1\u542c\u5f55\u5c4f\u4e2d\u65ad\u5f00\u59cb\u4e8b\u4ef6\u3002")}),this.m_gameRecorderManager.on("error",function(t){e.m_isRecording=!1,console.log("onError \u5f55\u5c4f\u9519\u8bef",t)})),this.m_isRecording&&(this.m_isRecording=!1,this.m_gameRecorderManager.stop());try{this.m_videoRecordStartTime=(new Date).getTime(),this.m_gameRecorderManager.start(),this.m_videoRecordIntervalId=setInterval(function(){e.autoStropRecording()},15e3)}catch(t){console.log("\u5f55\u5c4f\u5f00\u59cberror\uff1a",t)}},e.prototype.autoStropRecording=function(){0!=this.m_isRecording&&this.stopVideoRecording()},e.prototype.stopVideoRecording=function(){console.log("stopVideoRecording \u5f55\u5c4f\u505c\u6b62####################"),null!=this.m_gameRecorderManager?(this.m_videoRecordEndTime=(new Date).getTime(),this.m_gameRecorderManager.stop(),clearInterval(this.m_videoRecordIntervalId)):console.log("this.m_gameRecorderManager == null\uff0c\u5f55\u5c4fstop fail")},e.prototype.shareVideoRecording=function(){if(console.log("shareVideoRecording \u5206\u4eab\u5f55\u5c4f, time=",this.m_videoRecordEndTime-this.m_videoRecordStartTime,", videoPath=",this.m_lastVideoPath),this.m_videoRecordEndTime-this.m_videoRecordStartTime<=4e3)c.G.StringManager.PopStringOnce("\u5f55\u5c4f\u5c0f\u4e8e3s\uff0c\u65e0\u6cd5\u5206\u4eab");else{var e={video:this.m_lastVideoPath,callback:function(e){null==e||null==e?console.log("\u5206\u4eab\u5f55\u5c4f\u6210\u529f"):console.log("\u5206\u4eab\u5f55\u5c4f\u5931\u8d25, error=",e)}};this.m_gameRecorderManager.publishVideo(e)}},e.prototype.createKefuBtn=function(){var e=ks.createContactButton({type:"image",image:"douyinkefu.png",text:"",style:{left:10,top:60,width:40,height:30,lineHeight:40,backgroundColor:"#00ffff00",textAlign:"center",fontSize:16,borderRadius:4,borderColor:"#0000ff00",borderWidth:2,textColor:"#cccccc"},success:function(e){console.log("create success",e)},fail:function(e){console.log("create fail",e)},complete:function(e){console.log("create complete",e)}});e.onTap(function(){console.log("\u70b9\u51fb\u5ba2\u670d\u6309\u94ae")}),this.kefuBtn=e},e.prototype.destroyKefuBtn=function(){null!=this.kefuBtn&&this.kefuBtn.destroy()},e.prototype.changeSkinOfAdButton=function(e,t){if(null!=e){var o=e.getComponent(cc.Sprite);null!=o&&setTexture(o,"douyin/"+t)}},e.prototype.getTimeStamp=function(){return s.default.getServersTime2()},e.prototype.chatFilterAsync=function(e,t){return i(this,void 0,void 0,function(){return a(this,function(){return[2,new Promise(function(o){var i=new XMLHttpRequest;i.onload=function(){console.log("\u5feb\u624b\u654f\u611f\u8bcd2, onload!")},i.onreadystatechange=function(){if(console.log("\u5feb\u624b\u654f\u611f\u8bcd2, onreadystatechange, readyState="+i.readyState+", status="+i.status),4==i.readyState&&console.log("\u5feb\u624b\u654f\u611f\u8bcd2, onreadystatechange, http=",i),4==i.readyState&&i.status>=200&&i.status<400){var e=JSON.parse(i.responseText);if(console.log("\u5feb\u624b\u654f\u611f\u8bcd2, response=",e),0==e.result){var t=e.hit;o(1==t)}else o(!1)}},i.onerror=function(){console.log("\u5feb\u624b\u654f\u611f\u8bcd2, onerror!"),o("")},i.open("POST","https://mszctest.gameserver.iplay11g.com/gmsys/weblogic/webc/ksminigamechatfilter.php",!0);var a={};a.content=e,a.sceneType=t;var n=JSON.stringify(a);console.log("\u5feb\u624b\u654f\u611f\u8bcd2, sendValue=",n),i.send(n)})]})})},e.Instance=null,e.appid="ks694680245126253221",e.SDK_TYPE=16,e.JING_FEN_ID=60120,e.CHAT_FILTER_SCENETYPE_NAME=1,e.CHAT_FILTER_SCENETYPE_MSG=2,e.CHAT_FILTER_SCENETYPE_TITLE=3,e.CHAT_FILTER_SCENETYPE_COMMENT=4,e.CHAT_FILTER_SCENETYPE_SIGN=5,e.CHAT_FILTER_SCENETYPE_SEARCH=6,e.CHAT_FILTER_SCENETYPE_OTHER=7,e}();o.KSMinigameUtils=C,cc._RF.pop()},{"../../load":"load","../Global/GameGlobal":"GameGlobal","../StaticData/RechargeTableData":"RechargeTableData","../common/NetworkProtocolCommon":"NetworkProtocolCommon","../common/PlayerModule":"PlayerModule","../model/ServerAddrInfo":"ServerAddrInfo","../network/ClientNetwork":"ClientNetwork","../network/LocalMessage":"LocalMessage","../network/protocol/MatchProtocols":"MatchProtocols","../network/protocol/RoleProtocols":"RoleProtocols","../view/activity/ActivityModule":"ActivityModule","./GamePlatform":"GamePlatform","./GameUtils":"GameUtils","./LogUtil":"LogUtil","./subUtils/TypeDef":"TypeDef"}],LegendCtrl:[function(e,t,o){"use strict";cc._RF.push(t,"1629d+ALuZMfoqRP5gLjwqp","LegendCtrl");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseCtrl"),s=e("../../modules/base/GameView"),c=e("../../utils/LogUtil"),l=e("../../common/PlayerModule"),d=e("../../../scripts/modules/manager/ViewManager"),u=e("../../network/ClientNetwork"),h=e("../../network/protocol/RoleProtocols"),p=e("../../../scripts/modules/base/Decorators"),f=cc._decorator,g=f.ccclass,m=(f.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.view=null,t.rewardCount=0,t}return a(t,e),t.prototype.init=function(){this.onlistenProtocol()},t.prototype.destroy=function(){u.ClientNetwork.getInstance().removeMessageTarget(this)},t.prototype.onlistenProtocol=function(){var e=this;u.ClientNetwork.getInstance().listenProtocol(h.ROLE_CLIENT_ENUM.P_Role_GetLegendReward,function(t){t.resetPos();var o=new h.S_Role_GetLegendReward;if(o.read(t))if(0===o.errorcode){var i=l.default.getLegendData();o.scoreVec.forEach(function(e){i.set(e,1)});var a=s.default.getViewByName("LegendView");a&&a.view,e.rewardCount=0,e.view.refreshBoxState(o.scoreVec),e.tRewards=o.prize,e.onShowLegendRewards()}else c.default.info(o)},this)},t.prototype.onSendProtocolRewards=function(e){var t=new h.C_Role_GetLegendReward;t.scoreVec=e,u.ClientNetwork.getInstance().Send(h.ROLE_CLIENT_ENUM.P_Role_GetLegendReward,t)},t.prototype.onShowLegendRewards=function(){var e=this,t=this.tRewards.slice(6*this.rewardCount,6*(this.rewardCount+1));t.length>0&&s.default.addPopView("BaseCtrl","AcquirePopupView","AcquirePopupView",{items:t,closeCb:function(){e.rewardCount++,e.onShowLegendRewards()}})},n([d.AddViewEvent("SendProtocolLegendRewards")],t.prototype,"onSendProtocolRewards",null),n([p.Register_Class2("LegendCtrl"),g],t)}(r.default));o.default=m,cc._RF.pop()},{"../../../scripts/modules/base/Decorators":"Decorators","../../../scripts/modules/manager/ViewManager":"ViewManager","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseCtrl":"BaseCtrl","../../modules/base/GameView":"GameView","../../network/ClientNetwork":"ClientNetwork","../../network/protocol/RoleProtocols":"RoleProtocols","../../utils/LogUtil":"LogUtil"}],LegendIntroduceView:[function(e,t,o){"use strict";cc._RF.push(t,"52cdfJrQhhO8qzTQOwWL31y","LegendIntroduceView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=cc._decorator,l=c.ccclass,d=(c.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.path=function(){return"ui/chaunqi/prefab/IntroduceView"},n([s.Register_Class,l],t)}(r.default));o.default=d,cc._RF.pop()},{"../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators"}],LegendPalacePreview:[function(e,t,o){"use strict";cc._RF.push(t,"b9cfdyPlMZNZLfzAJtfxBlb","LegendPalacePreview");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=e("../../modules/base/GameView"),l=e("../../utils/List"),d=e("../../utils/LogUtil"),u=e("../../common/PlayerModule"),h=e("../../utils/GameTools"),p=e("../../StaticData/RankListPrizeTableData"),f=e("../../utils/ResourcesManager"),g=e("../../utils/GameUtils"),m=e("../../utils/ConfigUtils"),_=e("../../StaticData/BaseTableData"),y=cc._decorator,v=y.ccclass,C=y.property,S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.listV=null,t.data=[],t._rankIconArr=["ui/common_res/jin","ui/common_res/yin","ui/common_res/tong"],t}return a(t,e),t.path=function(){return"ui/chaunqi/prefab/PalaceRewardsPreview"},t.prototype.onLoad=function(){var e=this,t=u.default.getCurSeasonData();t||d.default.log("\u6ca1\u6709\u8d5b\u5b63\u6570\u636e");var o=t.seasonID;if(0!=o){p.RankListPrizeTableData.getDataMap().forEach(function(t){t.type==o&&e.data.push(t)});var i=m.default.getInstance().getDorpItemsByID(Number(g.getConfigIntValue("season_rank_not")));if(i){var a=[],n=i.dropRandom.split("|");for(var r in n){var s=n[r].split("#"),c=new _.DropItem;c.dropID=s[0],c.dropNum=s[1],a.push(c)}this.data.push({rankMin:3e3,prize:a})}this.listV.numItems=this.data.length}},t.prototype.start=function(){},t.prototype.onListRender=function(e,t){if(t!=this.data.length-1){var o=e.getChildByName("rankIconNode"),i=e.getChildByName("rankLabNode");for(e.getChildByName("ranNotNode").active=!1,this.data[t].rankMin<=3?(o.active=!0,i.active=!1,f.default.loadSprite(this._rankIconArr[t],o.getChildByName("rankIcon").getComponent(cc.Sprite))):(o.active=!1,i.active=!0,i.getChildByName("eankLab").getComponent(cc.Label).string=this.data[t].rankMin+" - "+this.data[t].rankMax),e.getChildByName("RewardsNode").removeAllChildren(),a=0;a<this.data[t].prize.length;a++)h.default.createNormalItems(this.data[t].prize[a].dropID,this.data[t].prize[a].dropNum,null,function(t){t.scale=.8,t.parent=e.getChildByName("RewardsNode")})}else{console.log(t),e.getChildByName("ranNotNode").active=!0,e.getChildByName("rankIconNode").active=!1,e.getChildByName("rankLabNode").active=!1,e.getChildByName("RewardsNode").removeAllChildren();for(var a=0;a<this.data[t].prize.length;a++)h.default.createNormalItems(this.data[t].prize[a].dropID,this.data[t].prize[a].dropNum,null,function(t){t.scale=.8,t.parent=e.getChildByName("RewardsNode")})}},t.prototype.onDestroy=function(){var e=c.default.getViewByName("LegendPalaceView");e&&e.view&&(e.view.node.active=!0,cc.find("Canvas").getChildByName("UI_Mask_LegendPalaceView").active=!0)},n([C(l.default)],t.prototype,"listV",void 0),n([s.Register_Class,v],t)}(r.default);o.default=S,cc._RF.pop()},{"../../StaticData/BaseTableData":"BaseTableData","../../StaticData/RankListPrizeTableData":"RankListPrizeTableData","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/base/GameView":"GameView","../../utils/ConfigUtils":"ConfigUtils","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils","../../utils/List":"List","../../utils/LogUtil":"LogUtil","../../utils/ResourcesManager":"ResourcesManager"}],LegendPalaceView:[function(e,t,o){"use strict";cc._RF.push(t,"f0b5dAh4S9Ps5BlmOWp3QTR","LegendPalaceView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=e("../../utils/GameTools"),l=e("../../Global/GameGlobal"),d=e("../../modules/base/GameView"),u=e("../../utils/GamePlatform"),h=e("../../network/protocol/TypeProtocols"),p=e("../../../load"),f=e("../../common/PlayerModule"),g=e("../../modules/manager/LoadResManager"),m=e("../../utils/GameUtils"),_=e("../../utils/LogUtil"),y=e("../../common/NetworkProtocolCommon"),v=e("./vos/VOLegendControl"),C=e("../../network/ClientNetwork"),S=e("../../network/LocalMessage"),T=e("../../StaticData/CostGetTableData"),I=e("../../network/protocol/TypeProtocols"),N=cc._decorator,b=N.ccclass,w=N.property,E=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.myRankLab=null,t.myScoreLab=null,t.playerNameNode=null,t.playerScoreNode=null,t.playerHeadNode=null,t.cupNode=null,t.playerWorshipNode=null,t.notRankTip=null,t}return a(t,e),t.path=function(){return"ui/chaunqi/prefab/ChuanQiPalace"},t.prototype.onLoad=function(){var e=this;c.default.registerTouchEvent(this.node.getChildByName("RewardsPreviewNode"),function(){d.default.addPopView("BaseCtrl","LegendPalacePreview","LegendPalacePreview"),e.node.active=!1}),c.default.registerTouchEvent(this.node.getChildByName("RankingNode"),function(){e.closeView();var t=d.default.getViewByName("LegendView");t&&t.view&&t.view.closeView(),d.default.addPopView("BaseCtrl","RankListView","RankListView")}),C.ClientNetwork.getInstance().listenLocalMessage(S.LOCAL_MESSAGE.LocalMsg_SyncCostGet,function(){this.checkWorshipState()},this)},t.prototype.start=function(){for(var e=0;e<3;e++){this.cupNode.children[e].active=!1;var t=this.playerScoreNode.children[e];t&&(t.getComponent(cc.Label).string="");var o=this.playerNameNode.children[e];o&&(o.getComponent(cc.Label).string="");var i=this.playerHeadNode.children[e];i&&(i.active=!1)}this.onPullRankData(I.RANKLIST_TYPE.RANKLIST_TYPE_SEASION_HISTORY),this.checkWorshipState()},t.prototype.onPullRankData=function(e){var t=this,o=l.G.StringManager.getString("RANKLIST_URL");(u.GamePlatform.isWechat()||u.GamePlatform.isQQMiniGame()||u.GamePlatform.isByteDanceMiniGame()||u.GamePlatform.isKuaishouMiniGame())&&(o=p.getSubmitReviewState()?l.G.StringManager.getString("RANKLIST_URL"):l.G.StringManager.getString("RANKLIST_URL_MOBILE")),(u.GamePlatform.getMiYa()||u.GamePlatform.isQQGameRoom())&&(o=l.G.StringManager.getString("RANKLIST_URL_MOBILE"));var i=f.default.uuidTransformRoieId();"bigBlue"==u.GamePlatform.getMiYaVideoTypeNoSet()&&(o=l.G.StringManager.getString("RANKLIST_URL_MOBILE_BIGBLUE")),"ly5add7"==u.GamePlatform.getMiYaVideoTypeNoSet()&&(o=l.G.StringManager.getString("RANKLIST_URL_MOBILE_ADDCHANNEL")),o+="?",o+="ranktype="+e,o+="&roleid="+i,o+="&page=1";var a=new XMLHttpRequest;a.onreadystatechange=function(){if(4==a.readyState&&a.status>=200&&a.status<400){var e=a.responseText.toString();e=(e=(e=e.replace('"','"')).replace("\ufeff","")).replace(" ","");var o=JSON.parse(e);if(!cc.isValid(t))return;if(0==o.maxpage)return t.notRankTip.active=!1,t.onPullRankData(I.RANKLIST_TYPE.RANKLIST_TYPE_BATTLE);o.ranktype==I.RANKLIST_TYPE.RANKLIST_TYPE_SEASION_HISTORY&&(t.notRankTip.active=!0),t.onSetFirstThreeInfo(o)}},a.open("GET",o,!0),a.send()},t.prototype.onSetSelfRankInfo=function(e){var t=0,o=0;if("playerrank"in e&&(t=e.playerrank,"playerdata"in e)){var i=JSON.parse(e.playerdata);e.ranktype==h.FIGHT_TYPE.FIGHT_TYPE_BATTLE&&(o=i.score)}0==t?(this.myRankLab.string=l.G.StringManager.getString("NO_RANK"),this.myScoreLab.string=f.default.getRoleAttrValByKey(h.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE).toString()):(this.myRankLab.string=t.toString(),this.myScoreLab.string=o.toString())},t.prototype.onSetFirstThreeInfo=function(e){if("ranklist"in e){var t=e.ranklist,o=0,i=function(e){if(Object.prototype.hasOwnProperty.call(t,e)){var i=JSON.parse(t[e]);if(o>=3)return{value:void 0};a.cupNode.children[o].active=!0;var n=a.playerScoreNode.children[o];if(n&&(n.getComponent(cc.Label).string=i.score),"role"in i){var r=i.role,s=a.playerNameNode.children[o];s&&(s.getComponent(cc.Label).string=r.nickname);var c=a.playerHeadNode.children[o];if(c){c.active=!0,r.headid=r.headid<=0?1:r.headid,m.setRemoteHeadIcon(r.headurl,r.headid,c.getComponent(cc.Sprite));var l=r.headframeid;(l<=0||l>=2e3)&&(l=200),g.default.loadSpriteFrame("ui/headFrame/frame_"+l).then(function(e){c.getChildByName("sprite").getComponent(cc.Sprite).spriteFrame=e}).catch(function(e){_.default.info(e)})}}o++}},a=this;for(var n in t){var r=i(n);if("object"==typeof r)return r.value}}},t.prototype.checkWorshipState=function(){for(var e=0;e<3;e++){var t=this.playerWorshipNode.children[e].getComponent(cc.Button),o=t.getComponentInChildren(cc.Label);o.string="";var i=v.default.getWorshipData(e+1),a=T.CostGetTableData.getById(i);if(a.get[0]){var n=a.get[0].itemNum;o.string=n+""}var r=f.default.getCostGetDataByID(i);t.interactable=!(r>0)}},t.prototype.btn_worship_clickHandler=function(e,t){console.log("----\u70b9\u51fb\u819c\u62dc--rank="+t);var o=v.default.getWorshipData(t);o>0&&y.default.callRoleCostGet(o)},n([w(cc.Label)],t.prototype,"myRankLab",void 0),n([w(cc.Label)],t.prototype,"myScoreLab",void 0),n([w(cc.Node)],t.prototype,"playerNameNode",void 0),n([w(cc.Node)],t.prototype,"playerScoreNode",void 0),n([w(cc.Node)],t.prototype,"playerHeadNode",void 0),n([w(cc.Node)],t.prototype,"cupNode",void 0),n([w(cc.Node)],t.prototype,"playerWorshipNode",void 0),n([w(cc.Node)],t.prototype,"notRankTip",void 0),n([s.Register_Class,b],t)}(r.default);o.default=E,cc._RF.pop()},{"../../../load":"load","../../Global/GameGlobal":"GameGlobal","../../StaticData/CostGetTableData":"CostGetTableData","../../common/NetworkProtocolCommon":"NetworkProtocolCommon","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/base/GameView":"GameView","../../modules/manager/LoadResManager":"LoadResManager","../../network/ClientNetwork":"ClientNetwork","../../network/LocalMessage":"LocalMessage","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/GamePlatform":"GamePlatform","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils","../../utils/LogUtil":"LogUtil","./vos/VOLegendControl":"VOLegendControl"}],LegendTableData:[function(e,t,o){"use strict";cc._RF.push(t,"526d9+lOcBFGaYJQCyF95KR","LegendTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.LegendTableData=void 0;var i=e("../TableReader"),a=e("./BaseTableData"),n=function(){function e(){this.id=0,this.cupNum=0,this.boxType=0,this.boxName="",this.boxId=0,this.nUnlockMapId=0,this.pointX=0,this.boxItems=new Array,this.map_res="",this.bReset=0,this.seasonId=0}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.cupNum=e.getNumber(),this.boxType=e.getNumber(),this.boxName=e.getString(),this.boxId=e.getNumber(),this.nUnlockMapId=e.getNumber(),this.pointX=e.getNumber();for(var o=e.getString(),n=new i.TableReader(o);n.getPos()<n.getLen();){var r=new a.ItemInfo;r.readOriginal(n),this.boxItems.push(r)}this.map_res=e.getString(),this.bReset=e.getNumber(),this.seasonId=e.getNumber()},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"LegendTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.LegendTableData=n,cc._RF.pop()},{"../TableReader":"TableReader","./BaseTableData":"BaseTableData"}],LegendView:[function(e,t,o){"use strict";cc._RF.push(t,"92cd2ao1U9EBoKITiwAm+Ym","LegendView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../Global/GameGlobal"),s=e("../../modules/base/BaseView"),c=e("../../utils/LogUtil"),l=e("../../StaticData/LegendTableData"),d=e("../../../scripts/modules/base/Decorators"),u=e("../../modules/manager/LoadResManager"),h=e("../../common/PlayerModule"),p=e("../../utils/GameTools"),f=e("../../modules/base/GameView"),g=e("../../StaticData/StringValueTableData"),m=e("../../network/protocol/TypeProtocols"),_=e("../../StaticData/SeasonTableData"),y=e("./vos/VOLegendControl"),v=e("../../network/ClientNetwork"),C=e("../../network/LocalMessage"),S=cc._decorator,T=S.ccclass,I=S.property,N=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ScrollView=null,t.BoxNode1=null,t.BoxNode2=null,t.MapNode=null,t.LineNode=null,t.CurTrophy=null,t.ProgressBarNode=null,t.DrawTotalButtonNode=null,t._legendCfgMap=new Map,t._playerScore=0,t._playerLegendData=null,t._curBelongMapId=0,t._boxArr=[],t._scrollViewChildNode=[],t}return a(t,e),t.path=function(){return"ui/chaunqi/prefab/ChuanQi"},t.prototype.onLoad=function(){var e=this;u.default.loadPrefab("ui/CommonPrefab/TopView").then(function(t){t.parent=e.node,t.getChildByName("goldDiamondContent").active=!1,t.getComponent("TopView").bindExitEvent(function(){e.closeView();var t=f.default.getViewByName("MainSceneView");t&&t.view&&t.view.onRefreshLegendRedPoint()})}).catch(function(e){c.default.info(e)}),this.ScrollView.node.active=!1,v.ClientNetwork.getInstance().listenLocalMessage(C.LOCAL_MESSAGE.LocalMsg_SyncCostGet,function(){this.onRefreshLegendWorshipRedPoint()},this)},t.prototype.start=function(){var e=this,t=h.default.getCurSeasonData();if(this.ScrollView.node.active=!1,this._playerScore=h.default.getRoleAttrValByKey(m.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE),this._playerLegendData=h.default.getLegendData(),l.LegendTableData.getDataMap().forEach(function(o,i){o.seasonId==t.seasonID&&e._legendCfgMap.set(i,o)}),this._legendCfgMap.size<=0||!t)return r.G.StringManager.PopString("\u8d5b\u5b63\u6570\u636e\u5f02\u5e38\uff01"),this.closeView();var o=0,i=0,a=0;this._legendCfgMap.forEach(function(t){a++,t.pointX>o&&(o=t.pointX),e._playerScore>=t.cupNum&&t.nUnlockMapId>0&&(e._curBelongMapId=t.nUnlockMapId),a>1&&a<e._legendCfgMap.size&&t.pointX>i&&(i=t.pointX)}),this.ScrollView.content.width=o,this.ProgressBarNode.width=i,this.ProgressBarNode.getChildByName("bar").width=0,this.ProgressBarNode.x=(o-i)/2,this.initTrophyProgress(),this.initBoxMap();var n=t.seasonID,s=this.node.getChildByName("titleLab").getComponent(cc.Sprite),d=this.node.getChildByName("titleTimeLab").getComponent(cc.Label);0==n?(d.node.active=!1,s.node.active=!1):(u.default.loadSpriteFrame("ui/chaunqi/textures/"+_.SeasonTableData.getById(n).nameUrl).then(function(e){s.spriteFrame=e}).catch(function(e){c.default.info(e)}),this.onRefreshSeasonEndTime(),this.schedule(this.onRefreshSeasonEndTime,30)),this.onRefreshTotalBtnState(),this.onRefreshLegendWorshipRedPoint()},t.prototype.onRefreshSeasonEndTime=function(){var e=this.node.getChildByName("titleTimeLab").getComponent(cc.Label),t=h.default.getCurSeasonData();t||c.default.log("\u6ca1\u6709\u8d5b\u5b63\u6570\u636e");var o=h.default.getServersTime(),i=t.seasonEndTime-o;if(i<=0)return e.node.active=!1,void this.unschedule(this.onRefreshSeasonEndTime);e.string=r.G.StringManager.getString("SEASON_END")+function(e){var t=e%864e5/36e5,o=e%36e5/6e4;return parseInt((e/864e5).toString())+" \u5929 "+parseInt(t.toString())+" \u5c0f\u65f6 "+parseInt(o.toString())+" \u5206\u949f "}.call(this,1e3*i)},t.prototype.init=function(){var e=this;this.ScrollView.node.active=!1,this.ScrollView.node.width=this.node.width,this.ScrollView.node.getChildByName("view").width=this.node.width,this.node.getChildByName("vVsibleNode").width=this.node.width,this.ScrollView.node.x=-this.node.width/2,setTimeout(function(){e.ScrollView.node.active=!0;for(var t=!1,o=0,i=e._scrollViewChildNode.length;o<i;o++)if((s=e._scrollViewChildNode[o]).cupNum&&e._playerScore>=s.cupNum&&!1===e.checkRewards(s.cupNum)){var a=e.ScrollView.getMaxScrollOffset(),n=s.x>a.x?a.x:s.x;e.ScrollView.setContentPosition(cc.v2(-n+s.width,0)),t=!0;break}if(0==t){var r=null;for(o=0,i=e._scrollViewChildNode.length;o<i;o++){var s;(s=e._scrollViewChildNode[o]).cupNum&&e._playerScore>=s.cupNum&&(r=s)}r&&(a=e.ScrollView.getMaxScrollOffset(),n=r.x>a.x?a.x:r.x,e.ScrollView.setContentPosition(cc.v2(-n+r.width,0)))}},150)},t.prototype.onScrollViewCallBack=function(){for(var e=this.node.getChildByName("vVsibleNode").getBoundingBoxToWorld(),t=0,o=this._scrollViewChildNode.length;t<o;t++){var i=this._scrollViewChildNode[t].getBoundingBoxToWorld().intersects(e);this._scrollViewChildNode[t]&&this._scrollViewChildNode[t].isValid&&this._scrollViewChildNode[t].active!=i&&(this._scrollViewChildNode[t].active=i)}},t.prototype.onRefreshTotalBtnState=function(){var e=this,t=[];this._legendCfgMap.forEach(function(o){o.cupNum>0&&e._playerScore>=o.cupNum&&!1===e.checkRewards(o.cupNum)&&o.boxType>0&&t.push(o.cupNum)}),t.length<=0&&(this.DrawTotalButtonNode.getComponent(cc.Button).interactable=!1,this.DrawTotalButtonNode.getComponent(cc.Button).enableAutoGrayEffect=!0)},t.prototype.onHelpCallBack=function(){f.default.addPopView("BaseCtrl","LegendHelpView","LegendHelpView")},t.prototype.initTrophyProgress=function(){var e=this,t=null,o=null;if(this._legendCfgMap.forEach(function(i){if(i.boxType>0){var a=cc.instantiate(e.LineNode);a.parent=e.ProgressBarNode,a.x=i.pointX-2,a.y=6,a.active=!0,a.getChildByName("LineLabel").getComponent(cc.Label).string=i.cupNum.toString(),e._scrollViewChildNode.push(a),o=i}e._playerScore>=i.cupNum&&(t=i)}),o&&this._playerScore>=o.cupNum)return this.CurTrophy.x=o.pointX,this.ProgressBarNode.getChildByName("bar").width=this.ProgressBarNode.width,void(this.CurTrophy.getChildByName("CupLabel").getComponent(cc.Label).string=this._playerScore.toString());if(t&&this._legendCfgMap){var i=this._legendCfgMap.get(t.id+1);if(i){var a=this._playerScore-t.cupNum,n=i.cupNum-t.cupNum,r=(i.pointX-t.pointX)*(a/n),s=t.pointX+r;this.CurTrophy.x=s,isNaN(this.CurTrophy.x)&&(this.CurTrophy.x=0),this.ProgressBarNode.getChildByName("bar").width=s}}this.CurTrophy.getChildByName("CupLabel").getComponent(cc.Label).string=this._playerScore.toString()},t.prototype.initBoxMap=function(){var e=this,t=[];Array.from(this._legendCfgMap.keys(),function(e){t.push(e)}),p.default.startFraming(t.length,function(o){if(e._legendCfgMap){var i=e._legendCfgMap.get(t[o]),a=null;if(1===i.boxType)(a=cc.instantiate(e.BoxNode1)).getChildByName("BoxSprite").getComponent(sp.Skeleton).setAnimation(0,"idle",!0),a.y=125;else if(2===i.boxType)(a=cc.instantiate(e.BoxNode2)).getChildByName("BoxSprite").getComponent(sp.Skeleton).setAnimation(0,"idle",!0),a.y=145;else if(3===i.boxType){var n=cc.instantiate(e.MapNode);n.active=!0,n.x=i.pointX,n.y=225,n.parent=e.ProgressBarNode,u.default.loadSpriteFrame(i.map_res).then(function(e){n.getComponent(cc.Sprite).spriteFrame=e}).catch(function(e){c.default.info(e)}),n.getChildByName("MapNameLabel").getComponent(cc.Label).string=i.boxName;var r=e.checkRewards(i.cupNum),s=n.getChildByName("RewardLayout");i.boxItems.forEach(function(e){p.default.createNormalItems(e.itemID,e.itemNum,s,function(e){e.scale=.625,e.width=e.width*e.scale,e.height=e.height*e.scale,1==r&&p.default.setNodeBright(e,!1)})}),s.getComponent(cc.Layout).updateLayout(),n.getChildByName("SelectNode").active=!1,e._curBelongMapId>=i.nUnlockMapId&&(e._curBelongMapId==i.nUnlockMapId?n.getChildByName("SelectNode").active=!0:n.getChildByName("SelectNode").active=!1),n.boxType=i.boxType,n.cupNum=i.cupNum,n.rewards=i.boxItems,n.on(cc.Node.EventType.TOUCH_END,function(t){if(!(t.target.rewards.length<=0)){var o;o=e._playerScore<t.target.cupNum?0:!0===e.checkRewards(t.target.cupNum)?2:1,f.default.addPopView("BaseCtrl","RewardsPreviewView","RewardsPreviewView",{prizeNum:t.target.cupNum,rewards:t.target.rewards,rewardState:o})}}),e._scrollViewChildNode.push(n)}a&&(a.getChildByName("BoxNameLabel").getComponent(cc.Label).string=i.boxName,a.active=!0,a.parent=e.ProgressBarNode,a.x=i.pointX,e._playerScore>=i.cupNum&&!0===e.checkRewards(i.cupNum)&&(u.default.loadSpriteFrame("ui/chaunqi/textures/box_grey").then(function(e){a.getComponent(cc.Sprite).spriteFrame=e}).catch(function(e){c.default.info(e)}),cc.tween(a).delay(.2).call(function(){a.getChildByName("BoxSprite").getComponent(sp.Skeleton).setAnimation(1,"idle2",!0)}).start()),a.boxType=i.boxType,a.cupNum=i.cupNum,a.rewards=i.boxItems,a.on(cc.Node.EventType.TOUCH_END,function(t){var o;o=e._playerScore<t.target.cupNum?0:!0===e.checkRewards(t.target.cupNum)?2:1,f.default.addPopView("BaseCtrl","RewardsPreviewView","RewardsPreviewView",{prizeNum:t.target.cupNum,rewards:t.target.rewards,rewardState:o})}),e._boxArr.push(a),e._scrollViewChildNode.push(a))}})},t.prototype.checkRewards=function(e){this._playerLegendData||(this._playerLegendData=h.default.getLegendData());var t=!1;return this._playerLegendData.forEach(function(o,i){i==e&&1==o&&(t=!0)}),t},t.prototype.refreshBoxState=function(e){var t=this;if(this._playerLegendData=null,this._boxArr&&this._boxArr.length){this.onRefreshTotalBtnState(),e.forEach(function(e){for(var o="",i=function(i){var a=t._boxArr[i];if(a&&a.cupNum==e)return 1===a.boxType?o="ui/chaunqi/textures/box_grey":2===a.boxType&&(o="ui/chaunqi/textures/box_grey"),u.default.loadSpriteFrame(o).then(function(e){a.getComponent(cc.Sprite).spriteFrame=e}).catch(function(e){c.default.info(e)}),a.getChildByName("BoxSprite")&&a.getChildByName("BoxSprite").getComponent(sp.Skeleton).setAnimation(0,"idle2",!0),"break"},a=0;a<t._boxArr.length&&"break"!==i(a);a++);}),e.forEach(function(e){t._scrollViewChildNode.forEach(function(t){if(3==t.boxType){var o=t.getChildByName("RewardLayout");o&&t.cupNum==e&&o.children.forEach(function(e){p.default.setNodeBright(e,!1)})}})});var o=f.default.getViewByName("RewardsPreviewView");o&&o.view&&o.view.closeView()}else{var i=f.default.getViewByName("RewardsPreviewView");i&&i.view&&i.view.closeView()}},t.prototype.onTotalRewardCallBack=function(){var e=this,t=[];if(this._legendCfgMap.forEach(function(o){o.cupNum>0&&e._playerScore>=o.cupNum&&!1===e.checkRewards(o.cupNum)&&t.push(o.cupNum)}),t.length<=0)return r.G.StringManager.PopString(g.StringValueTableData.getById(10).string_value);this.sendEvent("SendProtocolLegendRewards",t)},t.prototype.onRewardCallBack=function(e){c.default.log("\u70b9\u51fb\u53d1\u9001\u9886\u53d6\u5956\u52b1",e),this.sendEvent("SendProtocolLegendRewards",[e])},t.prototype.onClickLegendPalaceCallBack=function(){f.default.addPopView("BaseCtrl","LegendPalaceView","LegendPalaceView")},t.prototype.onClickDescribeCallBack=function(){f.default.addPopView("BaseCtrl","LegendIntroduceView","LegendIntroduceView")},t.prototype.onDestroy=function(){this.unschedule(this.onRefreshSeasonEndTime)},t.prototype.onRefreshLegendWorshipRedPoint=function(){var e=this.node.getChildByName("DiantangButton").getChildByName("redpoint");e&&(e.active=y.default.refreshShowWorshipRedPoint())},n([I(cc.ScrollView)],t.prototype,"ScrollView",void 0),n([I(cc.Node)],t.prototype,"BoxNode1",void 0),n([I(cc.Node)],t.prototype,"BoxNode2",void 0),n([I(cc.Node)],t.prototype,"MapNode",void 0),n([I(cc.Node)],t.prototype,"LineNode",void 0),n([I(cc.Node)],t.prototype,"CurTrophy",void 0),n([I(cc.Node)],t.prototype,"ProgressBarNode",void 0),n([I(cc.Node)],t.prototype,"DrawTotalButtonNode",void 0),n([d.Register_Class,T],t)}(s.default);o.default=N,cc._RF.pop()},{"../../../scripts/modules/base/Decorators":"Decorators","../../Global/GameGlobal":"GameGlobal","../../StaticData/LegendTableData":"LegendTableData","../../StaticData/SeasonTableData":"SeasonTableData","../../StaticData/StringValueTableData":"StringValueTableData","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/GameView":"GameView","../../modules/manager/LoadResManager":"LoadResManager","../../network/ClientNetwork":"ClientNetwork","../../network/LocalMessage":"LocalMessage","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/GameTools":"GameTools","../../utils/LogUtil":"LogUtil","./vos/VOLegendControl":"VOLegendControl"}],LeniuGameUtils:[function(e,t,o){"use strict";cc._RF.push(t,"3d44545hXRBkKqFsqmHmZaN","LeniuGameUtils"),Object.defineProperty(o,"__esModule",{value:!0}),o.LeniuGameUtils=void 0;var i=e("./GamePlatform"),a=function(){function e(){}return Object.defineProperty(e,"Instance",{get:function(){return null==e.g_instance&&(e.g_instance=new e),e.g_instance},enumerable:!1,configurable:!0}),e.prototype.isLeniu=function(){return"leniu"==i.GamePlatform.getMiYaVideoTypeNoSet()},e.prototype.reportPlayerInfo=function(){},e.g_instance=null,e}();o.LeniuGameUtils=a,cc._RF.pop()},{"./GamePlatform":"GamePlatform"}],ListItem:[function(e,t,o){"use strict";cc._RF.push(t,"f5f9dQcvstBNrjqgG4o2aKr","ListItem");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r,s=cc._decorator,c=s.ccclass,l=s.property,d=s.disallowMultiple,u=s.executionOrder;(function(e){e[e.NONE=0]="NONE",e[e.TOGGLE=1]="TOGGLE",e[e.SWITCH=2]="SWITCH"})(r||(r={}));var h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.icon=null,t.title=null,t.selectedMode=r.NONE,t.selectedFlag=null,t.selectedSpriteFrame=null,t._unselectedSpriteFrame=null,t.adaptiveSize=!1,t._selected=!1,t._eventReg=!1,t}return a(t,e),Object.defineProperty(t.prototype,"selected",{get:function(){return this._selected},set:function(e){if(this._selected=e,this.selectedFlag)switch(this.selectedMode){case r.TOGGLE:this.selectedFlag.active=e;break;case r.SWITCH:var t=this.selectedFlag.getComponent(cc.Sprite);t&&(t.spriteFrame=e?this.selectedSpriteFrame:this._unselectedSpriteFrame)}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"btnCom",{get:function(){return this._btnCom||(this._btnCom=this.node.getComponent(cc.Button)),this._btnCom},enumerable:!1,configurable:!0}),t.prototype.onLoad=function(){if(this.selectedMode==r.SWITCH){var e=this.selectedFlag.getComponent(cc.Sprite);this._unselectedSpriteFrame=e.spriteFrame}},t.prototype.onDestroy=function(){this.node.off(cc.Node.EventType.SIZE_CHANGED,this._onSizeChange,this)},t.prototype._registerEvent=function(){this._eventReg||(this.btnCom&&this.list.selectedMode>0&&this.btnCom.clickEvents.unshift(this.createEvt(this,"onClickThis")),this.adaptiveSize&&this.node.on(cc.Node.EventType.SIZE_CHANGED,this._onSizeChange,this),this._eventReg=!0)},t.prototype._onSizeChange=function(){this.list._onItemAdaptive(this.node)},t.prototype.createEvt=function(e,t,o){if(void 0===o&&(o=null),e&&e.isValid){e.comName=e.comName||e.name.match(/\<(.*?)\>/g).pop().replace(/\<|>/g,"");var i=new cc.Component.EventHandler;return i.target=o||e.node,i.component=e.comName,i.handler=t,i}},t.prototype.showAni=function(e,t,o){var i,a=this;switch(e){case 0:i=cc.tween(a.node).to(.2,{scale:.7}).by(.3,{y:2*a.node.height});break;case 1:i=cc.tween(a.node).to(.2,{scale:.7}).by(.3,{x:2*a.node.width});break;case 2:i=cc.tween(a.node).to(.2,{scale:.7}).by(.3,{y:-2*a.node.height});break;case 3:i=cc.tween(a.node).to(.2,{scale:.7}).by(.3,{x:-2*a.node.width});break;default:i=cc.tween(a.node).to(.3,{scale:.1})}(t||o)&&i.call(function(){if(o){a.list._delSingleItem(a.node);for(var e=a.list.displayData.length-1;e>=0;e--)if(a.list.displayData[e].id==a.listId){a.list.displayData.splice(e,1);break}}t()}),i.start()},t.prototype.onClickThis=function(){this.list.selectedId=this.listId},n([l({type:cc.Sprite,tooltip:!1})],t.prototype,"icon",void 0),n([l({type:cc.Node,tooltip:!1})],t.prototype,"title",void 0),n([l({type:cc.Enum(r),tooltip:!1})],t.prototype,"selectedMode",void 0),n([l({type:cc.Node,tooltip:!1,visible:function(){return this.selectedMode>r.NONE}})],t.prototype,"selectedFlag",void 0),n([l({type:cc.SpriteFrame,tooltip:!1,visible:function(){return this.selectedMode==r.SWITCH}})],t.prototype,"selectedSpriteFrame",void 0),n([l({tooltip:!1})],t.prototype,"adaptiveSize",void 0),n([c,d(),u(-5001)],t)}(cc.Component);o.default=h,cc._RF.pop()},{}],List:[function(e,t,o){"use strict";cc._RF.push(t,"57d98boUj1Pg6hByY/KJ1o0","List");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r,s,c,l=cc._decorator,d=l.ccclass,u=l.property,h=l.disallowMultiple,p=l.executionOrder,f=l.requireComponent,g=e("./ListItem");(function(e){e[e.NODE=1]="NODE",e[e.PREFAB=2]="PREFAB"})(r||(r={})),function(e){e[e.NORMAL=1]="NORMAL",e[e.ADHERING=2]="ADHERING",e[e.PAGE=3]="PAGE"}(s||(s={})),function(e){e[e.NONE=0]="NONE",e[e.SINGLE=1]="SINGLE",e[e.MULT=2]="MULT"}(c||(c={}));var m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.templateType=r.NODE,t.tmpNode=null,t.tmpPrefab=null,t._slideMode=s.NORMAL,t.pageDistance=.3,t.pageChangeEvent=new cc.Component.EventHandler,t._virtual=!0,t.cyclic=!1,t.lackCenter=!1,t.lackSlide=!1,t._updateRate=0,t.frameByFrameRenderNum=0,t.renderEvent=new cc.Component.EventHandler,t.selectedMode=c.NONE,t.repeatEventSingle=!1,t.selectedEvent=new cc.Component.EventHandler,t._selectedId=-1,t._forceUpdate=!1,t._updateDone=!0,t._numItems=0,t._inited=!1,t._needUpdateWidget=!1,t._aniDelRuning=!1,t._doneAfterUpdate=!1,t.adhering=!1,t._adheringBarrier=!1,t.curPageNum=0,t}return a(t,e),Object.defineProperty(t.prototype,"slideMode",{get:function(){return this._slideMode},set:function(e){this._slideMode=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"virtual",{get:function(){return this._virtual},set:function(e){null!=e&&(this._virtual=e),0!=this._numItems&&this._onScrolling()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"updateRate",{get:function(){return this._updateRate},set:function(e){e>=0&&e<=6&&(this._updateRate=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selectedId",{get:function(){return this._selectedId},set:function(e){var t,o=this;switch(o.selectedMode){case c.SINGLE:if(!o.repeatEventSingle&&e==o._selectedId)return;t=o.getItemByListId(e);var i=void 0;if(o._selectedId>=0?o._lastSelectedId=o._selectedId:o._lastSelectedId=null,o._selectedId=e,t&&((i=t.getComponent(g.default)).selected=!0),o._lastSelectedId>=0&&o._lastSelectedId!=o._selectedId){var a=o.getItemByListId(o._lastSelectedId);a&&(a.getComponent(g.default).selected=!1)}o.selectedEvent&&cc.Component.EventHandler.emitEvents([o.selectedEvent],t,e%this._actualNumItems,null==o._lastSelectedId?null:o._lastSelectedId%this._actualNumItems);break;case c.MULT:if(!(t=o.getItemByListId(e)))return;i=t.getComponent(g.default),o._selectedId>=0&&(o._lastSelectedId=o._selectedId),o._selectedId=e;var n=!i.selected;i.selected=n;var r=o.multSelected.indexOf(e);n&&r<0?o.multSelected.push(e):!n&&r>=0&&o.multSelected.splice(r,1),o.selectedEvent&&cc.Component.EventHandler.emitEvents([o.selectedEvent],t,e%this._actualNumItems,null==o._lastSelectedId?null:o._lastSelectedId%this._actualNumItems,n)}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"numItems",{get:function(){return this._actualNumItems},set:function(e){var t=this;if(t.checkInited(!1))if(null==e||e<0)cc.error("numItems set the wrong::",e);else if(t._actualNumItems=t._numItems=e,t._forceUpdate=!0,t._virtual)t._resizeContent(),t.cyclic&&(t._numItems=t._cyclicNum*t._numItems),t._onScrolling(),t.frameByFrameRenderNum||t.slideMode!=s.PAGE||(t.curPageNum=t.nearestListId);else{t.cyclic&&(t._resizeContent(),t._numItems=t._cyclicNum*t._numItems);var o=t.content.getComponent(cc.Layout);if(o&&(o.enabled=!0),t._delRedundantItem(),t.firstListId=0,t.frameByFrameRenderNum>0){for(var i=t.frameByFrameRenderNum>t._numItems?t._numItems:t.frameByFrameRenderNum,a=0;a<i;a++)t._createOrUpdateItem2(a);t.frameByFrameRenderNum<t._numItems&&(t._updateCounter=t.frameByFrameRenderNum,t._updateDone=!1)}else{for(a=0;a<t._numItems;a++)t._createOrUpdateItem2(a);t.displayItemNum=t._numItems}}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scrollView",{get:function(){return this._scrollView},enumerable:!1,configurable:!0}),t.prototype.onLoad=function(){this._init()},t.prototype.onDestroy=function(){var e=this;cc.isValid(e._itemTmp)&&e._itemTmp.destroy(),cc.isValid(e.tmpNode)&&e.tmpNode.destroy(),e._pool&&e._pool.clear()},t.prototype.onEnable=function(){this._registerEvent(),this._init(),this._aniDelRuning&&(this._aniDelRuning=!1,this._aniDelItem&&(this._aniDelBeforePos&&(this._aniDelItem.position=this._aniDelBeforePos,delete this._aniDelBeforePos),this._aniDelBeforeScale&&(this._aniDelItem.scale=this._aniDelBeforeScale,delete this._aniDelBeforeScale),delete this._aniDelItem),this._aniDelCB&&(this._aniDelCB(),delete this._aniDelCB))},t.prototype.onDisable=function(){this._unregisterEvent()},t.prototype._registerEvent=function(){var e=this;e.node.on(cc.Node.EventType.TOUCH_START,e._onTouchStart,e,!0),e.node.on("touch-up",e._onTouchUp,e),e.node.on(cc.Node.EventType.TOUCH_CANCEL,e._onTouchCancelled,e,!0),e.node.on("scroll-began",e._onScrollBegan,e,!0),e.node.on("scroll-ended",e._onScrollEnded,e,!0),e.node.on("scrolling",e._onScrolling,e,!0),e.node.on(cc.Node.EventType.SIZE_CHANGED,e._onSizeChanged,e)},t.prototype._unregisterEvent=function(){var e=this;e.node.off(cc.Node.EventType.TOUCH_START,e._onTouchStart,e,!0),e.node.off("touch-up",e._onTouchUp,e),e.node.off(cc.Node.EventType.TOUCH_CANCEL,e._onTouchCancelled,e,!0),e.node.off("scroll-began",e._onScrollBegan,e,!0),e.node.off("scroll-ended",e._onScrollEnded,e,!0),e.node.off("scrolling",e._onScrolling,e,!0),e.node.off(cc.Node.EventType.SIZE_CHANGED,e._onSizeChanged,e)},t.prototype._init=function(){var e=this;if(!e._inited)if(e._scrollView=e.node.getComponent(cc.ScrollView),e.content=e._scrollView.content,e.content){switch(e._layout=e.content.getComponent(cc.Layout),e._align=e._layout.type,e._resizeMode=e._layout.resizeMode,e._startAxis=e._layout.startAxis,e._topGap=e._layout.paddingTop,e._rightGap=e._layout.paddingRight,e._bottomGap=e._layout.paddingBottom,e._leftGap=e._layout.paddingLeft,e._columnGap=e._layout.spacingX,e._lineGap=e._layout.spacingY,e._colLineNum,e._verticalDir=e._layout.verticalDirection,e._horizontalDir=e._layout.horizontalDirection,e.setTemplateItem(cc.instantiate(e.templateType==r.PREFAB?e.tmpPrefab:e.tmpNode)),e._slideMode!=s.ADHERING&&e._slideMode!=s.PAGE||(e._scrollView.inertia=!1,e._scrollView._onMouseWheel=function(){}),e.virtual||(e.lackCenter=!1),e._lastDisplayData=[],e.displayData=[],e._pool=new cc.NodePool,e._forceUpdate=!1,e._updateCounter=0,e._updateDone=!0,e.curPageNum=0,e.cyclic&&(e._scrollView._processAutoScrolling=this._processAutoScrolling.bind(e),e._scrollView._startBounceBackIfNeeded=function(){return!1}),e._align){case cc.Layout.Type.HORIZONTAL:switch(e._horizontalDir){case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:e._alignCalcType=1;break;case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:e._alignCalcType=2}break;case cc.Layout.Type.VERTICAL:switch(e._verticalDir){case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:e._alignCalcType=3;break;case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:e._alignCalcType=4}break;case cc.Layout.Type.GRID:switch(e._startAxis){case cc.Layout.AxisDirection.HORIZONTAL:switch(e._verticalDir){case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:e._alignCalcType=3;break;case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:e._alignCalcType=4}break;case cc.Layout.AxisDirection.VERTICAL:switch(e._horizontalDir){case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:e._alignCalcType=1;break;case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:e._alignCalcType=2}}}e.content.removeAllChildren(),e._inited=!0}else cc.error(e.node.name+"'s cc.ScrollView unset content!")},t.prototype._processAutoScrolling=function(e){this._scrollView._autoScrollAccumulatedTime+=1*e;var t=Math.min(1,this._scrollView._autoScrollAccumulatedTime/this._scrollView._autoScrollTotalTime);if(this._scrollView._autoScrollAttenuate){var o=t-1;t=o*o*o*o*o+1}var i=this._scrollView._autoScrollStartPosition.add(this._scrollView._autoScrollTargetDelta.mul(t)),a=this._scrollView.getScrollEndedEventTiming(),n=Math.abs(t-1)<=a;Math.abs(t-1)<=this._scrollView.getScrollEndedEventTiming()&&!this._scrollView._isScrollEndedWithThresholdEventFired&&(this._scrollView._dispatchEvent("scroll-ended-with-threshold"),this._scrollView._isScrollEndedWithThresholdEventFired=!0),n&&(this._scrollView._autoScrolling=!1);var r=i.sub(this._scrollView.getContentPosition());this._scrollView._moveContent(this._scrollView._clampDelta(r),n),this._scrollView._dispatchEvent("scrolling"),this._scrollView._autoScrolling||(this._scrollView._isBouncing=!1,this._scrollView._scrolling=!1,this._scrollView._dispatchEvent("scroll-ended"))},t.prototype.setTemplateItem=function(e){if(e){var t=this;t._itemTmp=e,t._resizeMode==cc.Layout.ResizeMode.CHILDREN?t._itemSize=t._layout.cellSize:t._itemSize=cc.size(e.width,e.height);var o=e.getComponent(g.default),i=!1;switch(o||(i=!0),i&&(t.selectedMode=c.NONE),(o=e.getComponent(cc.Widget))&&o.enabled&&(t._needUpdateWidget=!0),t.selectedMode==c.MULT&&(t.multSelected=[]),t._align){case cc.Layout.Type.HORIZONTAL:t._colLineNum=1,t._sizeType=!1;break;case cc.Layout.Type.VERTICAL:t._colLineNum=1,t._sizeType=!0;break;case cc.Layout.Type.GRID:switch(t._startAxis){case cc.Layout.AxisDirection.HORIZONTAL:var a=t.content.width-t._leftGap-t._rightGap;t._colLineNum=Math.floor((a+t._columnGap)/(t._itemSize.width+t._columnGap)),t._sizeType=!0;break;case cc.Layout.AxisDirection.VERTICAL:var n=t.content.height-t._topGap-t._bottomGap;t._colLineNum=Math.floor((n+t._lineGap)/(t._itemSize.height+t._lineGap)),t._sizeType=!1}}}},t.prototype.checkInited=function(e){return void 0===e&&(e=!0),!!this._inited||(e&&cc.error("List initialization not completed!"),!1)},t.prototype._resizeContent=function(){var e,t=this;switch(t._align){case cc.Layout.Type.HORIZONTAL:if(t._customSize){var o=t._getFixedSize(null);e=t._leftGap+o.val+t._itemSize.width*(t._numItems-o.count)+t._columnGap*(t._numItems-1)+t._rightGap}else e=t._leftGap+t._itemSize.width*t._numItems+t._columnGap*(t._numItems-1)+t._rightGap;break;case cc.Layout.Type.VERTICAL:t._customSize?(o=t._getFixedSize(null),e=t._topGap+o.val+t._itemSize.height*(t._numItems-o.count)+t._lineGap*(t._numItems-1)+t._bottomGap):e=t._topGap+t._itemSize.height*t._numItems+t._lineGap*(t._numItems-1)+t._bottomGap;break;case cc.Layout.Type.GRID:switch(t.lackCenter&&(t.lackCenter=!1),t._startAxis){case cc.Layout.AxisDirection.HORIZONTAL:var i=Math.ceil(t._numItems/t._colLineNum);e=t._topGap+t._itemSize.height*i+t._lineGap*(i-1)+t._bottomGap;break;case cc.Layout.AxisDirection.VERTICAL:var a=Math.ceil(t._numItems/t._colLineNum);e=t._leftGap+t._itemSize.width*a+t._columnGap*(a-1)+t._rightGap}}var n=t.content.getComponent(cc.Layout);if(n&&(n.enabled=!1),t._allItemSize=e,t._allItemSizeNoEdge=t._allItemSize-(t._sizeType?t._topGap+t._bottomGap:t._leftGap+t._rightGap),t.cyclic){var r=t._sizeType?t.node.height:t.node.width;t._cyclicPos1=0,r-=t._cyclicPos1,t._cyclicNum=Math.ceil(r/t._allItemSizeNoEdge)+1;var s=t._sizeType?t._lineGap:t._columnGap;t._cyclicPos2=t._cyclicPos1+t._allItemSizeNoEdge+s,t._cyclicAllItemSize=t._allItemSize+t._allItemSizeNoEdge*(t._cyclicNum-1)+s*(t._cyclicNum-1),t._cycilcAllItemSizeNoEdge=t._allItemSizeNoEdge*t._cyclicNum,t._cycilcAllItemSizeNoEdge+=s*(t._cyclicNum-1)}t._lack=!t.cyclic&&t._allItemSize<(t._sizeType?t.node.height:t.node.width);var c=t._lack&&t.lackCenter||!t.lackSlide?.1:0,l=t._lack?(t._sizeType?t.node.height:t.node.width)-c:t.cyclic?t._cyclicAllItemSize:t._allItemSize;l<0&&(l=0),t._sizeType?t.content.height=l:t.content.width=l},t.prototype._onScrolling=function(e){if(void 0===e&&(e=null),null==this.frameCount&&(this.frameCount=this._updateRate),!this._forceUpdate&&e&&"scroll-ended"!=e.type&&this.frameCount>0)this.frameCount--;else if(this.frameCount=this._updateRate,!this._aniDelRuning){if(this.cyclic){var t=this.content.getPosition();t=this._sizeType?t.y:t.x;var o=this._allItemSizeNoEdge+(this._sizeType?this._lineGap:this._columnGap),i=this._sizeType?cc.v2(0,o):cc.v2(o,0);switch(this._alignCalcType){case 1:t>-this._cyclicPos1?(this.content.x=-this._cyclicPos2,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.sub(i))):t<-this._cyclicPos2&&(this.content.x=-this._cyclicPos1,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.add(i)));break;case 2:t<this._cyclicPos1?(this.content.x=this._cyclicPos2,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.add(i))):t>this._cyclicPos2&&(this.content.x=this._cyclicPos1,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.sub(i)));break;case 3:t<this._cyclicPos1?(this.content.y=this._cyclicPos2,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.add(i))):t>this._cyclicPos2&&(this.content.y=this._cyclicPos1,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.sub(i)));break;case 4:t>-this._cyclicPos1?(this.content.y=-this._cyclicPos2,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.sub(i))):t<-this._cyclicPos2&&(this.content.y=-this._cyclicPos1,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.add(i)))}}var a,n,r,s;if(this._calcViewPos(),this._sizeType?(a=this.viewTop,r=this.viewBottom):(n=this.viewRight,s=this.viewLeft),this._virtual){this.displayData=[];var c=void 0,l=0,d=this._numItems-1;if(this._customSize)for(var u=!1;l<=d&&!u;l++)switch(c=this._calcItemPos(l),this._align){case cc.Layout.Type.HORIZONTAL:c.right>=s&&c.left<=n?this.displayData.push(c):0!=l&&this.displayData.length>0&&(u=!0);break;case cc.Layout.Type.VERTICAL:c.bottom<=a&&c.top>=r?this.displayData.push(c):0!=l&&this.displayData.length>0&&(u=!0);break;case cc.Layout.Type.GRID:switch(this._startAxis){case cc.Layout.AxisDirection.HORIZONTAL:c.bottom<=a&&c.top>=r?this.displayData.push(c):0!=l&&this.displayData.length>0&&(u=!0);break;case cc.Layout.AxisDirection.VERTICAL:c.right>=s&&c.left<=n?this.displayData.push(c):0!=l&&this.displayData.length>0&&(u=!0)}}else{var h=this._itemSize.width+this._columnGap,p=this._itemSize.height+this._lineGap;switch(this._alignCalcType){case 1:l=(s-this._leftGap)/h,d=(n-this._leftGap)/h;break;case 2:l=(-n-this._rightGap)/h,d=(-s-this._rightGap)/h;break;case 3:l=(-a-this._topGap)/p,d=(-r-this._topGap)/p;break;case 4:l=(r-this._bottomGap)/p,d=(a-this._bottomGap)/p}for(l=Math.floor(l)*this._colLineNum,d=Math.ceil(d)*this._colLineNum,l<0&&(l=0),--d>=this._numItems&&(d=this._numItems-1);l<=d;l++)this.displayData.push(this._calcItemPos(l))}if(this._delRedundantItem(),this.displayData.length<=0||!this._numItems)return void(this._lastDisplayData=[]);this.firstListId=this.displayData[0].id,this.displayItemNum=this.displayData.length;var f=this._lastDisplayData.length,g=this.displayItemNum!=f;if(g&&(this.frameByFrameRenderNum>0&&this._lastDisplayData.sort(function(e,t){return e-t}),g=this.firstListId!=this._lastDisplayData[0]||this.displayData[this.displayItemNum-1].id!=this._lastDisplayData[f-1]),this._forceUpdate||g)if(this.frameByFrameRenderNum>0)this._numItems>0?(this._updateDone?this._updateCounter=0:this._doneAfterUpdate=!0,this._updateDone=!1):(this._updateCounter=0,this._updateDone=!0);else{this._lastDisplayData=[];for(var m=0;m<this.displayItemNum;m++)this._createOrUpdateItem(this.displayData[m]);this._forceUpdate=!1}this._calcNearestItem()}}},t.prototype._calcViewPos=function(){var e=this.content.getPosition();switch(this._alignCalcType){case 1:this.elasticLeft=e.x>0?e.x:0,this.viewLeft=(e.x<0?-e.x:0)-this.elasticLeft,this.viewRight=this.viewLeft+this.node.width,this.elasticRight=this.viewRight>this.content.width?Math.abs(this.viewRight-this.content.width):0,this.viewRight+=this.elasticRight;break;case 2:this.elasticRight=e.x<0?-e.x:0,this.viewRight=(e.x>0?-e.x:0)+this.elasticRight,this.viewLeft=this.viewRight-this.node.width,this.elasticLeft=this.viewLeft<-this.content.width?Math.abs(this.viewLeft+this.content.width):0,this.viewLeft-=this.elasticLeft;break;case 3:this.elasticTop=e.y<0?Math.abs(e.y):0,this.viewTop=(e.y>0?-e.y:0)+this.elasticTop,this.viewBottom=this.viewTop-this.node.height-this.node.height/2,this.elasticBottom=this.viewBottom<-this.content.height?Math.abs(this.viewBottom+this.content.height):0,this.viewBottom+=this.elasticBottom;break;case 4:this.elasticBottom=e.y>0?Math.abs(e.y):0,this.viewBottom=(e.y<0?-e.y:0)-this.elasticBottom,this.viewTop=this.viewBottom+this.node.height,this.elasticTop=this.viewTop>this.content.height?Math.abs(this.viewTop-this.content.height):0,this.viewTop-=this.elasticTop}},t.prototype._calcItemPos=function(e){var t,o,i,a,n,r,s,c;switch(this._align){case cc.Layout.Type.HORIZONTAL:switch(this._horizontalDir){case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:if(this._customSize){var l=this._getFixedSize(e);n=this._leftGap+(this._itemSize.width+this._columnGap)*(e-l.count)+(l.val+this._columnGap*l.count),t=(d=this._customSize[e])>0?d:this._itemSize.width}else n=this._leftGap+(this._itemSize.width+this._columnGap)*e,t=this._itemSize.width;return this.lackCenter&&(n-=this._leftGap,n+=this.content.width/2-this._allItemSizeNoEdge/2),{id:e,left:n,right:r=n+t,x:n+this._itemTmp.anchorX*t,y:this._itemTmp.y};case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:return this._customSize?(l=this._getFixedSize(e),r=-this._rightGap-(this._itemSize.width+this._columnGap)*(e-l.count)-(l.val+this._columnGap*l.count),t=(d=this._customSize[e])>0?d:this._itemSize.width):(r=-this._rightGap-(this._itemSize.width+this._columnGap)*e,t=this._itemSize.width),this.lackCenter&&(r+=this._rightGap,r-=this.content.width/2-this._allItemSizeNoEdge/2),{id:e,right:r,left:n=r-t,x:n+this._itemTmp.anchorX*t,y:this._itemTmp.y}}break;case cc.Layout.Type.VERTICAL:switch(this._verticalDir){case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:return this._customSize?(l=this._getFixedSize(e),i=-this._topGap-(this._itemSize.height+this._lineGap)*(e-l.count)-(l.val+this._lineGap*l.count),o=(d=this._customSize[e])>0?d:this._itemSize.height):(i=-this._topGap-(this._itemSize.height+this._lineGap)*e,o=this._itemSize.height),this.lackCenter&&(i+=this._topGap,i-=this.content.height/2-this._allItemSizeNoEdge/2),{id:e,top:i,bottom:a=i-o,x:this._itemTmp.x,y:a+this._itemTmp.anchorY*o};case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:var d;if(this._customSize)l=this._getFixedSize(e),a=this._bottomGap+(this._itemSize.height+this._lineGap)*(e-l.count)+(l.val+this._lineGap*l.count),o=(d=this._customSize[e])>0?d:this._itemSize.height;else a=this._bottomGap+(this._itemSize.height+this._lineGap)*e,o=this._itemSize.height;return this.lackCenter&&(a-=this._bottomGap,a+=this.content.height/2-this._allItemSizeNoEdge/2),{id:e,top:i=a+o,bottom:a,x:this._itemTmp.x,y:a+this._itemTmp.anchorY*o}}case cc.Layout.Type.GRID:var u=Math.floor(e/this._colLineNum);switch(this._startAxis){case cc.Layout.AxisDirection.HORIZONTAL:switch(this._verticalDir){case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:c=(a=(i=-this._topGap-(this._itemSize.height+this._lineGap)*u)-this._itemSize.height)+this._itemTmp.anchorY*this._itemSize.height;break;case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:i=(a=this._bottomGap+(this._itemSize.height+this._lineGap)*u)+this._itemSize.height,c=a+this._itemTmp.anchorY*this._itemSize.height}switch(s=this._leftGap+e%this._colLineNum*(this._itemSize.width+this._columnGap),this._horizontalDir){case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:s+=this._itemTmp.anchorX*this._itemSize.width,s-=this.content.anchorX*this.content.width;break;case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:s+=(1-this._itemTmp.anchorX)*this._itemSize.width,s-=(1-this.content.anchorX)*this.content.width,s*=-1}return{id:e,top:i,bottom:a,x:s,y:c};case cc.Layout.AxisDirection.VERTICAL:switch(this._horizontalDir){case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:r=(n=this._leftGap+(this._itemSize.width+this._columnGap)*u)+this._itemSize.width,s=n+this._itemTmp.anchorX*this._itemSize.width,s-=this.content.anchorX*this.content.width;break;case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:s=(n=(r=-this._rightGap-(this._itemSize.width+this._columnGap)*u)-this._itemSize.width)+this._itemTmp.anchorX*this._itemSize.width,s+=(1-this.content.anchorX)*this.content.width}switch(c=-this._topGap-e%this._colLineNum*(this._itemSize.height+this._lineGap),this._verticalDir){case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:c-=(1-this._itemTmp.anchorY)*this._itemSize.height,c+=(1-this.content.anchorY)*this.content.height;break;case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:c-=this._itemTmp.anchorY*this._itemSize.height,c+=this.content.anchorY*this.content.height,c*=-1}return{id:e,left:n,right:r,x:s,y:c}}}},t.prototype._calcExistItemPos=function(e){var t=this.getItemByListId(e);if(!t)return null;var o={id:e,x:t.x,y:t.y};return this._sizeType?(o.top=t.y+t.height*(1-t.anchorY),o.bottom=t.y-t.height*t.anchorY):(o.left=t.x-t.width*t.anchorX,o.right=t.x+t.width*(1-t.anchorX)),o},t.prototype.getItemPos=function(e){return this._virtual?this._calcItemPos(e):this.frameByFrameRenderNum?this._calcItemPos(e):this._calcExistItemPos(e)},t.prototype._getFixedSize=function(e){if(!this._customSize)return null;null==e&&(e=this._numItems);var t=0,o=0;for(var i in this._customSize)parseInt(i)<e&&(t+=this._customSize[i],o++);return{val:t,count:o}},t.prototype._onScrollBegan=function(){this._beganPos=this._sizeType?this.viewTop:this.viewLeft},t.prototype._onScrollEnded=function(){var e=this;if(e.curScrollIsTouch=!1,null!=e.scrollToListId){var t=e.getItemByListId(e.scrollToListId);e.scrollToListId=null,t&&cc.tween(t).to(.1,{scale:1.06}).to(.1,{scale:1}).start()}e._onScrolling(),e._slideMode!=s.ADHERING||e.adhering?e._slideMode==s.PAGE&&(null!=e._beganPos&&e.curScrollIsTouch?this._pageAdhere():e.adhere()):e.adhere()},t.prototype._onTouchStart=function(e,t){if(!this._scrollView._hasNestedViewGroup(e,t)&&(this.curScrollIsTouch=!0,e.eventPhase!==cc.Event.AT_TARGET||e.target!==this.node)){for(var o=e.target;null==o._listId&&o.parent;)o=o.parent;this._scrollItem=null!=o._listId?o:e.target}},t.prototype._onTouchUp=function(){var e=this;e._scrollPos=null,e._slideMode==s.ADHERING?(this.adhering&&(this._adheringBarrier=!0),e.adhere()):e._slideMode==s.PAGE&&(null!=e._beganPos?this._pageAdhere():e.adhere()),this._scrollItem=null},t.prototype._onTouchCancelled=function(e,t){var o=this;o._scrollView._hasNestedViewGroup(e,t)||e.simulate||(o._scrollPos=null,o._slideMode==s.ADHERING?(o.adhering&&(o._adheringBarrier=!0),o.adhere()):o._slideMode==s.PAGE&&(null!=o._beganPos?o._pageAdhere():o.adhere()),this._scrollItem=null)},t.prototype._onSizeChanged=function(){this.checkInited(!1)&&this._onScrolling()},t.prototype._onItemAdaptive=function(e){if(!this._sizeType&&e.width!=this._itemSize.width||this._sizeType&&e.height!=this._itemSize.height){this._customSize||(this._customSize={});var t=this._sizeType?e.height:e.width;this._customSize[e._listId]!=t&&(this._customSize[e._listId]=t,this._resizeContent(),this.updateAll(),null!=this._scrollToListId&&(this._scrollPos=null,this.unschedule(this._scrollToSo),this.scrollTo(this._scrollToListId,Math.max(0,this._scrollToEndTime-(new Date).getTime()/1e3))))}},t.prototype._pageAdhere=function(){var e=this;if(e.cyclic||!(e.elasticTop>0||e.elasticRight>0||e.elasticBottom>0||e.elasticLeft>0)){var t=e._sizeType?e.viewTop:e.viewLeft,o=(e._sizeType?e.node.height:e.node.width)*e.pageDistance;if(Math.abs(e._beganPos-t)>o)switch(e._alignCalcType){case 1:case 4:e._beganPos>t?e.prePage(.5):e.nextPage(.5);break;case 2:case 3:e._beganPos<t?e.prePage(.5):e.nextPage(.5)}else e.elasticTop<=0&&e.elasticRight<=0&&e.elasticBottom<=0&&e.elasticLeft<=0&&e.adhere();e._beganPos=null}},t.prototype.adhere=function(){var e=this;if(e.checkInited()&&!(e.elasticTop>0||e.elasticRight>0||e.elasticBottom>0||e.elasticLeft>0)){e.adhering=!0,e._calcNearestItem();var t=(e._sizeType?e._topGap:e._leftGap)/(e._sizeType?e.node.height:e.node.width);e.scrollTo(e.nearestListId,.7,t)}},t.prototype.update=function(){if(!(this.frameByFrameRenderNum<=0||this._updateDone))if(this._virtual){for(var e=this._updateCounter+this.frameByFrameRenderNum>this.displayItemNum?this.displayItemNum:this._updateCounter+this.frameByFrameRenderNum,t=this._updateCounter;t<e;t++){var o=this.displayData[t];o&&this._createOrUpdateItem(o)}this._updateCounter>=this.displayItemNum-1?this._doneAfterUpdate?(this._updateCounter=0,this._updateDone=!1,this._doneAfterUpdate=!1):(this._updateDone=!0,this._delRedundantItem(),this._forceUpdate=!1,this._calcNearestItem(),this.slideMode==s.PAGE&&(this.curPageNum=this.nearestListId)):this._updateCounter+=this.frameByFrameRenderNum}else if(this._updateCounter<this._numItems){for(e=this._updateCounter+this.frameByFrameRenderNum>this._numItems?this._numItems:this._updateCounter+this.frameByFrameRenderNum,t=this._updateCounter;t<e;t++)this._createOrUpdateItem2(t);this._updateCounter+=this.frameByFrameRenderNum}else this._updateDone=!0,this._calcNearestItem(),this.slideMode==s.PAGE&&(this.curPageNum=this.nearestListId)},t.prototype._createOrUpdateItem=function(e){var t=this.getItemByListId(e.id);if(t)this._forceUpdate&&this.renderEvent&&(t.setPosition(cc.v2(e.x,e.y)),this._resetItemSize(t),this.renderEvent&&cc.Component.EventHandler.emitEvents([this.renderEvent],t,e.id%this._actualNumItems));else{var o=this._pool.size()>0;if(t=o?this._pool.get():cc.instantiate(this._itemTmp),o&&cc.isValid(t)||(t=cc.instantiate(this._itemTmp),o=!1),t._listId!=e.id&&(t._listId=e.id,t.setContentSize(this._itemSize)),t.setPosition(cc.v2(e.x,e.y)),this._resetItemSize(t),this.content.addChild(t),o&&this._needUpdateWidget){var i=t.getComponent(cc.Widget);i&&i.updateAlignment()}t.setSiblingIndex(this.content.childrenCount-1);var a=t.getComponent(g.default);t.listItem=a,a&&(a.listId=e.id,a.list=this,a._registerEvent()),this.renderEvent&&cc.Component.EventHandler.emitEvents([this.renderEvent],t,e.id%this._actualNumItems)}this._resetItemSize(t),this._updateListItem(t.listItem),this._lastDisplayData.indexOf(e.id)<0&&this._lastDisplayData.push(e.id)},t.prototype._createOrUpdateItem2=function(e){var t,o=this.content.children[e];o?this._forceUpdate&&this.renderEvent&&(o._listId=e,t&&(t.listId=e),this.renderEvent&&cc.Component.EventHandler.emitEvents([this.renderEvent],o,e%this._actualNumItems)):((o=cc.instantiate(this._itemTmp))._listId=e,this.content.addChild(o),t=o.getComponent(g.default),o.listItem=t,t&&(t.listId=e,t.list=this,t._registerEvent()),this.renderEvent&&cc.Component.EventHandler.emitEvents([this.renderEvent],o,e%this._actualNumItems)),this._updateListItem(t),this._lastDisplayData.indexOf(e)<0&&this._lastDisplayData.push(e)},t.prototype._updateListItem=function(e){if(e&&this.selectedMode>c.NONE){var t=e.node;switch(this.selectedMode){case c.SINGLE:e.selected=this.selectedId==t._listId;break;case c.MULT:e.selected=this.multSelected.indexOf(t._listId)>=0}}},t.prototype._resetItemSize=function(){},t.prototype._updateItemPos=function(e){var t=isNaN(e)?e:this.getItemByListId(e),o=this.getItemPos(t._listId);t.setPosition(o.x,o.y)},t.prototype.setMultSelected=function(e,t){var o=this;if(o.checkInited()){if(Array.isArray(e)||(e=[e]),null==t)o.multSelected=e;else{var i=void 0,a=void 0;if(t)for(var n=e.length-1;n>=0;n--)i=e[n],(a=o.multSelected.indexOf(i))<0&&o.multSelected.push(i);else for(n=e.length-1;n>=0;n--)i=e[n],(a=o.multSelected.indexOf(i))>=0&&o.multSelected.splice(a,1)}o._forceUpdate=!0,o._onScrolling()}},t.prototype.getMultSelected=function(){return this.multSelected},t.prototype.hasMultSelected=function(e){return this.multSelected&&this.multSelected.indexOf(e)>=0},t.prototype.updateItem=function(e){if(this.checkInited()){Array.isArray(e)||(e=[e]);for(var t=0,o=e.length;t<o;t++){var i=e[t],a=this.getItemByListId(i);a&&cc.Component.EventHandler.emitEvents([this.renderEvent],a,i%this._actualNumItems)}}},t.prototype.updateAll=function(){this.checkInited()&&(this.numItems=this.numItems)},t.prototype.getItemByListId=function(e){if(this.content)for(var t=this.content.childrenCount-1;t>=0;t--){var o=this.content.children[t];if(o._listId==e)return o}},t.prototype._getOutsideItem=function(){for(var e,t=[],o=this.content.childrenCount-1;o>=0;o--)e=this.content.children[o],this.displayData.find(function(t){return t.id==e._listId})||t.push(e);return t},t.prototype._delRedundantItem=function(){if(this._virtual)for(var e=this._getOutsideItem(),t=e.length-1;t>=0;t--){var o=e[t];if(!this._scrollItem||o._listId!=this._scrollItem._listId){o.isCached=!0,this._pool.put(o);for(var i=this._lastDisplayData.length-1;i>=0;i--)if(this._lastDisplayData[i]==o._listId){this._lastDisplayData.splice(i,1);break}}}else for(;this.content.childrenCount>this._numItems;)this._delSingleItem(this.content.children[this.content.childrenCount-1])},t.prototype._delSingleItem=function(e){e.removeFromParent(),e.destroy&&e.destroy(),e=null},t.prototype.aniDelItem=function(e,t,o){var i=this;if(!i.checkInited()||i.cyclic||!i._virtual)return cc.error("This function is not allowed to be called!");if(!t)return cc.error("CallFunc are not allowed to be NULL, You need to delete the corresponding index in the data array in the CallFunc!");if(i._aniDelRuning)return cc.warn("Please wait for the current deletion to finish!");var a,n=i.getItemByListId(e);if(n){a=n.getComponent(g.default),i._aniDelRuning=!0,i._aniDelCB=t,i._aniDelItem=n,i._aniDelBeforePos=n.position,i._aniDelBeforeScale=n.scale;var r=i.displayData[i.displayData.length-1].id,s=a.selected;a.showAni(o,function(){var o,a,l;if(r<i._numItems-2&&(o=r+1),null!=o){var d=i._calcItemPos(o);i.displayData.push(d),i._virtual?i._createOrUpdateItem(d):i._createOrUpdateItem2(o)}else i._numItems--;if(i.selectedMode==c.SINGLE)s?i._selectedId=-1:i._selectedId-1>=0&&i._selectedId--;else if(i.selectedMode==c.MULT&&i.multSelected.length){var u=i.multSelected.indexOf(e);u>=0&&i.multSelected.splice(u,1);for(var h=i.multSelected.length-1;h>=0;h--)(g=i.multSelected[h])>=e&&i.multSelected[h]--}if(i._customSize){i._customSize[e]&&delete i._customSize[e];var p={},f=void 0;for(var g in i._customSize){f=i._customSize[g];var m=parseInt(g);p[m-(m>=e?1:0)]=f}i._customSize=p}for(h=null!=o?o:r;h>=e+1;h--)if(n=i.getItemByListId(h)){var _=i._calcItemPos(h-1);a=cc.tween(n).to(.2333,{position:cc.v2(_.x,_.y)}),h<=e+1&&(l=!0,a.call(function(){i._aniDelRuning=!1,t(e),delete i._aniDelCB})),a.start()}l||(i._aniDelRuning=!1,t(e),i._aniDelCB=null)},!0)}else t(e)},t.prototype.scrollTo=function(e,t,o,i){void 0===t&&(t=.5),void 0===o&&(o=null),void 0===i&&(i=!1);var a=this;if(a.checkInited(!1)){null==t?t=.5:t<0&&(t=0),e<0?e=0:e>=a._numItems&&(e=a._numItems-1),!a._virtual&&a._layout&&a._layout.enabled&&a._layout.updateLayout();var n,r,s=a.getItemPos(e);if(!s)return!1;switch(a._alignCalcType){case 1:n=s.left,n-=null!=o?a.node.width*o:a._leftGap,s=cc.v2(n,0);break;case 2:n=s.right-a.node.width,n+=null!=o?a.node.width*o:a._rightGap,s=cc.v2(n+a.content.width,0);break;case 3:r=s.top,r+=null!=o?a.node.height*o:a._topGap,s=cc.v2(0,-r);break;case 4:r=s.bottom+a.node.height,r-=null!=o?a.node.height*o:a._bottomGap,s=cc.v2(0,-r+a.content.height)}var c=a.content.getPosition();c=Math.abs(a._sizeType?c.y:c.x);var l=a._sizeType?s.y:s.x;Math.abs((null!=a._scrollPos?a._scrollPos:c)-l)>.5&&(a._scrollView.scrollToOffset(s,t),a._scrollToListId=e,a._scrollToEndTime=(new Date).getTime()/1e3+t,a._scrollToSo=a.scheduleOnce(function(){if(a._adheringBarrier||(a.adhering=a._adheringBarrier=!1),a._scrollPos=a._scrollToListId=a._scrollToEndTime=a._scrollToSo=null,i){var t=a.getItemByListId(e);t&&cc.tween(t).to(.1,{scale:1.05}).to(.1,{scale:1}).start()}},t+.1),t<=0&&a._onScrolling())}},t.prototype._calcNearestItem=function(){var e,t,o,i,a,n,r=this;r.nearestListId=null,r._virtual&&r._calcViewPos(),o=r.viewTop,i=r.viewRight,a=r.viewBottom,n=r.viewLeft;for(var s=!1,c=0;c<r.content.childrenCount&&!s;c+=r._colLineNum)if(e=r._virtual?r.displayData[c]:r._calcExistItemPos(c))switch(t=r._sizeType?(e.top+e.bottom)/2:t=(e.left+e.right)/2,r._alignCalcType){case 1:e.right>=n&&(r.nearestListId=e.id,n>t&&(r.nearestListId+=r._colLineNum),s=!0);break;case 2:e.left<=i&&(r.nearestListId=e.id,i<t&&(r.nearestListId+=r._colLineNum),s=!0);break;case 3:e.bottom<=o&&(r.nearestListId=e.id,o<t&&(r.nearestListId+=r._colLineNum),s=!0);break;case 4:e.top>=a&&(r.nearestListId=e.id,a>t&&(r.nearestListId+=r._colLineNum),s=!0)}if((e=r._virtual?r.displayData[r.displayItemNum-1]:r._calcExistItemPos(r._numItems-1))&&e.id==r._numItems-1)switch(t=r._sizeType?(e.top+e.bottom)/2:t=(e.left+e.right)/2,r._alignCalcType){case 1:i>t&&(r.nearestListId=e.id);break;case 2:n<t&&(r.nearestListId=e.id);break;case 3:a<t&&(r.nearestListId=e.id);break;case 4:o>t&&(r.nearestListId=e.id)}},t.prototype.prePage=function(e){void 0===e&&(e=.5),this.checkInited()&&this.skipPage(this.curPageNum-1,e)},t.prototype.nextPage=function(e){void 0===e&&(e=.5),this.checkInited()&&this.skipPage(this.curPageNum+1,e)},t.prototype.skipPage=function(e,t){var o=this;if(o.checkInited())return o._slideMode!=s.PAGE?cc.error("This function is not allowed to be called, Must SlideMode = PAGE!"):void(e<0||e>=o._numItems||o.curPageNum!=e&&(o.curPageNum=e,o.pageChangeEvent&&cc.Component.EventHandler.emitEvents([o.pageChangeEvent],e),o.scrollTo(e,t)))},t.prototype.calcCustomSize=function(e){var t=this;if(t.checkInited()){if(!t._itemTmp)return cc.error("Unset template item!");if(!t.renderEvent)return cc.error("Unset Render-Event!");t._customSize={};var o=cc.instantiate(t._itemTmp);t.content.addChild(o);for(var i=0;i<e;i++)cc.Component.EventHandler.emitEvents([t.renderEvent],o,i),o.height==t._itemSize.height&&o.width==t._itemSize.width||(t._customSize[i]=t._sizeType?o.height:o.width);return Object.keys(t._customSize).length||(t._customSize=null),o.removeFromParent(),o.destroy&&o.destroy(),t._customSize}},n([u({type:cc.Enum(r),tooltip:!1})],t.prototype,"templateType",void 0),n([u({type:cc.Node,tooltip:!1,visible:function(){return this.templateType==r.NODE}})],t.prototype,"tmpNode",void 0),n([u({type:cc.Prefab,tooltip:!1,visible:function(){return this.templateType==r.PREFAB}})],t.prototype,"tmpPrefab",void 0),n([u()],t.prototype,"_slideMode",void 0),n([u({type:cc.Enum(s),tooltip:!1})],t.prototype,"slideMode",null),n([u({type:cc.Float,range:[0,1,.1],tooltip:!1,slide:!0,visible:function(){return this._slideMode==s.PAGE}})],t.prototype,"pageDistance",void 0),n([u({type:cc.Component.EventHandler,tooltip:!1,visible:function(){return this._slideMode==s.PAGE}})],t.prototype,"pageChangeEvent",void 0),n([u()],t.prototype,"_virtual",void 0),n([u({type:cc.Boolean,tooltip:!1})],t.prototype,"virtual",null),n([u({tooltip:!1,visible:function(){var e=this.slideMode==s.NORMAL;return e||(this.cyclic=!1),e}})],t.prototype,"cyclic",void 0),n([u({tooltip:!1,visible:function(){return this.virtual}})],t.prototype,"lackCenter",void 0),n([u({tooltip:!1,visible:function(){var e=this.virtual&&!this.lackCenter;return e||(this.lackSlide=!1),e}})],t.prototype,"lackSlide",void 0),n([u({type:cc.Integer})],t.prototype,"_updateRate",void 0),n([u({type:cc.Integer,range:[0,6,1],tooltip:!1,slide:!0})],t.prototype,"updateRate",null),n([u({type:cc.Integer,range:[0,12,1],tooltip:!1,slide:!0})],t.prototype,"frameByFrameRenderNum",void 0),n([u({type:cc.Component.EventHandler,tooltip:!1})],t.prototype,"renderEvent",void 0),n([u({type:cc.Enum(c),tooltip:!1})],t.prototype,"selectedMode",void 0),n([u({tooltip:!1,visible:function(){return this.selectedMode==c.SINGLE}})],t.prototype,"repeatEventSingle",void 0),n([u({type:cc.Component.EventHandler,tooltip:!1,visible:function(){return this.selectedMode>c.NONE}})],t.prototype,"selectedEvent",void 0),n([u({serializable:!1})],t.prototype,"_numItems",void 0),n([d,h(),f(cc.ScrollView),p(-5e3)],t)}(cc.Component);o.default=m,cc._RF.pop()},{"./ListItem":"ListItem"}],LoadMainSceneMap:[function(e,t,o){"use strict";cc._RF.push(t,"f89ccFS/f1ElKZ/s2Mn2T60","LoadMainSceneMap");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../utils/ResourcesManager"),s=e("../modules/manager/LoadResManager"),c=e("../utils/LogUtil"),l=e("../common/PlayerModule"),d=e("../utils/GameTools"),u=e("../utils/GameUtils"),h=e("../utils/ConfigUtils"),p=e("../StaticData/HeroBubbleTableData"),f=e("../modules/base/GameView"),g=e("../network/ClientNetwork"),m=e("../network/LocalMessage"),_=e("../network/protocol/TypeProtocols"),y=e("../common/EventConst"),v=e("../modules/manager/EventManager"),C=e("../view/mainScene/CarSkinUtils"),S=e("../view/heroCardBag/HeroSkinUtils"),T=e("../utils/ConstValue"),I=cc._decorator,N=I.ccclass,b=I.property,w=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.cardNode=null,t.bubbleNode=null,t.btn_changeCar=null,t.newCardNode=null,t.oceanCardMaskNode=null,t._curCardHeroArr=[],t}return a(t,e),t.prototype.onLoad=function(){},t.prototype.start=function(){var e=this;this.bubbleNode.active=!1,this.m_redpoint_carSkin=this.btn_changeCar.getChildByName("redDot"),this.m_redpoint_carSkin.active=!1,this.showCar(),this.showHeroBubble(),v.default.Instance.on(y.default.ChangeMainSceneEvent,this.onLoadMainBg,this),v.default.Instance.emit(y.default.ChangeMainSceneEvent),g.ClientNetwork.getInstance().listenLocalMessage(m.LOCAL_MESSAGE.LocalMsg_Refresh_pet,function(){e.showCarPet()},this),null!=this.btn_changeCar&&this.btn_changeCar.on(cc.Node.EventType.TOUCH_END,function(){e.showChangeCarView()}),g.ClientNetwork.getInstance().listenLocalMessage(m.LOCAL_MESSAGE.LocalMsg_Fresh_Car_Skin,function(){e.playCarChangeAni()},this),g.ClientNetwork.getInstance().listenLocalMessage(m.LOCAL_MESSAGE.LocalMsg_RefreshRedDot_carSkin,function(){e.showCarSkinRed()},this),g.ClientNetwork.getInstance().listenLocalMessage(m.LOCAL_MESSAGE.LocalMsg_heroSkin_changed,function(){e.setCardHero()},this),this.showCarSkinRed()},t.prototype.showCarSkinRed=function(){var e=l.default.getCarSkinRed();this.m_redpoint_carSkin.active=e},t.prototype.showCar=function(){console.log("\u5f53\u524d\u6218\u8f66\u76ae\u80a4id="+l.default.getRoleAttrValByKey(_.ROLE_ATTR_VALUES.ROLE_ATTR_CARSKINID)),C.default.Instance.getCurrSkinId()!=C.default.CAR_DEFAULT_SKIN_ID?(this.newCardNode.active=!0,this.cardNode.active=!1,this.currCarNode=this.newCardNode,this.setCarSkin()):(this.newCardNode.active=!1,this.cardNode.active=!0,this.currCarNode=this.cardNode,this.setCardHero())},t.prototype.onLoadMainBg=function(){var e=this;this.oceanCardMaskNode.active=!1,this.node.getChildByName("mainSceneBg")&&(this.node.getChildByName("mainSceneBg").destroy(),cc.assetManager.releaseAsset(this.mapRes),this.mapRes=null);var t=l.default.getRoleAttrValByKey(_.ROLE_ATTR_VALUES.ROLE_ATTR_MAPSKINID);t<=0&&(t=701);var o="main_map/main_map_"+t+"/main_map_"+t;r.default.loadPrefab(o,this.node,function(o,i){cc.isValid(e.node)&&(o.setSiblingIndex(0),o.name="mainSceneBg",e.mapRes=i,703==t&&(e.oceanCardMaskNode.active=!0),705==t?e.openFogHiddenEffect():e.closeFogHiddenEffect())})},t.prototype.setCarSkin=function(){var e=this,t=C.default.Instance.getCurrSkinId();if(t!=C.default.CAR_DEFAULT_SKIN_ID){var o=C.default.Instance.getCarSpineUrl(C.default.TYPE_MAIN,t);r.default.loadSpine(o,function(t,o){if(o){e.newCardNode.getComponent(sp.Skeleton).skeletonData=o,e.newCardNode.getComponent(sp.Skeleton).setAnimation(0,"walk",!0);var i=e.newCardNode.getComponent(sp.Skeleton).attachUtil;i.generateAllAttachedNodes(),i.getAttachedNodes("bone")[0].children.forEach(function(e){var t=new cc.Node;t.parent=e,t.name="HeroNode"}),e.setCardHero()}})}},t.prototype.setCardHero=function(){var e=this,t=this.currCarNode.getComponent(sp.Skeleton).attachUtil;t.generateAllAttachedNodes();var o=l.default.getBattleHeroCarData(l.default.fightHeroArrayIndex),i=[];for(var a in o)h.default.getInstance().getHeroConfig(o[a]._heroId).occupation!=T.HERO_PROF_TYPE.Engineer&&i.push(o[a]);t.getAttachedNodes("bone")[0].children.forEach(function(t){var o=t.getChildByName("HeroNode");if(o){o.removeAllChildren();for(var a=d.default.getRandomInt(1,i.length-1),n=i[a]._heroId,r=h.default.getInstance().getHeroConfig(i[a]._heroId).npc_id,l=0;l<i.length;l++)if(i[l]&&i[l]._heroId==n){i.splice(l,1);break}var u=S.default.Instance.getCurSkinIdByHeroUUID(null,n);console.log("LoadMainSceneMap, \u82f1\u96c4id="+n+", skinid="+u),u>0&&(r=S.default.Instance.getNpcTemplateId(n,u));var p=h.default.getInstance().getNpcTemplateConfig(r,1).res_id;s.default.loadSpineNode(h.default.getInstance().getResConfig(p).animation).then(function(e){e.parent=o,e.getComponent(sp.Skeleton).setAnimation(0,"idle",!0),e.scale=.01*h.default.getInstance().getResConfig(p).scale}).catch(function(e){c.default.info(e)}),o.heroId=n,e._curCardHeroArr.push(o);var f=new cc.Node("click"+p);f.width=130,f.height=160,f.parent=o,f.y=85,f.heroId=n,f.hasEventListener(cc.Node.EventType.TOUCH_END)||f.on(cc.Node.EventType.TOUCH_END,function(){e.showChangeCarView()})}}),this.showCarPet()},t.prototype.showHeroBubble=function(){var e=this,t=d.default.getRandomInt(20,40);this.scheduleOnce(function(){var t=d.default.getRandomInt(0,e._curCardHeroArr.length);if(e._curCardHeroArr[t]){var o=cc.instantiate(e.bubbleNode);o.active=!0,o.parent=e.node,e.m_bubbleNode=o;var i=e._curCardHeroArr[t].parent.convertToWorldSpaceAR(cc.v2(0,0));i=o.parent.convertToNodeSpaceAR(i),o.x=t%2==0?15:-45,o.y=i.y+80,o.scale=0;var a=p.HeroBubbleTableData.getById(e._curCardHeroArr[t].heroId).contents;o.getChildByName("bg").getChildByName("content").getComponent(cc.Label).string=a[d.default.getRandomInt(0,a.length)],cc.tween(o).to(.25,{scale:1.2}).to(.3,{scale:1}).delay(5).call(function(){e.showHeroBubble(),cc.tween(o).to(.3,{scale:1.2}).to(.25,{scale:0}).delay(5).call(function(){o.destroy()}).start()}).start()}},t)},t.prototype.showCarPet=function(){if(c.default.log("MainLoopBgView, showCarPet!!!"),cc.isValid(this.currCarNode)){var e=l.default.getRoleAttrValByKey(_.ROLE_ATTR_VALUES.ROLE_ATTR_PETID),t=h.default.getInstance().getItemByID(e);t?u.showCombatPet(this.currCarNode,t.spineId,"chongwu3",!0):c.default.log("MainLoopBgView, showCarPet, itemConfig is null!! itemId="+e)}},t.prototype.showChangeCarView=function(){f.default.addPopView("BaseCtrl","ChangeCarSkinView","ChangeCarSkinView")},t.prototype.onDestroy=function(){v.default.Instance.off(this)},t.prototype.playCarChangeAni=function(){var e=this,t=cc.callFunc(function(){e.playCarChangeAni_newCar()},this,null),o=cc.moveTo(1,cc.v2(800,-200)),i=cc.sequence(o,t);this.currCarNode.runAction(i),this.btn_changeCar.active=!1,this.m_bubbleNode&&(this.m_bubbleNode.active=!1)},t.prototype.playCarChangeAni_newCar=function(){C.default.Instance.getCurrSkinId()!=C.default.CAR_DEFAULT_SKIN_ID?(this.newCardNode.active=!0,this.cardNode.active=!1,this.currCarNode=this.newCardNode,this.setCarSkin()):(this.newCardNode.active=!1,this.cardNode.active=!0,this.currCarNode=this.cardNode,this.setCardHero()),this.currCarNode.setPosition(cc.v2(-800,-200));var e=this,t=cc.callFunc(function(){e.btn_changeCar.active=!0},this,null),o=cc.moveTo(1,cc.v2(0,-200)),i=cc.sequence(o,t);this.currCarNode.runAction(i)},t.prototype.closeFogHiddenEffect=function(){var e=this.node.getChildByName("FogHiddenNode");e&&(e.active=!1,e.stopAllActions())},t.prototype.openFogHiddenEffect=function(){var e=this,t=this.node.getChildByName("FogHiddenNode");if(t){t.active=!0,t.children.forEach(function(e){e.active=!1});var o=d.default.getRandomInt(5,10);cc.tween(t).delay(o).call(function(){e.randomPlayFogHiddenEffect()}).start()}},t.prototype.randomPlayFogHiddenEffect=function(){var e=this,t=d.default.getRandomInt(0,2),o=this.node.getChildByName("FogHiddenNode");if(o){o.children.forEach(function(e){e.active=!1});var i=cc.view.getVisibleSize(),a=i.width/1440;i.height,a>1&&(o.children[t].scaleX=a),o.children[t].active=!0,o.children[t].getComponent(sp.Skeleton).setAnimation(0,"idle",!1);var n=o.children[t].getComponent(sp.Skeleton);n.setTrackEventListener(n.getCurrent(0),function(t,o){"end"===(o.data?o.data.name:"")&&e.openFogHiddenEffect()})}},n([b({displayName:"\u6218\u8f66",type:cc.Node})],t.prototype,"cardNode",void 0),n([b({displayName:"\u82f1\u96c4\u6c14\u6ce1",type:cc.Node})],t.prototype,"bubbleNode",void 0),n([b(cc.Node)],t.prototype,"btn_changeCar",void 0),n([b({displayName:"\u65b0\u6218\u8f66",type:cc.Node})],t.prototype,"newCardNode",void 0),n([b({displayName:"\u6d77\u9762\u6218\u8f66\u6ce2\u6d6a\u906e\u7f69",type:cc.Node})],t.prototype,"oceanCardMaskNode",void 0),n([N],t)}(cc.Component);o.default=w,cc._RF.pop()},{"../StaticData/HeroBubbleTableData":"HeroBubbleTableData","../common/EventConst":"EventConst","../common/PlayerModule":"PlayerModule","../modules/base/GameView":"GameView","../modules/manager/EventManager":"EventManager","../modules/manager/LoadResManager":"LoadResManager","../network/ClientNetwork":"ClientNetwork","../network/LocalMessage":"LocalMessage","../network/protocol/TypeProtocols":"TypeProtocols","../utils/ConfigUtils":"ConfigUtils","../utils/ConstValue":"ConstValue","../utils/GameTools":"GameTools","../utils/GameUtils":"GameUtils","../utils/LogUtil":"LogUtil","../utils/ResourcesManager":"ResourcesManager","../view/heroCardBag/HeroSkinUtils":"HeroSkinUtils","../view/mainScene/CarSkinUtils":"CarSkinUtils"}],LoadResManager:[function(e,t,o){"use strict";cc._RF.push(t,"5e89f7uWB1I74qUK8jSXJG7","LoadResManager");var i=this&&this.__awaiter||function(e,t,o,i){return new(o||(o=Promise))(function(a,n){function r(e){try{c(i.next(e))}catch(t){n(t)}}function s(e){try{c(i.throw(e))}catch(t){n(t)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(r,s)}c((i=i.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){var o,i,a,n,r={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return n={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function s(e){return function(t){return c([e,t])}}function c(n){if(o)throw new TypeError("Generator is already executing.");for(;r;)try{if(o=1,i&&(a=2&n[0]?i.return:n[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return r.label++,{value:n[1],done:!1};case 5:r.label++,i=n[1],n=[0];continue;case 7:n=r.ops.pop(),r.trys.pop();continue;default:if(!(a=(a=r.trys).length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){r=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){r.label=n[1];break}if(6===n[0]&&r.label<a[1]){r.label=a[1],a=n;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(n);break}a[2]&&r.ops.pop(),r.trys.pop();continue}n=t.call(e,r)}catch(s){n=[6,s],i=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(){}return e.instance=function(){return this._instance||(this._instance=new this),this._instance},e.prototype.loadPrefab=function(e){return i(this,void 0,Promise,function(){var t;return a(this,function(o){switch(o.label){case 0:return[4,this.LoadResAsync(e,cc.Prefab)];case 1:return(t=o.sent())?[2,cc.instantiate(t)]:[2,null]}})})},e.prototype.loadSpriteFrame=function(e){return i(this,void 0,Promise,function(){return a(this,function(t){switch(t.label){case 0:return[4,this.LoadResAsync(e,cc.SpriteFrame)];case 1:return[2,t.sent()]}})})},e.prototype.loadSpineNode=function(e){return i(this,void 0,Promise,function(){var t,o,i;return a(this,function(a){switch(a.label){case 0:return[4,this.LoadResAsync(e,sp.SkeletonData)];case 1:return(t=a.sent())?(o=new cc.Node,(i=o.addComponent(sp.Skeleton))&&(i.skeletonData=t,i.setSkin("default")),[2,o]):[2,null]}})})},e.prototype.LoadResAsync=function(e,t,o,i){return void 0===o&&(o=!1),new Promise(function(a){cc.resources.load(e,t,i,function(e,t){if(e){if(o)throw e;cc.error(e),a(null)}else a(t)})})},e}();o.default=n.instance(),cc._RF.pop()},{}],LoadView:[function(e,t){"use strict";cc._RF.push(t,"da948BYRTJAO7sABY+KG8nI","LoadView");var o,i=(o=e("../utils/ConfigUtils"))&&o.__esModule?o:{default:o};cc.Class({extends:cc.Component,onLoad:function(){this.bInitCfg=!1,this.bLoadEnd=!1,this.bInitDone=!1,this.loadScene="",this._loadProgress=this.node.getChildByName("loadProgressBar")},start:function(){},update:function(){0!=this.bLoadEnd&&0!=this.bInitCfg&&(this.bInitDone||(this._loadProgress.getComponent(cc.ProgressBar).progress=i.default.Instance.loadedCnt/i.default.Instance.cfgToLoadCnt,this._loadProgress.getComponent(cc.ProgressBar).node.getChildByName("barLabel").getComponent(cc.Label).string="\u914d\u7f6e\u6587\u4ef6\u52a0\u8f7d"+Math.floor(i.default.Instance.loadedCnt/i.default.Instance.cfgToLoadCnt*100)+"%",i.default.getInstance().isAllConfigLoad()&&(this.bInitDone=!0,cc.director.loadScene(this.loadScene))))},load:function(e,t){this.bInitCfg=t||!1,this.loadScene=e;var o=this;cc.director.preloadScene(e,function(i,a){o._loadProgress.getComponent(cc.ProgressBar).progress=i/a,o._loadProgress.getComponent(cc.ProgressBar).node.getChildByName("barLabel").getComponent(cc.Label).string="\u8d44\u6e90\u52a0\u8f7d"+Math.floor(i/a*100)+"%",i>=a&&(t||cc.director.loadScene(e),o.bLoadEnd=!0)},function(){})}}),cc._RF.pop()},{"../utils/ConfigUtils":"ConfigUtils"}],LoadingBgTableData:[function(e,t,o){"use strict";cc._RF.push(t,"ea9021cUAdBOL1fi/Mijifw","LoadingBgTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.LoadingBgTableData=o.LoadingSpecialType=void 0;var i=e("../TableReader");(function(e){e[e.LoadingSpecialTypeFirstRecharge=1]="LoadingSpecialTypeFirstRecharge",e[e.LoadingSpecialTypeMonthCard=2]="LoadingSpecialTypeMonthCard"})(o.LoadingSpecialType||(o.LoadingSpecialType={}));var a=function(){function e(){this.id=0,this.resPath="",this.levelStart=0,this.levelEnd=0,this.rmbNumStart=0,this.rmbNumEnd=0,this.special=0}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.resPath=e.getString(),this.levelStart=e.getNumber(),this.levelEnd=e.getNumber(),this.rmbNumStart=e.getNumber(),this.rmbNumEnd=e.getNumber(),this.special=e.getNumber()},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"LoadingBgTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.LoadingBgTableData=a,cc._RF.pop()},{"../TableReader":"TableReader"}],LoadingTipsTableData:[function(e,t,o){"use strict";cc._RF.push(t,"7d6b5k6W/dPMZPGo6RlCpny","LoadingTipsTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.LoadingTipsTableData=o.LoadingTipsActionType=void 0;var i=e("../TableReader");(function(e){e[e.LoadingTipsActionType_Move=0]="LoadingTipsActionType_Move",e[e.LoadingTipsActionType_Rotate=1]="LoadingTipsActionType_Rotate",e[e.LoadingTipsActionType_FadeOut=2]="LoadingTipsActionType_FadeOut",e[e.LoadingTipsActionType_Jump=3]="LoadingTipsActionType_Jump",e[e.LoadingTipsActionType_Scale=4]="LoadingTipsActionType_Scale",e[e.LoadingTipsActionType_Max=5]="LoadingTipsActionType_Max"})(o.LoadingTipsActionType||(o.LoadingTipsActionType={}));var a=function(){function e(){this.id=0,this.tips="",this.milisec=0,this.actionType=0}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.tips=e.getString(),this.milisec=e.getNumber(),this.actionType=e.getNumber()},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"LoadingTipsTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.LoadingTipsTableData=a,cc._RF.pop()},{"../TableReader":"TableReader"}],LocalMessage:[function(e,t,o){"use strict";cc._RF.push(t,"c9264pTdKhHv6USRh+iOXBX","LocalMessage"),Object.defineProperty(o,"__esModule",{value:!0}),o.LOCAL_MESSAGE=void 0,function(e){e[e.LocalMsg_Begin=9e6]="LocalMsg_Begin",e[e.LocalMsg_ConnectFailed=9000001]="LocalMsg_ConnectFailed",e[e.LocalMsg_RecvMeg=9000002]="LocalMsg_RecvMeg",e[e.LocalMsg_SceneBeginLoad=9000003]="LocalMsg_SceneBeginLoad",e[e.LocalMsg_SceneLoaded=9000004]="LocalMsg_SceneLoaded",e[e.LocalMsg_EnterMainScene=9000005]="LocalMsg_EnterMainScene",e[e.LocalMsg_UpdateCarInfo=9000006]="LocalMsg_UpdateCarInfo",e[e.LocalMsg_MatchFail=9000007]="LocalMsg_MatchFail",e[e.LocalMsg_MatchSuccess=9000008]="LocalMsg_MatchSuccess",e[e.LocalMsg_MatchReconnectSuccess=9000009]="LocalMsg_MatchReconnectSuccess",e[e.LocalMsg_LoginFightServerSuccess=9000010]="LocalMsg_LoginFightServerSuccess",e[e.LocalMsg_RootTopCreateFinshed=9000011]="LocalMsg_RootTopCreateFinshed",e[e.LocalMsg_ClosePopLayer=9000012]="LocalMsg_ClosePopLayer",e[e.LocalMsg_RefreshPveRedPoint=9000013]="LocalMsg_RefreshPveRedPoint",e[e.LocalMsg_OpenPveLayer=9000014]="LocalMsg_OpenPveLayer",e[e.LocalMsg_HeroUpMessage=9000015]="LocalMsg_HeroUpMessage",e[e.LocalMsg_FightBloodSync=9000016]="LocalMsg_FightBloodSync",e[e.LocalMsg_StartCarSummon=9000017]="LocalMsg_StartCarSummon",e[e.LocalMsg_SyncGold=9000018]="LocalMsg_SyncGold",e[e.LocalMsg_SyncDiamond=9000019]="LocalMsg_SyncDiamond",e[e.LocalMsg_RefreshTask=9000020]="LocalMsg_RefreshTask",e[e.LocalMsg_RefreshTaskBox=9000021]="LocalMsg_RefreshTaskBox",e[e.LocalMsg_TaskAhcievementSelTab=9000022]="LocalMsg_TaskAhcievementSelTab",e[e.LocalMsg_Friend_BeApply=9000023]="LocalMsg_Friend_BeApply",e[e.LocalMsg_FriendPopupWindow=9000024]="LocalMsg_FriendPopupWindow",e[e.LocalMsg_ShowPopLayer=9000025]="LocalMsg_ShowPopLayer",e[e.LocalMsg_START_GUIDE=9000026]="LocalMsg_START_GUIDE",e[e.LocalMsg_CHECK_GUIDE=9000027]="LocalMsg_CHECK_GUIDE",e[e.LocalMsg_GUIDE_STOP_OUTSIDE=9000028]="LocalMsg_GUIDE_STOP_OUTSIDE",e[e.LocalMsg_GUIDE_RESET=9000029]="LocalMsg_GUIDE_RESET",e[e.LocalMsg_GUIDE_MESSAGE=9000030]="LocalMsg_GUIDE_MESSAGE",e[e.LocalMsg_SyncAchPoint=9000031]="LocalMsg_SyncAchPoint",e[e.LocalMsg_SDK_LoginRet=9000032]="LocalMsg_SDK_LoginRet",e[e.LocalMsg_RechargeSuccess=9000033]="LocalMsg_RechargeSuccess",e[e.LocalMsg_BuyFightCard=9000034]="LocalMsg_BuyFightCard",e[e.LocalMsg_CoopBossDead=9000035]="LocalMsg_CoopBossDead",e[e.LocalMsg_PvpBossRefresh=9000036]="LocalMsg_PvpBossRefresh",e[e.LocalMsg_SynRoleInformationData=9000037]="LocalMsg_SynRoleInformationData",e[e.LocalMsg_SynRoleAttrVal=9000038]="LocalMsg_SynRoleAttrVal",e[e.LocalMsg_SyncCostGet=9000039]="LocalMsg_SyncCostGet",e[e.LocalMsg_CheatValue=9000040]="LocalMsg_CheatValue",e[e.LocalMsg_CheatTable=9000041]="LocalMsg_CheatTable",e[e.LocalMsg_CheatTableFile=9000042]="LocalMsg_CheatTableFile",e[e.LocalMsg_Cheat8094=9000043]="LocalMsg_Cheat8094",e[e.LocalMsg_Cheat8096=9000044]="LocalMsg_Cheat8096",e[e.LocalMsg_Refresh_pet=9000045]="LocalMsg_Refresh_pet",e[e.LocalMsg_ChooseServer=9000046]="LocalMsg_ChooseServer",e[e.LocalMsg_GetServerAddr=9000047]="LocalMsg_GetServerAddr",e[e.LocalMsg_itemChange_pet=9000048]="LocalMsg_itemChange_pet",e[e.LocalMsg_RefreshPetRedDot=9000049]="LocalMsg_RefreshPetRedDot",e[e.LocalMsg_RefreshHeroCardMainView=9000050]="LocalMsg_RefreshHeroCardMainView",e[e.LocalMsg_AgreeUserProtocol=9000051]="LocalMsg_AgreeUserProtocol",e[e.LocalMsg_AgreePrivacyProtocol=9000052]="LocalMsg_AgreePrivacyProtocol",e[e.LocalMsg_Fresh_Car_Skin=9000053]="LocalMsg_Fresh_Car_Skin",e[e.LocalMsg_close_view=9000054]="LocalMsg_close_view",e[e.LocalMsg_itemChange_carSkin=9000055]="LocalMsg_itemChange_carSkin",e[e.LocalMsg_RefreshRedDot_carSkin=9000056]="LocalMsg_RefreshRedDot_carSkin",e[e.LocalMsg_Game_BackGround=9000057]="LocalMsg_Game_BackGround",e[e.LocalMsg_Game_FrontGround=9000058]="LocalMsg_Game_FrontGround",e[e.LocalMsg_itemChange_sweepCard=9000059]="LocalMsg_itemChange_sweepCard",e[e.LocalMsg_SyncVoucher=9000060]="LocalMsg_SyncVoucher",e[e.LocalMsg_ChooseSubGame=9000061]="LocalMsg_ChooseSubGame",e[e.LocalMsg_BackSubGame=9000062]="LocalMsg_BackSubGame",e[e.LocalMsg_ClientTaskUpdateCount=9000063]="LocalMsg_ClientTaskUpdateCount",e[e.LocalMsg_SmallBagLogin=9000064]="LocalMsg_SmallBagLogin",e[e.LocalMsg_ForceCheckGame=9000065]="LocalMsg_ForceCheckGame",e[e.LocalMsg_RefreshSkyCastleRed=9000066]="LocalMsg_RefreshSkyCastleRed",e[e.LocalMsg_RefreshCoopFriendChatRed=9000067]="LocalMsg_RefreshCoopFriendChatRed",e[e.LocalMsg_SystemCallFriendAddBlack=9000068]="LocalMsg_SystemCallFriendAddBlack",e[e.LocalMsg_BuyVideoByGold=9000069]="LocalMsg_BuyVideoByGold",e[e.LocalMsg_ShowGameRecorderBtn=9000070]="LocalMsg_ShowGameRecorderBtn",e[e.LocalMsg_itemChange_selectCard=9000071]="LocalMsg_itemChange_selectCard",e[e.LocalMsg_heroSkin_changed=9000072]="LocalMsg_heroSkin_changed",e[e.LocalMsg_itemChange_heroSkin=9000073]="LocalMsg_itemChange_heroSkin",e[e.LocalMsg_RefreshRedDot_heroSkin=9000074]="LocalMsg_RefreshRedDot_heroSkin",e[e.LocalMsg_JumpAdGetReward=9000075]="LocalMsg_JumpAdGetReward",e[e.LocalMsg_ServerCheckTableMd5=9000076]="LocalMsg_ServerCheckTableMd5",e[e.LocalMsg_freshNewerGiftRed=9000077]="LocalMsg_freshNewerGiftRed"}(o.LOCAL_MESSAGE||(o.LOCAL_MESSAGE={})),cc._RF.pop()},{}],Locator:[function(e,t,o){"use strict";cc._RF.push(t,"7e2bezkazdDy6tS5FQMcu6Y","Locator");var i=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0}),o.Locator=o.DefaultLocatorTimeOut=void 0,o.DefaultLocatorTimeOut=8e3;var a=cc._decorator,n=a.ccclass,r=(a.property,function(){function e(){}var t;return t=e,e.parse=function(e){return cc.assert(e,"locator string is null"),e.split(/[.,\/\/,>,#]/g).map(function(t){var o=e.indexOf(t);return{symbol:e[o-1]||">",name:t.trim()}})},e.seekNodeByName=function(e,t){if(!e)return null;if(e.getName()==t)return e;for(var o=e.getChildren(),i=o.length,a=0;a<i;a++){var n=o[a],r=this.seekNodeByName(n,t);if(null!=r)return r}return null},e.locateNode=function(e,o,i){if(!cc.isValid(e))return i("locateNode root is not valid"),null;t.locating||(t.startTime=Date.now(),t.locating=!0);for(var a,n=t.parse(o),r=e,s=0;s<n.length;s++){var c=n[s];switch(c.symbol){case"/":a=r.getChildByName(c.name);break;case".":a=r[c.name];break;case">":a=t.seekNodeByName(r,c.name)}if(!a){r=null;break}r=a}return r&&r.active&&i?(t.locating=!1,i(null,r)):i&&setTimeout(function(){t.locateNode(e,o,i)},100),r},e.getNodeFullPath=function(e){var t=[],o=e;do{t.unshift(o.name),o=o.parent}while(o&&"Canvas"!==o.name);return t.join("/")},e.locating=!1,e.timeout=o.DefaultLocatorTimeOut,t=i([n],e)}());o.Locator=r,cc._RF.pop()},{}],LockStepManager:[function(e,t,o){"use strict";cc._RF.push(t,"38eb02YFBFIpIhjSowtPP4L","LockStepManager");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0}),o.T_Server_Npc_Blood_Struct=void 0;var n=e("../combat/CombatManager"),r=e("./FightNetwork"),s=e("./LocalMessage"),c=e("./protocol/FightProtocols"),l=e("./protocol/long"),d=e("../utils/ConstValue"),u=e("./protocol/FightProtocols"),h=e("./protocol/FightProtocols"),p=e("./protocol/FightProtocols"),f=e("../common/PlayerModule"),g=e("../common/CombatModule"),m=e("./protocol/FightProtocols"),_=e("./protocol/BaseProtocols"),y=e("./protocol/FightProtocols"),v=e("../utils/ConfigUtils"),C=e("./protocol/FightProtocols"),S=e("./protocol/FightProtocols"),T=e("../utils/GameUtils"),I=e("./protocol/TypeProtocols"),N=function(){};o.T_Server_Npc_Blood_Struct=N;var b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.serverFrameRate=200,t.bloodframes=[],t.silverframes=[],t.monsterframes=[],t.heroframes=[],t.curBloodFrameIndex=1,t.curSilverFrameIndex=1,t.curMonsterFrameIndex=1,t.curHeroFrameIndex=1,t.frameInv=0,t.serverFrameAcc=3,t.time=0,t.guardTime=0,t.serverNpcList=new Map,t.bCheckDropBlood=!1,t.tableSyncCount=40,t.npcTableIndex=1025,t.skillTableIndex=0,t.buffTableIndex=0,t}return a(t,e),t.prototype.resetFrameIndex=function(){this.curBloodFrameIndex=1,this.curSilverFrameIndex=1,this.curMonsterFrameIndex=1,this.bloodframes=[],this.silverframes=[],this.monsterframes=[],this.time=0,this.guardTime=0,this.serverNpcList.clear(),this.bCheckDropBlood=f.default.checkModulerOnOffState(65)},t.prototype.onDestroy=function(){this.resetFrameIndex(),r.FightNetwork.getInstance().removeMessageTarget(this)},t.prototype.init=function(){this.time=0;var e=this;r.FightNetwork.getInstance().listenProtocol(c.FIGHT_CLIENT_ENUM.P_Fight_Monster_Blood_SYNC,function(t){t.resetPos();var o=new c.S_Fight_Monster_Blood_SYNC;if(o.read(t)){var i=n.default.getInstance().getNpcList();o.monsterBlood.forEach(function(t){t.monsterBlood.forEach(function(t,a){var n=i[a];n&&(t.curBlood<=0&&n.state!=d.NPC_STATE.Dead&&(e.addMoney(n.camp,t.extraDropMoney,n.dropMoney,n.isBoss()),cc.director.emit("Event_KillTarget",t.heroId,n.id)),n.hp<=0&&(t.curBlood=0),n.hp=t.curBlood,(n.isCar()||n.isBoss())&&(n.tmpHp=t.curBlood),n.hp<=0&&(n.tmpHp=0,n.onRefreshHpBar()),console.log("P_Fight_Monster_Blood_SYNC:"+o.syncRoleID+" "+n.id+" "+t.curBlood)),e.insertSerNpcList(a,t)})}),this.curMonsterFrameIndex!=o.timeFrame&&(this.curMonsterFrameIndex=o.timeFrame),this.curMonsterFrameIndex++}r.FightNetwork.getInstance().pushLocalMessage(s.LOCAL_MESSAGE.LocalMsg_FightBloodSync)}.bind(this),this),r.FightNetwork.getInstance().listenProtocol(c.FIGHT_CLIENT_ENUM.P_Fight_Silver_SYNC,function(e){e.resetPos();var t=new c.S_Fight_Silver_SYNC;if(t.read(e)&&!t.roleID.equals(f.default.UUID)){if(t.silver.type==I.SP_CHANGE_TYPE.SP_CHANGE_TYPE_BEGIN)return;t.silver.SilverChange=t.silver.SilverChange/100;var o=null;if(o=n.default.getInstance().isCoop()?n.default.getInstance().getPlayerModelByCamp(d.PLAYER_CAMP.coopPlayer):n.default.getInstance().getPlayerModelByCamp(d.PLAYER_CAMP.opponents)){var i=o.money+t.silver.SilverChange;i<0&&(i=0);var a=t.silver.SilverChange;if(f.default.checkModulerOnOffState(66)&&i>d.INT_MAX_MONEY&&(a-=i-d.INT_MAX_MONEY,i=d.INT_MAX_MONEY),o.setMoney(i),1==t.silver.SilverChangeType&&(o.combatStatistic.countSliverNum(t.silver.SilverChange),o.combatStatistic.countMaxSliverNum(o.money)),console.log("P_Fight_Silver_SYNC otherPlayer.money",o.money),console.log("P_Fight_Silver_SYNC countSliverNum.money",o.combatStatistic.slivers),console.log("P_Fight_Silver_SYNC countMaxSliverNum.money",o.combatStatistic.maxSlivers),0!=t.silver.SilverChange&&(cc.director.emit("Event_MoneyChange",a,o.camp,t.silver.type),0==t.silver.SilverChangeType)){var r=n.default.getInstance().getCarByCamp(o.camp);r&&r.sliverCurseEffect(Math.abs(t.silver.SilverChange))}}this.curSilverFrameIndex!=t.timeFrame&&(this.curSilverFrameIndex=t.timeFrame),this.curSilverFrameIndex++}}.bind(this),this),r.FightNetwork.getInstance().listenProtocol(c.FIGHT_CLIENT_ENUM.P_Fight_Hero_Attr_SYNC,function(e){if(n.default.getInstance().gameState==d.Game_State.Fighting){e.resetPos();var t=new p.S_Fight_Hero_Attr_SYNC;if(t.read(e)&&!t.roleID.equals(f.default.UUID)){var o=null;if(n.default.getInstance().isCoop()?n.default.getInstance().getSelfCar()&&(o=n.default.getInstance().getCoopCarByCamp(n.default.getInstance().getSelfCar().camp)):o=n.default.getInstance().getCarByCamp(2),o)for(var i in t.heroAttrVec){var a=o.getHeroObjByHeroID(Number(t.heroAttrVec[i].id));a&&(a.summonMonsterCount=t.heroAttrVec[i].attr[0])}}}}.bind(this),this)},t.prototype.update=function(e){if(n.default.getInstance().gameState==d.Game_State.Fighting)for(this.time+=e;this.time>=.2;)this.time-=.2,this.sendPlayerInfoTosSvr()},t.prototype.sendPlayerInfoTosSvr=function(){if(n.default.getInstance().gameState==d.Game_State.Fighting){var e=this,t=new c.C_Fight_Monster_Blood_SYNC;t.timeFrame=this.curMonsterFrameIndex;var o=new c.T_Player_Monster_Blood_Struct,i=new c.T_Player_Monster_Blood_Struct,a=new c.T_Player_Monster_Blood_Struct,s=g.default.getMatchBattleInfo(!1);t.playerMonsterBlod.set(f.default.UUID,o),t.playerMonsterBlod.set(s.roleID,i),n.default.getInstance().isCoop()&&t.playerMonsterBlod.set(l.fromNumber(d.PLAYER_CAMP.opponents),a);var p=new c.T_Monster_Blood_Struct,m=new c.T_Monster_Blood_Struct,_=new c.T_Monster_Blood_Struct,y=new c.T_Monster_Blood_Struct,v=new c.T_Monster_Blood_Struct,C=new c.T_Monster_Blood_Struct,S=new c.T_Monster_Blood_Struct,I=new c.T_Monster_Blood_Struct,N=new c.T_Monster_Blood_Struct;n.default.getInstance().isPvP()?(o.monsterBlood.set(s.roleID,y),o.monsterBlood.set(f.default.UUID,p),i.monsterBlood.set(f.default.UUID,m),i.monsterBlood.set(s.roleID,v)):(o.monsterBlood.set(l.fromNumber(d.PLAYER_CAMP.opponents),S),o.monsterBlood.set(f.default.UUID,p),o.monsterBlood.set(s.roleID,y),i.monsterBlood.set(l.fromNumber(d.PLAYER_CAMP.opponents),I),i.monsterBlood.set(f.default.UUID,m),i.monsterBlood.set(s.roleID,v),a.monsterBlood.set(l.fromNumber(d.PLAYER_CAMP.opponents),N),a.monsterBlood.set(f.default.UUID,_),a.monsterBlood.set(s.roleID,C));var b=n.default.getInstance().getNpcList(),w=function(t){var o=b[t];if(o){if(n.default.getInstance().isCoop()&&o.isCar()&&T.getRoleIdentity(o.camp)==d.PLAYER_IDENTITY.home){var i=new c.T_Blood_Struct;i.dropBlood=2e7,i.curBlood=0,i.maxBlood=0,i.type=o.npcType,i.damageType=6,o.dropBloodMap.set(l.fromNumber(d.PLAYER_CAMP.opponents),i)}o.dropBloodMap.forEach(function(i,a){if((0!=i.dropBlood||o.isCar())&&(i.maxBlood<o.getMaxHp()&&(i.maxBlood=o.getMaxHp()),!(i.maxBlood<i.curBlood&&i.dropBlood<0||e.bCheckDropBlood&&(0==i.maxDropBlood&&i.dropBlood>=d.INT_BIG_VALUE||i.maxDropBlood>0&&i.dropBlood>20*i.maxDropBlood)))){if(n.default.getInstance().isCoop())if(a.equals(f.default.UUID))if(o.camp==d.PLAYER_CAMP.myPlayer)p.monsterBlood.set(Number(t),i);else if(o.camp==d.PLAYER_CAMP.coopPlayer)y.monsterBlood.set(Number(t),i);else if(S.monsterBlood.has(Number(t))){var r=S.monsterBlood.get(Number(t));e.refreshDropBloodData(r,i)}else S.monsterBlood.set(Number(t),i);else a.equals(s.roleID)?o.camp==d.PLAYER_CAMP.myPlayer?m.monsterBlood.set(Number(t),i):o.camp==d.PLAYER_CAMP.coopPlayer?v.monsterBlood.set(Number(t),i):I.monsterBlood.has(Number(t))?(r=I.monsterBlood.get(Number(t)),e.refreshDropBloodData(r,i)):I.monsterBlood.set(Number(t),i):a.equals(d.PLAYER_CAMP.opponents)&&(o.camp==d.PLAYER_CAMP.myPlayer?_.monsterBlood.set(Number(t),i):o.camp==d.PLAYER_CAMP.coopPlayer?C.monsterBlood.set(Number(t),i):T.getRoleIdentity(d.PLAYER_CAMP.myPlayer)==d.PLAYER_IDENTITY.home?S.monsterBlood.has(Number(t))?(r=S.monsterBlood.get(Number(t)),e.refreshDropBloodData(r,i)):S.monsterBlood.set(Number(t),i):I.monsterBlood.has(Number(t))?(r=I.monsterBlood.get(Number(t)),e.refreshDropBloodData(r,i)):I.monsterBlood.set(Number(t),i));else a.equals(f.default.UUID)?o.camp==d.PLAYER_CAMP.myPlayer?p.monsterBlood.set(Number(t),i):o.camp==d.PLAYER_CAMP.opponents&&y.monsterBlood.set(Number(t),i):o.camp==d.PLAYER_CAMP.myPlayer?m.monsterBlood.set(Number(t),i):o.camp==d.PLAYER_CAMP.opponents&&v.monsterBlood.set(Number(t),i);console.log("P_Fight_Monster_Blood_SYNC  sendPlayerInfoTosSvr:key:"+a+"  PlayerModule.UUID "+o.id+" "+i.curBlood+" "+i.dropBlood)}}),o.clearDropBlood()}};for(var E in b)w(E);r.FightNetwork.getInstance().Send(c.FIGHT_CLIENT_ENUM.P_Fight_Monster_Blood_SYNC,t);var P=n.default.getInstance().getSelfCar(),R=new u.C_Fight_Hero_Attr_SYNC;R.roleID=f.default.UUID;var L=P.heroList;for(var A in L){var D=L[A];if(D){var M=new h.T_Hero_Attr_Struct;M.id=String(D.heroTemplateId),M.attr[0]=D.summonMonsterCount,R.heroAttrVec.push(M)}}r.FightNetwork.getInstance().Send(c.FIGHT_CLIENT_ENUM.P_Fight_Hero_Attr_SYNC,R)}},t.prototype.refreshDropBloodData=function(e,t){e.dropBlood+t.dropBlood>d.INT_BIG_VALUE?e.dropBlood=d.INT_BIG_VALUE:e.dropBlood+=t.dropBlood,e.damageType=t.npcType},t.prototype.sendGuardTableDataToSvr=function(){var e=new m.C_Fight_Guard_TableData_SYNC,t=n.default.getInstance().getSelfCar().heroList;for(var o in t){var i=t[o];if(i){var a=new y.T_Guard_TableData_BattleLevelupTableData_Struct;a.heroId=Number(i.heroTemplateId),a.level=i.level;var s=v.default.getInstance().getHeroConfig(a.heroId);s&&(f=v.default.getInstance().getNpcTemplateConfig(s.npc_id,a.level))&&((g=new _.T_Attr).type=d.Npc_Attr_Type.attack,g.value=f.attack,a.attr.push(g)),e.fightGuard.vecBattleLevelupTableData.push(a)}}var l=0,u=0,h=v.default.getInstance().data["StaticData/NpcTemplateTableData"];for(var p in h){var f;if(l++,Number(p)>5e5+1&&l>this.npcTableIndex&&(f=h[p])){var g,T=new c.T_Guard_TableData_BattleNpcMoneyTableData_Struct;if(T.npcId=f.id,T.npcLv=f.level,T.dropMoney=f.money,(g=new _.T_Attr).type=d.Npc_Attr_Type.attack,g.value=f.attack,T.attr.push(g),e.fightGuard.vecBattleNpcMoneyTableData.push(T),u++,this.npcTableIndex+u>=Object.keys(h).length){this.npcTableIndex=1025;break}if(u>=this.tableSyncCount){this.npcTableIndex+=u;break}}}var I=v.default.getInstance().data["StaticData/CarTableData"];for(var p in I){var N=I[p];if(N){var b=new c.T_Guard_TableData_BattleCarCfgTableData_Struct;b.carID=N.id;var w=N.lv_up_cost.split("|");for(var E in w)b.lvUpCostVec.push(w[E]);e.fightGuard.vecBattleCarCfgTableData.push(b)}}var P=v.default.getInstance().data["StaticData/RandomConstTableData"];for(var p in P){var R=P[p];if(R){var L=new c.T_Guard_TableData_BattleCardRefreshTableData_Struct;L.id=R.id,L.min=R.min_times,L.max=R.max_times,L.pvpCost=R.const,L.coopCost=R.const_coop,e.fightGuard.vecBattleCardRefreshTableData.push(L)}}l=0,u=0;var A=v.default.getInstance().data["StaticData/SkillTableData"];for(var p in A)if(++l>this.skillTableIndex){var D=A[p];if(D){var M=new C.T_Guard_TableData_BattleSkillTableData_Struct;M.skillID=D.id;var B=new _.T_Attr;B.type=d.Npc_Attr_Type.attack_speed,B.value=D.cd,M.attr.push(B);var k=new _.T_Attr;if(k.type=d.Npc_Attr_Type.damage_inc,k.value=D.damage,M.attr.push(k),e.fightGuard.vecBattleSkillTableData.push(M),u++,this.skillTableIndex+u>=Object.keys(A).length){this.skillTableIndex=0;break}if(u>=this.tableSyncCount){this.skillTableIndex+=u;break}}}l=0,u=0;var G=v.default.getInstance().data["StaticData/BuffTableData"];for(var p in G)if(++l>this.buffTableIndex){var O=G[p];if(O){var H=new S.T_Guard_TableData_BattleBuffTableData_Struct;if(H.BuffID=O.id,H.BuffValue=O.value,e.fightGuard.vecBattleBuffTableData.push(H),u++,this.buffTableIndex+u>=Object.keys(G).length){this.buffTableIndex=0;break}if(u>=this.tableSyncCount){this.buffTableIndex+=u;break}}}r.FightNetwork.getInstance().Send(c.FIGHT_CLIENT_ENUM.P_Fight_Guard_TableData_SYNC,e)},t.prototype.addMoney=function(e,t,o,i){var a=o+t;if(n.default.getInstance().isCoop()){if(e===d.PLAYER_CAMP.opponents)(r=n.default.getInstance().getSelfCombatModel())&&(r.addMoney(a),r.combatStatistic.countMosterNum(i)),(s=n.default.getInstance().getPlayerModelByCamp(d.PLAYER_CAMP.coopPlayer))&&(s.addMoney(a),s.combatStatistic.countMosterNum(i));else if(n.default.getInstance().isSkyCastle()&&T.getRoleIdentity(e)===d.PLAYER_IDENTITY.away){var r=n.default.getInstance().getPlayerModelByCamp(d.PLAYER_CAMP.opponents),s=n.default.getInstance().getPlayerModelByCamp(d.PLAYER_CAMP.opponentsCoop);r&&r.addMoney(a),s&&s.addMoney(a)}}else if(n.default.getInstance().isPvP()){var c=n.default.getInstance().getOpponentsCarCamp(e),l=n.default.getInstance().getPlayerModelByCamp(c);l&&(l.addMoney(a),l.combatStatistic.countMosterNum(i))}},t.prototype.insertSerNpcList=function(e,t){var o=new N;o.curBlood=t.curBlood,o.maxBlood=t.maxBlood,o.heroId=t.heroId,o.extraDropMoney=t.extraDropMoney,this.serverNpcList.set(e,o)},t.prototype.getMosterBlood=function(e){return this.serverNpcList.get(e)},t.prototype.onReceiveServerFrame=function(e,t){this.addFrames(e,t)},t.prototype.addFrames=function(){},t.prototype.runTick=function(){},t.prototype.nextTick=function(e){n.default.getInstance().gameState==d.Game_State.Fighting&&this.runTick(e)},t}(cc.Component);o.default=b,cc._RF.pop()},{"../combat/CombatManager":"CombatManager","../common/CombatModule":"CombatModule","../common/PlayerModule":"PlayerModule","../utils/ConfigUtils":"ConfigUtils","../utils/ConstValue":"ConstValue","../utils/GameUtils":"GameUtils","./FightNetwork":"FightNetwork","./LocalMessage":"LocalMessage","./protocol/BaseProtocols":"BaseProtocols","./protocol/FightProtocols":"FightProtocols","./protocol/TypeProtocols":"TypeProtocols","./protocol/long":"long"}],LogUtil:[function(e,t,o){"use strict";cc._RF.push(t,"a2baeo/SPFOIY7K/q9/7MBZ","LogUtil");var i,a=this&&this.__spreadArrays||function(){for(var e=0,t=0,o=arguments.length;t<o;t++)e+=arguments[t].length;var i=Array(e),a=0;for(t=0;t<o;t++)for(var n=arguments[t],r=0,s=n.length;r<s;r++,a++)i[a]=n[r];return i};Object.defineProperty(o,"__esModule",{value:!0}),o.LogUtilLevel=void 0,function(e){e[e.Log=1]="Log",e[e.Info=2]="Info",e[e.Warn=3]="Warn",e[e.Error=4]="Error"}(i=o.LogUtilLevel||(o.LogUtilLevel={}));var n=function(){function e(){}return e.log=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];!this._isCanLog||this.level>i.Log||this.checkIsLogNode(e,t)||console.log.apply(console,a([this.getTag("log"),e],t))},e.info=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];!this._isCanLog||this.level>i.Info||this.checkIsLogNode(e,t)||console.info.apply(console,a([this.getTag("info"),e],t))},e.warn=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];!this._isCanLog||this.level>i.Warn||this.checkIsLogNode(e,t)||console.info.apply(console,a([this.getTag("warn"),e],t))},e.error=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];!this._isCanLog||this.level>i.Error||this.checkIsLogNode(e,t)||console.info.apply(console,a([this.getTag("error"),e],t))},e.save=function(t){cc.sys.isNative?t&&t():e.log("\u5176\u4ed6\u5e73\u53f0\u4e0d\u652f\u6301\u4fdd\u5b58")},e.setIsCanLog=function(e){this._isCanLog=e},e.setIsIgnoreNode=function(e){this._isIgnoreNode=e},e.getFullTime=function(){var e=new Date;return e.getHours()+":"+e.getMinutes()+":"+e.getSeconds()+"-"+e.getMilliseconds()},e.getFileName=function(){var e=new Date;return e.getMonth()+"-"+e.getDay()+"_"+e.getHours()+":"+e.getMinutes()+":"+e.getSeconds()+".log"},e.defaultParseCallStack=function(e,t){void 0===t&&(t=4);var o=e.stack.split("\n").slice(t),i=this.stackReg.exec(o[0]);return i&&6===i.length?{functionName:i[1],fileName:i[2],lineNumber:parseInt(i[3],10),columnNumber:parseInt(i[4],10),callStack:o.join("\n")}:null},e.getTag=function(t){return e.baseTag+" [ "+e.getFullTime()+" ] [ "+t+" ]: "},e.checkIsLogNode=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];if(!this._isIgnoreNode)return!1;if(e instanceof cc.Node||e instanceof cc.Component)return!0;for(var i in t){var a=t[i];if(a instanceof cc.Node||a instanceof cc.Component)return!0}return!1},e.level=i.Log,e.baseTag="LOG_TAG",e._isCanLog=!0,e._isIgnoreNode=!1,e.stackReg=/at (?:(.+)\s+\()?(?:(.+?):(\d+)(?::(\d+))?|([^)]+))\)?/,e}();o.default=n,cc._RF.pop()},{}],LoginProtocols:[function(e,t,o){"use strict";cc._RF.push(t,"cd62egusyRPIYA9J/oVjXGf","LoginProtocols"),e("DataViewRW");var i=e("ObjCollection"),a=e("long");(function(e){e[e.P_Login_Begin=1e6]="P_Login_Begin",e[e.P_Login_Validate=1000001]="P_Login_Validate",e[e.P_Login_RequestRole=1000002]="P_Login_RequestRole",e[e.P_Login_CreateRole=1000003]="P_Login_CreateRole",e[e.P_Login_ChooseRole=1000004]="P_Login_ChooseRole",e[e.P_Login_ValidateOnline=1000005]="P_Login_ValidateOnline",e[e.P_Login_Ping=1000006]="P_Login_Ping",e[e.P_Login_Test=1000007]="P_Login_Test"})(o.LOGIN_CLIENT_ENUM||(o.LOGIN_CLIENT_ENUM={}));var n=function(){function e(){this.account="",this.passwd="",this.zoneid=0,this.platformId=0}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();if(e.getLen()-e.getPos()<t)return!1;if(this.account=e.getString(t),e.getLen()-e.getPos()<4)return!1;var o=e.getUint32();return!(e.getLen()-e.getPos()<o||(this.passwd=e.getString(o),e.getLen()-e.getPos()<8||(this.zoneid=e.getInt32(),this.platformId=e.getInt32(),0)))},e.prototype.writeNoEnd=function(e){e.setString(this.account),e.setString(this.passwd),e.setInt32(this.zoneid),e.setInt32(this.platformId)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Login_Validate=n;var r=function(){function e(){this.isSucceed=!1,this.serverUTCTime=0,this.key=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<6||(this.isSucceed=e.getBool(),this.serverUTCTime=e.getInt32(),this.key=e.getUint8(),0))},e.prototype.writeNoEnd=function(e){e.setBool(this.isSucceed),e.setInt32(this.serverUTCTime),e.setUint8(this.key)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Login_Validate=r;var s=function(){function e(){}return e.prototype.read=function(){return!0},e.prototype.writeNoEnd=function(){},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Login_RequestRole=s;var c=function(){function e(){this.roleID=a.fromValue(0),this.showID="",this.name="",this.level=0}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<12)return!1;this.roleID=e.getLong();var t=e.getUint32();if(e.getLen()-e.getPos()<t)return!1;if(this.showID=e.getString(t),e.getLen()-e.getPos()<4)return!1;var o=e.getUint32();return!(e.getLen()-e.getPos()<o||(this.name=e.getString(o),e.getLen()-e.getPos()<4||(this.level=e.getInt32(),0)))},e.prototype.writeNoEnd=function(e){e.setLong(this.roleID),e.setString(this.showID),e.setString(this.name),e.setInt32(this.level)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Login_Role=c;var l=function(){function e(){this.bIndulge=!1,this.roles=new i.ObjMap,this.forbidLoginTimeRemaining=0}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<5)return!1;this.bIndulge=e.getBool();var t=e.getUint32();this.roles.clear();for(var o=0;o<t;++o){var i;i=e.getLong();var a=new c;if(!a.read(e))return!1;this.roles.set(i,a)}return!(e.getLen()-e.getPos()<4||(this.forbidLoginTimeRemaining=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setBool(this.bIndulge),e.setUint32(this.roles.size),this.roles.forEach(function(t,o){e.setLong(o),t.writeNoEnd(e)}),e.setInt32(this.forbidLoginTimeRemaining)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Login_RequestRole=l;var d=function(){function e(){this.name="",this.sex=0,this.headID=0}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();return!(e.getLen()-e.getPos()<t||(this.name=e.getString(t),e.getLen()-e.getPos()<8||(this.sex=e.getInt32(),this.headID=e.getInt32(),0)))},e.prototype.writeNoEnd=function(e){e.setString(this.name),e.setInt32(this.sex),e.setInt32(this.headID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Login_CreateRole=d;var u=function(){function e(){this.result=0,this.roleId=a.fromValue(0),this.name=""}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<16)return!1;this.result=e.getInt32(),this.roleId=e.getLong();var t=e.getUint32();return!(e.getLen()-e.getPos()<t||(this.name=e.getString(t),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.result),e.setLong(this.roleId),e.setString(this.name)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Login_CreateRole=u;var h=function(){function e(){this.roleId=a.fromValue(0)}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.roleId=e.getLong(),0))},e.prototype.writeNoEnd=function(e){e.setLong(this.roleId)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Login_ChooseRole=h;var p=function(){function e(){this.result=!1}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<1||(this.result=e.getBool(),0))},e.prototype.writeNoEnd=function(e){e.setBool(this.result)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Login_ChooseRole=p;var f=function(){function e(){this.sdkType=0,this.sdkID=0,this.packageID=0,this.entranceID=0,this.clientType=0,this.accountName="",this.sign="",this.headUrl="",this.extra=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<24)return!1;this.sdkType=e.getInt32(),this.sdkID=e.getInt32(),this.packageID=e.getInt32(),this.entranceID=e.getInt32(),this.clientType=e.getInt32();var t=e.getUint32();if(e.getLen()-e.getPos()<t)return!1;if(this.accountName=e.getString(t),e.getLen()-e.getPos()<4)return!1;var o=e.getUint32();if(e.getLen()-e.getPos()<o)return!1;if(this.sign=e.getString(o),e.getLen()-e.getPos()<4)return!1;var i=e.getUint32();if(e.getLen()-e.getPos()<i)return!1;if(this.headUrl=e.getString(i),e.getLen()-e.getPos()<4)return!1;var a=e.getUint32();this.extra=[];for(var n=0;n<a;++n){var r;if(e.getLen()-e.getPos()<4)return!1;var s=e.getUint32();if(e.getLen()-e.getPos()<s)return!1;r=e.getString(s),this.extra.push(r)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.sdkType),e.setInt32(this.sdkID),e.setInt32(this.packageID),e.setInt32(this.entranceID),e.setInt32(this.clientType),e.setString(this.accountName),e.setString(this.sign),e.setString(this.headUrl),e.setUint32(this.extra.length),this.extra.forEach(function(t){e.setString(t)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Login_ValidateOnline=f;var g=function(){function e(){}return e.prototype.read=function(){return!0},e.prototype.writeNoEnd=function(){},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Login_Ping=g;var m=function(){function e(){}return e.prototype.read=function(){return!0},e.prototype.writeNoEnd=function(){},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Login_Ping=m;var _=function(){function e(){this.nInt=0,this.sString=""}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.nInt=e.getInt32();var t=e.getUint32();return!(e.getLen()-e.getPos()<t||(this.sString=e.getString(t),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.nInt),e.setString(this.sString)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.Struct_TestStruct=_;var y=function(){function e(){this.nUChar=0,this.nUInt=0,this.nChar=0,this.nBool=!1,this.nInt=0,this.nShort=0,this.nDouble=0,this.nFloat=0,this.nLong=a.fromValue(0),this.sString="",this.mMap=new i.ObjMap,this.vVector=[],this.mSMap=new i.ObjMap,this.vSVector=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<37)return!1;this.nUChar=e.getUint8(),this.nUInt=e.getUint32(),this.nChar=e.getInt8(),this.nBool=e.getBool(),this.nInt=e.getInt32(),this.nShort=e.getInt16(),this.nDouble=e.getFloat64(),this.nFloat=e.getFloat32(),this.nLong=e.getLong();var t=e.getUint32();if(e.getLen()-e.getPos()<t)return!1;if(this.sString=e.getString(t),e.getLen()-e.getPos()<4)return!1;var o=e.getUint32();this.mMap.clear();for(var i=0;i<o;++i){var a,n;if(a=e.getInt32(),e.getLen()-e.getPos()<4)return!1;var r=e.getUint32();if(e.getLen()-e.getPos()<r)return!1;n=e.getString(r),this.mMap.set(a,n)}if(e.getLen()-e.getPos()<4)return!1;var s=e.getUint32();this.vVector=[];for(var c=0;c<s;++c){var l;if(e.getLen()-e.getPos()<4)return!1;var d=e.getUint32();if(e.getLen()-e.getPos()<d)return!1;l=e.getString(d),this.vVector.push(l)}if(e.getLen()-e.getPos()<4)return!1;var u=e.getUint32();this.mSMap.clear();for(var h=0;h<u;++h){var p;p=e.getInt32();var f=new _;if(!f.read(e))return!1;this.mSMap.set(p,f)}if(e.getLen()-e.getPos()<4)return!1;var g=e.getUint32();this.vSVector=[];for(var m=0;m<g;++m){var y=new _;if(!y.read(e))return!1;this.vSVector.push(y)}return!0},e.prototype.writeNoEnd=function(e){e.setUint8(this.nUChar),e.setUint32(this.nUInt),e.setInt8(this.nChar),e.setBool(this.nBool),e.setInt32(this.nInt),e.setInt16(this.nShort),e.setFloat64(this.nDouble),e.setFloat32(this.nFloat),e.setLong(this.nLong),e.setString(this.sString),e.setUint32(this.mMap.size),this.mMap.forEach(function(t,o){e.setInt32(o),e.setString(t)}),e.setUint32(this.vVector.length),this.vVector.forEach(function(t){e.setString(t)}),e.setUint32(this.mSMap.size),this.mSMap.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)}),e.setUint32(this.vSVector.length),this.vSVector.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Login_Test=y;var v=function(){function e(){this.nUChar=0,this.nUInt=0,this.nChar=0,this.nBool=!1,this.nInt=0,this.nShort=0,this.nDouble=0,this.nFloat=0,this.nLong=a.fromValue(0),this.sString="",this.mMap=new i.ObjMap,this.vVector=[],this.mSMap=new i.ObjMap,this.vSVector=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<37)return!1;this.nUChar=e.getUint8(),this.nUInt=e.getUint32(),this.nChar=e.getInt8(),this.nBool=e.getBool(),this.nInt=e.getInt32(),this.nShort=e.getInt16(),this.nDouble=e.getFloat64(),this.nFloat=e.getFloat32(),this.nLong=e.getLong();var t=e.getUint32();if(e.getLen()-e.getPos()<t)return!1;if(this.sString=e.getString(t),e.getLen()-e.getPos()<4)return!1;var o=e.getUint32();this.mMap.clear();for(var i=0;i<o;++i){var a,n;if(a=e.getInt32(),e.getLen()-e.getPos()<4)return!1;var r=e.getUint32();if(e.getLen()-e.getPos()<r)return!1;n=e.getString(r),this.mMap.set(a,n)}if(e.getLen()-e.getPos()<4)return!1;var s=e.getUint32();this.vVector=[];for(var c=0;c<s;++c){var l;if(e.getLen()-e.getPos()<4)return!1;var d=e.getUint32();if(e.getLen()-e.getPos()<d)return!1;l=e.getString(d),this.vVector.push(l)}if(e.getLen()-e.getPos()<4)return!1;var u=e.getUint32();this.mSMap.clear();for(var h=0;h<u;++h){var p;p=e.getInt32();var f=new _;if(!f.read(e))return!1;this.mSMap.set(p,f)}if(e.getLen()-e.getPos()<4)return!1;var g=e.getUint32();this.vSVector=[];for(var m=0;m<g;++m){var y=new _;if(!y.read(e))return!1;this.vSVector.push(y)}return!0},e.prototype.writeNoEnd=function(e){e.setUint8(this.nUChar),e.setUint32(this.nUInt),e.setInt8(this.nChar),e.setBool(this.nBool),e.setInt32(this.nInt),e.setInt16(this.nShort),e.setFloat64(this.nDouble),e.setFloat32(this.nFloat),e.setLong(this.nLong),e.setString(this.sString),e.setUint32(this.mMap.size),this.mMap.forEach(function(t,o){e.setInt32(o),e.setString(t)}),e.setUint32(this.vVector.length),this.vVector.forEach(function(t){e.setString(t)}),e.setUint32(this.mSMap.size),this.mSMap.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)}),e.setUint32(this.vSVector.length),this.vSVector.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Login_Test=v,cc._RF.pop()},{DataViewRW:"DataViewRW",ObjCollection:"ObjCollection",long:"long"}],LoginView:[function(e,t,o){"use strict";cc._RF.push(t,"8fd4a8KHn9Hl7wDcKWptBPS","LoginView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../common/PlayerModule"),s=e("../Global/GameGlobal"),c=e("../modules/base/BaseView"),l=e("../modules/base/Decorators"),d=e("../modules/base/GameView"),u=e("../network/ClientNetwork"),h=e("../network/LocalMessage"),p=e("../network/protocol/LoginProtocols"),f=e("../network/protocol/LoginProtocols"),g=e("../network/protocol/LoginProtocols"),m=e("../TableReader"),_=e("../utils/GameLoading"),y=e("../utils/GamePlatform"),v=e("../utils/GameUtils"),C=e("../utils/NameManager"),S=e("../utils/ResourceLoader"),T=e("../utils/subUtils/TypeDef"),I=e("../utils/UIManager"),N=e("../utils/WechatUtils"),b=e("../utils/H5Utils"),w=e("../common/CombatModule"),E=e("../network/protocol/MatchProtocols"),P=e("../network/protocol/TypeProtocols"),R=e("../controller/Guide/GuideConfig/GuideConst"),L=e("../Global"),A=e("../../load"),D=e("../utils/ConfigUtils"),M=e("../utils/QQMiniGameUtils"),B=e("../utils/LogUtil"),k=e("../model/ServerAddrInfo"),G=e("../utils/ByteDanceMiniGameUtils"),O=e("../utils/QQGameHallUtils"),H=e("../utils/KSMinigameUtils"),V=e("../utils/TimeOffSetManager"),F=cc._decorator,U=F.ccclass,x=F.property,Y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.PersistRootNode=null,t.ServerNameTxt=null,t.userNameNode=null,t.userPasswordNode=null,t.userPlatformNode=null,t.gameLoadingNode=null,t.VerLab=null,t.reportNode=null,t.enterBtn=null,t.serverChooseNode=null,t.userProtocolTxt=null,t.privacyProtocolTxt=null,t.add7protoNode=null,t.protocolNode=null,t.ServerListNode=null,t.ServerBtn=null,t.loginBtn=null,t.wechatLoginBtn=null,t.m_serverIndex=7,t.m_serverUrl="",t.zoneId=0,t.account="",t.pwd="",t.platform=0,t._clickedEnterBtn=!1,t}return a(t,e),t.prototype.onEnable=function(){var e,t;y.GamePlatform.isWechat()?null===(e=wx.getOpenDataContext())||void 0===e||e.postMessage({}):y.GamePlatform.isQQMiniGame()&&(null===(t=qq.getOpenDataContext())||void 0===t||t.postMessage({}))},t.prototype.waitingConfigUtils=function(){if(D.default.getInstance().checkAllConfigDone()){this.unschedule(this.waitingConfigUtils);var e=r.default.getRoleAttrValByKey(P.ROLE_ATTR_VALUES.ROLE_ATTR_MAPSKINID);e<=0&&(e=701);var t="main_map/main_map_"+e+"/main_map_"+e;cc.resources.load(t,cc.Prefab,function(){s.G.UIManager.LoadScene(I.SceneName.MainScene,I.SceneTag.MainScene,0,function(){d.default.addLayerView("BaseCtrl","MainSceneView","MainSceneView")})})}},t.prototype.start=function(){var e=this;if(B.default.log("LoginView, start!",y.GamePlatform.isWechat(),y.GamePlatform.isQQMiniGame(),y.GamePlatform.isByteDanceMiniGame(),y.GamePlatform.isKuaishouMiniGame()),B.default.log("cc.sys.os=",cc.sys.os),B.default.log("cc.sys.platform=",cc.sys.platform,cc.sys.DESKTOP_BROWSER),this.node.setContentSize(cc.winSize),this.gameLoadingNode.active=!1,this.reportNode.active=!1,this.ServerListNode=this.node.getChildByName("ServerListNode"),this.ServerBtn=this.node.getChildByName("ServerBtn"),this.loginBtn=this.node.getChildByName("LoginButton"),this.m_agreementNode=this.node.getChildByName("Agreement"),this.m_agreementToggleNode=this.m_agreementNode.getChildByName("checkBox"),this.m_agreementNode.active=!1,y.GamePlatform.isWechat()&&(m.PreLoadCsvSync("WorldNoticeTableData"),this.node.parent.getChildByName("LoginSprite").getChildByName("provotoBtn").active=!0),cc.sys.platform==cc.sys.DESKTOP_BROWSER&&"qqgame"==y.GamePlatform.getQQGameUrlParam("pf")&&(y.GamePlatform.is_platform_qqGameHall=!0),cc.sys.platform==cc.sys.MOBILE_BROWSER&&"bigBlueH5Video"==y.GamePlatform.getQQGameUrlParam("pf")){y.GamePlatform.is_bigBlueH5=!0,y.GamePlatform.video_type="bigBlue";var t=y.GamePlatform.getQQGameUrlParam("bgImg");if(""!=t){var o=this.node.parent.getChildByName("LoginSprite").getComponent(cc.Sprite);o.spriteFrame=new cc.SpriteFrame;var i="https://mszctest-1300944069.file.myqcloud.com/bigBlueBgImg/"+t+".png";i=i+"?"+V.TimeOffSetManager.getMilisecond(),console.log("login bgImg url="+i),i&&cc.assetManager.loadRemote(i,function(e,t){if(cc.isValid(this,!0)&&null==e&&t){var i=new cc.SpriteFrame(t);o.spriteFrame=i}}.bind(this))}this.scheduleOnce(function(){y.GamePlatform.RequestIsSmallBag()},1)}else if(cc.sys.platform==cc.sys.MOBILE_BROWSER&&"ly5add7"==y.GamePlatform.getQQGameUrlParam("pf")){m.PreLoadCsvSync("WorldNoticeTableData"),y.GamePlatform.is_ly5add7=!0,y.GamePlatform.video_type="ly5add7",y.GamePlatform.is_miya=!0;var a=y.GamePlatform.getQQGameUrlParam("pid");this.node.parent.getChildByName("LoginSprite").getChildByName("changeButton").active=!0,""!=a&&y.GamePlatform.setLY5Add7Pid(Number(a)),this.m_agreementNode.active=!0;var n=cc.sys.localStorage.getItem("agreement");this.m_agreementToggleNode.getComponent(cc.Toggle).isChecked=1==n,1==n?(AppActivity.Init5Add7(),this.add7protoNode.active=!1):this.add7protoNode.active=!0,this.scheduleOnce(function(){y.GamePlatform.RequestIsSmallBag()},1)}else if(cc.sys.platform==cc.sys.MOBILE_BROWSER&&"ttss"==y.GamePlatform.getQQGameUrlParam("pf"))y.GamePlatform.is_mayiH5yl=!0,y.GamePlatform.video_type="ttss",y.GamePlatform.is_miya=!0,this.scheduleOnce(function(){y.GamePlatform.RequestIsSmallBag()},1);else if(cc.sys.platform==cc.sys.MOBILE_BROWSER&&"mayiH5my"==y.GamePlatform.getQQGameUrlParam("pf"))y.GamePlatform.is_mayiH5my=!0,y.GamePlatform.video_type="mayiH5my",y.GamePlatform.is_miya=!0,this.scheduleOnce(function(){y.GamePlatform.RequestIsSmallBag()},1);else if(cc.sys.platform==cc.sys.MOBILE_BROWSER&&"hykb"==y.GamePlatform.getQQGameUrlParam("pf"))y.GamePlatform.is_ly5add7=!0,y.GamePlatform.video_type="ly5add7",y.GamePlatform.is_miya=!0,y.GamePlatform.is_hykb=!0,this.scheduleOnce(function(){y.GamePlatform.RequestIsSmallBag()},1);else if(cc.sys.platform==cc.sys.MOBILE_BROWSER&&"mayiH5yl"==y.GamePlatform.getQQGameUrlParam("pf")){y.GamePlatform.is_mayiH5yl=!0,y.GamePlatform.video_type="mayiH5yl",y.GamePlatform.is_miya=!0;var c=y.GamePlatform.getQQGameUrlParam("anchor");""!=c&&(y.GamePlatform.anchor_type=c),this.scheduleOnce(function(){y.GamePlatform.RequestIsSmallBag()},1)}else cc.sys.platform==cc.sys.MOBILE_BROWSER&&"mayiH5ylks"==y.GamePlatform.getQQGameUrlParam("pf")?(y.GamePlatform.is_mayiH5yl=!0,y.GamePlatform.video_type="ylks",y.GamePlatform.is_miya=!0,this.scheduleOnce(function(){y.GamePlatform.RequestIsSmallBag()},1)):cc.sys.platform==cc.sys.MOBILE_BROWSER&&"lyH5sq"==y.GamePlatform.getQQGameUrlParam("pf")?(y.GamePlatform.is_lyH5sq=!0,y.GamePlatform.video_type="lyH5sq",y.GamePlatform.is_miya=!0,this.node.parent.getChildByName("LoginSprite").getChildByName("changeButton").active=!0,this.scheduleOnce(function(){y.GamePlatform.RequestIsSmallBag()},1)):cc.sys.platform==cc.sys.MOBILE_BROWSER&&"issueByDance"==y.GamePlatform.getQQGameUrlParam("pf")?(y.GamePlatform.is_mayiH5yl=!0,y.GamePlatform.video_type="issueByDance",y.GamePlatform.is_miya=!0,this.scheduleOnce(function(){y.GamePlatform.RequestIsSmallBag()},1)):cc.sys.platform==cc.sys.MOBILE_BROWSER&&"mayiH5gdt"==y.GamePlatform.getQQGameUrlParam("pf")?(y.GamePlatform.is_mayiH5my=!0,y.GamePlatform.video_type="mayiH5gdt",y.GamePlatform.is_miya=!0,this.scheduleOnce(function(){y.GamePlatform.RequestIsSmallBag()},1)):cc.sys.platform==cc.sys.MOBILE_BROWSER&&"mayiH5tab"==y.GamePlatform.getQQGameUrlParam("pf")?(y.GamePlatform.is_mayiH5my=!0,y.GamePlatform.video_type="mayiH5tab",y.GamePlatform.is_miya=!0,this.scheduleOnce(function(){y.GamePlatform.RequestIsSmallBag()},1)):cc.sys.platform==cc.sys.MOBILE_BROWSER&&"lyH5dysb"==y.GamePlatform.getQQGameUrlParam("pf")?(y.GamePlatform.is_lyH5dysb=!0,"5add7ChannelTest"==y.GamePlatform.getQQGameUrlParam("Channeltype")&&(y.GamePlatform.is_mayiH5my=!0),y.GamePlatform.video_type="lyH5dysb",y.GamePlatform.is_miya=!0,this.scheduleOnce(function(){y.GamePlatform.RequestIsSmallBag()},1)):cc.sys.platform==cc.sys.MOBILE_BROWSER&&"mayiH5xfc"==y.GamePlatform.getQQGameUrlParam("pf")&&(y.GamePlatform.is_mayiH5my=!0,y.GamePlatform.is_lyH5dysb=!0,y.GamePlatform.video_type="mayiH5xfc",y.GamePlatform.is_miya=!0,this.scheduleOnce(function(){y.GamePlatform.RequestIsSmallBag()},1));var l=this,d=function(){l.userNameNode.active=!1,l.userPasswordNode.active=!1,l.userPlatformNode.active=!1,l.ServerListNode.active=!1,l.ServerBtn.active=!1,l.serverChooseNode.active=!1,l.enterBtn.active=!1,l.loginBtn=l.node.getChildByName("LoginButton"),l.loginBtn.active=!1,l.wechatLoginBtn=l.node.getChildByName("WechatLoginButton"),l.wechatLoginBtn.active=!1,console.log("closeBtnShow========================")};"bigBlueH5"==y.GamePlatform.getQQGameUrlParam("pf")?(console.log("is_bigBlueNoVideoH5=="),y.GamePlatform.is_bigBlueNoVideoH5=!0,y.GamePlatform.video_type="bigBlue",d()):"miyaIosH5"==y.GamePlatform.getQQGameUrlParam("pf")?(y.GamePlatform.is_miyaIosH5=!0,y.GamePlatform.video_type="miyaIosH5",d(),""!=(a=y.GamePlatform.getQQGameUrlParam("miyapid"))&&(y.GamePlatform.miyaIospid=Number(a))):"meituan"==y.GamePlatform.getQQGameUrlParam("pf")&&(console.log("meituan===================================="),y.GamePlatform.is_meituan=!0),"bigBlue"!=y.GamePlatform.getMiYaVideoType()&&(this.node.parent.getChildByName("LoginSprite").getChildByName("bigBlueBg").active=!1),cc.director.on("javaBridgeLoginSuccess",this.loginCallBack,this),cc.director.on("javaBridgeSmallBagLoginSuccess",this.mayiOrSmallBagLogin,this),cc.director.on("clearToken",this.clearToken,this),this.ServerListNode.active=!1,D.default.getInstance().initData(),y.GamePlatform.isQQGameRoom()?(m.PreLoadCsvSync("GuidePlotTableData"),m.PreLoadCsvSync("LoadingBgTableData"),m.PreLoadCsvSync("LoadingTipsTableData"),m.PreLoadCsvSync("SoundTableData"),m.PreLoadCsvSync("RobotTableData"),m.PreLoadCsvSync("ConfigIntTableData"),m.PreLoadCsvSync("NameTableData").then(function(){C.default.getInstance()})):(m.PreLoadCsv("GuidePlotTableData"),m.PreLoadCsv("LoadingBgTableData"),m.PreLoadCsv("LoadingTipsTableData"),m.PreLoadCsv("SoundTableData"),m.PreLoadCsv("RobotTableData"),m.PreLoadCsv("ConfigIntTableData"),m.PreLoadCsv("NameTableData").then(function(){C.default.getInstance().getName(1)})),cc.game.addPersistRootNode(this.PersistRootNode);this.userNameNode.active = !1, this.userPasswordNode.active = !1, this.userPlatformNode.active = !1, this.enterBtn.active = !1;var w="accountName";if(this.account=v.getLocalData(w),w="password"+this.zoneId,this.pwd=v.getLocalData(w),this.userNameNode.getComponent(cc.EditBox).textLabel.string=this.account,this.userNameNode.getChildByName("TEXT_LABEL").active=!0,this.userPasswordNode.getChildByName("TEXT_LABEL").active=!0,this.userPlatformNode.getChildByName("TEXT_LABEL").active=!0,this.userNameNode.getChildByName("PLACEHOLDER_LABEL").active=!1,this.userPasswordNode.getChildByName("PLACEHOLDER_LABEL").active=!0,this.userPlatformNode.getChildByName("PLACEHOLDER_LABEL").active=!0,u.ClientNetwork.getInstance().listenLocalMessage(h.LOCAL_MESSAGE.LocalMsg_AgreeUserProtocol,function(){e.showProtocolPrivacy()},this),u.ClientNetwork.getInstance().listenLocalMessage(h.LOCAL_MESSAGE.LocalMsg_SmallBagLogin,function(e){console.log("loginResult=========11==2=============",e,e[0],e[1],e[2]),this.loginCallBack(e[0],e[1],e[2])}.bind(this),this),u.ClientNetwork.getInstance().listenLocalMessage(h.LOCAL_MESSAGE.LocalMsg_AgreePrivacyProtocol,function(){e.onClickAgreePrivacy()},this),u.ClientNetwork.getInstance().listenLocalMessage(h.LOCAL_MESSAGE.LocalMsg_ChooseServer,function(e){l.onSelectServerGroup(e)},this),u.ClientNetwork.getInstance().listenLocalMessage(h.LOCAL_MESSAGE.LocalMsg_EnterMainScene,function(){if(w="password"+l.zoneId,v.setLocalData(w,l.pwd),T.GlobalVar.setAccountName(l.account),T.GlobalVar.setPassword(l.pwd),T.GlobalVar.setZoneId(l.zoneId),T.GlobalVar.setPlatform(l.platform),r.default.getRoleAttrValByKey(P.ROLE_ATTR_VALUES.ROLE_ATTR_GUIDE)<R.default.BattleGuide.guideId&&0==L.default.Instance.jumpGuide){var e=new E.C_Match_Fight;e.fightType=P.FIGHT_TYPE.FIGHT_TYPE_BATTLE,e.params.push(v.getConfigVersion()),u.ClientNetwork.getInstance().Send(E.MATCH_CLIENT_ENUM.P_Match_Fight,e,!1),setTimeout(function(){y.GamePlatform.isWechat()&&N.WechatUtils.getInstance().checkInviteInfo(null),y.GamePlatform.isQQMiniGame()&&M.QQMiniGameUtils.getInstance().checkInviteInfo(null),y.GamePlatform.isByteDanceMiniGame()&&G.default.getInstance().checkInviteInfo(null),y.GamePlatform.isKuaishouMiniGame()&&H.KSMinigameUtils.getInstance().checkInviteInfo(null)},1e3)}else S.ResourceLoaderLayer.setType(I.ResourceType.game_main_from_out_game),_.default.setCallBack(null,function(){l.unschedule(l.waitingConfigUtils),l.schedule(l.waitingConfigUtils,.1)}),_.default.show();(y.GamePlatform.getMiYa()||y.GamePlatform.IsSmallBag()||y.GamePlatform.IsH5SmallBag()||y.GamePlatform.IsMiYaIosH5())&&("bigBlue"!=y.GamePlatform.getMiYaVideoTypeNoSet()&&"ly5add7"!=y.GamePlatform.getMiYaVideoTypeNoSet()&&"miyaIosH5"!=y.GamePlatform.getMiYaVideoTypeNoSet()||y.GamePlatform.sendInfoGame("chooseServer"),y.GamePlatform.sendInfoGame("enterGame")),y.GamePlatform.setOnlineLoginTime()}.bind(this),this),u.ClientNetwork.getInstance().listenExtraMsg(u.EXTRA_MSG.EXTRA_MSG_CONNCET_SUCCEED,function(){if(console.log("HHHHHHHHHHHHHHHHHHH open loginview"),y.GamePlatform.isWechat()){(S=new f.C_Login_ValidateOnline).sdkType=2,S.sdkID=1,S.clientType=2,S.accountName=N.WechatUtils.getInstance().getWechatLoginData().accountname,S.sign=N.WechatUtils.getInstance().getWechatLoginData().sign,S.packageID=N.WechatUtils.getInstance().getChannelID(),console.log("req.packageID ==========  ",S.packageID),S.extra=[],console.log("servergroup a="+N.WechatUtils.getInstance().getWechatLoginData().accountname),console.log("servergroup b="+N.WechatUtils.getInstance().getWechatLoginData().sign);var e=wx.getLaunchOptionsSync().query,t=e.clue_token,o=e.trackid,i=e.uctrackid,a=e.channel,n=e.ksUnitId,r=e.wxgamecid,c=e.c;if(t?S.entranceID=60102:o?S.entranceID=60106:i?S.entranceID=60108:n?S.entranceID=60116:c?S.entranceID=60244:r?("CCBgAAoXkpQY9zqJTvv4tB"==r?S.entranceID=60183:"CCBgAAoXkpQY9zqJTvv4tK"==r?(S.entranceID=60239,S.extra.push(r)):"CCBgAAoXkpQY9zqJTvv4tL"==r?(S.entranceID=60240,S.extra.push(r)):"CCBgAAoXkpQY9zqJTvv4tI"==r?(S.entranceID=60241,S.extra.push(r)):"CCBgAAoXkpQY9zqJTvv4tH"==r?(S.entranceID=60242,S.extra.push(r)):"CCBgAAoXkpQY9zqJTvv4tM"==r&&(S.entranceID=60243,S.extra.push(r)),console.log("req.extra===============",S.extra)):N.WechatUtils.Instance.isFrom360dianjing()?S.entranceID=60245:S.entranceID=5e4,"xingtu"==a)S.entranceID=60110;else if("chuanshanjia"==a)S.entranceID=60109;else for(var d=1;d<101;d++)if(a=="xingtu"+d){S.entranceID=d<=50?60132+d:60135+d;break}try{(_=wx.getStorageSync("wxImage"))&&(S.headUrl=_),(C=wx.getStorageSync("wxNickName"))&&v.setLocalData("accountName",C)}catch(E){console.log("loginScene headUrl fail")}s.G.StringManager.PopStringOnceEnd(),u.ClientNetwork.getInstance().Send(g.LOGIN_CLIENT_ENUM.P_Login_ValidateOnline,S)}else if(y.GamePlatform.isQQMiniGame()){(S=new f.C_Login_ValidateOnline).sdkType=9,S.sdkID=0,S.clientType=2,S.accountName=M.QQMiniGameUtils.getInstance().getWechatLoginData().accountname,S.sign=M.QQMiniGameUtils.getInstance().getWechatLoginData().sign,S.packageID=M.QQMiniGameUtils.getInstance().getChannelID(),console.log("req.packageID ==========  ",S.packageID),S.entranceID=60107;var h=qq.getStorageSync("isDancejumpQQ");if(h){if(S.entranceID=60119,h.aid){var m=Number(h.aid);S.packageID=m%1e9}console.log("req.packageID =====isDancejumpQQ===== ",S.packageID)}try{(_=qq.getStorageSync("wxImage"))&&(S.headUrl=_),(C=qq.getStorageSync("wxNickName"))&&v.setLocalData("accountName",C)}catch(E){console.log("loginScene headUrl fail")}s.G.StringManager.PopStringOnceEnd(),u.ClientNetwork.getInstance().Send(g.LOGIN_CLIENT_ENUM.P_Login_ValidateOnline,S)}else if(y.GamePlatform.isByteDanceMiniGame()){(S=new f.C_Login_ValidateOnline).sdkType=G.default.SDK_TYPE,S.sdkID=0,S.clientType=2,S.accountName=G.default.getInstance().getWechatLoginData().accountname,S.sign=G.default.getInstance().getWechatLoginData().sign,S.packageID=G.default.getInstance().getChannelID(),console.log("req.packageID ==========  ",S.packageID),S.entranceID=G.default.JING_FEN_ID;try{var _,C;(_=tt.getStorageSync("wxImage"))&&(S.headUrl=_),(C=tt.getStorageSync("wxNickName"))&&v.setLocalData("accountName",C)}catch(E){console.log("loginScene headUrl fail")}s.G.StringManager.PopStringOnceEnd(),u.ClientNetwork.getInstance().Send(g.LOGIN_CLIENT_ENUM.P_Login_ValidateOnline,S)}else if(y.GamePlatform.isQQGameRoom())(S=new f.C_Login_ValidateOnline).sdkType=O.QQGameHallUtils.SDK_TYPE,S.sdkID=0,S.clientType=2,S.accountName=O.QQGameHallUtils.getInstance().getWechatLoginData().accountname,S.sign=O.QQGameHallUtils.getInstance().getWechatLoginData().sign,S.packageID=O.QQGameHallUtils.getInstance().getChannelID(),console.log("req.packageID ==========  ",S.packageID),S.entranceID=O.QQGameHallUtils.JING_FEN_ID,u.ClientNetwork.getInstance().Send(g.LOGIN_CLIENT_ENUM.P_Login_ValidateOnline,S);else if(y.GamePlatform.isKuaishouMiniGame())(S=new f.C_Login_ValidateOnline).sdkType=H.KSMinigameUtils.SDK_TYPE,S.sdkID=0,S.clientType=2,S.accountName=H.KSMinigameUtils.getInstance().getWechatLoginData().accountname,S.sign=H.KSMinigameUtils.getInstance().getWechatLoginData().sign,S.packageID=H.KSMinigameUtils.getInstance().getChannelID(),console.log("req.packageID ==========  ",S.packageID),S.entranceID=H.KSMinigameUtils.JING_FEN_ID,u.ClientNetwork.getInstance().Send(g.LOGIN_CLIENT_ENUM.P_Login_ValidateOnline,S);else if(y.GamePlatform.is_meituan)console.log("CC_PREVIEW && !CC_JSB ==========================="),(S=new p.C_Login_Validate).account=l.account,S.passwd=l.pwd,S.zoneid=l.zoneId,S.platformId=l.platform,v.setLocalData("accountName",l.account),u.ClientNetwork.getInstance().Send(g.LOGIN_CLIENT_ENUM.P_Login_Validate,S);else if(y.GamePlatform.getMiYa()||y.GamePlatform.IsSmallBag()||y.GamePlatform.IsH5SmallBag()||y.GamePlatform.IsMiYaIosH5()){var S=new f.C_Login_ValidateOnline,T=y.GamePlatform.getMiYaVideoType(),I=T.toString().slice(0,5),b=y.GamePlatform.getMiYaAnchorType();console.log("type======",T);var w=y.GamePlatform.getMiYaLoginData();if(w){if(S.sdkType=w.sdktype,S.sdkID=w.sdkid,"ylh"==T?S.entranceID=60103:"csj"==T?S.entranceID=60101:"gdt"==T?S.entranceID=60105:"mzf"==T?S.entranceID=340:"lektn"==I?S.entranceID=60111:"yltt"==T?S.entranceID=60112:"ks"==T?S.entranceID=60114:"ylks"==T?S.entranceID=60115:"bigBlue"==T?S.entranceID=342:"leniu"==T?S.entranceID=343:"zc"==T?S.entranceID=60118:"mayiH5yl"==T?S.entranceID=60122:"mayiH5my"==T?S.entranceID=60123:"lyH5sq"==T?S.entranceID=347:"issueByDance"==T?S.entranceID=60132:"mayiH5gdt"==T?S.entranceID=60105:"lyH5dysb"==T?S.entranceID=348:"ly5add7"==T?y.GamePlatform.is_hykb?S.entranceID=60185:(console.log("ly5add7-----------------pid=",y.GamePlatform.pid),S.entranceID=y.GamePlatform.pid):"ttss"==T?S.entranceID=60184:"mayiH5xfc"==T?S.entranceID=60238:"miyaIosH5"==T?(console.log("miyaIosH5-----------------pid=",y.GamePlatform.miyaIospid),S.entranceID=y.GamePlatform.miyaIospid):"tab"!=T&&"mayiH5tab"!=T||(S.entranceID=60104),""!=b)for(d=1;d<9;d++)if(b=="anchor"+d){S.entranceID=60123+d;break}console.log("req.entranceID-----------------------------------==================="+S.entranceID),S.clientType=2,S.accountName=w.accountname,S.sign=w.sign,S.headUrl="",u.ClientNetwork.getInstance().Send(g.LOGIN_CLIENT_ENUM.P_Login_ValidateOnline,S)}} else if (y.GamePlatform.isPC() || y.GamePlatform.isAndroid()) {var S = new f.C_Login_ValidateOnline,T = y.GamePlatform.getMiYaVideoType(),I = T.toString().slice(0, 5),b = y.GamePlatform.getMiYaAnchorType();console.log("type======", T);var w = y.GamePlatform.getMiYaLoginData();if (w) {if (S.sdkType = w.sdktype, S.sdkID = w.sdkid, "ylh" == T ? S.entranceID = 60103 : "csj" == T ? S.entranceID = 60101 : "gdt" == T ? S.entranceID = 60105 : "mzf" == T ? S.entranceID = 340 : "lektn" == I ? S.entranceID = 60111 : "yltt" == T ? S.entranceID = 60112 : "ks" == T ? S.entranceID = 60114 : "ylks" == T ? S.entranceID = 60115 : "bigBlue" == T ? S.entranceID = 342 : "leniu" == T ? S.entranceID = 343 : "zc" == T ? S.entranceID = 60118 : "mayiH5yl" == T ? S.entranceID = 60122 : "mayiH5my" == T ? S.entranceID = 60123 : "lyH5sq" == T ? S.entranceID = 347 : "issueByDance" == T ? S.entranceID = 60132 : "mayiH5gdt" == T ? S.entranceID = 60105 : "lyH5dysb" == T ? S.entranceID = 348 : "ly5add7" == T ? y.GamePlatform.is_hykb ? S.entranceID = 60185 : (console.log("ly5add7-----------------pid=", y.GamePlatform.pid), S.entranceID = y.GamePlatform.pid) : "ttss" == T ? S.entranceID = 60184 : "mayiH5xfc" == T ? S.entranceID = 60238 : "miyaIosH5" == T ? (console.log("miyaIosH5-----------------pid=", y.GamePlatform.miyaIospid), S.entranceID = y.GamePlatform.miyaIospid) : "tab" != T && "mayiH5tab" != T || (S.entranceID = 60104), "" != b)for (d = 1; d < 9; d++)if (b == "anchor" + d) {S.entranceID = 60123 + d;break} console.log("req.entranceID-----------------------------------===================" + S.entranceID), S.clientType = 2, S.accountName = w.accountname, S.sign = w.sign, S.headUrl = "", u.ClientNetwork.getInstance().Send(g.LOGIN_CLIENT_ENUM.P_Login_ValidateOnline, S)}}}.bind(this),this),u.ClientNetwork.getInstance().listenLocalMessage(h.LOCAL_MESSAGE.LocalMsg_GetServerAddr,function(e){0!=e[0].error?(y.GamePlatform.isWechat()||y.GamePlatform.isQQMiniGame()||y.GamePlatform.isByteDanceMiniGame()||y.GamePlatform.isQQGameRoom()||y.GamePlatform.isKuaishouMiniGame())&&(console.log("getserver failed:"+e[0].error),-2==e[0].error?s.G.StringManager.PopString(s.G.StringManager.getString("CONNECT_NO_NET")):s.G.StringManager.PopString(s.G.StringManager.getString("CONNECT_ERROR")),this.wechatLoginBtn.active=!0,this.enterBtn.active=!1):(l.zoneId=e[0].zone,y.GamePlatform.setMiYaLoginData(e[0]),l.onLoginGame(e[0].webname,e[0].webport))}.bind(this),this),y.GamePlatform.isWechat()||y.GamePlatform.isQQMiniGame()||y.GamePlatform.isByteDanceMiniGame()||y.GamePlatform.isQQGameRoom()||y.GamePlatform.IsH5SmallBag()||y.GamePlatform.IsMiYaIosH5()||y.GamePlatform.isKuaishouMiniGame()){if(u.ClientNetwork.getInstance().listenLocalMessage(h.LOCAL_MESSAGE.LocalMsg_SDK_LoginRet,function(e){if(0!=e[0].error)console.log("Wechat failed:"+e[0].error),-2==e[0].error?s.G.StringManager.PopString(s.G.StringManager.getString("CONNECT_NO_NET")):s.G.StringManager.PopString(s.G.StringManager.getString("CONNECT_ERROR")),this.wechatLoginBtn.active=!0,this.enterBtn.active=!1;else{var t=k.ServerAddrInfo.getInstance().getLastLoginServerInfo();t&&l.onSelectServerGroup(t.groupId)}}.bind(this),this),u.ClientNetwork.getInstance().listenExtraMsg(u.EXTRA_MSG.EXTRA_MSG_CLOSE,function(){y.GamePlatform.IsSmallBag()||y.GamePlatform.IsH5SmallBag()||y.GamePlatform.IsMiYaIosH5()?(s.G.StringManager.PopString(s.G.StringManager.getString("CONNECT_ERROR_EXTRA_MSG_CLOSE")),console.log("bigblue EXTRA_MSG_CLOSE")):(s.G.StringManager.PopString(s.G.StringManager.getString("CONNECT_ERROR")),this.wechatLoginBtn.active=!0,this.enterBtn.active=!1)}.bind(this),this),s.G.StringManager.PopStringOnce("\u6b63\u5728\u767b\u5f55\uff0c\u8bf7\u7a0d\u7b49..."),y.GamePlatform.isWechat())N.WechatUtils.getInstance().userLogin(),N.WechatUtils.getInstance().requestAiQiYiJumpIsOpen();else if(y.GamePlatform.isQQMiniGame())M.QQMiniGameUtils.getInstance().requestDanceJumpQQIsOpen(),M.QQMiniGameUtils.getInstance().userLogin();else if(y.GamePlatform.isByteDanceMiniGame())G.default.getInstance().userLogin();else if(y.GamePlatform.isQQGameRoom())O.QQGameHallUtils.getInstance().userLogin();else if(y.GamePlatform.IsH5SmallBag()||y.GamePlatform.IsMiYaIosH5())try{this.scheduleOnce(function(){b.H5Utils.getInstance().tgH5Init()},1.5)}catch(F){}else y.GamePlatform.isKuaishouMiniGame()&&H.KSMinigameUtils.getInstance().userLogin();this.userNameNode.active=!1,this.userPasswordNode.active=!1,this.userPlatformNode.active=!1,this.ServerListNode.active=!1,this.ServerBtn.active=!1,this.serverChooseNode.active=!1,this.enterBtn.active=!1,this.loginBtn=this.node.getChildByName("LoginButton"),this.loginBtn.active=!1,this.wechatLoginBtn=this.node.getChildByName("WechatLoginButton"),this.wechatLoginBtn.active=!1}else y.GamePlatform.IsMiYa()||y.GamePlatform.IsSmallBag()?this.mayiOrSmallBagLogin():(y.GamePlatform.is_meituan&&(this.userPasswordNode.active=!1,this.userPlatformNode.active=!1),k.ServerAddrInfo.getInstance().requestPCServerList(this.account,this.pwd,function(e){if(0==e){var t=k.ServerAddrInfo.getInstance().getLastLoginServerInfo();t&&u.ClientNetwork.getInstance().pushLocalMessage(h.LOCAL_MESSAGE.LocalMsg_ChooseServer,t.groupId);this.scheduleOnce(function () {k.ServerAddrInfo.getInstance().requestPCServer();}, 1.5);}}.bind(this)));v.backgroundFitScreen(this.node.parent,this.node.parent.getChildByName("LoginSprite")),v.backgroundFitScreen(this.node.parent,this.node.parent.getChildByName("TipPopWindow").getChildByName("bantou")),v.backgroundFitScreen(this.node.parent,this.node.parent.getChildByName("5add7proto").getChildByName("bantou")),this.onListenMatchResult(),this._jumpGuideNode=this.node.getChildByName("JumpGuideNode").getChildByName("jumpGuideToggle"),this.node.getChildByName("JumpGuideNode").active=!1,y.GamePlatform.isWechat()||y.GamePlatform.isQQMiniGame()||y.GamePlatform.isByteDanceMiniGame()||y.GamePlatform.isQQGameRoom()||y.GamePlatform.IsSmallBag()||y.GamePlatform.IsH5SmallBag()||y.GamePlatform.isKuaishouMiniGame()||y.GamePlatform.IsMYSmallBag()||y.GamePlatform.IsYLSmallBag()||y.GamePlatform.IsLYSmallBag()||y.GamePlatform.Is5Add7SmallBag()?this.VerLab.string=A.wechatminiLoaclGameVer:this.VerLab.string=L.default.Instance.version,y.GamePlatform.isKuaishouMiniGame(),this.protocolNode.active=!1,console.log("LoginView, start end!"),v.setLocalData("SaveAnniversaryRedFlag","0"),v.setLocalData("SaveFogHiddenRedFlag","0"),v.setLocalData("SaveMachinariumCityRedFlag","0")},t.prototype.onAccountEditDidEnded=function(e){this.account=e.string,this.ServerListNode.active=!1},t.prototype.mayiOrSmallBagLogin=function(){if(this.userNameNode.active=!1,this.userPasswordNode.active=!1,this.userPlatformNode.active=!1,this.ServerListNode.active=!1,this.ServerBtn.active=!1,this.serverChooseNode.active=!1,this.enterBtn.active=!1,this.loginBtn=this.node.getChildByName("LoginButton"),this.loginBtn.getComponent(cc.Widget).bottom=110,""!=v.getLocalData("token")){if(this.loginBtn.active=!1,this.enterBtn.active=!0,console.log("servergroup loginMiYa"),y.GamePlatform.IsSmallBag()||y.GamePlatform.IsYLSmallBag()||y.GamePlatform.IsMYSmallBag()||y.GamePlatform.IsLYSmallBag()||y.GamePlatform.IsDysbSmallBag())return void AppActivity.RequestLogin();if(y.GamePlatform.Is5Add7SmallBag())return void(7!=y.GamePlatform.pid&&this.scheduleOnce(function(){AppActivity.RequestLogin()},2));y.GamePlatform.isAndroid()?jsb.reflection.callStaticMethod("org/cocos2dx/javascript/AppActivity","RequestLogin","()V"):jsb.reflection.callStaticMethod("AppController","RequestLogin")}else this.loginBtn.active=!0,this.enterBtn.active=!1},t.prototype.onPwdEditDidEnded=function(e){this.pwd=e.string,this.ServerListNode.active=!1},t.prototype.onPlatformEditDidEnded=function(e){this.platform=parseInt(e.string),this.ServerListNode.active=!1},t.prototype.onClickServerListBtn=function(){d.default.addPopView("BaseCtrl","ServerListMainView","ServerListMainView")},t.prototype.onSelectServerGroup=function(e){console.log("servergroup onSelectServerGroup "+e);var t=k.ServerAddrInfo.getInstance().getServerInfoByGroupId(e);t&&(this.ServerNameTxt.string="\u3010S"+t.groupId+"\u3011"+t.name),T.GlobalVar.setServerGroup(e),(y.GamePlatform.IsSmallBag()||y.GamePlatform.IsH5SmallBag()||y.GamePlatform.IsMiYaIosH5())&&(console.log("bigblue clear serverurl"),T.GlobalVar.setServerURL("")),(y.GamePlatform.isWechat()||y.GamePlatform.IsMiYa()||y.GamePlatform.IsSmallBag()||y.GamePlatform.isByteDanceMiniGame()||y.GamePlatform.isKuaishouMiniGame())&&0==k.ServerAddrInfo.getInstance().getLastLoginGroup()?y.GamePlatform.Is5Add7SmallBag()?(this.enterBtn.active=!0,this.serverChooseNode.active=!0,this.ServerBtn.active=!0,this.loginBtn.active=!1):(this.enterBtn.active=!1,this.serverChooseNode.active=!1,this.ServerBtn.active=!1,this.enterBtnClick()):(y.GamePlatform.isQQMiniGame()||y.GamePlatform.isQQGameRoom())&&0==k.ServerAddrInfo.getInstance().getLastLoginGroup()?(this.enterBtn.active=!0,this.serverChooseNode.active=!0,this.ServerBtn.active=!0,this.loginBtn.active=!1,this.showProtocolUser()):(this.enterBtn.active=!1,this.serverChooseNode.active=!0,this.ServerBtn.active=!0,this.loginBtn.active=!1)},t.prototype.onSelectServer=function(){},t.prototype.onWechatLogin=function(){console.log("LoginView, onWechatLogin!"),s.G.StringManager.PopStringOnce("\u6b63\u5728\u767b\u5f55\uff0c\u8bf7\u7a0d\u7b49..."),this.wechatLoginBtn.active=!1,this.enterBtn.active=!0,y.GamePlatform.isWechat()?N.WechatUtils.getInstance().userLogin():y.GamePlatform.isQQMiniGame()?M.QQMiniGameUtils.getInstance().userLogin():y.GamePlatform.isByteDanceMiniGame()?G.default.getInstance().userLogin():y.GamePlatform.IsH5SmallBag()||y.GamePlatform.IsMiYaIosH5()?b.H5Utils.getInstance().tgH5Init():y.GamePlatform.isKuaishouMiniGame()&&H.KSMinigameUtils.getInstance().userLogin()},t.prototype.init5Add7Channel=function(){AppActivity.Init5Add7(),this.add7protoNode.active=!1},t.prototype.canCell5Add7Channel=function(){AppActivity.exitGame()},t.prototype.close5Add7Tip=function(){this.add7protoNode.active=!1},t.prototype.onAgeTip=function(){this.reportNode.active=!0},t.prototype.confirmAgeTip=function(){this.reportNode.active=!1},t.prototype.cancellAgeTip=function(){this.reportNode.active=!1},t.prototype.enterBtnClickNew=function(){y.GamePlatform.isKuaishouMiniGame(),this.enterBtnClick()},t.prototype.enterBtnClick=function(){var e=this;if(!this._clickedEnterBtn){if(y.GamePlatform.Is5Add7SmallBag()&&!y.GamePlatform.is_hykb&&"1"!=cc.sys.localStorage.getItem("agreement"))return void s.G.StringManager.PopString(s.G.StringManager.getString("AGREEMENT_TIP"));if(this._clickedEnterBtn=!0,this.scheduleOnce(function(){e._clickedEnterBtn=!1},3),T.GlobalVar.getServerGroup()<=0)return s.G.StringManager.PopString(s.G.StringManager.getString("WAITTING_SERVER_GROUP")),void(y.GamePlatform.Is5Add7SmallBag()&&7==y.GamePlatform.pid&&AppActivity.RequestLogin());if(y.GamePlatform.isWechat())N.WechatUtils.getInstance().requestWXServer();else if(y.GamePlatform.isQQMiniGame())M.QQMiniGameUtils.getInstance().requestQQServer();else if(y.GamePlatform.isByteDanceMiniGame())G.default.getInstance().requestByteDanceServer();else if(y.GamePlatform.IsMiYa())k.ServerAddrInfo.getInstance().requestMiYaServer();else if(y.GamePlatform.IsSmallBag()){var t=T.GlobalVar.getServerURL();t&&t.length>0?(console.log("bigblue smallbag enterbtnclick"),u.ClientNetwork.getInstance().Connect(t)):k.ServerAddrInfo.getInstance().requestMiYaServer()}else y.GamePlatform.IsH5SmallBag()||y.GamePlatform.IsMiYaIosH5()?b.H5Utils.getInstance().startLogin():y.GamePlatform.isQQGameRoom()?O.QQGameHallUtils.getInstance().requestQQServer():y.GamePlatform.isKuaishouMiniGame()?H.KSMinigameUtils.getInstance().requestServer():y.GamePlatform.IsMiYa()?k.ServerAddrInfo.getInstance().requestMiYaServer():y.GamePlatform.is_meituan&&k.ServerAddrInfo.getInstance().requestPCServer(this.account)}},t.prototype.loginMiYaBtnClick=function(){console.log("servergroup loginMiYaBtnClick"),y.GamePlatform.IsSmallBag()||y.GamePlatform.IsYLSmallBag()||y.GamePlatform.IsMYSmallBag()||y.GamePlatform.IsLYSmallBag()||y.GamePlatform.IsDysbSmallBag()||y.GamePlatform.is_hykb?AppActivity.RequestLogin():y.GamePlatform.Is5Add7SmallBag()?"1"!=cc.sys.localStorage.getItem("agreement")?s.G.StringManager.PopString(s.G.StringManager.getString("AGREEMENT_TIP")):AppActivity.RequestLogin():y.GamePlatform.isAndroid()?jsb.reflection.callStaticMethod("org/cocos2dx/javascript/AppActivity","RequestLogin","()V"):jsb.reflection.callStaticMethod("AppController","RequestLogin")},t.prototype.onLoginGame=function(e,t){var o=this;if (y.GamePlatform.isPC() || y.GamePlatform.isAndroid()) {return s.G.UIManager.showWaitingLayer(I.SceneName.LoginScene), this.m_serverUrl = "ws://" + e, T.GlobalVar.setServerURL(this.m_serverUrl), void (u.ClientNetwork.getInstance().Connect(this.m_serverUrl) && setTimeout(function () {u.ClientNetwork.getInstance().getWebSocket() && u.ClientNetwork.getInstance().getWebSocket().readyState === WebSocket.OPEN || (s.G.StringManager.PopString(s.G.StringManager.getString("CONNECT_ERROR")), o.wechatLoginBtn && (o.wechatLoginBtn.active = !0), o.enterBtn && (o.enterBtn.active = !1))}, 6e3));}},t.prototype.onListenMatchResult=function(){u.ClientNetwork.getInstance().listenProtocol(E.MATCH_CLIENT_ENUM.P_Match_Fight,function(e){e.resetPos();var t=new E.S_Match_Fight;if(t.read(e)){console.log("LoginView, P_Match_Fight, rsp=",t);var o=t.errorcode;if(8089==o){d.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:s.G.StringManager.getString("BATTLE_VERSION_NOT_MATCH"),confirmCb:function(){y.GamePlatform.isWechat()?wx.exitMiniProgram():y.GamePlatform.isQQMiniGame()?qq.exitMiniProgram():y.GamePlatform.isByteDanceMiniGame()?tt.exitMiniProgram():y.GamePlatform.isKuaishouMiniGame()&&ks.exitMiniProgram()}});try{this.clear()}catch(i){}}else 0!=o&&s.G.StringManager.PopStringOnce(s.G.StringManager.getString("MATCH_ROOM_FAIL"))}},this),u.ClientNetwork.getInstance().listenProtocol(E.MATCH_CLIENT_ENUM.P_Match_Result,function(e){e.resetPos();var t=new E.S_Match_Result;if(t.read(e)){var o=t.ret;if(0==o){if(t.matchRoles.forEach(function(e){e.roleID.equals(r.default.UUID)?w.default.setMatchBattleInfo(!0,e):(w.default.setMatchBattleInfo(!1,e),w.default.setMatchPlayerCards(e.heros))}),w.default.matchModule=t.fightModule,w.default.matchType=t.fightType,w.default.matchToken=t.fightToken,w.default.matchPattern=t.fightPattern,w.default.matchRoleIdentity=t.roleIdentity,w.default.matchSeedIds=t.seedId,w.default.coopBossIdIndexs=t.bossIdIndexs,r.default.getRoleAttrValByKey(P.ROLE_ATTR_VALUES.ROLE_ATTR_GUIDE)<R.default.BattleGuide.guideId)w.default.setCombatType(w.CombatType.SOLO),w.default.setBattleMapId(101),w.default.setCarSummonId(1,9999),w.default.setCarSummonId(2,1e4);else{w.default.matchType==P.FIGHT_TYPE.FIGHT_TYPE_COOPERATION?w.default.setCombatType(w.CombatType.COOP):w.default.matchType==P.FIGHT_TYPE.FIGHT_TYPE_DUEL_BATTLE&&w.default.setCombatType(w.CombatType.DUEL);var i=0;if(w.default.getCombatType()==w.CombatType.DUEL){w.default.setBattleMapId(101);var a=D.default.getInstance().getBattleCfg();if(a[101]){var n=a[101].summon_id.split("|");for(var c in n){var l=n[c].split("#");w.default.setCarSummonId(l[0],l[1])}}}else{var d=D.default.getInstance().getBattleCfg();for(var u in d)if(d[u].type==this.m_nCurCombatType){w.default.setBattleMapId(d[u].id),d[u].bath_id&&(i=d[u].bath_id);break}}i&&i>0&&w.default.setBatchMonsterId(i)}S.ResourceLoaderLayer.setType(I.ResourceType.game_main_from_out_game),_.default.setCallBack(null,function(){s.G.UIManager.LoadScene(I.SceneName.PveFightScene,I.SceneTag.PveFightScene)}),_.default.show()}else console.log("P_Match_Result errorcode\uff1a%d",o)}else console.log("P_Match_Result error")},this)},t.prototype.onClickJumpGuide=function(e){v.setLocalData("bJumpGuide",e.isChecked),L.default.Instance.jumpGuide=e.isChecked},t.prototype.clearToken=function(){console.log("clearToken================================================="),cc.sys.localStorage.removeItem("token"),cc.sys.localStorage.removeItem("wxdata"),cc.sys.localStorage.removeItem("uid")},t.prototype.loginCallBack=function(e,t,o){var i=this;v.setLocalData("wxdata",e),v.setLocalData("token",t),v.setLocalData("uid",o),y.GamePlatform.isIOS();var a="https://mszcs1.gameserver.iplay11g.com/gmsys/weblogic/webc/miyaservergroup.php",n=y.GamePlatform.getMiYaVideoType();"testUpdate"==n||"iosBgm"==n?a="https://mszctest.gameserver.iplay11g.com/gmsys/weblogic/webc/miyaservergroup.php":"bigBlue"==n&&(a="https://mszcappphp.gameserver.iplay11g.com/gmsys/weblogic/webc/miyaservergroup.php"),a+="?",a+="&open_id="+o,a+="&extjson="+e,console.log("servergroup miya loginCallBack url="+a);var r=new XMLHttpRequest;r.onreadystatechange=function(){if(console.log("xMLHttpRequest.readyState===1==============",r.readyState,"xMLHttpRequest.status=====================",r.status),4==r.readyState&&r.status>=200&&r.status<400){var e=r.responseText.toString(),t=JSON.parse(e);console.log("servergroup MiYaLoginCallBack",e),k.ServerAddrInfo.getInstance().initServerList(t.servers);var o=k.ServerAddrInfo.getInstance().getLastLoginServerInfo();o&&i.onSelectServerGroup(o.groupId)}},r.open("GET",a,!0),r.send()},t.prototype.onClickAgreement=function(){console.log("onClickAgreement",this.m_agreementToggleNode.getComponent(cc.Toggle).isChecked),cc.sys.localStorage.setItem("agreement",this.m_agreementToggleNode.getComponent(cc.Toggle).isChecked?1:0)},t.prototype.showProtocolUser=function(){console.log("LoginView, showProtocolUser!!"),d.default.addPopView("BaseCtrl","UserProtocolView","UserProtocolView",{showClose:y.GamePlatform.Is5Add7SmallBag()})},t.prototype.showProtocolPrivacy=function(){console.log("LoginView, showProtocolPrivacy!!"),d.default.addPopView("BaseCtrl","PrivacyProtocolView","PrivacyProtocolView",{showClose:y.GamePlatform.Is5Add7SmallBag()})},t.prototype.onClickAgreePrivacy=function(){this.enterBtnClick()},t.prototype.requestProtocolByType=function(e){void 0===e&&(e=1);var t="https://mszctest.gameserver.iplay11g.com/gmsys/weblogic/webc/getuserhelp.php?type="+e,o=this,i=new XMLHttpRequest;i.onload=function(){if(i.status>=200&&i.status<400){console.log("requestProtocolByType success",i);var t=i.responseText;if(t){var a=JSON.parse(t).value;1==e?o.userProtocolTxt.string=a:o.privacyProtocolTxt.string=a}}},i.onerror=function(){console.log("requestProtocolByType Error, type="+e)},i.open("GET",t,!0),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),i.timeout=1e4,i.send()},t.prototype.onClickNoticeCallBack=function(){d.default.addPopView("BaseCtrl","AnnouncementView","AnnouncementView")},t.prototype.onClickZhuXiaoCallBack=function(){AppActivity.ZhuXiao()},t.prototype.onClickProtocol=function(){d.default.addPopView("BaseCtrl","protocolView","protocolView")},t.prototype.onClickProtocol_user=function(){d.default.addPopView("BaseCtrl","UserProtocolView","UserProtocolView",{showClose:!0})},t.prototype.onClickProtocol_private=function(){d.default.addPopView("BaseCtrl","PrivacyProtocolView","PrivacyProtocolView",{showClose:!0})},t.prototype.onClickCheckBox_agreeProtocol=function(){},n([x(cc.Node)],t.prototype,"PersistRootNode",void 0),n([x(cc.Label)],t.prototype,"ServerNameTxt",void 0),n([x(cc.Node)],t.prototype,"userNameNode",void 0),n([x(cc.Node)],t.prototype,"userPasswordNode",void 0),n([x(cc.Node)],t.prototype,"userPlatformNode",void 0),n([x(cc.Node)],t.prototype,"gameLoadingNode",void 0),n([x(cc.Label)],t.prototype,"VerLab",void 0),n([x(cc.Node)],t.prototype,"reportNode",void 0),n([x(cc.Node)],t.prototype,"enterBtn",void 0),n([x(cc.Node)],t.prototype,"serverChooseNode",void 0),n([x(cc.RichText)],t.prototype,"userProtocolTxt",void 0),n([x(cc.RichText)],t.prototype,"privacyProtocolTxt",void 0),n([x(cc.Node)],t.prototype,"add7protoNode",void 0),n([x(cc.Node)],t.prototype,"protocolNode",void 0),n([l.Register_Button_Sound,l.Register_Class,U],t)}(c.default);o.default=Y,cc._RF.pop()},{"../../load":"load","../Global":"Global","../Global/GameGlobal":"GameGlobal","../TableReader":"TableReader","../common/CombatModule":"CombatModule","../common/PlayerModule":"PlayerModule","../controller/Guide/GuideConfig/GuideConst":"GuideConst","../model/ServerAddrInfo":"ServerAddrInfo","../modules/base/BaseView":"BaseView","../modules/base/Decorators":"Decorators","../modules/base/GameView":"GameView","../network/ClientNetwork":"ClientNetwork","../network/LocalMessage":"LocalMessage","../network/protocol/LoginProtocols":"LoginProtocols","../network/protocol/MatchProtocols":"MatchProtocols","../network/protocol/TypeProtocols":"TypeProtocols","../utils/ByteDanceMiniGameUtils":"ByteDanceMiniGameUtils","../utils/ConfigUtils":"ConfigUtils","../utils/GameLoading":"GameLoading","../utils/GamePlatform":"GamePlatform","../utils/GameUtils":"GameUtils","../utils/H5Utils":"H5Utils","../utils/KSMinigameUtils":"KSMinigameUtils","../utils/LogUtil":"LogUtil","../utils/NameManager":"NameManager","../utils/QQGameHallUtils":"QQGameHallUtils","../utils/QQMiniGameUtils":"QQMiniGameUtils","../utils/ResourceLoader":"ResourceLoader","../utils/TimeOffSetManager":"TimeOffSetManager","../utils/UIManager":"UIManager","../utils/WechatUtils":"WechatUtils","../utils/subUtils/TypeDef":"TypeDef"}],LookVideoView:[function(e,t,o){"use strict";cc._RF.push(t,"2653aT0CohFkLvuL4ibPbem","LookVideoView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../Global/GameGlobal"),s=e("../../modules/base/BaseView"),c=e("../../modules/base/Decorators"),l=e("../../network/ClientNetwork"),d=e("../../modules/base/GameView"),u=e("../../network/protocol/RoleProtocols"),h=e("../../utils/RewardedVideoAd"),p=e("../../network/protocol/RoleProtocols"),f=e("../../utils/RewardedVideoUnitIdConst"),g=e("../../utils/GamePlatform"),m=e("../../utils/ByteDanceMiniGameUtils"),_=cc._decorator,y=_.ccclass,v=_.property,C=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.contentLabel=null,t}return a(t,e),t.path=function(){return"ui/shop/prefab/look_video"},t.prototype.init=function(e){this._data=e,e.content&&(this.contentLabel.string=e.content)},t.prototype.start=function(){var e=this;l.ClientNetwork.getInstance().listenProtocol(u.ROLE_CLIENT_ENUM.P_Role_RandShopRefresh,function(t){t.resetPos();var o=new u.S_Role_RandShopRefresh;if(o.read(t))if(0===o.errorcode){e.closeView();var i=d.default.getViewByName("MainSceneView");i&&i.view&&i.view.onClientTaskAddAdvert(f.RewardedVideoClientIdConst.Shop_Refresh)}else r.G.StringManager.PopString("S_Role_RandShopRefresh Error "+o.errorcode)},this),l.ClientNetwork.getInstance().listenProtocol(u.ROLE_CLIENT_ENUM.P_Role_RandRechargeRefresh,function(t){t.resetPos();var o=new p.S_Role_RandRechargeRefresh;o.read(t)&&(0===o.errorcode?e.closeView():r.G.StringManager.PopString("S_Role_RandRechargeRefresh Error "+o.errorcode))},this),this.changeAdButtonSkins()},t.prototype.onLookVideoCallBack=function(){var e=this;h.default.createVideo({name:e._data.sourceName,adUnitId:e._data.adUnitId,advertID:e._data.advertID,finishCb:function(){e._data.cb&&e._data.cb()}})},t.prototype.changeAdButtonSkins=function(){g.GamePlatform.isByteDanceMiniGame()&&m.default.getInstance().changeSkinOfAdButton(this.node.getChildByName("tongzhi").getChildByName("lijishuaxin"),"lijishuaxin")},t.prototype.onDestroy=function(){l.ClientNetwork.getInstance().removeMessageTarget(this)},n([v(cc.Label)],t.prototype,"contentLabel",void 0),n([c.Register_Class,y],t)}(s.default);o.default=C,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/base/GameView":"GameView","../../network/ClientNetwork":"ClientNetwork","../../network/protocol/RoleProtocols":"RoleProtocols","../../utils/ByteDanceMiniGameUtils":"ByteDanceMiniGameUtils","../../utils/GamePlatform":"GamePlatform","../../utils/RewardedVideoAd":"RewardedVideoAd","../../utils/RewardedVideoUnitIdConst":"RewardedVideoUnitIdConst"}],LoopRollMsg:[function(e,t,o){"use strict";cc._RF.push(t,"17985Z6D51GDqtg/Iw64cEJ","LoopRollMsg");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../Global/GameGlobal"),s=cc._decorator,c=s.ccclass,l=s.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.maskNode=null,t.label=null,t.contentArr=new Array,t.startPos=null,t}return a(t,e),t.prototype.onLoad=function(){this.startPos=cc.v3(this.maskNode.width/2,0,0),0==this.contentArr.length&&(this.node.active=!1),this.label.node.position=this.startPos},t.prototype.startScroll=function(e){var t=this;if(null!=e&&0!=e.length&&(this.node.active=!0,r.G.LoopRollMsg.node.active=!0,this.contentArr.push(e),null==t.label.node.getActionByTag(0)||0!=this.label.node.getActionByTag(0).isDone())){var o=function(){if(t.contentArr.length>0){t.label.string=t.contentArr.shift(),t.label._forceUpdateRenderData(),t.label.node.position=t.startPos;var e=t.label.node.width+t.label.node.parent.width,i=e/100,a=cc.sequence(cc.moveBy(i,cc.v2(-e,0)),cc.callFunc(function(){t.label.string="",t.label.node.position=t.startPos,o()}));a.setTag(0),t.label.node.runAction(a)}else t.node.active=!1,r.G.LoopRollMsg.node.active=!1};o()}},t.prototype.onDestroy=function(){null!=this.label.node.getActionByTag(0)&&this.label.node.stopAction(this.label.node.getActionByTag(0))},n([l(cc.Node)],t.prototype,"maskNode",void 0),n([l(cc.Label)],t.prototype,"label",void 0),n([c],t)}(cc.Component);o.default=d,cc._RF.pop()},{"../Global/GameGlobal":"GameGlobal"}],LuckyGiftSelectRewardView:[function(e,t,o){"use strict";cc._RF.push(t,"3bc19S9RypIoonxyb6jHd61","LuckyGiftSelectRewardView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../modules/base/BaseView"),s=e("../utils/GameTools"),c=e("../modules/base/Decorators"),l=e("../modules/manager/LoadResManager"),d=e("../Global/GameGlobal"),u=e("../common/PlayerModule"),h=e("../utils/ConfigUtils"),p=e("../utils/GamePlatform"),f=cc._decorator,g=f.ccclass,m=f.property,_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.RewardNode=null,t.LuckyGiftSelectId=0,t.index=0,t.selectNum=0,t._rewardsArrNode=[],t}return a(t,e),t.path=function(){return"ui/shop/prefab/LuckyGiftSelectReward"},t.prototype.onLoad=function(){},t.prototype.start=function(){},t.prototype.init=function(e){var t=this,o=u.default.getCurSeasonData(),i=(this.node.getChildByName("taskinfo").getChildByName("reward_list"),o.seasonID);e.tRewards&&(this.index=e.index,e.tRewards.forEach(function(o){i>=o.season&&(2!=h.default.getInstance().getItemByID(o.itemID).type&&e.isEveryDayReacharge||(p.GamePlatform.isQQGameRoom()||p.GamePlatform.IsH5SmallBag()||p.GamePlatform.IsMiYaIosH5()||p.GamePlatform.IsDysbSmallBag()||p.GamePlatform.Is5Add7SmallBag())&&1010==o.itemID||s.default.createNormalItems(o.itemID,o.itemNum,t.RewardNode,function(i){var a=new cc.Node("select");a.parent=i;var n=a.addComponent(cc.Sprite);l.default.loadSpriteFrame("ui/drawcard/res/xianzhong").then(function(e){n.spriteFrame=e}),a.active=!1,a.scale=1.22,i.on(cc.Node.EventType.TOUCH_END,function(e){t.LuckyGiftSelectId=o.itemID,t.selectNum=o.itemNum,t._rewardsArrNode.forEach(function(t){t.getChildByName("select")&&(t==e.target?t.getChildByName("select").active=!0:t.getChildByName("select").active=!1)})}),i.scale=.7,t._rewardsArrNode.push(i),e.isEveryDayReacharge&&(i.getChildByName("num").active=!1)}))}));var a=Math.ceil(e.tRewards.length/6),n=Math.floor(84)+this.RewardNode.getComponent(cc.Layout).spacingY;this.RewardNode.height=n*a,this._data=e},t.prototype.onGetRewardCallBack=function(){0!==this.LuckyGiftSelectId?(null!=this._data.callBack?this._data.callBack.apply(this._data.parent,[this.LuckyGiftSelectId,this.index,this.selectNum]):this._data.parent.showSecectRwd(this.LuckyGiftSelectId,this.index,this.selectNum),this.closeView()):d.G.StringManager.PopString(d.G.StringManager.getString("LUCKY_SELECT"))},t.prototype.onClose=function(){this.closeView()},n([m(cc.Node)],t.prototype,"RewardNode",void 0),n([c.Register_Class,g],t)}(r.default);o.default=_,cc._RF.pop()},{"../Global/GameGlobal":"GameGlobal","../common/PlayerModule":"PlayerModule","../modules/base/BaseView":"BaseView","../modules/base/Decorators":"Decorators","../modules/manager/LoadResManager":"LoadResManager","../utils/ConfigUtils":"ConfigUtils","../utils/GamePlatform":"GamePlatform","../utils/GameTools":"GameTools"}],LuckyGiftSelectTableData:[function(e,t,o){"use strict";cc._RF.push(t,"753766lPABIQ4UeLvY5daGY","LuckyGiftSelectTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.LuckyGiftSelectTableData=void 0;var i=e("../TableReader"),a=e("./BaseTableData"),n=function(){function e(){this.id=0,this.prize=new Array,this.limit=0,this.percentT=0,this.percentF=0}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber();for(var o=e.getString(),n=new i.TableReader(o);n.getPos()<n.getLen();){var r=new a.SeasonItem;r.readOriginal(n),this.prize.push(r)}this.limit=e.getNumber(),this.percentT=e.getNumber(),this.percentF=e.getNumber()},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"LuckyGiftSelectTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.LuckyGiftSelectTableData=n,cc._RF.pop()},{"../TableReader":"TableReader","./BaseTableData":"BaseTableData"}],MD5:[function(e,t,o){"use strict";cc._RF.push(t,"0267eD8koNDl6G60k4BIn5Q","MD5"),Object.defineProperty(o,"__esModule",{value:!0});var i=function(){function e(){this.hexcase=0,this.b64pad=""}return e.prototype.hex_md5=function(e){return this.rstr2hex(this.rstr_md5(this.str2rstr_utf8(e)))},e.prototype.b64_md5=function(e){return this.rstr2b64(this.rstr_md5(this.str2rstr_utf8(e)))},e.prototype.any_md5=function(e,t){return this.rstr2any(this.rstr_md5(this.str2rstr_utf8(e)),t)},e.prototype.hex_hmac_md5=function(e,t){return this.rstr2hex(this.rstr_hmac_md5(this.str2rstr_utf8(e),this.str2rstr_utf8(t)))},e.prototype.b64_hmac_md5=function(e,t){return this.rstr2b64(this.rstr_hmac_md5(this.str2rstr_utf8(e),this.str2rstr_utf8(t)))},e.prototype.any_hmac_md5=function(e,t,o){return this.rstr2any(this.rstr_hmac_md5(this.str2rstr_utf8(e),this.str2rstr_utf8(t)),o)},e.prototype.md5_vm_test=function(){return!0},e.prototype.rstr_md5=function(e){return this.binl2rstr(this.binl_md5(this.rstr2binl(e),8*e.length))},e.prototype.rstr_hmac_md5=function(e,t){var o=this.rstr2binl(e);o.length>16&&(o=this.binl_md5(o,8*e.length));for(var i=Array(16),a=Array(16),n=0;n<16;n++)i[n]=909522486^o[n],a[n]=1549556828^o[n];var r=this.binl_md5(i.concat(this.rstr2binl(t)),512+8*t.length);return this.binl2rstr(this.binl_md5(a.concat(r),640))},e.prototype.rstr2hex=function(e){try{this.hexcase}catch(n){this.hexcase=0}for(var t,o=this.hexcase?"0123456789ABCDEF":"0123456789abcdef",i="",a=0;a<e.length;a++)t=e.charCodeAt(a),i+=o.charAt(t>>>4&15)+o.charAt(15&t);return i},e.prototype.rstr2b64=function(e){try{this.b64pad}catch(r){this.b64pad=""}for(var t="",o=e.length,i=0;i<o;i+=3)for(var a=e.charCodeAt(i)<<16|(i+1<o?e.charCodeAt(i+1)<<8:0)|(i+2<o?e.charCodeAt(i+2):0),n=0;n<4;n++)8*i+6*n>8*e.length?t+=this.b64pad:t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(a>>>6*(3-n)&63);return t},e.prototype.rstr2any=function(e,t){var o,i,a,n,r,s=t.length,c=Array(Math.ceil(e.length/2));for(o=0;o<c.length;o++)c[o]=e.charCodeAt(2*o)<<8|e.charCodeAt(2*o+1);var l=Math.ceil(8*e.length/(Math.log(t.length)/Math.log(2))),d=Array(l);for(i=0;i<l;i++){for(r=Array(),n=0,o=0;o<c.length;o++)n=(n<<16)+c[o],n-=(a=Math.floor(n/s))*s,(r.length>0||a>0)&&(r[r.length]=a);d[i]=n,c=r}var u="";for(o=d.length-1;o>=0;o--)u+=t.charAt(d[o]);return u},e.prototype.str2rstr_utf8=function(e){for(var t,o,i="",a=-1;++a<e.length;)t=e.charCodeAt(a),o=a+1<e.length?e.charCodeAt(a+1):0,55296<=t&&t<=56319&&56320<=o&&o<=57343&&(t=65536+((1023&t)<<10)+(1023&o),a++),t<=127?i+=String.fromCharCode(t):t<=2047?i+=String.fromCharCode(192|t>>>6&31,128|63&t):t<=65535?i+=String.fromCharCode(224|t>>>12&15,128|t>>>6&63,128|63&t):t<=2097151&&(i+=String.fromCharCode(240|t>>>18&7,128|t>>>12&63,128|t>>>6&63,128|63&t));return i},e.prototype.str2rstr_utf16le=function(e){for(var t="",o=0;o<e.length;o++)t+=String.fromCharCode(255&e.charCodeAt(o),e.charCodeAt(o)>>>8&255);return t},e.prototype.str2rstr_utf16be=function(e){for(var t="",o=0;o<e.length;o++)t+=String.fromCharCode(e.charCodeAt(o)>>>8&255,255&e.charCodeAt(o));return t},e.prototype.rstr2binl=function(e){for(var t=Array(e.length>>2),o=0;o<t.length;o++)t[o]=0;for(o=0;o<8*e.length;o+=8)t[o>>5]|=(255&e.charCodeAt(o/8))<<o%32;return t},e.prototype.binl2rstr=function(e){for(var t="",o=0;o<32*e.length;o+=8)t+=String.fromCharCode(e[o>>5]>>>o%32&255);return t},e.prototype.binl_md5=function(e,t){e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;for(var o=1732584193,i=-271733879,a=-1732584194,n=271733878,r=0;r<e.length;r+=16){var s=o,c=i,l=a,d=n;o=this.md5_ff(o,i,a,n,e[r+0],7,-680876936),n=this.md5_ff(n,o,i,a,e[r+1],12,-389564586),a=this.md5_ff(a,n,o,i,e[r+2],17,606105819),i=this.md5_ff(i,a,n,o,e[r+3],22,-1044525330),o=this.md5_ff(o,i,a,n,e[r+4],7,-176418897),n=this.md5_ff(n,o,i,a,e[r+5],12,1200080426),a=this.md5_ff(a,n,o,i,e[r+6],17,-1473231341),i=this.md5_ff(i,a,n,o,e[r+7],22,-45705983),o=this.md5_ff(o,i,a,n,e[r+8],7,1770035416),n=this.md5_ff(n,o,i,a,e[r+9],12,-1958414417),a=this.md5_ff(a,n,o,i,e[r+10],17,-42063),i=this.md5_ff(i,a,n,o,e[r+11],22,-1990404162),o=this.md5_ff(o,i,a,n,e[r+12],7,1804603682),n=this.md5_ff(n,o,i,a,e[r+13],12,-40341101),a=this.md5_ff(a,n,o,i,e[r+14],17,-1502002290),i=this.md5_ff(i,a,n,o,e[r+15],22,1236535329),o=this.md5_gg(o,i,a,n,e[r+1],5,-165796510),n=this.md5_gg(n,o,i,a,e[r+6],9,-1069501632),a=this.md5_gg(a,n,o,i,e[r+11],14,643717713),i=this.md5_gg(i,a,n,o,e[r+0],20,-373897302),o=this.md5_gg(o,i,a,n,e[r+5],5,-701558691),n=this.md5_gg(n,o,i,a,e[r+10],9,38016083),a=this.md5_gg(a,n,o,i,e[r+15],14,-660478335),i=this.md5_gg(i,a,n,o,e[r+4],20,-405537848),o=this.md5_gg(o,i,a,n,e[r+9],5,568446438),n=this.md5_gg(n,o,i,a,e[r+14],9,-1019803690),a=this.md5_gg(a,n,o,i,e[r+3],14,-187363961),i=this.md5_gg(i,a,n,o,e[r+8],20,1163531501),o=this.md5_gg(o,i,a,n,e[r+13],5,-1444681467),n=this.md5_gg(n,o,i,a,e[r+2],9,-51403784),a=this.md5_gg(a,n,o,i,e[r+7],14,1735328473),i=this.md5_gg(i,a,n,o,e[r+12],20,-1926607734),o=this.md5_hh(o,i,a,n,e[r+5],4,-378558),n=this.md5_hh(n,o,i,a,e[r+8],11,-2022574463),a=this.md5_hh(a,n,o,i,e[r+11],16,1839030562),i=this.md5_hh(i,a,n,o,e[r+14],23,-35309556),o=this.md5_hh(o,i,a,n,e[r+1],4,-1530992060),n=this.md5_hh(n,o,i,a,e[r+4],11,1272893353),a=this.md5_hh(a,n,o,i,e[r+7],16,-155497632),i=this.md5_hh(i,a,n,o,e[r+10],23,-1094730640),o=this.md5_hh(o,i,a,n,e[r+13],4,681279174),n=this.md5_hh(n,o,i,a,e[r+0],11,-358537222),a=this.md5_hh(a,n,o,i,e[r+3],16,-722521979),i=this.md5_hh(i,a,n,o,e[r+6],23,76029189),o=this.md5_hh(o,i,a,n,e[r+9],4,-640364487),n=this.md5_hh(n,o,i,a,e[r+12],11,-421815835),a=this.md5_hh(a,n,o,i,e[r+15],16,530742520),i=this.md5_hh(i,a,n,o,e[r+2],23,-995338651),o=this.md5_ii(o,i,a,n,e[r+0],6,-198630844),n=this.md5_ii(n,o,i,a,e[r+7],10,1126891415),a=this.md5_ii(a,n,o,i,e[r+14],15,-1416354905),i=this.md5_ii(i,a,n,o,e[r+5],21,-57434055),o=this.md5_ii(o,i,a,n,e[r+12],6,1700485571),n=this.md5_ii(n,o,i,a,e[r+3],10,-1894986606),a=this.md5_ii(a,n,o,i,e[r+10],15,-1051523),i=this.md5_ii(i,a,n,o,e[r+1],21,-2054922799),o=this.md5_ii(o,i,a,n,e[r+8],6,1873313359),n=this.md5_ii(n,o,i,a,e[r+15],10,-30611744),a=this.md5_ii(a,n,o,i,e[r+6],15,-1560198380),i=this.md5_ii(i,a,n,o,e[r+13],21,1309151649),o=this.md5_ii(o,i,a,n,e[r+4],6,-145523070),n=this.md5_ii(n,o,i,a,e[r+11],10,-1120210379),a=this.md5_ii(a,n,o,i,e[r+2],15,718787259),i=this.md5_ii(i,a,n,o,e[r+9],21,-343485551),o=this.safe_add(o,s),i=this.safe_add(i,c),a=this.safe_add(a,l),n=this.safe_add(n,d)}return[o,i,a,n]},e.prototype.md5_cmn=function(e,t,o,i,a,n){return this.safe_add(this.bit_rol(this.safe_add(this.safe_add(t,e),this.safe_add(i,n)),a),o)},e.prototype.md5_ff=function(e,t,o,i,a,n,r){return this.md5_cmn(t&o|~t&i,e,t,a,n,r)},e.prototype.md5_gg=function(e,t,o,i,a,n,r){return this.md5_cmn(t&i|o&~i,e,t,a,n,r)},e.prototype.md5_hh=function(e,t,o,i,a,n,r){return this.md5_cmn(t^o^i,e,t,a,n,r)},e.prototype.md5_ii=function(e,t,o,i,a,n,r){return this.md5_cmn(o^(t|~i),e,t,a,n,r)},e.prototype.safe_add=function(e,t){var o=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(o>>16)<<16|65535&o},e.prototype.bit_rol=function(e,t){return e<<t|e>>>32-t},e}();o.default=i,cc._RF.pop()},{}],MachinariumBattlePassTableData:[function(e,t,o){"use strict";cc._RF.push(t,"df928+nAntJ44tXrbzgysIW","MachinariumBattlePassTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.MachinariumBattlePassTableData=void 0;var i=e("../TableReader"),a=e("./BaseTableData"),n=function(){function e(){this.id=0,this.coinNum=0,this.itemName="",this.itemIcon="",this.itemScale=0,this.extraItemName="",this.extraItemIcon="",this.extraItemScale=0,this.prize=new Array,this.extraPrize=new Array,this.pointX=0}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.coinNum=e.getNumber(),this.itemName=e.getString(),this.itemIcon=e.getString(),this.itemScale=e.getNumber(),this.extraItemName=e.getString(),this.extraItemIcon=e.getString(),this.extraItemScale=e.getNumber();for(var o=e.getString(),n=new i.TableReader(o);n.getPos()<n.getLen();)(s=new a.ItemInfo).readOriginal(n),this.prize.push(s);o=e.getString();for(var r=new i.TableReader(o);r.getPos()<r.getLen();){var s;(s=new a.ItemInfo).readOriginal(r),this.extraPrize.push(s)}this.pointX=e.getNumber()},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"MachinariumBattlePassTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.MachinariumBattlePassTableData=n,cc._RF.pop()},{"../TableReader":"TableReader","./BaseTableData":"BaseTableData"}],MachinariumCardTableData:[function(e,t,o){"use strict";cc._RF.push(t,"1bd22/PQvJP1rakzpIVb/gH","MachinariumCardTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.MachinariumCardTableData=void 0;var i=e("../TableReader"),a=function(){function e(){this.id=0,this.cardGroup=new Array}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber();for(var o=e.getString(),a=new i.TableReader(o);a.getPos()<a.getLen();){var n;n=a.getNumber(),this.cardGroup.push(n)}},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"MachinariumCardTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.MachinariumCardTableData=a,cc._RF.pop()},{"../TableReader":"TableReader"}],MachinariumRankListTableData:[function(e,t,o){"use strict";cc._RF.push(t,"a4ffdjuF4xFVLPTuJtBPBnS","MachinariumRankListTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.MachinariumRankListTableData=void 0;var i=e("../TableReader"),a=e("./BaseTableData"),n=function(){function e(){this.id=0,this.rankMin=0,this.rankMax=0,this.mailid=0,this.prize=new Array}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.rankMin=e.getNumber(),this.rankMax=e.getNumber(),this.mailid=e.getNumber();for(var o=e.getString(),n=new i.TableReader(o);n.getPos()<n.getLen();){var r=new a.DropItem;r.readOriginal(n),this.prize.push(r)}},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"MachinariumRankListTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.MachinariumRankListTableData=n,cc._RF.pop()},{"../TableReader":"TableReader","./BaseTableData":"BaseTableData"}],MachinariumRewardTableData:[function(e,t,o){"use strict";cc._RF.push(t,"07ed2rG3UdFC48HLvrjdlCI","MachinariumRewardTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.MachinariumRewardTableData=void 0;var i=e("../TableReader"),a=e("./BaseTableData"),n=function(){function e(){this.id=0,this.machinariumAllRound=0,this.prize=new Array,this.heroId=0,this.heroScale=0}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.machinariumAllRound=e.getNumber();for(var o=e.getString(),n=new i.TableReader(o);n.getPos()<n.getLen();){var r=new a.DropItem;r.readOriginal(n),this.prize.push(r)}this.heroId=e.getNumber(),this.heroScale=e.getNumber()},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"MachinariumRewardTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.MachinariumRewardTableData=n,cc._RF.pop()},{"../TableReader":"TableReader","./BaseTableData":"BaseTableData"}],MachinariumRotationTableData:[function(e,t,o){"use strict";cc._RF.push(t,"146d25gK9NCQJgHtX7TRrOn","MachinariumRotationTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.MachinariumRotationTableData=void 0;var i=e("../TableReader"),a=function(){function e(){this.id=0,this.cardIdGroup=new Array}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber();for(var o=e.getString(),a=new i.TableReader(o);a.getPos()<a.getLen();){var n;n=a.getNumber(),this.cardIdGroup.push(n)}},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"MachinariumRotationTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.MachinariumRotationTableData=a,cc._RF.pop()},{"../TableReader":"TableReader"}],MachineryCityBattlePassBuyView:[function(e,t,o){"use strict";cc._RF.push(t,"5cff7DT4XFG/LdYoMid1oHS","MachineryCityBattlePassBuyView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=e("../../StaticData/CostGetTableData"),l=e("../../Global/GameGlobal"),d=e("../../common/NetworkProtocolCommon"),u=e("../../common/PlayerModule"),h=cc._decorator,p=h.ccclass,f=h.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.m_costLab=null,t.m_getLab=null,t}return a(t,e),t.path=function(){return"ui/machineryCityActivity/prefab/MachineryCityBattlePassBuyView"},t.prototype.start=function(){var e=c.CostGetTableData.getById(9),t=l.G.StringManager.m_pDict.COMMON_COSTGET_LAB.split("|")[0],o=l.G.StringManager.formatStr(t,[e.cost[0].itemNum]);this.m_costLab.string=o;var i=l.G.StringManager.m_pDict.COMMON_COSTGET_LAB.split("|")[1],a=l.G.StringManager.formatStr(i,[e.get[0].itemNum]);this.m_getLab.string=a},t.prototype.onClickConfirmCallBack=function(){if(u.default.diamondNum<c.CostGetTableData.getById(9).cost[0].itemNum)return l.G.StringManager.PopWorldString("common_prompt_diamond_insufficient");d.default.callRoleCostGet(9)},n([f(cc.Label)],t.prototype,"m_costLab",void 0),n([f(cc.Label)],t.prototype,"m_getLab",void 0),n([s.Register_Class,p],t)}(r.default);o.default=g,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/CostGetTableData":"CostGetTableData","../../common/NetworkProtocolCommon":"NetworkProtocolCommon","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators"}],MachineryCityBattlePassItem:[function(e,t,o){"use strict";cc._RF.push(t,"95c6d8pp7VNsY5t/MQSIQs6","MachineryCityBattlePassItem");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/manager/LoadResManager"),s=e("../../utils/GameTools"),c=e("../../modules/base/GameView"),l=e("../../Global/GameGlobal"),d=e("../../network/protocol/TypeProtocols"),u=e("../../common/PlayerModule"),h=e("../../utils/ConfigUtils"),p=e("../../network/protocol/ActivityProtocols"),f=e("../../network/ClientNetwork"),g=e("../../view/machineryCityActivity/MachineryCityModel"),m=cc._decorator.ccclass,_=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.show=function(e,t){this.initCoinInfo(e,t),this.initFreeBoxInof(e,t),this.initLuxuryBoxInfo(e,t)},t.prototype.initLuxuryBoxInfo=function(e,t){var o=this,i=this.node.getChildByName("ExtraRewardsNode");i.reawds=e.extraPrize,i.coinNum=e.coinNum,i.id=e.id,r.default.loadSpriteFrame(e.extraItemIcon).then(function(t){cc.isValid(o.node)&&(i.getChildByName("ExtraRewardsIcon").scale=i.getChildByName("ExtraRewardsIcon").scale*e.extraItemScale/100,i.getChildByName("ExtraRewardsIcon").getComponent(cc.Sprite).spriteFrame=t)}).catch(function(e){cc.error(e)}),i.getChildByName("ExtraRewardsName").getComponent(cc.Label).string=e.extraItemName;var a=this.checkLuxuryRewardLockState();i.getChildByName("suo").active=!a,0==a&&s.default.registerTouchEvent(i.getChildByName("suo"),function(){l.G.StringManager.PopString(l.G.StringManager.getString("MACHINERYCITY_BATTLEPASS_SUO"))});var n=0,h=t;1==this.checkBoxReceiveState(e.id,2)?n=2:h>=e.coinNum&&1==a&&(n=1),2==n?(s.default.setNodeBright(i,!1),this.node.getChildByName("waifaguang").active=!1):this.node.getChildByName("waifaguang").active=1==n,i.receiveState=n,s.default.registerTouchEvent(i,function(e){var t=e.target;if(t.reawds)if(t.reawds.length>1)c.default.addPopView("BaseCtrl","BattlePassRewardPreview","BattlePassRewardPreview",{cb:function(){if(1!=u.default.getRoleAttrValByKey(d.ROLE_ATTR_VALUES.ROLE_ATTR_MACHINARIUM_BATTLEPASS))return l.G.StringManager.PopString(l.G.StringManager.getString("MACHINERYCITY_BATTLEPASS_SUO"));var e=new p.T_Activity_MachinariumGetBattlePassRewardData;e.index=t.id,e.type=2;var o=new p.C_Activity_MachinariumGetBattlePassReward;o.getRewardsVec=[e],f.ClientNetwork.getInstance().Send(p.ACTIVITY_CLIENT_ENUM.P_Activity_MachinariumGetBattlePassReward,o)},rewards:t.reawds,rewardState:t.receiveState});else{if(2==t.receiveState)return l.G.StringManager.PopString(l.G.StringManager.getWorldString("common_prompt_receive_over"));if(1==t.receiveState){if(1!=u.default.getRoleAttrValByKey(d.ROLE_ATTR_VALUES.ROLE_ATTR_MACHINARIUM_BATTLEPASS))return l.G.StringManager.PopString(l.G.StringManager.getString("MACHINERYCITY_BATTLEPASS_SUO"));var i=new p.T_Activity_MachinariumGetBattlePassRewardData;i.index=t.id,i.type=2;var a=new p.C_Activity_MachinariumGetBattlePassReward;a.getRewardsVec=[i],f.ClientNetwork.getInstance().Send(p.ACTIVITY_CLIENT_ENUM.P_Activity_MachinariumGetBattlePassReward,a)}else o.checkRewardIsHero(t.reawds[0])&&c.default.addPopView("BaseCtrl","DrawNewHeroCardView","DrawNewHeroCardView",{heroId:t.reawds[0].itemID,bShowNew:!0,bAction:!0})}})},t.prototype.initCoinInfo=function(e){var t=this;this.node.getChildByName("CoinBg").getChildByName("CoinNum").getComponent(cc.Label).string=e.coinNum.toString(),0>=e.coinNum&&r.default.loadSpriteFrame("ui/battle_pass/res/bei1").then(function(e){cc.isValid(t.node)&&(t.node.getChildByName("CoinBg").getComponent(cc.Sprite).spriteFrame=e)})},t.prototype.initFreeBoxInof=function(e,t){var o=this,i=this.node.getChildByName("RewardsNode");i.reawds=e.prize,i.coinNum=e.coinNum,i.id=e.id,r.default.loadSpriteFrame(e.itemIcon).then(function(t){cc.isValid(o.node)&&(i.getChildByName("RewardsIcon").scale=i.getChildByName("RewardsIcon").scale*e.itemScale/100,i.getChildByName("RewardsIcon").getComponent(cc.Sprite).spriteFrame=t)}).catch(function(e){cc.error(e)}),i.getChildByName("RewardsName").getComponent(cc.Label).string=e.itemName;var a=0,n=t;1==this.checkBoxReceiveState(e.id,1)?a=2:n>=e.coinNum&&(a=1),2==a?(s.default.setNodeBright(i,!1),this.node.getChildByName("waifaguangReward").active=!1):this.node.getChildByName("waifaguangReward").active=1==a,i.receiveState=a,s.default.registerTouchEvent(i,function(e){var t=e.target;if(t.reawds.length>1)c.default.addPopView("BaseCtrl","BattlePassRewardPreview","BattlePassRewardPreview",{cb:function(){var e=new p.T_Activity_MachinariumGetBattlePassRewardData;e.index=t.id,e.type=1;var o=new p.C_Activity_MachinariumGetBattlePassReward;o.getRewardsVec=[e],f.ClientNetwork.getInstance().Send(p.ACTIVITY_CLIENT_ENUM.P_Activity_MachinariumGetBattlePassReward,o)},rewards:t.reawds,rewardState:t.receiveState});else{if(2==t.receiveState)return l.G.StringManager.PopString(l.G.StringManager.getWorldString("common_prompt_receive_over"));if(1==t.receiveState){var i=new p.T_Activity_MachinariumGetBattlePassRewardData;i.index=t.id,i.type=1;var a=new p.C_Activity_MachinariumGetBattlePassReward;a.getRewardsVec=[i],f.ClientNetwork.getInstance().Send(p.ACTIVITY_CLIENT_ENUM.P_Activity_MachinariumGetBattlePassReward,a)}else o.checkRewardIsHero(t.reawds[0])&&c.default.addPopView("BaseCtrl","DrawNewHeroCardView","DrawNewHeroCardView",{heroId:t.reawds[0].itemID,bShowNew:!0,bAction:!0})}})},t.prototype.checkLuxuryRewardLockState=function(){var e=!1;return 1==u.default.getRoleAttrValByKey(d.ROLE_ATTR_VALUES.ROLE_ATTR_MACHINARIUM_BATTLEPASS)&&(e=!0),e},t.prototype.checkBoxReceiveState=function(e,t){var o=g.default.Instance.MachinariumBoxData().normalPrize;return 2==t&&(o=g.default.Instance.MachinariumBoxData().superprize),!!o.has(e)&&o.get(e)},t.prototype.checkRewardIsHero=function(e){return!!h.default.getInstance().data["StaticData/HeroTableData"].hasOwnProperty(e.itemID)},n([m],t)}(cc.Component);o.default=_,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../common/PlayerModule":"PlayerModule","../../modules/base/GameView":"GameView","../../modules/manager/LoadResManager":"LoadResManager","../../network/ClientNetwork":"ClientNetwork","../../network/protocol/ActivityProtocols":"ActivityProtocols","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/ConfigUtils":"ConfigUtils","../../utils/GameTools":"GameTools","../../view/machineryCityActivity/MachineryCityModel":"MachineryCityModel"}],MachineryCityBattlePassView:[function(e,t,o){"use strict";cc._RF.push(t,"de970BsEK1DXpgMJdV4id/f","MachineryCityBattlePassView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../StaticData/MachinariumBattlePassTableData"),s=e("../../common/PlayerModule"),c=e("../../modules/base/GameView"),l=e("../../Global/GameGlobal"),d=e("../../common/EventConst"),u=e("../../modules/manager/EventManager"),h=e("../../utils/GameUtils"),p=e("../../network/protocol/TypeProtocols"),f=e("../../network/protocol/RoleProtocols"),g=e("../../network/ClientNetwork"),m=e("../../modules/base/BaseView"),_=e("../../modules/base/Decorators"),y=e("../../StaticData/ActivityTableData"),v=e("../../network/protocol/RechargeProtocols"),C=e("../../network/protocol/ActivityProtocols"),S=e("../../StaticData/RechargeTableData"),T=e("../../utils/GameTools"),I=e("../../view/machineryCityActivity/MachineryCityModel"),N=cc._decorator,b=N.ccclass,w=N.property,E=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.itemPrefab=null,t.ScrollView=null,t.progressBarNode=null,t.curTrophyNode=null,t.curGetWayLab=null,t._scrollViewChildNode=[],t._curSeasonData=[],t._boxItemSpacing=300,t.m_ItemId=1026,t.m_itemNum=0,t.rewardCount=0,t.nSeasonLeftTime=0,t}return a(t,e),t.path=function(){return"ui/machineryCityActivity/prefab/MachineryCityBattlePass"},t.prototype.onLoad=function(){var e=this;this.m_ItemId=Number(h.getConfigIntValue("Machinarium_box_coin_itemId")),g.ClientNetwork.getInstance().listenProtocol(f.ROLE_CLIENT_ENUM.P_Role_Get_Item_Num,function(t){t.resetPos();var o=new f.S_Role_Get_Item_Num;o.read(t)&&0===o.errorcode&&o.itemId==e.m_ItemId&&(e.m_itemNum=o.itemNum,e.initBoxInfo())},this),g.ClientNetwork.getInstance().listenProtocol(C.ACTIVITY_CLIENT_ENUM.P_Activity_MachinariumGetBattlePassReward,function(t){t.resetPos();var o=new C.S_Activity_MachinariumGetBattlePassReward;o.read(t)&&(0==o.errorcode&&o.rewards.length>0&&(e.initBoxInfo(),e.showRewards(o.rewards),u.default.Instance.emit(d.default.RefreshMachineryCityBoxRedpoint)),0!=o.errorcode&&l.G.StringManager.PopString("S_Activity_MachinariumGetBattlePassReward ERROR "+o.errorcode))},this),g.ClientNetwork.getInstance().listenProtocol(v.RECHARGE_CLIENT_ENUM.P_Recharge_Role_Recharge,function(){console.log("P_Recharge_Role_Recharge===================="),e.initBoxInfo(),1==s.default.getRoleAttrValByKey(p.ROLE_ATTR_VALUES.ROLE_ATTR_MACHINARIUM_BATTLEPASS)&&(e.node.getChildByName("BuyButton").active=!1)},this)},t.prototype.start=function(){var e=this,t=new f.C_Role_Get_Item_Num;t.itemId=this.m_ItemId,g.ClientNetwork.getInstance().Send(f.ROLE_CLIENT_ENUM.P_Role_Get_Item_Num,t),r.MachinariumBattlePassTableData.getDataMap().forEach(function(t){e._curSeasonData.push(t)});var o=Number(h.getConfigIntValue("Machinarium_box_rechargeid")),i=S.RechargeTableData.getById(o),a=T.default.getRechargeMoneyByPlatform(i)/100;this.node.getChildByName("BuyButton").getChildByName("label").getComponent(cc.Label).string="\uffe5"+a;var n=this._curSeasonData;this.progressBarNode.width=n[n.length-1].pointX,this.ScrollView.content.width=this.progressBarNode.width+n[0].pointX-this.itemPrefab.width/2+100,1==s.default.getRoleAttrValByKey(p.ROLE_ATTR_VALUES.ROLE_ATTR_MACHINARIUM_BATTLEPASS)&&(this.node.getChildByName("BuyButton").active=!1)},t.prototype.initCurGetWayInfo=function(){this.curGetWayLab.string=s.default.getRoleAttrValByKey(p.ROLE_ATTR_VALUES.ROLE_ATTR_MACHINARIUM_BATTLEPASS_COIN_NUM)+"/"+h.getConfigIntValue("Machinarium_box_coin_day_max")},t.prototype.initBoxProgress=function(){var e=null;this.curTrophyNode.x=5;var t,o=this._curSeasonData,i=0,a=this.m_itemNum;if(o.forEach(function(t,o){a>=t.coinNum&&(e=t,i=o)}),e)if(t=o[i+1]){var n=a-e.coinNum,r=t.coinNum-e.coinNum,s=(t.pointX-e.pointX)*(n/r),c=e.pointX+s;this.curTrophyNode.x=c,isNaN(this.curTrophyNode.x)&&(this.curTrophyNode.x=5),this.progressBarNode.getChildByName("bar").width=c}else this.progressBarNode.getChildByName("bar").width=this.progressBarNode.width,this.curTrophyNode.x=this.progressBarNode.width-5;else(t=o[i])?(n=a,r=t.coinNum,c=s=t.pointX*(n/r),this.curTrophyNode.x=c,isNaN(this.curTrophyNode.x)&&(this.curTrophyNode.x=5),this.progressBarNode.getChildByName("bar").width=c):(this.progressBarNode.getChildByName("bar").width=this.progressBarNode.width,this.curTrophyNode.x=this.progressBarNode.width-5);this.curTrophyNode.getChildByName("CoinLabel").getComponent(cc.Label).string=a.toString()},t.prototype.onRefreshSociatySeasonEndTime=function(){var e=this.node.getChildByName("sociatyEndTimeLab").getComponent(cc.Label),t=y.ActivityTableData.getById(C.ACTIVITY_ID_ENUM.P_Activity_Anniversary),o=s.default.getServersTime(),i=t.param9-o;if(i<=0)return e.node.active=!1,void this.unschedule(this.onRefreshSociatySeasonEndTime);e.string="\u8ddd\u79bb\u6d3b\u52a8\u7ed3\u675f\u8fd8\u6709:"+function(e){var t=e%864e5/36e5,o=e%36e5/6e4,i=e%6e4/1e3;return parseInt((e/864e5).toString())+" \u5929 "+parseInt(t.toString())+" \u5c0f\u65f6 "+parseInt(o.toString())+" \u5206\u949f "+parseInt(i.toString())+" \u79d2 "}.call(this,1e3*i),0==e.node.active&&(e.node.active=!0)},t.prototype.initBoxInfo=function(){var e=this;this._scrollViewChildNode.forEach(function(e){e.destroy()}),this._scrollViewChildNode=[];var t=c.default.getViewByName("BattlePassRewardPreview");t&&t.view&&(t.view.node.active=!1,t.view.closeView());var o=this._curSeasonData,i=o.length,a=0;this.progressBarNode.active=!1,T.default.startFraming(i,function(){if(e.progressBarNode){var t=cc.instantiate(e.itemPrefab);t.parent=e.progressBarNode,t.getComponent("MachineryCityBattlePassItem").show(o[a],e.m_itemNum),t.x=o[a].pointX,t.y=-50,t.active=!0,e._scrollViewChildNode.push(t),e.curTrophyNode.setSiblingIndex(99),++a==i&&(e.onScrollToPoint(),e.progressBarNode.active=!0)}});var n=I.default.Instance.checkBoxIsReceive();this.node.getChildByName("DrawButton").getComponent(cc.Button).interactable=n,this.node.getChildByName("DrawButton").getComponent(cc.Button).enableAutoGrayEffect=!n,this.initBoxProgress(),this.initCurGetWayInfo()},t.prototype.showRewards=function(e){var t=this,o=function(){var e=t.tRewards.slice(6*t.rewardCount,6*(t.rewardCount+1));e.length>0&&c.default.addPopView("BaseCtrl","AcquirePopupView","AcquirePopupView",{items:e,closeCb:function(){t.rewardCount++,o.call(t)}})};this.rewardCount=0,this.tRewards=e,o.call(this)},t.prototype.onTotalGetRewardCallBack=function(){var e=I.default.Instance.checkReceiveSociatyBoxPrize();if(e.length<=0)return l.G.StringManager.PopString(l.G.StringManager.getWorldString("common_prompt_not_rewards"));var t=new C.C_Activity_MachinariumGetBattlePassReward;t.getRewardsVec=e,g.ClientNetwork.getInstance().Send(C.ACTIVITY_CLIENT_ENUM.P_Activity_MachinariumGetBattlePassReward,t)},t.prototype.onBuyBattlePass=function(){var e={rechargeID:Number(h.getConfigIntValue("Machinarium_box_rechargeid")),rechargeNum:1};this.sendEvent("SendProtocolRecharge",e)},t.prototype.onScrollToPoint=function(){for(var e=!1,t=this.m_itemNum,o=0,i=this._curSeasonData.length;o<i;o++){var a=(m=this._curSeasonData[o]).coinNum,n=m.id;if(a){var r=this.m_itemNum,c=0,l=I.default.Instance.checkBoxReceiveState(n,1);0!=l&&l||r>=a&&(c=1);var d=0,u=I.default.Instance.checkBoxReceiveState(n,2);if(0!=u&&u||r>=a&&1==s.default.getRoleAttrValByKey(p.ROLE_ATTR_VALUES.ROLE_ATTR_MACHINARIUM_BATTLEPASS)&&(d=1),1==c||1==d){var h=this.ScrollView.getMaxScrollOffset(),f=m.pointX>h.x?h.x:m.pointX;this.ScrollView.setContentPosition(cc.v2(-f+this.itemPrefab.width-180,0)),e=!0;break}}}if(0==e){var g=null;for(o=0,i=this._curSeasonData.length;o<i;o++){var m;(m=this._curSeasonData[o]).coinNum&&t>=m.coinNum&&(g=m)}g&&(h=this.ScrollView.getMaxScrollOffset(),f=g.pointX>h.x?h.x:g.pointX,this.ScrollView.setContentPosition(cc.v2(-f+this.itemPrefab.width-180,0)))}},t.prototype.onClickAddCallBack=function(){c.default.addPopView("BaseCtrl","MachineryCityBattlePassBuyView","MachineryCityBattlePassBuyView")},t.prototype.onCloseView=function(){this.closeView()},t.prototype.onHelpCallBack=function(){c.default.addPopView("BaseCtrl","MachineryCityBoxIntroduceView","MachineryCityBoxIntroduceView")},t.prototype.update_pass_currency=function(){if(this.node){var e=new f.C_Role_Get_Item_Num;e.itemId=this.m_ItemId,g.ClientNetwork.getInstance().Send(f.ROLE_CLIENT_ENUM.P_Role_Get_Item_Num,e);var t=c.default.getViewByName("MachineryCityBattlePassBuyView");t&&t.view&&t.view.closeView(),u.default.Instance.emit(d.default.RefreshMachineryCityBoxRedpoint)}},t.prototype.onDestroy=function(){u.default.Instance.off(this,d.default.RefreshMachineryCityBoxRedpoint)},n([w(cc.Node)],t.prototype,"itemPrefab",void 0),n([w(cc.ScrollView)],t.prototype,"ScrollView",void 0),n([w(cc.Node)],t.prototype,"progressBarNode",void 0),n([w(cc.Node)],t.prototype,"curTrophyNode",void 0),n([w(cc.Label)],t.prototype,"curGetWayLab",void 0),n([_.Register_Class,b],t)}(m.default);o.default=E,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/ActivityTableData":"ActivityTableData","../../StaticData/MachinariumBattlePassTableData":"MachinariumBattlePassTableData","../../StaticData/RechargeTableData":"RechargeTableData","../../common/EventConst":"EventConst","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/base/GameView":"GameView","../../modules/manager/EventManager":"EventManager","../../network/ClientNetwork":"ClientNetwork","../../network/protocol/ActivityProtocols":"ActivityProtocols","../../network/protocol/RechargeProtocols":"RechargeProtocols","../../network/protocol/RoleProtocols":"RoleProtocols","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils","../../view/machineryCityActivity/MachineryCityModel":"MachineryCityModel"}],MachineryCityBoxIntroduceView:[function(e,t,o){"use strict";cc._RF.push(t,"90940w+g/1KCaezOkFNtvpz","MachineryCityBoxIntroduceView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=cc._decorator,l=c.ccclass,d=(c.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.path=function(){return"ui/machineryCityActivity/prefab/MachineryCityBoxIntroduce"},n([s.Register_Class,l],t)}(r.default));o.default=d,cc._RF.pop()},{"../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators"}],MachineryCityCardGropuView:[function(e,t,o){"use strict";cc._RF.push(t,"4799cgCxQJOgaKU0Uxlygt6","MachineryCityCardGropuView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=e("./MachineryCityModel"),l=e("../../Global/GameGlobal"),d=e("../../StaticData/MachinariumRotationTableData"),u=e("../../StaticData/MachinariumCardTableData"),h=e("../../utils/GameTools"),p=cc._decorator,f=p.ccclass,g=p.property,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.m_CardGroupLayoutA=null,t.m_CardGroupLayoutB=null,t}return a(t,e),t.path=function(){return"ui/machineryCityActivity/prefab/MachineryCityCardGroup"},t.prototype.start=function(){var e=this,t=c.default.Instance.getMachinariumRotationId();if(t<=0)return l.G.StringManager.PopWorldString("\u5361\u7ec4ID\u9519\u8bef\uff01");var o=d.MachinariumRotationTableData.getById(t).cardIdGroup,i=u.MachinariumCardTableData.getById(o[0]).cardGroup;i&&i.length>0&&i.forEach(function(t){h.default.createNormalItems(t,1,e.m_CardGroupLayoutA.node,function(e){e.scale=.6,e.getChildByName("num").active=!1})});var a=u.MachinariumCardTableData.getById(o[1]).cardGroup;a&&a.length>0&&a.forEach(function(t){h.default.createNormalItems(t,1,e.m_CardGroupLayoutB.node,function(e){e.scale=.6,e.getChildByName("num").active=!1})})},n([g(cc.Layout)],t.prototype,"m_CardGroupLayoutA",void 0),n([g(cc.Layout)],t.prototype,"m_CardGroupLayoutB",void 0),n([s.Register_Class,f],t)}(r.default);o.default=m,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/MachinariumCardTableData":"MachinariumCardTableData","../../StaticData/MachinariumRotationTableData":"MachinariumRotationTableData","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../utils/GameTools":"GameTools","./MachineryCityModel":"MachineryCityModel"}],MachineryCityChatItem:[function(e,t,o){"use strict";cc._RF.push(t,"689eeZ7vjlDibnqluxpreS3","MachineryCityChatItem");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../common/PlayerModule"),s=e("../../utils/GameUtils"),c=e("../../utils/ResourcesManager"),l=e("../../utils/GameTools"),d=e("../../modules/base/GameView"),u=e("../../network/protocol/TypeProtocols"),h=e("../../utils/ConfigUtils"),p=e("./MachineryCityModel"),f=e("../../network/protocol/MatchProtocols"),g=e("../../network/ClientNetwork"),m=e("../../Global/GameGlobal"),_=e("../../StaticData/ActivityTableData"),y=e("../../network/protocol/ActivityProtocols"),v=["ui/common_res/quality1","ui/common_res/quality2","ui/common_res/quality3","ui/common_res/quality4"],C=cc._decorator,S=C.ccclass,T=C.property,I=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.m_selfMsgNode=null,t.m_otherMsgNode=null,t}return a(t,e),t.prototype.onRefresh=function(e){var t,o=!1;1==e.roleID.equals(r.default.UUID)&&(o=!0),this.m_selfMsgNode.active=!1,this.m_otherMsgNode.active=!1,(t=1==o?this.m_selfMsgNode:this.m_otherMsgNode).children.forEach(function(e){e.active=!1}),t.active=!0;var i=t.getChildByName("player");i.active=!0,i.roleid=r.default.otherUUidTransformRoieId(e.roleID),s.setRemoteHeadIcon(e.headUrl,e.headID,i.getChildByName("icon").getComponent(cc.Sprite)),e.headFrameID<=0&&(e.headFrameID=200),c.default.loadSprite("ui/headFrame/frame_"+e.headFrameID,i.getChildByName("frame").getComponent(cc.Sprite)),l.default.registerTouchEvent(i,function(e){var t=d.default.getViewNodeByName("MainSceneView");t&&t.getComponent("MainSceneView")&&t.getComponent("MainSceneView").onCallGetRoleSimpleInfo(e.target.roleid)});var a=i.getChildByName("sociatyNameLyout");a.getChildByName("name").getComponent(cc.Label).string=e.nickName;var n=e.sociatyName.length>0?" ["+e.sociatyName+"]":"";switch(a.getChildByName("txt_union_name").getComponent(cc.Label).string=n,a.getChildByName("img_job20").active=!1,a.getChildByName("img_job30").active=!1,e.sociatyJob==u.SOCIATY_JOB.SOCIATY_JOB_OFFICIAL&&(a.getChildByName("img_job20").active=!0),e.sociatyJob==u.SOCIATY_JOB.SOCIATY_JOB_PRESIDENT&&(a.getChildByName("img_job30").active=!0),e.chatType){case u.TYPE_CHAT.TYPE_CHAT_TEXT:this.chatMsgTextInfo(t,e.chatText);break;case u.TYPE_CHAT.TYPE_CHAT_EXPRESSION:this.chatMsgEmojiInfo(t,e.chatText);break;case u.TYPE_CHAT.TYPE_CHAT_ROOMFIGHT:this.chatMsgBattleRoomInfo(t,e),this.node.roomId=e.chatText}e.bReadState||(e.bReadState=0);var h=this.node.getBoundingBoxToWorld().intersects(this.node.parent.parent.parent.getBoundingBoxToWorld());0==e.bReadState&&1==h&&(e.bReadState=1)},t.prototype.chatMsgEmojiInfo=function(e,t){if(e.getChildByName("EmojiNode").active=!0,t.length>0){var o=h.default.getInstance().getItemByID(Number(t));e.getChildByName("EmojiNode").children[0].active=!1;var i=e.getChildByName("EmojiNode").children[1],a=h.default.getInstance().getResConfig(o.spineId).animation;cc.resources.load(a,sp.SkeletonData,function(e,t){e?console.log("load asset url:"+a+" faild!!!"):(i.getComponent(sp.Skeleton).skeletonData=t,i.getComponent(sp.Skeleton).setSkin("default"),i.getComponent(sp.Skeleton).setAnimation(0,"idle",!1))})}e.parent.height=130},t.prototype.chatMsgTextInfo=function(e,t){e.getChildByName("background").active=!0;var o=function(){var t=e.getChildByName("background").getComponent(cc.Layout),o=t.node.getChildByName("label").getComponent(cc.Label);o.node.width>345&&(o.overflow=cc.Label.Overflow.RESIZE_HEIGHT,o.node.width=340,o._forceUpdateRenderData(),t.updateLayout(),t.node.width=o.node.width+45)},i=e.getChildByName("background").getComponent(cc.Layout),a=i.node.getChildByName("label").getComponent(cc.Label);a.node.off(cc.Node.EventType.SIZE_CHANGED,o),a.node.on(cc.Node.EventType.SIZE_CHANGED,o),a.overflow=cc.Label.Overflow.NONE,a.string=t,a._forceUpdateRenderData(),i.updateLayout(),i.node.width=a.node.width+45,e.parent.height=i.node.height+45},t.prototype.chatMsgBattleRoomInfo=function(e,t){if(e.getChildByName("ppveNode").active=!1,e.getChildByName("machineryNode").active=!1,e.getChildByName("pvpNode").active=!1,t.heros.size>0){var o=null;if(t.heros.size>10?(o=e.getChildByName("machineryNode")).getChildByName("btn_join2").roomType=u.FIGHT_TYPE.FIGHT_TYPE_MACHINARIUM:(o=e.getChildByName("ppveNode")).getChildByName("btn_join2").roomType=u.FIGHT_TYPE.FIGHT_TYPE_COOPERATION,o&&(o.active=!0),t.chatParam&&1==t.chatParam?(o.getChildByName("btn_join2").getComponent(cc.Button).interactable=!1,o.getChildByName("btn_join2").getComponent(cc.Button).enableAutoGrayEffect=!0,o.getChildByName("btn_join2").getChildByName("txt_join2").active=!1,o.getChildByName("btn_join2").getChildByName("txt_na2").active=!0):(o.getChildByName("btn_join2").getComponent(cc.Button).interactable=!0,o.getChildByName("btn_join2").getComponent(cc.Button).enableAutoGrayEffect=!1,o.getChildByName("btn_join2").getChildByName("txt_join2").active=!0,o.getChildByName("btn_join2").getChildByName("txt_na2").active=!1),t.heros.size>10&&o.getChildByName("HeroLayout")){o.getChildByName("HeroLayout").active=!0;var i=new Array;t.heros,t.heros.forEach(function(e,t){t>10&&i.push(e.heroID)}),i&&i.length>0&&i.forEach(function(e,t){var i=h.default.getInstance().getItemByID(e);if(i){var a=o.getChildByName("HeroLayout").children[t];a&&(c.default.loadSprite(v[i.quality-1],a.getComponent(cc.Sprite)),c.default.loadSprite(i.icon,a.children[0].getComponent(cc.Sprite)))}})}o.getChildByName("btn_join2").roomId=t.chatText}else{var a=e.getChildByName("pvpNode");a.active=!0,t.chatParam&&1==t.chatParam?(a.getChildByName("btn_join1").getComponent(cc.Button).interactable=!1,a.getChildByName("btn_join1").getComponent(cc.Button).enableAutoGrayEffect=!0,a.getChildByName("btn_join1").getChildByName("txt_join1").active=!1,a.getChildByName("btn_join1").getChildByName("txt_na1").active=!0):(a.getChildByName("btn_join1").getComponent(cc.Button).interactable=!0,a.getChildByName("btn_join1").getComponent(cc.Button).enableAutoGrayEffect=!1,a.getChildByName("btn_join1").getChildByName("txt_join1").active=!0,a.getChildByName("btn_join1").getChildByName("txt_na1").active=!1),a.getChildByName("btn_join1").roomId=t.chatText,a.getChildByName("btn_join1").roomType=u.FIGHT_TYPE.FIGHT_TYPE_DUEL_BATTLE}e.parent.height=145,t.heros.size>10&&(e.parent.height=295)},t.prototype.onClickJoinRoomCallBack=function(e){var t=this,o=function(e){if(e.roomId&&!(e.roomId.length<=0)&&e.roomType){var t=new f.C_Match_Duel_Fight;t.fightType=e.roomType,t.useRoom=0,t.params.push(s.getConfigVersion()),t.roomID=e.roomId,g.ClientNetwork.getInstance().Send(f.MATCH_CLIENT_ENUM.P_Match_Duel_Fight,t)}},i=e.target;if(i.roomType&&i.roomType==u.FIGHT_TYPE.FIGHT_TYPE_COOPERATION){var a=Number(s.getConfigIntValue("coop_score_limit"));if(r.default.getRoleAttrValByKey(u.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE)<a)return m.G.StringManager.PopWorldString(m.G.StringManager.getWorldString("coop_score_limit_tip",a));r.default.getRoleInfoData().cooperationDayLeftNum<=0?d.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:m.G.StringManager.getString("COOP_BATTLE_OVER_TIPS"),confirmCb:function(){o.call(t,i)}}):o.call(this,i)}else if(i.roomType&&i.roomType==u.FIGHT_TYPE.FIGHT_TYPE_MACHINARIUM){if(1==p.default.Instance.getMachineryCityState()){var n=_.ActivityTableData.getById(y.ACTIVITY_ID_ENUM.P_Activity_Machinarium);if(p.default.Instance.getTodayFightFailCount()>=n.param3)return d.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:m.G.StringManager.getString("MACHINERYCITY_TIP6"),confirmCb:function(){o.call(t,i)}});o.call(this,i)}}else i.roomType&&i.roomType==u.FIGHT_TYPE.FIGHT_TYPE_DUEL_BATTLE&&o.call(this,i)},n([T(cc.Node)],t.prototype,"m_selfMsgNode",void 0),n([T(cc.Node)],t.prototype,"m_otherMsgNode",void 0),n([S],t)}(cc.Component);o.default=I,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/ActivityTableData":"ActivityTableData","../../common/PlayerModule":"PlayerModule","../../modules/base/GameView":"GameView","../../network/ClientNetwork":"ClientNetwork","../../network/protocol/ActivityProtocols":"ActivityProtocols","../../network/protocol/MatchProtocols":"MatchProtocols","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/ConfigUtils":"ConfigUtils","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils","../../utils/ResourcesManager":"ResourcesManager","./MachineryCityModel":"MachineryCityModel"}],MachineryCityChatView:[function(e,t,o){"use strict";cc._RF.push(t,"46b0170JgxNk6IoUvC9Ncvj","MachineryCityChatView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/manager/EventManager"),s=e("../../modules/cores/UISuperLayout"),c=e("../../common/PlayerModule"),l=e("../../network/protocol/TypeProtocols"),d=e("../../network/ClientNetwork"),u=e("../../network/protocol/ChatProtocols"),h=e("../../network/protocol/ChatProtocols"),p=e("../../Global/GameGlobal"),f=e("../../modules/base/GameView"),g=e("../../utils/ConfigUtils"),m=e("../../utils/ResourcesManager"),_=e("../sociaty/SociatyCtrl"),y=e("./MachineryCityModel"),v=e("../../utils/GamePlatform"),C=e("../../utils/QQGameHallUtils"),S=e("../../utils/KSMinigameUtils"),T=e("../../utils/GameUtils"),I=cc._decorator,N=I.ccclass,b=I.property,w=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.scrollViewNode=null,t.unreadNode=null,t.m_EmojiLayoutNode=null,t.m_ChatSendBtnNode=null,t.m_ChatEditBox=null,t.nChatCd=0,t.tMsgDatas=new Array,t.nUnreadMsgCount=0,t}return a(t,e),t.prototype.onLoad=function(){var e=this,t=this.tMsgDatas;d.ClientNetwork.getInstance().listenProtocol(u.CHAT_CLIENT_ENUM.P_Chat_CloseFightRoom,function(o){o.resetPos();var i=new h.S_Chat_CloseFightRoom;if(i.read(o)){for(var a=!1,n=0;n<t.length;n++)if(t[n].channel==l.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_SOCIATY&&t[n].chatType==l.TYPE_CHAT.TYPE_CHAT_ROOMFIGHT&&t[n].chatText==i.roomID&&1!=t[n].chatParam){t[n].chatParam=1,a=!0;break}1==a&&e.scrollViewNode.children.forEach(function(t){t.roomId&&t.roomId==i.roomID&&e.scrollViewNode.notifyRefreshItem(t)})}},this),this.schedule(function(){e.nUnreadMsgCount=0,e.tMsgDatas.forEach(function(t){t.bReadState&&0!=t.bReadState||e.nUnreadMsgCount++}),e.nUnreadMsgCount>99&&(e.nUnreadMsgCount=99),e.node.getChildByName("unread").active=e.nUnreadMsgCount>1,e.nUnreadMsgCount>=99?e.node.getChildByName("unread").children[0].getComponent(cc.Label).string=p.G.StringManager.getWorldString("chat_unread_max"):e.node.getChildByName("unread").children[0].getComponent(cc.Label).string=p.G.StringManager.getWorldString("chat_unread",e.nUnreadMsgCount)},.2),this.schedule(function(){e.onMachineryCityChatCountdownSendTime()},1),this.initMachineryCityChatEmoji()},t.prototype.onEnable=function(){if(this.scrollViewNode.total(this.tMsgDatas.length),this.onClickMachineryCityUnreadCallBack(),!(y.default.Instance.MachineryCityChatDisableTime<=0)){var e=c.default.getServersTime()-y.default.Instance.MachineryCityChatDisableTime;this.nChatCd=y.default.Instance.getMachineryCityChatSurplusTime(),this.nChatCd>0&&(this.nChatCd-=e,this.nChatCd<=0&&(this.m_ChatSendBtnNode.getChildByName("button").active=!0,this.m_ChatSendBtnNode.getChildByName("cd").active=!1)),this.onMachineryCityChatCountdownSendTime()}},t.prototype.onDisable=function(){y.default.Instance.MachineryCityChatDisableTime=c.default.getServersTime(),y.default.Instance.setMachineryCityChatSurplusTime(this.nChatCd)},t.prototype.addMachineryCityChatMsg=function(e){var t=this;1!=this.checkMachineryCityRoomInChannel(e)&&(this.tMsgDatas.push(e),0!=this.node.active&&(this.scrollViewNode.total(this.tMsgDatas.length),1!=c.default.UUID.equals(e.roleID)&&1!=this.scrollViewNode.scrollView.isScrollBounceBottom||(e.bReadState=1,setTimeout(function(){try{t.scrollViewNode.scrollToFooter(.1)}catch(e){}},50))))},t.prototype.onClickMachineryCityUnreadCallBack=function(){var e=this;this.tMsgDatas.forEach(function(e){e.bReadState=1}),this.scrollViewNode.scrollView.isScrollBounceBottom=!0,setTimeout(function(){try{e.scrollViewNode.scrollToFooter(.1)}catch(t){}},50)},t.prototype.checkMachineryCityRoomInChannel=function(e){for(var t=0;t<this.tMsgDatas.length;t++)if(this.tMsgDatas[t].chatText==e.chatText&&this.tMsgDatas[t].chatType==l.TYPE_CHAT.TYPE_CHAT_ROOMFIGHT)return!0;return!1},t.prototype.onListRender=function(e,t){e.getComponent("MachineryCityChatItem").onRefresh(this.tMsgDatas[t])},t.prototype.onClickMachineryCityCloseView=function(){var e=f.default.getViewNodeByName("MachineryCityMainView");e&&e.getComponent("MachineryCityMainView")&&e.getComponent("MachineryCityMainView").setMachineryCityChatViewActiveState(!1)},t.prototype.initMachineryCityChatEmoji=function(){var e=this,t=[],o=g.default.getInstance().data["StaticData/ItemTableData"];for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&6===o[i].type&&t.push(o[i]);for(var a=this.node.getChildByName("EmojiNode").getChildByName("EmojiLayout"),n=0;n<a.children.length;n++){var r=a.children[n];r.emojiId=t[n].id,m.default.loadSprite(t[n].icon,r.getComponent(cc.Sprite)),r.on(cc.Node.EventType.TOUCH_END,function(t){if(e.nChatCd>0)return p.G.StringManager.PopWorldString("chat_cd");_.default.request_C_Sociaty_Chat_Client({chatType:l.TYPE_CHAT.TYPE_CHAT_EXPRESSION,msg:t.target.emojiId.toString()}),e.m_EmojiLayoutNode.parent.active=!1,e.nChatCd=Number(T.getConfigIntValue("cd_union_chat")),e.m_ChatSendBtnNode.getChildByName("button").active=!1})}},t.prototype.onClickMachineryCityChatEmojiCallBack=function(){0==this.m_EmojiLayoutNode.parent.active?this.m_EmojiLayoutNode.parent.active=!0:this.m_EmojiLayoutNode.parent.active=!1},t.prototype.onClickMachineryCityChatSendCallBack=function(){var e=this;return this.nChatCd>0?p.G.StringManager.PopWorldString("chat_cd"):this.m_ChatEditBox.string.length<=0?p.G.StringManager.PopWorldString("chat_client_code1"):(v.GamePlatform.isQQGameRoom()?C.QQGameHallUtils.Instance.chatFilterAsync(this.m_ChatEditBox.string,C.QQGameHallUtils.CHAT_FILTER_SCENETYPE_MSG).then(function(t){_.default.request_C_Sociaty_Chat_Client({chatType:l.TYPE_CHAT.TYPE_CHAT_TEXT,msg:""==t?e.m_ChatEditBox.string:t})}):v.GamePlatform.isKuaishouMiniGame()?S.KSMinigameUtils.Instance.chatFilterAsync(this.m_ChatEditBox.string,S.KSMinigameUtils.CHAT_FILTER_SCENETYPE_MSG).then(function(t){1!=t?_.default.request_C_Sociaty_Chat_Client({chatType:l.TYPE_CHAT.TYPE_CHAT_TEXT,msg:e.m_ChatEditBox.string}):p.G.StringManager.PopStringOnce("\u5185\u5bb9\u542b\u6709\u8fdd\u89c4\u5185\u5bb9")}):_.default.request_C_Sociaty_Chat_Client({chatType:l.TYPE_CHAT.TYPE_CHAT_TEXT,msg:this.m_ChatEditBox.string}),this.m_ChatEditBox.string="",this.m_ChatSendBtnNode.getChildByName("button").active=!1,void(this.nChatCd=Number(T.getConfigIntValue("cd_union_chat"))))},t.prototype.onMachineryCityChatCountdownSendTime=function(){this.nChatCd>0&&(this.nChatCd--,this.nChatCd<10?this.m_ChatSendBtnNode.getChildByName("cd").getComponent(cc.Label).string="0"+this.nChatCd+"s":this.m_ChatSendBtnNode.getChildByName("cd").getComponent(cc.Label).string=this.nChatCd+"s",this.m_ChatSendBtnNode.getChildByName("cd").active=!0,this.nChatCd<=0&&(this.m_ChatSendBtnNode.getChildByName("button").active=!0,this.m_ChatSendBtnNode.getChildByName("cd").active=!1))},t.prototype.onDestroy=function(){this.unscheduleAllCallbacks(),d.ClientNetwork.getInstance().removeMessageTarget(this),r.default.Instance.off(this)},n([b(s.default)],t.prototype,"scrollViewNode",void 0),n([b(cc.Node)],t.prototype,"unreadNode",void 0),n([b(cc.Node)],t.prototype,"m_EmojiLayoutNode",void 0),n([b(cc.Node)],t.prototype,"m_ChatSendBtnNode",void 0),n([b(cc.EditBox)],t.prototype,"m_ChatEditBox",void 0),n([N],t)}(cc.Component);o.default=w,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../common/PlayerModule":"PlayerModule","../../modules/base/GameView":"GameView","../../modules/cores/UISuperLayout":"UISuperLayout","../../modules/manager/EventManager":"EventManager","../../network/ClientNetwork":"ClientNetwork","../../network/protocol/ChatProtocols":"ChatProtocols","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/ConfigUtils":"ConfigUtils","../../utils/GamePlatform":"GamePlatform","../../utils/GameUtils":"GameUtils","../../utils/KSMinigameUtils":"KSMinigameUtils","../../utils/QQGameHallUtils":"QQGameHallUtils","../../utils/ResourcesManager":"ResourcesManager","../sociaty/SociatyCtrl":"SociatyCtrl","./MachineryCityModel":"MachineryCityModel"}],MachineryCityCtrl:[function(e,t,o){"use strict";cc._RF.push(t,"9db42Icw7RDIqRHoFX49B2t","MachineryCityCtrl");var i=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var a=e("../../network/ClientNetwork"),n=e("../../network/protocol/ActivityProtocols"),r=e("../../Global/GameGlobal"),s=e("./MachineryCityModel"),c=e("../../common/EventConst"),l=e("../../modules/manager/EventManager"),d=e("../../network/protocol/SociatyProtocols"),u=e("../sociaty/SociatyModel"),h=e("../../modules/base/GameView"),p=cc._decorator.ccclass,f=function(){function e(){}return e.registerMachinariumProtocol=function(){a.ClientNetwork.getInstance().listenProtocol(n.ACTIVITY_CLIENT_ENUM.P_Activity_SyncMachinariumData,this.syncMachineryCityActivityData,this),a.ClientNetwork.getInstance().listenProtocol(d.SOCIATY_CLIENT_ENUM.P_Sociaty_SyncMachinariumData,this.syncMachinariumData,this),a.ClientNetwork.getInstance().listenProtocol(d.SOCIATY_CLIENT_ENUM.P_Sociaty_RoleGetMachinariumReward,this.syncSociatyRoleGetMachinariumReward,this),a.ClientNetwork.getInstance().listenProtocol(d.SOCIATY_CLIENT_ENUM.P_Sociaty_RoleMachinariumSelectCard,this.syncSociatyRoleMachinariumSelectCard,this)},e.syncMachineryCityActivityData=function(e){e.resetPos();var t=new n.S_Activity_SyncMachinariumData;t.read(e)&&(0==t.error?(t.refleshId!=s.default.Instance.getMachinariumRotationId()&&(s.default.Instance.setICSociatyRoleGetMachinariumState(!0),this.callSociatyRoleGetMachinariumData()),s.default.Instance.setMachinariumActivity(t),s.default.Instance.setMachinariumActivityIsOpen(t.isOpen)):r.G.StringManager.PopString("\u540c\u6b65\u673a\u68b0\u4e4b\u57ce\u6570\u636e\u9519\u8bef Error "+t.error))},e.syncMachinariumData=function(e){e.resetPos();var t=new d.S_Sociaty_SyncMachinariumData;if(t.read(e)){var o=u.default.instance().SociatyPlayerData;o&&o.sociatyID&&Number(o.sociatyID)==t.sociatyId&&(s.default.Instance.syncSyncMachinariumData(t),l.default.Instance.emit(c.default.SociatySyncMachinariumDataEvent),l.default.Instance.emit(c.default.SyncRefreshMachineryCityEvent),l.default.Instance.emit(c.default.RefreshMachineryCityRoundRewardRedpoint),s.default.Instance.setICSociatyRoleGetMachinariumState(!1))}},e.syncSociatyRoleGetMachinariumReward=function(e){e.resetPos();var t=new d.S_Sociaty_RoleGetMachinariumReward;t.read(e)&&(0==t.errorcode&&t.prize.length>0?(h.default.addPopView("BaseCtrl","AcquirePopupView","AcquirePopupView",{items:t.prize}),l.default.Instance.emit(c.default.RefreshMachineryCityRoundRewardListEvent)):-4==t.errorcode?r.G.StringManager.PopString("\u8fdb\u5165\u8054\u76df\u6b21\u65e5\u624d\u53ef\u9886\u53d6"):r.G.StringManager.PopString("\u9886\u53d6\u5956\u52b1\u9519\u8bef Error "+t.errorcode))},e.syncSociatyRoleMachinariumSelectCard=function(e){e.resetPos();var t=new d.S_Sociaty_RoleMachinariumSelectCard;t.read(e)&&(0==t.errorcode||r.G.StringManager.PopString("\u66f4\u6362\u5361\u7ec4\u9519\u8bef Error "+t.errorcode))},e.callSociatyRoleGetMachinariumData=function(){var e=new d.C_Sociaty_RoleGetMachinariumData;a.ClientNetwork.getInstance().Send(d.SOCIATY_CLIENT_ENUM.P_Sociaty_RoleGetMachinariumData,e)},e.callSociatyRoleGetMachinariumReward=function(e){var t=new d.C_Sociaty_RoleGetMachinariumReward;t.round=e,a.ClientNetwork.getInstance().Send(d.SOCIATY_CLIENT_ENUM.P_Sociaty_RoleGetMachinariumReward,t)},e.callSociatyRoleMachinariumSelectCard=function(){var e=new d.C_Sociaty_RoleMachinariumSelectCard;e.cardId=0,a.ClientNetwork.getInstance().Send(d.SOCIATY_CLIENT_ENUM.P_Sociaty_RoleMachinariumSelectCard,e)},i([p],e)}();o.default=f,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../common/EventConst":"EventConst","../../modules/base/GameView":"GameView","../../modules/manager/EventManager":"EventManager","../../network/ClientNetwork":"ClientNetwork","../../network/protocol/ActivityProtocols":"ActivityProtocols","../../network/protocol/SociatyProtocols":"SociatyProtocols","../sociaty/SociatyModel":"SociatyModel","./MachineryCityModel":"MachineryCityModel"}],MachineryCityHelpView:[function(e,t,o){"use strict";cc._RF.push(t,"56d23Ol+udKn6efj8gKv8AT","MachineryCityHelpView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=cc._decorator,l=c.ccclass,d=(c.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.path=function(){return"ui/machineryCityActivity/prefab/MachineryCityHelp"},n([s.Register_Class,l],t)}(r.default));o.default=d,cc._RF.pop()},{"../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators"}],MachineryCityMainView:[function(e,t,o){"use strict";cc._RF.push(t,"040febJewBKt6a5ECskClnq","MachineryCityMainView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=e("../../StaticData/ActivityTableData"),l=e("../../network/protocol/ActivityProtocols"),d=e("../../network/protocol/TypeProtocols"),u=e("../../common/PlayerModule"),h=e("./MachineryCityModel"),p=e("../../Global/GameGlobal"),f=e("../../modules/base/GameView"),g=e("../../utils/GameTools"),m=e("../../modules/manager/EventManager"),_=e("../../common/EventConst"),y=e("../../utils/GameUtils"),v=e("../../StaticData/MachinariumRotationTableData"),C=e("../../common/CommandValue"),S=e("./MachineryCityCtrl"),T=e("../../utils/ResourcesManager"),I=cc._decorator,N=I.ccclass,b=I.property,w=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.m_ChatTextMsgNode=null,t.m_TodayFightCardsLayout=null,t.m_MatchNode=null,t.m_AssistBattleNode=null,t.m_SurplusActivityTimeLab=null,t.m_BoxRedpointNode=null,t.m_CardGroupImageNodeArr=[],t.m_RoundRewardRedpointNode=null,t.m_bInitChatNode=!1,t.m_changeCardGroupTime=0,t}return a(t,e),t.path=function(){return"ui/machineryCityActivity/prefab/MachineryCityMain"},t.prototype.onLoad=function(){var e=this;m.default.Instance.on(_.default.SyncRefreshMachineryCityEvent,this.initTodayFightCardInfo,this),m.default.Instance.on(_.default.RefreshMachineryCityBoxRedpoint,this.showBoxRedPoint,this),m.default.Instance.on(_.default.RefreshMachineryCityRoundRewardRedpoint,function(){e.m_RoundRewardRedpointNode.active=h.default.Instance.checkMachinariumRoundRewards()},this),this.hideMainChatView()},t.prototype.start=function(){this.setChatViewVisible(!0),this.initTodayFightCardInfo(),this.showBoxRedPoint(),this.onRefreshMachineryCityEndTime(),this.schedule(this.onRefreshMachineryCityEndTime,1),m.default.Instance.emit(_.default.RefreshMachineryCityRoundRewardRedpoint),y.setLocalData("SaveMachinariumCityRedFlag","1")},t.prototype.hideMainChatView=function(){m.default.Instance.emit(_.default.SyncChatViewChange,C.ChatViewVisible.Retracting)},t.prototype.setChatViewVisible=function(e){1==e?this.initChatView():this.destroyChatView()},t.prototype.initChatView=function(){var e=f.default.getViewNodeByName("MainSceneView");if(e&&e.getComponent("MainSceneView")){e.getComponent("MainSceneView").onSetChatBtnNodeActive(!1);var t=e.getComponent("MainSceneView").getMainChatNode();if(cc.isValid(t)){t.parent=this.node;var o=t.getChildByName("chatMain").getComponent("ChatMainView");o.setShowChannelTab([d.CHAT_CHANNEL_GROUP_TYPE.CHAT_CHANNEL_ACTICITY_GROUP,d.CHAT_CHANNEL_GROUP_TYPE.CHAT_CHANNEL_PRIVATE_GROUP,d.CHAT_CHANNEL_GROUP_TYPE.CHAT_CHANNEL_SOCIATY_GROUP]),o.setChatChannel(d.CHAT_CHANNEL_GROUP_TYPE.CHAT_CHANNEL_ACTICITY_GROUP),this.m_bInitChatNode=!0}}this.m_ChatTextMsgNode.active=!0},t.prototype.destroyChatView=function(){this.m_ChatTextMsgNode.active=!1},t.prototype.onClickChatBtnCallBack=function(){0!=this.m_bInitChatNode&&m.default.Instance.emit(_.default.SyncChatViewChange,[C.ChatViewVisible.Popup,d.CHAT_CHANNEL_GROUP_TYPE.CHAT_CHANNEL_ACTICITY_GROUP])},t.prototype.onSetChatMsg=function(e){if(e.length<=0)return this.m_ChatTextMsgNode.getChildByName("msgNode").active=!1;var t=this.m_ChatTextMsgNode.getChildByName("msgNode"),o=t.getChildByName("label_chat"),i=t.getChildByName("label_chatDotLab");o.getComponent(cc.Label).string=e,i.active=!1,e.length>9&&(i.active=!0),t.active=!0},t.prototype.onSetChatRedpoint=function(e){this.m_ChatTextMsgNode.getChildByName("msgNode").parent.children[1].children[0].active=e},t.prototype.showBoxRedPoint=function(){var e;e=h.default.Instance.checkBoxRedPoint(),this.m_BoxRedpointNode.active=e},t.prototype.activityIsEnd=function(){var e=u.default.getServersTime();return c.ActivityTableData.getById(l.ACTIVITY_ID_ENUM.P_Activity_Machinarium).param9-e>0},t.prototype.onRefreshMachineryCityEndTime=function(){var e=this.m_SurplusActivityTimeLab,t=u.default.getServersTime(),o=c.ActivityTableData.getById(l.ACTIVITY_ID_ENUM.P_Activity_Machinarium).param9-t;if(o<=0)return this.unschedule(this.onRefreshMachineryCityEndTime),e.string="\u6d3b\u52a8\u5df2\u7ed3\u675f";e.string=p.G.StringManager.getString("ROYALE_ACTIVITY_END_TIME_TIP")+function(e){var t=e%864e5/36e5,i=e%36e5/6e4,a=e%6e4/1e3;return o>=86400?parseInt((e/864e5).toString())+" \u5929 "+parseInt(t.toString())+" \u5c0f\u65f6 "+parseInt(i.toString())+" \u5206 ":o>=3600?parseInt(t.toString())+" \u5c0f\u65f6 "+parseInt(i.toString())+" \u5206 "+parseInt(a.toString())+" \u79d2 ":o>=60?parseInt(i.toString())+" \u5206 "+parseInt(a.toString())+" \u79d2 ":parseInt(a.toString())+" \u79d2 "}.call(this,1e3*o)},t.prototype.initTodayFightCardInfo=function(){var e=this;this.m_TodayFightCardsLayout.node.childrenCount>0&&this.m_TodayFightCardsLayout.node.destroyAllChildren();var t=h.default.Instance.getTodayFightCards();t&&t.length>0&&t.forEach(function(t){g.default.createNormalItems(t,1,e.m_TodayFightCardsLayout.node,function(e){e.scale=.65,e.getChildByName("num").active=!1})});var o=c.ActivityTableData.getById(l.ACTIVITY_ID_ENUM.P_Activity_Machinarium),i=h.default.Instance.getTodayFightFailCount();if(i<o.param3){this.m_MatchNode.active=!0,this.m_AssistBattleNode.active=!1;var a=f.default.getViewNodeByName("AssistBattleView");a&&a.getComponent("AssistBattleView").closeView()}else if(i>=o.param3&&(this.m_MatchNode.active=!1,this.m_AssistBattleNode.active=!0,o.param7>0)){var n=o.param7+o.param3-i;n=n<0?0:n,this.m_AssistBattleNode.children[0].getComponent(cc.Label).string="("+n+"/"+o.param7+")",T.default.loadSprite("ui/machineryCityActivity/image/tanxianzhuzhan1",this.m_AssistBattleNode.getComponent(cc.Sprite))}this.m_CardGroupImageNodeArr[0].active=!1,this.m_CardGroupImageNodeArr[1].active=!1;var r=h.default.Instance.getMachinariumRotationId();if(r>0){var s=v.MachinariumRotationTableData.getById(r).cardIdGroup,d=h.default.Instance.getTodayFightCardsId();d>0&&(s[0]==d?this.m_CardGroupImageNodeArr[0].active=!0:s[1]==d&&(this.m_CardGroupImageNodeArr[1].active=!0))}else p.G.StringManager.PopWorldString("\u5361\u7ec4ID\u9519\u8bef\uff01")},t.prototype.onClickMachineryMatch=function(){1==h.default.Instance.getMachineryCityState()&&f.default.addPopView("BaseCtrl","BattleRoomMainView","BattleRoomMainView",{CombatType:4})},t.prototype.onClickMachineryCityAssistFight=function(){if(1==h.default.Instance.getMachineryCityState()){var e=p.G.StringManager.getString("MACHINERYCITY_TIP3");f.default.addPopView("BaseCtrl","AssistBattleView","AssistBattleView",{fightType:d.FIGHT_TYPE.FIGHT_TYPE_MACHINARIUM,title:e.split("|")[0],tips:e.split("|")[1]})}},t.prototype.onClickChangeCardGroupCallBack=function(){var e=(new Date).getTime();if(e-this.m_changeCardGroupTime<1200)return p.G.StringManager.PopWorldString("sociaty_auction_tip11");this.m_changeCardGroupTime=e,S.default.callSociatyRoleMachinariumSelectCard()},t.prototype.onClickMachineryCityShopCallBack=function(){1==h.default.Instance.getMachineryCityIsOpen()&&1==this.activityIsEnd()?f.default.addPopView("BaseCtrl","MachineryCityShopView","MachineryCityShopView"):p.G.StringManager.PopString(p.G.StringManager.getString("MACHINERYCITY_TIP1"))},t.prototype.onClickMachineryCityRankCallBack=function(){1==h.default.Instance.getMachineryCityIsOpen()&&1==this.activityIsEnd()?f.default.addPopView("BaseCtrl","MachineryCityRankView","MachineryCityRankView"):p.G.StringManager.PopString(p.G.StringManager.getString("MACHINERYCITY_TIP1"))},t.prototype.onClickMachineryCityBoxCallBack=function(){1==h.default.Instance.getMachineryCityIsOpen()&&1==this.activityIsEnd()?f.default.addPopView("ShopMainCtrl","MachineryCityBattlePassView","MachineryCityBattlePassView"):p.G.StringManager.PopString(p.G.StringManager.getString("MACHINERYCITY_TIP1"))},t.prototype.onClickMachineryCityRechargeCallBack=function(){1==h.default.Instance.getMachineryCityIsOpen()&&1==this.activityIsEnd()?f.default.addPopView("ShopMainCtrl","MachineryCityRechargeView","MachineryCityRechargeView"):p.G.StringManager.PopString(p.G.StringManager.getString("MACHINERYCITY_TIP1"))},t.prototype.onClickMachineryCitHelpCallBack=function(){f.default.addPopView("BaseCtrl","MachineryCityHelpView","MachineryCityHelpView")},t.prototype.onClickCloseCallBack=function(){this.destroyChatView(),this.hideMainChatView(),this.closeView()},t.prototype.update=function(){0==this.m_bInitChatNode&&this.initChatView()},t.prototype.onDestroy=function(){m.default.Instance.off(this),m.default.Instance.off(this,_.default.RefreshMachineryCityBoxRedpoint),m.default.Instance.emit(_.default.RefreshMachineryCityMainRedPoint)},n([b(cc.Node)],t.prototype,"m_ChatTextMsgNode",void 0),n([b(cc.Layout)],t.prototype,"m_TodayFightCardsLayout",void 0),n([b(cc.Node)],t.prototype,"m_MatchNode",void 0),n([b(cc.Node)],t.prototype,"m_AssistBattleNode",void 0),n([b(cc.Label)],t.prototype,"m_SurplusActivityTimeLab",void 0),n([b(cc.Node)],t.prototype,"m_BoxRedpointNode",void 0),n([b(cc.Node)],t.prototype,"m_CardGroupImageNodeArr",void 0),n([b(cc.Node)],t.prototype,"m_RoundRewardRedpointNode",void 0),n([s.Register_Class,N],t)}(r.default);o.default=w,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/ActivityTableData":"ActivityTableData","../../StaticData/MachinariumRotationTableData":"MachinariumRotationTableData","../../common/CommandValue":"CommandValue","../../common/EventConst":"EventConst","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/base/GameView":"GameView","../../modules/manager/EventManager":"EventManager","../../network/protocol/ActivityProtocols":"ActivityProtocols","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils","../../utils/ResourcesManager":"ResourcesManager","./MachineryCityCtrl":"MachineryCityCtrl","./MachineryCityModel":"MachineryCityModel"}],MachineryCityModel:[function(e,t,o){"use strict";cc._RF.push(t,"7363d3tDVRGjKqcUG4V0Ogi","MachineryCityModel");var i=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var a=e("../../StaticData/MachinariumBattlePassTableData"),n=e("../../common/PlayerModule"),r=e("../../common/CommandValue"),s=e("../../StaticData/ActivityTableData"),c=e("../../network/protocol/ActivityProtocols"),l=e("../../network/protocol/TypeProtocols"),d=e("../../Global/GameGlobal"),u=e("../../utils/GameUtils"),h=e("../../network/protocol/ActivityProtocols"),p=e("../../common/PlayerModule"),f=e("../../utils/GameUtils"),g=e("../../StaticData/MachinariumCardTableData"),m=e("../../StaticData/MachinariumRewardTableData"),_=cc._decorator.ccclass,y=function(){function e(){this.nMachineryCityChatDisableTime=0,this.nMachineryCityChatTime=0,this.tMachinariumData=null,this.bMachinariumActivityIsOpen=!1,this.tActivityMachinariumData=null,this.bInitiativeCallSociatyRoleGetMachinarium=!1}var t;return t=e,Object.defineProperty(e,"Instance",{get:function(){return null==t._instance&&(t._instance=new t),t._instance},enumerable:!1,configurable:!0}),e.prototype.setMachinariumActivity=function(e){this.tActivityMachinariumData=e},e.prototype.MachinariumBoxData=function(){return this.tActivityMachinariumData},e.prototype.syncSyncMachinariumData=function(e){this.tMachinariumData=e},e.prototype.setMachinariumActivityIsOpen=function(e){this.bMachinariumActivityIsOpen=e},e.prototype.getMachineryCityIsOpen=function(){return 1==this.bMachinariumActivityIsOpen&&1==n.default.checkModulerOnOffState(r.ModulerViewOnOff.MachineryCityActivity)},e.prototype.getMachineryCityTotalRound=function(){return this.tMachinariumData?this.tMachinariumData.allRound:0},e.prototype.getMachineryRoundRewardStatusMap=function(){return this.tMachinariumData?this.tMachinariumData.rewardStatus:null},Object.defineProperty(e.prototype,"MachineryCityChatDisableTime",{get:function(){return this.nMachineryCityChatDisableTime},set:function(e){this.nMachineryCityChatDisableTime=e},enumerable:!1,configurable:!0}),e.prototype.setMachineryCityChatSurplusTime=function(e){this.nMachineryCityChatTime=e},e.prototype.getMachineryCityChatSurplusTime=function(){return this.nMachineryCityChatTime},e.prototype.getTodayFightCards=function(){return this.tMachinariumData?this.tMachinariumData.cardId<=0?d.G.StringManager.PopString("\u4eca\u65e5\u5361\u7ec4\u6570\u636e\u9519\u8bef "+this.tMachinariumData.cardId):g.MachinariumCardTableData.getById(this.tMachinariumData.cardId)?g.MachinariumCardTableData.getById(this.tMachinariumData.cardId).cardGroup:[]:[]},e.prototype.getTodayFightCardsId=function(){return this.tMachinariumData?this.tMachinariumData.cardId:0},e.prototype.getMachineryCityBattleCards=function(){var e=this,t=function(e){var t=1;return n.default.getHeroCarData().forEach(function(o){o&&1==o.bHeroLock&&o.heroId==e&&(t=o.heroLevel)}),t},o=[],i=this.getTodayFightCards();return i&&i.length>0&&i.forEach(function(i,a){var n=new p.HeroCarModule;n.heroId=i,n.heroLevel=t.call(e,i),o[a]=n}),o},e.prototype.getTodayFightFailCount=function(){return this.tMachinariumData?this.tMachinariumData.dayFailNum:99},e.prototype.getMachineryCitySociatyMemberRankData=function(){return this.tMachinariumData?this.tMachinariumData.rankListData:[]},e.prototype.checkMachineryCityRedpointState=function(){if(0==this.getMachineryCityIsOpen())return!1;var e=s.ActivityTableData.getById(c.ACTIVITY_ID_ENUM.P_Activity_Machinarium);if(e.param7+e.param3-this.getTodayFightFailCount()>0){var t=f.getLocalData("SaveMachinariumCityRedFlag");if(t&&"0"==t)return!0}return 1==this.checkBoxRedPoint()||1==this.checkMachinariumRoundRewards()},e.prototype.getMachineryCityState=function(){if(this.getTodayFightCardsId()<=0)return d.G.StringManager.PopString("\u5361\u7ec4\u6570\u636e\u9519\u8bef"),!1;var e=s.ActivityTableData.getById(c.ACTIVITY_ID_ENUM.P_Activity_Machinarium);return n.default.getRoleAttrValByKey(l.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE)<e.param1?(d.G.StringManager.PopString(d.G.StringManager.getString("MACHINERYCITY_TIP7",e.param1)),!1):e.param7>0&&t.Instance.getTodayFightFailCount()>=e.param3+e.param7?(d.G.StringManager.PopWorldString("common_fight_over"),!1):0!=t.Instance.getMachineryCityIsOpen()||(d.G.StringManager.PopString(d.G.StringManager.getString("MACHINERYCITY_TIP1")),!1)},e.prototype.checkBoxRedPoint=function(){return 0!=this.bMachinariumActivityIsOpen&&1==this.checkBoxIsReceive()},e.prototype.checkBoxIsReceive=function(){var e=Number(u.getConfigIntValue("Machinarium_box_coin_itemId")),t=n.default.getItemCountByBag(e),o=[];a.MachinariumBattlePassTableData.getDataMap().forEach(function(e){o.push(e)});for(var i=0;i<o.length;i++){var r=o[i],s=0,c=this.checkBoxReceiveState(r.id,1);0!=c&&c||t>=r.coinNum&&(s=1);var d=0,h=this.checkBoxReceiveState(r.id,2);if(0!=h&&h||t>=r.coinNum&&1==n.default.getRoleAttrValByKey(l.ROLE_ATTR_VALUES.ROLE_ATTR_MACHINARIUM_BATTLEPASS)&&(d=1),1==s)return!0;if(1==d)return!0}return!1},e.prototype.checkReceiveSociatyBoxPrize=function(){var e=this,t=[],o=Number(u.getConfigIntValue("Machinarium_box_coin_itemId")),i=n.default.getItemCountByBag(o),r=[];return a.MachinariumBattlePassTableData.getDataMap().forEach(function(e){r.push(e)}),r.forEach(function(o){var a=0,r=e.checkBoxReceiveState(o.id,1);0!=r&&r||i>=o.coinNum&&(a=1);var s,c=0,d=e.checkBoxReceiveState(o.id,2);0!=d&&d||i>=o.coinNum&&1==n.default.getRoleAttrValByKey(l.ROLE_ATTR_VALUES.ROLE_ATTR_MACHINARIUM_BATTLEPASS)&&(c=1),1==a&&((s=new h.T_Activity_MachinariumGetBattlePassRewardData).index=o.id,s.type=1,t.push(s)),1==c&&((s=new h.T_Activity_MachinariumGetBattlePassRewardData).index=o.id,s.type=2,t.push(s))}),t},e.prototype.checkBoxReceiveState=function(e,t){if(!this.tActivityMachinariumData)return!1;var o=this.tActivityMachinariumData.normalPrize;return 2==t&&(o=this.tActivityMachinariumData.superprize),!!o.has(e)&&o.get(e)},e.prototype.getMachinariumRotationId=function(){return this.tActivityMachinariumData?this.tActivityMachinariumData.refleshId:0},e.prototype.checkMachinariumRoundRewards=function(){var e=this,t=!1;return m.MachinariumRewardTableData.getDataMap().forEach(function(o){var i=e.getMachineryRoundRewardStatusMap();i&&e.getMachineryCityTotalRound()>=o.machinariumAllRound&&i.get(o.machinariumAllRound)<=0&&(t=!0)}),t},e.prototype.setICSociatyRoleGetMachinariumState=function(e){this.bInitiativeCallSociatyRoleGetMachinarium=e},e.prototype.getICSociatyRoleGetMachinariumState=function(){return this.bInitiativeCallSociatyRoleGetMachinarium},e._instance=null,t=i([_],e)}();o.default=y,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/ActivityTableData":"ActivityTableData","../../StaticData/MachinariumBattlePassTableData":"MachinariumBattlePassTableData","../../StaticData/MachinariumCardTableData":"MachinariumCardTableData","../../StaticData/MachinariumRewardTableData":"MachinariumRewardTableData","../../common/CommandValue":"CommandValue","../../common/PlayerModule":"PlayerModule","../../network/protocol/ActivityProtocols":"ActivityProtocols","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/GameUtils":"GameUtils"}],MachineryCityRankView:[function(e,t,o){"use strict";cc._RF.push(t,"ca317axG1NC/pftdfCSErWF","MachineryCityRankView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=e("../../network/protocol/TypeProtocols"),l=e("../../utils/List"),d=e("../../utils/GameTools"),u=e("../../common/PlayerModule"),h=e("../../Global/GameGlobal"),p=e("../sociaty/SociatyModel"),f=e("../../StaticData/MachinariumRankListTableData"),g=e("./MachineryCityModel"),m=e("../../StaticData/MachinariumRewardTableData"),_=e("../../utils/ResourcesManager"),y=e("../../utils/ConfigUtils"),v=e("./MachineryCityCtrl"),C=e("../../modules/manager/EventManager"),S=e("../../common/EventConst"),T=cc._decorator,I=T.ccclass,N=T.property,b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.m_SociatyRankListNode=null,t.m_SociatyMemberRankListNode=null,t.m_SociatyRewardListNode=null,t.m_SociatyRoundRewardListNode=null,t.m_SociatyRankMyRankNode=null,t.m_SociatyMemberRankMyRankNode=null,t.m_SociatyRewardItemNode=null,t.m_SociatyRoundRewardItemNode=null,t.m_SociatyRoundRewardRedpointNode=null,t.m_SociatyRankTipLabNode=null,t.m_SociatyMemberRankTipLabNode=null,t.sSelectTabName="",t.tSociatyRankListData=[],t.nSociatyRankPageIdx=1,t.nSociatyRankMaxPage=0,t.tSociatyMemberRankListData=[],t}return a(t,e),t.path=function(){return"ui/machineryCityActivity/prefab/MachineryCityRank"},t.prototype.start=function(){this.m_SociatyRankListNode.node.on("bounce-bottom",this.onSociatyScrollBottom,this),this.onClickSociatyTotalTabCallBack(),C.default.Instance.on(S.default.RefreshMachineryCityRoundRewardListEvent,this.initSociatyRoundRewardListInfo,this),this.m_SociatyRoundRewardRedpointNode.active=g.default.Instance.checkMachinariumRoundRewards()},t.prototype.onSociatyScrollBottom=function(){this.nSociatyRankPageIdx>=this.nSociatyRankMaxPage||(this.nSociatyRankPageIdx++,this.callSociatyRank())},t.prototype.callSociatyRank=function(){var e=this,t=p.default.instance().SociatyPlayerData,o=d.default.getDevelopRankListUrl("SociatyRank"),i=u.default.uuidTransformRoieId();o+="?",o+="ranktype="+c.RANKLIST_TYPE.RANKLIST_TYPE_MACHINARIUM,o+="&roleid="+i,o+="&page="+this.nSociatyRankPageIdx,o+="&sociatyid="+t.sociatyID;var a=new XMLHttpRequest;a.onreadystatechange=function(){if(4==a.readyState&&a.status>=200&&a.status<400){var t=a.responseText.toString();t=(t=(t=t.replace('"','"')).replace("\ufeff","")).replace(" ","");var o=JSON.parse(t),i=o.page;e.nSociatyRankMaxPage=o.maxpage,0==i||0==e.nSociatyRankMaxPage?e.m_SociatyRankMyRankNode.active=!1:e.m_SociatyRankMyRankNode.active=!0,Number(o.ranktype)==c.RANKLIST_TYPE.RANKLIST_TYPE_MACHINARIUM&&Number(i)==e.nSociatyRankPageIdx&&e.resolvingSociatyRankData(o)}},a.timeout=3e3,a.ontimeout=function(){cc.isValid(e)&&h.G.StringManager.PopString("\u6392\u884c\u699c\u8bf7\u6c42\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\uff01")},a.onerror=function(){cc.isValid(e)&&h.G.StringManager.PopString("\u6392\u884c\u699c\u8bf7\u6c42\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\uff01")},a.open("GET",o,!0),a.send()},t.prototype.resolvingSociatyRankData=function(e){1==Number(e.page)&&(this.tSociatyRankListData=[]);var t=this.m_SociatyRankMyRankNode.getChildByName("my_rank_num").getComponent(cc.Label);t.string=h.G.StringManager.getString("NO_RANK");var o=this.m_SociatyRankMyRankNode.getChildByName("my_score_label").getComponent(cc.Label),i=this.m_SociatyRankMyRankNode.getChildByName("my_sociaty_label").children[0].getComponent(cc.Label),a=g.default.Instance.getMachineryCityTotalRound(),n=p.default.instance().SociatyPlayerData;if(n.sociatyID.length<=0||0==Number(n.sociatyID)||Number(n.sociatyID),o.string=a+"",i.string=h.G.StringManager.getWorldString("common_level",n.sociatyLevel),"playerrank"in e&&(t.string=e.playerrank,"playerdata"in e)){var r=JSON.parse(e.playerdata);o.string=r.sociatyExp,i.string=h.G.StringManager.getWorldString("common_level",r.sociatyLevel)}if("ranklist"in e){var s=e.ranklist;for(var c in s)Object.prototype.hasOwnProperty.call(s,c)&&this.tSociatyRankListData.push(s[c])}this.m_SociatyRankListNode.numItems=this.tSociatyRankListData.length},t.prototype.onSociatyRefreshItemRankEvent=function(e,t){var o=this.tSociatyRankListData[t];e.getComponent("MachineryCitySociatyRankItem").refreshData(o,t+1)},t.prototype.initSociatyRoundRewardListInfo=function(){var e=this;this.m_SociatyRoundRewardListNode.content.childrenCount>0&&this.m_SociatyRoundRewardListNode.content.destroyAllChildren(),this.scheduleOnce(function(){m.MachinariumRewardTableData.getDataMap().forEach(function(t){var o=cc.instantiate(e.m_SociatyRoundRewardItemNode);o.active=!0,o.parent=e.m_SociatyRoundRewardListNode.content;var i=o.getChildByName("rewardNode"),a=y.default.getInstance().getItemByID(t.prize[0].dropID).icon;_.default.loadSprite(a,i.getComponent(cc.Sprite)),i.children[0].getComponent(cc.Label).string=t.prize[0].dropNum.toString();var n=o.getChildByName("task_progress");n.getChildByName("task_desc").getComponent(cc.Label).string=h.G.StringManager.getString("MACHINERYCITY_TIP5",t.machinariumAllRound);var r=n.getChildByName("task_progressBar"),s=g.default.Instance.getMachineryCityTotalRound();r.getComponent(cc.ProgressBar).progress=s/t.machinariumAllRound,r.getComponent(cc.ProgressBar).progress>=1?r.getChildByName("num").getComponent(cc.Label).string=t.machinariumAllRound+"/"+t.machinariumAllRound:r.getChildByName("num").getComponent(cc.Label).string=s+"/"+t.machinariumAllRound;var c=o.getChildByName("receiveBtn");c.RoundNum=t.machinariumAllRound,c.active=!1;var l=o.getChildByName("finishNode");l.active=!1;var u=o.getChildByName("noFinishLab");u.active=!1;var p=g.default.Instance.getMachineryRoundRewardStatusMap();p&&(1==p.get(t.machinariumAllRound)?(l.active=!0,r.getComponent(cc.ProgressBar).progress=1,r.getChildByName("num").getComponent(cc.Label).string=t.machinariumAllRound+"/"+t.machinariumAllRound):r.getComponent(cc.ProgressBar).progress>=1?c.active=!0:u.active=!0),d.default.registerTouchEvent(c,function(e){v.default.callSociatyRoleGetMachinariumReward(e.target.RoundNum)})})}),this.m_SociatyRoundRewardRedpointNode.active=g.default.Instance.checkMachinariumRoundRewards()},t.prototype.initSociatyRewardListInfo=function(){var e=this;f.MachinariumRankListTableData.getDataMap().forEach(function(t){var o=cc.instantiate(e.m_SociatyRewardItemNode);o.parent=e.m_SociatyRewardListNode.content,o.active=!0,o.getChildByName("rank1").active=!1,o.getChildByName("rank2").active=!1,o.getChildByName("rank3").active=!1,t.rankMin==t.rankMax&&o.getChildByName("rank"+t.rankMin)?o.getChildByName("rank"+t.rankMin).active=!0:o.getChildByName("rankLabNode").children[0].getComponent(cc.Label).string=t.rankMin+" - "+t.rankMax;for(var i=0;i<t.prize.length;i++)d.default.createNormalItems(t.prize[i].dropID,t.prize[i].dropNum,o.getChildByName("RewardsNode"),function(e){e.scale=.75})})},t.prototype.initSociatyMemberRankDataInfo=function(){var e=g.default.Instance.getMachineryCitySociatyMemberRankData();e.sort(function(e,t){return e.round==t.round?e.totalTime<t.totalTime?-1:1:e.round<t.round?1:-1}),this.tSociatyMemberRankListData=e,this.m_SociatyMemberRankListNode.numItems=e.length;var t=function(){for(var t=null,o=function(o){if(e[o].roles.forEach(function(i){1==u.default.UUID.equals(i.roleId)&&((t=e[o]).rankId=o+1)}),t)return"break"},i=0;i<e.length&&"break"!==o(i);i++);return t}.call(this);t?(this.m_SociatyMemberRankMyRankNode.getChildByName("my_rank_num").getComponent(cc.Label).string=t.rankId.toString(),this.m_SociatyMemberRankMyRankNode.getChildByName("my_score_label").getComponent(cc.Label).string=t.round.toString(),this.m_SociatyMemberRankMyRankNode.getChildByName("my_time_label").getComponent(cc.Label).string=function(e){var t=e%864e5/36e5,o=e%36e5/6e4,i=e%6e4/1e3;return parseInt(t.toString())>0?parseInt(t.toString())+" \u65f6 "+parseInt(o.toString())+" \u5206 "+i+" \u79d2 ":parseInt(o.toString())+" \u5206 "+i+" \u79d2 "}.call(this,1e3*t.totalTime)):(this.m_SociatyMemberRankMyRankNode.getChildByName("my_rank_num").getComponent(cc.Label).string=h.G.StringManager.getString("NO_RANK"),this.m_SociatyMemberRankMyRankNode.getChildByName("my_score_label").getComponent(cc.Label).string="0",this.m_SociatyMemberRankMyRankNode.getChildByName("my_time_label").getComponent(cc.Label).string=""),e.length<=0?this.m_SociatyMemberRankMyRankNode.active=!1:this.m_SociatyMemberRankMyRankNode.active=!0},t.prototype.onSociatyMemberRefreshItemRankEvent=function(e,t){var o=this.tSociatyMemberRankListData[t];e.getComponent("MachineryCitySociatyMemberRankItem").refreshData(o,t+1)},t.prototype.onClickSociatyTotalTabCallBack=function(){"SociatyTotalTab"!=this.sSelectTabName&&(this.sSelectTabName="SociatyTotalTab",this.m_SociatyRankListNode.scrollTo(-1,.1),this.m_SociatyRankMyRankNode.active=!1,this.m_SociatyMemberRankMyRankNode.active=!1,this.m_SociatyRewardListNode.node.active=!1,this.m_SociatyRankListNode.node.active=!0,this.m_SociatyMemberRankListNode.node.active=!1,this.m_SociatyRewardListNode.node.active=!1,this.m_SociatyRoundRewardListNode.node.active=!1,this.m_SociatyRankTipLabNode.active=!0,this.m_SociatyMemberRankTipLabNode.active=!1,this.tSociatyRankListData.length<=0?this.callSociatyRank():this.m_SociatyRankMyRankNode.active=!0)},t.prototype.onClickSociatyRewardTabCallBack=function(){"SociatyRewardTab"!=this.sSelectTabName&&(this.sSelectTabName="SociatyRewardTab",this.m_SociatyRewardListNode.scrollToTop(.1),this.m_SociatyRankMyRankNode.active=!1,this.m_SociatyMemberRankMyRankNode.active=!1,this.m_SociatyRankListNode.node.active=!1,this.m_SociatyMemberRankListNode.node.active=!1,this.m_SociatyRewardListNode.node.active=!0,this.m_SociatyRoundRewardListNode.node.active=!1,this.m_SociatyRankTipLabNode.active=!0,this.m_SociatyMemberRankTipLabNode.active=!1,this.m_SociatyRewardListNode.content.childrenCount<=0&&this.initSociatyRewardListInfo())},t.prototype.onClickSociatyMemberTabCallBack=function(){"SociatyMemberTab"!=this.sSelectTabName&&(this.sSelectTabName="SociatyMemberTab",this.m_SociatyMemberRankListNode.scrollTo(-1,.1),this.m_SociatyRankMyRankNode.active=!1,this.m_SociatyMemberRankMyRankNode.active=!0,this.m_SociatyRankListNode.node.active=!1,this.m_SociatyMemberRankListNode.node.active=!0,this.m_SociatyRewardListNode.node.active=!1,this.m_SociatyRoundRewardListNode.node.active=!1,this.m_SociatyRankTipLabNode.active=!1,this.m_SociatyMemberRankTipLabNode.active=!0,this.tSociatyMemberRankListData.length<=0&&this.initSociatyMemberRankDataInfo())},t.prototype.onClickSociatyRoundRewardsCallBack=function(){"SociatyRoundRewardTab"!=this.sSelectTabName&&(this.sSelectTabName="SociatyRoundRewardTab",this.m_SociatyRankMyRankNode.active=!1,this.m_SociatyMemberRankMyRankNode.active=!1,this.m_SociatyRankListNode.node.active=!1,this.m_SociatyMemberRankListNode.node.active=!1,this.m_SociatyRewardListNode.node.active=!1,this.m_SociatyRoundRewardListNode.node.active=!0,this.m_SociatyRankTipLabNode.active=!1,this.m_SociatyMemberRankTipLabNode.active=!1,this.m_SociatyRoundRewardListNode.scrollToTop(.1),this.m_SociatyRoundRewardListNode.content.childrenCount<=0&&this.initSociatyRoundRewardListInfo())},t.prototype.onDestroy=function(){C.default.Instance.off(this)},n([N(l.default)],t.prototype,"m_SociatyRankListNode",void 0),n([N(l.default)],t.prototype,"m_SociatyMemberRankListNode",void 0),n([N(cc.ScrollView)],t.prototype,"m_SociatyRewardListNode",void 0),n([N(cc.ScrollView)],t.prototype,"m_SociatyRoundRewardListNode",void 0),n([N(cc.Node)],t.prototype,"m_SociatyRankMyRankNode",void 0),n([N(cc.Node)],t.prototype,"m_SociatyMemberRankMyRankNode",void 0),n([N(cc.Node)],t.prototype,"m_SociatyRewardItemNode",void 0),n([N(cc.Node)],t.prototype,"m_SociatyRoundRewardItemNode",void 0),n([N(cc.Node)],t.prototype,"m_SociatyRoundRewardRedpointNode",void 0),n([N(cc.Node)],t.prototype,"m_SociatyRankTipLabNode",void 0),n([N(cc.Node)],t.prototype,"m_SociatyMemberRankTipLabNode",void 0),n([s.Register_Class,I],t)}(r.default);o.default=b,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/MachinariumRankListTableData":"MachinariumRankListTableData","../../StaticData/MachinariumRewardTableData":"MachinariumRewardTableData","../../common/EventConst":"EventConst","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/manager/EventManager":"EventManager","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/ConfigUtils":"ConfigUtils","../../utils/GameTools":"GameTools","../../utils/List":"List","../../utils/ResourcesManager":"ResourcesManager","../sociaty/SociatyModel":"SociatyModel","./MachineryCityCtrl":"MachineryCityCtrl","./MachineryCityModel":"MachineryCityModel"}],MachineryCityRechargeView:[function(e,t,o){"use strict";cc._RF.push(t,"baf3aBN8XJJ87xnd9H/Cg6U","MachineryCityRechargeView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../common/PlayerModule"),s=e("../../Global/GameGlobal"),c=e("../../modules/base/BaseView"),l=e("../../modules/base/Decorators"),d=e("../../modules/base/GameView"),u=e("../../network/ClientNetwork"),h=e("../../network/protocol/RechargeProtocols"),p=e("../../network/protocol/RoleProtocols"),f=e("../../StaticData/LuckyGiftSelectTableData"),g=e("../../StaticData/RechargeTableData"),m=e("../../utils/ConfigUtils"),_=e("../../utils/GameTools"),y=e("../../utils/GameUtils"),v=cc._decorator,C=v.ccclass,S=v.property,T=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.m_btn_buy=null,t.m_btn_buy2=null,t.m_btn_buy3=null,t.m_btn_buy4=null,t.m_box1=null,t.m_box2=null,t.m_box3=null,t.m_box4=null,t.rechargeId_buy1=39,t.rechargeId_buy2=40,t.rechargeId_buy3=41,t.rechargeId_buy4=42,t.select_index=0,t}return a(t,e),t.path=function(){return"ui/machineryCityActivity/prefab/MachineryCityRecharge"},t.prototype.onLoad=function(){},t.prototype.start=function(){var e=this;u.ClientNetwork.getInstance().listenProtocol(h.RECHARGE_CLIENT_ENUM.P_Recharge_Role_Recharge,function(){e.initBuyViewDay1(),e.initBuyViewDay2(),e.initBuyViewDay3()},this),u.ClientNetwork.getInstance().listenProtocol(p.ROLE_CLIENT_ENUM.P_Role_SetSelfSelect,function(){1==e.select_index?e.initBuyViewDay1():2==e.select_index?e.initBuyViewDay2():3==e.select_index?e.initBuyViewDay3():e.initBuyViewDay4()},this),this.initBuyViewDay1(),this.initBuyViewDay2(),this.initBuyViewDay3(),this.initBuyViewDay4();for(var t=function(t){_.default.registerTouchEvent(o.node.getChildByName("newBoxRechargeNode").getChildByName("box"+t).getChildByName("select"),function(){var o=38+t,i=r.default.getRoleRechargeData().get(o),a=g.RechargeTableData.getById(o);if(i&&i.dayNum>a.limitMaxDayNum&&4!=t)return s.G.StringManager.PopString("\u60a8\u5df2\u8d2d\u4e70\u8fc7\u8be5\u793c\u5305\uff0c\u65e0\u6cd5\u9009\u62e9");var n=y.getConfigIntValue("battlePass_choose_gold"),c=f.LuckyGiftSelectTableData.getById(Number(n)).prize;c=y.clone(c),e.select_index=t,c.forEach(function(e){var t=Number(y.getConfigIntValue("SelfSelect_"+o));e.itemNum=null!=t?t:1});for(var l=c.length-1;l>=0;l--)2!=m.default.getInstance().getItemByID(c[l].itemID).type&&c.splice(l,1);d.default.addPopView("BaseCtrl","LuckyGiftSelectRewardView","LuckyGiftSelectRewardView",{tRewards:c,index:o,isEveryDayReacharge:!1,parent:e,callBack:function(e,t){if(0!=e){var o=new p.C_Role_SetSelfSelect;o.type=t,o.selectItemId=e,u.ClientNetwork.getInstance().Send(p.ROLE_CLIENT_ENUM.P_Role_SetSelfSelect,o)}else s.G.StringManager.PopString("\u672a\u9009\u62e9\u82f1\u96c4\u5956\u52b1")}})})},o=this,i=1;i<5;i++)t(i)},t.prototype.initBuyViewDay1=function(){var e=this;this.m_box1.getChildByName("boxReward").removeAllChildren();var t=g.RechargeTableData.getById(this.rechargeId_buy1);if(null!=t){t.prize.forEach(function(t){var o=m.default.getInstance().getDorpItemsByID(t.dropID);if(o)for(var i=o.dropRandom.split("|"),a=function(t){var o=i[t].split("#"),a=o[0],n=o[1]!=o[2]?"x"+o[1]+"~"+o[2]:"x"+o[1];_.default.createNormalItemsWithNames(a,-1,e.m_box1.getChildByName("boxReward"),function(e){e.getChildByName("txt_name").getComponent(cc.Label).string=n})},n=0;n<i.length;n++)a(n)});var o=_.default.getRechargeMoneyByPlatform(t)/100,i=r.default.getRoleRechargeData().get(this.rechargeId_buy1);null!=i&&i.dayNum>t.limitMaxDayNum?(this.m_btn_buy.getComponent(cc.Button).interactable=!1,this.m_btn_buy.getChildByName("label").getComponent(cc.Label).string=s.G.StringManager.getWorldString("word_yishouwan")):(this.m_btn_buy.getComponent(cc.Button).interactable=!0,this.m_btn_buy.getChildByName("label").getComponent(cc.Label).string=s.G.StringManager.getString("SUPER_SALE_MONEY",o));var a=t.limitMaxNum;if(a<=0)this.node.getChildByName("newBoxRechargeNode").getChildByName("limit1").active=!1;else{var n=null!=i?i.totalNum:0;this.node.getChildByName("newBoxRechargeNode").getChildByName("limit1").active=!0,this.node.getChildByName("newBoxRechargeNode").getChildByName("limit1").getChildByName("label_limit").getComponent(cc.Label).string=s.G.StringManager.getWorldString("word_xiangou")+a+"\u6b21("+n+"/"+a+")"}var c=r.default.getRoleInfoData().selfSelectMap.get(this.rechargeId_buy1);if(null==c||c<=0)this.m_box1.getChildByName("select").getChildByName("player").active=!0,this.m_box1.getChildByName("select").getChildByName("changeIcon").active=!1,this.m_box1.getChildByName("select").getChildByName("txt").getComponent(cc.Label).string="";else{this.m_box1.getChildByName("select").getChildByName("player").active=!1,this.m_box1.getChildByName("select").getChildByName("changeIcon").active=!0;var l=m.default.getInstance().getItemByID(c);y.setTexture(this.m_box1.getChildByName("select").getChildByName("headframe").getComponent(cc.Sprite),l.icon);var d=y.getConfigIntValue("SelfSelect_39");this.m_box1.getChildByName("select").getChildByName("txt").getComponent(cc.Label).string="x"+d}}},t.prototype.showSecectRwd=function(e,t){if(0!=e){var o=e;if(o<=0)this.node.getChildByName("newBoxRechargeNode").getChildByName("box"+t).getChildByName("select").getChildByName("player").active=!0,this.node.getChildByName("newBoxRechargeNode").getChildByName("box"+t).getChildByName("select").getChildByName("changeIcon").active=!1,this.node.getChildByName("newBoxRechargeNode").getChildByName("box"+t).getChildByName("select").getChildByName("txt").getComponent(cc.Label).string="";else{this.node.getChildByName("newBoxRechargeNode").getChildByName("box"+t).getChildByName("select").getChildByName("player").active=!1,this.node.getChildByName("newBoxRechargeNode").getChildByName("box"+t).getChildByName("select").getChildByName("changeIcon").active=!0;var i=m.default.getInstance().getItemByID(o);y.setTexture(this.node.getChildByName("newBoxRechargeNode").getChildByName("box"+t).getChildByName("select").getChildByName("headframe").getComponent(cc.Sprite),i.icon);var a=y.getConfigIntValue("skyCastle_select_recharge_rewardNum");this.node.getChildByName("newBoxRechargeNode").getChildByName("box"+t).getChildByName("select").getChildByName("txt").getComponent(cc.Label).string="x"+a}}},t.prototype.initBuyViewDay2=function(){var e=this;this.m_box2.getChildByName("boxReward").removeAllChildren();var t=g.RechargeTableData.getById(this.rechargeId_buy2);if(null!=t){t.prize.forEach(function(t){var o=m.default.getInstance().getDorpItemsByID(t.dropID);if(o)for(var i=o.dropRandom.split("|"),a=function(t){var o=i[t].split("#"),a=o[0],n=o[1]!=o[2]?"x"+o[1]+"~"+o[2]:"x"+o[1];_.default.createNormalItemsWithNames(a,-1,e.m_box2.getChildByName("boxReward"),function(e){e.getChildByName("txt_name").getComponent(cc.Label).string=n})},n=0;n<i.length;n++)a(n)});var o=_.default.getRechargeMoneyByPlatform(t)/100,i=r.default.getRoleRechargeData().get(this.rechargeId_buy2);null!=i&&i.dayNum>t.limitMaxDayNum?(this.m_btn_buy2.getComponent(cc.Button).interactable=!1,this.m_btn_buy2.getChildByName("label").getComponent(cc.Label).string=s.G.StringManager.getWorldString("word_yishouwan")):(this.m_btn_buy2.getComponent(cc.Button).interactable=!0,this.m_btn_buy2.getChildByName("label").getComponent(cc.Label).string=s.G.StringManager.getString("SUPER_SALE_MONEY",o));var a=t.limitMaxNum;if(a<=0)this.node.getChildByName("newBoxRechargeNode").getChildByName("limit2").active=!1;else{var n=null!=i?i.totalNum:0;this.node.getChildByName("newBoxRechargeNode").getChildByName("limit2").active=!0,this.node.getChildByName("newBoxRechargeNode").getChildByName("limit2").getChildByName("label_limit").getComponent(cc.Label).string=s.G.StringManager.getWorldString("word_xiangou")+a+"\u6b21("+n+"/"+a+")"}var c=r.default.getRoleInfoData().selfSelectMap.get(this.rechargeId_buy2);if(null==c||c<=0)this.m_box2.getChildByName("select").getChildByName("player").active=!0,this.m_box2.getChildByName("select").getChildByName("changeIcon").active=!1,this.m_box2.getChildByName("select").getChildByName("txt").getComponent(cc.Label).string="";else{this.m_box2.getChildByName("select").getChildByName("player").active=!1,this.m_box2.getChildByName("select").getChildByName("changeIcon").active=!0;var l=m.default.getInstance().getItemByID(c);y.setTexture(this.m_box2.getChildByName("select").getChildByName("headframe").getComponent(cc.Sprite),l.icon);var d=y.getConfigIntValue("SelfSelect_40");this.m_box2.getChildByName("select").getChildByName("txt").getComponent(cc.Label).string="x"+d}}},t.prototype.initBuyViewDay3=function(){var e=this;this.m_box3.getChildByName("boxReward").removeAllChildren();var t=g.RechargeTableData.getById(this.rechargeId_buy3);if(null!=t){t.prize.forEach(function(t){var o=m.default.getInstance().getDorpItemsByID(t.dropID);if(o)for(var i=o.dropRandom.split("|"),a=function(t){var o=i[t].split("#"),a=o[0],n=o[1]!=o[2]?"x"+o[1]+"~"+o[2]:"x"+o[1];_.default.createNormalItemsWithNames(a,-1,e.m_box3.getChildByName("boxReward"),function(e){e.getChildByName("txt_name").getComponent(cc.Label).string=n})},n=0;n<i.length;n++)a(n)});var o=_.default.getRechargeMoneyByPlatform(t)/100,i=r.default.getRoleRechargeData().get(this.rechargeId_buy3);null!=i&&i.dayNum>t.limitMaxDayNum?(this.m_btn_buy3.getComponent(cc.Button).interactable=!1,this.m_btn_buy3.getChildByName("label").getComponent(cc.Label).string=s.G.StringManager.getWorldString("word_yishouwan")):(this.m_btn_buy3.getComponent(cc.Button).interactable=!0,this.m_btn_buy3.getChildByName("label").getComponent(cc.Label).string=s.G.StringManager.getString("SUPER_SALE_MONEY",o));var a=t.limitMaxNum;if(a<=0)this.node.getChildByName("newBoxRechargeNode").getChildByName("limit3").active=!1;else{var n=null!=i?i.totalNum:0;this.node.getChildByName("newBoxRechargeNode").getChildByName("limit3").active=!0,this.node.getChildByName("newBoxRechargeNode").getChildByName("limit3").getChildByName("label_limit").getComponent(cc.Label).string="\u9650\u8d2d"+a+"\u6b21("+n+"/"+a+")"}var c=r.default.getRoleInfoData().selfSelectMap.get(this.rechargeId_buy3);if(null==c||c<=0)this.m_box3.getChildByName("select").getChildByName("player").active=!0,this.m_box3.getChildByName("select").getChildByName("changeIcon").active=!1,this.m_box3.getChildByName("select").getChildByName("txt").getComponent(cc.Label).string="";else{this.m_box3.getChildByName("select").getChildByName("player").active=!1,this.m_box3.getChildByName("select").getChildByName("changeIcon").active=!0;var l=m.default.getInstance().getItemByID(c);y.setTexture(this.m_box3.getChildByName("select").getChildByName("headframe").getComponent(cc.Sprite),l.icon);var d=y.getConfigIntValue("SelfSelect_41");this.m_box3.getChildByName("select").getChildByName("txt").getComponent(cc.Label).string="x"+d}}},t.prototype.initBuyViewDay4=function(){var e=this;this.m_box4.getChildByName("boxReward").removeAllChildren();var t=g.RechargeTableData.getById(this.rechargeId_buy4);if(null!=t){t.prize.forEach(function(t){var o=m.default.getInstance().getDorpItemsByID(t.dropID);if(o)for(var i=o.dropRandom.split("|"),a=function(t){var o=i[t].split("#"),a=o[0],n=o[1]!=o[2]?"x"+o[1]+"~"+o[2]:"x"+o[1];_.default.createNormalItemsWithNames(a,-1,e.m_box4.getChildByName("boxReward"),function(e){e.getChildByName("txt_name").getComponent(cc.Label).string=n})},n=0;n<i.length;n++)a(n)});var o=_.default.getRechargeMoneyByPlatform(t)/100;this.m_btn_buy4.getComponent(cc.Button).interactable=!0,this.m_btn_buy4.getChildByName("label").getComponent(cc.Label).string=s.G.StringManager.getString("SUPER_SALE_MONEY",o),this.node.getChildByName("newBoxRechargeNode").getChildByName("limit4").active=!0,this.node.getChildByName("newBoxRechargeNode").getChildByName("limit4").getChildByName("label_limit").getComponent(cc.Label).string="\uff08 \u4e0d\u9650\u8d2d \uff09";var i=r.default.getRoleInfoData().selfSelectMap.get(this.rechargeId_buy4);if(null==i||i<=0)this.m_box4.getChildByName("select").getChildByName("player").active=!0,this.m_box4.getChildByName("select").getChildByName("changeIcon").active=!1,this.m_box4.getChildByName("select").getChildByName("txt").getComponent(cc.Label).string="";else{this.m_box4.getChildByName("select").getChildByName("player").active=!1,this.m_box4.getChildByName("select").getChildByName("changeIcon").active=!0;var a=m.default.getInstance().getItemByID(i);y.setTexture(this.m_box4.getChildByName("select").getChildByName("headframe").getComponent(cc.Sprite),a.icon);var n=y.getConfigIntValue("SelfSelect_42");this.m_box4.getChildByName("select").getChildByName("txt").getComponent(cc.Label).string="x"+n}}},t.prototype.onClickBuy=function(){var e=this,t=this.rechargeId_buy1,o=(r.default.getRoleRechargeData().get(t),r.default.getRoleInfoData().selfSelectMap.get(t));if(null==o||o<=0)return s.G.StringManager.PopString(s.G.StringManager.getString("EVERYDAY_RECHARGE"));var i=function(){var o={rechargeID:t,rechargeNum:1};e.sendEvent("SendProtocolRecharge",o)};d.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:s.G.StringManager.getString("BUY_EVERYDAYRECHARGE_LASTDAY"),confirmCb:function(){i.call(e)}})},t.prototype.onClickBuy2=function(){var e=this,t=this.rechargeId_buy2,o=(r.default.getRoleRechargeData().get(t),r.default.getRoleInfoData().selfSelectMap.get(t));if(null==o||o<=0)return s.G.StringManager.PopString(s.G.StringManager.getString("EVERYDAY_RECHARGE"));var i=function(){var o={rechargeID:t,rechargeNum:1};e.sendEvent("SendProtocolRecharge",o)};d.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:s.G.StringManager.getString("BUY_EVERYDAYRECHARGE_LASTDAY"),confirmCb:function(){i.call(e)}})},t.prototype.onClickBuy3=function(){var e=this,t=this.rechargeId_buy3,o=(r.default.getRoleRechargeData().get(t),r.default.getRoleInfoData().selfSelectMap.get(t));if(null==o||o<=0)return s.G.StringManager.PopString(s.G.StringManager.getString("EVERYDAY_RECHARGE"));var i=function(){var o={rechargeID:t,rechargeNum:1};e.sendEvent("SendProtocolRecharge",o)};d.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:s.G.StringManager.getString("BUY_EVERYDAYRECHARGE_LASTDAY"),confirmCb:function(){i.call(e)}})},t.prototype.onClickBuy4=function(){var e=this,t=this.rechargeId_buy4,o=(r.default.getRoleRechargeData().get(t),r.default.getRoleInfoData().selfSelectMap.get(t));if(null==o||o<=0)return s.G.StringManager.PopString(s.G.StringManager.getString("EVERYDAY_RECHARGE"));var i=function(){var o={rechargeID:t,rechargeNum:1};e.sendEvent("SendProtocolRecharge",o)};d.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:s.G.StringManager.getString("BUY_EVERYDAYRECHARGE_LASTDAY"),confirmCb:function(){i.call(e)}})},n([S(cc.Node)],t.prototype,"m_btn_buy",void 0),n([S(cc.Node)],t.prototype,"m_btn_buy2",void 0),n([S(cc.Node)],t.prototype,"m_btn_buy3",void 0),n([S(cc.Node)],t.prototype,"m_btn_buy4",void 0),n([S(cc.Node)],t.prototype,"m_box1",void 0),n([S(cc.Node)],t.prototype,"m_box2",void 0),n([S(cc.Node)],t.prototype,"m_box3",void 0),n([S(cc.Node)],t.prototype,"m_box4",void 0),n([l.Register_Class,C],t)}(c.default);o.default=T,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/LuckyGiftSelectTableData":"LuckyGiftSelectTableData","../../StaticData/RechargeTableData":"RechargeTableData","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/base/GameView":"GameView","../../network/ClientNetwork":"ClientNetwork","../../network/protocol/RechargeProtocols":"RechargeProtocols","../../network/protocol/RoleProtocols":"RoleProtocols","../../utils/ConfigUtils":"ConfigUtils","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils"}],MachineryCityShopIntroduceView:[function(e,t,o){"use strict";cc._RF.push(t,"2a78fGdmDhPLq8LThdtrl+Z","MachineryCityShopIntroduceView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=cc._decorator,l=c.ccclass,d=(c.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.path=function(){return"ui/machineryCityActivity/prefab/MachineryCityShopIntroduce"},n([s.Register_Class,l],t)}(r.default));o.default=d,cc._RF.pop()},{"../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators"}],MachineryCityShopView:[function(e,t,o){"use strict";cc._RF.push(t,"97286JSqx1JeqN9xx9m7D0t","MachineryCityShopView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=e("../../network/protocol/RoleProtocols"),l=e("../../network/ClientNetwork"),d=e("../../Global/GameGlobal"),u=e("../../modules/base/GameView"),h=e("../../common/PlayerModule"),p=cc._decorator,f=p.ccclass,g=p.property,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.m_MoneyCountLabel=null,t.m_ShopItemLayout=null,t.m_ShopItemPrefab=null,t.desc=null,t.m_nGetRandShopId=10,t.m_nGetOtherRandShopId=11,t.m_consumeItemId=1027,t.m_consumeOtherItemId=1028,t.m_nCurIndex=1,t.tShopData1=null,t.tShopData2=null,t}return a(t,e),t.path=function(){return"ui/machineryCityActivity/prefab/MachineryCityShop"},t.prototype.start=function(){var e=this,t=new c.C_Role_GetRandShop;t.shopID=this.m_nGetRandShopId,l.ClientNetwork.getInstance().Send(c.ROLE_CLIENT_ENUM.P_Role_GetRandShop,t);var o=new c.C_Role_GetRandShop;o.shopID=this.m_nGetOtherRandShopId,l.ClientNetwork.getInstance().Send(c.ROLE_CLIENT_ENUM.P_Role_GetRandShop,o),l.ClientNetwork.getInstance().listenProtocol(c.ROLE_CLIENT_ENUM.P_Role_SynRandShopData,function(t){t.resetPos();var o=new c.S_Role_SynRandShopData;o.read(t)&&(o.shopID===e.m_nGetRandShopId?(e.tShopData1=o.shopData,1==e.m_nCurIndex&&e.initShopListInfo(o.shopData)):o.shopID===e.m_nGetOtherRandShopId&&(e.tShopData2=o.shopData,2==e.m_nCurIndex&&e.initOtherShopListInfo(o.shopData)))},this),l.ClientNetwork.getInstance().listenProtocol(c.ROLE_CLIENT_ENUM.P_Role_RandShopBuy,function(t){t.resetPos();var o=new c.S_Role_RandShopBuy;if(o.read(t))if(0===o.errorcode&&o.prize.length>0){u.default.addPopView("BaseCtrl","AcquirePopupView","AcquirePopupView",{items:o.prize});var i=u.default.getViewByName("ShopConfirmBuy");i&&i.view&&(i.view.node.active=!1,i.view.closeView()),1==e.m_nCurIndex?e.m_MoneyCountLabel.string=h.default.getItemCountByBag(e.m_consumeItemId):2==e.m_nCurIndex&&(e.m_MoneyCountLabel.string=h.default.getItemCountByBag(e.m_consumeOtherItemId))}else d.G.StringManager.PopString("S_Role_RandShopBuy ERROR  "+o.errorcode)},this)},t.prototype.initShopListInfo=function(e){var t=this;this.desc.node.active=!0,this.m_ShopItemLayout.node.destroyAllChildren(),this.scheduleOnce(function(){e.positions.forEach(function(e,o){var i=cc.instantiate(t.m_ShopItemPrefab);i.parent=t.m_ShopItemLayout.node,i.getComponent("NavigationShopItem").init(e,o,t.callRoleRandShopBuy),i.scale=.8})}),this.m_MoneyCountLabel.string=h.default.getItemCountByBag(this.m_consumeItemId)},t.prototype.initOtherShopListInfo=function(e){var t=this;this.desc.node.active=!1,this.m_ShopItemLayout.node.destroyAllChildren(),this.scheduleOnce(function(){e.positions.forEach(function(e,o){var i=cc.instantiate(t.m_ShopItemPrefab);i.parent=t.m_ShopItemLayout.node,i.getComponent("NavigationShopItem").init(e,o,t.callOtherRoleRandShopBuy,!0),i.scale=.8})}),this.m_MoneyCountLabel.string=h.default.getItemCountByBag(this.m_consumeOtherItemId)},t.prototype.clickFirstShopBtn=function(){1!=this.m_nCurIndex&&(this.m_nCurIndex=1,this.node.getChildByName("BuyNode").getChildByName("checkmark").active=!0,this.node.getChildByName("BuyNode1").getChildByName("checkmark").active=!1,this.initShopListInfo(this.tShopData1),this.node.getChildByName("itemBg").getChildByName("checkmark").active=!1)},t.prototype.clickOtherBtn=function(){2!=this.m_nCurIndex&&(this.m_nCurIndex=2,this.node.getChildByName("BuyNode").getChildByName("checkmark").active=!1,this.node.getChildByName("BuyNode1").getChildByName("checkmark").active=!0,this.initOtherShopListInfo(this.tShopData2),this.node.getChildByName("itemBg").getChildByName("checkmark").active=!0)},t.prototype.callRoleRandShopBuy=function(e){var t=new c.C_Role_RandShopBuy;t.shopID=10,t.shopPosition=e.shopPosition,t.shopItemID=e.shopItemID,l.ClientNetwork.getInstance().Send(c.ROLE_CLIENT_ENUM.P_Role_RandShopBuy,t)},t.prototype.callOtherRoleRandShopBuy=function(e){var t=new c.C_Role_RandShopBuy;t.shopID=11,t.shopPosition=e.shopPosition,t.shopItemID=e.shopItemID,l.ClientNetwork.getInstance().Send(c.ROLE_CLIENT_ENUM.P_Role_RandShopBuy,t)},t.prototype.onHelpCallBack=function(){u.default.addPopView("BaseCtrl","MachineryCityShopIntroduceView","MachineryCityShopIntroduceView")},n([g(cc.Label)],t.prototype,"m_MoneyCountLabel",void 0),n([g(cc.Layout)],t.prototype,"m_ShopItemLayout",void 0),n([g(cc.Prefab)],t.prototype,"m_ShopItemPrefab",void 0),n([g(cc.Label)],t.prototype,"desc",void 0),n([s.Register_Class,f],t)}(r.default);o.default=m,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/base/GameView":"GameView","../../network/ClientNetwork":"ClientNetwork","../../network/protocol/RoleProtocols":"RoleProtocols"}],MachineryCitySociatyMemberRankItem:[function(e,t,o){"use strict";cc._RF.push(t,"f21cePSbLBBHpow1u1IN29Y","MachineryCitySociatyMemberRankItem");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../Global/GameGlobal"),s=e("../../modules/base/GameView"),c=e("../../utils/GameTools"),l=e("../../modules/manager/LoadResManager"),d=e("../../utils/GameUtils"),u=e("../sociaty/SociatyModel"),h=e("../../common/PlayerModule"),p=cc._decorator,f=p.ccclass,g=p.property,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.round_time_label=null,t.round_label=null,t.player_name1_lab=null,t.player_name2_lab=null,t.player_sociaty_name1_lab=null,t.player_sociaty_name2_lab=null,t.player_head1_node=null,t.player_head2_node=null,t.rank_node_arr=[],t.rank_num_node=null,t.rank_num_lab=null,t}return a(t,e),t.prototype.refreshData=function(e,t){var o,i=this;this.rank_node_arr[0].active=1==t,this.rank_node_arr[1].active=2==t,this.rank_node_arr[2].active=3==t,this.rank_num_node.active=t>3,this.rank_num_lab.string=t.toString(),this.node.active=!0;var a=null===(o=u.default.instance().SociatyPlayerData)||void 0===o?void 0:o.sociatyName;a=a||"",this.round_time_label.string=function(e){var t=e%864e5/36e5,o=e%36e5/6e4,i=e%6e4/1e3;return parseInt(t.toString())>0?parseInt(t.toString())+" \u65f6 "+parseInt(o.toString())+" \u5206 "+i+" \u79d2 ":parseInt(o.toString())+" \u5206 "+i+" \u79d2 "}.call(this,1e3*e.totalTime),e.totalTime<=0?this.round_time_label.node.active=!1:this.round_time_label.node.active=!0,this.round_label.string=r.G.StringManager.getString("MY_ROUND",e.round);var n=0;e.roles.forEach(function(e){var t=null;if(e.headID=e.headID<=0?1:e.headID,0==n?(i.player_name1_lab.string=e.nickName,d.setRemoteHeadIcon(e.headUrl,e.headID,i.player_head1_node.getComponent(cc.Sprite)),t=i.player_head1_node,i.player_sociaty_name1_lab.string=a):(i.player_name2_lab.string=e.nickName,d.setRemoteHeadIcon(e.headUrl,e.headID,i.player_head2_node.getComponent(cc.Sprite)),t=i.player_head2_node,i.player_sociaty_name2_lab.string=a),t){t.roleid=e.roleId;var o=e.headFrameID;(o<=0||o>=2e3)&&(o=200),l.default.loadSpriteFrame("ui/headFrame/frame_"+o).then(function(e){t&&(t.getChildByName("headframe").getComponent(cc.Sprite).spriteFrame=e)}),c.default.registerTouchEvent(t,function(e){var t=s.default.getViewNodeByName("MainSceneView"),o=h.default.otherUUidTransformRoieId(e.target.roleid);t&&t.getComponent("MainSceneView").onCallGetRoleSimpleInfo(o)})}n++})},n([g(cc.Label)],t.prototype,"round_time_label",void 0),n([g(cc.Label)],t.prototype,"round_label",void 0),n([g(cc.Label)],t.prototype,"player_name1_lab",void 0),n([g(cc.Label)],t.prototype,"player_name2_lab",void 0),n([g(cc.Label)],t.prototype,"player_sociaty_name1_lab",void 0),n([g(cc.Label)],t.prototype,"player_sociaty_name2_lab",void 0),n([g(cc.Node)],t.prototype,"player_head1_node",void 0),n([g(cc.Node)],t.prototype,"player_head2_node",void 0),n([g(cc.Node)],t.prototype,"rank_node_arr",void 0),n([g(cc.Node)],t.prototype,"rank_num_node",void 0),n([g(cc.Label)],t.prototype,"rank_num_lab",void 0),n([f],t)}(cc.Component);o.default=m,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../common/PlayerModule":"PlayerModule","../../modules/base/GameView":"GameView","../../modules/manager/LoadResManager":"LoadResManager","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils","../sociaty/SociatyModel":"SociatyModel"}],MachineryCitySociatyRankItem:[function(e,t,o){"use strict";cc._RF.push(t,"7ccbaTDh8RFlYeFeW2FyMYf","MachineryCitySociatyRankItem");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../Global/GameGlobal"),s=cc._decorator,c=s.ccclass,l=s.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.sociaty_node=null,t.rank_node_arr=[],t.rank_num_node=null,t.rank_num_lab=null,t}return a(t,e),t.prototype.refreshData=function(e,t){this.rank_node_arr[0].active=1==t,this.rank_node_arr[1].active=2==t,this.rank_node_arr[2].active=3==t,this.rank_num_node.active=t>3,this.rank_num_lab.string=t.toString(),this.node.active=!0;var o=JSON.parse(e);this.sociaty_node.getChildByName("sociaty_name").getComponent(cc.Label).string=o.sociatyName,this.sociaty_node.getChildByName("sociaty_id").getComponent(cc.Label).string=o.sociatyId,this.sociaty_node.getChildByName("total_socre").children[0].getComponent(cc.Label).string=o.sociatyExp,this.sociaty_node.getChildByName("huizhang").children[0].getComponent(cc.Label).string=o.sociatyPresidentName,this.sociaty_node.getChildByName("lv_lab").getComponent(cc.Label).string=r.G.StringManager.getString("SOCIATY_LEVEL_TEXT",o.sociatyLevel)},n([l(cc.Node)],t.prototype,"sociaty_node",void 0),n([l(cc.Node)],t.prototype,"rank_node_arr",void 0),n([l(cc.Node)],t.prototype,"rank_num_node",void 0),n([l(cc.Label)],t.prototype,"rank_num_lab",void 0),n([c],t)}(cc.Component);o.default=d,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal"}],MailCtrl:[function(e,t,o){"use strict";cc._RF.push(t,"2b1c2o+NjFMSopDJZvDc768","MailCtrl");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseCtrl"),s=e("../../modules/base/GameView"),c=e("../../utils/LogUtil"),l=e("../../../scripts/modules/manager/ViewManager"),d=e("../../network/ClientNetwork"),u=e("../../network/protocol/RoleProtocols"),h=e("../../../scripts/modules/base/Decorators"),p=cc._decorator.ccclass,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.view=null,t.rewardCount=0,t}return a(t,e),t.prototype.init=function(){this.onlistenProtocol()},t.prototype.destroy=function(){d.ClientNetwork.getInstance().removeMessageTarget(this)},t.prototype.onlistenProtocol=function(){var e=this;d.ClientNetwork.getInstance().listenProtocol(u.ROLE_CLIENT_ENUM.P_Role_ReceiveMailAnnex,function(t){t.resetPos();var o=new u.S_Role_ReceiveMailAnnex;o.read(t)&&(0===o.errorcode?(e.tRewards=o.rewards,e.rewardCount=0,e.onShowLegendRewards()):c.default.info(o))},this),d.ClientNetwork.getInstance().listenProtocol(u.ROLE_CLIENT_ENUM.P_Role_DeleteReadMail,function(e){e.resetPos();var t=new u.S_Role_DeleteReadMail;t.read(e)&&(0===t.errorcode||c.default.info(t))},this)},t.prototype.onSendReceiveMailAnnex=function(e){c.default.log("\u70b9\u51fb\u53d1\u9001\u9886\u53d6\u90ae\u4ef6\u9644\u4ef6");var t=new u.C_Role_ReceiveMailAnnex;t.mailUUID=e,d.ClientNetwork.getInstance().Send(u.ROLE_CLIENT_ENUM.P_Role_ReceiveMailAnnex,t)},t.prototype.onSendReceiveMailAnnexWithSelfSelect=function(e){c.default.log("\u70b9\u51fb\u53d1\u9001\u9886\u53d6\u90ae\u4ef6\u9644\u4ef6");var t=new u.C_Role_ReceiveMailAnnex;t.mailUUID=e.mailUUID,t.selfSelect=e.pSelfSelectItemIds,d.ClientNetwork.getInstance().Send(u.ROLE_CLIENT_ENUM.P_Role_ReceiveMailAnnex,t)},t.prototype.onSendDeleteReadMail=function(e){c.default.log("\u70b9\u51fb\u53d1\u9001\u5220\u9664\u90ae\u4ef6");var t=new u.C_Role_DeleteReadMail;t.mailUUID=e,d.ClientNetwork.getInstance().Send(u.ROLE_CLIENT_ENUM.P_Role_DeleteReadMail,t)},t.prototype.onSendReadMail=function(e){var t=new u.C_Role_ReadMail;t.mailUUID=e,d.ClientNetwork.getInstance().Send(u.ROLE_CLIENT_ENUM.P_Role_ReadMail,t)},t.prototype.onShowLegendRewards=function(){var e=this,t=this.tRewards.slice(6*this.rewardCount,6*(this.rewardCount+1));t.length>0&&s.default.addPopView("BaseCtrl","AcquirePopupView","AcquirePopupView",{items:t,closeCb:function(){e.rewardCount++,e.onShowLegendRewards()}})},n([l.AddViewEvent("SendReceiveMailAnnex")],t.prototype,"onSendReceiveMailAnnex",null),n([l.AddViewEvent("SendReceiveMailAnnexWithSelfSelect")],t.prototype,"onSendReceiveMailAnnexWithSelfSelect",null),n([l.AddViewEvent("SendDeleteReadMail")],t.prototype,"onSendDeleteReadMail",null),n([l.AddViewEvent("SendReadMail")],t.prototype,"onSendReadMail",null),n([h.Register_Class2("MailCtrl"),p],t)}(r.default);o.default=f,cc._RF.pop()},{"../../../scripts/modules/base/Decorators":"Decorators","../../../scripts/modules/manager/ViewManager":"ViewManager","../../modules/base/BaseCtrl":"BaseCtrl","../../modules/base/GameView":"GameView","../../network/ClientNetwork":"ClientNetwork","../../network/protocol/RoleProtocols":"RoleProtocols","../../utils/LogUtil":"LogUtil"}],MailUtils:[function(e,t,o){"use strict";cc._RF.push(t,"c267421HC9LrrswvS0k9XUd","MailUtils"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../network/protocol/TypeProtocols"),a=e("../../utils/ConfigUtils"),n=function(){function e(){}return e.getInstance=function(){return this.Instance||(this.Instance=new e),this.Instance},e.prototype.getSelfSelectBoxItemIdList=function(e){for(var t=[],o=e.annex.annex,n=0;n<o.length;n++){var r=o[n].dropID,s=a.default.getInstance().getItemByID(r);if(null!=s&&s.type==i.TYPE_ITEM.TYPE_ITEM_CHOOSEBOX)for(var c=0;c<o[n].dropNum;c++)t.push(r)}return t},e.Instance=null,e}();o.default=n,cc._RF.pop()},{"../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/ConfigUtils":"ConfigUtils"}],MailView:[function(e,t,o){"use strict";cc._RF.push(t,"3da261D+gxD06aKnwOayi1G","MailView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../utils/GameTools"),c=e("../../common/PlayerModule"),l=e("../../modules/base/Decorators"),d=e("../../network/protocol/TypeProtocols"),u=e("../../utils/GameUtils"),h=e("./MailUtils"),p=e("../../StaticData/LuckyGiftSelectTableData"),f=e("../../modules/base/GameView"),g=cc._decorator,m=g.ccclass,_=g.property,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.mailScroll=null,t.mailPrefab=null,t.lableTip=null,t.m_selfSelect_selectIndex=0,t}return a(t,e),t.path=function(){return"ui/mail/mail_main"},t.prototype.start=function(){this.initMailView()},t.prototype.initMailView=function(){var e=this,t=[],o=c.default.getRoleMailData();Array.from(o.keys(),function(e){t.push(e)}),s.default.startFraming(t.length,function(i){var a=o.get(t[i]);e.createMailTemplate(a)}),t.length<=0?this.lableTip.active=!0:this.lableTip.active=!1},t.prototype.createMailTemplate=function(e){var t=this,o=cc.instantiate(this.mailPrefab);o.parent=this.mailScroll.content,o.active=!0,o.mailUUID=e.mailUUID,o.getChildByName("title").getComponent(cc.Label).string=e.title,o.getChildByName("content").getComponent(cc.Label).string=e.msg,o.getChildByName("content").getComponent(cc.Label)._forceUpdateRenderData();var i=o.getChildByName("content").height;o.height=i+55,o.height<135&&(o.height=135);var a=o.getChildByName("btn_get"),n=o.getChildByName("btn_remove");e.annex.annex.length>0?(a.active=!0,a.mailUUID=e.mailUUID,a.mailID=e.mailId,s.default.registerTouchEvent(a,function(e){t.sendEvent("SendReceiveMailAnnex",e.target.mailUUID),1001!=e.target.mailID&&1004!=e.target.mailID||u.setLocalData("PopSeasonEnd","0")})):(n.active=!0,n.mailUUID=e.mailUUID,s.default.registerTouchEvent(n,function(e){t.sendEvent("SendDeleteReadMail",e.target.mailUUID)}));var r=c.default.getServersTime()-e.createTime,l=Math.floor(r/86400),h=Math.floor(r/3600),p=Math.floor(r%3600/60);p<=0&&(p=1);var f;f=l>0?l+"\u5929\u524d":h>0?h+"\u5c0f\u65f6"+p+"\u5206\u524d":p+"\u5206\u524d",o.getChildByName("time").getComponent(cc.Label).string=f,e.state==d.MAIL_STATE.MAIL_STATE_UNREAD&&this.sendEvent("SendReadMail",e.mailUUID)},t.prototype.doReceiveMailAnnex=function(e){this.sendEvent("SendReceiveMailAnnex",e.mailUUID),1001!=e.mailID&&1004!=e.mailID||u.setLocalData("PopSeasonEnd","0")},t.prototype.refreshMailListView=function(e){this.mailScroll.content.children.forEach(function(t){1==t.mailUUID.equals(e)&&(t.active=!1)})},t.prototype.doSelfSelect=function(e){this.m_selfSelect_mailData=e,this.m_selfSelect_selectIndex=0,this.m_selfSelect_selectIdList=[],this.openSelect()},t.prototype.openSelect=function(){var e=h.default.getInstance().getSelfSelectBoxItemIdList(this.m_selfSelect_mailData);if(null!=e&&e.length>0)if(this.m_selfSelect_selectIndex<e.length){var t=u.getConfigIntValue("activity_daily_chaozhi_choose"),o=p.LuckyGiftSelectTableData.getById(Number(t)).prize;f.default.addPopView("BaseCtrl","LuckyGiftSelectRewardView","LuckyGiftSelectRewardView",{tRewards:o,index:1,isEveryDayReacharge:!0,parent:this}),this.m_selfSelect_selectIndex++}else{var i={};i.mailUUID=this.m_selfSelect_mailData.mailUUID,i.pSelfSelectItemIds=this.m_selfSelect_selectIdList,this.sendEvent("SendReceiveMailAnnexWithSelfSelect",i)}else console.log("mail get error:  no self select box!!!")},t.prototype.showSecectRwd=function(e){var t=this;this.m_selfSelect_selectIdList.push(e),setTimeout(function(){t.openSelect()},.5)},n([_(cc.ScrollView)],t.prototype,"mailScroll",void 0),n([_(cc.Node)],t.prototype,"mailPrefab",void 0),n([_(cc.Node)],t.prototype,"lableTip",void 0),n([l.Register_Class,m],t)}(r.default);o.default=y,cc._RF.pop()},{"../../StaticData/LuckyGiftSelectTableData":"LuckyGiftSelectTableData","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/base/GameView":"GameView","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils","./MailUtils":"MailUtils"}],MainSceneMap1:[function(e,t,o){"use strict";cc._RF.push(t,"278fcUhFOpBgaXkdJlODgGa","MainSceneMap1");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,s=r.ccclass,c=r.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.bgSpeed=0,t.skySpeed=0,t.cloudSpeed=0,t.bgArr=[],t.skyArr=[],t.cloudImage=null,t.curBg=null,t.nextBg=null,t.curIndex=0,t.curSky=null,t.nextSky=null,t.curSkyIndex=0,t._scaleX=0,t}return a(t,e),t.prototype.start=function(){if(0!=this.bgArr.length&&0!=this.skyArr.length){this.curBg=this.bgArr[this.curIndex],this.nextBg=this.bgArr[this.curIndex+1];var e=cc.view.getVisibleSize(),t=e.width/1440;e.height,this.curBg.scaleX=t,this.nextBg.scaleX=t,this._scaleX=t,this.node.children[0].scaleX=t,this.curSky=this.skyArr[this.curSkyIndex],this.nextSky=this.skyArr[this.curSkyIndex+1],this.nextSky.scaleX=t,this.curSky.scaleX=t,this.setBgPosition(),this.setSkyPosition(),this.cloudImage.x=0}},t.prototype.setBgPosition=function(){this.bgArr[this.curIndex].x=0,this.bgArr[this.curIndex+1].x=this.curBg.width*this._scaleX/2+this.nextBg.width*this._scaleX/2},t.prototype.setSkyPosition=function(){this.skyArr[this.curSkyIndex].x=0,this.skyArr[this.curSkyIndex+1].x=this.curSky.width*this._scaleX/2+this.nextSky.width*this._scaleX/2},t.prototype.update=function(){var e=cc.view.getFrameSize().width,t=cc.view.getFrameSize().height;e<t?console.log("\u5df2\u7ecf\u662f\u7ad6\u5c4f,\u65e0\u9700\u4fee\u6539!",e,t):(this.bgMove(),this.skyMove(),this.cloudMove())},t.prototype.cloudMove=function(){this.cloudImage.x-=this.cloudSpeed,this.cloudImage.x<-this.curBg.width*this._scaleX&&(this.cloudImage.x=this.curBg.width*this._scaleX)},t.prototype.bgMove=function(){this.curBg.x-=this.bgSpeed,this.nextBg.x-=this.bgSpeed,this.curBg.x<=-this.curBg.width*this._scaleX&&(this.curBg=this.nextBg,this.nextBg=this.bgArr[this.curIndex++%this.bgArr.length],this.nextBg.x=this.curBg.x+this.curBg.width*this._scaleX/2+this.nextBg.width*this._scaleX/2)},t.prototype.skyMove=function(){this.curSky.x-=this.skySpeed,this.nextSky.x-=this.skySpeed,this.curSky.x<=-this.curSky.width*this._scaleX&&(this.curSky=this.nextSky,this.nextSky=this.skyArr[this.curSkyIndex++%this.skyArr.length],this.nextSky.x=this.curSky.x+this.curSky.width*this._scaleX/2+this.nextSky.width*this._scaleX/2)},n([c({displayName:"\u80cc\u666f\u64ad\u653e\u901f\u5ea6"})],t.prototype,"bgSpeed",void 0),n([c({displayName:"\u5929\u7a7a\u64ad\u653e\u901f\u5ea6"})],t.prototype,"skySpeed",void 0),n([c({displayName:"\u5929\u7a7a\u4e91\u64ad\u653e\u901f\u5ea6"})],t.prototype,"cloudSpeed",void 0),n([c({displayName:"\u80cc\u666f\u56fe",type:cc.Node})],t.prototype,"bgArr",void 0),n([c({displayName:"\u4e2d\u95f4\u56fe",type:cc.Node})],t.prototype,"skyArr",void 0),n([c({displayName:"\u5929\u7a7a\u4e91\u56fe",type:cc.Node})],t.prototype,"cloudImage",void 0),n([s],t)}(cc.Component);o.default=l,cc._RF.pop()},{}],MainSceneMap2:[function(e,t,o){"use strict";cc._RF.push(t,"8faddVvz7NCRK7anCoY+tX1","MainSceneMap2");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,s=r.ccclass,c=r.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.bgSpeed=0,t.skySpeed=0,t.bgArr=[],t.skyArr=[],t.curBg=null,t.nextBg=null,t.curIndex=0,t.curSky=null,t.nextSky=null,t.curSkyIndex=0,t._scaleX=0,t}return a(t,e),t.prototype.start=function(){if(0!=this.bgArr.length&&0!=this.skyArr.length){this.curBg=this.bgArr[this.curIndex],this.nextBg=this.bgArr[this.curIndex+1];var e=cc.view.getVisibleSize(),t=e.width/1440;e.height,this.curBg.scaleX=t,this.nextBg.scaleX=t,this._scaleX=t,this.curSky=this.skyArr[this.curSkyIndex],this.nextSky=this.skyArr[this.curSkyIndex+1],this.nextSky.width=this.curBg.width*this._scaleX,this.curSky.width=this.nextBg.width*this._scaleX,this.setBgPosition(),this.setSkyPosition()}},t.prototype.setBgPosition=function(){this.bgArr[this.curIndex].x=0,this.bgArr[this.curIndex+1].x=this.curBg.width*this._scaleX/2+this.nextBg.width*this._scaleX/2},t.prototype.setSkyPosition=function(){this.skyArr[this.curSkyIndex].x=0,this.skyArr[this.curSkyIndex+1].x=this.curSky.width/2+this.nextSky.width/2},t.prototype.update=function(){var e=cc.view.getFrameSize().width,t=cc.view.getFrameSize().height;e<t?console.log("\u5df2\u7ecf\u662f\u7ad6\u5c4f,\u65e0\u9700\u4fee\u6539!",e,t):(this.bgMove(),this.skyMove())},t.prototype.bgMove=function(){this.curBg.x-=this.bgSpeed,this.nextBg.x-=this.bgSpeed,this.curBg.x<=-this.curBg.width*this._scaleX&&(this.curBg=this.nextBg,this.nextBg=this.bgArr[this.curIndex++%this.bgArr.length],this.nextBg.x=this.curBg.x+this.curBg.width*this._scaleX/2+this.nextBg.width*this._scaleX/2)},t.prototype.skyMove=function(){this.curSky.x-=this.skySpeed,this.nextSky.x-=this.skySpeed,this.curSky.x<=-this.curSky.width&&(this.curSky=this.nextSky,this.nextSky=this.skyArr[this.curSkyIndex++%this.skyArr.length],this.nextSky.x=this.curSky.x+this.curSky.width/2+this.nextSky.width/2)},n([c({displayName:"\u80cc\u666f\u64ad\u653e\u901f\u5ea6"})],t.prototype,"bgSpeed",void 0),n([c({displayName:"\u5929\u7a7a\u64ad\u653e\u901f\u5ea6"})],t.prototype,"skySpeed",void 0),n([c({displayName:"\u80cc\u666f\u56fe",type:cc.Node})],t.prototype,"bgArr",void 0),n([c({displayName:"\u5929\u7a7a\u56fe",type:cc.Node})],t.prototype,"skyArr",void 0),n([s],t)}(cc.Component);o.default=l,cc._RF.pop()},{}],MainSceneMap703:[function(e,t,o){"use strict";cc._RF.push(t,"edb94wnnHtO8ICvh4Co/cPR","MainSceneMap703");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../utils/GameTools"),s=cc._decorator,c=s.ccclass,l=s.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.oceanNode=null,t.skyNode=null,t.IslandNode=null,t.IslandNodeSpeed=0,t.cloudNode=null,t._scaleX=0,t}return a(t,e),t.prototype.start=function(){var e=this,t=cc.view.getVisibleSize(),o=t.width/1440;t.height,this.oceanNode.scaleX=o,this.skyNode.scaleX=o,this._scaleX=o;var i=r.default.getRandomInt(1,this.skyNode.width*this.skyNode.scaleX);this.IslandNode.active=!0,this.IslandNode.x=1.5*i,this.cloudNode.active=!0,this.cloudNode.getComponent(sp.Skeleton).setAnimation(0,"idle1",!1),this.schedule(function(){var t="idle"+r.default.getRandomInt(1,4);e.cloudNode.getComponent(sp.Skeleton).setAnimation(0,t,!1)},125)},t.prototype.islandMove=function(){if(this.IslandNode.x-=this.IslandNodeSpeed,this.IslandNode.x<-this.skyNode.width*this._scaleX){var e=r.default.getRandomInt(1,this.skyNode.width);this.IslandNode.x=this.skyNode.width*this._scaleX*2+e}},t.prototype.update=function(){var e=cc.view.getFrameSize().width,t=cc.view.getFrameSize().height;e<t?console.log("\u5df2\u7ecf\u662f\u7ad6\u5c4f,\u65e0\u9700\u4fee\u6539!",e,t):this.islandMove()},t.prototype.onDestroy=function(){this.unscheduleAllCallbacks()},n([l({displayName:"\u5927\u6d77\u56fe",type:cc.Node})],t.prototype,"oceanNode",void 0),n([l({displayName:"\u5929\u7a7a\u56fe",type:cc.Node})],t.prototype,"skyNode",void 0),n([l({displayName:"\u6d77\u5c9b",type:cc.Node})],t.prototype,"IslandNode",void 0),n([l({displayName:"\u6d77\u5c9b\u79fb\u52a8\u901f\u5ea6"})],t.prototype,"IslandNodeSpeed",void 0),n([l({displayName:"\u5929\u7a7a\u4e91",type:cc.Node})],t.prototype,"cloudNode",void 0),n([c],t)}(cc.Component);o.default=d,cc._RF.pop()},{"../utils/GameTools":"GameTools"}],MainSceneMap704:[function(e,t,o){"use strict";cc._RF.push(t,"7c9d2PBz4FAGq3mAmy1ZB1y","MainSceneMap704");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,s=r.ccclass,c=r.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.sceneArrNode=[],t.moveSpeed=0,t.m_tSceneArr=new Array,t.m_bStartMove=!1,t}return a(t,e),t.prototype.onLoad=function(){var e=this;this.sceneArrNode.forEach(function(t,o,i){t.y-=100;var a;(a=0==o?i[i.length-1]:i[o-1])&&e.m_tSceneArr.push({sceneNode:t,sceneHeadNode:a})})},t.prototype.start=function(){var e=this,t=cc.view.getVisibleSize(),o=t.width/1440,i=t.height/720;o>1&&(this.node.scaleX=o),this.node.scaleY=i,this.node.getChildByName("tiankongfg2").scaleX=o,this.node.getChildByName("tiankongfg1").scaleX=o,this.node.x=-cc.view.getVisibleSize().width/2,this.scheduleOnce(function(){e.m_bStartMove=!0},.2)},t.prototype.sceneMove=function(){var e=this;this.m_tSceneArr.forEach(function(t){var o=t.sceneNode;o.x-=e.moveSpeed,o.x-2<-o.width&&(o.x=t.sceneHeadNode.x+t.sceneHeadNode.width-2)})},t.prototype.update=function(){0!=this.m_bStartMove&&this.sceneMove()},n([c({displayName:"\u62fc\u63a5\u573a\u666f\u8282\u70b9",type:cc.Node})],t.prototype,"sceneArrNode",void 0),n([c({displayName:"\u79fb\u52a8\u901f\u5ea6"})],t.prototype,"moveSpeed",void 0),n([s],t)}(cc.Component);o.default=l,cc._RF.pop()},{}],MainSceneMap705:[function(e,t,o){"use strict";cc._RF.push(t,"8e2e08tz7tAPKR6Kch7+2++","MainSceneMap705");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,s=r.ccclass,c=r.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.bgArr=[],t.midShotBgArr=[],t.longShotBgArr=[],t._scaleX=0,t.bgSpeed=10,t.curmidShotBgSpeed=20,t.curlongShotSpeed=150,t}return a(t,e),t.prototype.start=function(){var e=cc.view.getVisibleSize();this.node.x=-e.width/2;var t=e.width/1440;e.height,t>1?(this.longShotBgArr[0].scaleX=t,this.longShotBgArr[1].scaleX=t,this.longShotBgArr[0].x=0,this.longShotBgArr[1].x=this.longShotBgArr[0].width*t,this.midShotBgArr[0].scaleX=t,this.midShotBgArr[1].scaleX=t,this.midShotBgArr[0].x=0,this.midShotBgArr[1].x=this.midShotBgArr[0].width*t,this.bgArr[0].scaleX=t,this.bgArr[1].scaleX=t,this.bgArr[0].x=0,this.bgArr[1].x=this.bgArr[0].width*t,this._scaleX=t):this._scaleX=1},t.prototype.showPlayEffect=function(){},t.prototype.update=function(e){var t=this.bgSpeed*e;this.bgArr[0].x-=t,this.bgArr[1].x-=t,this.bgArr[0].x<-this.bgArr[0].width*this._scaleX&&(this.bgArr[0].x=this.bgArr[1].x+this.bgArr[1].width*this._scaleX),this.bgArr[1].x<-this.bgArr[1].width*this._scaleX&&(this.bgArr[1].x=this.bgArr[0].x+this.bgArr[0].width*this._scaleX);var o=this.curmidShotBgSpeed*e;this.midShotBgArr[0].x-=o,this.midShotBgArr[1].x-=o,this.midShotBgArr[0].x<-this.midShotBgArr[0].width*this._scaleX&&(this.midShotBgArr[0].x=this.midShotBgArr[1].x+this.midShotBgArr[1].width*this._scaleX),this.midShotBgArr[1].x<-this.midShotBgArr[1].width*this._scaleX&&(this.midShotBgArr[1].x=this.midShotBgArr[0].x+this.midShotBgArr[0].width*this._scaleX);var i=this.curlongShotSpeed*e;this.longShotBgArr[0].x-=i,this.longShotBgArr[1].x-=i,this.longShotBgArr[0].x<-this.longShotBgArr[0].width*this._scaleX&&(this.longShotBgArr[0].x=this.longShotBgArr[1].x+this.longShotBgArr[1].width*this._scaleX),this.longShotBgArr[1].x<-this.longShotBgArr[1].width*this._scaleX&&(this.longShotBgArr[1].x=this.longShotBgArr[0].x+this.longShotBgArr[0].width*this._scaleX)},n([c({displayName:"\u80cc\u666f\u56fe",type:cc.Node})],t.prototype,"bgArr",void 0),n([c({displayName:"\u4e2d\u666f\u56fe",type:cc.Node})],t.prototype,"midShotBgArr",void 0),n([c({displayName:"\u8fdc\u666f\u56fe",type:cc.Node})],t.prototype,"longShotBgArr",void 0),n([s],t)}(cc.Component);o.default=l,cc._RF.pop()},{}],MainSceneView:[function(e,t,o){"use strict";cc._RF.push(t,"1d3cc7X1bhAL5Wd3Vch8ZbB","MainSceneView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../utils/Tools"),s=e("../Global/GameGlobal"),c=e("../Global"),l=e("../common/CombatModule"),d=e("../network/LocalMessage"),u=e("../network/ClientNetwork"),h=e("../utils/UIManager"),p=e("../common/PlayerModule"),f=e("../utils/GameLoading"),g=e("../utils/GameUtils"),m=e("../network/protocol/TypeProtocols"),_=e("../utils/GameTools"),y=e("../modules/base/GameView"),v=e("./drawcard/DrawCardMainCtrl"),C=e("./drawcard/DrawCardMainView"),S=e("../modules/base/BaseView"),T=e("../modules/base/Decorators"),I=e("../modules/manager/LoadResManager"),N=e("../utils/LogUtil"),b=e("../combat/CombatManager"),w=e("../StaticData/StringValueTableData"),E=e("../utils/ConstValue"),P=e("./task/TaskView"),R=e("../network/protocol/RoleProtocols"),L=e("./friend/FriendMainView"),A=e("../controller/Guide/GuideConfig/GuideConst"),D=e("../StaticData/LegendTableData"),M=e("../../load"),B=e("../utils/WechatUtils"),k=e("../StaticData/TaskTableData"),G=e("../StaticData/BattlePassTableData"),O=e("../utils/GamePlatform"),H=e("../StaticData/ActivityTableData"),V=e("../network/protocol/ActivityProtocols"),F=e("../view/activity/ActivityModule"),U=e("./legend/vos/VOLegendControl"),x=e("../utils/QQMiniGameUtils"),Y=e("../modules/manager/ViewManager"),j=e("./playerInfo/PlayerInfoView"),W=e("../utils/ByteDanceMiniGameUtils"),z=e("../common/EventConst"),K=e("../modules/manager/EventManager"),q=e("./sociaty/SociatyModel"),Q=e("./sociaty/SociatyCtrl"),X=e("../utils/ConfigUtils"),J=e("../utils/QQGameHallUtils"),Z=e("../common/CommandValue"),$=e("./pushGift/PushGiftUtils"),ee=e("../utils/TimeOffSetManager"),te=e("../utils/LeniuGameUtils"),oe=e("../StaticData/OnOffTableData"),ie=e("../utils/KSMinigameUtils"),ae=e("../StaticData/ProficiencyTableData"),ne=e("../StaticData/ChatChannelTableData"),re=e("../network/protocol/RoleProtocols"),se=e("./skyCastle/SkyCastleModule"),ce=e("./skyCastle/SkyCastleUtils"),le=e("../StaticData/LuckyGiftSelectTableData"),de=e("./task/TaskDayView"),ue=e("./advertisingGifts/AdvertisingGiftsMengXinView"),he=e("./advertisingGifts/AdvertisingGiftsGuangGaoView"),pe=e("./heroCardBag/HeroSkinUtils"),fe=e("./anniversary/AnniversaryModule"),ge=e("./fogHidden/FogHiddenModel"),me=e("../StaticData/RoleScoreFundTableData"),_e=e("./pushGift/NewerThreeDaysGiftUtils"),ye=e("./machineryCityActivity/MachineryCityModel"),ve=e("./machineryCityActivity/MachineryCityCtrl"),Ce=["jaAeaNiRfny2MqT2NIB02x8qFAv_z0xdgrJBbwyG5fQ","NHgawrB3EuAggxvzv6qW_LVAYrIqA-SX7d9eWXsuErs"],Se=cc._decorator,Te=Se.ccclass,Ie=(Se.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._bHaveShopFreeItem=!1,t._firstRechargeIsRedpoint=!1,t.tNeedRefreshPointNodeArr=new Array,t}return a(t,e),t.path=function(){return"ui/mainScene/mainView"},t.prototype.onLoad=function(){var e=this,t=this.node.getChildByName("UI_Root"),o=t.getChildByName("RightNode"),i=t.getChildByName("LeftNode"),a=t.getChildByName("LeftDownNode"),n=t.getChildByName("RightDownNode"),r=t.getChildByName("TopLeftNode");if(this._activityNode=i.getChildByName("wudaohui"),this._laissezPasserNode=a.getChildByName("laissezPasser"),this._shopNode=i.getChildByName("shop"),this._heroNode=o.getChildByName("hero"),this._taskNode=i.getChildByName("task"),this._pvpNode=n.getChildByName("pvp"),this._soloNode=n.getChildByName("solo"),this._uuid=this.node.getChildByName("playerUUID"),this._playerName=r.getChildByName("nameNode").getChildByName("name").getComponent(cc.Label),this._playerCup=r.getChildByName("nameNode").getChildByName("cup").getComponent(cc.Label),this._coopTimesLabel=this._pvpNode.getChildByName("cup").getComponent(cc.Label),this._drawCardNode=o.getChildByName("drawcard"),this._selectCardNode=o.getChildByName("jinka"),this._legendNode=a.getChildByName("road"),this._advertisingGiftsNode=r.getChildByName("AdvertisingGifts"),this.tNeedRefreshPointNodeArr.push(this._advertisingGiftsNode),this._inviteFriendNode=r.getChildByName("InviteFriend"),this.tNeedRefreshPointNodeArr.push(this._inviteFriendNode),this._activityFirstRecharge=r.getChildByName("activityFirstRecharge"),this._activityFirstRecharge.active=!0,this.tNeedRefreshPointNodeArr.push(this._activityFirstRecharge),this.m_btn_pushGift=r.getChildByName("btn_pushGift"),this.m_btn_pushGift.active=!1,this.tNeedRefreshPointNodeArr.push(this.m_btn_pushGift),this.m_btn_newerGift=r.getChildByName("btn_newerGift"),this.tNeedRefreshPointNodeArr.push(this.m_btn_newerGift),this._moreNode=t.getChildByName("TopRightNode").getChildByName("morebtn"),this._ranklist=this._moreNode.getChildByName("btn_ranklist"),this._friendNode=this._moreNode.getChildByName("friend"),this._gameclub=this._moreNode.getChildByName("gameclub"),this._channelsLiveNode=this._moreNode.getChildByName("channelsLive"),this._chatMainMsgNode=o.getChildByName("btn_chat").getChildByName("msgNode"),this._playerHeadNode=r.getChildByName("clickNode"),this._redpoint_head=this._playerHeadNode.getChildByName("redpoint_head"),this._playerNameNode=r.getChildByName("nameNode"),this._btn_uniton=o.getChildByName("btn_union"),this.m_skyCastleNode=a.getChildByName("skyCastle"),this.m_royaleNode=a.getChildByName("royaleBtnNode"),this.m_AnniversaryNode=a.getChildByName("AnniversaryNode"),this.m_FogHiddenNode=a.getChildByName("FogHiddenNode"),this.m_MachineryCityNode=a.getChildByName("MachineryCityNode"),this.m_btn_userProtocol=this._moreNode.getChildByName("btn_userProtocol"),this.m_btn_PrivacyProtocol=this._moreNode.getChildByName("btn_privacyPotocol"),O.GamePlatform.isQQMiniGame()||O.GamePlatform.isQQGameRoom()||O.GamePlatform.isKuaishouMiniGame()?this.m_btn_userProtocol.active=this.m_btn_PrivacyProtocol.active=!0:this.m_btn_userProtocol.active=this.m_btn_PrivacyProtocol.active=!1,O.GamePlatform.isQQMiniGame())if(p.default.getRoleAttrValByKey(m.ROLE_ATTR_VALUES.ROLE_ATTR_GUIDE)<A.default.BattleSecondGuide.guideId&&0==c.default.Instance.jumpGuide);else{var s=qq.getLaunchOptionsSync().query;if(s.act&&"coupons"==s.act){var l=[];Array.from(p.default.getRoleTaskData().tasks.values()).forEach(function(e){var t=k.TaskTableData.getById(e.taskID);t&&58==t.clientType&&l.push(e)}),l.length>0&&(k.TaskTableData.getById(l[0].taskID),l[0].taskState==m.TASK_STATE.TASK_STATE_FINISH&&c.default.Instance._isShowQQExchange||y.default.addPopView("BaseCtrl","QQExchange","QQExchange"))}}this.m_btnQQHall=r.getChildByName("btn_qqhall"),this.m_btnQQBlue=r.getChildByName("btn_qqblue"),this.m_QQHallIconNode=r.getChildByName("clickNode").getChildByName("bluevip"),this.m_btn_addShortcut=i.getChildByName("btn_addShortcut"),this.m_btn_addCollect=i.getChildByName("btn_addCollect"),this.checkAddShortcutButton(),this.checkAddCollectButton(),this.freshQQHallVipIcon(),this.setMengXinCountDown(),this.onNodeEvent(),this.onlistenLocalMessage(),this.onCheckFightResult(),this.refreshEveryDayRechargeRedPoint(),M.getSubmitReviewShopState()&&(cc.sys.os==cc.sys.OS_IOS||M.getQQMiniGameSubmitReviewShopState()||M.getByteDanceSubmitReviewShopState())&&(this._shopNode.active=!1,this._laissezPasserNode.active=!1,this._activityFirstRecharge.active=!1),(O.GamePlatform.getMiYa()||O.GamePlatform.IsSmallBag())&&(this._inviteFriendNode.active=!1,this._activityFirstRecharge.getComponent(cc.Widget).left=373,this._channelsLiveNode.active=!1,this._gameclub.active=!1),(O.GamePlatform.isQQMiniGame()||O.GamePlatform.isByteDanceMiniGame()||O.GamePlatform.isKuaishouMiniGame())&&(this._channelsLiveNode.active=!1,this._gameclub.active=!1),(O.GamePlatform.isQQGameRoom()||O.GamePlatform.IsH5SmallBag()||O.GamePlatform.IsMiYaIosH5()||O.GamePlatform.IsDysbSmallBag()||O.GamePlatform.Is5Add7SmallBag()||O.GamePlatform.is_meituan)&&(this._advertisingGiftsNode.active=!1,this._inviteFriendNode.getComponent(cc.Widget).left=266,this._activityFirstRecharge.getComponent(cc.Widget).left=373,this._channelsLiveNode.active=!1,this._gameclub.active=!1,this._inviteFriendNode.active=!1),O.GamePlatform.isWechat(),O.GamePlatform.isByteDanceMiniGame()&&(W.default.getInstance().createKefuBtn(),M.getSubmitReviewState()&&(this._advertisingGiftsNode.active=!1)),this.forceCheckGame(),this.sendTotalCarHpToServar(),M.getSubmitReviewState()&&O.GamePlatform.isQQMiniGame()&&(this._inviteFriendNode.active=!1),this.tNeedRefreshPointNodeArr.forEach(function(t){t.on("active-in-hierarchy-changed",e.refreshTopNodePoint,e)})},t.prototype.refreshTopNodePoint=function(){var e=0;this.tNeedRefreshPointNodeArr.forEach(function(t){var o=null;t.getComponent(cc.Widget)?o=t.getComponent(cc.Widget):(o=t.addComponent(cc.Widget)).isAlignLeft=!0,1==t.active&&o&&(o.left=265+85*e,o.updateAlignment(),e++)})},t.prototype.freshQQHallVipIcon=function(){0==O.GamePlatform.isQQGameRoom()?(this.m_btnQQHall.active=this.m_btnQQBlue.active=!1,this.m_QQHallIconNode.active=!1):(this.m_btnQQHall.active=this.m_btnQQBlue.active=!0,this.m_QQHallIconNode.active=!0,J.QQGameHallUtils.setBlueIcon(this.m_QQHallIconNode.getChildByName("icon"),!1,J.QQGameHallUtils.isBlueVip(),J.QQGameHallUtils.isBlueVipYear(),J.QQGameHallUtils.getBlueVipLv(),J.QQGameHallUtils.isBlueVipSuper()),J.QQGameHallUtils.setBlueIcon(this.m_QQHallIconNode.getChildByName("year"),!0,J.QQGameHallUtils.isBlueVip(),J.QQGameHallUtils.isBlueVipYear(),J.QQGameHallUtils.getBlueVipLv(),J.QQGameHallUtils.isBlueVipSuper()))},t.prototype.getShopNodeShowState=function(){return this._shopNode.active},t.prototype.onEnable=function(){var e=this;this.schedule(function(){e.onSeasonCloseing();var t=F.default.checkActivityIsOpen(V.ACTIVITY_ID_ENUM.P_Activity_WuDaoHui),o=F.default.checkActivityIsOpen(V.ACTIVITY_ID_ENUM.P_Activity_ChickenDinner);1==o&&(o=p.default.checkModulerOnOffState(Z.ModulerViewOnOff.ChickenDinnerView));var i=F.default.getChickenDinnerData();if(i){var a=H.ActivityTableData.getById(V.ACTIVITY_ID_ENUM.P_Activity_ChickenDinner);if(1==t&&0==F.default.ClickGoldenLeagueState||1==o&&0==F.default.ClickChickenDinnerState&&i.count<a.param3)return e._activityNode.children[0].active=!0;e._activityNode.children[0].active=!1}},5)},t.prototype.init=function(){var e=this;(O.GamePlatform.isWechat()||O.GamePlatform.isQQMiniGame())&&(this.node.active=!0,this.onWXSendUserCloudStorage(),this.onSyncChangeLiveTaskData(),this.scheduleOnce(function(){var t=e.node.getChildByName("UI_Root");if(t.width<t.height){var o=[];o[0]=t.width,o[1]=t.height,O.GamePlatform.reportWXLog(o),e._topViewNode?t.setContentSize(e._topViewNode.width,e._topViewNode.height):t.setContentSize(1280,720)}},2)),cc.resources.preload("ui/shop/prefab/shop_main"),u.ClientNetwork.getInstance().pushLocalMessage(d.LOCAL_MESSAGE.LocalMsg_START_GUIDE,A.default.MatchingGuide.guideId),this.refreshTopNodePoint()},t.prototype.start=function(){var e=this,t=new R.C_Role_Get_Server_Time;u.ClientNetwork.getInstance().Send(R.ROLE_CLIENT_ENUM.P_Role_Get_Server_Time,t),O.GamePlatform.isWechat()&&(this.node.active=!1,B.WechatUtils.getInstance().wxGetGameLiveState()&&B.WechatUtils.getInstance().wxSyncLiveTimeUpdate()),this._playerCup.string=p.default.getRoleAttrValByKey(m.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE),"bigBlue"!=O.GamePlatform.getMiYaVideoTypeNoSet()&&"ly5add7"!=O.GamePlatform.getMiYaVideoTypeNoSet()||O.GamePlatform.sendInfoGame("lvUp"),te.LeniuGameUtils.Instance.reportPlayerInfo(),this.onShowPlayerName(),this.onRefreshCoopTimes(),r.playAudioMusic("music/mainuibg"),I.default.loadPrefab("ui/CommonPrefab/TopView").then(function(t){t.parent=e.node,t.getChildByName("ExitButton").active=!1,e._topViewNode=t}).catch(function(e){N.default.info(e)}),I.default.loadPrefab("ui/mainScene/ChatNode").then(function(t){t.parent=e.node.getChildByName("UI_Root"),e._chatNode=t;var o=t.getChildByName("chatMain").getComponent("ChatMainView");o.setShowChannelTab([m.CHAT_CHANNEL_GROUP_TYPE.CHAT_CHANNEL_PRIVATE_GROUP,m.CHAT_CHANNEL_GROUP_TYPE.CHAT_CHANNEL_SYSTEM_GROUP,m.CHAT_CHANNEL_GROUP_TYPE.CHAT_CHANNEL_WORLD_GROUP]),o.setChatChannel(1),o.hideAllChannelList(),t.active=!1,e.onShowChatRedpoint()}).catch(function(e){N.default.info(e)}),cc.resources.preload("ui/advertising_gifts/prefab/AdvertisingGifts"),cc.resources.preload("ui/chaunqi/prefab/ChuanQi"),cc.resources.preload("ui/battle_pass/prefab/BattlePass"),this.onShowPlayerHead(),this.onShowPlayerHeadFrame(),this.onSeasonCloseing(),this.onCheckReportedCarHpTask(),p.default.syncClientTaskUpdateCountToServer(10,!1),p.default.syncClientTaskUpdateCountToServer(11,!1),O.GamePlatform.isWechat()&&B.WechatUtils.getInstance().checkInviteInfo(null),O.GamePlatform.isQQMiniGame()&&x.QQMiniGameUtils.getInstance().checkInviteInfo(null),O.GamePlatform.isByteDanceMiniGame()&&W.default.getInstance().checkInviteInfo(null),O.GamePlatform.isQQGameRoom()&&J.QQGameHallUtils.getInstance().checkInviteInfo(null),O.GamePlatform.isKuaishouMiniGame()&&ie.KSMinigameUtils.getInstance().checkInviteInfo(null);var o=0;this.schedule(function(){switch(o){case 0:if(M.getSubmitReviewShopState()&&(cc.sys.os==cc.sys.OS_IOS||M.getQQMiniGameSubmitReviewShopState()||M.getByteDanceSubmitReviewShopState()));else{var e=new V.C_Activity_GetDayPrizeData;e.activityID=V.ACTIVITY_ID_ENUM.P_Activity_FristRecharge,u.ClientNetwork.getInstance().Send(V.ACTIVITY_CLIENT_ENUM.P_Activity_GetDayPrizeData,e,!1)}break;case 1:var t=new R.C_Role_SyncDrawPrize;u.ClientNetwork.getInstance().Send(R.ROLE_CLIENT_ENUM.P_Role_SyncDrawPrize,t,!1);break;case 2:var i=new R.C_Role_GetRandShop;i.shopID=1,u.ClientNetwork.getInstance().Send(R.ROLE_CLIENT_ENUM.P_Role_GetRandShop,i,!1)}o++},.5,2,0),this.onCheckRePay(),this.chickShowChickResultData(),this.onCallSociatyRedPoint(),this.schedule(function(){Q.default.updateTimer()},2),this.checkPushGiftBtn(),this.checkNewerGiftBtn(),this.onCheckModuleViewOnOffEvent(),this.checkCallChatCount(),this.m_skyCastleNode.active=se.default.Instance.checkSkyCastleOpenState(),this.checkRoyaleNodeVisible(),this.m_AnniversaryNode.active=fe.default.Instance.checkAnniversaryOpenState(),this.m_AnniversaryNode.children[0].active=fe.default.Instance.checkAnniversaryRedpointState(),this.m_FogHiddenNode.active=ge.default.Instance.getFogHiddenButtonActiveState(),this.m_FogHiddenNode.children[0].active=ge.default.Instance.checkFogHiddenRedpointState(),this.m_MachineryCityNode.active=ye.default.Instance.getMachineryCityIsOpen(),this.m_MachineryCityNode.children[0].active=ye.default.Instance.checkMachineryCityRedpointState()},t.prototype.checkCallChatCount=function(){var e=ne.ChatChannelTableData.getById(m.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_SYSTEM).conditionMaxScore,t=p.default.getLocalScore(),o=p.default.getRoleAttrValByKey(m.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE);t!=o&&t<=e&&o>e&&_.default.callSystemCheckChatCount(o,p.default.getRoleAttrValByKey(m.ROLE_ATTR_VALUES.ROLE_ATTR_RECHARGENUM),m.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_SYSTEM);var i=Number(g.getConfigIntValue("chat_limit_cup_count"));t!=o&&t<=i&&o>i&&_.default.callSystemCheckChatCount(o,p.default.getRoleAttrValByKey(m.ROLE_ATTR_VALUES.ROLE_ATTR_RECHARGENUM),m.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_WORLD)},t.prototype.getMainChatNode=function(){return this._chatNode},t.prototype.checkNewerGiftRed=function(){var e=_e.default.Instance.getRedPoint();this.m_btn_newerGift.getChildByName("redpoint").active=e},t.prototype.checkNewerGiftBtn=function(){M.getSubmitReviewShopState()&&cc.sys.os==cc.sys.OS_IOS?this.m_btn_newerGift.active=!1:(this.unschedule(this.updateNewerGiftTime),_e.default.Instance.hasGift()?(this.m_btn_newerGift.active=!0,this.m_btn_newerGift.on(cc.Node.EventType.TOUCH_END,function(){_e.default.Instance.showGiftView()}),this.showNewerGiftTime(),this.checkNewerGiftRed()):this.m_btn_newerGift.active=!1)},t.prototype.showNewerGiftTime=function(){this.updateNewerGiftTime(),this.schedule(this.updateNewerGiftTime,1)},t.prototype.updateNewerGiftTime=function(){var e,t,o,i,a=_e.default.Instance.getEndTime()-p.default.getServersTime2();if(a<0||0==_e.default.Instance.hasGift())return this.unschedule(this.updateNewerGiftTime),void this.checkNewerGiftBtn();a<86400?(this.m_btn_newerGift.getChildByName("txt_time").getComponent(cc.Label).string=(e=1e3*a,t=Math.floor(e/36e5),o=Math.floor(e%36e5/6e4),i=Math.floor(e%6e4)/1e3,ee.TimeOffSetManager.getTimeStr(t,o,i)),this.m_btn_newerGift.getChildByName("txt_time").active=!0,this.m_btn_newerGift.getChildByName("bg_time").active=!0):(this.m_btn_newerGift.getChildByName("txt_time").active=!1,this.m_btn_newerGift.getChildByName("bg_time").active=!1)},t.prototype.checkPushGiftBtn=function(){M.getSubmitReviewShopState()&&cc.sys.os==cc.sys.OS_IOS||(this.unschedule(this.updatePushGiftTime),$.default.Instance.hasGift()?(this.m_btn_pushGift.active=!0,this.m_btn_pushGift.on(cc.Node.EventType.TOUCH_END,function(){$.default.Instance.showGiftView()}),this.showPushGiftTime()):this.m_btn_pushGift.active=!1)},t.prototype.showPushGiftTime=function(){this.updatePushGiftTime(),this.schedule(this.updatePushGiftTime,1)},t.prototype.updatePushGiftTime=function(){var e,t,o,i,a=$.default.Instance.getEntranceRemainTime()-p.default.getServersTime2();if(a<=0)return this.unschedule(this.updatePushGiftTime),void this.checkPushGiftBtn();this.m_btn_pushGift.getChildByName("txt_time").getComponent(cc.Label).string=(e=1e3*a,t=Math.floor(e/36e5),o=Math.floor(e%36e5/6e4),i=Math.floor(e%6e4)/1e3,ee.TimeOffSetManager.getTimeStr(t,o,i))},t.prototype.onWXSendUserCloudStorage=function(){var e,t;if(O.GamePlatform.isWechat()||O.GamePlatform.isQQMiniGame()){var o=function(){var e=0;return p.default.getRoleInfoData().fightData.typeData.forEach(function(t,o){2==o&&t.maxRound>e&&(e=t.maxRound)}),e}.call(this);O.GamePlatform.isWechat()?null===(e=wx.getOpenDataContext())||void 0===e||e.postMessage({event:"setScore",score:p.default.getRoleAttrValByKey(m.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE),roundNum:o,openId:B.WechatUtils.getInstance().getWechatLoginData().openid}):O.GamePlatform.isQQMiniGame()&&(null===(t=qq.getOpenDataContext())||void 0===t||t.postMessage({event:"setScore",score:p.default.getRoleAttrValByKey(m.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE),roundNum:o,openId:x.QQMiniGameUtils.getInstance().getWechatLoginData().openid}))}},t.prototype.onlistenLocalMessage=function(){var e=this;u.ClientNetwork.getInstance().listenLocalMessage(d.LOCAL_MESSAGE.LocalMsg_RootTopCreateFinshed,function(e){e[0].children[0].on(cc.Node.EventType.TOUCH_END,function(){e[1].destroy()})},this),u.ClientNetwork.getInstance().listenLocalMessage(d.LOCAL_MESSAGE.LocalMsg_itemChange_selectCard,function(){e.onRefreshSelectCardNode()},this),u.ClientNetwork.getInstance().listenLocalMessage(d.LOCAL_MESSAGE.LocalMsg_OpenPveLayer,function(){s.G.UIManager.showPopLayer(h.PrefabUrl.PveMainLayer,!0,!0,h.PopNodeTag.PveView,h.PopNodeType.FullScreen,null).then(function(t){t.parent=e.node,s.G.UIManager.addTopInfo(t)}).catch(function(e){cc.error(e)})},this),u.ClientNetwork.getInstance().listenProtocol(R.ROLE_CLIENT_ENUM.P_Role_SynRandShopData,function(t){t.resetPos();var o=new R.S_Role_SynRandShopData;o.read(t)&&1===o.shopID&&(e._bHaveShopFreeItem=o.shopData.positions.get(1).buyNum<=0,e.onShopRedpointActive())},this),u.ClientNetwork.getInstance().listenProtocol(R.ROLE_CLIENT_ENUM.P_Role_ClientTaskAddAdvert,function(t){t.resetPos();var o=new R.S_Role_ClientTaskAddAdvert;o.read(t)&&(0===o.errorcode?e.onAdvertisingGiftsRedPoint():s.G.StringManager.PopString("ClientTaskAddAdvert Error "+o.errorcode))},this),u.ClientNetwork.getInstance().listenProtocol(R.ROLE_CLIENT_ENUM.P_Role_UseChooseBox,function(t){t.resetPos();var o=new re.S_Role_UseChooseBox;o.read(t)&&0===o.errorcode&&(y.default.addPopView("BaseCtrl","AcquirePopupView","AcquirePopupView",{items:o.prize}),e.onRefreshSelectCardNode())},this),u.ClientNetwork.getInstance().listenProtocol(V.ACTIVITY_CLIENT_ENUM.P_Activity_GetDayPrizeData,function(t){if(cc.isValid(e)){var o=new V.S_Activity_GetDayPrizeData;if(o.read(t)&&o.activityID==V.ACTIVITY_ID_ENUM.P_Activity_FristRecharge){var i=!0;(1==o.isOpen&&1==o.dayPrizeNum||0==o.isOpen||o.totalDay>=3)&&(i=!1),e.onActivityFristRechargeRedpoint(i,o);var a=y.default.getViewByName("ActivityFristRechargeView");a&&a.view&&a.view.initFirstRechargeInfo(o)}}},this),u.ClientNetwork.getInstance().listenLocalMessage(d.LOCAL_MESSAGE.LocalMsg_SynRoleInformationData,function(){this.onRefreshCoopTimes(),this.freshQQHallVipIcon()},this),u.ClientNetwork.getInstance().listenLocalMessage(d.LOCAL_MESSAGE.LocalMsg_RefreshTask,function(){ue.default.initData(),e.setMengXinCountDown(),e.onAdvertisingGiftsRedPoint()},this),u.ClientNetwork.getInstance().listenLocalMessage(d.LOCAL_MESSAGE.LocalMsg_RefreshTaskBox,function(){de.default.m_LastTakeBoxTime=Number(g.getLocalData(de.default.getTakeTimeKey(),0)),e.onShowTaskRedPoint()},this),u.ClientNetwork.getInstance().listenLocalMessage(d.LOCAL_MESSAGE.LocalMsg_SyncCostGet,function(){this.onRefreshLegendRedPoint()},this),K.default.Instance.on(z.default.SociatyRefreshRedpoint,this.onRefreshSociatyRedpoint,this),K.default.Instance.on(z.default.SkyCastleRefreshRedpoint,this.onRefreshSkyCastleRedpoint,this),u.ClientNetwork.getInstance().listenLocalMessage(d.LOCAL_MESSAGE.LocalMsg_RefreshSkyCastleRed,this.onRefreshSkyCastleRedpoint,this),K.default.Instance.on(z.default.SociatyRefreshUnreadChatEvent,this.onRefreshSociatyUnreadChat,this),K.default.Instance.on(z.default.SycnClientCarHpChangeEvent,this.onCheckReportedCarHpTask,this),K.default.Instance.on(z.default.SyncRoleItemMapSkinEvent,function(){e._redpoint_head.active=e.checkHeadRedDotVisible()},this),K.default.Instance.on(z.default.SyncSkyCastleChangeType,function(){e.m_skyCastleNode.active=se.default.Instance.checkSkyCastleOpenState()},this),K.default.Instance.on(z.default.SyncChatViewChange,this.changeChatViewVisible,this),this._redpoint_head.active=this.checkHeadRedDotVisible(),u.ClientNetwork.getInstance().listenLocalMessage(d.LOCAL_MESSAGE.LocalMsg_RefreshPetRedDot,function(){var t=e.checkHeadRedDotVisible();e._redpoint_head.active=t},this),u.ClientNetwork.getInstance().listenLocalMessage(d.LOCAL_MESSAGE.LocalMsg_RefreshRedDot_heroSkin,function(){e.onRefreshHeroRedPoint()},this),K.default.Instance.on(z.default.SyncModuleViewEvent,this.onCheckModuleViewOnOffEvent,this),K.default.Instance.on(z.default.RefreshAnniversaryMainRedpoint,function(){e.m_AnniversaryNode.children[0].active=fe.default.Instance.checkAnniversaryRedpointState()},this),K.default.Instance.on(z.default.RefreshFogHiddenMainNodeInfo,function(){e.m_FogHiddenNode.active=ge.default.Instance.getFogHiddenButtonActiveState(),e.m_FogHiddenNode.children[0].active=ge.default.Instance.checkFogHiddenRedpointState()},this),K.default.Instance.on(z.default.RefreshMainPlayerCupNum,function(){e._playerCup.string=p.default.getRoleAttrValByKey(m.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE)},this),K.default.Instance.on(z.default.SociatySyncMachinariumDataEvent,function(){1!=ye.default.Instance.getICSociatyRoleGetMachinariumState()&&(y.default.getViewNodeByName("MachineryCityMainView")||y.default.addPopView("BaseCtrl","MachineryCityMainView","MachineryCityMainView"))},this),K.default.Instance.on(z.default.RefreshMachineryCityMainRedPoint,function(){e.m_MachineryCityNode.children[0].active=ye.default.Instance.checkMachineryCityRedpointState()},this),u.ClientNetwork.getInstance().listenLocalMessage(d.LOCAL_MESSAGE.LocalMsg_freshNewerGiftRed,this.checkNewerGiftRed,this),this.onShowMailRedPointNode(),this.onShowGameClubRedPointNode(),this.onShowTaskRedPoint(),this.onShowFriendRedPoint(),this.onAdvertisingGiftsRedPoint(),this.onRefreshLegendRedPoint(),this.onInviteFriendRedPoint(),this.onBattlePassRedPoint(),this.onGameNoticeRedpoint(),this.onRefreshSociatyUnreadChat(),this.onRefreshHeroRedPoint(),this.onRefreshSkyCastleRedpoint(),this.onRefreshSelectCardNode(),this.node.on(cc.Node.EventType.TOUCH_START,function(t){e._moreNode.getBoundingBoxToWorld().contains(t.getLocation())||e.hideGameClub()}),this.node._touchListener.swallowTouches=!1},t.prototype.onNodeEvent=function(){var e=this;_.default.registerTouchEvent(this._legendNode,function(){y.default.addPopView("LegendCtrl","LegendView","LegendView")}),_.default.registerTouchEvent(this._activityNode,function(){y.default.addPopView("BaseCtrl","ActivityMainView","ActivityMainView"),O.GamePlatform.isWechat()}),_.default.registerTouchEvent(this.m_btn_addShortcut,function(){O.GamePlatform.isByteDanceMiniGame()?W.default.getInstance().addToDesktop():O.GamePlatform.isQQMiniGame()&&x.QQMiniGameUtils.getInstance().addToDesktop()}),_.default.registerTouchEvent(this.m_btn_addCollect,function(){O.GamePlatform.isQQMiniGame()&&x.QQMiniGameUtils.getInstance().addToCollect()}),_.default.registerTouchEvent(this._friendNode,function(){y.default.addPopView("BaseCtrl","FriendMainView","FriendMainView"),e.hideGameClub()}),_.default.registerTouchEvent(this._shopNode,function(){y.default.addPopView("ShopMainCtrl","ShopMainView","ShopMainView")}),_.default.registerTouchEvent(this._drawCardNode,function(){y.default.addPopView(v.default,C.default,"DrawCardMainView")}),_.default.registerTouchEvent(this._selectCardNode,function(){e.onClickHeroBtn()}),_.default.registerTouchEvent(this._heroNode,function(){b.getInstance().gameState!=E.Game_State.Reconnect&&y.default.addPopView("BaseCtrl","HeroCardsMainView","HeroCardsMainView")}),_.default.registerTouchEvent(this._gameclub,function(){y.default.addPopView("BaseCtrl","GameClubView","GameClubView"),e.hideGameClub()}),_.default.registerTouchEvent(this._taskNode,function(){y.default.addPopView("BaseCtrl","TaskView","TaskView")}),_.default.registerTouchEvent(this._pvpNode,function(){var e=Number(g.getConfigIntValue("coop_score_limit"));if(p.default.getRoleAttrValByKey(m.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE)<e)return s.G.StringManager.PopWorldString(s.G.StringManager.getWorldString("coop_score_limit_tip",e));if(b.getInstance().gameState!=E.Game_State.Reconnect){if(p.default.getRoleInfoData().cooperationDayLeftNum<=0){if(p.default.getRoleInfoData().cooperationDayWatchAdNum<Number(g.getConfigIntValue("match_cooperation_day_add_num")))return O.GamePlatform.isQQGameRoom()||O.GamePlatform.IsH5SmallBag()||O.GamePlatform.IsMiYaIosH5()||O.GamePlatform.IsDysbSmallBag()||O.GamePlatform.Is5Add7SmallBag()?p.default.goldNum<300?s.G.StringManager.PopString(w.StringValueTableData.getById(4).string_value):y.default.addPopView("BaseCtrl","AddCoopCountAdvertiseByQQ","AddCoopCountAdvertiseByQQ"):y.default.addPopView("BaseCtrl","AddCoopCountAdvertise","AddCoopCountAdvertise");var t=s.G.StringManager.getString("ASSISTBATTLE_TIP_COOP");return y.default.addPopView("BaseCtrl","AssistBattleView","AssistBattleView",{fightType:m.FIGHT_TYPE.FIGHT_TYPE_COOPERATION,title:t.split("|")[0],tips:t.split("|")[1]})}y.default.addPopView("BaseCtrl","BattleRoomMainView","BattleRoomMainView",{CombatType:l.CombatType.COOP})}}),_.default.registerTouchEvent(this._soloNode,function(){b.getInstance().gameState!=E.Game_State.Reconnect&&y.default.addPopView("BaseCtrl","BattleRoomMainView","BattleRoomMainView",{CombatType:l.CombatType.SOLO})}),_.default.registerTouchEvent(this._ranklist,function(){y.default.addPopView("BaseCtrl","RankListView","RankListView"),e.hideGameClub()}),_.default.registerTouchEvent(this._playerHeadNode,function(){var t=p.default.uuidTransformRoieId();e.onCallGetRoleSimpleInfo(t)}),_.default.registerTouchEvent(this._playerNameNode,function(){var t=p.default.uuidTransformRoieId();e.onCallGetRoleSimpleInfo(t)}),_.default.registerTouchEvent(this._advertisingGiftsNode,function(){y.default.addPopView("BaseCtrl","AdvertisingGiftsMainView","AdvertisingGiftsMainView")}),_.default.registerTouchEvent(this._inviteFriendNode,function(){y.default.addPopView("BaseCtrl","InviteFriendView","InviteFriendView")}),_.default.registerTouchEvent(this._activityFirstRecharge,function(){y.default.addPopView("ShopMainCtrl","ActivityFristRechargeView","ActivityFristRechargeView")}),_.default.registerTouchEvent(this._laissezPasserNode,function(){y.default.addPopView("ShopMainCtrl","BattlePassView","BattlePassView")}),_.default.registerTouchEvent(this._channelsLiveNode,function(){y.default.addPopView("BaseCtrl","ChannelsLiveView","ChannelsLiveView"),e.hideGameClub()}),_.default.registerTouchEvent(this._btn_uniton,function(){if(p.default.getRoleAttrValByKey(m.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE)<Number(g.getConfigIntValue("sociaty_open_score")))return s.G.StringManager.PopString(s.G.StringManager.getWorldString("function_open_6"));var e=q.default.instance().SociatyPlayerData;e&&(0==Number(e.sociatyID)?y.default.addPopView("BaseCtrl","NotJoinedSociatyview","NotJoinedSociatyview"):y.default.addPopView("BaseCtrl","SociatyMainView","SociatyMainView"))}),_.default.registerTouchEvent(this.m_btn_userProtocol,function(){y.default.addPopView("BaseCtrl","UserProtocolView","UserProtocolView",{showClose:!0})}),_.default.registerTouchEvent(this.m_btn_PrivacyProtocol,function(){y.default.addPopView("BaseCtrl","PrivacyProtocolView","PrivacyProtocolView",{showClose:!0})}),_.default.registerTouchEvent(this.m_skyCastleNode,function(){y.default.addPopView("BaseCtrl","SkyCastleArenaView","SkyCastleArenaView")}),_.default.registerTouchEvent(this.m_royaleNode,function(){y.default.addPopView("BaseCtrl","RoyaleMainView","RoyaleMainView")}),_.default.registerTouchEvent(this.m_AnniversaryNode,function(){y.default.addPopView("BaseCtrl","AnniversaryMainView","AnniversaryMainView")}),_.default.registerTouchEvent(this.m_FogHiddenNode,function(){y.default.addPopView("BaseCtrl","FogHiddenMainView","FogHiddenMainView")}),_.default.registerTouchEvent(this.m_MachineryCityNode,function(){var e=q.default.instance().SociatyPlayerData;if(e.sociatyID.length<=0||0==Number(e.sociatyID))return s.G.StringManager.PopString(s.G.StringManager.getString("MACHINERYCITY_TIP2"));ve.default.callSociatyRoleGetMachinariumData()})},t.prototype.onCallGetRoleSimpleInfo=function(e){var t=new R.C_Role_GetRoleSimpleInfo;t.showID=e.toString(),u.ClientNetwork.getInstance().Send(R.ROLE_CLIENT_ENUM.P_Role_GetRoleSimpleInfo,t)},t.prototype.onFlexibleViewCallBack=function(){if(b.getInstance().gameState!=E.Game_State.Reconnect){var e=this._moreNode.active;this._moreNode.active=!e}},t.prototype.onMailBtnCallBack=function(){y.default.addPopView("MailCtrl","MailView","MailView"),this.hideGameClub()},t.prototype.onShowGameClubRedPointNode=function(e){if(void 0===e&&(e=!0),e&&O.GamePlatform.isWechat()){var t=p.default.getServersTime(),o=g.getLocalData("lastClickGameClubTime"),i=function(e){var t=new Date(1e3*e);return t.getFullYear()+"-"+(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-"+(t.getDate()<10?"0"+t.getDate():t.getDate())};i.call(this,t)!=i.call(this,o)&&(this._moreNode.getChildByName("gameclub").getChildByName("redpoint").active=!0)}else this._moreNode.getChildByName("gameclub").getChildByName("redpoint").active=!1;this.onMoreRedpointActive()},t.prototype.onShowMailRedPointNode=function(){var e=p.default.getRoleMailData(),t=!1;e.forEach(function(e){e.annex.annex.length>0&&(t=!0),1005==e.mailId&&(t=!0),0==e.mailId&&(t=!0)}),this._moreNode.getChildByName("btn_mail").getChildByName("redpoint").active=t,this.onMoreRedpointActive()},t.prototype.onShowTaskRedPoint=function(){P.default.showRedPoints()?this._taskNode.getChildByName("redPoint").active=!0:this._taskNode.getChildByName("redPoint").active=!1},t.prototype.onShowFriendRedPoint=function(){L.default.showRedPoint()?this._friendNode.getChildByName("redPoint").active=!0:this._friendNode.getChildByName("redPoint").active=!1,this.onMoreRedpointActive()},t.prototype.onAnnouncementBtnCallBack=function(){y.default.addPopView("BaseCtrl","AnnouncementView","AnnouncementView"),this.hideGameClub()},t.prototype.changeChatViewVisible=function(e){var t=this;if(e&&!("number"==typeof e&&isNaN(e)||Array.isArray(e)&&e.length<=0)){var o=null;if("number"==typeof e&&(o=e),Array.isArray(e)&&(o=e[0]),o&&cc.isValid(this._chatNode)&&this._chatNode)if(this._chatNode.active=!0,1==o){var i=cc.winSize.width/2-this._chatNode.width/2;cc.tween(this._chatNode).to(.1,{x:i}).call(function(){t._topViewNode&&(t._topViewNode.active=!1),"number"==typeof e&&t._chatNode.getChildByName("chatMain").getComponent("ChatMainView").setChatChannel(1),Array.isArray(e)&&t._chatNode.getChildByName("chatMain").getComponent("ChatMainView").setChatChannel(e[1],e[2])}).start()}else 2==o&&(i=cc.winSize.width/2+this._chatNode.width/2,cc.tween(this._chatNode).to(.1,{x:i}).call(function(){t._topViewNode&&(t._topViewNode.active=!0),t._chatNode.getChildByName("chatMain").getComponent("ChatMainView").hideAllChannelList(),t._chatNode.active=!1}).start())}},t.prototype.onClickChatNodeCallBack=function(){K.default.Instance.emit(z.default.SyncChatViewChange,Z.ChatViewVisible.Popup)},t.prototype.onShowNewMsg=function(e){var t=e.chatText;if(1!=function(e){var t=0;return ne.ChatChannelTableData.getDataMap().forEach(function(o){o.id==e&&(t=o.group)}),t==m.CHAT_CHANNEL_GROUP_TYPE.CHAT_CHANNEL_ACTICITY_GROUP}.call(this,e.channel))if(e.channel!=m.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_WEEK_COOPERATION){var o=this._chatMainMsgNode.getChildByName("label_chat"),i=this._chatMainMsgNode.getChildByName("label_chatDotLab");o.getComponent(cc.Label).string=t,i.active=!1,t.length>9&&(i.active=!0),this._chatMainMsgNode.active=!0;var a=y.default.getViewByName("BattleRoomMainView");a&&a.view&&a.view.onSetChatMsg(t)}else{var n=y.default.getViewByName("WeekCooperationReliveMainView");if(n&&n.view){n.view.onSetChatMsg(t);var r=y.default.getViewByName("BattleRoomMainView");r&&r.view&&r.view.onSetChatMsg(t)}}else{var s=y.default.getViewByName("SkyCastleArenaView");if(s&&s.view){s.view.onSetChatMsg(t);var c=y.default.getViewByName("BattleRoomMainView");c&&c.view&&c.view.onSetChatMsg(t)}var l=y.default.getViewNodeByName("FogHiddenMainView");if(l){l.getComponent("FogHiddenMainView").onSetChatMsg(t);var d=y.default.getViewByName("BattleRoomMainView");d&&d.view&&d.view.onSetChatMsg(t)}var u=y.default.getViewNodeByName("MachineryCityMainView");u&&u.getComponent("MachineryCityMainView")&&u.getComponent("MachineryCityMainView").onSetChatMsg(t);var h=y.default.getViewByName("BattleRoomMainView");h&&h.view&&h.view.onSetChatMsg(t)}},t.prototype.onShowPlayerHead=function(){g.setRemoteHeadIcon(p.default.getHeadUrl(),p.default.getRoleAttrValByKey(m.ROLE_ATTR_VALUES.ROLE_ATTR_HEADID),this._playerHeadNode.getChildByName("icon").getComponent(cc.Sprite))},t.prototype.onShowPlayerHeadFrame=function(){var e=this,t=p.default.getRoleAttrValByKey(m.ROLE_ATTR_VALUES.ROLE_ATTR_HEADFRAMEID);t<=0&&(t=200),I.default.loadSpriteFrame("ui/headFrame/frame_"+t).then(function(t){e._playerHeadNode.getChildByName("sprite").getComponent(cc.Sprite).spriteFrame=t}).catch(function(e){N.default.info(e)})},t.prototype.onShowPlayerName=function(){this._playerName.string=p.default.roleName},t.prototype.onRefreshCoopTimes=function(){var e=this;this._pvpNode.active=!1,this._coopTimesLabel.string=p.default.getRoleInfoData().cooperationDayLeftNum+"/"+(p.default.getRoleInfoData().cooperationDayGiveNum+p.default.getRoleInfoData().cooperationDayWatchAdNum),p.default.getRoleInfoData().cooperationDayLeftNum<=0?p.default.getRoleInfoData().cooperationDayWatchAdNum<Number(g.getConfigIntValue("match_cooperation_day_add_num"))?(O.GamePlatform.isQQGameRoom()||O.GamePlatform.IsH5SmallBag()||O.GamePlatform.IsMiYaIosH5()||O.GamePlatform.IsDysbSmallBag()||O.GamePlatform.Is5Add7SmallBag()?this._pvpNode.getChildByName("ppveqq_advertise").active=!0:this._pvpNode.getChildByName("ppve_advertise").active=!0,this._pvpNode.active=!0):(this._pvpNode.getChildByName("ppve_advertise").active=!1,this._pvpNode.getChildByName("ppveqq_advertise").active=!1,this._pvpNode.getChildByName("cup").active=!1,I.default.loadSpriteFrame("ui/mainScene/res/hezuo2").then(function(t){e._pvpNode.getComponent(cc.Sprite).spriteFrame=t,e._pvpNode.active=!0}).catch(function(e){N.default.info(e)})):(this._pvpNode.getChildByName("ppve_advertise").active=!1,this._pvpNode.getChildByName("ppveqq_advertise").active=!1,this._pvpNode.active=!0)},t.prototype.onRefreshFirstRechargeNode=function(){},t.prototype.onFightReconnect=function(){if(b.getInstance().gameState==E.Game_State.Reconnect){g.setTouchEnabled(!1);var e=p.default.getFightReconnectData();e?e.fightType==m.FIGHT_TYPE.FIGHT_TYPE_BATTLE_EAT_CHICKEN?this.scheduleOnce(function(){y.default.addPopView("BaseCtrl","ActivityMainView","ActivityMainView",null,null,function(){y.default.addPopView("BaseCtrl","MatchMainView","MatchMainView",{ntype:e.fightType})})}):this.scheduleOnce(function(){y.default.addPopView("BaseCtrl","MatchMainView","MatchMainView",{ntype:e.fightType})}):this.scheduleOnce(this.fightReconnectDataDelay,2)}},t.prototype.fightReconnectDataDelay=function(){b.getInstance().gameState=E.Game_State.End,g.setTouchEnabled(!0)},t.prototype.removeFightReconnectDataDelay=function(){this.unschedule(this.fightReconnectDataDelay)},t.prototype.onCheckFightResult=function(){if(p.default.getFightBalanceData()){if(b.getInstance().gameState=E.Game_State.End,1==p.default.getRoleAttrValByKey(m.ROLE_ATTR_VALUES.ROLE_ATTR_GUIDE))return void p.default.setFightBalanceData(null);var e=p.default.getFightBalanceData();if(e.type==m.FIGHT_TYPE.FIGHT_TYPE_BATTLE_EAT_CHICKEN){var t=F.default.getChickenDinnerData();if(3==t.status&&1==t.isLive||4==t.status){var o=y.default.getViewByName("MatchMainView");o&&o.view&&o.view.closeView(),f.default.hide(),y.default.getViewByName("ActivityMainView")||y.default.addPopView("BaseCtrl","ActivityMainView","ActivityMainView"),y.default.getViewByName("ChickenDinnerMainView")||y.default.addPopView("BaseCtrl","ChickenDinnerMainView","ChickenDinnerMainView")}return p.default.setFightBalanceData(null),void g.setTouchEnabled(!0)}b.getInstance().showFightResult(e)}else this.onFightReconnect()},t.prototype.onCheckRePay=function(){p.default.getRechargePrizeData()&&(y.default.addPopView("BaseCtrl","AcquirePopupView","AcquirePopupView",{items:p.default.getRechargePrizeData()}),p.default.setRechargePrizeData(null)),this.scheduleOnce(function(){var e=g.getLocalData("userPayRechargeInfo","");console.log("pay repay"+g.getLocalData("userPayRechargeInfo","")),e&&""!=e&&(O.GamePlatform.isWechat()?B.WechatUtils.getInstance().noticeServerPay(e):O.GamePlatform.isQQMiniGame()&&x.QQMiniGameUtils.getInstance().noticeServerPay(e))},.5)},t.prototype.onRefreshLegendRedPoint=function(){var e=this,t=new Map,o=p.default.getCurSeasonData();if(D.LegendTableData.getDataMap().forEach(function(e,i){e.seasonId==o.seasonID&&t.set(i,e)}),t.size<=0||!o)return!1;var i=p.default.getRoleAttrValByKey(m.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE),a=p.default.getLegendData(),n=!1,r=function(e){if(e<=0)return!0;var t=!1;return a.forEach(function(o,i){i==e&&1==o&&(t=!0)}),t};t.forEach(function(t){i>=t.cupNum&&0==r.call(e,t.cupNum)&&t.boxType>0&&(n=!0)}),n||(n=U.default.refreshShowWorshipRedPoint()),this._legendNode.getChildByName("redpoint").active=n},t.prototype.getTotalGetScoreFundRewardsCount=function(){var e=function(e,t){var o=p.default.getScoreFundData(),i=o.get(88889).rewardBoxStateMap;return 2==t&&(i=o.get(88890).rewardBoxStateMap),!!i.has(e)&&1==i.get(e)},t=0;return me.RoleScoreFundTableData.getDataMap().forEach(function(o){if(p.default.getRoleAttrValByKey(m.ROLE_ATTR_VALUES.ROLE_ATTR_MAX_SCORE)>=o.needScore){0==e(o.needScore,1)&&t++;var i=p.default.getRoleAttrValByKey(m.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE_FUND_BATTLEPASS);0==e(o.needScore,2)&&i&&i>0&&t++}}),t},t.prototype.onShopRedpointActive=function(){var e=!1,t=p.default.getRoleAttrValByKey(m.ROLE_ATTR_VALUES.ROLE_ATTR_PRIVILEGE_MONTHCARDTIME),o=p.default.getRoleAttrValByKey(m.ROLE_ATTR_VALUES.ROLE_ATTR_PRIVILEGE_MONTHCARDPRIZE);t>0&&0==o&&(e=!0),1==this._bHaveShopFreeItem||1==e||this.getTotalGetScoreFundRewardsCount()>0?this._shopNode.getChildByName("redpoint").active=!0:this._shopNode.getChildByName("redpoint").active=!1},t.prototype.onMoreRedpointActive=function(){var e=!1;1!=this._gameclub.getChildByName("redpoint").active&&1!=this._friendNode.getChildByName("redPoint").active&&1!=this._moreNode.getChildByName("btn_mail").getChildByName("redpoint").active&&1!=this._moreNode.getChildByName("channelsLive").getChildByName("redPoint").active&&1!=this._moreNode.getChildByName("btn_announcement").getChildByName("redpoint").active||(e=!0),this._moreNode.parent.getChildByName("btn_more").getChildByName("redPoint").active=e},t.prototype.onClientTaskAddAdvert=function(e){var t=new R.C_Role_ClientTaskAddAdvert;t.advertID=e,u.ClientNetwork.getInstance().Send(R.ROLE_CLIENT_ENUM.P_Role_ClientTaskAddAdvert,t)},t.prototype.onAdvertisingGiftsRedPoint=function(){p.default.getWatchadboxData().watchADNum>=10&&0==p.default.getWatchadboxData().isReceive?this._advertisingGiftsNode.getChildByName("redpoint").active=!0:this._advertisingGiftsNode.getChildByName("redpoint").active=!1,this._advertisingGiftsNode.getChildByName("redpoint").active||(ue.default.haveMengXinTask()&&ue.default.mengxinRedPoint()?this._advertisingGiftsNode.getChildByName("redpoint").active=!0:he.default.haveGuangGaoTask()&&he.default.guanggaoRedPoint()&&(this._advertisingGiftsNode.getChildByName("redpoint").active=!0));var e=this._advertisingGiftsNode.getChildByName("progressBar").getComponent(cc.ProgressBar),t=this._advertisingGiftsNode.getChildByName("progressBar").getChildByName("num").getComponent(cc.Label);e.progress=p.default.getWatchadboxData().watchADNum/10,t.string=p.default.getWatchadboxData().watchADNum+"/10"},t.prototype.onBattlePassRedPoint=function(){if(0!=this._laissezPasserNode.active){var e=p.default.getCurSeasonData();e||N.default.log("\u6ca1\u6709\u8d5b\u5b63\u6570\u636e");var t=[];G.BattlePassTableData.getDataMap().forEach(function(o){e.seasonID==o.seasonId&&t.push(o)});for(var o=function(e,t){if(0==t){var o=p.default.getRoleAttrValByKey(m.ROLE_ATTR_VALUES.ROLE_ATTR_BATTLE_PASS);if(!o||0==o)return 0}var i=1;p.default.getItemCountByBag(Number(g.getConfigIntValue("battle_pass_currency")))<e&&(i=0);var a=p.default.getCurSeasonData();return a||(i=0),(t?a.foreverScorePrize:a.scorePrize).forEach(function(t,o){o==e&&t.isPrize&&(i=2)}),i},i=!1,a=0;a<t.length;a++){var n=o.call(this,t[a].coinNum,!0),r=o.call(this,t[a].coinNum,!1);if(1==n||1==r){i=!0;break}}this._laissezPasserNode.getChildByName("redpoint").active=i}},t.prototype.onDrawBoxRewardRedpoint=function(){var e=this._drawCardNode.getChildByName("redpoint"),t=p.default.getDrawPrizeData();if(t){var o=function(e,t){var o=0;return e.forEach(function(e,i){t==i&&(o=e)}),1==o},i=!1,a=g.getConfigIntValue("recruit_purple_box"),n=g.getConfigIntValue("recruit_golden_box"),r=o.call(this,t.rewardBoxStateMap,Number(a)),s=o.call(this,t.rewardBoxStateMap,Number(n));t.roundDrawNum>=Number(a)&&0==r&&(i=!0),t.roundDrawNum>=Number(n)&&0==s&&(i=!0),e.active=i}else e.active=!1},t.prototype.onInviteFriendRedPoint=function(){var e=[];Array.from(p.default.getRoleTaskData().tasks.values()).forEach(function(t){var o=k.TaskTableData.getById(t.taskID);o&&o.type==m.TASK_TYPE.TASK_TYPE_COUNT_SHAREPLAYERNUM&&e.push(t),o||console.error("onInviteFriendRedPoint taskID",t.taskID)});for(var t=null,o=0;o<e.length;o++)if(e[o].taskState==m.TASK_STATE.TASK_STATE_EXECUTING){t=e[o];break}if(t){var i=function(e){var t=p.default.getSharePrenticeData(),o=[];t.forEach(function(e){o.push(e)}),o.sort(function(e,t){return e.bindTime-t.bindTime});for(var i=0,a=0;a<e.length;a++)e[a].taskState==m.TASK_STATE.TASK_STATE_FINISH&&(i=k.TaskTableData.getById(e[a].taskID).finishCount);return o.splice(0,i),o}.call(this,e,t),a=this._inviteFriendNode.getChildByName("progressBar").getComponent(cc.ProgressBar),n=this._inviteFriendNode.getChildByName("progressBar").getChildByName("num").getComponent(cc.Label);a.progress=i.length/Number(k.TaskTableData.getById(t.taskID).info3),n.string=i.length+"/"+k.TaskTableData.getById(t.taskID).info3,a.progress>=1?this._inviteFriendNode.getChildByName("redpoint").active=!0:this._inviteFriendNode.getChildByName("redpoint").active=!1}else this._inviteFriendNode.active=!1},t.prototype.onShowChatRedpoint=function(){var e=this._chatMainMsgNode.parent.children[1].children[0],t=!1;p.default.getPrivateChatSimData().forEach(function(e){e.noReadNum>0&&(t=!0)}),e.active=t,this._chatNode.getChildByName("chatMain").getChildByName("ToggleContainer").getChildByName("channe_"+m.CHAT_CHANNEL_GROUP_TYPE.CHAT_CHANNEL_PRIVATE_GROUP).getChildByName("redpoint").active=t;var o=y.default.getViewByName("BattleRoomMainView");o&&o.view&&o.view.onSetChatRedpoint(t);var i=y.default.getViewByName("SkyCastleArenaView");i&&i.view&&i.view.onSetChatRedpoint(t);var a=y.default.getViewNodeByName("FogHiddenMainView");a&&a.getComponent("FogHiddenMainView").onSetChatRedpoint(t);var n=y.default.getViewNodeByName("MachineryCityMainView");n&&n.getComponent("MachineryCityMainView")&&n.getComponent("MachineryCityMainView").onSetChatRedpoint(t)},t.prototype.onGetChatMsgAndRedpoint=function(){var e=this._chatMainMsgNode.getChildByName("label_chat"),t=this._chatMainMsgNode.parent.children[1].children[0];return{msg:e.getComponent(cc.Label).string,redpoint:t.active}},t.prototype.onSetChatBtnNodeActive=function(e){this._chatMainMsgNode.parent.active=e},t.prototype.onActivityEveryDayRechargeRedpoint=function(e){this._firstRechargeIsRedpoint||(this._activityFirstRecharge.children[0].active=e)},t.prototype.refreshEveryDayRechargeRedPoint=function(){if(!this._firstRechargeIsRedpoint){var e=g.getLocalData("isSeeEveryDayRecharge"),t=p.default.getRoleAttrValByKey(m.ROLE_ATTR_VALUES.ROLE_ATTR_DAY_RECHARGE_ID),o=p.default.getRoleAttrValByKey(m.ROLE_ATTR_VALUES.ROLE_ATTR_DAY_RECHARGE_TIME),i=p.default.getServersTime(),a=!1,n=!1,r=function(e){var t=new Date(1e3*e);return t.getFullYear()+"-"+(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-"+(t.getDate()<10?"0"+t.getDate():t.getDate())},s=r.call(this,o),c=r.call(this,i),l=g.getLocalData("lastClickEveryRechargeTime");s==c&&(a=!0),r.call(this,l)==c&&(n=!0),""!==e&&(0==t||a||n)||(this._activityFirstRecharge.children[0].active=!0)}},t.prototype.onActivityFristRechargeRedpoint=function(e,t){this._firstRechargeIsRedpoint=e,this._activityFirstRecharge.children[0].active=e,g.getLocalData("isSeeEveryDayRecharge"),p.default.getRoleAttrValByKey(m.ROLE_ATTR_VALUES.ROLE_ATTR_DAY_RECHARGE_ID),this.refreshEveryDayRechargeRedPoint();for(var o=p.default.getRoleRechargeData(),i=V.ACTIVITY_ID_ENUM.P_Activity_Box1;i<V.ACTIVITY_ID_ENUM.P_Activity_Box1+3;i++){var a=H.ActivityTableData.getById(i);o.has(a.param2)&&o.get(a.param2).totalNum,a.param3}t&&t.totalDay,this._activityFirstRecharge.active=!0,M.getSubmitReviewShopState()&&(cc.sys.os==cc.sys.OS_IOS||M.getQQMiniGameSubmitReviewShopState()||M.getByteDanceSubmitReviewShopState())&&(this._activityFirstRecharge.active=!1)},t.prototype.onSyncChangeLiveTaskData=function(){var e=[],t=[],o=[];Array.from(p.default.getRoleTaskData().tasks.values()).forEach(function(i){var a=k.TaskTableData.getById(i.taskID);a&&(a.showType==m.TASK_SHOW_TYPE.ASK_CHANNELS_LIVE_NEW_REPORTED?e.push(i):a.showType==m.TASK_SHOW_TYPE.TASK_CHANNELS_LIVE?t.push(i):a.showType==m.TASK_SHOW_TYPE.TASK_CHANNELS_LIVE_REWARD&&o.push(i))});var i=[];e.forEach(function(e){if(e.taskState==m.TASK_STATE.TASK_STATE_EXECUTING){var t=p.default.getRoleAttrValByKey(m.ROLE_ATTR_VALUES.ROLE_ATTR_DAYLIVETIME),o=k.TaskTableData.getById(e.taskID);t>=o.finishCount&&i.push({taskID:e.taskID,count:o.finishCount})}}),t.forEach(function(e){if(e.taskState==m.TASK_STATE.TASK_STATE_EXECUTING){var t=k.TaskTableData.getById(e.taskID);e.taskCount>=t.finishCount&&i.push({taskID:e.taskID,count:t.finishCount})}}),i.length>0||1==function(e){for(var t=!1,o=0;o<e.length;o++){var i=k.TaskTableData.getById(e[o].taskID);if(e[o].taskCount/i.finishCount>=1&&e[o].taskState==m.TASK_STATE.TASK_STATE_EXECUTING){t=!0;break}}return t}.call(this,o)?this._channelsLiveNode.getChildByName("redPoint").active=!0:this._channelsLiveNode.getChildByName("redPoint").active=!1,this.onMoreRedpointActive()},t.prototype.hideGameClub=function(){this._moreNode.active=!1,O.GamePlatform.isWechat()&&B.WechatUtils.getInstance().m_gameClubBtn&&B.WechatUtils.getInstance().m_gameClubBtn.hide()},t.prototype.onGameNoticeRedpoint=function(){var e=this,t=s.G.StringManager.getString("Announcement_URL");(O.GamePlatform.isWechat()||O.GamePlatform.isQQMiniGame()||O.GamePlatform.isByteDanceMiniGame()||O.GamePlatform.isKuaishouMiniGame())&&(t=M.getSubmitReviewState()?s.G.StringManager.getString("Announcement_URL"):s.G.StringManager.getString("Announcement_URL_MOBILE")),(O.GamePlatform.getMiYa()||O.GamePlatform.isQQGameRoom())&&(t=s.G.StringManager.getString("Announcement_URL_MOBILE")),"bigBlue"==O.GamePlatform.getMiYaVideoTypeNoSet()&&(t=s.G.StringManager.getString("Announcement_URL_MOBILE_BIGBLUE")),"ly5add7"==O.GamePlatform.getMiYaVideoTypeNoSet()&&(t=s.G.StringManager.getString("Announcement_URL_MOBILE_ADDCHANNEL")),t+="?"+Math.random();var o=new XMLHttpRequest;o.onreadystatechange=function(){if(4==o.readyState&&o.status>=200&&o.status<400){var t=JSON.parse(o.responseText);e.checkGameNoticeRedpoint(t)}},o.open("GET",t,!0),o.send()},t.prototype.checkGameNoticeRedpoint=function(e){var t=!1;0==_.default.hasData("GameNoticeData")&&_.default.storageData("GameNoticeData",JSON.stringify(e));var o=_.default.getData("GameNoticeData");if(o&&!(o.length<=0)){for(var i in o=JSON.parse(o),e)String(e[i].exclude).indexOf("douyin")>-1&&O.GamePlatform.isByteDanceMiniGame()||String(e[i].exclude).indexOf("kuaishou")>-1&&O.GamePlatform.isKuaishouMiniGame()||String(e[i].exclude).indexOf("qqmini")>-1&&O.GamePlatform.isQQMiniGame()||String(e[i].exclude).indexOf("qqhall")>-1&&O.GamePlatform.isQQGameRoom()||String(e[i].exclude).indexOf("5plus7")>-1&&O.GamePlatform.Is5Add7SmallBag()||(o[i]||(o[i]=e[i],o[i].isNew=!0),o[i].content!=e[i].content&&(o[i].isNew=!0),1==o[i].isNew&&(t=!0));if(_.default.storageData("GameNoticeData",JSON.stringify(o)),this._moreNode){var a=this._moreNode.getChildByName("btn_announcement");a&&(a.getChildByName("redpoint").active=t)}this.onMoreRedpointActive()}},t.prototype.chickShowChickResultData=function(){var e=F.default.getChickenDinnerResultData();if(e&&0==e.ranklistdata.isLive){var t=y.default.getViewByName("MatchMainView");t&&t.view&&t.view.closeView(),y.default.getViewByName("ChickenDinnerMainView")?y.default.addPopView("BaseCtrl","ChickenDinnerSettlementView","ChickenDinnerSettlementView"):this.scheduleOnce(function(){y.default.addPopView("BaseCtrl","ChickenDinnerSettlementView","ChickenDinnerSettlementView")},1.5)}},t.prototype.onRefreshSkyCastleRedpoint=function(){var e;e=se.default.Instance.checkBoxRedPoint(),K.default.Instance.emit(z.default.SkyCastleRefreshBoxRedpoint);var t=ce.SkyCastleUtls.Instance.getRecharViewRed(),o=this.m_skyCastleNode.getChildByName("redpoint");o.active=!1,1!=e&&1!=t||(o.active=!0)},t.prototype.onRefreshSelectCardNode=function(){var e=p.default.getItemCountByBag(21e4);this._selectCardNode.getChildByName("num").getComponent(cc.Label).string="x"+e,this._selectCardNode.active=!1,e&&e>0&&(this._selectCardNode.active=!0)},t.prototype.onCallSociatyRedPoint=function(){if(!(p.default.getRoleAttrValByKey(m.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE)<Number(g.getConfigIntValue("sociaty_open_score")))){var e=q.default.instance().SociatyPlayerData;e.sociatyID.length<=0||0==Number(e.sociatyID)?q.default.instance().getSociatyInviteLength()<=0&&Q.default.c_Sociaty_RoleGetInviteData():(q.default.instance().SociatyPlayerData.job!=m.SOCIATY_JOB.SOCIATY_JOB_OFFICIAL&&q.default.instance().SociatyPlayerData.job!=m.SOCIATY_JOB.SOCIATY_JOB_PRESIDENT||q.default.instance().getSociatyApplyLength()<=0&&Q.default.c_Sociaty_RoleGetSociatyApplyData(),q.default.instance().m_sociatyChat.length<=0&&Q.default.request_C_Sociaty_RoleGetChatData(),Q.default.c_Sociaty_RoleGetSociatyData(q.default.instance().SociatyPlayerData.sociatyID),Q.default.c_Sociaty_RoleGetSociatyBoxData(),Q.default.c_Activity_GetSociatyWarData())}},t.prototype.onRefreshSociatyRedpoint=function(){var e,t,o,i,a,n=!1;e=q.default.instance().checkSociatyInviteRedPoint(),K.default.Instance.emit(z.default.SociatyInviteBtnRedpointEvent),t=q.default.instance().checkSociatyApplyRedPoint(),K.default.Instance.emit(z.default.SociatyApplyBtnRedpointEvent);var r=q.default.instance().SociatyPlayerData;if(r.sociatyID.length<=0||0==Number(r.sociatyID))return(s=this._btn_uniton.getChildByName("redpoint")).active=!1,void(1!=e&&1!=t||(s.active=!0));o=q.default.instance().checkSociatyBoxRedPoint(),K.default.Instance.emit(z.default.SociatyRefreshBoxRedpointEvent),i=q.default.instance().checkSociatyRedEnvelopeRedPoint(),a=q.default.instance().checkSociatyFightRedPoint();var s,c=q.default.instance().getSociatyAuctionState();if(q.default.instance().SociatyData.sociatyLevel<Number(g.getConfigIntValue("sociaty_war_need_sociatylevel")))n=!1;else if(1==(n=c<3)){var l=_.default.getData("AuctionClickState");l&&l.length>0&&(n=!1)}(s=this._btn_uniton.getChildByName("redpoint")).active=!1,1!=e&&1!=t&&1!=o&&1!=i&&1!=a&&1!=n||(s.active=!0)},t.prototype.onRefreshSociatyUnreadChat=function(){q.default.instance().m_sociatyUnreadChat.length>99?this._btn_uniton.children[1].children[0].getComponent(cc.Label).string="99+":this._btn_uniton.children[1].children[0].getComponent(cc.Label).string=q.default.instance().m_sociatyUnreadChat.length,this._btn_uniton.children[1].active=q.default.instance().m_sociatyUnreadChat.length>0},t.prototype.onSeasonCloseing=function(){if(!(Y.default.nodeList.length>1)){var e=!1,t=0,o=!1,i="",a=g.getLocalData("PopSeasonEnd");a&&""!=a&&(t=a),p.default.getRoleMailData().forEach(function(t){1001!=t.mailId&&1004!=t.mailId||(e=!0,1001==t.mailId&&(o=!0,i=t.msg))});var n=p.default.getRoleAttrValByKey(m.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE);if(e&&0==Number(t)&&n>=3e3)if(o&&i.length>0){var r=i.match(/\d+/g);r.length>0&&Number(r[0])>0?y.default.addPopView("BaseCtrl","SeasonClosingView","SeasonClosingView",{nRankNum:Number(r[0])}):y.default.addPopView("BaseCtrl","SeasonClosingView","SeasonClosingView")}else y.default.addPopView("BaseCtrl","SeasonClosingView","SeasonClosingView")}},t.prototype.checkHeadRedDotVisible=function(){var e=p.default.getPetRedDot(),t=j.default.vipBtnRedDotCanShow(),o=p.default.getMainMapSkinRedpoint();return e||t||o},t.prototype.onQQHallBtnClick=function(){y.default.addPopView("BaseCtrl","QQHallVipView","QQHallVipView")},t.prototype.onQQBlueBtnCLicked=function(){y.default.addPopView("BaseCtrl","QQBlueVipView","QQBlueVipView")},t.prototype.onCheckReportedCarHpTask=function(){var e=p.default.getHeroCarData(),t=0;e.forEach(function(e){if(1==e.bHeroLock){var o=X.default.getInstance().getHeroConfig(e.heroId).npc_id,i=X.default.getInstance().getNpcTemplateConfig(o,e.heroLevel).carhp;t+=i}});var o=X.default.getInstance().getCarConfig(1);o&&(t+=o.ini_hp),u.ClientNetwork.getInstance().pushLocalMessage(d.LOCAL_MESSAGE.LocalMsg_ClientTaskUpdateCount,{classifyId:1,valueCount:t})},t.prototype.onCheckModuleViewOnOffEvent=function(){var e=this;oe.OnOffTableData.getDataMap().forEach(function(t){if(1==t.isFunction){var o=p.default.checkModulerOnOffState(t.id);switch(t.id){case Z.ModulerViewOnOff.LotteryView:e._drawCardNode&&(e._drawCardNode.active=o);break;case Z.ModulerViewOnOff.PushGiftView:e.checkPushGiftBtn();break;case Z.ModulerViewOnOff.Anniversary:e.m_AnniversaryNode&&(1==o&&0==fe.default.Instance.checkAnniversaryOpenState()&&(o=!1),e.m_AnniversaryNode.active=o);break;case Z.ModulerViewOnOff.AnniversaryReturnBack:K.default.Instance.emit(z.default.SyncActivityReturnBackOffState);break;case Z.ModulerViewOnOff.FogHidden:e.m_FogHiddenNode&&(1==o&&0==ge.default.Instance.checkFogHiddenOpenState()&&(o=!1),e.m_FogHiddenNode.active=o);break;case Z.ModulerViewOnOff.FogHiddenRank:K.default.Instance.emit(z.default.SyncFogHiddenRankOffState,o);break;case Z.ModulerViewOnOff.MachineryCityActivity:e.m_MachineryCityNode&&(1==o&&0==ye.default.Instance.getMachineryCityIsOpen()&&(o=!1),e.m_MachineryCityNode.active=o)}}})},t.prototype.checkAddShortcutTask=function(e){console.log("MainSceneView, checkAddShortcutTask");var t=_.default.getAddShortcutTaskId();O.GamePlatform.isQQMiniGame()&&(t=402,2===e&&(t=403));var o=Array.from(p.default.getRoleTaskData().tasks.values()),i=!1;return o.forEach(function(e){t==e.taskID&&e.taskState==m.TASK_STATE.TASK_STATE_FINISH&&(i=!0)}),i},t.prototype.checkAddShortcutButton=function(){if(console.log("MainSceneView, checkAddShortcutButton"),O.GamePlatform.isByteDanceMiniGame()||O.GamePlatform.isQQMiniGame()){var e=function(){var e=this.m_btn_addShortcut.getChildByName("reward"),t=cc.rotateTo(.1,5),o=cc.rotateTo(.1,-5),i=cc.rotateTo(.1,0),a=cc.sequence(t,o,t,o,i);e.runAction(a)};this.checkAddShortcutTask(1)?(this.m_btn_addShortcut.active=!1,this.unschedule(e)):(this.m_btn_addShortcut.active=!0,this.schedule(e,5))}else this.m_btn_addShortcut.active=!1},t.prototype.checkAddCollectButton=function(){if(console.log("MainSceneView, checkAddCollectButton"),O.GamePlatform.isQQMiniGame()){var e=this.checkAddShortcutTask(2),t=this.checkAddShortcutTask(1),o=function(){var e=this.m_btn_addCollect.getChildByName("reward"),t=cc.rotateTo(.1,5),o=cc.rotateTo(.1,-5),i=cc.rotateTo(.1,0),a=cc.sequence(t,o,t,o,i);e.runAction(a)};e?(this.m_btn_addCollect.active=!1,this.unschedule(o)):(this.m_btn_addCollect.active=!0,t&&(this.m_btn_addCollect.x=0),this.schedule(o,5))}else this.m_btn_addCollect.active=!1},t.prototype.showSubscribeMessage=function(){if(!O.GamePlatform.isPC()){var e=g.getLocalData("SubscribeMessageState");if(!e||"1"!=e){var t=this;wx.requestSubscribeMessage({tmplIds:Ce,success:function(e){console.log("\u8c03\u8d77\u6210\u529f",e),t.checkToServerSubscribe(e,E.INT_MAX_VALUE)},fail:function(e){console.log(e),wx.showModal({title:"\u8ba2\u9605\u5931\u8d25",content:"\u9519\u8bef\u7801"+e.errCode})}})}}},t.prototype.checkToServerSubscribe=function(e,t){for(var o=this,i={},a=0;a<Ce.length;a++){var n=e[Ce[a]];"accept"===n?(console.log("\u63a5\u53d7\u4e86\u6d88\u606f\u63a8\u9001"),i[Ce[a]]={key:a+1,value:t}):"reject"===n?console.log("\u62d2\u7edd\u6d88\u606f\u63a8\u9001"):"ban"===n&&console.log("\u5df2\u88ab\u540e\u53f0\u5c01\u7981")}var r=i;if(console.log("\u9700\u8981\u4e0a\u4f20\u7684\u6570\u636e  ",r),r&&Object.keys(r).length>0){var s=0,c=function(e){if(Object.prototype.hasOwnProperty.call(r,e)){var t=r[e];setTimeout(function(){o.onSendRoleSetSubscribe(t.key,t.value)},200*s),s++}};for(var l in r)c(l)}g.setLocalData("SubscribeMessageState","1")},t.prototype.onSendRoleSetSubscribe=function(e,t){if(!O.GamePlatform.isPC()){var o=new R.C_Role_SetSubscribe;o.type=e,o.sendnum=t,o.sendtype=1,u.ClientNetwork.getInstance().Send(R.ROLE_CLIENT_ENUM.P_Role_SetSubscribe,o)}},t.prototype.onRefreshHeroRedPoint=function(){var e=this,t=!1;if(0==p.default.checkModulerOnOffState(Z.ModulerViewOnOff.ProficiencyShare))t=!1;else{var o=function(e){if(O.GamePlatform.isWechat()){var t=p.default.getHeroProficiencyDataById(e);if(t){var o=0;if(ae.ProficiencyTableData.getDataMap().forEach(function(e){t.proficiency>=e.minProficiency&&t.proficiency<=e.maxProficiency&&(o=e.id)}),o>=Number(g.getConfigIntValue("proficiency_share_level_num")))return 1!=t.shareData.has(o)||1!=t.shareData.get(o)}}return!1};p.default.getHeroCarData().forEach(function(i){1==i.bHeroLock&&1==o.call(e,i.heroId)&&(t=!0)})}var i=pe.default.Instance.getHeroSkinRedPointBy(!0,0);this._heroNode.children[0].active=t||i},t.prototype.onDestroy=function(){u.ClientNetwork.getInstance().removeMessageTarget(this),this.unscheduleAllCallbacks(),K.default.Instance.off(this,z.default.SociatyRefreshRedpoint),K.default.Instance.off(this,z.default.SociatyRefreshUnreadChatEvent),K.default.Instance.off(this,z.default.SycnClientCarHpChangeEvent),K.default.Instance.off(this,z.default.SyncRoleItemMapSkinEvent),K.default.Instance.off(this,z.default.SyncModuleViewEvent),K.default.Instance.off(this,z.default.SyncSkyCastleChangeType),K.default.Instance.off(this,z.default.SyncChatViewChange),K.default.Instance.off(this,z.default.SociatySyncMachinariumDataEvent),O.GamePlatform.isByteDanceMiniGame()&&W.default.getInstance().destroyKefuBtn()},t.prototype.forceCheckGame=function(){var e=this,t=O.GamePlatform.getMiYaVideoTypeNoSet();if(O.GamePlatform.getMiYa()&&"mayiH5yl"!=t&&"mayiH5my"!=t&&"lyH5sq"!=t&&"issueByDance"!=t&&"mayiH5gdt"!=t&&"lyH5dysb"!=t&&"ly5add7"!=t&&"ttss"!=t&&"mayiH5tab"!=t&&"mayiH5xfc"!=t&&g.getForceCheckGame()){var o="https://mszcs1.gameserver.iplay11g.com/gmsys/native_version.php?"+Math.random();if("bigBlue"==O.GamePlatform.getMiYaVideoType()&&(console.log("this is big blue"),o="https://mszcs1.gameserver.iplay11g.com/gmsys/native_bigBlue_version.php?"+Math.random()),cc.isValid(this)){var i=new XMLHttpRequest;i.timeout=3e3;var a=o;i.open("GET",a,!0),i.send(),i.onload=function(){if(cc.isValid(e)){g.setForceCheckGame(!1);try{var o=JSON.parse(i.response),a=cc.sys.localStorage.getItem("clentVersion");if(a=a||"",console.log("clentVersion   ",a,o.version),"testUpdate"==t)return console.log("clentVersion   ",a,o.testVersion,o.testPackageUrl),void(o.testVersion>a&&(console.log("\u6d4b\u8bd5\u5ba2\u6237\u7aef\u7248\u672c\u4f4e\u4e8e\u540e\u7aef\u7248\u672c\uff0c\u5f39\u51fa\u63d0\u793a"),y.default.addPopView("BaseCtrl","NeedRestart","NeedRestart")));if(o.version>a)return console.log("\u5ba2\u6237\u7aef\u7248\u672c\u4f4e\u4e8e\u540e\u7aef\u7248\u672c\uff0c \u68c0\u67e5\u66f4\u65b0"),void y.default.addPopView("BaseCtrl","NeedRestart","NeedRestart")}catch(n){console.log("JSON.parse(request.response) error")}}},i.ontimeout=function(){cc.isValid(e)&&console.log("checkgame ontimeout")},i.onerror=function(){cc.isValid(e)&&console.log("checkgame onerror")},i.onabort=function(){cc.isValid(e)&&console.log("checkgame abort")}}}},t.prototype.sendTotalCarHpToServar=function(){var e=p.default.getHeroCarData(),t=0;e.forEach(function(e){if(1==e.bHeroLock){var o=X.default.getInstance().getHeroConfig(e.heroId).npc_id,i=X.default.getInstance().getNpcTemplateConfig(o,e.heroLevel).carhp;t+=i}});var o=X.default.getInstance().getCarConfig(1),i=t+o.ini_hp,a=new re.C_Role_SendCarHpToServer;a.carHp=i,u.ClientNetwork.getInstance().Send(R.ROLE_CLIENT_ENUM.P_Role_SendCarHpToServer,a)},t.prototype.onClickHeroBtn=function(){var e=g.getConfigIntValue("activity_daily_chaozhi_choose"),t=le.LuckyGiftSelectTableData.getById(Number(e)).prize;y.default.addPopView("BaseCtrl","LuckyGiftSelectRewardView","LuckyGiftSelectRewardView",{tRewards:t,index:1,isEveryDayReacharge:!0,parent:this})},t.prototype.showSecectRwd=function(e,t,o,i){if(void 0===i&&(i=1),0!=e){var a=new re.C_Role_UseChooseBox;a.boxItemId=21e4,a.selectItemId=e,a.useBoxNum=i,u.ClientNetwork.getInstance().Send(R.ROLE_CLIENT_ENUM.P_Role_UseChooseBox,a)}},t.prototype.refreshMengXinTimeCountDown=function(){var e=ue.default.getleftTime();if(e>0)this._advertisingGiftsNode.getChildByName("taskboxtime").active=!0,this._advertisingGiftsNode.getChildByName("progressBar").active=!1,this._advertisingGiftsNode.getChildByName("taskboxtime").getComponent(cc.Label).string=ee.TimeOffSetManager.getSecondStr2(e);else{this._advertisingGiftsNode.getChildByName("taskboxtime").active=!1,this._advertisingGiftsNode.getChildByName("progressBar").active=!0,this.unschedule(this.refreshMengXinTimeCountDown),this.onAdvertisingGiftsRedPoint();var t=y.default.getViewByName("AdvertisingGiftsMainView");if(t&&t.view){var o=t.view;o&&o.refreshMenuRedPoint()}}},t.prototype.setMengXinCountDown=function(){ue.default.initData(),ue.default.getleftTime()>0?this.schedule(this.refreshMengXinTimeCountDown,.1):this.unschedule(this.refreshMengXinTimeCountDown),this.refreshMengXinTimeCountDown()},t.prototype.checkRoyaleNodeVisible=function(){var e=p.default.getServersTime(),t=Number(g.getConfigIntValue("royale_activity_end_time"))-e;this.m_royaleNode.active=!(t<=0),M.getSubmitReviewState()&&(this.m_royaleNode.active=!1)},t.prototype.update=function(){var e=this;if(0==Y.default.getGameViewShowCount()&&0==this._chatMainMsgNode.parent.active){this._chatMainMsgNode.parent.active=!0;var t=this.node.getChildByName("UI_Root");if(t)if(this._chatNode&&cc.isValid(this._chatNode)){this._chatNode.parent=t,this._chatNode.zIndex=0;var o=this._chatNode.getChildByName("chatMain").getComponent("ChatMainView");o.setShowChannelTab([m.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_PRIVATE,m.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_SYSTEM,m.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_WORLD]),o.setChatChannel(m.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_SYSTEM)}else cc.resources.load("ui/mainScene/ChatNode",cc.Prefab,function(o,i){if(o)return e._chatNode=null,void console.error("load chatNode faild!!!");var a=cc.instantiate(i);a.parent=t,a.zIndex=0,a.active=!1,e._chatNode=a;var n=a.getChildByName("chatMain").getComponent("ChatMainView");n.setShowChannelTab([m.CHAT_CHANNEL_GROUP_TYPE.CHAT_CHANNEL_PRIVATE_GROUP,m.CHAT_CHANNEL_GROUP_TYPE.CHAT_CHANNEL_SYSTEM_GROUP,m.CHAT_CHANNEL_GROUP_TYPE.CHAT_CHANNEL_WORLD_GROUP]),n.setChatChannel(1),n.hideAllChannelList(),e.onShowChatRedpoint()})}},n([T.Register_Button_Sound,T.Register_Class,Te],t)}(S.default));o.default=Ie,cc._RF.pop()},{"../../load":"load","../Global":"Global","../Global/GameGlobal":"GameGlobal","../StaticData/ActivityTableData":"ActivityTableData","../StaticData/BattlePassTableData":"BattlePassTableData","../StaticData/ChatChannelTableData":"ChatChannelTableData","../StaticData/LegendTableData":"LegendTableData","../StaticData/LuckyGiftSelectTableData":"LuckyGiftSelectTableData","../StaticData/OnOffTableData":"OnOffTableData","../StaticData/ProficiencyTableData":"ProficiencyTableData","../StaticData/RoleScoreFundTableData":"RoleScoreFundTableData","../StaticData/StringValueTableData":"StringValueTableData","../StaticData/TaskTableData":"TaskTableData","../combat/CombatManager":"CombatManager","../common/CombatModule":"CombatModule","../common/CommandValue":"CommandValue","../common/EventConst":"EventConst","../common/PlayerModule":"PlayerModule","../controller/Guide/GuideConfig/GuideConst":"GuideConst","../modules/base/BaseView":"BaseView","../modules/base/Decorators":"Decorators","../modules/base/GameView":"GameView","../modules/manager/EventManager":"EventManager","../modules/manager/LoadResManager":"LoadResManager","../modules/manager/ViewManager":"ViewManager","../network/ClientNetwork":"ClientNetwork","../network/LocalMessage":"LocalMessage","../network/protocol/ActivityProtocols":"ActivityProtocols","../network/protocol/RoleProtocols":"RoleProtocols","../network/protocol/TypeProtocols":"TypeProtocols","../utils/ByteDanceMiniGameUtils":"ByteDanceMiniGameUtils","../utils/ConfigUtils":"ConfigUtils","../utils/ConstValue":"ConstValue","../utils/GameLoading":"GameLoading","../utils/GamePlatform":"GamePlatform","../utils/GameTools":"GameTools","../utils/GameUtils":"GameUtils","../utils/KSMinigameUtils":"KSMinigameUtils","../utils/LeniuGameUtils":"LeniuGameUtils","../utils/LogUtil":"LogUtil","../utils/QQGameHallUtils":"QQGameHallUtils","../utils/QQMiniGameUtils":"QQMiniGameUtils","../utils/TimeOffSetManager":"TimeOffSetManager","../utils/Tools":"Tools","../utils/UIManager":"UIManager","../utils/WechatUtils":"WechatUtils","../view/activity/ActivityModule":"ActivityModule","./advertisingGifts/AdvertisingGiftsGuangGaoView":"AdvertisingGiftsGuangGaoView","./advertisingGifts/AdvertisingGiftsMengXinView":"AdvertisingGiftsMengXinView","./anniversary/AnniversaryModule":"AnniversaryModule","./drawcard/DrawCardMainCtrl":"DrawCardMainCtrl","./drawcard/DrawCardMainView":"DrawCardMainView","./fogHidden/FogHiddenModel":"FogHiddenModel","./friend/FriendMainView":"FriendMainView","./heroCardBag/HeroSkinUtils":"HeroSkinUtils","./legend/vos/VOLegendControl":"VOLegendControl","./machineryCityActivity/MachineryCityCtrl":"MachineryCityCtrl","./machineryCityActivity/MachineryCityModel":"MachineryCityModel","./playerInfo/PlayerInfoView":"PlayerInfoView","./pushGift/NewerThreeDaysGiftUtils":"NewerThreeDaysGiftUtils","./pushGift/PushGiftUtils":"PushGiftUtils","./skyCastle/SkyCastleModule":"SkyCastleModule","./skyCastle/SkyCastleUtils":"SkyCastleUtils","./sociaty/SociatyCtrl":"SociatyCtrl","./sociaty/SociatyModel":"SociatyModel","./task/TaskDayView":"TaskDayView","./task/TaskView":"TaskView"}],MarqueeView:[function(e,t){"use strict";cc._RF.push(t,"ffdc3Di+PJJboKFWimX03PC","MarqueeView");var o=e("../utils/ConstValue");cc.Class({extends:cc.Component,properties:{label:cc.RichText,maskNode:cc.Mask},onLoad:function(){},start:function(){this.m_speed=1,this.m_direction=o.Direction.RIGHT_TO_LEFT,this.label.string="\u8fd9\u662f\u6761\u6d4b\u8bd5\u4fe1\u606f\u3002\u3002\u3002\u3002\u3002\u3002\u3002",this.m_xRightEnd=this.node.x+this.maskNode.node.width*this.maskNode.node.anchorX,this.m_xLeftEnd=this.node.x-this.maskNode.node.width*this.maskNode.node.anchorX;var e=this.label.node.getContentSize();this.m_direction===o.Direction.LEFT_TO_RIGHT?(this.m_xLeftEnd,e.width):this.m_xRightEnd},update:function(){if(this.m_direction===o.Direction.LEFT_TO_RIGHT){var e=this.label.node.getContentSize();this.label.node.x>=this.m_xRightEnd&&(this.label.node.x=this.m_xLeftEnd-e.width),this.label.node.x+=this.m_speed}else{var t=this.label.node.getContentSize();this.label.node.x<=this.m_xLeftEnd-t.width&&(this.label.node.x=this.m_xRightEnd),this.label.node.x-=this.m_speed}}}),cc._RF.pop()},{"../utils/ConstValue":"ConstValue"}],MatchMainView:[function(e,t,o){"use strict";cc._RF.push(t,"4a776WWK1dLZqzMgOt9hnL7","MatchMainView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/Decorators"),s=e("../../utils/ResourceLoader"),c=e("../../modules/base/BaseView"),l=e("../../StaticData/LoadingTipsTableData"),d=e("../../utils/GameUtils"),u=e("../../common/CombatModule"),h=e("../../Global/GameGlobal"),p=e("../../network/ClientNetwork"),f=e("../../network/FightNetwork"),g=e("../../network/LocalMessage"),m=e("../../network/protocol/MatchProtocols"),_=e("../../network/protocol/TypeProtocols"),y=e("../../utils/ConfigUtils"),v=e("../../common/PlayerModule"),C=(e("../../network/protocol/long"),e("../../network/protocol/TypeProtocols")),S=e("../../combat/CombatManager"),T=e("../../utils/ConstValue"),I=e("../../controller/Guide/GuideConfig/GuideConst"),N=e("../../utils/GamePlatform"),b=e("../../modules/manager/LoadResManager"),w=e("../activity/ActivityModule"),E=e("../../modules/base/GameView"),P=e("../../network/FightReconnectLayer"),R=e("../../network/ReconnectLayer"),L=e("../../common/NetworkProtocolCommon"),A=cc._decorator,D=A.ccclass,M=A.property,B=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.search=null,t.ready=null,t.player1=null,t.player2=null,t.player1_ready=null,t.matchTime=null,t.gametype=null,t.matchtip=null,t.time=0,t.matchStatus=0,t.dt=0,t.bLoadEnd=!1,t.loadingTips=[],t.reconnectTime=25,t.curBattleType=0,t.enterBattleTime=0,t.bMatchSuccess=!1,t}return a(t,e),t.path=function(){return"ui/match/match"},t.prototype.onLoad=function(){var e=this;l.LoadingTipsTableData.getDataMap().forEach(function(t){e.loadingTips.push(t)})},t.prototype.init=function(e){var t=this;this.curBattleType=e.ntype,this.search.active=!0,this.ready.active=!1,this.matchTime.string=h.G.StringManager.getString("MATCH_TIME",this.time),d.setRemoteHeadIcon(v.default.getHeadUrl(),v.default.getRoleAttrValByKey(C.ROLE_ATTR_VALUES.ROLE_ATTR_HEADID),this.player1),d.setRemoteHeadIcon(v.default.getHeadUrl(),v.default.getRoleAttrValByKey(C.ROLE_ATTR_VALUES.ROLE_ATTR_HEADID),this.player1_ready);var o=v.default.getRoleAttrValByKey(C.ROLE_ATTR_VALUES.ROLE_ATTR_HEADFRAMEID);o<=0&&(o=200),b.default.loadSpriteFrame("ui/headFrame/frame_"+o).then(function(e){t.search.getChildByName("player1").getChildByName("headframe1").getComponent(cc.Sprite).spriteFrame=e,t.ready.getChildByName("player1").getChildByName("headframe1").getComponent(cc.Sprite).spriteFrame=e}),this.bLoadEnd=!0,this.gametype.string=h.G.StringManager.getString("MATCH_TYPE"+e.ntype);var i=E.default.getViewByName("SkyCastleArenaView");i&&i.view&&(this.gametype.string=h.G.StringManager.getString("MATCH_TYPE11"));var a=E.default.getViewByName("WeekCooperationReliveMainView");a&&a.view&&(this.gametype.string=h.G.StringManager.getString("MATCH_TYPE12"));var n=E.default.getViewByName("AnniversaryMainView");if(n&&n.view&&(this.gametype.string=h.G.StringManager.getString("MATCH_TYPE13")),E.default.getViewNodeByName("FogHiddenMainView")&&(this.gametype.string=h.G.StringManager.getString("MATCH_TYPE14")),E.default.getViewNodeByName("MachineryCityMainView")&&(this.gametype.string=h.G.StringManager.getString("MATCH_TYPE15")),this.showTips(),v.default.getRoleAttrValByKey(C.ROLE_ATTR_VALUES.ROLE_ATTR_GUIDE)+1==I.default.MatchingGuide.guideId&&(this.node.getChildByName("search").getChildByName("quit").getComponent(cc.Button).interactable=!1),u.default.setCombatType(e.ntype),this.schedule(this.updateMatch,1),this.onInitListenEvent(),v.default.getFightBalanceData()){if(1==v.default.getRoleAttrValByKey(C.ROLE_ATTR_VALUES.ROLE_ATTR_GUIDE))return void v.default.setFightBalanceData(null);S.getInstance().showFightResult(v.default.getFightBalanceData())}else this.onCheckReconnectStatus(e);this.curBattleType!=_.FIGHT_TYPE.FIGHT_TYPE_BATTLE_EAT_CHICKEN&&w.default.isChickenDinnerMatching()&&(this.clear(),h.G.StringManager.PopString(h.G.StringManager.getString("CHICKENDINNER_MATCHING")),L.default.callRoleClientLog("CHICKENDINNER_MATCHING8"),console.log("isChickenDinnerMatching code=8"))},t.prototype.onInitListenEvent=function(){p.ClientNetwork.getInstance().listenLocalMessage(g.LOCAL_MESSAGE.LocalMsg_MatchFail,function(){this.clear()}.bind(this),this),p.ClientNetwork.getInstance().listenLocalMessage(g.LOCAL_MESSAGE.LocalMsg_MatchSuccess,function(e){var t=this;this.search.active=!1,this.ready.active=!0,this.time=0,this.bMatchSuccess=!0,e[0].matchRoles.forEach(function(e){e.roleID.equals(v.default.UUID)||(t.player2.node.active=!0)}),e[0].fightType==_.FIGHT_TYPE.FIGHT_TYPE_BATTLE_GOLDENLEAGUE?this.gametype.string=h.G.StringManager.getString("MATCH_TYPE"+_.FIGHT_TYPE.FIGHT_TYPE_BATTLE_GOLDENLEAGUE):e[0].fightType==_.FIGHT_TYPE.FIGHT_TYPE_BATTLE_EAT_CHICKEN?this.gametype.string=h.G.StringManager.getString("MATCH_TYPE"+_.FIGHT_TYPE.FIGHT_TYPE_BATTLE_EAT_CHICKEN):e[0].fightType==_.FIGHT_TYPE.FIGHT_TYPE_BATTLE_SOCIATY_WAR?this.gametype.string=h.G.StringManager.getString("MATCH_TYPE"+_.FIGHT_TYPE.FIGHT_TYPE_BATTLE_SOCIATY_WAR):e[0].fightType==_.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE?this.gametype.string=h.G.StringManager.getString("MATCH_TYPE"+_.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE):e[0].fightType==_.FIGHT_TYPE.FIGHT_TYPE_WEEK_COOPERATION?this.gametype.string=h.G.StringManager.getString("MATCH_TYPE"+_.FIGHT_TYPE.FIGHT_TYPE_WEEK_COOPERATION):e[0].fightType==_.FIGHT_TYPE.FIGHT_TYPE_ANNIVERSARY_TRIAL?this.gametype.string=h.G.StringManager.getString("MATCH_TYPE"+_.FIGHT_TYPE.FIGHT_TYPE_ANNIVERSARY_TRIAL):e[0].fightType==_.FIGHT_TYPE.FIGHT_TYPE_FOG_HIDDEN?this.gametype.string=h.G.StringManager.getString("MATCH_TYPE"+_.FIGHT_TYPE.FIGHT_TYPE_FOG_HIDDEN):e[0].fightType==_.FIGHT_TYPE.FIGHT_TYPE_MACHINARIUM?this.gametype.string=h.G.StringManager.getString("MATCH_TYPE"+_.FIGHT_TYPE.FIGHT_TYPE_MACHINARIUM):this.gametype.string=h.G.StringManager.getString("MATCH_TYPE"+u.default.getCombatType()),this.enterBattleTime=0}.bind(this),this),p.ClientNetwork.getInstance().listenLocalMessage(g.LOCAL_MESSAGE.LocalMsg_LoginFightServerSuccess,function(){this.matchStatus=2,this.clear()}.bind(this),this),p.ClientNetwork.getInstance().listenProtocol(m.MATCH_CLIENT_ENUM.P_Match_Fight,function(e){e.resetPos();var t=new m.S_Match_Fight;if(t.read(e)){var o=t.errorcode;if(8089==o)E.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:h.G.StringManager.getString("BATTLE_VERSION_NOT_MATCH"),confirmCb:function(){}}),this.clear();else if(0!=o){if(1==this.bMatchSuccess)return;h.G.StringManager.PopStringOnce(h.G.StringManager.getString("MATCH_ROOM_FAIL"))}}},this)},t.prototype.onCheckReconnectStatus=function(e){if(S.getInstance().gameState==T.Game_State.Reconnect){this.search.getChildByName("quit").active=!1,this.reconnectTime=10,this.ready.getChildByName("label").getComponent(cc.Label).string=h.G.StringManager.getString("MATCH_RECONNECT")+"("+this.reconnectTime+"s)...",u.default.destroy();var t=v.default.getFightReconnectData();if(t){v.default.getFightReconnectData().fightType==_.FIGHT_TYPE.FIGHT_TYPE_BATTLE||v.default.getFightReconnectData().fightType==_.FIGHT_TYPE.FIGHT_TYPE_BATTLE_SOCIATY_WAR||v.default.getFightReconnectData().fightType==_.FIGHT_TYPE.FIGHT_TYPE_BATTLE_GOLDENLEAGUE||v.default.getFightReconnectData().fightType==_.FIGHT_TYPE.FIGHT_TYPE_BATTLE_EAT_CHICKEN||v.default.getFightReconnectData().fightType==_.FIGHT_TYPE.FIGHT_TYPE_ANNIVERSARY_TRIAL?e.ntype=u.CombatType.SOLO:v.default.getFightReconnectData().fightType==_.FIGHT_TYPE.FIGHT_TYPE_COOPERATION||v.default.getFightReconnectData().fightType==_.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE||v.default.getFightReconnectData().fightType==_.FIGHT_TYPE.FIGHT_TYPE_WEEK_COOPERATION||v.default.getFightReconnectData().fightType==_.FIGHT_TYPE.FIGHT_TYPE_FOG_HIDDEN||v.default.getFightReconnectData().fightType==_.FIGHT_TYPE.FIGHT_TYPE_MACHINARIUM?e.ntype=u.CombatType.COOP:v.default.getFightReconnectData().fightType==_.FIGHT_TYPE.FIGHT_TYPE_DUEL_BATTLE&&(e.ntype=u.CombatType.DUEL),t.matchRoles.forEach(function(e,o){e.roleID.equals(v.default.UUID)?u.default.setMatchBattleInfo(!0,e):t.fightType==_.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE&&o.isNegative()?u.default.setMatchBattleAIInfo(o,e):(u.default.setMatchBattleInfo(!1,e),u.default.setMatchPlayerCards(e.heros))}),u.default.matchModule=t.fightModule,u.default.matchType=t.fightType,u.default.matchToken=t.fightToken,u.default.matchPattern=t.fightPattern,u.default.matchRoleIdentity=t.roleIdentity,u.default.matchSeedIds=t.seedId,u.default.coopBossIdIndexs=t.seedId,u.default.matchType==_.FIGHT_TYPE.FIGHT_TYPE_BATTLE||u.default.matchType==_.FIGHT_TYPE.FIGHT_TYPE_BATTLE_SOCIATY_WAR||u.default.matchType==_.FIGHT_TYPE.FIGHT_TYPE_BATTLE_GOLDENLEAGUE||u.default.matchType==_.FIGHT_TYPE.FIGHT_TYPE_BATTLE_EAT_CHICKEN||u.default.matchType==_.FIGHT_TYPE.FIGHT_TYPE_ANNIVERSARY_TRIAL?u.default.setCombatType(u.CombatType.SOLO):u.default.matchType==_.FIGHT_TYPE.FIGHT_TYPE_COOPERATION||u.default.matchType==_.FIGHT_TYPE.FIGHT_TYPE_BATTLE_GREAT_SAILING||u.default.matchType==_.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE||u.default.matchType==_.FIGHT_TYPE.FIGHT_TYPE_WEEK_COOPERATION||u.default.matchType==_.FIGHT_TYPE.FIGHT_TYPE_FOG_HIDDEN||u.default.matchType==_.FIGHT_TYPE.FIGHT_TYPE_MACHINARIUM?u.default.setCombatType(u.CombatType.COOP):u.default.matchType==_.FIGHT_TYPE.FIGHT_TYPE_DUEL_BATTLE&&u.default.setCombatType(u.CombatType.DUEL),p.ClientNetwork.getInstance().pushLocalMessage(g.LOCAL_MESSAGE.LocalMsg_MatchSuccess,t);var o=0;if(u.default.getCombatType()==u.CombatType.SOLO||u.default.getCombatType()==u.CombatType.DUEL){var i=v.default.getRoleAttrValByKey(C.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE),a=0;if((a=u.default.getCombatType()==u.CombatType.DUEL?101:u.default.matchType==_.FIGHT_TYPE.FIGHT_TYPE_BATTLE_GOLDENLEAGUE?11:u.default.matchType==_.FIGHT_TYPE.FIGHT_TYPE_BATTLE_EAT_CHICKEN?w.default.getChickenDinneBattleMapIdByDate():u.default.matchType==_.FIGHT_TYPE.FIGHT_TYPE_BATTLE_SOCIATY_WAR?13:u.default.matchType==_.FIGHT_TYPE.FIGHT_TYPE_ANNIVERSARY_TRIAL?17:y.default.getInstance().getRoleScoreByScore(i).battleId)>0&&u.default.setBattleMapId(a),(m=y.default.getInstance().getBattleCfg())[a]){var n=m[a].summon_id.split("|");for(var r in n){var s=n[r].split("#");u.default.setCarSummonId(s[0],s[1])}}}else{var c=0,l=y.default.getInstance().getBattleCfg();if(u.default.matchType==_.FIGHT_TYPE.FIGHT_TYPE_COOPERATION)c=10;else if(u.default.matchType==_.FIGHT_TYPE.FIGHT_TYPE_BATTLE_GREAT_SAILING)c=14;else if(u.default.matchType==_.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE){var m;if(c=15,(m=y.default.getInstance().getBattleCfg())[c])for(var r in n=m[c].summon_id.split("|"))s=n[r].split("#"),u.default.setCarSummonId(s[0],s[1])}else u.default.matchType==_.FIGHT_TYPE.FIGHT_TYPE_WEEK_COOPERATION?c=16:u.default.matchType==_.FIGHT_TYPE.FIGHT_TYPE_FOG_HIDDEN?c=18:u.default.matchType==_.FIGHT_TYPE.FIGHT_TYPE_MACHINARIUM&&(c=19);for(var I in l)if(l[I].id==c){u.default.setBattleMapId(l[I].id),l[I].bath_id&&(o=l[I].bath_id);break}}o&&o>0&&u.default.setBatchMonsterId(o),(""!=t.fightServerIp&&0!=t.fightServerPort||""!=t.fightServerIpSSL&&0!=t.fightServerPortSSL)&&(this.scheduleOnce(function(){if(N.GamePlatform.isWechat()||N.GamePlatform.isQQMiniGame()||N.GamePlatform.isByteDanceMiniGame()||N.GamePlatform.isQQGameRoom()||N.GamePlatform.IsSmallBag()||N.GamePlatform.IsMYSmallBag()||N.GamePlatform.IsYLSmallBag()||N.GamePlatform.IsH5SmallBag()||N.GamePlatform.IsMiYaIosH5()||N.GamePlatform.IsLYSmallBag()||N.GamePlatform.isKuaishouMiniGame()||N.GamePlatform.IsDysbSmallBag()||N.GamePlatform.Is5Add7SmallBag()){(N.GamePlatform.IsSmallBag()||N.GamePlatform.IsH5SmallBag())&&(t.fightServerPortSSL=t.fightServerPortSSL%1e3+3e4),console.log("fightServerPortSSL wss"+t.fightServerIpSSL+t.fightServerPortSSL);var e="ws://"+t.fightServerIpSSL;f.FightNetwork.getInstance().Connect(e),P.default.setFightUrl(e)}else console.log("fightServerPortSSL ws"+t.fightServerIp+t.fightServerPort),e="ws://"+t.fightServerIp,f.FightNetwork.getInstance().Connect(e),P.default.setFightUrl(e)},2),this.schedule(this.checkEnterBattleTimeOut,d.getEnterBattleTimeoutTime()))}}},t.prototype.showTips=function(){if(this.loadingTips.length<=0)this.matchtip.node.active=!1;else{this.matchtip.node.active=!0,this.matchtip.node.runAction(cc.fadeIn(0));var e=d.getRand(this.loadingTips.length),t=this.loadingTips[e];this.loadingTips.splice(e,1),this.matchtip.string=t.tips;var o=Math.floor(t.milisec/1e3),i=cc.callFunc(this.showTips,this),a=cc.sequence(cc.delayTime(o),cc.sequence(s.ResourceLoaderLayer.getRandAction(t.actionType),i));a.setTag(6666),this.matchtip.node.stopActionByTag(6666),this.matchtip.node.runAction(a)}},t.prototype.onCancelMatch=function(){var e=new m.C_Match_Cacel;p.ClientNetwork.getInstance().Send(m.MATCH_CLIENT_ENUM.P_Match_Cancel,e),this.clear()},t.prototype.clear=function(){p.ClientNetwork.getInstance().removeLocalMessage(g.LOCAL_MESSAGE.LocalMsg_MatchFail,this),this.unschedule(this.updateMatch),this.cancelEnterBattleTimeOut(),this.closeView()},t.prototype.updateMatch=function(){if(0==this.matchStatus){if(this.time++,this.matchTime.string=h.G.StringManager.getString("MATCH_TIME",this.time),2==this.time&&S.getInstance().gameState!=T.Game_State.Reconnect&&(this.curBattleType==u.CombatType.SOLO||this.curBattleType==u.CombatType.COOP||this.curBattleType==u.CombatType.DUEL)){if(1==this.bMatchSuccess)return;var e=new m.C_Match_Fight;if(this.curBattleType==u.CombatType.SOLO){e.fightType=_.FIGHT_TYPE.FIGHT_TYPE_BATTLE;var t=E.default.getViewByName("AnniversaryMainView");t&&t.view&&(e.fightType=_.FIGHT_TYPE.FIGHT_TYPE_ANNIVERSARY_TRIAL)}else if(this.curBattleType==u.CombatType.COOP){e.fightType=_.FIGHT_TYPE.FIGHT_TYPE_COOPERATION;var o=E.default.getViewByName("SkyCastleArenaView");o&&o.view&&(e.fightType=_.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE);var i=E.default.getViewByName("WeekCooperationReliveMainView");i&&i.view&&(e.fightType=_.FIGHT_TYPE.FIGHT_TYPE_WEEK_COOPERATION),E.default.getViewNodeByName("FogHiddenMainView")&&(e.fightType=_.FIGHT_TYPE.FIGHT_TYPE_FOG_HIDDEN),E.default.getViewNodeByName("MachineryCityMainView")&&(e.fightType=_.FIGHT_TYPE.FIGHT_TYPE_MACHINARIUM)}else this.curBattleType==u.CombatType.DUEL&&(e.fightType=_.FIGHT_TYPE.FIGHT_TYPE_DUEL_BATTLE);e.params.push(d.getConfigVersion()),p.ClientNetwork.getInstance().Send(m.MATCH_CLIENT_ENUM.P_Match_Fight,e,!1)}}else 2==this.matchStatus&&(this.matchStatus=-1);S.getInstance().gameState==T.Game_State.Reconnect&&(this.ready.getChildByName("label").getComponent(cc.Label).string=h.G.StringManager.getString("MATCH_RECONNECT")+"("+(this.reconnectTime-this.time)+"s)...",this.reconnectTime<=this.time&&(S.getInstance().gameState=T.Game_State.End,d.setTouchEnabled(!0)))},t.prototype.checkEnterBattleTimeOut=function(){R.default.setEnterBattleTimeout(!0),R.default.ShowReconnectLayer()},t.prototype.cancelEnterBattleTimeOut=function(){R.default.setEnterBattleTimeout(!1),this.unschedule(this.checkEnterBattleTimeOut)},t.prototype.onDestroy=function(){},n([M(cc.Node)],t.prototype,"search",void 0),n([M(cc.Node)],t.prototype,"ready",void 0),n([M(cc.Sprite)],t.prototype,"player1",void 0),n([M(cc.Sprite)],t.prototype,"player2",void 0),n([M(cc.Sprite)],t.prototype,"player1_ready",void 0),n([M(cc.Label)],t.prototype,"matchTime",void 0),n([M(cc.Label)],t.prototype,"gametype",void 0),n([M(cc.Label)],t.prototype,"matchtip",void 0),n([r.Register_Class,D],t)}(c.default);o.default=B,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/LoadingTipsTableData":"LoadingTipsTableData","../../combat/CombatManager":"CombatManager","../../common/CombatModule":"CombatModule","../../common/NetworkProtocolCommon":"NetworkProtocolCommon","../../common/PlayerModule":"PlayerModule","../../controller/Guide/GuideConfig/GuideConst":"GuideConst","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/base/GameView":"GameView","../../modules/manager/LoadResManager":"LoadResManager","../../network/ClientNetwork":"ClientNetwork","../../network/FightNetwork":"FightNetwork","../../network/FightReconnectLayer":"FightReconnectLayer","../../network/LocalMessage":"LocalMessage","../../network/ReconnectLayer":"ReconnectLayer","../../network/protocol/MatchProtocols":"MatchProtocols","../../network/protocol/TypeProtocols":"TypeProtocols","../../network/protocol/long":"long","../../utils/ConfigUtils":"ConfigUtils","../../utils/ConstValue":"ConstValue","../../utils/GamePlatform":"GamePlatform","../../utils/GameUtils":"GameUtils","../../utils/ResourceLoader":"ResourceLoader","../activity/ActivityModule":"ActivityModule"}],MatchProtocols:[function(e,t,o){"use strict";cc._RF.push(t,"9e4daAmiilIaK3VDAKeebG5","MatchProtocols");var i=e("BaseProtocols"),a=(e("DataViewRW"),e("ObjCollection")),n=e("long"),r=e("./BaseProtocols").T_Reward,s=e("./BaseProtocols").T_Fight_Extra_Data;(function(e){e[e.P_Match_Begin=9e6]="P_Match_Begin",e[e.P_Match_Fight=9000001]="P_Match_Fight",e[e.P_Match_Cancel=9000002]="P_Match_Cancel",e[e.P_Match_Result=9000003]="P_Match_Result",e[e.P_Match_Duel_Fight=9000004]="P_Match_Duel_Fight",e[e.P_Match_Duel_Cancel=9000005]="P_Match_Duel_Cancel",e[e.P_Match_Chicken_Jion=9000006]="P_Match_Chicken_Jion",e[e.P_Match_Chicken_Quit=9000007]="P_Match_Chicken_Quit",e[e.P_Match_Chicken_Result=9000008]="P_Match_Chicken_Result",e[e.P_Match_Chicken_RankList=9000009]="P_Match_Chicken_RankList"})(o.MATCH_CLIENT_ENUM||(o.MATCH_CLIENT_ENUM={}));var c=function(){function e(){this.fightType=0,this.params=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.fightType=e.getInt32();var t=e.getUint32();if(e.getLen()-e.getPos()<4*t)return!1;this.params=[];for(var o=0;o<t;++o){var i;i=e.getInt32(),this.params.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.fightType),e.setUint32(this.params.length),this.params.forEach(function(t){e.setInt32(t)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Match_Fight=c;var l=function(){function e(){this.errorcode=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Match_Fight=l;var d=function(){function e(){this.ret=0,this.fightPattern=0,this.fightType=0,this.fightModule=0,this.roleIdentity=0,this.matchRoles=new a.ObjMap,this.fightServerIp="",this.fightServerPort=0,this.fightServerIpSSL="",this.fightServerPortSSL=0,this.fightToken="",this.seedId=[],this.extraData=new a.ObjMap,this.bossIdIndexs=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<24)return!1;this.ret=e.getInt32(),this.fightPattern=e.getInt32(),this.fightType=e.getInt32(),this.fightModule=e.getInt32(),this.roleIdentity=e.getInt32();var t=e.getUint32();this.matchRoles.clear();for(var o=0;o<t;++o){var a;a=e.getLong();var n=new i.T_RoleAbstract;if(!n.read(e))return!1;this.matchRoles.set(a,n)}if(e.getLen()-e.getPos()<4)return!1;var r=e.getUint32();if(e.getLen()-e.getPos()<r)return!1;if(this.fightServerIp=e.getString(r),e.getLen()-e.getPos()<8)return!1;this.fightServerPort=e.getInt32();var c=e.getUint32();if(e.getLen()-e.getPos()<c)return!1;if(this.fightServerIpSSL=e.getString(c),e.getLen()-e.getPos()<8)return!1;this.fightServerPortSSL=e.getInt32();var l=e.getUint32();if(e.getLen()-e.getPos()<l)return!1;if(this.fightToken=e.getString(l),e.getLen()-e.getPos()<4)return!1;var d=e.getUint32();if(e.getLen()-e.getPos()<4*d)return!1;this.seedId=[];for(var u=0;u<d;++u){var h;h=e.getInt32(),this.seedId.push(h)}if(e.getLen()-e.getPos()<4)return!1;var p=e.getUint32();this.extraData.clear();for(var f=0;f<p;++f){var g;g=e.getLong();var m=new s;if(!m.read(e))return!1;this.extraData.set(g,m)}if(e.getLen()-e.getPos()<4)return!1;var _=e.getUint32();if(e.getLen()-e.getPos()<4*_)return!1;this.bossIdIndexs=[];for(var y=0;y<_;++y){var v;v=e.getInt32(),this.bossIdIndexs.push(v)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.ret),e.setInt32(this.fightPattern),e.setInt32(this.fightType),e.setInt32(this.fightModule),e.setInt32(this.roleIdentity),e.setUint32(this.matchRoles.size),this.matchRoles.forEach(function(t,o){e.setLong(o),t.writeNoEnd(e)}),e.setString(this.fightServerIp),e.setInt32(this.fightServerPort),e.setString(this.fightServerIpSSL),e.setInt32(this.fightServerPortSSL),e.setString(this.fightToken),e.setUint32(this.seedId.length),this.seedId.forEach(function(t){e.setInt32(t)}),e.setUint32(this.extraData.size),this.extraData.forEach(function(t,o){e.setLong(o),t.writeNoEnd(e)}),e.setUint32(this.bossIdIndexs.length),this.bossIdIndexs.forEach(function(t){e.setInt32(t)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Match_Result=d;var u=function(){function e(){}return e.prototype.read=function(){return!0},e.prototype.writeNoEnd=function(){},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Match_Cacel=u;var h=function(){function e(){this.errorcode=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Match_Cancel=h;var p=function(){function e(){this.fightType=0,this.useRoom=0,this.roomID="",this.longRoomID="",this.params=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<12)return!1;this.fightType=e.getInt32(),this.useRoom=e.getInt32();var t=e.getUint32();if(e.getLen()-e.getPos()<t)return!1;if(this.roomID=e.getString(t),e.getLen()-e.getPos()<4)return!1;var o=e.getUint32();if(e.getLen()-e.getPos()<o)return!1;if(this.longRoomID=e.getString(o),e.getLen()-e.getPos()<4)return!1;var i=e.getUint32();if(e.getLen()-e.getPos()<4*i)return!1;this.params=[];for(var a=0;a<i;++a){var n;n=e.getInt32(),this.params.push(n)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.fightType),e.setInt32(this.useRoom),e.setString(this.roomID),e.setString(this.longRoomID),e.setUint32(this.params.length),this.params.forEach(function(t){e.setInt32(t)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Match_Duel_Fight=p;var f=function(){function e(){this.errorcode=0,this.fightType=0,this.roomID="",this.longRoomID="",this.roleAbstract=new i.T_RoleAbstract}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<12)return!1;this.errorcode=e.getInt32(),this.fightType=e.getInt32();var t=e.getUint32();if(e.getLen()-e.getPos()<t)return!1;if(this.roomID=e.getString(t),e.getLen()-e.getPos()<4)return!1;var o=e.getUint32();return!(e.getLen()-e.getPos()<o||(this.longRoomID=e.getString(o),!this.roleAbstract.read(e)))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setInt32(this.fightType),e.setString(this.roomID),e.setString(this.longRoomID),this.roleAbstract.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Match_Duel_Fight=f;var g=function(){function e(){this.roomID="",this.longRoomID=""}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();if(e.getLen()-e.getPos()<t)return!1;if(this.roomID=e.getString(t),e.getLen()-e.getPos()<4)return!1;var o=e.getUint32();return!(e.getLen()-e.getPos()<o||(this.longRoomID=e.getString(o),0))},e.prototype.writeNoEnd=function(e){e.setString(this.roomID),e.setString(this.longRoomID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Match_Duel_Cancel=g;var m=function(){function e(){this.errorcode=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Match_Duel_Cancel=m;var _=function(){function e(){this.params=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();if(e.getLen()-e.getPos()<4*t)return!1;this.params=[];for(var o=0;o<t;++o){var i;i=e.getInt32(),this.params.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setUint32(this.params.length),this.params.forEach(function(t){e.setInt32(t)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Match_Chicken_Jion=_;var y=function(){function e(){this.errorcode=0,this.chickenRoomID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.errorcode=e.getInt32(),this.chickenRoomID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setInt32(this.chickenRoomID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Match_Chicken_Jion=y;var v=function(){function e(){this.params=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();if(e.getLen()-e.getPos()<4*t)return!1;this.params=[];for(var o=0;o<t;++o){var i;i=e.getInt32(),this.params.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setUint32(this.params.length),this.params.forEach(function(t){e.setInt32(t)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Match_Chicken_Quit=v;var C=function(){function e(){this.errorcode=0,this.chickenRoomID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.errorcode=e.getInt32(),this.chickenRoomID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setInt32(this.chickenRoomID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Match_Chicken_Quit=C;var S=function(){function e(){this.rank=0,this.roleId=n.fromValue(0),this.roleName="",this.sociatyName="",this.headID=0,this.headUrl="",this.headFrameID=0,this.killNum=0,this.isLive=!1}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<16)return!1;this.rank=e.getInt32(),this.roleId=e.getLong();var t=e.getUint32();if(e.getLen()-e.getPos()<t)return!1;if(this.roleName=e.getString(t),e.getLen()-e.getPos()<4)return!1;var o=e.getUint32();if(e.getLen()-e.getPos()<o)return!1;if(this.sociatyName=e.getString(o),e.getLen()-e.getPos()<8)return!1;this.headID=e.getInt32();var i=e.getUint32();return!(e.getLen()-e.getPos()<i||(this.headUrl=e.getString(i),e.getLen()-e.getPos()<9||(this.headFrameID=e.getInt32(),this.killNum=e.getInt32(),this.isLive=e.getBool(),0)))},e.prototype.writeNoEnd=function(e){e.setInt32(this.rank),e.setLong(this.roleId),e.setString(this.roleName),e.setString(this.sociatyName),e.setInt32(this.headID),e.setString(this.headUrl),e.setInt32(this.headFrameID),e.setInt32(this.killNum),e.setBool(this.isLive)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.Chicken_RankListData=S;var T=function(){function e(){this.ranklistdata=new S,this.prizes=[]}return e.prototype.read=function(e){if(!this.ranklistdata.read(e))return!1;if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();this.prizes=[];for(var o=0;o<t;++o){var i=new r;if(!i.read(e))return!1;this.prizes.push(i)}return!0},e.prototype.writeNoEnd=function(e){this.ranklistdata.writeNoEnd(e),e.setUint32(this.prizes.length),this.prizes.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Match_Chicken_Result=T;var I=function(){function e(){this.params=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();if(e.getLen()-e.getPos()<4*t)return!1;this.params=[];for(var o=0;o<t;++o){var i;i=e.getInt32(),this.params.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setUint32(this.params.length),this.params.forEach(function(t){e.setInt32(t)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Match_Chicken_RankList=I;var N=function(){function e(){this.ranklist=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();this.ranklist=[];for(var o=0;o<t;++o){var i=new S;if(!i.read(e))return!1;this.ranklist.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setUint32(this.ranklist.length),this.ranklist.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Match_Chicken_RankList=N,cc._RF.pop()},{"./BaseProtocols":"BaseProtocols",BaseProtocols:"BaseProtocols",DataViewRW:"DataViewRW",ObjCollection:"ObjCollection",long:"long"}],MatchingCoopGuideCfg:[function(e,t,o){"use strict";cc._RF.push(t,"85db6axrXRNNoPCd523YTTu","MatchingCoopGuideCfg"),Object.defineProperty(o,"__esModule",{value:!0}),o.task=void 0,o.task={},cc._RF.pop()},{}],MatchingGuideCfg:[function(e,t,o){"use strict";cc._RF.push(t,"b4519lxXz9LZKGLJ94NCtqr","MatchingGuideCfg"),Object.defineProperty(o,"__esModule",{value:!0}),o.task=void 0;var i=e("../GuideCommand"),a=e("./GuideConst"),n=e("../../../modules/base/GameView");o.task={name:"\u5339\u914d\u5f15\u5bfc\u914d\u7f6e",guideId:a.default.MatchingGuide.guideId,steps:[{desc:"\u6b65\u9aa41",command:{cmd:i.Command.Dialogue,args:["8",!0]}},{desc:"\u6b65\u9aa42",command:[{cmd:i.Command.Dialogue,args:"9"},{cmd:i.Command.Click,args:"MainSceneView>UI_Root>RightDownNode>solo"}],delayTime:.5,delayClick:0},{desc:"\u6b65\u9aa43",command:[{cmd:i.Command.Dialogue,args:"10"},{cmd:i.Command.Click,args:"BattleRoomMainView>step1>vsMatch"}],delayTime:1,delayClick:0,bSendGuideEnd:!0}],condition:function(){var e=n.default.getViewByName("MainSceneView");return!(!e||!e.view)}},cc._RF.pop()},{"../../../modules/base/GameView":"GameView","../GuideCommand":"GuideCommand","./GuideConst":"GuideConst"}],ModelManager:[function(e,t,o){"use strict";cc._RF.push(t,"fb80eIxM4BBVan9F4LUaVGM","ModelManager");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0});var n=e("../base/BaseSingle"),r=e("../../utils/LogUtil"),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.onCreate=function(){this._modelList=new Map},t.prototype.onDestroy=function(){},t.prototype.getModel=function(e,t){void 0===t&&(t=!0);var o=this._modelList.get(e);return!o&&t&&(this.registerModel(e),o=this._modelList.get(e)),o},t.prototype.registerModel=function(e){if(this._modelList.get(e))r.default.warn("Model \u5df2\u7ecf\u5b58\u5728");else{var t=new e;t.__init__(),this._modelList.set(e,t)}},t.prototype.unregisterModel=function(e){this._modelList.get(e)?(this._modelList.get(e).__uninit__(),this._modelList.delete(e)):r.default.warn("Model \u5b58\u5728, \u65e0\u6cd5\u53d6\u6d88\u6ce8\u518c")},t}(n.BaseSingle);o.default=n.SingleFactory.getInstance(s),cc._RF.pop()},{"../../utils/LogUtil":"LogUtil","../base/BaseSingle":"BaseSingle"}],ModifyNameNumTableData:[function(e,t,o){"use strict";cc._RF.push(t,"76255ED0v5C65lYfigBn36q","ModifyNameNumTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.ModifyNameNumTableData=void 0;var i=e("../TableReader"),a=e("./BaseTableData"),n=function(){function e(){this.id=0,this.cost=new Array}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber();for(var o=e.getString(),n=new i.TableReader(o);n.getPos()<n.getLen();){var r=new a.DropItem;r.readOriginal(n),this.cost.push(r)}},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"ModifyNameNumTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.ModifyNameNumTableData=n,cc._RF.pop()},{"../TableReader":"TableReader","./BaseTableData":"BaseTableData"}],NameManager:[function(e,t,o){"use strict";cc._RF.push(t,"e288bKfK+RAf5xJi3FeWVK8","NameManager"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("./GameUtils"),a=e("../StaticData/NameTableData"),n=function(){function e(){this.vecLastNameGirl=[],this.vecFirstNameGirl=[],this.vecLastNameBoy=[],this.vecFirstNameBoy=[],this.bInit=!1,this.vecLastNameGirl=[],this.vecFirstNameGirl=[],this.vecLastNameBoy=[],this.vecFirstNameBoy=[],this.bInit=!1}return e.getInstance=function(){return this.Instance||(this.Instance=new e,this.Instance.initData()),this.Instance},e.prototype.initData=function(){var e=this;this.bInit||(this.bInit=!0,a.NameTableData.getDataMap().forEach(function(t){t.sex?e.vecLastNameGirl.push(t.lastname):e.vecLastNameBoy.push(t.lastname),t.sex?e.vecFirstNameGirl.push(t.firstname):e.vecFirstNameBoy.push(t.firstname)}))},e.prototype.getName=function(e){var t="";t+=1==e?this.vecLastNameGirl[i.getRand(this.vecLastNameGirl.length)]:this.vecLastNameBoy[i.getRand(this.vecLastNameBoy.length)];for(var o=0;1!=o;++o)t+=1==e?this.vecFirstNameGirl[i.getRand(this.vecFirstNameGirl.length)]:this.vecFirstNameBoy[i.getRand(this.vecFirstNameBoy.length)];return t},e.Instance=null,e}();o.default=n,cc._RF.pop()},{"../StaticData/NameTableData":"NameTableData","./GameUtils":"GameUtils"}],NameTableData:[function(e,t,o){"use strict";cc._RF.push(t,"3dcdcg4/GBL7ZrPb2WPdWxa","NameTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.NameTableData=void 0;var i=e("../TableReader"),a=function(){function e(){this.id=0,this.sex=0,this.lastname="",this.firstname=""}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.sex=e.getNumber(),this.lastname=e.getString(),this.firstname=e.getString()},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"NameTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.NameTableData=a,cc._RF.pop()},{"../TableReader":"TableReader"}],NavigationBarView:[function(e,t){"use strict";cc._RF.push(t,"4d7e1mX3SFLhYeMV9takdEE","NavigationBarView"),cc.Class({extends:cc.Component,properties:{},init:function(e){this.parent=e},onBtnBack:function(){this.parent.onClose()},onBtnGoHome:function(){this.parent.onGoHome()}}),cc._RF.pop()},{}],NavigationIntroduceView:[function(e,t,o){"use strict";cc._RF.push(t,"6ff33c4UthHHqrf4N/Eegpd","NavigationIntroduceView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=cc._decorator.ccclass,l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.path=function(){return"ui/navigation/NavigationIntroduce"},n([s.Register_Class,c],t)}(r.default);o.default=l,cc._RF.pop()},{"../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators"}],NavigationMainView:[function(e,t,o){"use strict";cc._RF.push(t,"2a3b1JX401GOKSzwSg29eE4","NavigationMainView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../Global/GameGlobal"),s=e("../../modules/base/BaseView"),c=e("../../modules/base/Decorators"),l=e("../../utils/List"),d=e("../../network/ClientNetwork"),u=e("../../network/LocalMessage"),h=e("../../modules/base/GameView"),p=e("../../common/PlayerModule"),f=e("../../network/protocol/RoleProtocols"),g=e("../../utils/GameTools"),m=e("../../StaticData/ActivityTableData"),_=e("../../network/protocol/ActivityProtocols"),y=e("../../network/protocol/MatchProtocols"),v=e("../../network/protocol/TypeProtocols"),C=e("../../utils/GameUtils"),S=e("../../StaticData/GreatSailingTableData"),T=e("../../StaticData/GreatSailingRankListTableData"),I=e("../activity/ActivityModule"),N=e("../../StaticData/GreatSailingRefreshTableData"),b=e("../../network/protocol/TypeProtocols"),w=e("../../common/NetworkProtocolCommon"),E=cc._decorator,P=E.ccclass,R=E.property,L=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.rankListPanelNode=null,t.rewardListPanelNode=null,t.shopPanelNode=null,t.myRankInfoNode=null,t.shopItemPrefab=null,t.rewardItemPrefab=null,t.titleTimeLab=null,t.battleCardLayout=null,t.joinBtnNode=null,t.refreshBtnNode=null,t.readyPrefabNode=null,t.conchNumLab=null,t.spineNode=null,t.refreshExpendNode=null,t.tRankListData=[],t.activityIsOpen=!1,t.readNodePanel=null,t.curMaxWaveCount=0,t.curDayWave=0,t.rankPageIdx=1,t.rankMaxPage=0,t.failCount=0,t.refreshCardCount=0,t}return a(t,e),t.path=function(){return"ui/navigation/NavigationMain"},t.prototype.onLoad=function(){this.initListenMessageEvent();var e=new _.C_Activity_GetGreatSailingData;e.activityID=_.ACTIVITY_ID_ENUM.P_Activity_Navigation,d.ClientNetwork.getInstance().Send(_.ACTIVITY_CLIENT_ENUM.P_Activity_GetGreatSailingData,e);var t=h.default.getViewByName("ActivityMainView");if(t&&t.view&&t.view.node){t.view.node.active=!1;var o=t.view.node.parent.getChildByName("UI_Mask_ActivityMainView");o&&(o.active=!1)}},t.prototype.start=function(){var e=new f.C_Role_GetRandShop;e.shopID=4,d.ClientNetwork.getInstance().Send(f.ROLE_CLIENT_ENUM.P_Role_GetRandShop,e),this.initRewardsListInfo(),this.initSpine(),this.rankListPanelNode.node.on("bounce-bottom",this.onScrollBottom,this)},t.prototype.onScrollBottom=function(){this.rankPageIdx>=this.rankMaxPage||(this.rankPageIdx++,this.callRankListData())},t.prototype.initListenMessageEvent=function(){var e=this;d.ClientNetwork.getInstance().listenProtocol(_.ACTIVITY_CLIENT_ENUM.P_Activity_SyncGreatSailingData,function(t){t.resetPos();var o=new _.S_Activity_SyncGreatSailingData;o.read(t)&&(0==o.error&&o.activityID==_.ACTIVITY_ID_ENUM.P_Activity_Navigation?(e.onRefreshNavigationInfo(o),e.callRankListData()):r.G.StringManager.PopString("\u5927\u822a\u6d77\u6570\u636e\u9519\u8bef "+o.error))},this),d.ClientNetwork.getInstance().listenProtocol(_.ACTIVITY_CLIENT_ENUM.P_Activity_GreatSailingRelive,function(t){t.resetPos();var o=new _.S_Activity_GreatSailingRelive;o.read(t)&&(0===o.errorcode?e.showReadView():r.G.StringManager.PopString("\u5927\u822a\u6d77\u590d\u6d3b\u6570\u636e\u9519\u8bef "+o.errorcode))},this),d.ClientNetwork.getInstance().listenProtocol(f.ROLE_CLIENT_ENUM.P_Role_SynRandShopData,function(t){t.resetPos();var o=new f.S_Role_SynRandShopData;o.read(t)&&4===o.shopID&&e.initShopListInfo(o.shopData)},this),d.ClientNetwork.getInstance().listenProtocol(f.ROLE_CLIENT_ENUM.P_Role_RandShopBuy,function(t){t.resetPos();var o=new f.S_Role_RandShopBuy;if(o.read(t))if(0===o.errorcode&&o.prize.length>0){h.default.addPopView("BaseCtrl","AcquirePopupView","AcquirePopupView",{items:o.prize});var i=h.default.getViewByName("ShopConfirmBuy");i&&i.view&&(i.view.node.active=!1,i.view.closeView()),e.conchNumLab.string=p.default.getItemCountByBag(1011)}else r.G.StringManager.PopString("S_Role_RandShopBuy ERROR  "+o.errorcode)},this),d.ClientNetwork.getInstance().listenLocalMessage(u.LOCAL_MESSAGE.LocalMsg_MatchSuccess,function(){},this),d.ClientNetwork.getInstance().listenProtocol(y.MATCH_CLIENT_ENUM.P_Match_Fight,function(t){t.resetPos();var o=new y.S_Match_Fight;if(o.read(t)){var i=o.errorcode;8089==i?(e.unscheduleAllCallbacks(),h.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:r.G.StringManager.getString("BATTLE_VERSION_NOT_MATCH"),confirmCb:function(){var t=new y.C_Match_Cacel;d.ClientNetwork.getInstance().Send(y.MATCH_CLIENT_ENUM.P_Match_Cancel,t),e.onClickCloseCallBack()}})):0!=i&&r.G.StringManager.PopStringOnce(r.G.StringManager.getString("MATCH_ROOM_FAIL"))}},this)},t.prototype.callRankListData=function(){var e=this,t=g.default.getDevelopRankListUrl();t+="?",t+="ranktype="+v.RANKLIST_TYPE.RANKLIST_TYPE_GREATSAILING,t+="&roleid="+p.default.uuidTransformRoieId(),t+="&page="+this.rankPageIdx;var o=new XMLHttpRequest;o.onreadystatechange=function(){if(4==o.readyState&&o.status>=200&&o.status<400){var t=o.responseText.toString();t=(t=(t=t.replace('"','"')).replace("\ufeff","")).replace(" ","");var i=JSON.parse(t),a=i.page;e.rankMaxPage=i.maxpage,Number(i.ranktype)==v.RANKLIST_TYPE.RANKLIST_TYPE_GREATSAILING&&Number(a)==e.rankPageIdx&&e.resolvingNavigationRankData(i)}},o.open("GET",t,!0),o.send()},t.prototype.onRefreshRankEvent=function(e,t){var o=this.tRankListData[t];e.getComponent("NavigationRankItem").show(o,t)},t.prototype.resolvingNavigationRankData=function(e){1==Number(e.page)&&(this.tRankListData=[]);var t=this.myRankInfoNode.getChildByName("my_rank_num").getComponent(cc.Label),o=this.myRankInfoNode.getChildByName("my_score_label").getComponent(cc.Label),i=this.myRankInfoNode.getChildByName("my_time_label").getComponent(cc.Label),a=0,n=0;if("playerrank"in e&&(t.string=e.playerrank,"playerdata"in e)){var r=JSON.parse(e.playerdata);a=r.round,n=r.totaltime}if(0==Number(a)&&(a=this.curDayWave),o.string=a.toString(),i.string=function(e){var t=e%6e4/1e3;return parseInt((e%36e5/6e4).toString())+" \u5206 "+t+" \u79d2 "}.call(this,1e3*n),i.node.active=!(n<=0),"ranklist"in e){var s=e.ranklist;for(var c in s)Object.prototype.hasOwnProperty.call(s,c)&&this.tRankListData.push(s[c])}this.rankListPanelNode.numItems=this.tRankListData.length},t.prototype.initRewardsListInfo=function(){var e=this,t=[];T.GreatSailingRankListTableData.getDataMap().forEach(function(e){t.push(e)}),t.forEach(function(t,o){var i=cc.instantiate(e.rewardItemPrefab);i.parent=e.rewardListPanelNode.getComponent(cc.ScrollView).content,o>=1&&(o+=2),i.getComponent("ActivityGoldenLeagueRewardtem").show(t,o)})},t.prototype.initShopListInfo=function(e){var t=this;this.shopPanelNode.getChildByName("ShopLyoutNode").destroyAllChildren(),this.scheduleOnce(function(){e.positions.forEach(function(e,o){var i=cc.instantiate(t.shopItemPrefab);i.parent=t.shopPanelNode.getChildByName("ShopLyoutNode"),i.getComponent("NavigationShopItem").init(e,o,t.callRoleRandShopBuy),i.scale=.8})}),this.conchNumLab.string=p.default.getItemCountByBag(1011)},t.prototype.checkIsOpen=function(){var e=m.ActivityTableData.getById(_.ACTIVITY_ID_ENUM.P_Activity_Navigation),t=p.default.getServersTime(),o=new Date(1e3*t),i=(o.getSeconds(),o.getMinutes(),o.getHours(),o.getDay()),a=o.getDate(),n=o.getFullYear(),r=o.getMonth()+1;if(e.param2<0||i==e.param2){if(e.param4<=0&&e.param5<=0)return!0;var s=n+"-"+r+"-"+a+" "+e.param4.toString().slice(0,-2)+":"+e.param4.toString().slice(-2)+":00",c=g.default.timeToTimestamp(s),l=n+"-"+r+"-"+a+" "+e.param5.toString().slice(0,-2)+":"+e.param5.toString().slice(-2)+":00",d=g.default.timeToTimestamp(l);if(t>=c&&t<=d)return!0}return!1},t.prototype.checkScheduleNavigationState=function(){var e=this,t=m.ActivityTableData.getById(_.ACTIVITY_ID_ENUM.P_Activity_Navigation);t.param4<=0&&t.param5<=0?this.titleTimeLab.string=t.extranceUrl.split("|")[0]:this.schedule(function(){if(!cc.isValid(e.node))return!1;if(e.checkIsOpen()){var o=p.default.getServersTime(),i=new Date(1e3*o),a=i.getDate(),n=i.getFullYear()+"-"+(i.getMonth()+1)+"-"+a+" "+t.param5.toString().slice(0,-2)+":"+t.param5.toString().slice(-2)+":00",s=g.default.timeToTimestamp(n);e.titleTimeLab.string=r.G.StringManager.getString("WUDAOHUI_OPEN_TIP")+function(e){var t=e%36e5/6e4;return parseInt((e%864e5/36e5).toString())+" \u5c0f\u65f6 "+Math.ceil(t)+" \u5206\u949f "}.call(e,1e3*(s-o))}else e.titleTimeLab.string=t.extranceUrl.split("|")[0]},1)},t.prototype.onRefreshNavigationInfo=function(e){var t=this;this.battleCardLayout.node.destroyAllChildren();var o=S.GreatSailingTableData.getById(e.cardId).cardGroup;o&&o.length>0&&o.forEach(function(e){g.default.createNormalItems(e,1,t.battleCardLayout.node,function(e){e.scale=.5,e.getChildByName("num").active=!1})});var i=m.ActivityTableData.getById(_.ACTIVITY_ID_ENUM.P_Activity_Navigation);if(e.failCount>=i.param3&&(g.default.setNodeBright(this.joinBtnNode,!1),g.default.setNodeBright(this.refreshBtnNode,!1)),this.activityIsOpen=e.isOpen,I.default.setNavigationBattleCardGroupId(e.cardId),this.curMaxWaveCount=e.historyMaxScore,this.curDayWave=e.todayScore,this.failCount=e.failCount,this.refreshCardCount=e.refleshCardNum,this.refreshCardCount>=N.GreatSailingRefreshTableData.getDataMap().size)this.refreshExpendNode.active=!1,g.default.setNodeBright(this.refreshBtnNode,!1);else{var a=N.GreatSailingRefreshTableData.getById(this.refreshCardCount+1).reliveCost[0].dropNum||0,n=a.toString();0==a&&(n=r.G.StringManager.getString("FREE_LABEL")),this.refreshExpendNode.children[0].getComponent(cc.Label).string=n}var s=N.GreatSailingRefreshTableData.getDataMap().size-this.refreshCardCount;s<=0&&(s=0),this.refreshBtnNode.children[0].children[1].getComponent(cc.Label).string="("+s+"/"+N.GreatSailingRefreshTableData.getDataMap().size+")"},t.prototype.initSpine=function(){var e=this,t=function(){var t=["idle","idle2","idle3","idle4"],o=g.default.getRandomInt(0,t.length);e.spineNode.getComponent(sp.Skeleton).setAnimation(0,t[o],!1),e.spineNode.getComponent(sp.Skeleton).setTrackEventListener(e.spineNode.getComponent(sp.Skeleton).getCurrent(0),function(t,o){"end"===(o.data?o.data.name:"")&&e.spineNode.getComponent(sp.Skeleton).setAnimation(0,"idle",!0)})};this.schedule(t,15),t.call(this)},t.prototype.onClickRankCallBack=function(){1!=this.rankListPanelNode.node.active&&(this.rankListPanelNode.node.active=!0,this.rewardListPanelNode.active=!1,this.myRankInfoNode.active=!0,this.shopPanelNode.active=!1)},t.prototype.onClickRewardCallBack=function(){1!=this.rewardListPanelNode.active&&(this.rankListPanelNode.node.active=!1,this.rewardListPanelNode.active=!0,this.myRankInfoNode.active=!1,this.shopPanelNode.active=!1,this.rewardListPanelNode.getComponent(cc.ScrollView).scrollToTop())},t.prototype.onClickShopCallBack=function(){1!=this.shopPanelNode.active&&(this.shopPanelNode.active=!0,this.rewardListPanelNode.active=!1,this.myRankInfoNode.active=!1,this.rankListPanelNode.node.active=!1)},t.prototype.onClickJoinCallBack=function(){var e=m.ActivityTableData.getById(_.ACTIVITY_ID_ENUM.P_Activity_Navigation);if(p.default.getRoleAttrValByKey(b.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE)<e.param1)return r.G.StringManager.PopString(r.G.StringManager.getString("WUDAOHUI_SCORE_TIP",e.param1));if(0==this.activityIsOpen)return r.G.StringManager.PopWorldString("coopActivity_time_end");var t=m.ActivityTableData.getById(_.ACTIVITY_ID_ENUM.P_Activity_Navigation);if(this.failCount>=t.param3)return r.G.StringManager.PopWorldString("chaogong_today_num_is_complete");this.showReadView()},t.prototype.showReadView=function(){if(I.default.isChickenDinnerMatching())return r.G.StringManager.PopString(r.G.StringManager.getString("CHICKENDINNER_MATCHING")),w.default.callRoleClientLog("CHICKENDINNER_MATCHING10"),void console.log("isChickenDinnerMatching code=10");var e=cc.instantiate(this.readyPrefabNode);e.parent=this.node,e.width=2*cc.winSize.width,e.height=2*cc.winSize.height,this.readNodePanel=e,this.scheduleOnce(function(){var e=new y.C_Match_Fight;e.fightType=v.FIGHT_TYPE.FIGHT_TYPE_BATTLE_GREAT_SAILING,e.params.push(C.getConfigVersion()),d.ClientNetwork.getInstance().Send(y.MATCH_CLIENT_ENUM.P_Match_Fight,e)},1)},t.prototype.callRoleRandShopBuy=function(e){var t=new f.C_Role_RandShopBuy;t.shopID=e.shopID,t.shopPosition=e.shopPosition,t.shopItemID=e.shopItemID,d.ClientNetwork.getInstance().Send(f.ROLE_CLIENT_ENUM.P_Role_RandShopBuy,t)},t.prototype.onClickCloseCallBack=function(){var e=h.default.getViewByName("ActivityMainView");if(e&&e.view){if(e.view.node){e.view.node.active=!0;var t=e.view.node.parent.getChildByName("UI_Mask_ActivityMainView");t&&(t.active=!0)}}else h.default.addPopView("BaseCtrl","ActivityMainView","ActivityMainView");this.closeView()},t.prototype.onClickIntroduceCallBack=function(){h.default.addPopView("BaseCtrl","NavigationIntroduceView","NavigationIntroduceView")},t.prototype.onSendRefCardMsgToSvr=function(){var e=new _.C_Activity_GreatSailingRefleshCard;e.refleshCardNum=this.refreshCardCount+1,d.ClientNetwork.getInstance().Send(_.ACTIVITY_CLIENT_ENUM.P_Activity_GreatSailingRefleshCard,e)},t.prototype.onClickRefreshCardCallBack=function(){var e=this;if(this.refreshCardCount>=N.GreatSailingRefreshTableData.getDataMap().size)return r.G.StringManager.PopString(r.G.StringManager.getString("NAVIGATION_TIP1"));var t=m.ActivityTableData.getById(_.ACTIVITY_ID_ENUM.P_Activity_Navigation);if(p.default.getRoleAttrValByKey(b.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE)<t.param1)return r.G.StringManager.PopString(r.G.StringManager.getString("WUDAOHUI_SCORE_TIP",t.param1));if(0==this.activityIsOpen)return r.G.StringManager.PopWorldString("coopActivity_time_end");var o=m.ActivityTableData.getById(_.ACTIVITY_ID_ENUM.P_Activity_Navigation);if(this.failCount>=o.param3)return r.G.StringManager.PopWorldString("chaogong_today_num_is_complete");var i;if(0==(i=this.refreshCardCount>=N.GreatSailingRefreshTableData.getDataMap().size?N.GreatSailingRefreshTableData.getById(this.refreshCardCount).reliveCost[0].dropNum:N.GreatSailingRefreshTableData.getById(this.refreshCardCount+1).reliveCost[0].dropNum))this.onSendRefCardMsgToSvr();else{var a="<outline color=black width=2> <color=#ffffff>\u662f\u5426\u786e\u5b9a\u82b1\u8d39"+i+"</c> <img src='diamond' />  <color=#ffffff>\u5237\u65b0\u4eca\u65e5\u5361\u7ec4\uff1f</color> </outline>";h.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:a,isRichText:!0,confirmCb:function(){if(p.default.diamondNum<i)return r.G.StringManager.PopWorldString("common_prompt_diamond_insufficient");e.onSendRefCardMsgToSvr()}})}},t.prototype.getReadNode=function(){return this.readNodePanel||null},t.prototype.getCurBattleMaxWave=function(){return this.curMaxWaveCount||0},t.prototype.devChangeCardGroup=function(){var e=this,t=g.default.getRandomInt(1,S.GreatSailingTableData.getDataMap().size);t>S.GreatSailingTableData.getDataMap().size&&(t=S.GreatSailingTableData.getDataMap().size-1),this.battleCardLayout.node.destroyAllChildren();var o=S.GreatSailingTableData.getById(t).cardGroup;o&&o.length>0&&o.forEach(function(t){g.default.createNormalItems(t,1,e.battleCardLayout.node,function(e){e.scale=.5,e.getChildByName("num").active=!1})}),I.default.setNavigationBattleCardGroupId(t)},t.prototype.onDestroy=function(){this.unscheduleAllCallbacks(),d.ClientNetwork.getInstance().removeMessageTarget(this)},n([R(l.default)],t.prototype,"rankListPanelNode",void 0),n([R(cc.Node)],t.prototype,"rewardListPanelNode",void 0),n([R(cc.Node)],t.prototype,"shopPanelNode",void 0),n([R(cc.Node)],t.prototype,"myRankInfoNode",void 0),n([R(cc.Prefab)],t.prototype,"shopItemPrefab",void 0),n([R(cc.Prefab)],t.prototype,"rewardItemPrefab",void 0),n([R(cc.Label)],t.prototype,"titleTimeLab",void 0),n([R(cc.Layout)],t.prototype,"battleCardLayout",void 0),n([R(cc.Node)],t.prototype,"joinBtnNode",void 0),n([R(cc.Node)],t.prototype,"refreshBtnNode",void 0),n([R(cc.Prefab)],t.prototype,"readyPrefabNode",void 0),n([R(cc.Label)],t.prototype,"conchNumLab",void 0),n([R(cc.Node)],t.prototype,"spineNode",void 0),n([R(cc.Node)],t.prototype,"refreshExpendNode",void 0),n([c.Register_Class,P],t)}(s.default);o.default=L,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/ActivityTableData":"ActivityTableData","../../StaticData/GreatSailingRankListTableData":"GreatSailingRankListTableData","../../StaticData/GreatSailingRefreshTableData":"GreatSailingRefreshTableData","../../StaticData/GreatSailingTableData":"GreatSailingTableData","../../common/NetworkProtocolCommon":"NetworkProtocolCommon","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/base/GameView":"GameView","../../network/ClientNetwork":"ClientNetwork","../../network/LocalMessage":"LocalMessage","../../network/protocol/ActivityProtocols":"ActivityProtocols","../../network/protocol/MatchProtocols":"MatchProtocols","../../network/protocol/RoleProtocols":"RoleProtocols","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils","../../utils/List":"List","../activity/ActivityModule":"ActivityModule"}],NavigationRankItem:[function(e,t,o){"use strict";cc._RF.push(t,"3fc78Yb5xBBrICtTADRg9ph","NavigationRankItem");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../utils/GameTools"),s=e("../../modules/base/GameView"),c=e("../../utils/GameUtils"),l=e("../../modules/manager/LoadResManager"),d=e("../../Global/GameGlobal"),u=cc._decorator,h=u.ccclass,p=u.property,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.rankIconNodeArr=[],t.rankNumNode=null,t.playerHeadNode=null,t.playerNameLab=null,t.waveLab=null,t.timeLab=null,t.sociatyNameLab=null,t}return a(t,e),t.prototype.show=function(e,t){var o=this,i=JSON.parse(e);this.rankIconNodeArr.forEach(function(e){e.active=!1}),this.rankNumNode.active=!1,this.rankIconNodeArr[t]?this.rankIconNodeArr[t].active=!0:(this.rankNumNode.active=!0,this.rankNumNode.children[0].getComponent(cc.Label).string=(t+1).toString());var a=null;for(var n in i.roles)Object.prototype.hasOwnProperty.call(i.roles,n)&&Number(n)>1&&(a=i.roles[n]);if(a){this.playerNameLab.string=a.nickname,c.setRemoteHeadIcon(a.headurl,a.headid,this.playerHeadNode.getComponent(cc.Sprite));var u=a.headframeid;(u<=0||u>=2e3)&&(u=200),l.default.loadSpriteFrame("ui/headFrame/frame_"+u).then(function(e){o.playerHeadNode&&(o.playerHeadNode.children[0].getComponent(cc.Sprite).spriteFrame=e)})}this.waveLab.string=d.G.StringManager.getString("MY_ROUND",i.round),this.timeLab.string=function(e){var t=e%864e5/36e5,o=e%36e5/6e4,i=e%6e4/1e3;return parseInt(t.toString())>0?parseInt(t.toString())+" \u65f6 "+parseInt(o.toString())+" \u5206 "+i+" \u79d2 ":parseInt(o.toString())+" \u5206 "+i+" \u79d2 "}.call(this,1e3*i.totaltime),i.totaltime<=0?this.timeLab.node.active=!1:this.timeLab.node.active=!0,a&&(this.playerHeadNode.roleid=a.roleid,r.default.registerTouchEvent(this.playerHeadNode,function(e){var t=s.default.getViewByName("MainSceneView");t&&t.view&&t.view.onCallGetRoleSimpleInfo(e.target.roleid)}),this.sociatyNameLab.string=a.sociatyName?a.sociatyName:"")},n([p(cc.Node)],t.prototype,"rankIconNodeArr",void 0),n([p(cc.Node)],t.prototype,"rankNumNode",void 0),n([p(cc.Node)],t.prototype,"playerHeadNode",void 0),n([p(cc.Label)],t.prototype,"playerNameLab",void 0),n([p(cc.Label)],t.prototype,"waveLab",void 0),n([p(cc.Label)],t.prototype,"timeLab",void 0),n([p(cc.Label)],t.prototype,"sociatyNameLab",void 0),n([h],t)}(cc.Component);o.default=f,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../modules/base/GameView":"GameView","../../modules/manager/LoadResManager":"LoadResManager","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils"}],NavigationShopItem:[function(e,t,o){"use strict";cc._RF.push(t,"eb222fRjDlJZowJSWgWxtrc","NavigationShopItem");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../StaticData/RandShopPositionTableData"),s=e("../../StaticData/RandShopItemTableData"),c=e("../../utils/ConfigUtils"),l=e("../../common/PlayerModule"),d=e("../../modules/manager/LoadResManager"),u=e("../../utils/GameTools"),h=e("../../Global/GameGlobal"),p=e("../../modules/base/GameView"),f=e("../activity/ActivityModule"),g=cc._decorator,m=g.ccclass,_=(g.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.tShopObj={shopID:0,shopPosition:0,shopItemID:0,costNum:0,gives:null,costs:null,bSellOut:!1,bOpen:!1},t.cb=null,t.isMachineryGearShop=!1,t}return a(t,e),t.prototype.init=function(e,t,o,i){var a=this;if(void 0===i&&(i=!1),this.tShopObj.shopID=4,this.tShopObj.shopPosition=t,this.tShopObj.shopItemID=e.shopItemID,this.tShopObj.bSellOut=!1,this.tShopObj.costNum=0,this.cb=o,this.tShopObj.bOpen=!0,this.isMachineryGearShop=i,e.shopItemID>0){var n=s.RandShopItemTableData.getById(e.shopItemID).give;this.tShopObj.gives=n;var g=c.default.getInstance().getItemByID(n[0].dropID);if(g.isChance&&g.isChance>0&&(this.node.getChildByName("gailv").active=!0,this.node.getChildByName("gailv").children[0].getComponent(cc.Label).string=g.isChance+"%"),2===g.type){var m=c.default.getInstance().getHeroConfig(n[0].dropID),_=l.default.getHeroCarData()[n[0].dropID];if(_&&0==_.bHeroLock)this.node.getChildByName("shop_new").active=!0;else{d.default.loadSpriteFrame("ui/bag/img/bar"+m.hero_color).then(function(e){cc.isValid(a)?a.node.getChildByName("cardNumber").getChildByName("pro_bar").getChildByName("bar").getComponent(cc.Sprite).spriteFrame=e:console.log(" load sprite_splash error ")}).catch(function(e){cc.error(e)});var y=l.default.getHeroCarData()[n[0].dropID].heroLevel,v=c.default.getInstance().getNpcTemplateConfig(m.npc_id,y).up_res.split("|")[0].split("#"),C=l.default.getItemCountByBag(Number(v[0])),S=Number(v[1]);this.node.getChildByName("cardNumber").getChildByName("pro_bar").getComponent(cc.ProgressBar).progress=C/S,this.node.getChildByName("cardNumber").getChildByName("number").getComponent(cc.Label).string=C+"/"+S}d.default.loadSpriteFrame("ui/cardpic_l/"+m.image).then(function(e){cc.isValid(a)?a.node.getChildByName("heroImg").getComponent(cc.Sprite).spriteFrame=e:console.log(" load sprite_splash error ")}).catch(function(e){cc.error(e)})}else d.default.loadSpriteFrame(g.big_icon).then(function(e){cc.isValid(a)?a.node.getChildByName("heroImg").getComponent(cc.Sprite).spriteFrame=e:console.log(" load sprite_splash error ")}).catch(function(e){cc.error(e)});var T=s.RandShopItemTableData.getById(e.shopItemID);if(T.cost[0]){this.tShopObj.costs=T.cost,this.node.getChildByName("priceNode").active=!0;var I=c.default.getInstance().getItemByID(T.cost[0].dropID).icon;d.default.loadSpriteFrame(I).then(function(e){cc.isValid(a)?a.node.getChildByName("priceNode").getChildByName("costIcon").getComponent(cc.Sprite).spriteFrame=e:console.log(" load sprite_splash error ")}).catch(function(e){cc.error(e)}),this.node.getChildByName("priceNode").getChildByName("cost").getComponent(cc.Label).string=T.cost[0].dropNum.toString(),this.tShopObj.costNum=T.cost[0].dropNum}else this.node.getChildByName("free").active=!0,e.buyNum<=0&&(this.node.getChildByName("redpoint").active=!0);this.node.getChildByName("name").getComponent(cc.Label).string=c.default.getInstance().getItemByID(n[0].dropID).name,T.buyNum>0&&e.buyNum>=T.buyNum&&(this.node.getChildByName("over").active=!0,this.node.getChildByName("free").active=!1,this.node.getChildByName("priceNode").active=!1,this.node.getChildByName("cardNumber").active=!1,u.default.setNodeBright(this.node,!1),this.tShopObj.bSellOut=!0);var N=p.default.getViewByName("NavigationMainView");N&&N.view&&N.view.getCurBattleMaxWave()<(b=r.RandShopPositionTableData.getById(t).conditionRound)&&(this.node.getChildByName("priceNode").active=!1,this.node.getChildByName("lockLab").getComponent(cc.Label).string=h.G.StringManager.getString("NAVIGATION_SHOP_TIP",b),this.node.getChildByName("lockLab").active=!0,this.tShopObj.bOpen=!1);var b,w=p.default.getViewByName("WeekCooperationReliveMainView");w&&w.view&&(this.node.getChildByName("name").getComponent(cc.Label).string=c.default.getInstance().getItemByID(n[0].dropID).name+"x"+n[0].dropNum,f.default.getWeekCooperationData().historyMaxScore<(b=r.RandShopPositionTableData.getById(t).conditionRound)&&(this.node.getChildByName("priceNode").active=!1,this.node.getChildByName("lockLab").getComponent(cc.Label).string=h.G.StringManager.getString("NAVIGATION_SHOP_TIP",b),this.node.getChildByName("lockLab").active=!0,this.tShopObj.bOpen=!1));var E=p.default.getViewByName("RoyaleMainView");E&&E.view&&(this.node.getChildByName("name").getComponent(cc.Label).string=c.default.getInstance().getItemByID(n[0].dropID).name+"x"+n[0].dropNum);var P=p.default.getViewByName("AnniversaryMainView");P&&P.view&&(this.node.getChildByName("name").getComponent(cc.Label).string=c.default.getInstance().getItemByID(n[0].dropID).name+"x"+n[0].dropNum);var R=p.default.getViewByName("FogHiddenMainView"),L=p.default.getViewByName("MachineryCityMainView");(R&&R.view||L&&L.view)&&(this.node.getChildByName("name").getComponent(cc.Label).string=c.default.getInstance().getItemByID(n[0].dropID).name+"x"+n[0].dropNum)}},t.prototype.onClickShopItemCallBack=function(){var e=this;if(0==this.tShopObj.bOpen)return h.G.StringManager.PopString(h.G.StringManager.getString("NAVIGATION_SHOP_TIP2"));if(1==this.tShopObj.bSellOut)return h.G.StringManager.PopString(h.G.StringManager.getString("SOCIATY_SHOP_SOLD_OUT_TEXT"));var t=p.default.getViewByName("RoyaleMainView"),o=p.default.getViewByName("AnniversaryMainView"),i=p.default.getViewByName("FogHiddenMainView"),a=p.default.getViewByName("MachineryCityMainView"),n=p.default.getViewByName("WeekCooperationReliveMainView");if(n&&n.view){if(l.default.getItemCountByBag(1016)<this.tShopObj.costNum)return h.G.StringManager.PopWorldString("chaterrorcode6");if(12===c.default.getInstance().getItemByID(this.tShopObj.gives[0].dropID).type&&l.default.getItemCountByBag(this.tShopObj.gives[0].dropID)>=1)return h.G.StringManager.PopString(h.G.StringManager.getString("ROYALE_SHOP_BUY_TIP"));p.default.addPopView("BaseCtrl","ShopConfirmBuy","ShopConfirmBuy",{itemData:{shopID:6,tGive:this.tShopObj.gives,tCost:this.tShopObj.costs},cb:function(){e.cb(e.tShopObj)}})}else if(t&&t.view){if(l.default.getItemCountByBag(1019)<this.tShopObj.costNum)return h.G.StringManager.PopWorldString("chaterrorcode6");if(12===c.default.getInstance().getItemByID(this.tShopObj.gives[0].dropID).type&&l.default.getItemCountByBag(this.tShopObj.gives[0].dropID)>=1)return h.G.StringManager.PopString(h.G.StringManager.getString("ROYALE_SHOP_BUY_TIP"));p.default.addPopView("BaseCtrl","ShopConfirmBuy","ShopConfirmBuy",{itemData:{shopID:7,tGive:this.tShopObj.gives,tCost:this.tShopObj.costs},cb:function(){e.cb(e.tShopObj)}})}else if(o&&o.view){if(l.default.getItemCountByBag(1023)<this.tShopObj.costNum)return h.G.StringManager.PopWorldString("chaterrorcode6");if(12===c.default.getInstance().getItemByID(this.tShopObj.gives[0].dropID).type&&l.default.getItemCountByBag(this.tShopObj.gives[0].dropID)>=1)return h.G.StringManager.PopString(h.G.StringManager.getString("ROYALE_SHOP_BUY_TIP"));p.default.addPopView("BaseCtrl","ShopConfirmBuy","ShopConfirmBuy",{itemData:{shopID:8,tGive:this.tShopObj.gives,tCost:this.tShopObj.costs},cb:function(){e.cb(e.tShopObj)}})}else if(i&&i.view){if(l.default.getItemCountByBag(1025)<this.tShopObj.costNum)return h.G.StringManager.PopWorldString("chaterrorcode6");if(12===c.default.getInstance().getItemByID(this.tShopObj.gives[0].dropID).type&&l.default.getItemCountByBag(this.tShopObj.gives[0].dropID)>=1)return h.G.StringManager.PopString(h.G.StringManager.getString("ROYALE_SHOP_BUY_TIP"));p.default.addPopView("BaseCtrl","ShopConfirmBuy","ShopConfirmBuy",{itemData:{shopID:9,tGive:this.tShopObj.gives,tCost:this.tShopObj.costs},cb:function(){e.cb(e.tShopObj)}})}else if(a&&a.view){var r=1027,s=10;if(this.isMachineryGearShop&&(r=1028,s=11),l.default.getItemCountByBag(r)<this.tShopObj.costNum)return h.G.StringManager.PopWorldString("chaterrorcode6");if(12===c.default.getInstance().getItemByID(this.tShopObj.gives[0].dropID).type&&l.default.getItemCountByBag(this.tShopObj.gives[0].dropID)>=1)return h.G.StringManager.PopString(h.G.StringManager.getString("ROYALE_SHOP_BUY_TIP"));p.default.addPopView("BaseCtrl","ShopConfirmBuy","ShopConfirmBuy",{itemData:{shopID:s,tGive:this.tShopObj.gives,tCost:this.tShopObj.costs},cb:function(){e.cb(e.tShopObj)}})}else{if(l.default.getItemCountByBag(1011)<this.tShopObj.costNum)return h.G.StringManager.PopWorldString("chaterrorcode6");p.default.addPopView("BaseCtrl","ShopConfirmBuy","ShopConfirmBuy",{itemData:{shopID:4,tGive:this.tShopObj.gives,tCost:this.tShopObj.costs},cb:function(){e.cb(e.tShopObj)}})}},n([m],t)}(cc.Component));o.default=_,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/RandShopItemTableData":"RandShopItemTableData","../../StaticData/RandShopPositionTableData":"RandShopPositionTableData","../../common/PlayerModule":"PlayerModule","../../modules/base/GameView":"GameView","../../modules/manager/LoadResManager":"LoadResManager","../../utils/ConfigUtils":"ConfigUtils","../../utils/GameTools":"GameTools","../activity/ActivityModule":"ActivityModule"}],NeedRestart:[function(e,t,o){"use strict";cc._RF.push(t,"4a796I1UztGR4VWMmc3vN+i","NeedRestart");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../modules/base/BaseView"),s=e("../modules/base/Decorators"),c=cc._decorator,l=c.ccclass,d=(c.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.path=function(){return"ui/CommonPrefab/NeedRestart"},t.prototype.onLoad=function(){},t.prototype.okBtnClick=function(){cc.audioEngine.stopAll(),cc.game.end()},n([s.Register_Class,l],t)}(r.default));o.default=d,cc._RF.pop()},{"../modules/base/BaseView":"BaseView","../modules/base/Decorators":"Decorators"}],NetworkProtocolCommon:[function(e,t,o){"use strict";cc._RF.push(t,"cd3415ZCklPp458lu2gfPsw","NetworkProtocolCommon"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../network/protocol/RoleProtocols"),a=e("../StaticData/CostGetTableData"),n=e("../network/ClientNetwork"),r=e("../utils/GamePlatform"),s=e("../utils/GameTools"),c=function(){function e(){}return e.instance=function(){return this._instance||(this._instance=new this),this._instance},e.prototype.callRoleCostGet=function(e){var t=new i.C_Role_Cost_Get;t.id=a.CostGetTableData.getById(e).id,t.count=1,n.ClientNetwork.getInstance().Send(i.ROLE_CLIENT_ENUM.P_Role_Cost_Get,t)},e.prototype.callRoleClientLog=function(e){var t=new i.C_Role_ClientLog;t.logMassage=e,n.ClientNetwork.getInstance().Send(i.ROLE_CLIENT_ENUM.P_Role_ClientLog,t)},e.prototype.callAddShortcutTask=function(e){void 0===e&&(e=0);var t=s.default.getAddShortcutTaskId();r.GamePlatform.isQQMiniGame()&&(t=402,2==e&&(t=403));var o=new i.C_Role_ClientTaskAddCount;o.taskID=t,o.count=1,n.ClientNetwork.getInstance().Send(i.ROLE_CLIENT_ENUM.P_Role_ClientTaskAddCount,o);var a=new i.C_Role_TakeTask;a.taskID=t,n.ClientNetwork.getInstance().Send(i.ROLE_CLIENT_ENUM.P_Role_TakeTask,a)},e.prototype.callPushGiftAdvertiseTask=function(e){var t=new i.C_Role_ClientTaskAddCount;t.taskID=e,t.count=1,n.ClientNetwork.getInstance().Send(i.ROLE_CLIENT_ENUM.P_Role_ClientTaskAddCount,t);var o=new i.C_Role_TakeTask;o.taskID=e,n.ClientNetwork.getInstance().Send(i.ROLE_CLIENT_ENUM.P_Role_TakeTask,o)},e}();o.default=c.instance(),cc._RF.pop()},{"../StaticData/CostGetTableData":"CostGetTableData","../network/ClientNetwork":"ClientNetwork","../network/protocol/RoleProtocols":"RoleProtocols","../utils/GamePlatform":"GamePlatform","../utils/GameTools":"GameTools"}],NewHandFinish:[function(e,t,o){"use strict";cc._RF.push(t,"ed938n+bPdAcY0GMQhD3pW+","NewHandFinish");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../utils/subUtils/PopLayer"),s=cc._decorator,c=s.ccclass,l=(s.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.m_bIsEnd=!1,t}return a(t,e),t.prototype.onLoad=function(){this.node.getParent().on(cc.Node.EventType.TOUCH_START,this.ccTouchBegin,this),this.node.getParent().on(cc.Node.EventType.TOUCH_END,this.ccTouchEnd,this)},t.prototype.start=function(){},t.prototype.ccTouchBegin=function(){return!0},t.prototype.ccTouchEnd=function(){if(!this.m_bIsEnd){this.m_bIsEnd=!0;var e=this.node.getParent().getComponent(cc.Animation);e&&(e.on("finished",this.ActionEnd,this),e.play("animation"))}},t.prototype.ActionEnd=function(){var e=this.node.getParent().getComponent(cc.Animation);e&&e.off("finished",this.ActionEnd,this)},n([c],t)}(r.PopLayerInterface));o.default=l,cc._RF.pop()},{"../../utils/subUtils/PopLayer":"PopLayer"}],NewerThreeDaysGiftTableData:[function(e,t,o){"use strict";cc._RF.push(t,"4176fkXLV9NEr4MPRLZxJmu","NewerThreeDaysGiftTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.NewerThreeDaysGiftTableData=void 0;var i=e("../TableReader"),a=function(){function e(){this.id=0,this.day=0,this.round=0,this.nextRound=0,this.rechargeId=0,this.extraParam="",this.extraParam2="",this.extraParam3=""}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.day=e.getNumber(),this.round=e.getNumber(),this.nextRound=e.getNumber(),this.rechargeId=e.getNumber(),this.extraParam=e.getString(),this.extraParam2=e.getString(),this.extraParam3=e.getString()},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"NewerThreeDaysGiftTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.NewerThreeDaysGiftTableData=a,cc._RF.pop()},{"../TableReader":"TableReader"}],NewerThreeDaysGiftUtils:[function(e,t,o){"use strict";cc._RF.push(t,"ad389N6t3RKhLwhmefKX2z8","NewerThreeDaysGiftUtils"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../common/PlayerModule"),a=e("../../modules/base/GameView"),n=e("../../modules/manager/ViewManager"),r=e("../../network/ClientNetwork"),s=e("../../network/LocalMessage"),c=e("../../StaticData/NewerThreeDaysGiftTableData"),l=e("../../utils/GameUtils"),d=e("../../utils/TimeOffSetManager"),u=function(){function e(){this.isReadyPopUp=!1}return Object.defineProperty(e,"Instance",{get:function(){return null==e.g_instance&&(e.g_instance=new e),e.g_instance},enumerable:!1,configurable:!0}),e.prototype.showGiftView=function(){a.default.addPopView("ShopMainCtrl","NewerThreeDaysGiftView","NewerThreeDaysGiftView"),this.setRedPoint(!1),r.ClientNetwork.getInstance().pushLocalMessage(s.LOCAL_MESSAGE.LocalMsg_freshNewerGiftRed),this.isReadyPopUp=!1},e.prototype.updateData=function(e){this.giftServerData=e,null!=this.giftServerData&&0==this.giftServerData.errorcode&&1==this.giftServerData.isFirst&&(this.isReadyPopUp=!0,this.isInMainScene()&&this.showGiftView())},e.prototype.checkPopUp=function(){return!(!this.isReadyPopUp||!this.isInMainScene()||null==this.giftServerData||(this.showGiftView(),0))},e.prototype.isInMainScene=function(){var e=a.default.getViewByName("MainSceneView");return null!=e&&null!=e.view&&!(n.default.nodeList.length>1)},e.prototype.clearAllGift=function(){this.giftServerData},e.prototype.hasGift=function(){if(null==this.giftServerData)return!1;var e=i.default.getServersTime2();return e>=this.giftServerData.startTime&&e<=this.giftServerData.endTime},e.prototype.getEndTime=function(){return null==this.giftServerData?0:this.giftServerData.endTime},e.prototype.getCurrDayNum=function(){if(null==this.giftServerData)return-1;var e=d.TimeOffSetManager.getSpanDays(i.default.getServersTime2(),this.giftServerData.startTime);return e>=0?e+1:-1},e.prototype.getNewerThreeDaysGiftTableData=function(e,t){var o=null;return c.NewerThreeDaysGiftTableData.getDataMap().forEach(function(i){i.day==e&&i.round==t&&(o=i)}),o},e.prototype.getTableByDay=function(e){var t=this.getNewerThreeDaysGiftTableData(e,1),o=t.rechargeId,a=i.default.getRoleRechargeData().get(o);if(null==a||0==a.totalNum)return t;for(;0!=t.nextRound&&(o=(t=this.getNewerThreeDaysGiftTableData(e,t.nextRound)).rechargeId,null!=(a=i.default.getRoleRechargeData().get(o))&&0!=a.totalNum););return t},e.prototype.getRedPoint=function(){var e=i.default.getServersTime2(),t=new Date(1e3*e),o="newerGift_"+t.getFullYear()+"_"+t.getMonth()+"_"+t.getDate(),a=l.getLocalData(o);return null==a||"false"!=a},e.prototype.setRedPoint=function(e){var t=i.default.getServersTime2(),o=new Date(1e3*t),a="newerGift_"+o.getFullYear()+"_"+o.getMonth()+"_"+o.getDate();l.setLocalData(a,e?"true":"false")},e}();o.default=u,cc._RF.pop()},{"../../StaticData/NewerThreeDaysGiftTableData":"NewerThreeDaysGiftTableData","../../common/PlayerModule":"PlayerModule","../../modules/base/GameView":"GameView","../../modules/manager/ViewManager":"ViewManager","../../network/ClientNetwork":"ClientNetwork","../../network/LocalMessage":"LocalMessage","../../utils/GameUtils":"GameUtils","../../utils/TimeOffSetManager":"TimeOffSetManager"}],NewerThreeDaysGiftView:[function(e,t,o){"use strict";cc._RF.push(t,"541f9YeyKlD6IAJW0OTZEI2","NewerThreeDaysGiftView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../common/PlayerModule"),s=e("../../modules/base/BaseView"),c=e("../../modules/base/Decorators"),l=e("../../network/ClientNetwork"),d=e("../../network/LocalMessage"),u=e("../../StaticData/RechargeTableData"),h=e("../../utils/ConfigUtils"),p=e("../../utils/GameTools"),f=e("../../utils/GameUtils"),g=e("../../utils/subUtils/SpineMaker"),m=e("../../utils/TimeOffSetManager"),_=e("./NewerThreeDaysGiftUtils"),y=cc._decorator,v=y.ccclass,C=y.property,S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.tabItemNode=null,t.layerRewardNode=null,t.btnRechargeNode=null,t.txtTimeNode=null,t.heroImage=null,t.oldPriceNode=null,t.tabBarPrefab=null,t.scrollTab=null,t.m_currTabIndex=0,t}return a(t,e),t.path=function(){return"ui/pushGift/NewerThreeDaysGift"},t.prototype.init=function(){},t.prototype.onLoad=function(){this.currSpineItemId=0,this.currRechargeId=0},t.prototype.start=function(){var e=this;l.ClientNetwork.getInstance().listenLocalMessage(d.LOCAL_MESSAGE.LocalMsg_RechargeSuccess,function(){cc.isValid(e)&&e.updateTabView()},this),this.updateTabs()},t.prototype.updateTabs=function(){var e=this,t=Number(f.getConfigIntValue("newerThreeDaysGift_dayNum"));this.scrollTab.removeAllChildren(),this.btnList=[];for(var o=function(t){var o=cc.instantiate(i.tabBarPrefab);o.active=!0,o.name=t.toString(),o.parent=i.scrollTab,o.getChildByName("label").getComponent(cc.Label).string="\u7b2c"+(t+1)+"\u5929",o.on(cc.Node.EventType.TOUCH_END,function(){e.switchToTab(parseInt(o.name))},i),i.btnList.push(o)},i=this,a=0;a<t;a++)o(a);var n=_.default.Instance.getCurrDayNum();n<=0&&(n=1),this.m_currTabIndex=n-1,this.switchToTab(this.m_currTabIndex)},t.prototype.switchToTab=function(e){this.m_currTabIndex=e,this.prevBtn&&f.setTexture(this.prevBtn.getChildByName("Background").getComponent(cc.Sprite),"ui/pushGift/res2/TAB1"),this.prevBtn=this.btnList[this.m_currTabIndex],f.setTexture(this.prevBtn.getChildByName("Background").getComponent(cc.Sprite),"ui/pushGift/res2/TAB"),this.updateTabView()},t.prototype.updateTabView=function(){var e,t=this,o=_.default.Instance.getCurrDayNum(),i=this.m_currTabIndex+1;e=_.default.Instance.getTableByDay(i),this.currRechargeId=e.rechargeId,this.layerRewardNode.removeAllChildren();var a=u.RechargeTableData.getById(this.currRechargeId);a.prize.forEach(function(e){p.default.createNormalItems(e.dropID,e.dropNum,t.layerRewardNode,function(e){e.scale=.8})}),this.btnRechargeNode.getChildByName("label").getComponent(cc.Label).string="\uffe5"+(p.default.getRechargeMoneyByPlatform(a)/100).toString(),this.oldPriceNode.getChildByName("txt").getComponent(cc.Label).string="\uffe5"+a.original_cost/100;var n=_.default.Instance.getNewerThreeDaysGiftTableData(i,1);if(null!=n&&this.currSpineItemId!=Number(n.extraParam)&&(this.currSpineItemId=Number(n.extraParam),this.heroImage)){var s=h.default.getInstance().getHeroConfig(this.currSpineItemId),c=h.default.getInstance().getNpcTemplateConfig(s.npc_id,1),l=h.default.getInstance().getResConfig(c.res_id);g.SpineMaker.createSpineV2(c.res_id,this.heroImage).then(function(e){e&&(l.uiScale>0?t.heroImage.scale=l.uiScale/100:t.heroImage.scale=1,e.setAnimation(0,"idle",!0))})}if(i>o)this.btnRechargeNode.getComponent(cc.Button).interactable=!1,p.default.setNodeBright(this.btnRechargeNode,!1),this.showUnlockInfo(i,o),this.btnRechargeNode.off(cc.Node.EventType.TOUCH_START);else{var d=!1,f=r.default.getRoleRechargeData().get(this.currRechargeId);null!=f&&f.totalNum>0&&(d=!0),d&&0==e.nextRound?(this.btnRechargeNode.getComponent(cc.Button).interactable=!1,p.default.setNodeBright(this.btnRechargeNode,!1),this.btnRechargeNode.getChildByName("label").getComponent(cc.Label).string="\u5df2\u8d2d\u4e70",this.btnRechargeNode.off(cc.Node.EventType.TOUCH_START)):(this.btnRechargeNode.getComponent(cc.Button).interactable=!0,p.default.setNodeBright(this.btnRechargeNode,!0),this.btnRechargeNode.on(cc.Node.EventType.TOUCH_START,function(){var e=r.default.getRoleRechargeData().get(t.currRechargeId);e&&e.dayNum>0||function(){var e={rechargeID:t.currRechargeId,rechargeNum:1};t.sendEvent("SendProtocolRecharge",e)}()})),this.showTime()}},t.prototype.showUnlockInfo=function(e,t){this.unschedule(this.updateTime);var o;o=t<0?"\u656c\u8bf7\u671f\u5f85":e-t==1?"\u660e\u65e5\u89e3\u9501":e-t==2?"\u540e\u65e5\u89e3\u9501":e-t+"\u5929\u540e\u89e3\u9501",this.txtTimeNode.getComponent(cc.Label).string=o},t.prototype.showTime=function(){this.unschedule(this.updateTime),this.updateTime(),this.schedule(this.updateTime,1)},t.prototype.updateTime=function(){var e=_.default.Instance.getEndTime();if(e<=0)this.unschedule(this.updateTime);else{var t,o=e-r.default.getServersTime2();if(o<0)return this.unschedule(this.updateTime),void this.closeView();this.txtTimeNode.getComponent(cc.Label).string=(t=o,m.TimeOffSetManager.formaterWithOutSecond2(t)+"\u540e\u6d88\u5931")}},n([C(cc.Node)],t.prototype,"tabItemNode",void 0),n([C(cc.Node)],t.prototype,"layerRewardNode",void 0),n([C(cc.Node)],t.prototype,"btnRechargeNode",void 0),n([C(cc.Node)],t.prototype,"txtTimeNode",void 0),n([C(cc.Node)],t.prototype,"heroImage",void 0),n([C(cc.Node)],t.prototype,"oldPriceNode",void 0),n([C(cc.Node)],t.prototype,"tabBarPrefab",void 0),n([C(cc.Node)],t.prototype,"scrollTab",void 0),n([c.Register_Class,v],t)}(s.default);o.default=S,cc._RF.pop()},{"../../StaticData/RechargeTableData":"RechargeTableData","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../network/ClientNetwork":"ClientNetwork","../../network/LocalMessage":"LocalMessage","../../utils/ConfigUtils":"ConfigUtils","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils","../../utils/TimeOffSetManager":"TimeOffSetManager","../../utils/subUtils/SpineMaker":"SpineMaker","./NewerThreeDaysGiftUtils":"NewerThreeDaysGiftUtils"}],NextScenePanel:[function(e,t,o){"use strict";cc._RF.push(t,"a83c3XDj+VNFYu7EYaNus8/","NextScenePanel");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("./Global"),s=e("./utils/GamePlatform"),c=cc._decorator,l=c.ccclass,d=c.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.infoLabel=null,t.versionLabel=null,t.fileProgress=null,t.fileLabel=null,t.tipNode=null,t.quitNode=null,t._storagePath="",t._isNexting=!1,t._canRetry=!1,t._retryCount=0,t._retryMaxCount=3,t.requestVersionTimeOut=10,t.NextSceneUrlCacheKey="appNextSceneUrl",t.manifestUrl=null,t.manifestRes=null,t.package="tfjl-1300944069.file.myqcloud.com/tfjlios/",t}return a(t,e),t.prototype.onLoad=function(){cc.sys.isNative&&(this._storagePath=(jsb.fileUtils?jsb.fileUtils.getWritablePath():"/")+"game-remote-asset",this.initAssetManagerNativeUrl())},t.prototype.start=function(){var e=this;this.backgroundFitScreen(this.node,this.node.getChildByName("bg")),this.requireFirst(function(){e.initGetGameVer()})},t.prototype.requireFirst=function(e){var t=this,o="https://tfjl-1300944069.file.myqcloud.com/tfjlios/"+s.GamePlatform.getMiYaVideoType();cc.assetManager.loadRemote(o,function(o,i){if(o)t.quitNode.active=!0;else{if(cc.isValid(t,!0)){var a=new jsb.Manifest(i._nativeAsset,t._storagePath);t.manifestUrl=a,t.manifestRes=i._nativeAsset}e()}})},t.prototype.backgroundFitScreen=function(e,t){e.setContentSize(cc.winSize),.5==e.anchorX&&e.setPosition(cc.winSize.width/2,e.position.y),.5==e.anchorY&&e.setPosition(e.position.x,cc.winSize.height/2);var o=cc.view.getDesignResolutionSize(),i=e.width/o.width,a=e.height/o.height;if(t){var n=e.height/t.height;i>a&&(n=e.width/t.width,t.width*=n)}},t.prototype.initGetGameVer=function(){var e=this,t="https://mszcs1.gameserver.iplay11g.com/gmsys/native_ios_status.php?"+Math.random();if(cc.isValid(this)){var o=new XMLHttpRequest;o.timeout=1e3*this.requestVersionTimeOut;var i=t;o.open("GET",i,!0),o.send(),o.onload=function(){if(cc.isValid(e))try{var t=JSON.parse(o.response),i=cc.sys.localStorage.getItem("clentVersion");i=i||"";var a=s.GamePlatform.getMiYaVideoType(),n=!1;if(s.GamePlatform.isIOS()&&(n=e.setcodeSit(t.bgmm)),"iosBgm"==a)return console.log("clent=====",i,t.murContent),void e.goNextScene(t,i);if(n&&s.GamePlatform.isIOS())return void e.NextSceneFinish(!1);if(t.content>i)e.modifyAppLoadUrlForManifestFile(t.content,function(){e.checkUpdate()});else{if(t.content==i)return void e.NextSceneFinish(!1);cc.sys.localStorage.getItem("NextSceneSearchPaths")?(cc.sys.localStorage.removeItem("NextSceneSearchPaths"),e.cleanNextSceneFile()):e.NextSceneFinish(!0)}}catch(r){e.quitNode.active=!0}},o.ontimeout=function(){e.quitNode.active=!0,cc.isValid(e)},o.onerror=function(){e.quitNode.active=!0,cc.isValid(e)},o.onabort=function(){e.quitNode.active=!0,cc.isValid(e)}}else this.quitNode.active=!0},t.prototype.goNextScene=function(e,t){var o=this;if(e.murContent>t)console.log("murContent>>>>>>>>>>>>>>>>"),this.modifyAppLoadUrlForManifestFile(e.murContent,function(){o.checkUpdate()});else{if(e.murContent==t)return console.log("murContent================"),void this.NextSceneFinish(!1);cc.sys.localStorage.getItem("NextSceneSearchPaths")?(console.log("murContent<<<<<<<<<<<<<"),cc.sys.localStorage.removeItem("NextSceneSearchPaths"),this.cleanNextSceneFile()):this.NextSceneFinish(!0)}},t.prototype.cleanNextSceneFile=function(){var e=jsb.fileUtils.getWritablePath();e&&jsb.fileUtils.removeDirectory(e+"/game-remote-asset"),this.scheduleOnce(function(){cc.game.restart()},.5)},t.prototype.quitGame=function(){cc.director.pause(),cc.audioEngine.stopAll(),cc.director.isPaused()&&cc.game.end()},t.prototype.initAssetManagerNativeUrl=function(){var e=this.getHotFileInXml(),t=jsb.fileUtils.getWritablePath()+"game-remote-asset/";if(console.log("checkWritablePath : 2  ",e),console.log("checkWritablePath : 3  ",t),console.log("checkWritablePath : 4  ",null!=jsb.fileUtils),null==jsb.fileUtils||null==e||t==e)this._am=new jsb.AssetsManager("",this._storagePath,this.versionCompareHandler),this._am.setVerifyCallback(function(e,t){return t.compressed,t.md5,t.path,!0});else{var o=cc.sys.localStorage.getItem("NextSceneSearchPaths");if(o){var i=JSON.parse(o);i.length>1&&(i[0]=t,console.log("checkWritablePath : 1  ",i[0]),cc.sys.localStorage.setItem("NextSceneSearchPaths",JSON.stringify(i)))}cc.game.restart()}},t.prototype.versionCompareHandler=function(e,t){for(var o=e.split("."),i=t.split("."),a=0;a<o.length;++a){var n=parseInt(o[a]),r=parseInt(i[a]||"0");if(n!==r)return n-r}return i.length>o.length?-1:0},t.prototype.setcodeSit=function(e){for(var t=e.split("&"),o=s.GamePlatform.getMiYaVideoType(),i=0;i<t.length;++i)if(t[i]==o)return s.GamePlatform.setcodeSit(!0),!0;return!1},t.prototype.checkUpdate=function(){this._isNexting||this._am&&(this._am.getState()===jsb.AssetsManager.State.UNINITED&&this._am.loadLocalManifest(this.manifestUrl,this._storagePath),this._am.getLocalManifest()&&this._am.getLocalManifest().isLoaded()&&(this._am.setEventCallback(this.checkCallback.bind(this)),this._am.checkUpdate(),this._isNexting=!0,this.disPatchRateEvent(.01),this.versionLabel&&(this.versionLabel.string=this._am.getLocalManifest().getVersion())))},t.prototype.checkCallback=function(e){switch(e.getEventCode()){case jsb.EventAssetsManager.ERROR_NO_LOCAL_MANIFEST:this.NextSceneFinish(!0);break;case jsb.EventAssetsManager.ERROR_DOWNLOAD_MANIFEST:case jsb.EventAssetsManager.ERROR_PARSE_MANIFEST:this.NextSceneFinish(!1);break;case jsb.EventAssetsManager.ALREADY_UP_TO_DATE:this.NextSceneFinish(!0);break;case jsb.EventAssetsManager.NEW_VERSION_FOUND:return this._isNexting=!1,void this.onShowUpdateTip();case jsb.EventAssetsManager.UPDATE_PROGRESSION:var t=e.getPercent();if(isNaN(t))return;return void e.getMessage();default:return}this._am.setEventCallback(null),this._isNexting=!1},t.prototype.startNextScene=function(){this._am&&!this._isNexting&&(this._am.setEventCallback(this.updateCallback.bind(this)),this._am.getState()===jsb.AssetsManager.State.UNINITED&&this._am.loadLocalManifest(this.manifestUrl,this._storagePath),this._retryCount=0,this._am.update(),this._isNexting=!0,this.tipNode.active=!1)},t.prototype.updateCallback=function(e){var t=!1,o=!1;switch(e.getEventCode()){case jsb.EventAssetsManager.ERROR_NO_LOCAL_MANIFEST:o=!0,this.NextSceneFinish(!0);break;case jsb.EventAssetsManager.UPDATE_PROGRESSION:0==e.getPercentByFile()?this.fileProgress.progress=.01:this.fileProgress.progress=e.getPercentByFile();var i=Math.floor(e.getDownloadedFiles()/e.getTotalFiles()*100);if(isNaN(i))return;this.fileLabel.string=i+"%",e.getMessage(),this.infoLabel.string="\u6b63\u5728\u4e0b\u8f7d\u4e2d\u2026",this.infoLabel.node.active=!0,this.fileProgress.node.active=!0;break;case jsb.EventAssetsManager.ERROR_DOWNLOAD_MANIFEST:case jsb.EventAssetsManager.ERROR_PARSE_MANIFEST:o=!0,this.NextSceneFinish(o);break;case jsb.EventAssetsManager.ALREADY_UP_TO_DATE:o=!0,this.NextSceneFinish(!0);break;case jsb.EventAssetsManager.UPDATE_FINISHED:this.disPatchRateEvent(1),t=!0,o=!0;break;case jsb.EventAssetsManager.UPDATE_FAILED:this._isNexting=!1,this._canRetry=!0,this.retryUpdate();break;case jsb.EventAssetsManager.ERROR_UPDATING:case jsb.EventAssetsManager.ERROR_DECOMPRESS:}if(o&&(this._am.setEventCallback(null),this._isNexting=!1),t){this._am.setEventCallback(null);var a=jsb.fileUtils.getSearchPaths(),n=this._am.getLocalManifest().getSearchPaths();Array.prototype.unshift.apply(a,n),cc.sys.localStorage.setItem("NextSceneSearchPaths",JSON.stringify(a)),jsb.fileUtils.setSearchPaths(a),cc.audioEngine.stopAll(),this.scheduleOnce(function(){cc.game.restart()},.1)}},t.prototype.retryUpdate=function(){this._retryCount>=this._retryMaxCount?this.NextSceneFinish(!1):!this._isNexting&&this._canRetry&&this._retryCount<this._retryMaxCount&&(this._canRetry=!1,this._retryCount++,this._am.downloadFailedAssets())},t.prototype.NextSceneFinish=function(){this._am.getState()===jsb.AssetsManager.State.UNINITED&&this._am.loadLocalManifest(this.manifestUrl,this._storagePath),r.default.Instance.version=this._am.getLocalManifest().getVersion(),cc.sys.localStorage.setItem("clentVersion",r.default.Instance.version),this.tipNode.active=!1,this.infoLabel.node.active=!1,this.fileProgress.node.active=!1,cc.tween(this.node).delay(.1).call(function(){cc.director.loadScene("scene/login")}).start()},t.prototype.disPatchRateEvent=function(e){e>1&&(e=1)},t.prototype.onShowUpdateTip=function(){if(this._am.getTotalBytes()<=0)return this.NextSceneFinish(!0);this.infoLabel.node.active=!1,this.fileProgress.node.active=!1,this.tipNode.active=!0;var e="\u6709\u65b0\u7248\u672c\u5185\u5bb9\u5927\u5c0f"+this.getUnit(this._am.getTotalBytes());this.tipNode.getChildByName("TipUpdataLabel").getComponent(cc.Label).string=e},t.prototype.getUnit=function(e){if(0==e)return"0 B";for(var t=0,o=0;o<8&&!(e/Math.pow(1024,o)<1);o++)t=o;return(e/Math.pow(1024,t)).toFixed(3)+" "+["B","KB","MB","GB","TB","PB","EB","ZB","YB"][t]},t.prototype.modifyAppLoadUrlForManifestFile=function(e,t){var o="https://"+this.package+e+"/",i=cc.sys.localStorage.getItem(this.NextSceneUrlCacheKey);if(i&&i==o)t();else if(jsb.fileUtils.isFileExist(this._storagePath+"/pjmt")){var a=jsb.fileUtils.getStringFromFile(this._storagePath+"/pjmt");(r=JSON.parse(a)).packageUrl=o,r.remoteManifestUrl=o+"pjmt",r.remoteVersionUrl=o+"vsmt";var n=JSON.stringify(r);jsb.fileUtils.writeStringToFile(n,this._storagePath+"/pjmt")&&cc.sys.localStorage.setItem(this.NextSceneUrlCacheKey,o),t()}else{var r;jsb.fileUtils.isDirectoryExist(this._storagePath)||jsb.fileUtils.createDirectory(this._storagePath),a=this.manifestRes,(r=JSON.parse(a)).packageUrl=o,r.remoteManifestUrl=o+"pjmt",r.remoteVersionUrl=o+"vsmt",n=JSON.stringify(r),jsb.fileUtils.writeStringToFile(n,this._storagePath+"/pjmt")&&cc.sys.localStorage.setItem(this.NextSceneUrlCacheKey,o),t()}},t.prototype.showLog=function(e){cc.log("[NextScene][showLog]----"+e)},t.prototype.getHotFileInXml=function(){var e=cc.sys.localStorage.getItem("NextSceneSearchPaths");if(e){var t=JSON.parse(e);if(t.length>1)return t[0]}return null},n([d({type:cc.Label})],t.prototype,"infoLabel",void 0),n([d({type:cc.Label})],t.prototype,"versionLabel",void 0),n([d({type:cc.ProgressBar})],t.prototype,"fileProgress",void 0),n([d(cc.Label)],t.prototype,"fileLabel",void 0),n([d(cc.Node)],t.prototype,"tipNode",void 0),n([d(cc.Node)],t.prototype,"quitNode",void 0),n([l],t)}(cc.Component);o.default=u,cc._RF.pop()},{"./Global":"Global","./utils/GamePlatform":"GamePlatform"}],NotJoinedSociatyview:[function(e,t,o){"use strict";cc._RF.push(t,"a287fpLbZ5CXZxs4E+YEPrk","NotJoinedSociatyview");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=e("../../utils/GameTools"),l=e("../../common/EventConst"),d=e("../../modules/manager/EventManager"),u=e("./SociatyCtrl"),h=e("./SociatyModel"),p=e("../../modules/base/GameView"),f=e("../../Global/GameGlobal"),g=e("../../common/PlayerModule"),m=e("../../utils/GameUtils"),_=cc._decorator,y=_.ccclass,v=_.property,C=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.itemPrefab=null,t.scrollViewNode=null,t.notSociatyTip=null,t.m_txt_time=null,t.refreshRecommendBtn=null,t.inviteRedPointNode=null,t.nLeaveTime=0,t}return a(t,e),t.path=function(){return"ui/sociaty/prefab/NotJoinedSociaty"},t.prototype.onLoad=function(){var e=this;c.default.registerTouchEvent(this.node.getChildByName("btn_back"),function(){e.closeView()}),d.default.Instance.on(l.default.SociatyInviteBtnRedpointEvent,this.onRefreshInviteRedPoint,this),d.default.Instance.on(l.default.RecommendSociatyEvent,this.onRefreshRecommendedlistinfo,this),d.default.Instance.on(l.default.CloseNotJoinedSociatyView,function(){return e.closeView()},this)},t.prototype.start=function(){h.default.instance().getSociatyInviteLength()<=0&&u.default.c_Sociaty_RoleGetInviteData(),this.onRefreshInviteRedPoint(),h.default.instance().RefreshRecommendedCd>0&&(this.onRefreshRecommendCd(),this.schedule(this.onRefreshRecommendCd,1));var e=g.default.getServersTime(),t=h.default.instance().SociatyPlayerData.activeLeaveSociaty,o=h.default.instance().SociatyPlayerData.passiveLeaveSociaty;return t>0&&e<t?(this.nLeaveTime=t,this.onRefreshLeaveTimeCd(),void this.schedule(this.onRefreshLeaveTimeCd,1)):o>0&&e<o?(this.nLeaveTime=o,this.onRefreshLeaveTimeCd(),void this.schedule(this.onRefreshLeaveTimeCd,1)):void(h.default.instance().RefreshRecommendedCd>0?d.default.Instance.emit(l.default.RecommendSociatyEvent,h.default.instance().SociatyRecommendedList):u.default.c_Sociaty_RoleGetRecommendSociaty())},t.prototype.onRefreshLeaveTimeCd=function(){var e=this.nLeaveTime-g.default.getServersTime();if(e<0)return u.default.c_Sociaty_RoleGetRecommendSociaty(),this.m_txt_time.node.active=!1,this.unschedule(this.onRefreshLeaveTimeCd);this.m_txt_time.string=f.G.StringManager.getWorldString("union_exit_time",function(e){var t="";if(e>-1){var o=Math.floor(e/3600),i=Math.floor(e/60)%60,a=e%60;t=o<10?"0"+o+":":o+":",i<10&&(t+="0"),t+=i+":",a<10&&(t+="0"),t+=a.toFixed(0)}return t}.call(this,e)),this.m_txt_time.node.active=!0,this.notSociatyTip.active=!1},t.prototype.onRefreshRecommendedlistinfo=function(e){this.scrollViewNode.content.removeAllChildren();var t=e.length;this.notSociatyTip.active=t<=0;for(var o=0;o<t;o++){var i=cc.instantiate(this.itemPrefab);i.parent=this.scrollViewNode.content,i.getComponent("SociatyRecommendItem").initData(e[o])}},t.prototype.onRefreshSingleListItem=function(e){this.scrollViewNode.content.children.forEach(function(t){t.sociatyID==e&&(t.bApplyState=!0,t.getChildByName("btn_apply").getComponent(cc.Button).interactable=!1,t.getChildByName("btn_apply").getComponent(cc.Button).enableAutoGrayEffect=!0,t.getChildByName("btn_apply").getChildByName("Background").getChildByName("Label").getComponent(cc.Label).string=f.G.StringManager.getWorldString("join_sociaty_client_error1"))})},t.prototype.chickApplyState=function(e){for(var t=0;t<this.scrollViewNode.content.children.length;t++){var o=this.scrollViewNode.content.children[t];if(o.sociatyID==e)return o.bApplyState}return!1},t.prototype.onClickRefreshListCallBack=function(){u.default.c_Sociaty_RoleGetRecommendSociaty(),h.default.instance().RefreshRecommendedCd=Number(m.getConfigIntValue("cd_union_recommended_refresh_time")),this.schedule(this.onRefreshRecommendCd,1)},t.prototype.onClickCreateSociatyCallBack=function(){p.default.addPopView("BaseCtrl","SociatyCreateView","SociatyCreateView")},t.prototype.onClickInvitationListCallBack=function(){p.default.addPopView("BaseCtrl","SociatyInvitedView","SociatyInvitedView")},t.prototype.onClickFindSociatyCallBack=function(){p.default.addPopView("BaseCtrl","SociatySearchView","SociatySearchView")},t.prototype.onRefreshRecommendCd=function(){var e=h.default.instance().RefreshRecommendedCd;e>0?(this.refreshRecommendBtn.interactable=!1,this.refreshRecommendBtn.enableAutoGrayEffect=!0,this.refreshRecommendBtn.node.children[0].children[1].active=!0,this.refreshRecommendBtn.node.children[0].children[0].active=!1,this.refreshRecommendBtn.node.children[0].children[1].getComponent(cc.Label).string=e+"s",h.default.instance().RefreshRecommendedCd--):(this.refreshRecommendBtn.interactable=!0,this.refreshRecommendBtn.enableAutoGrayEffect=!1,this.refreshRecommendBtn.node.children[0].children[1].active=!1,this.refreshRecommendBtn.node.children[0].children[0].active=!0,this.unschedule(this.onRefreshRecommendCd))},t.prototype.onRefreshInviteRedPoint=function(){this.inviteRedPointNode.active=h.default.instance().checkSociatyInviteRedPoint()},t.prototype.onDestroy=function(){d.default.Instance.off(this,l.default.RecommendSociatyEvent),d.default.Instance.off(this,l.default.CloseNotJoinedSociatyView),d.default.Instance.off(this,l.default.SociatyInviteBtnRedpointEvent),this.unschedule(this.onRefreshLeaveTimeCd),this.unschedule(this.onRefreshRecommendCd),this.unscheduleAllCallbacks()},n([v(cc.Prefab)],t.prototype,"itemPrefab",void 0),n([v(cc.ScrollView)],t.prototype,"scrollViewNode",void 0),n([v(cc.Node)],t.prototype,"notSociatyTip",void 0),n([v(cc.Label)],t.prototype,"m_txt_time",void 0),n([v(cc.Button)],t.prototype,"refreshRecommendBtn",void 0),n([v(cc.Node)],t.prototype,"inviteRedPointNode",void 0),n([s.Register_Class,y],t)}(r.default);o.default=C,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../common/EventConst":"EventConst","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/base/GameView":"GameView","../../modules/manager/EventManager":"EventManager","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils","./SociatyCtrl":"SociatyCtrl","./SociatyModel":"SociatyModel"}],NotificationManager:[function(e,t,o){"use strict";cc._RF.push(t,"111f45YnhJCpo8HwpHo1MWm","NotificationManager");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0});var n=e("../base/BaseSingle"),r=e("./ViewManager"),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.onCreate=function(){this.msgMap=new Map},t.prototype.onDestroy=function(){this.msgMap=null},t.prototype.on=function(e,t,o){this.msgMap.set(e,{key:e,cb:t,target:o})},t.prototype.emit=function(e,t){var o=r.default.popCtrlList;this._loopMap(o,e,t);var i=r.default.layerCtrlList;this._loopMap(i,e,t)},t.prototype.off=function(e,t){for(var o in this.msgMap){var i=this.msgMap.get(o);if(t&&i.target==t&&o==e)return void this.msgMap.delete(e);t||o!=e||this.msgMap.delete(e)}},t.prototype.offByTarget=function(e){for(var t in this.msgMap){var o=this.msgMap.get(t);if(e&&o.target==e)return void this.msgMap.delete(t)}},t.prototype._loopMap=function(e,t,o){for(var i=function(e){if(null==e||null==e)return"continue";a.msgMap.forEach(function(i,a){a==t&&i&&e==i.target&&i.cb.call(i.target,o)})},a=this,n=0,r=e;n<r.length;n++)i(r[n])},t}(n.BaseSingle);o.default=n.SingleFactory.getInstance(s),cc._RF.pop()},{"../base/BaseSingle":"BaseSingle","./ViewManager":"ViewManager"}],NpcObj:[function(e,t,o){"use strict";cc._RF.push(t,"bf000XBb2xA1rVGnQnU8uPG","NpcObj"),o.__esModule=!0,o.default=void 0,e("../../network/ClientNetwork"),e("../../network/protocol/RoleProtocols");var i=T(e("../../utils/ConfigUtils")),a=e("../../utils/ConstValue"),n=T(e("../../utils/Debug")),r=T(e("../../utils/Tools")),s=T(e("../CombatManager")),c=T(e("../logic/PassiveSkill")),l=T(e("../logic/Skill")),d=T(e("./BuffObj")),u=T(e("./CombatObj")),h=T(e("../../common/PlayerModule")),p=(T(e("long")),T(e("../../common/CombatModule"))),f=e("../../utils/GameUtils"),g=e("../../StaticData/RobotTableData"),m=T(e("../../view/mainScene/CarSkinUtils")),_=e("../../network/protocol/TypeProtocols"),y=T(e("../../view/activity/ActivityModule")),v=(T(e("../../modules/manager/EventManager")),T(e("../../common/EventConst")),e("../../StaticData/HeroSkinTableData")),C=e("../../utils/RandomSeed"),S=e("../../network/protocol/FightProtocols");function T(e){return e&&e.__esModule?e:{default:e}}var I=function(e){var t,o;function u(){var t;return(t=e.call(this)||this).config=null,t.level=0,t.skillIdList="",t.pSkillObjList=[],t.passiveSkillIdList="",t.maxPassiveSkillIdList="",t.pPassiveSkillObjList=[],t.maxPassiveSkillObjList=[],t.state=-1,t.moveSpeed=0,t.npcType=0,t.dropMoney=0,t.buffList=[],t.speedScale=0,t.tbAimList={},t.xuanyun_state=!1,t.wudi_state=!1,t.immunity_state=!1,t.immunity_several_state=!1,t.frozen_state=!1,t.cellX=0,t.cellY=0,t.dropId=0,t.summonedSustainTime=0,t.configSummonedSustainTime=0,t.trueDamage_state=!1,t.setTrueDamagePERC(0),t.setDamageLimitMaxHpPERC(0),t.sliverCurse_state=!1,t.whosyourdaddy_state=-1,t.whosyourdaddyBuffIdList=[],t.dodgeSeedRandom=null,t.critSeedRandom=null,t.nextSkillIndex=0,t.bloodNode=null,t.shadowNode=null,t.theSummonerId=0,t.bTheSummonerIsHero=!1,t.bTheSummonerIdentity=a.PLAYER_IDENTITY.home,t}o=e,(t=u).prototype=Object.create(o.prototype),t.prototype.constructor=t,t.__proto__=o;var T=u.prototype;return T.destroy=function(){if(this.pPassiveSkillObjList){for(var t in this.pPassiveSkillObjList)this.pPassiveSkillObjList[t]&&(this.pPassiveSkillObjList[t].unbind(),this.pPassiveSkillObjList[t]=null);this.pPassiveSkillObjList=null}if(this.maxPassiveSkillObjList){for(var o in this.maxPassiveSkillObjList)this.maxPassiveSkillObjList[o]&&(this.maxPassiveSkillObjList[o].unbind(),this.maxPassiveSkillObjList[o]=null);this.maxPassiveSkillObjList=[]}if(this.pSkillObjList){for(var i in this.pSkillObjList)this.pSkillObjList[i]&&(this.pSkillObjList[i].unbind(),this.pSkillObjList[i]=null);this.pSkillObjList=[]}for(var a in this.tbAimList=null,this.buffList){var n=this.buffList[a];n&&cc.isValid(n)&&cc.isValid(n.node)&&(n._HitTarget&&n._HitTarget.removeBuffById(n.uId),n.node.destroy())}if(this.buffList=null,delete this.buffList,this.summonedSustainTime=0,this.configSummonedSustainTime=0,this.node&&cc.isValid(this.node)){this.node.angle=0;var r=this.getCamp();3==r&&(r=1);var s=this.bloodNode;s&&(s.active=!1,s.getComponent(cc.ProgressBar).progress=1,s.scale=1);var c=this.shadowNode;c&&(c.active=!1)}this.dodgeSeedRandom=null,this.critSeedRandom=null,this.nextSkillIndex=0,e.prototype.destroy.call(this),this.bloodNode=null,this.shadowNode=null},T.removeAllBuff=function(){for(var e in this.buffList){var t=this.buffList[e];t&&cc.isValid(t)&&cc.isValid(t.node)&&(t._HitTarget&&t._HitTarget.removeBuffById(t.uId),t.node.destroy())}this.buffList=[]},T.unBindPassiveEvent=function(){if(this.pPassiveSkillObjList)for(var e in this.pPassiveSkillObjList)this.pPassiveSkillObjList[e]&&this.pPassiveSkillObjList[e].unbindEvent();if(this.maxPassiveSkillObjList)for(var t in this.maxPassiveSkillObjList)this.maxPassiveSkillObjList[t]&&this.maxPassiveSkillObjList[t].unbindEvent()},T.init=function(t,o,r,c,l){var d=i.default.getInstance().getNpcTemplateConfig(o,r);if(d){this.npcType=d.type,this.npcType==a.NPC_TYPE.Summoned&&(this.configSummonedSustainTime=d.summonedSustainTime),s.default.getInstance().gameState==a.Game_State.Reconnect?(l.y=l.y,l.x=l.x,d.type==a.NPC_TYPE.Car&&(l.y+=d.offset_y,l.x+=d.offset_x*this.campParam)):(l.y=l.y+d.offset_y,l.x=l.x+d.offset_x*this.campParam),this.heroTemplateId&&(2!=i.default.getInstance().getHeroConfig(this.heroTemplateId).hero_type||c||(c=s.default.getInstance().getController().mapNode)),e.prototype.init.call(this,t,o,c,l),this.level=r,this.initConfig(d),this.initRes(d.res_id),this.initSkills(),this.initPassiveSkills(),this.onBorn(),this.offset_y=d.offset_y,this.Shadow&&this.loadNpcShadow(),this.damageType=d.damage_type,this.dropId=d.drop_id;var u=this.id;this.setDodgeSeedRandom(u),this.isHero()&&(u+=(0,f.getRoleIdentity)(this.camp)),this.setCritSeedRandom(u)}else n.default.error("NpcObj init get config failed templateId = "+this.templateId+", level = "+this.level)},T.refreshLevel=function(e){this.level=e;var t=i.default.getInstance().getNpcTemplateConfig(this.templateId,this.level);if(t){if(t=(0,f.clone)(t),this.isCar()){var o=i.default.getInstance().getCarConfig(this.model.templateId),r=(Number(o.lv_up_hp.split("|")[e-1]),0);if(this.camp===a.PLAYER_CAMP.myPlayer?(t.hp=this.getHeroCardHp(),o&&(t.hp+=o.ini_hp,r=o.ini_hp)):o&&(r=o.ini_hp,t.hp=this.calcOpponentsHp(r)),s.default.getInstance().isCoop()){var c=(0,f.getRoleIdentity)(this.camp);if(c==a.PLAYER_IDENTITY.home?t.hp=0:c==a.PLAYER_CAMP.opponentsCoop?t.hp=0:t.hp=this.calcOpponentsHp(r)+this.getHeroCardHp()+r,s.default.getInstance().isSkyCastle()&&this.camp==a.PLAYER_CAMP.opponents){var l=function(e){var t=0,o=p.default.getMatchBattleAIInfo(e);return o&&o.heros.forEach(function(e){var o=i.default.getInstance().getHeroConfig(e.heroID),a=i.default.getInstance().getNpcTemplateConfig(o.npc_id,e.heroLevel);t+=a.carhp}),t},d=g.RobotTableData.getById(this.aiId);t.hp=d.carUpHp,t.hp+=l(a.PLAYER_CAMP.opponents),t.hp+=l(a.PLAYER_CAMP.opponentsCoop);var u=p.default.getMatchBattleAIInfo(a.PLAYER_CAMP.opponentsCoop);if(u){var h=g.RobotTableData.getById(u.aiid);h&&(t.hp+=h.carUpHp)}}}}if(this.setAttr(t),this.isCar()){i.default.getInstance().getNpcTemplateConfig(this.templateId,this.level-1);var m=i.default.getInstance().getCarConfig(this.model.templateId),_=Number(m.lv_up_hp.split("|")[e-1]),y=p.default.getMatchBattleInfo(!1);y&&1==y.bRobot&&(this.hp=Math.floor(this.hp*_/100),this.maxHp=Math.floor(this.maxHp*_/100));var v=s.default.getInstance().getPlayerModelByCamp(this.camp);v&&1==v.bIsSyncCarLvUp&&this.camp==a.PLAYER_CAMP.coopPlayer&&(this.bIsSyncCarLvUp=!1),cc.director.emit("Event_ChangeMaxHp",this.npcType,this.camp,this.id)}this.refRes(t.res_id),this.moveSpeed=t.move_speed,this.dropMoney=t.money}else n.default.error("NpcObj levelup get config failed templateId = "+this.templateId+", level = "+this.level)},T.onLoadRes=function(t){e.prototype.onLoadRes.call(this,t),this.chgState(a.NPC_STATE.IDLE),(this.isMonster()||this.isSummoned())&&this.createBlood()},T.getHeroCardHp=function(){var e=h.default.getHeroCarData(),t=0;return e.forEach(function(e){if(e&&1==e.bHeroLock){var o=i.default.getInstance().getHeroConfig(e.heroId),a=i.default.getInstance().getNpcTemplateConfig(o.npc_id,e.heroLevel);t+=a.carhp}else if(p.default.matchType==_.FIGHT_TYPE.FIGHT_TYPE_BATTLE_GREAT_SAILING){var n=!1,r=y.default.getNavigationBattleCards();if(r)for(var s=0;s<r.length;s++)if(r[s].heroId==e.heroId){n=!0;break}if(1==n){var c=i.default.getInstance().getHeroConfig(e.heroId),l=i.default.getInstance().getNpcTemplateConfig(c.npc_id,e.heroLevel);t+=l.carhp}}}),t},T.calcOpponentsHp=function(e){var t=0,o=p.default.getMatchBattleInfo(!1);return o&&1!=o.bRobot?(p.default._matchPlayerCards&&p.default._matchPlayerCards.forEach(function(e){var o=i.default.getInstance().getHeroConfig(e.heroID),a=i.default.getInstance().getNpcTemplateConfig(o.npc_id,e.heroLevel);t+=a.carhp}),t+=e):o&&1==o.bRobot&&(p.default.matchType==_.FIGHT_TYPE.FIGHT_TYPE_BATTLE_GREAT_SAILING||(t+=g.RobotTableData.getById(o.aiid).carUpHp)),t},T.initConfig=function(e){var t=0;if((e=(0,f.clone)(e)).type===a.NPC_TYPE.Car){if(this.camp===a.PLAYER_CAMP.myPlayer){e.hp=this.getHeroCardHp();var o=i.default.getInstance().getCarConfig(this.model.templateId);o&&(e.hp+=o.ini_hp,t=o.ini_hp)}else{var n=i.default.getInstance().getCarConfig(this.model.templateId);n&&(t=n.ini_hp,e.hp=this.calcOpponentsHp(t))}if(s.default.getInstance().isCoop()){var r=(0,f.getRoleIdentity)(this.camp);r==a.PLAYER_IDENTITY.home?e.hp=0:r==a.PLAYER_CAMP.opponentsCoop?e.hp=0:e.hp=this.calcOpponentsHp(t)+this.getHeroCardHp()+t,this.camp===a.PLAYER_CAMP.opponents&&(e.hp=t)}}this.setAttr(e),this.skillIdList=e.skill_id,this.passiveSkillIdList=e.passive_skill,this.moveSpeed=e.move_speed,this.npcType=e.type,this.posType=e.pos_type,this.dropMoney=e.money},T.initPassiveSkills=function(){var e=this;if(this.pPassiveSkillObjList||(this.pPassiveSkillObjList=[]),this.isHero()){var t=i.default.getInstance().getHeroConfig(this.id);t&&(this.maxPassiveSkillIdList=t.starPassiveSkill);for(var o=i.default.getInstance().getHeroTalentTableDataCfg(),n=[],r=0,l=Object.keys(o);r<l.length;r++){var d=l[r];o.hasOwnProperty(d)&&o[d].heroId==this.id&&n.push(o[d])}n.forEach(function(t){Number(e.level)>=t.level&&(e.passiveSkillIdList=t.skillIdList,e.maxPassiveSkillIdList=t.maxSkillIdList)});var u=p.default.getHeroSkinId(this.camp==a.PLAYER_CAMP.myPlayer,this.id);if(u>0){var h=v.HeroSkinTableData.getById(u),f=h.EffectType.split(","),g=p.default.matchType;if(f.indexOf(g+"")>-1||0==h.EffectType.length){var _=h.skillIdList;_.length>0&&(this.passiveSkillIdList.length>0?this.passiveSkillIdList+="|"+_:this.passiveSkillIdList=_,this.maxPassiveSkillIdList.length>0?this.maxPassiveSkillIdList+="|"+_:this.maxPassiveSkillIdList=_)}}}else if(this.isCar()){this.camp,a.PLAYER_CAMP.myPlayer;var y=p.default.getCarSkinId(this.camp),C=p.default.getCarSkinLevel(this.camp),S=m.default.Instance.getCarTalentTableData(y,C);if(s.default.getInstance().isCoop()&&this.camp==a.PLAYER_CAMP.opponents&&(S=null),S){var T=S.EffectType.split(","),I=p.default.matchType;console.log("NpcObj, \u6218\u8f66,effectTyp="+S.EffectType+", matchType="+I),T.indexOf(I+"")>-1||0==S.EffectType.length?this.passiveSkillIdList=S.skillIdList:this.passiveSkillIdList=""}}if(""!=this.passiveSkillIdList){var N=this.passiveSkillIdList.split("|");for(var b in N){var w=N[b];this.pPassiveSkillObjList[w]=new c.default,this.pPassiveSkillObjList[w].init(w,this)}}},T.initMaxLvPassiveSkill=function(e){if(this.pPassiveSkillObjList){for(var t in this.pPassiveSkillObjList)this.pPassiveSkillObjList[t].unbind(),this.pPassiveSkillObjList[t]=null;this.pPassiveSkillObjList=null}if(e>0){var o=i.default.getInstance().getHeroConfig(e);if(o){var a=o.starPassiveSkill.split("|");""!=this.maxPassiveSkillIdList&&(a=this.maxPassiveSkillIdList.split("|"));for(var n=0;n<a.length;n++)this.maxPassiveSkillObjList[a[n]]||(this.maxPassiveSkillObjList[a[n]]=new c.default,this.maxPassiveSkillObjList[a[n]].init(a[n],this))}}},T.initSkills=function(){if(""!=this.skillIdList){var e=this.skillIdList.split("|");for(var t in e){var o=e[t];this.pSkillObjList[o]=new l.default,this.pSkillObjList[o].init(o,this)}}},T.changeSkill=function(e){if(this.pSkillObjList){if(this.pSkillObjList[e])return;for(var t in this.pSkillObjList)this.pSkillObjList[t]&&(this.pSkillObjList[t].unbind(),this.pSkillObjList[t]=null);this.skillIdList="",this.pSkillObjList=[]}this.chgState(a.NPC_STATE.IDLE),this.skillIdList=e.toString(),this.pSkillObjList[e]=new l.default,this.pSkillObjList[e].init(e,this)},T.update=function(t){if(-1!=this.state){if(this.isSummoned()&&(this.summonedSustainTime+=1e3*t,this.summonedSustainTime>=a.SummonedSustainTime||this.configSummonedSustainTime>0&&this.summonedSustainTime>=this.configSummonedSustainTime))return this.hp=0,this.dropMoney=0,this.summonedSustainTime=0,void this.onRefreshHpBar();if(this.state!=a.NPC_STATE.Dead)if(this.isDead())this.toDie();else{if(this.pSkillObjList)for(var o in this.pSkillObjList)this.pSkillObjList[o]&&(this.pSkillObjList[o].update(t),!this.pSkillObjList[o].getTarget()&&this.canWalk()&&this.chgState(a.NPC_STATE.Walk));for(var i in this.buffList)this.buffList[i]&&this.buffList[i].onUpdate(t);e.prototype.update.call(this,t)}else if(1==this.xuanyun_state)for(var n in this.buffList)this.buffList[n]&&this.buffList[n].onRemove()}},T.canWalk=function(){return this.state!=a.NPC_STATE.Attack},T.createBlood=function(){var e=this;if(this.node&&cc.isValid(this.node)){var t=this.getCamp();t==a.PLAYER_CAMP.coopPlayer?t=a.PLAYER_CAMP.myPlayer:t==a.PLAYER_CAMP.opponentsCoop&&(t=a.PLAYER_CAMP.opponents);var o=s.default.getInstance().getController().getNpcBloodNode(t,"blood_"+this.node._id);if(o)s.default.getInstance().getController().setNpcBloodNode(o,t),this.bloodNode=o,o.active=!0,o.y=this.node.getPosition().y+this.hpY*this.node.scaleY,this.hpscalable&&(o.scaleX=this.node.scaleX*this.hpscalable/100,o.scaleY=this.node.scaleY*this.hpscalable/100),this.isSummoned()?o.getChildByName("clock").active=!0:o.getChildByName("clock").active=!1,this.onRefreshHpBar();else{var i="combat_ui/blood/progressBar_"+t;cc.resources.load(i,cc.Prefab,function(o,i){if(o)n.default.error("err----------------------------",o);else{var a=cc.instantiate(i);e.node&&cc.isValid(e.node)&&(a.y=e.node.getPosition().y+e.hpY*e.node.scaleY,a.name="blood_"+e.node._id,s.default.getInstance().getController().setNpcBloodNode(a,t),e.bloodNode=a,e.hpscalable&&(a.scaleX=e.node.scaleX*e.hpscalable/100,a.scaleY=e.node.scaleY*e.hpscalable/100),e.isSummoned()?a.getChildByName("clock").active=!0:a.getChildByName("clock").active=!1,e.onRefreshHpBar())}})}}},T.createPopFont=function(e,t,o,i){if(!this.isHero()){var n;n=this.getCamp()==a.PLAYER_CAMP.myPlayer||this.getCamp()==a.PLAYER_CAMP.coopPlayer?t?"font/Label_shuzilv":i?"font/Label_shuzizi":"font/Label_shuzihong":t?"font/Label_shuzilv":i?"font/Label_shuzizi":0==o?"font/Label_shuzibai":"font/Label_shuzicheng";var r=r=s.default.getInstance().getController().getBloodLabelNode(),c=r.getComponent(cc.Label);if(r.y=this.hpY,this.isCar()&&(r.scaleX=1.2*r.scaleX,r.scaleY=1.2*r.scaleY,s.default.getInstance().isCoop()&&cc.isValid(this.node)&&this.model&&this.model.templateId==a.CAR_TEMPLATE_ID.coop_front&&(r.x+=150)),this.node&&cc.isValid(this.node)){var l=s.default.getInstance().getController().getBloodNode();r.parent=l,r.position=l.convertToNodeSpaceAR(this.node.convertToWorldSpaceAR(r.position)),s.default.getInstance().isCoop()&&this.isCar()&&this.model&&this.model.templateId==a.CAR_TEMPLATE_ID.coop_back&&s.default.getInstance().getCoopCarByCamp(this.camp)&&(r.x+=100),c.string=e,c.font=cc.resources.get(n,cc.Font),c.fontSize=32,c.spacingX=-4,"MISS"==e&&(r.x+=20*this.campParam,c.spacingX=-3),i&&(r.y-=15);var d=cc.callFunc(function(e){c.string="",s.default.getInstance().getController().putBloodLabelNode(e)},this,r),u=cc.moveBy(.5,-20,70),h=cc.sequence(u,d);r.runAction(h)}}},T.chgState=function(e,t){var o=this;if(1==this.xuanyun_state)return this.state=e,void(e==a.NPC_STATE.Behit&&this.chgState(a.NPC_STATE.IDLE));if(this.state!=e&&this.spineNode)if(this.state=e,this.setSpeed(0,0),e==a.NPC_STATE.IDLE)this.spineNode.findAnimation("idle")&&this.spineNode.setAnimation(0,"idle",!0);else if(e==a.NPC_STATE.Walk)this.spineNode.setAnimation(0,"walk",!0),this.setSpeed(this.campParam*(this.moveSpeed-this.moveSpeed*this.speedScale),0);else if(e==a.NPC_STATE.Behit)if(this.isCar())this.spineNode.setAnimation(0,"behit",!1),this.spineNode.setCompleteListener(function(e){"behit"===(e.animation?e.animation.name:"")&&o.chgState(a.NPC_STATE.IDLE)});else{if(1==this.immunity_several_state)return;if(1!=this.immunity_state){var i=cc.callFunc(function(){this.isDead()?this.toDie():this.chgState(a.NPC_STATE.IDLE)},this),n=t,r=cc.moveBy(.05,.5*n.x*this.campParam,n.y),s=cc.moveBy(.05,.5*n.x*this.campParam,-1*n.y),c=cc.sequence(r,s,i);this.node.runAction(c)}}},T.restoreState=function(){if(this.spineNode){var e=this.state;0==this.checkSlowSpeedBuff()&&this.setSpeed(0,0),e==a.NPC_STATE.IDLE?this.spineNode.setAnimation(0,"idle",!0):e==a.NPC_STATE.Walk?(this.spineNode.setAnimation(0,"walk",!0),this.setSpeed(this.campParam*(this.moveSpeed-this.moveSpeed*this.speedScale),0)):e==a.NPC_STATE.Behit?(this.isNpc()||this.isSummoned())&&this.spineNode.setAnimation(0,"idle",!0):e==a.NPC_STATE.Attack?this.chgState(a.NPC_STATE.IDLE):e==a.NPC_STATE.Dead&&this.toDie()}},T.canDoSkill=function(){return 1!=this.xuanyun_state&&1!=this.frozen_state&&(this.state==a.NPC_STATE.IDLE||this.state==a.NPC_STATE.Walk)},T.onHurt=function(e,t,o,i,n,c){try{if(e){if(this.state==a.NPC_STATE.Dead)return;if(""!=e.behitRes){var l=s.default.getInstance().getController().getBehitNode(),d=l.convertToNodeSpaceAR(this.node.convertToWorldSpaceAR(cc.v2(0,.8*this.height)));r.default.playEffect(e.behitRes,l,d,e.behitScale)}r.default.playAudioEffect(e.behitAudio),0!=n.x||0!=n.y?1==this.immunity_state||1==this.immunity_several_state||this.chgState(a.NPC_STATE.Behit,n):this.isDead()&&this.toDie(),this.onRefreshHpBar(),this.createPopFont(t,o,i,c)}}catch(u){console.log("npcobj onHurt \u51fa\u9519\u4e86"+u)}},T.onRefreshHpBar=function(){if(this.node&&cc.isValid(this.node)){var e=this.getCamp();e==a.PLAYER_CAMP.coopPlayer&&(e=a.PLAYER_CAMP.myPlayer);var t=this.bloodNode;if(t){var o=t.getComponent(cc.ProgressBar),i=p.default.getMatchBattleInfo(!1);i&&(1==i.bRobot?o.progress=this.hp/this.maxHp:o.progress=this.tmpHp/this.maxHp)}}this.isDead()&&this.toDie()},T.isDead=function(){if(s.default.getInstance().isCoop()&&this.isCar()){if(this.camp==a.PLAYER_CAMP.opponents||this.camp==a.PLAYER_CAMP.opponentsCoop){if(p.default.matchType==_.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE){var e=s.default.getInstance().getCarByCamp(this.camp),t=s.default.getInstance().getCoopCarByCamp(this.camp);return!e||!t||this.hp<=0&&t.hp<=0}return this.hp<=0}var o=p.default.getMatchBattleInfo(!1);if(o&&1==o.bRobot){var i=s.default.getInstance().getCarByCamp(this.camp),n=s.default.getInstance().getCoopCarByCamp(this.camp);return!i||!n||this.hp<=0&&n.hp<=0}return!1}if(this.isHero())return!1;var r=null;s.default.getInstance().lockStepManager&&(r=s.default.getInstance().lockStepManager.getMosterBlood(this.id));var c=null!=r&&null!=r&&r.curBlood<=0;return this.hp<=0||c},T.toDie=function(){var e=this;if(this.state!=a.NPC_STATE.Dead&&(this.chgState(a.NPC_STATE.Dead),this.spineNode)){if(this.dropMoney>0){var t=s.default.getInstance().getController().getEffectNode(),o=t.convertToNodeSpaceAR(this.node.convertToWorldSpaceAR(cc.v2(0,.5*this.height)));r.default.playEffect("combat/effect/jinbi/jinbi",t,o,this.scale)}this.spineNode.findAnimation("dead")?(this.spineNode.setAnimation(0,"dead",!1),this.spineNode.setCompleteListener(function(t){"dead"===(t.animation?t.animation.name:"")&&e.onDie()})):this.onDie()}},T.onDie=function(){if(this.pPassiveSkillObjList){for(var e in this.pPassiveSkillObjList)this.pPassiveSkillObjList[e]&&(this.pPassiveSkillObjList[e].unbind(),this.pPassiveSkillObjList[e]=null);this.pPassiveSkillObjList=[]}if(this.maxPassiveSkillObjList){for(var t in this.maxPassiveSkillObjList)this.maxPassiveSkillObjList[t].unbind(),this.maxPassiveSkillObjList[t]=null;this.maxPassiveSkillObjList=[]}if(this.pSkillObjList){for(var o in this.pSkillObjList)this.pSkillObjList[o]&&(this.pSkillObjList[o].unbind(),this.pSkillObjList[o]=null);this.pSkillObjList=[]}for(var n in this.tbAimList={},this.buffList){var r=this.buffList[n];r&&cc.isValid(r)&&cc.isValid(r.node)&&(r._HitTarget&&r._HitTarget.removeBuffById(r.uId),r.node.destroy())}if(this.buffList=null,delete this.buffList,s.default.getInstance().onNpcDie(this.id),this.dropId&&s.default.getInstance().gameState==a.Game_State.Fighting){var c=this.camp==a.PLAYER_CAMP.myPlayer?a.PLAYER_CAMP.opponents:a.PLAYER_CAMP.myPlayer;if(s.default.getInstance().isCoop()&&(c=this.camp==a.PLAYER_CAMP.myPlayer?a.PLAYER_CAMP.coopPlayer:a.PLAYER_CAMP.myPlayer,!s.default.getInstance().isSkyCastle()||this.camp!=a.PLAYER_CAMP.myPlayer&&this.camp!=a.PLAYER_CAMP.coopPlayer||(c=a.PLAYER_CAMP.opponents)),1==p.default.getMatchBattleInfo(!1).bRobot){var l=0,d=i.default.getInstance().getDorpItemsByID(this.dropId).dropRandom.split("|");for(var u in d){var h=d[u].split("#");l+=Number(h[3])}var f=Math.floor(Math.random()*l),g=0,m=null;for(var _ in d){var y=d[_].split("#");if(f<=(g+=Number(y[3]))){m=y;break}}if(!m)return cc.log("\u968f\u673a\u9519\u8bef\uff0c\u6ca1\u6709\u627e\u5230\u6389\u843d\u6570\u636e"),void this.destroy();if(Number(1003==m[0]))s.default.getInstance().getController().onParachuteAct(m[0],c,Number(m[2]),1);else{var v=m[0],C=p.default.getDropEquipList(),S=C[c]?C[c]:[];S.length>0&&(v=S[S.length-1]._templateId),s.default.getInstance().getController().onParachuteAct(v,c,1,1)}}else{var T=p.default.opponentsReplaced;if(s.default.getInstance().isPvP()){if(c==a.PLAYER_CAMP.myPlayer)s.default.getInstance().onSendRoleBossDropItems(10030,null,"1 "+this.templateId.toString(),a.PLAYER_CAMP.myPlayer);else if(1==T){var I=p.default.getMatchBattleInfo(!1);s.default.getInstance().onSendRoleBossDropItems(10030,I.roleID,"2 "+this.templateId.toString(),a.PLAYER_CAMP.opponents)}}else s.default.getInstance().isCoop()&&(1!=p.default.matchRoleIdentity&&1!=p.default.opponentsReplaced||(c==a.PLAYER_CAMP.opponents||c==a.PLAYER_CAMP.opponentsCoop?s.default.getInstance().onSendRoleBossDropItems(10030,null,"4 "+this.templateId.toString(),a.PLAYER_CAMP.opponents):s.default.getInstance().onSendRoleBossDropItems(10030,null,"3 "+this.templateId.toString(),a.PLAYER_CAMP.myPlayer)))}}this.destroy()},T.setLevel=function(e){this.level=e},T.getLevel=function(){return this.level},T.addBuff=function(e,t){if("string"==typeof e&&(e=parseInt(e)),!(e<=0)&&e){var o=!1,n=this.checkHaveBuff(e),r=i.default.Instance.getBuffConfig(e);if((1!=this.immunity_several_state||r.type!=a.Buff_Type.XuanYun)&&(0==n?o=!0:r.type==a.Buff_Type.countBehit||r.type==a.Buff_Type.Equip_Invalid||r.type==a.Buff_Type.Extra_Sliver_Invalid?(t&&this.resetBuffTime(e,t.getOwnerId()+(0,f.getRoleIdentity)(t.camp)),o=!1):r.index<n?o=!1:1==r.no_cover?o=!1:(this.checkRemoveOldBuff(e),o=!0),1==o)){var s=new d.default;this.buffList&&(this.buffList[s.uId]=s,s.ReleaseTarget=t,s.HitTarget=this,s.init(e,this.node,cc.v2(0,0)))}}},T.onBuffRemoved=function(e){this.buffList&&(this.buffList[e]=null,delete this.buffList[e])},T.removeBuffById=function(e,t){if(void 0===t&&(t=!1),this.buffList){var o=this.buffList[e];o&&o.onRemove(t)}},T.restoreBuffById=function(e){if(this.buffList){var t=this.buffList[e];t&&t.onAdd()}},T.removeBuffByTemplateId=function(e){var t=[];for(var o in this.buffList)this.buffList[o].templateId==e&&t.push(o);for(var i in t)o=t[i],this.removeBuffById(o)},T.removeBuffByType=function(e){var t=[];for(var o in this.buffList)this.buffList[o]._BuffCfg.type==e&&t.push(o);for(var i in t)o=t[i],this.removeBuffById(o)},T.removeAllDebuff=function(e){void 0===e&&(e=!1);var t=[];for(var o in this.buffList){var i=this.buffList[o];i._BuffCfg.debuf_type&&i._BuffCfg.debuf_type>0&&t.push(o)}for(var a in t)o=t[a],this.removeBuffById(o,e)},T.restoreAllDebuff=function(){var e=[];for(var t in this.buffList){var o=this.buffList[t];o._BuffCfg.debuf_type&&o._BuffCfg.debuf_type>0&&e.push(t)}for(var i in e)t=e[i],this.restoreBuffById(t)},T.slowFactor=function(e){this.speedScale+=e,this.state==a.NPC_STATE.Walk&&this.setSpeed(this.campParam*(this.moveSpeed-this.moveSpeed*this.speedScale),0)},T.aimed=function(e){this.tbAimList&&this.tbAimList[e.id]&&(this.tbAimList[e.id]=e.calcDamage(this))},T.canAim=function(){var e=this.hp;for(var t in this.tbAimList)e-=this.tbAimList[t];return e<0?0:1},T.shooted=function(e){this.tbAimList&&this.tbAimList[e.id]&&(this.tbAimList[e.id]=null,delete this.tbAimList[e.id])},T.getBuffCountByType=function(e){var t=0;for(var o in this.buffList)this.buffList[o]._BuffCfg.type==e&&t++;return t},T.checkHaveBuff=function(e){var t=i.default.Instance.getBuffConfig(e);for(var o in this.buffList)if(this.buffList[o]){var a=this.buffList[o];if(a._BuffCfg.kind==t.kind)return a._BuffCfg.index}return 0},T.checkRemoveOldBuff=function(e){var t=i.default.Instance.getBuffConfig(e);for(var o in this.buffList){var a=this.buffList[o];a._BuffCfg.kind==t.kind&&a._BuffCfg.index<=t.index&&a.onRemove()}},T.checkSlowSpeedBuff=function(){for(var e in this.buffList)if(this.buffList[e]._BuffCfg.type==a.Buff_Type.SlowSpeed)return!0;return!1},T.resetBuffTime=function(e,t){var o=i.default.Instance.getBuffConfig(e);for(var n in this.buffList){var r=this.buffList[n];if(r._BuffCfg.kind==o.kind&&r._BuffCfg.index==o.index)if(r._LastTime=0,o.type==a.Buff_Type.countBehit)this.modBehitCount(t);else if(o.type==a.Buff_Type.Equip_Invalid){var c=s.default.getInstance().getPlayerModelByCamp(this.camp);c&&c.setEquipInvaild(!0)}else if(o.type==a.Buff_Type.Extra_Sliver_Invalid){var l=s.default.getInstance().getPlayerModelByCamp(this.camp);l&&l.setSliverInvalid(!0)}}},T.isNpc=function(){return this.npcType==a.NPC_TYPE.Monster||this.npcType==a.NPC_TYPE.Boss},T.isMonster=function(){return this.npcType==a.NPC_TYPE.Monster},T.isHero=function(){return this.npcType==a.NPC_TYPE.Hero},T.isBoss=function(){return this.npcType==a.NPC_TYPE.Boss},T.isCar=function(){return this.npcType==a.NPC_TYPE.Car},T.isSummoned=function(){return this.npcType==a.NPC_TYPE.Summoned},T.isInAir=function(){return this.posType==a.NPC_POS_TYPE.Air},T.isOnLand=function(){return this.posType==a.NPC_POS_TYPE.Land},T.isFlyingobj=function(){return!1},T.modAttr=function(t,o){if(s.default.getInstance().gameState!=a.Game_State.Reconnect&&(t!=a.Npc_Attr_Type.move_speed||0!=this.attr[a.Npc_Attr_Type.move_speed]))if(e.prototype.modAttr.call(this,t,o),t==a.Npc_Attr_Type.curHp){this.chgHp(o,this.camp,this.id,this.getKillRewardPlus(this.dropMoney),this.npcType),this.onRefreshHpBar();var i=!1;o>0&&(i=!0),this.createPopFont(o,i,0,!1)}else if(t==a.Npc_Attr_Type.move_speed)this.moveSpeed=this.attr[a.Npc_Attr_Type.move_speed],this.state==a.NPC_STATE.Walk&&this.setSpeed(this.campParam*(this.moveSpeed-this.moveSpeed*this.speedScale),0);else if(t==a.Npc_Attr_Type.maxHp){if(this.maxHp<=0)return;if(this.isHero())return;var n=this.tmpHp/this.maxHp;this.setMaxHp(o+this.maxHp);var r=o<=0?Math.ceil(o*n):Math.floor(o*n);this.chgHp(r,this.camp,this.id,this.getKillRewardPlus(this.dropMoney),this.npcType),this.isCar()?cc.director.emit("Event_ChangeMaxHp",this.npcType,this.camp,this.id):this.onRefreshHpBar()}else if(t==a.Npc_Attr_Type.hp_inc){if(this.maxHp<=0)return;if(this.isHero())return;var c=this.tmpHp/this.maxHp;console.log("Npc_Attr_Type: 111tmpHp "+this.tmpHp+"--this.getMaxHp()"+this.getMaxHp()+"this.attr[Npc_Attr_Type.hp_inc]"+this.attr[a.Npc_Attr_Type.hp_inc]+"this.template:"+this.templateId);var l=this.maxHp,d=this.attr[a.Npc_Attr_Type.maxHp]*(a.AttrParam+this.attr[a.Npc_Attr_Type.hp_inc])/a.AttrParam*this.starHpParam,u=o<=0?Math.ceil((d-l)*c):Math.floor((d-l)*c);this.setMaxHp(d),this.chgHp(u,this.camp,this.id,this.getKillRewardPlus(this.dropMoney),this.npcType),console.log("Npc_Attr_Type: 222tmpHp "+this.tmpHp+"--this.getMaxHp()"+this.getMaxHp()+"this.attr[Npc_Attr_Type.hp_inc]"+this.attr[a.Npc_Attr_Type.hp_inc]+"this.template:"+this.templateId),this.isCar()?cc.director.emit("Event_ChangeMaxHp",this.npcType,this.camp,this.id):this.onRefreshHpBar()}else if(t==a.Npc_Attr_Type.attack_speed&&this.pSkillObjList)for(var h in this.pSkillObjList)this.pSkillObjList[h]&&this.pSkillObjList[h].calDeltaTime(o)},T.isHaveDebufType=function(e){if(e<=0)return!1;for(var t in this.buffList)if(this.buffList[t]._BuffCfg.debuf_type==e)return!0;return!1},T.getTriggerCritDebufType=function(){if(this.pPassiveSkillObjList)for(var e in this.pPassiveSkillObjList)if(this.pPassiveSkillObjList[e]){var t=this.pPassiveSkillObjList[e].getTriggerCritDebufType();if(t>0)return t}if(this.maxPassiveSkillObjList)for(var o in this.maxPassiveSkillObjList)if(this.maxPassiveSkillObjList[o]){var i=this.maxPassiveSkillObjList[o].getTriggerCritDebufType();if(i>0)return i}return-1},T.getPassiveDamage=function(){if(this.pPassiveSkillObjList)for(var e in this.pPassiveSkillObjList)if(this.pPassiveSkillObjList[e]){var t=this.pPassiveSkillObjList[e].getDamagePlus();if(t>0)return t}if(this.maxPassiveSkillObjList)for(var o in this.maxPassiveSkillObjList)if(this.maxPassiveSkillObjList[o]){var i=this.maxPassiveSkillObjList[o].getDamagePlus();if(i>0)return i}return 0},T.getKillRewardPlus=function(e){if(this.pPassiveSkillObjList)for(var t in this.pPassiveSkillObjList)if(this.pPassiveSkillObjList[t]){var o=this.pPassiveSkillObjList[t].getKillRewardPlus(e);if(o>0)return o}if(this.maxPassiveSkillObjList)for(var i in this.maxPassiveSkillObjList)if(this.maxPassiveSkillObjList[i]){var a=this.maxPassiveSkillObjList[i].getKillRewardPlus(e);if(a>0)return a}return 0},T.loadNpcShadow=function(){var e=this.getCamp();if(e==a.PLAYER_CAMP.coopPlayer?e=a.PLAYER_CAMP.myPlayer:e==a.PLAYER_CAMP.opponentsCoop&&(e=a.PLAYER_CAMP.opponents),this.node&&cc.isValid(this.node)){var t=s.default.getInstance().getController().getNpcShadowNode(e,"shadow_"+this.node._id);if(t)1==this.isOnLand()&&(this.shadowNode=t,t.active=!0,t.y=this.node.getPosition().y+(this.offset_y+10)*this.node.scaleY,t.scaleX=this.node.scaleX,t.scaleY=this.node.scaleY,s.default.getInstance().getController().setNpcShadowNode(t,e));else{if(p.default.matchType==_.FIGHT_TYPE.FIGHT_TYPE_BATTLE_GREAT_SAILING){for(var o=[20151,20152,20153,20154,20251,20252,20253,20254,20351,20352,20353,20354],n=!1,r=0;r<o.length;r++)if(o[r]==this.templateId){n=!0;break}var c=s.default.getInstance().getController().getNpcShadowNode(e,"water_shadow_"+this.node._id);if(!c){this.shadowNode=c,c=new cc.Node("water_shadow_"+this.node._id),s.default.getInstance().getController().setNpcShadowNode(c,e),c.scaleX=this.node.scaleX,c.scaleY=this.node.scaleY;var l=i.default.getInstance().getResConfig(1119).animation;cc.resources.load(l,sp.SkeletonData,function(e,t){if(e)console.log("load Water Res Error");else{var o=c.addComponent(sp.Skeleton);o&&(o.skeletonData=t,o.setSkin("default"),o.setAnimation(0,"idle",!0))}})}if(n){this.shadowNode=c,c.scaleX=this.node.scaleX,c.scaleY=this.node.scaleY,c.active=!0;var d=c.getComponent(sp.Skeleton);s.default.getInstance().getController().setNpcShadowNode(c,e),d&&d.skeletonData&&(d.setSkin("default"),d.setAnimation(0,"idle",!0))}else c.active=!1;return}if(1==this.isOnLand()){var u=new cc.Node;this.shadowNode=u,u.y=this.node.getPosition().y+(this.offset_y+10)*this.node.scaleY,u.opacity=128,u.scaleX=this.node.scaleX,u.scaleY=this.node.scaleY,u.name="shadow_"+this.node._id,s.default.getInstance().getController().setNpcShadowNode(u,e);var h=u.addComponent(cc.Sprite);(0,f.setTexture)(h,this.Shadow)}}}},T.getTargetHPDamagePlus=function(e){if(this.pPassiveSkillObjList)for(var t in this.pPassiveSkillObjList)if(this.pPassiveSkillObjList[t]){var o=this.pPassiveSkillObjList[t].getTargetHPDamagePlus(e);if(o>0)return o}if(this.maxPassiveSkillObjList)for(var i in this.maxPassiveSkillObjList)if(this.maxPassiveSkillObjList[i]){var a=this.maxPassiveSkillObjList[i].getTargetHPDamagePlus(e);if(a>0)return a}return 0},T.getTargetHPExtraDamage=function(e){if(this.pPassiveSkillObjList)for(var t in this.pPassiveSkillObjList)if(this.pPassiveSkillObjList[t]){var o=this.pPassiveSkillObjList[t].getTargetHPExtraDamage(e);if(o>0)return o}if(this.maxPassiveSkillObjList)for(var i in this.maxPassiveSkillObjList)if(this.maxPassiveSkillObjList[i]){var a=this.maxPassiveSkillObjList[i].getTargetHPExtraDamage(e);if(a>0)return a}return 0},T.getHealPercent=function(e){if(this.pPassiveSkillObjList)for(var t in this.pPassiveSkillObjList)if(this.pPassiveSkillObjList[t]){var o=this.pPassiveSkillObjList[t].getHealPercent(e);if(o>0)return o}if(this.maxPassiveSkillObjList)for(var i in this.maxPassiveSkillObjList)if(this.maxPassiveSkillObjList[i]){var a=this.maxPassiveSkillObjList[i].getHealPercent(e);if(a>0)return a}return 0},T.getReboundDamage=function(){if(this.pPassiveSkillObjList)for(var e in this.pPassiveSkillObjList)if(this.pPassiveSkillObjList[e]){var t=this.pPassiveSkillObjList[e].getReboundDamage();if(t>0)return t}if(this.maxPassiveSkillObjList)for(var o in this.maxPassiveSkillObjList)if(this.maxPassiveSkillObjList[o]){var i=this.maxPassiveSkillObjList[o].getReboundDamage();if(i>0)return i}return 0},T.getSellMoreMoney=function(e,t){if(this.pPassiveSkillObjList)for(var o in this.pPassiveSkillObjList)if(this.pPassiveSkillObjList[o]){var i=this.pPassiveSkillObjList[o].getSellMoreMoney(e,t);if(i>0)return i}if(this.maxPassiveSkillObjList)for(var a in this.maxPassiveSkillObjList)if(this.maxPassiveSkillObjList[a]){var n=this.maxPassiveSkillObjList[a].getSellMoreMoney(e,t);if(n>0)return n}return 0},T.getDamageMultiple=function(e){if(this.pPassiveSkillObjList)for(var t in this.pPassiveSkillObjList)if(this.pPassiveSkillObjList[t]){var o=this.pPassiveSkillObjList[t].getDamageMultiple(e);if(o>0)return o}if(this.maxPassiveSkillObjList)for(var i in this.maxPassiveSkillObjList)if(this.maxPassiveSkillObjList[i]){var a=this.maxPassiveSkillObjList[i].getDamageMultiple(e);if(a>0)return a}return 1},T.getEventPR=function(){if(this.maxPassiveSkillObjList)for(var e in this.maxPassiveSkillObjList)if(this.maxPassiveSkillObjList[e]){var t=this.maxPassiveSkillObjList[e].getEventPR();if(t>0)return t}if(this.pPassiveSkillObjList)for(var o in this.pPassiveSkillObjList)if(this.pPassiveSkillObjList[o]){var i=this.pPassiveSkillObjList[o].getEventPR();if(i>0)return i}return 0},T.getProfMinusNum=function(){if(this.maxPassiveSkillObjList)for(var e in this.maxPassiveSkillObjList)if(this.maxPassiveSkillObjList[e]){var t=this.maxPassiveSkillObjList[e].getProfMinusNum();if(t>0)return t}if(this.pPassiveSkillObjList)for(var o in this.pPassiveSkillObjList)if(this.pPassiveSkillObjList[o]){var i=this.pPassiveSkillObjList[o].getProfMinusNum();if(i>0)return i}},T.getEnemyHeroProfValue=function(){if(this.maxPassiveSkillObjList)for(var e in this.maxPassiveSkillObjList)if(this.maxPassiveSkillObjList[e]){var t=this.maxPassiveSkillObjList[e].getEnemyHeroProfValue();if(t>1)return t}if(this.pPassiveSkillObjList)for(var o in this.pPassiveSkillObjList)if(this.pPassiveSkillObjList[o]){var i=this.pPassiveSkillObjList[o].getEnemyHeroProfValue();if(i>1)return i}return 1},T.getEnemyPopulationAddValue=function(){if(this.maxPassiveSkillObjList)for(var e in this.maxPassiveSkillObjList)if(this.maxPassiveSkillObjList[e]){var t=this.maxPassiveSkillObjList[e].getEnemyPopulationAddValue();if(t>1)return t}if(this.pPassiveSkillObjList)for(var o in this.pPassiveSkillObjList)if(this.pPassiveSkillObjList[o]){var i=this.pPassiveSkillObjList[o].getEnemyPopulationAddValue();if(i>1)return i}return 1},T.addPassiveSkill=function(e,t){if(this.pPassiveSkillObjList[e])return null;for(var o in this.pPassiveSkillObjList)if(this.pPassiveSkillObjList[o]){var i=this.pPassiveSkillObjList[o].config.kind,a=this.pPassiveSkillObjList[o].templateId;if(t==i){if(!(Number(e)>Number(a)))return null;this.removePassiveSkill(a)}}return this.pPassiveSkillObjList[e]=new c.default,this.pPassiveSkillObjList[e].init(e,this),this.pPassiveSkillObjList[e]},T.removePassiveSkill=function(e){this.pPassiveSkillObjList&&this.pPassiveSkillObjList[e]&&(this.pPassiveSkillObjList[e].unbind(),this.pPassiveSkillObjList[e]=null,delete this.pPassiveSkillObjList[e])},T.setTrueDamagePERC=function(e){this.trueDamagePERC=e},T.modTrueDamagePERC=function(e){this.trueDamagePERC+=e},T.getTrueDamagePERC=function(){return this.trueDamagePERC},T.setDamageLimitMaxHpPERC=function(e){this.damageLimitPERC=e},T.getDamageLimitMaxHp=function(){return this.damageLimitPERC*this.getMaxHp()/a.AttrParam},T.checkAttrMaxValue=function(e,t){if(this.isHero()&&13==this.heroTemplateId){if(s.default.getInstance().isCoop()){var o=t*(0,f.getCoopMaxKills)()*Math.ceil(s.default.getInstance().batchModel.getIndexTip()/10);if(this.attr[e]>=o)return!0}return!1}},T.setSliverCurseState=function(e){this.sliverCurse_state!=e&&(this.sliverCurse_state=e)},T.getSliverCurseState=function(){return this.sliverCurse_state},T.sliverCurseEffect=function(e){if(!this.immunity_state&&this.getSliverCurseState())for(var t in this.buffList){var o=this.buffList[t];o&&o._BuffCfg.type==a.Buff_Type.Sliver_Curse&&o.sliverCurseEffect(e)}},T.setWhosyourdaddyState=function(e){0!=this.whosyourdaddy_state&&this.whosyourdaddy_state!=e&&(this.whosyourdaddy_state=e)},T.getWhosyourdaddyState=function(){return this.whosyourdaddy_state},T.setWhosyourdaddyBuffID=function(e,t){for(var o in this.whosyourdaddyBuffIdList)if(e<o)return;var a=s.default.getInstance().getPlayerModelByCamp(this.camp);if(t)this.whosyourdaddyBuffIdList[e]&&delete this.whosyourdaddyBuffIdList[e],a&&0!=this.getWhosyourdaddyState()&&a.sendRemoveBuffToServer(S.BUFF_TYPE.BUFF_TYPE_INJURY_FREE,e);else if(this.whosyourdaddyBuffIdList[e]||(this.whosyourdaddyBuffIdList[e]=e),a){var n=i.default.Instance.getBuffConfig(e);n&&a.sendAddBuffToServer(S.BUFF_TYPE.BUFF_TYPE_INJURY_FREE,e,n.validTime)}},T.addWhosyourdaddyBuff=function(){for(var e in this.whosyourdaddyBuffIdList)this.addBuff(this.whosyourdaddyBuffIdList[e])},T.refreshBuffRes=function(e){for(var t in this.buffList){var o=this.buffList[t];o&&(o.node.parent=e,o.node.zIndex=9999,o.adjustBuffPos())}},T.setCritSeedRandom=function(e){this.critSeedRandom=new C.RandomSeed,this.critSeedRandom.RandomSeed(e)},T.getCritSeedRandom=function(){return this.critSeedRandom?this.critSeedRandom.randomMinMaxInt(1,a.AttrParam):a.AttrParam},T.setDodgeSeedRandom=function(e){this.dodgeSeedRandom=new C.RandomSeed,this.dodgeSeedRandom.RandomSeed(e)},T.getDodgeSeedRandom=function(e,t,o,i){var a=e+t+(0,f.getRoleIdentity)(o)+i;return p.default.getSeedRandomResult(a)},T.setNextSkillIndex=function(e){e>6||(this.nextSkillIndex=e)},T.getNextSkillIndex=function(){return this.nextSkillIndex},T.setTheSummonerInfo=function(e,t,o){this.theSummonerId=e,this.bTheSummonerIsHero=t,this.bTheSummonerIdentity=o},T.getTheSummonerinfo=function(){var e=a.PLAYER_CAMP.opponents;return this.bTheSummonerIdentity==p.default.matchRoleIdentity?e=a.PLAYER_CAMP.myPlayer:!s.default.getInstance().isCoop()||this.bTheSummonerIdentity!=a.PLAYER_IDENTITY.away&&this.bTheSummonerIdentity!=a.PLAYER_IDENTITY.home||(e=a.PLAYER_CAMP.coopPlayer),{theSummonerId:this.theSummonerId,bIsHero:this.bTheSummonerIsHero,camp:e}},u}(u.default);o.default=I,t.exports=o.default,cc._RF.pop()},{"../../StaticData/HeroSkinTableData":"HeroSkinTableData","../../StaticData/RobotTableData":"RobotTableData","../../common/CombatModule":"CombatModule","../../common/EventConst":"EventConst","../../common/PlayerModule":"PlayerModule","../../modules/manager/EventManager":"EventManager","../../network/ClientNetwork":"ClientNetwork","../../network/protocol/FightProtocols":"FightProtocols","../../network/protocol/RoleProtocols":"RoleProtocols","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/ConfigUtils":"ConfigUtils","../../utils/ConstValue":"ConstValue","../../utils/Debug":"Debug","../../utils/GameUtils":"GameUtils","../../utils/RandomSeed":"RandomSeed","../../utils/Tools":"Tools","../../view/activity/ActivityModule":"ActivityModule","../../view/mainScene/CarSkinUtils":"CarSkinUtils","../CombatManager":"CombatManager","../logic/PassiveSkill":"PassiveSkill","../logic/Skill":"Skill","./BuffObj":"BuffObj","./CombatObj":"CombatObj",long:"long"}],ObjCollection:[function(e,t,o){"use strict";function i(e){if("object"!=typeof e)return e;var t={};for(var o in e instanceof Array&&(t=[]),e)t[o]=this.deepCopy(e[o]);return t}cc._RF.push(t,"64c6ae7TfdG0LVe5YP5IQRS","ObjCollection"),Object.defineProperty(o,"__esModule",{value:!0}),o.BitSet=o.ObjSet2=o.ObjList=o.ObjVector=o.ObjSet=o.ObjMap=void 0;var a=function(){function e(){this._map=new Map}return e.prototype.clear=function(){this._map.clear()},e.prototype.values=function(){return this._map.values()},e.prototype.delete=function(e){if(e instanceof Object){var t=!1,o=this;return this._map.forEach(function(i,a){e.equals(a)&&(t=o._map.delete(a))}),t}return this._map.delete(e)},e.prototype.forEach=function(e){this._map.forEach(e)},e.prototype.entries=function(){return this._map.entries()},e.prototype.keys=function(){return this._map.keys()},e.prototype.promiseGet=function(e,t){if(e instanceof Object){var o=null;return this._map.forEach(function(t,i){e.equals(i)&&(o=t)}),null==o&&(this._map.set(e,t),o=t),o}var i=this._map.get(e);return null==i&&(this._map.set(e,t),i=t),i},e.prototype.get=function(e){var t;return e instanceof Object?(this._map.forEach(function(o,i){e.equals(i)&&(t=o)}),t):this._map.get(e)},e.prototype.has=function(e){if(e instanceof Object){var t=!1;return this._map.forEach(function(o,i){e.equals(i)&&(t=!0)}),t}return this._map.has(e)},e.prototype.set=function(e,t){if(e instanceof Object){var o=this.getKey(e);o&&(e=o)}return this._map.set(e,t),this},e.prototype.getMap=function(){return this._map},Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:!1,configurable:!0}),e.prototype.getKey=function(e){var t;return e instanceof Object?(this._map.forEach(function(o,i){e.equals(i)&&(t=i)}),t):e},e}();o.ObjMap=a;var n=function(){function e(){this._set=new Set}return e.prototype.add=function(e){return e instanceof Object&&this.has(e)?this:(this._set.add(e),this)},e.prototype.clear=function(){this._set.clear()},e.prototype.delete=function(e){if(e instanceof Object){var t=!1,o=this;return this._set.forEach(function(i){e.equals(i)&&(t=o._set.delete(i))}),t}return this._set.delete(e)},e.prototype.forEach=function(e,t){this._set.forEach(e,t)},e.prototype.has=function(e){if(e instanceof Object){var t=!1;return this._set.forEach(function(o){e.equals(o)&&(t=!0)}),t}return this._set.has(e)},Object.defineProperty(e.prototype,"size",{get:function(){return this._set.size},enumerable:!1,configurable:!0}),e.prototype.empty=function(){return 0==this._set.size},e.prototype.frontValue=function(){var e=this._set.values();return e?e.next().value:null},e.prototype.lastValue=function(){for(var e=this._set.values();;){var t=e.next();if(t.done)return t.value}},e}();o.ObjSet=n;var r=function(){function e(e){this._vector=new Array(e||0)}return e.prototype.getArray=function(){return this._vector},e.prototype.setArray=function(e){this._vector=e},e.prototype.resize=function(e,t){var o=this.size();if(e>o)for(var a=e-o,n=0;n<a;n++)this.push_back(i(t));else e<o&&this._vector.splice(e-1,o-e)},e.prototype.sort=function(e){this._vector.sort(e)},e.prototype.sortWithoutFunc=function(){this._vector.sort()},e.prototype.push_front=function(e){this._vector.unshift(e)},e.prototype.push_back=function(e){this._vector.push(e)},e.prototype.pop_back=function(){return this._vector.pop()},e.prototype.pop_front=function(){return this._vector.shift()},e.prototype.insert=function(e,t,o){for(var i=o||1,a=0;a<i;a++)this._vector.splice(e,0,t)},e.prototype.insertArr=function(e,t,o,i){if(void 0===o&&(o=0),t&&0!=t.length&&!(t.length<=o)){var a=i||t.length;if(a<0){if(a+t.length<=0)return;a=t.length-1+a}for(var n=a-o,r=0;r<n;r++)this._vector.splice(e+r,0,t[o+r]);return this}},e.prototype.insertVector=function(e,t,o,i){if(void 0===o&&(o=0),t&&0!=t.size()&&!(t.size()<=o)){var a=i||t.size();if(a<0){if(a+t.size()<=0)return;a=t.size()-1+a}for(var n=a-o,r=0;r<n;r++)this._vector.splice(e+r,0,t.at(o+r))}},e.prototype.set=function(e,t){e<this._vector.length?this._vector[e]=t:cc.error("please check the index")},e.prototype._find=function(e){for(var t=-1,o=0;o<this._vector.length;o++)if(e==this._vector[o]){t=o;break}return t},e.prototype.erase=function(e,t){var o=0,i=0;if("number"==typeof e)o=e,i=e;else if(-1==(i=this._find(e)))return;if(t)if(t<=this._vector.length-1)if(t<0){if(i>(o=this._vector.length-1+t)){var a=i;i=o,o=a}}else o=t;else o=this._vector.length-1;else o=i+1;var n=o-i;this._vector.splice(i,n)},e.prototype.reverse=function(){for(var e=this.size(),t=Math.floor(e/2),o=0;o<t;o++){var i=this._vector[o];this._vector[o]=this._vector[e-1-o],this._vector[e-1-o]=i}},e.prototype.front=function(){return this._vector[0]},e.prototype.back=function(){return this._vector[this._vector.length-1]},e.prototype.forEach=function(e,t){this._vector.forEach(e,t)},e.prototype.at=function(e){if(!(e>=this.size()||e<0))return this._vector[e]},e.prototype.slice=function(t,o){for(var i=this._vector.slice(t,o),a=new e,n=0;n<i.length;n++)a.push_back(i[n]);return a},e.prototype.has=function(e){return this._find(e)>-1},e.prototype.clear=function(){for(var e=this._vector.length-1;e>=0;e--)this._vector[e];this._vector=[]},e.prototype.size=function(){return this._vector.length},e.prototype.empty=function(){return 0==this._vector.length},e}();o.ObjVector=r;var s=function(){function e(){this._list=new Array}return e.prototype.push_front=function(e){this._list.unshift(e)},e.prototype.pop_front=function(){return this._list.shift()},e.prototype.push_back=function(e){this._list.push(e)},e.prototype.pop_back=function(){this._list.pop()},e.prototype.insert=function(e,t,o){for(var i=o||1,a=0;a<i;a++)this._list.splice(e,0,t)},e.prototype.erase=function(e,t){var o=e,i=e;t?t<=this._list.length-1?t<0?e>(o=this._list.length-1+t)&&(i=o,o=e):o=t:t>this._list.length-1&&(o=this._list.length-1):o=e+1;var a=o-i;this._list.splice(i,a)},e.prototype.remove=function(e){for(var t=-1,o=0;o<this._list.length;o++)if(this._list[o]==e){t=o;break}-1!=t&&this._list.splice(t,1)},e.prototype.unique=function(){for(var e=new Array,t=0;t<this._list.length-1;t++)for(var o=this._list[t],i=t+1;i<this._list.length;i++)if(o==this._list[i]){e.push(i);break}for(var a=e.length-1;a>=0;a--){var n=e[a];this._list.splice(n,1)}},e.prototype.merge=function(e){for(var t=0;t<e.size();t++){var o=e.at(t);this.push_back(o)}},e.prototype.front=function(){return this._list[0]},e.prototype.back=function(){return this._list[this._list.length-1]},e.prototype.at=function(e){if(!(e>=this.size()||e<0))return this._list[e]},e.prototype.forEach=function(e,t){this._list.forEach(e,t)},e.prototype.sort=function(e){this._list.sort(e)},e.prototype.clear=function(){for(var e=this._list.length-1;e>=0;e--)this._list[e];this._list=[]},e.prototype.empty=function(){return 0==this._list.length},e.prototype.size=function(){return this._list.length},e.prototype.getArray=function(){return this._list},e}();o.ObjList=s;var c=function(){function e(e){void 0===e&&(e=null),this._arr=null,this._compare=null,this._arr=new Array,this._compare=e}return e.prototype.forEach=function(e){this._arr.forEach(function(t){e(t)})},e.prototype.add=function(e){return this.has(e)||(this._arr.push(e),this._compare&&this._arr.sort(this._compare)),this},e.prototype.delete=function(e){var t=!1,o=this._arr.indexOf(e);if(-1==o){o=0;for(var i=0,a=this._arr;i<a.length;i++){var n=a[i];if(!this._compare)break;if(0==this._compare(n,e)){t=!0;break}o++}}else t=!0;t&&this._arr.splice(o,1)},e.prototype.has=function(e){var t=!1;if(-1==this._arr.indexOf(e))for(var o=0,i=this._arr;o<i.length;o++){var a=i[o];if(!this._compare)break;if(0==this._compare(a,e)){t=!0;break}}else t=!0;return t},e.prototype.size=function(){return this._arr.length},e.prototype.clear=function(){this._arr=[]},e.prototype.empty=function(){return 0==this.size()},e}();o.ObjSet2=c;var l=function(){function e(e,t){this.data=new Array;var o=e.toString(2);if(o=o.split("").reverse().join(""),!(t<0))for(var i=0;i<t;++i)i>=o.length?this.data[i]=!1:this.data[i]="0"!=o.charAt(i)}return e.prototype.test=function(e){return!(e>=this.data.length)&&this.data[e]},e}();o.BitSet=l,cc._RF.pop()},{}],ObstacleObj:[function(e,t,o){"use strict";cc._RF.push(t,"975c8gt5SxDw6Xp0UkTFfYd","ObstacleObj"),o.__esModule=!0,o.default=void 0;var i=r(e("../../utils/ConfigUtils")),a=e("../../utils/GameUtils"),n=r(e("../CombatManager"));function r(e){return e&&e.__esModule?e:{default:e}}var s=function(e){var t,o;function r(){var t;return(t=e.call(this)||this).config=null,t}o=e,(t=r).prototype=Object.create(o.prototype),t.prototype.constructor=t,t.__proto__=o;var s=r.prototype;return s.destroy=function(){this.config=null,e.prototype.destroy.call(this)},s.init=function(t,o,n,r,s,c,l){this.setCamp(n.getCamp()),this.initCampParam();var d=(0,a.getRoleIdentity)(n.getCamp());this.setOwnerId(n.id+d),this.behitOffset=c,this.damageParam=l,this.config=i.default.getInstance().getObstacleConfig(o),e.prototype.init.call(this,t,o,s,this.getStartPos(config,r,s)),this.cloneAttr(n),this.initRes(this.config.res_id),this.buffId=this.config.buffId,this.onBorn()},s.getStartPos=function(e,t,o){var i=cc.v2(e.pointX,e.pointY);if(1==e.bFixPointX&&1==e.bFixPointY)return i;var a=t.node.convertToWorldSpaceAR(cc.v2(0,0));return a=o.convertToNodeSpaceAR(i),0==e.bFixPointX&&(i.x=a.x),0==e.bFixPointY&&(i.y=a.y),i},s.onLoadRes=function(t){var o=this;e.prototype.onLoadRes.call(this,t);var i=this.spineNode.setAnimation(0,"idle",!1);this.spineNode.setCompleteListener(function(e){"idle"===(e.animation?e.animation.name:"")&&o.toDie()}),this.spineNode.setTrackEventListener(i,function(e,t){"fire"===(t.data?t.data.name:"")&&o.checkAttack()})},s.checkAttack=function(){var e=this.getWorldPos(),t=this.getAttackFram(),o=.5*t[0],i=.5*t[1],a=n.default.getInstance().getNpcList();for(var r in a){var s=a[r];if(s&&0==s.isDead()&&this.camp!=s.camp){if(1==n.default.getInstance().isCoopPartner(this.camp,s.camp))return;var c=s.getWorldPos();Math.abs(c.x-e.x)<o&&Math.abs(c.y-e.y)<i&&this.attackTarget(s,!1,this.behitOffset,this.damageParam)}}},s.toDie=function(){n.default.getInstance().onObstacleDie(this.id),this.onDie()},s.onDie=function(){this.destroy()},s.getAttackFram=function(){return this.config.attackFram.split("|")},r}(r(e("./CombatObj")).default);o.default=s,t.exports=o.default,cc._RF.pop()},{"../../utils/ConfigUtils":"ConfigUtils","../../utils/GameUtils":"GameUtils","../CombatManager":"CombatManager","./CombatObj":"CombatObj"}],OccupationRankListTableData:[function(e,t,o){"use strict";cc._RF.push(t,"6a978+WjBxKKpaPhkHoEnLR","OccupationRankListTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.OccupationRankListTableData=void 0;var i=e("../TableReader"),a=e("./BaseTableData"),n=function(){function e(){this.id=0,this.rankMin=0,this.rankMax=0,this.occupation=0,this.mailid=0,this.prize=new Array}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.rankMin=e.getNumber(),this.rankMax=e.getNumber(),this.occupation=e.getNumber(),this.mailid=e.getNumber();for(var o=e.getString(),n=new i.TableReader(o);n.getPos()<n.getLen();){var r=new a.DropItem;r.readOriginal(n),this.prize.push(r)}},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"OccupationRankListTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.OccupationRankListTableData=n,cc._RF.pop()},{"../TableReader":"TableReader","./BaseTableData":"BaseTableData"}],OnOffTableData:[function(e,t,o){"use strict";cc._RF.push(t,"b1058mh9t9Ip4B4fhlrQvu6","OnOffTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.OnOffTableData=void 0;var i=e("../TableReader"),a=function(){function e(){this.id=0,this.defaultOn=0,this.name="",this.isFunction=0}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.defaultOn=e.getNumber(),this.name=e.getString(),this.isFunction=e.getNumber()},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"OnOffTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.OnOffTableData=a,cc._RF.pop()},{"../TableReader":"TableReader"}],PassiveSkill:[function(e,t,o){"use strict";cc._RF.push(t,"214b4hYVBZLjIAVKnENQ3J3","PassiveSkill"),o.__esModule=!0,o.default=void 0;var i=u(e("../../common/CombatModule")),a=e("../../network/protocol/TypeProtocols"),n=u(e("../../utils/ConfigUtils")),r=e("../../utils/ConstValue"),s=u(e("../../utils/Debug")),c=(u(e("../../utils/GameTools")),e("../../utils/GameUtils")),l=u(e("../../utils/Tools")),d=u(e("../CombatManager"));function u(e){return e&&e.__esModule?e:{default:e}}var h=function(){function e(){this.templateId=0,this.id=0,this.pBindNpcObj=null,this.isEffecting=!1,this.modAttr=0}var t=e.prototype;return t.onDestory=function(){this.unbind(),console.log("passive_unActive",this.templateId),this.isEffecting=!1,this.modAttr=0},t.init=function(e,t){if(this.id=l.default.getInstance().genId(),this.templateId=e,this.pBindNpcObj=t,this.config=n.default.getInstance().getPassiveSkillConfig(e),this.config){if(this.config.attr_type>5&&(this.addParam=100,this.config.attr_type!=r.Npc_Attr_Type.attack_inc&&this.config.attr_type!=r.Npc_Attr_Type.def_phy_inc&&this.config.attr_type!=r.Npc_Attr_Type.def_magic_inc&&this.config.attr_type!=r.Npc_Attr_Type.attack_speed||(this.addParam=1e3)),cc.director.on("passive_unActive",this.onDestory,this),this.config.type!=r.Passive_Type.debuff_crit&&this.config.type!=r.Passive_Type.extra_kill_money&&this.config.type!=r.Passive_Type.sell_more_money&&this.config.type!=r.Passive_Type.extra_hp&&this.config.type!=r.Passive_Type.extra_curHp_attack&&this.config.type!=r.Passive_Type.superpose_damage&&this.config.type!=r.Passive_Type.prof_num_minus)if(this.config.type==r.Passive_Type.extra_maxHp_damage)this.modAttr=this.pBindNpcObj.getPassiveDamage(),this.pBindNpcObj.modAttr(r.Npc_Attr_Type.attack,this.modAttr),cc.director.on("Event_ChangeMaxHp",this.onMaxHpChange,this);else if(this.config.type==r.Passive_Type.kill_target)cc.director.on("Event_KillTarget",this.onKillTarget,this);else if(this.config.type==r.Passive_Type.attack_target)cc.director.on("Event_AttackTarget",this.onAttackTarget,this);else if(this.config.type==r.Passive_Type.buff_prof||1==this.isProfPassive(this.config.type)){if(this.config.type==r.Passive_Type.buff_prof)return this.config.extra_condition_type==r.Passive_Condition.probability?void cc.director.on("Event_PR",this.onEventPR,this):(cc.director.on("Event_changeHero",this.onChangeHero,this),this.config.extra_condition_type==r.Passive_Condition.specialOCC?void this.onChangeHero(this.pBindNpcObj.camp,0):void 0);if(cc.director.on("Event_SummonNpc",this.onAddNpc,this),cc.director.on("Event_changeHero",this.onChangeHero,this),f=d.default.getInstance().getCarByCamp(this.pBindNpcObj.camp)){var o=new Set;if(this.config.type!=r.Passive_Type.buff_prof&&f.getHeroProfNum(this.pBindNpcObj.occupation,o),d.default.getInstance().isCoop()){var i=d.default.getInstance().getCoopCarByCamp(this.pBindNpcObj.camp);i&&(this.config.type!=r.Passive_Type.buff_prof&&i.getHeroProfNum(this.pBindNpcObj.occupation,o),this.config.type!=r.Passive_Type.buff_prof&&this.config.extra_condition_type==r.Passive_Condition.population&&this.config.extra_condition_value<=o.size?this.config.type==r.Passive_Type.buff_car_population?(this.addBuffAndAttrToNpc(!0,!0,i,i.camp),this.effectToAllNpc(!0,i.camp)):this.config.type==r.Passive_Type.buff_summoned||this.config.type==r.Passive_Type.buff_ninja?this.effectToSameOccupation(!0,this.pBindNpcObj.occupation,i.camp):(this.hasTarget(r.Passive_target.selfCar)&&this.addBuffAndAttrToNpc(!0,!0,i,i.camp),this.hasTarget(r.Passive_target.selfHero)&&this.effectToAllHero(!0,i.camp),this.hasTarget(r.Passive_target.selfNpc)&&this.effectToAllNpc(!0,i.camp)):this.config.type==r.Passive_Type.buff_prof&&(this.config.extra_condition_type==r.Passive_Condition.specialOCC?this.effectToSpecialOCC(!0,i.camp):this.effectToSameOccupation(!0,this.pBindNpcObj.occupation,i.camp)))}this.config.type!=r.Passive_Type.buff_prof&&this.config.extra_condition_type==r.Passive_Condition.population&&this.config.extra_condition_value<=o.size?this.config.type==r.Passive_Type.buff_car_population?(this.addBuffAndAttrToNpc(!0,!0,f,f.camp),this.effectToAllNpc(!0,f.camp)):this.config.type==r.Passive_Type.buff_summoned||this.config.type==r.Passive_Type.buff_ninja?this.effectToSameOccupation(!0,this.pBindNpcObj.occupation,f.camp):(this.hasTarget(r.Passive_target.selfCar)&&this.addBuffAndAttrToNpc(!0,!0,f,f.camp),this.hasTarget(r.Passive_target.selfHero)&&this.effectToAllHero(!0,f.camp),this.hasTarget(r.Passive_target.selfNpc)&&this.effectToAllNpc(!0,f.camp)):this.config.type==r.Passive_Type.buff_prof&&(this.config.extra_condition_type==r.Passive_Condition.specialOCC?this.effectToSpecialOCC(!0,f.camp):this.effectToSameOccupation(!0,this.pBindNpcObj.occupation,f.camp)),o.clear()}}else if(this.config.type==r.Passive_Type.buff_all_prof){if(this.hasTarget(r.Passive_target.selfHero)&&(cc.director.on("Event_AddHero",this.onAddHero,this),this.effectToAllHero(!0,this.pBindNpcObj.camp)),this.hasTarget(r.Passive_target.selfNpc)&&(cc.director.on("Event_SummonNpc",this.onAddNpc,this),this.effectToAllNpc(!0,this.pBindNpcObj.camp)),d.default.getInstance().isCoop()){var a=d.default.getInstance().getCoopCarCamp(this.pBindNpcObj.camp);a&&(this.hasTarget(r.Passive_target.selfHero)&&this.effectToAllHero(!0,a),this.hasTarget(r.Passive_target.selfNpc)&&this.effectToAllNpc(!0,a))}}else if(this.config.type==r.Passive_Type.debuff_enemy){if(cc.director.on("Event_SummonNpc",this.onAddNpc,this),this.config.extra_condition_type==r.Passive_Condition.population?cc.director.on("Event_changeHero",this.onChangeHero,this):cc.director.on("Event_AddHero",this.onAddHero,this),1==this.checkProfCondition()||this.config.extra_condition_type!=r.Passive_Condition.population){var c=d.default.getInstance().getOpponentsCarCamp(this.pBindNpcObj.camp);if(c){(f=d.default.getInstance().getCarByCamp(c))&&this.addBuffAndAttrToNpc(!1,!0,f,c);var u=d.default.getInstance().getCoopCarByCamp(c);u&&this.addBuffAndAttrToNpc(!1,!0,u,u.camp),this.hasTarget(r.Passive_target.opponentsNpc)&&this.effectToAllNpc(!0,this.pBindNpcObj.camp)}}}else if(this.config.type==r.Passive_Type.extra_maxHp_attr)this.checkEffectTarget();else if(this.config.type==r.Passive_Type.extra_recv_money)this.addBuffToNpc2(this.pBindNpcObj);else if(this.config.type==r.Passive_Type.buff_car){if(cc.director.on("Event_SummonNpc",this.onAddNpc,this),this.hasTarget(r.Passive_target.selfHero)&&cc.director.on("Event_AddHero",this.onAddHero,this),(f=d.default.getInstance().getCarByCamp(this.pBindNpcObj.camp))&&(this.addBuffAndAttrToNpc(!0,!0,f,f.camp),this.hasTarget(r.Passive_target.selfHero)&&this.effectToAllHero(!0,this.pBindNpcObj.camp),d.default.getInstance().isCoop())){var h=d.default.getInstance().getCoopCarByCamp(this.pBindNpcObj.camp);h&&(this.addBuffAndAttrToNpc(!0,!0,h,h.camp),this.hasTarget(r.Passive_target.selfHero)&&this.effectToAllHero(!0,h.camp))}}else if(this.config.type==r.Passive_Type.extra_sliver_attr){cc.director.on("Event_MoneyChange",this.onMoneyChange,this);var p=d.default.getInstance().getPlayerModelByCamp(this.pBindNpcObj.camp).getCurMoney();this.onMoneyChange(p,this.pBindNpcObj.camp)}else if(this.config.type==r.Passive_Type.buff_car_monster){var f,g=null;d.default.getInstance().isCoop()&&(g=d.default.getInstance().getCoopCarByCamp(this.pBindNpcObj.camp)),cc.director.on("Event_AddHero",this.onAddHero,this),cc.director.on("Event_SummonNpc",this.onAddNpc,this),this.config.extra_condition_type==r.Passive_Condition.haveOCC&&(this.modAttr=this.countSameProfNum()*this.config.attr_value,cc.director.on("Event_changeHero",this.onChangeHero,this)),(f=d.default.getInstance().getCarByCamp(this.pBindNpcObj.camp))&&(this.addBuffAndAttrToNpc(!0,!0,f,f.camp),this.effectToAllHero(!0,this.pBindNpcObj.camp),this.effectToAllNpc(!0,this.pBindNpcObj.camp),g&&(this.addBuffAndAttrToNpc(!0,!0,g,g.camp),this.effectToAllHero(!0,g.camp),this.effectToAllNpc(!0,g.camp)))}else if(this.config.type==r.Passive_Type.buff_self)this.addBuffAndAttrToNpc(!0,!0,this.pBindNpcObj,this.pBindNpcObj.camp);else if(this.config.type==r.Passive_Type.extra_heroLv_attr){cc.director.on("Event_changeHero",this.onChangeHero,this);var m=this.countHeroTotal(!0,r.HERO_TOTAL_TYPE.NUM);m>0&&(this.modAttr=this.config.attr_value*m,this.pBindNpcObj.modAttr(this.config.attr_type,this.modAttr))}else if(this.config.type==r.Passive_Type.extra_heroStar_attr){cc.director.on("Event_changeHero",this.onChangeHero,this);var _=this.countHeroTotal(!0,r.HERO_TOTAL_TYPE.STAR);_>0&&(this.modAttr=this.config.attr_value*_,this.pBindNpcObj.modAttr(this.config.attr_type,this.modAttr))}else if(this.config.type==r.Passive_Type.buff_summoned_npc){if(cc.director.on("Event_SummonNpc",this.onAddNpc,this),this.effectToAllSummoned(!0,this.pBindNpcObj.camp),d.default.getInstance().isCoop()){var y=d.default.getInstance().getCoopCarByCamp(this.pBindNpcObj.camp);y&&this.effectToAllSummoned(!0,y.camp)}}else if(this.config.type==r.Passive_Type.buff_no_prof){if(cc.director.on("Event_changeHero",this.onChangeHero,this),cc.director.on("Event_SummonNpc",this.onAddNpc,this),!1===this.checkProfPassiveSkill()&&(this.effectToAllHero(!0,this.pBindNpcObj.camp),this.effectToAllNpc(!0,this.pBindNpcObj.camp),d.default.getInstance().isCoop())){var v=d.default.getInstance().getCoopCarCamp(this.pBindNpcObj.camp);0!=v&&(this.effectToAllHero(!0,v),this.effectToAllNpc(!0,v))}}else if(this.config.type==r.Passive_Type.summoned_live_time){if(cc.director.on("Event_changeHero",this.onChangeHero,this),cc.director.on("Event_SummonNpc",this.onAddNpc,this),1==this.checkProfCondition()&&(this.effectToAllSummoned(!0,this.pBindNpcObj.camp),d.default.getInstance().isCoop())){var C=d.default.getInstance().getCoopCarCamp(this.pBindNpcObj.camp);0!=C&&this.effectToAllSummoned(!0,C)}}else if(this.config.type==r.Passive_Type.summoned_extra_attr)cc.director.on("Event_SummonNpc",this.onAddNpc,this);else if(this.config.type==r.Passive_Type.panda)cc.director.on("Event_changeHero",this.onChangeHero,this),this.addBuffToNpc2(this.pBindNpcObj),this.effectToALLDoubleHero();else if(this.config.type==r.Passive_Type.charge_interest)cc.director.on("Event_MoneyChange",this.onMoneyChange,this);else if(this.config.type==r.Passive_Type.superpose_damage_prof)cc.director.on("Event_changeHero",this.onChangeHero,this);else if(this.config.type==r.Passive_Type.sell_card_add_attr)cc.director.on("Event_SellHero",this.onSellHero,this);else if(this.config.type==r.Passive_Type.extra_enemy_heroNum_attr){cc.director.on("Event_changeHero",this.onChangeHero,this);var S=this.countHeroTotal(!1,r.HERO_TOTAL_TYPE.NUM),T=0;this.pBindNpcObj.isBoss()?(T=Math.pow(this.config.attr_value,S)-1,this.config.attr_type==r.Npc_Attr_Type.attack_inc&&(T*=1e3)):T=this.config.attr_value*S,this.modAttr=T,this.pBindNpcObj.modAttr(this.config.attr_type,this.modAttr)}else if(this.config.type==r.Passive_Type.change_skill)cc.director.on("Event_changeHero",this.onChangeHero,this),this.checkExtraCondition()&&0!=this.config.extra_condition_value2&&this.pBindNpcObj.changeSkill(this.config.extra_condition_value2);else if(this.config.type==r.Passive_Type.compare_enemy_carLv)cc.director.on("Event_carLvUp",this.onCarLvUp,this),cc.director.on("Event_AddHero",this.onAddHero,this),cc.director.on("Event_SummonNpc",this.onAddNpc,this),this.onCarLvUp(this.pBindNpcObj.camp);else if(this.config.type==r.Passive_Type.summon_spirit||this.config.type==r.Passive_Type.summon_npc)cc.director.on("Event_SummonSpirit",this.onCastSpirit,this);else if(this.config.type==r.Passive_Type.behit_add_buff)cc.director.on("Event_AttackTarget",this.onAttackTarget,this);else if(this.config.type==r.Passive_Type.all_same_prof){if(cc.director.on("Event_changeHero",this.onChangeHero,this),this.isEffecting=this.checkExtraCondition(),this.isEffecting&&(this.effectToAllHero(!0,this.pBindNpcObj.camp),d.default.getInstance().isCoop())){var I=d.default.getInstance().getCoopCarCamp(this.pBindNpcObj.camp);0!=I&&this.effectToAllHero(!0,I)}}else if(this.config.type==r.Passive_Type.change_spirit)if(!d.default.getInstance().isCoop()||this.pBindNpcObj.camp!=r.PLAYER_CAMP.opponents&&this.pBindNpcObj.camp!=r.PLAYER_CAMP.opponentsCoop){var N=d.default.getInstance().getPvpPlayerByCamp(this.pBindNpcObj.camp);if(d.default.getInstance().isCoop()){var b=d.default.getInstance().getPlayerModelByCamp(r.PLAYER_CAMP.opponents);N=null;var w=d.default.getInstance().getPlayerModelByCamp(r.PLAYER_CAMP.opponentsCoop);b&&(b.setChangeSpritPR(this.config.extra_condition_value),b.setChangeSpritRS(this.templateId)),w&&(w.setChangeSpritPR(this.config.extra_condition_value),w.setChangeSpritRS(this.templateId))}N&&(N.setChangeSpritPR(this.config.extra_condition_value),N.setChangeSpritRS(this.templateId))}else{var E=d.default.getInstance().getPlayerModelByCamp(r.PLAYER_CAMP.myPlayer),P=d.default.getInstance().getPlayerModelByCamp(r.PLAYER_CAMP.coopPlayer);E&&(E.setBossChangeSpritPR(this.config.extra_condition_value),E.setBossChangeSpritRS(this.templateId)),P&&(P.setBossChangeSpritPR(this.config.extra_condition_value),P.setBossChangeSpritRS(this.templateId))}else this.config.type==r.Passive_Type.equip_invalid?this.setEquipInvalid(!0):this.config.type==r.Passive_Type.damage_limit_depend_maxHp?this.pBindNpcObj.setDamageLimitMaxHpPERC(this.config.extra_condition_value):this.config.type==r.Passive_Type.whos_your_daddy?this.setWhosyourdaddyState(1):this.config.type==r.Passive_Type.enemy_num?(cc.director.on("Event_SummonNpc",this.onAddNpc,this),cc.director.on("Event_NpcDie",this.onNpcDie,this),this.checkEnemyNumAddAttr()):this.config.type==r.Passive_Type.enemy_profNum_add_damage?(cc.director.on("Event_changeHero",this.onChangeHero,this),this.checkEnemyHeroProfNum()):this.config.type==r.Passive_Type.change_drop_box?this.changeDropBox(!0):this.config.type==r.Passive_Type.enemy_population_add_damage?(cc.director.on("Event_changeHero",this.onChangeHero,this),this.checkEnemyPopulationNum()):this.config.type!=r.Passive_Type.car_dodge_self_add_buff&&this.config.type!=r.Passive_Type.car_dodge_add_buff||cc.director.on("Event_Dodge",this.onNpcDodge,this)}else s.default.error("Passive skill get config failed id = "+e)},t.isPassiveSkillVaild=function(){return!(!this||this.window&&this.window==window||!this.config||!this.pBindNpcObj)},t.unbindEvent=function(){cc.director.off("passive_unActive",this.onDestory,this),cc.director.off("Event_KillTarget",this.onKillTarget,this),cc.director.off("Event_AttackTarget",this.onAttackTarget,this),cc.director.off("Event_AddHero",this.onAddHero,this),cc.director.off("Event_SummonNpc",this.onAddNpc,this),cc.director.off("Event_ChangeMaxHp",this.onMaxHpChange,this),cc.director.off("Event_ChangeHp",this.onHpChange,this),cc.director.off("Event_MoneyChange",this.onMoneyChange,this),cc.director.off("Event_KillAddMoney",this.onKillAddMoney,this),cc.director.off("Event_changeHero",this.onChangeHero,this),cc.director.off("Event_SellHero",this.onSellHero,this),cc.director.off("Event_carLvUp",this.onCarLvUp,this),cc.director.off("Event_SummonSpirit",this.onCastSpirit,this),cc.director.off("Event_PR",this.onEventPR,this),cc.director.off("Event_NpcDie",this.onNpcDie,this),cc.director.off("Event_Dodge",this.onNpcDodge,this)},t.unbind=function(){if(this.unbindEvent(),this.config){if(this.pBindNpcObj){if(this.config.type==r.Passive_Type.extra_maxHp_damage)this.pBindNpcObj.modAttr(r.Npc_Attr_Type.attack,-this.modAttr);else if(this.config.type==r.Passive_Type.buff_prof||1==this.isProfPassive(this.config.type)){if(1!=d.default.getInstance().coopHaveSamePassive(this.pBindNpcObj,this.templateId)&&(m=d.default.getInstance().getCarByCamp(this.pBindNpcObj.camp))&&(this.config.type==r.Passive_Type.buff_prof?this.config.extra_condition_type!=r.Passive_Condition.probability&&(this.config.extra_condition_type==r.Passive_Condition.specialOCC?this.effectToSpecialOCC(!1,m.camp):this.effectToSameOccupation(!1,this.pBindNpcObj.occupation,m.camp)):this.config.type==r.Passive_Type.buff_car_population?(m.removeBuffByTemplateId(this.config.buff),m.removeBuffByTemplateId(this.config.buff2),this.effectToAllNpc(!1,m.camp)):this.config.type==r.Passive_Type.buff_summoned||this.config.type==r.Passive_Type.buff_ninja?this.effectToSameOccupation(!1,this.pBindNpcObj.occupation,m.camp):(this.hasTarget(r.Passive_target.selfCar)&&this.addBuffAndAttrToNpc(!0,!1,m,m.camp),this.hasTarget(r.Passive_target.selfHero)&&(m.removeBuffFromAllHero(this.config.buff),m.removeBuffFromAllHero(this.config.buff2)),this.hasTarget(r.Passive_target.selfNpc)&&this.effectToAllNpc(!1,m.camp)),d.default.getInstance().isCoop())){var e=d.default.getInstance().getCoopCarByCamp(this.pBindNpcObj.camp);e&&(this.config.type==r.Passive_Type.buff_prof?this.config.extra_condition_type!=r.Passive_Condition.probability&&(this.config.extra_condition_type==r.Passive_Condition.specialOCC?this.effectToSpecialOCC(!1,e.camp):this.effectToSameOccupation(!1,this.pBindNpcObj.occupation,e.camp)):this.config.type==r.Passive_Type.buff_car_population?(e.removeBuffByTemplateId(this.config.buff),e.removeBuffByTemplateId(this.config.buff2),this.effectToAllNpc(!1,e.camp)):this.config.type==r.Passive_Type.buff_summoned||this.config.type==r.Passive_Type.buff_ninja?this.effectToSameOccupation(!1,this.pBindNpcObj.occupation,e.camp):(this.hasTarget(r.Passive_target.selfCar)&&this.addBuffAndAttrToNpc(!0,!1,e,e.camp),this.hasTarget(r.Passive_target.selfHero)&&(e.removeBuffFromAllHero(this.config.buff),e.removeBuffFromAllHero(this.config.buff2)),this.hasTarget(r.Passive_target.selfNpc)&&this.effectToAllNpc(!1,e.camp)))}}else if(this.config.type==r.Passive_Type.buff_all_prof){if(1!=d.default.getInstance().coopHaveSamePassive(this.pBindNpcObj,this.templateId)&&(this.hasTarget(r.Passive_target.selfHero)&&this.effectToAllHero(!1,this.pBindNpcObj.camp),this.hasTarget(r.Passive_target.selfNpc)&&this.effectToAllNpc(!1,this.pBindNpcObj.camp),d.default.getInstance().isCoop())){var t=d.default.getInstance().getCoopCarCamp(this.pBindNpcObj.camp);t&&(this.hasTarget(r.Passive_target.selfHero)&&this.effectToAllHero(!1,t),this.hasTarget(r.Passive_target.selfNpc)&&this.effectToAllNpc(!1,t))}}else if(this.config.type==r.Passive_Type.debuff_enemy){var o=d.default.getInstance().getOpponentsCarCamp(this.pBindNpcObj.camp);(m=d.default.getInstance().getCarByCamp(o))&&m.removeBuffByTemplateId(this.config.buff);var a=d.default.getInstance().getCoopCarByCamp(o);a&&a.removeBuffByTemplateId(this.config.buff),this.hasTarget(r.Passive_target.opponentsHero)&&this.effectToAllHero(!1,o),this.hasTarget(r.Passive_target.opponentsNpc)&&this.effectToAllNpc(!1,this.pBindNpcObj.camp)}else if(this.config.type==r.Passive_Type.extra_maxHp_attr){var n=this.getTargetList();for(var s in n)if(n[s]==r.Passive_target.selfCar){if(this.pBindNpcObj.isCar()){if(d.default.getInstance().isCoop()){var c=d.default.getInstance().getCoopCarByCamp(this.pBindNpcObj.camp);c&&c.modAttr(this.config.attr_type,this.config.attr_value*-this.modAttr)}return this.pBindNpcObj.modAttr(this.config.attr_type,this.config.attr_value*-this.modAttr),void(this.modAttr=0)}var l=d.default.getInstance().getCoopSameHeroPS(this.pBindNpcObj,this.config.kind);if(Number(l)<Number(this.templateId)){var u=d.default.getInstance().getCarByCamp(this.pBindNpcObj.camp);if(u&&(u.removePassiveSkill(this.templateId),d.default.getInstance().isCoop())){var h=d.default.getInstance().getCoopCarByCamp(this.pBindNpcObj.camp);if(h&&h.removePassiveSkill(this.templateId),-1!=l&&(u=2==i.default.matchRoleIdentity?d.default.getInstance().getCarByCamp(1):d.default.getInstance().getCarByCamp(3))){var p=u.addPassiveSkill(l,this.config.kind);cc.director.on("Event_ChangeHp",this.onHpChange,p)}}}}}else if(this.config.type==r.Passive_Type.extra_recv_money)this.pBindNpcObj.removeBuffByTemplateId(this.config.buff);else if(this.config.type==r.Passive_Type.buff_car){if((m=d.default.getInstance().getCarByCamp(this.pBindNpcObj.camp))&&(this.addBuffAndAttrToNpc(!0,!1,m,m.camp),this.hasTarget(r.Passive_target.selfHero)&&this.effectToAllHero(!1,m.camp),d.default.getInstance().isCoop())){var f=d.default.getInstance().getCoopCarByCamp(this.pBindNpcObj.camp);f&&(this.addBuffAndAttrToNpc(!0,!1,f,f.camp),this.hasTarget(r.Passive_target.selfHero)&&this.effectToAllHero(!1,f.camp))}}else if(this.config.type==r.Passive_Type.extra_sliver_attr){if(m=d.default.getInstance().getCarByCamp(this.pBindNpcObj.camp)){var g=d.default.getInstance().getPlayerModelByCamp(this.pBindNpcObj.camp).getCurMoney();this.onMoneyChange(-g,this.pBindNpcObj.camp)}}else if(this.config.type==r.Passive_Type.buff_car_monster){var m;if(1!=d.default.getInstance().coopHaveSamePassive(this.pBindNpcObj,this.templateId)&&(m=d.default.getInstance().getCarByCamp(this.pBindNpcObj.camp))&&(this.addBuffAndAttrToNpc(!0,!1,m,m.camp),this.effectToAllHero(!1,this.pBindNpcObj.camp),this.effectToAllNpc(!1,this.pBindNpcObj.camp),d.default.getInstance().isCoop())){var _=d.default.getInstance().getCoopCarByCamp(this.pBindNpcObj.camp);_&&(this.addBuffAndAttrToNpc(!0,!1,_,_.camp),this.effectToAllHero(!1,_.camp),this.effectToAllNpc(!1,_.camp))}}else if(this.config.type==r.Passive_Type.extra_heroLv_attr||this.config.type==r.Passive_Type.extra_heroStar_attr)this.modAttr>0&&this.pBindNpcObj.modAttr(this.config.attr_type,-this.modAttr);else if(this.config.type==r.Passive_Type.buff_summoned_npc){if(this.effectToAllSummoned(!1,this.pBindNpcObj.camp),d.default.getInstance().isCoop()){var y=d.default.getInstance().getCoopCarByCamp(this.pBindNpcObj.camp);y&&this.effectToAllSummoned(!1,y.camp)}}else if(this.config.type==r.Passive_Type.buff_no_prof){if(this.effectToAllHero(!1,this.pBindNpcObj.camp),this.effectToAllNpc(!1,this.pBindNpcObj.camp),d.default.getInstance().isCoop()){var v=d.default.getInstance().getCoopCarCamp(this.pBindNpcObj.camp);0!=v&&(this.effectToAllHero(!1,v),this.effectToAllNpc(!1,v))}}else if(this.config.type==r.Passive_Type.summoned_live_time){if(this.effectToAllSummoned(!1,this.pBindNpcObj.camp),d.default.getInstance().isCoop()){var C=d.default.getInstance().getCoopCarCamp(this.pBindNpcObj.camp);0!=C&&this.effectToAllSummoned(!1,C)}}else if(this.config.type==r.Passive_Type.panda){if(1!=d.default.getInstance().coopHaveSamePassive(this.pBindNpcObj,this.templateId)&&(this.effectToAllHero(!1,this.pBindNpcObj.camp),d.default.getInstance().isCoop())){var S=d.default.getInstance().getCoopCarCamp(this.pBindNpcObj.camp);0!=S&&this.effectToAllHero(!1,S)}}else if(this.config.type==r.Passive_Type.compare_enemy_carLv){if(!this.isEffecting)return void(this.pBindNpcObj=null);var T=d.default.getInstance().getCarByCamp(this.pBindNpcObj.camp);if(T&&(this.addBuffAndAttrToNpc(!0,!1,T,T.camp),d.default.getInstance().isCoop())){var I=d.default.getInstance().getCoopCarByCamp(this.pBindNpcObj.camp);I&&this.addBuffAndAttrToNpc(!0,!1,I,I.camp)}this.effectToAllHero(!1,this.pBindNpcObj.camp),this.effectToAllNpc(!1,this.pBindNpcObj.camp),d.default.getInstance().isCoop()}else if(this.config.type==r.Passive_Type.behit_add_buff){var N=d.default.getInstance().getCarByCamp(this.pBindNpcObj.camp);if(N&&(this.addBuffAndAttrToNpc(!0,!1,N,N.camp),d.default.getInstance().isCoop())){var b=d.default.getInstance().getCoopCarByCamp(this.pBindNpcObj.camp);b&&this.addBuffAndAttrToNpc(!0,!1,b,b.camp)}}else if(this.config.type==r.Passive_Type.all_same_prof){if(this.isEffecting&&(this.effectToAllHero(!1,this.pBindNpcObj.camp),d.default.getInstance().isCoop())){var w=d.default.getInstance().getCoopCarCamp(this.pBindNpcObj.camp);0!=w&&this.effectToAllHero(!1,w)}}else if(this.config.type==r.Passive_Type.change_spirit)if(!d.default.getInstance().isCoop()||this.pBindNpcObj.camp!=r.PLAYER_CAMP.opponents&&this.pBindNpcObj.camp!=r.PLAYER_CAMP.opponentsCoop){var E=d.default.getInstance().getPvpPlayerByCamp(this.pBindNpcObj.camp);if(d.default.getInstance().isCoop()){E=null;var P=d.default.getInstance().getPlayerModelByCamp(r.PLAYER_CAMP.opponents),R=d.default.getInstance().getPlayerModelByCamp(r.PLAYER_CAMP.opponentsCoop);P&&(P.setChangeSpritPR(0),P.setChangeSpritRS(-1)),R&&(R.setChangeSpritPR(0),R.setChangeSpritRS(-1))}E&&(E.setChangeSpritPR(0),E.setChangeSpritRS(-1))}else{var L=d.default.getInstance().getPlayerModelByCamp(r.PLAYER_CAMP.myPlayer),A=d.default.getInstance().getPlayerModelByCamp(r.PLAYER_CAMP.coopPlayer);L&&(L.setBossChangeSpritPR(0),L.setBossChangeSpritRS(-1)),A&&(A.setBossChangeSpritPR(0),A.setBossChangeSpritRS(-1))}else this.config.type==r.Passive_Type.equip_invalid?this.setEquipInvalid(!1):this.config.type==r.Passive_Type.damage_limit_depend_maxHp?this.pBindNpcObj.setDamageLimitMaxHpPERC(0):this.config.type==r.Passive_Type.extra_enemy_heroNum_attr?this.pBindNpcObj.modAttr(this.config.attr_type,-this.modAttr):this.config.type==r.Passive_Type.whos_your_daddy?this.setWhosyourdaddyState(-1,!0):this.config.type==r.Passive_Type.enemy_num?(this.pBindNpcObj.modAttr(this.config.attr_type,-this.modAttr),this.modAttr=0):this.config.type==r.Passive_Type.change_skill?Number(this.config.extra_condition_value3)&&this.pBindNpcObj.changeSkill(Number(this.config.extra_condition_value3)):this.config.type==r.Passive_Type.buff_self?this.addBuffAndAttrToNpc(!0,!1,this.pBindNpcObj,this.pBindNpcObj.camp):this.config.type==r.Passive_Type.change_drop_box&&this.changeDropBox(!1);this.isEffecting=!1,this.pBindNpcObj=null}}else this.pBindNpcObj=null},t.trigger=function(){0!=this.config.buff&&this.addBuffToNpc2(this.pBindNpcObj)},t.onKillTarget=function(e,t){if(this.isPassiveSkillVaild()){var o=(0,c.getRoleIdentity)(this.pBindNpcObj.camp);if(this.config.type==r.Passive_Type.kill_target&&this.pBindNpcObj.id+o==e)if(42==this.pBindNpcObj.heroTemplateId){var i=d.default.getInstance().getCarByCamp(this.pBindNpcObj.camp);i&&(i.chgHp(this.config.attr_value,this.pBindNpcObj.camp,this.pBindNpcObj.npcType),i.onRefreshHpBar(),i.createPopFont(this.config.attr_value,!0,0,!1))}else{if(this.pBindNpcObj.checkAttrMaxValue(this.config.attr_type,this.config.attr_value))return;console.log("onKillTarget nTargetId:"+t+"attackId:"+e),this.pBindNpcObj.modAttr(this.config.attr_type,this.config.attr_value)}}},t.onNpcDie=function(e){if(this.isPassiveSkillVaild()&&this.config.type==r.Passive_Type.enemy_num){if(!this.checkEffectCondition(!1,e))return;this.checkEnemyNumAddAttr()}},t.onAttackTarget=function(e,t,o,i,a){if(void 0===a&&(a=!1),this.isPassiveSkillVaild())if(this.config.type==r.Passive_Type.attack_target){if(!a)return;if(o!=this.pBindNpcObj.camp||e!=this.pBindNpcObj.heroTemplateId)return;this.addBuffAndAttrToNpc(!0,!0,this.pBindNpcObj,this.pBindNpcObj.camp)}else if(this.config.type==r.Passive_Type.behit_add_buff&&this.checkEffectCondition(!0,o)){if(i)return;var n=d.default.getInstance().getNpcList()[t];if(n&&(n.isCar()||n.isBoss())&&!n.wudi_state)if(n.isCar()){var s=d.default.getInstance().getCarByCamp(o),c=null;s&&(this.addBuffAndAttrToNpc(!0,!0,s,s.camp),d.default.getInstance().isCoop()&&(c=d.default.getInstance().getCoopCarByCamp(o))&&this.addBuffAndAttrToNpc(!0,!0,c,c.camp))}else n.isBoss()&&this.addBuffAndAttrToNpc(!0,!0,n,n.camp)}},t.onAddNpc=function(e,t){if(this.isPassiveSkillVaild())if(this.config.type==r.Passive_Type.buff_prof){if(!this.checkEffectCondition(!0,e))return;if(this.config.extra_condition_type==r.Passive_Condition.probability)return;this.addBuffAndAttrToNpcById(t)}else if(this.config.type==r.Passive_Type.debuff_enemy){if(!this.checkEffectCondition(!1,e))return;1!=this.checkProfCondition()&&this.config.extra_condition_type==r.Passive_Condition.population||this.addBuffAndAttrToNpcById(t,!0)}else if(this.config.type==r.Passive_Type.buff_all_prof){if(!this.checkEffectCondition(!0,e))return;this.addBuffAndAttrToNpcById(t)}else if(this.config.type==r.Passive_Type.buff_car){if(!this.checkEffectCondition(!0,e))return;(s=d.default.getInstance().getNpcList()[t])&&s.isCar()&&this.addBuffAndAttrToNpcById(t,!0)}else if(this.config.type==r.Passive_Type.buff_car_monster){if(!this.checkEffectCondition(!0,e))return;this.addBuffAndAttrToNpcById(t,!0)}else if(1==this.isProfPassive(this.config.type)){if(!this.checkEffectCondition(!0,e))return;var o=d.default.getInstance().getCarByCamp(this.pBindNpcObj.camp);if(o){var i=new Set;if(o.getHeroProfNum(this.pBindNpcObj.occupation,i),d.default.getInstance().isCoop()){var a=d.default.getInstance().getCoopCarByCamp(this.pBindNpcObj.camp);a&&a.getHeroProfNum(this.pBindNpcObj.occupation,i)}if(this.config.extra_condition_type==r.Passive_Condition.population&&this.config.extra_condition_value<=i.size)if(this.config.type==r.Passive_Type.buff_car_population)(s=d.default.getInstance().getNpcList()[t])&&this.addBuffAndAttrToNpcById(t,!0);else if(this.config.type!=r.Passive_Type.buff_summoned&&this.config.type!=r.Passive_Type.buff_ninja){var n=!1;this.hasTarget(r.Passive_target.selfCar)&&(n=!0),this.hasTarget(r.Passive_target.selfNpc)&&this.addBuffAndAttrToNpcById(t,n)}i.clear()}}else if(this.config.type==r.Passive_Type.buff_summoned_npc){if(!this.checkEffectCondition(!0,e))return;(s=d.default.getInstance().getNpcList()[t])&&s.isSummoned()&&this.addBuffAndAttrToNpcById(t)}else if(this.config.type==r.Passive_Type.buff_no_prof){if(!this.checkEffectCondition(!0,e))return;!0===this.isEffecting&&this.addBuffAndAttrToNpcById(t)}else if(this.config.type==r.Passive_Type.summoned_live_time){if(!this.checkEffectCondition(!0,e))return;if(!this.checkProfCondition())return;(s=d.default.getInstance().getNpcList()[t])&&s.isSummoned()&&this.addSummonedSustainTime(!0,s)}else if(this.config.type==r.Passive_Type.summoned_extra_attr){if(!this.checkEffectCondition(!0,e))return;var s;!(s=d.default.getInstance().getNpcList()[t])||517!=s.templateId&&515!=s.templateId&&505!=s.templateId&&30117!=s.templateId||this.addSummonedAttr(!0,s)}else if(this.config.type==r.Passive_Type.compare_enemy_carLv){if(!this.checkEffectCondition(!0,e))return;this.isEffecting&&this.addBuffAndAttrToNpcById(t,!0)}else if(this.config.type==r.Passive_Type.enemy_num){if(!this.checkEffectCondition(!1,e))return;this.checkEnemyNumAddAttr()}},t.addAttrToNpcById=function(e,t){void 0===t&&(t=!1);var o=d.default.getInstance().getNpcList()[e];if(o){if(o.isCar()&&!t)return;var i=this.config.attr_value;this.config.type==r.Passive_Type.buff_car_monster&&this.config.extra_condition_type==r.Passive_Condition.haveOCC&&(i=this.modAttr),(this.hasTarget(r.Passive_target.opponentsNpc)||o.isCar()&&this.hasTarget(r.Passive_target.opponentsNpc))&&o.modAttr(this.config.attr_type,i)}},t.addBuffAndAttrToNpcById=function(e,t){void 0===t&&(t=!1),0==this.config.buff&&0==this.config.buff2||this.addBuffToNpcById(e),0!=this.config.attr_value&&this.addAttrToNpcById(e,t)},t.checkEffectCondition=function(e,t){if(e){if(t!=this.pBindNpcObj.camp&&!d.default.getInstance().isCoopPartner(t,this.pBindNpcObj.camp))return!1}else{if(t==this.pBindNpcObj.camp)return!1;if(t!=this.pBindNpcObj.camp&&d.default.getInstance().isCoopPartner(this.pBindNpcObj.camp,t))return!1}return!0},t.effectToAllHero=function(e,t){if(d.default.getInstance().gameState!=r.Game_State.Reconnect){var o=this.config.attr_value;this.config.type==r.Passive_Type.buff_car_monster&&this.config.extra_condition_type==r.Passive_Condition.haveOCC&&(o=this.modAttr);var i=d.default.getInstance().getCarByCamp(t);i&&(e?(i.addBuffToAllHero(this.config.buff),i.addBuffToAllHero(this.config.buff2),i.modAttrToAllHero(this.config.attr_type,o)):(i.removeBuffFromAllHero(this.config.buff),i.removeBuffFromAllHero(this.config.buff2),i.modAttrToAllHero(this.config.attr_type,-o)))}},t.effectToSameOccupation=function(e,t,o){if(d.default.getInstance().gameState!=r.Game_State.Reconnect){var i=d.default.getInstance().getCarByCamp(o);i&&(e?(i.addBuffToTargetProfHero(t,this.config.buff),i.addBuffToTargetProfHero(t,this.config.buff2),i.modAttrToTargetProfHero(t,this.config.attr_type,this.config.attr_value)):(i.removeBuffFromTargetProfHero(t,this.config.buff),i.removeBuffFromTargetProfHero(t,this.config.buff2),i.modAttrToTargetProfHero(t,this.config.attr_type,-this.config.attr_value)))}},t.effectToSpecialOCC=function(e,t){if(d.default.getInstance().gameState!=r.Game_State.Reconnect&&""!=this.config.extra_condition_value3){var o=this.config.extra_condition_value3.split("#");for(var i in o){var a=Number(o[i]);0!=a&&this.effectToSameOccupation(e,a,t)}}},t.effectToHero=function(e,t,o,i){var a=d.default.getInstance().getCarByCamp(i);if(a){var n=a.getHeroObjById(t);if(n&&(e&&n.occupation==this.pBindNpcObj.occupation||!e)){this.addBuffToNpc(null,!0,n,null);var s=this.config.attr_value;this.config.type==r.Passive_Type.buff_car_monster&&this.config.extra_condition_type==r.Passive_Condition.haveOCC&&(s=this.modAttr),n.modAttr(this.config.attr_type,s)}}},t.effectToDoubleHero=function(e,t){var o=0,i=null,a=null,n=null,r=null,s=d.default.getInstance().getOpponentsCarCamp(t);d.default.getInstance().isSkyCastle()?(n=d.default.getInstance().getCoopCarByCamp(t),i=d.default.getInstance().getCarByCamp(s),a=d.default.getInstance().getCoopCarByCamp(s),d.default.getInstance().isCoopPartner(t,this.pBindNpcObj.camp)&&n&&(s=n.camp)):d.default.getInstance().isCoop()?(n=d.default.getInstance().getCoopCarByCamp(t))&&(s=n.camp):d.default.getInstance().isPvP()&&(n=d.default.getInstance().getCarByCamp(s)),d.default.getInstance().isSkyCastle()&&(i&&i.getHeroObjById(e)&&o++,a&&a.getHeroObjById(e)&&o++),n&&n.getHeroObjById(e)&&o++,(r=d.default.getInstance().getCarByCamp(t))&&r.getHeroObjById(e)&&o++,e==this.pBindNpcObj.heroTemplateId&&(o=2);var c=t==this.pBindNpcObj.camp?t:s;if(o>=2){if(this.effectToHero(!1,e,!0,c),d.default.getInstance().isCoop()){var l=d.default.getInstance().getCoopCarCamp(c);this.effectToHero(!1,e,!0,l)}}else{var u=d.default.getInstance().getCarByCamp(c);if(u){var h=u.getHeroObjById(e);h&&(h.removeBuffByTemplateId(this.config.buff),h.removeBuffByTemplateId(this.config.buff2))}if(d.default.getInstance().isCoop()){var p=d.default.getInstance().getCoopCarByCamp(c);if(p){var f=p.getHeroObjById(e);f&&(f.removeBuffByTemplateId(this.config.buff),f.removeBuffByTemplateId(this.config.buff2))}}}},t.effectToALLDoubleHero=function(){var e=d.default.getInstance().getCarByCamp(this.pBindNpcObj.camp);if(e)for(var t in e.heroList){var o=e.heroList[t];o&&this.effectToDoubleHero(o.id,this.pBindNpcObj.camp)}},t.onAddHero=function(e,t){if(this.isPassiveSkillVaild())if(this.config.type==r.Passive_Type.buff_prof){if(!this.checkEffectCondition(!0,e))return;if(this.config.extra_condition_type==r.Passive_Condition.probability)return;this.effectToHero(!0,t,!0,e)}else if(this.config.type==r.Passive_Type.buff_all_prof||this.config.type==r.Passive_Type.buff_car_monster){if(!this.checkEffectCondition(!0,e))return;this.effectToHero(!1,t,!0,e)}else if(this.config.type==r.Passive_Type.debuff_enemy){if(!this.checkEffectCondition(!1,e))return;if(!this.hasTarget(r.Passive_target.opponentsHero))return;this.config.extra_condition_type!=r.Passive_Condition.population&&this.effectToHero(!1,t,!1,e)}else if(this.config.type==r.Passive_Type.buff_car){if(!this.checkEffectCondition(!0,e))return;this.effectToHero(!1,t,!0,e)}else if(this.config.type==r.Passive_Type.compare_enemy_carLv){if(!this.checkEffectCondition(!0,e))return;this.isEffecting&&this.effectToHero(!1,t,!0,e)}},t.onMaxHpChange=function(e,t){if(this.isPassiveSkillVaild()&&this.checkEffectCondition(!0,t)&&this.config.type==r.Passive_Type.extra_maxHp_damage&&e==r.NPC_TYPE.Car&&d.default.getInstance().getCarByCamp(t)){var o=this.pBindNpcObj.getPassiveDamage();o!=this.modAttr&&(this.pBindNpcObj.modAttr(r.Npc_Attr_Type.attack,-1*this.modAttr),this.modAttr=o,this.pBindNpcObj.modAttr(r.Npc_Attr_Type.attack,this.modAttr))}},t.onHpChange=function(e,t,o){if(this&&this.isPassiveSkillVaild()&&this.config.type==r.Passive_Type.extra_maxHp_attr&&this.checkEffectCondition(!0,t))if(e==r.NPC_TYPE.Car){var i=d.default.getInstance().getCarByCamp(t),a=null;if(i){var n=Math.floor(100-100*i.tmpHp/i.getMaxHp());if(d.default.getInstance().isCoop()&&(a=d.default.getInstance().getCoopCarByCamp(t))&&(n=Math.floor(100-100*(i.tmpHp+a.tmpHp)/(i.getMaxHp()+a.getMaxHp()))),n!=this.modAttr)if(this.pBindNpcObj.isCar()){var s=n-this.modAttr;this.modAttr=n,i.modAttr(this.config.attr_type,this.config.attr_value*s),a&&a.modAttr(this.config.attr_type,this.config.attr_value*s)}else{var c=n-this.modAttr;this.modAttr=n,this.pBindNpcObj.modAttr(this.config.attr_type,this.config.attr_value*c)}}}else if(e==r.NPC_TYPE.Boss&&this.pBindNpcObj&&this.pBindNpcObj.id==o){var l=Math.floor(100-100*this.pBindNpcObj.tmpHp/this.pBindNpcObj.getMaxHp());if(l!=this.modAttr){var u=l-this.modAttr;this.modAttr=l,this.pBindNpcObj.modAttr(this.config.attr_type,this.config.attr_value*u)}}},t.onEventPR=function(e,t){if(this.isPassiveSkillVaild()){var o=(0,c.getRoleIdentity)(this.pBindNpcObj.camp);if(this.checkEffectCondition(!0,e)&&this.config.type==r.Passive_Type.buff_prof&&this.pBindNpcObj.id+o==t){var i=d.default.getInstance().getCarByCamp(e);if(i){if(this.effectToSameOccupation(!0,this.pBindNpcObj.occupation,i.camp),d.default.getInstance().isCoop()){var a=d.default.getInstance().getCoopCarByCamp(e);a&&this.effectToSameOccupation(!0,this.pBindNpcObj.occupation,a.camp)}}else this.pBindNpcObj&&this.pBindNpcObj.isBoss()&&this.addBuffToNpc(!0,!0,this.pBindNpcObj,this.pBindNpcObj.getCamp())}}},t.getTriggerCritDebufType=function(){return this.config&&this.config.type==r.Passive_Type.debuff_crit?this.config.debuf_type:-1},t.getDamagePlus=function(){if(!this.config)return 0;if(this.config.type==r.Passive_Type.extra_maxHp_damage){var e=d.default.getInstance().getCarByCamp(this.pBindNpcObj.camp);if(e){if(d.default.getInstance().isCoop()){var t=d.default.getInstance().getCoopCarByCamp(this.pBindNpcObj.camp);if(t)return(e.getMaxHp()+t.getMaxHp())*this.config.attr_value*.001}return e.getMaxHp()*this.config.attr_value*.001}}return 0},t.getKillRewardPlus=function(e){if(!this.config)return 0;if(!this.pBindNpcObj)return 0;var t=d.default.getInstance().getPlayerModelByCamp(this.pBindNpcObj.camp);return t&&t.getSliverInvalidState()?0:this.config.type==r.Passive_Type.extra_kill_money?this.config.extra_condition_type==r.Passive_Condition.percentMoney?this.config.extra_condition_value*e/r.AttrParam:this.config.attr_value:0},t.onMoneyChange=function(e,t,o){if(void 0===o&&(o=a.SP_CHANGE_TYPE.SP_CHANGE_TYPE_INIT),this.isPassiveSkillVaild())if(this.config.type==r.Passive_Type.extra_sliver_attr)t==this.pBindNpcObj.camp&&this.pBindNpcObj.modAttr(this.config.attr_type,e*this.config.attr_value);else if(this.config.type==r.Passive_Type.charge_interest){if(o==a.SP_CHANGE_TYPE.SP_CHANGE_TYPE_ADD_OBLATION)return;if(t!=this.pBindNpcObj.camp&&e>0){var i=e*this.config.attr_value*.01;if(d.default.getInstance().isSkyCastle()){if(d.default.getInstance().isCoopPartner(t,this.pBindNpcObj.camp))return;i*=.5}d.default.getInstance().getPlayerModelByCamp(this.pBindNpcObj.camp).addMoney(i,a.SP_CHANGE_TYPE.SP_CHANGE_TYPE_ADD_OBLATION)}}},t.onKillAddMoney=function(){this.isPassiveSkillVaild()},t.getSellMoreMoney=function(e,t){return this.config&&this.config.type==r.Passive_Type.sell_more_money?this.config.attr_value*e*t:0},t.getDamageMultiple=function(e){return this.config?this.config.type==r.Passive_Type.superpose_damage?Math.pow(.01*this.config.attr_value,e):this.config.type==r.Passive_Type.superpose_damage_prof?Math.pow(.01*this.modAttr,e):0:0},t.onSellHero=function(){this.isPassiveSkillVaild()&&this.config.type==r.Passive_Type.sell_card_add_attr&&(this.addBuffToNpc(null,!0,this.pBindNpcObj,null),this.pBindNpcObj.modAttr(this.config.attr_type,this.config.attr_value))},t.onChangeHero=function(e,t){if(this.isPassiveSkillVaild())if(this.config.type!=r.Passive_Type.debuff_enemy){if(this.config.type==r.Passive_Type.panda)this.effectToDoubleHero(t,e);else if(this.config.type==r.Passive_Type.extra_enemy_heroNum_attr){var o=this.countHeroTotal(!1,r.HERO_TOTAL_TYPE.NUM),i=0;this.pBindNpcObj.isBoss()?(i=Math.pow(this.config.attr_value,o)-1,this.config.attr_type==r.Npc_Attr_Type.attack_inc&&(i*=1e3)):i=this.config.attr_value*o,i!=this.modAttr&&(this.pBindNpcObj.modAttr(this.config.attr_type,i-this.modAttr),this.modAttr=i)}else this.config.type==r.Passive_Type.enemy_profNum_add_damage?this.checkEnemyHeroProfNum(e):this.config.type==r.Passive_Type.enemy_population_add_damage&&this.checkEnemyPopulationNum(e);if(this.checkEffectCondition(!0,e))if(1==this.isProfPassive(this.config.type)){if(C=d.default.getInstance().getCarByCamp(this.pBindNpcObj.camp)){var a=new Set;if(C.getHeroProfNum(this.pBindNpcObj.occupation,a),d.default.getInstance().isCoop()){var n=d.default.getInstance().getCoopCarByCamp(this.pBindNpcObj.camp);n&&(n.getHeroProfNum(this.pBindNpcObj.occupation,a),this.config.extra_condition_type==r.Passive_Condition.population&&this.config.extra_condition_value<=a.size?this.config.type==r.Passive_Type.buff_car_population?(this.addBuffAndAttrToNpc(!0,!0,n,n.camp),this.effectToAllNpc(!0,n.camp)):this.config.type==r.Passive_Type.buff_summoned||this.config.type==r.Passive_Type.buff_ninja?this.effectToSameOccupation(!0,this.pBindNpcObj.occupation,n.camp):(this.hasTarget(r.Passive_target.selfCar)&&this.addBuffAndAttrToNpc(!0,!0,n,n.camp),this.hasTarget(r.Passive_target.selfHero)&&(n.addBuffToAllHero(this.config.buff),n.addBuffToAllHero(this.config.buff2)),this.hasTarget(r.Passive_target.selfNpc)&&this.effectToAllNpc(!0,n.camp)):this.config.extra_condition_type==r.Passive_Condition.population&&this.config.extra_condition_value>a.size&&(this.config.type==r.Passive_Type.buff_car_population?(this.addBuffAndAttrToNpc(!0,!1,n,n.camp),this.effectToAllNpc(!1,n.camp)):this.config.type==r.Passive_Type.buff_summoned||this.config.type==r.Passive_Type.buff_ninja?this.effectToSameOccupation(!1,this.pBindNpcObj.occupation,n.camp):(this.hasTarget(r.Passive_target.selfCar)&&this.addBuffAndAttrToNpc(!0,!1,n,n.camp),this.hasTarget(r.Passive_target.selfHero)&&(n.removeBuffFromAllHero(this.config.buff),n.removeBuffFromAllHero(this.config.buff2)),this.hasTarget(r.Passive_target.selfNpc)&&this.effectToAllNpc(!1,n.camp))))}this.config.extra_condition_type==r.Passive_Condition.population&&this.config.extra_condition_value<=a.size?this.config.type==r.Passive_Type.buff_car_population?(this.addBuffAndAttrToNpc(!0,!0,C,C.camp),this.effectToAllNpc(!0,C.camp)):this.config.type==r.Passive_Type.buff_summoned||this.config.type==r.Passive_Type.buff_ninja?this.effectToSameOccupation(!0,this.pBindNpcObj.occupation,C.camp):(this.hasTarget(r.Passive_target.selfCar)&&this.addBuffAndAttrToNpc(!0,!0,C,C.camp),this.hasTarget(r.Passive_target.selfHero)&&(C.addBuffToAllHero(this.config.buff),C.addBuffToAllHero(this.config.buff2)),this.hasTarget(r.Passive_target.selfNpc)&&this.effectToAllNpc(!0,C.camp)):this.config.extra_condition_type==r.Passive_Condition.population&&this.config.extra_condition_value>a.size&&(this.config.type==r.Passive_Type.buff_car_population?(this.addBuffAndAttrToNpc(!0,!1,C,C.camp),this.effectToAllNpc(!1,C.camp)):this.config.type==r.Passive_Type.buff_summoned||this.config.type==r.Passive_Type.buff_ninja?this.effectToSameOccupation(!1,this.pBindNpcObj.occupation,C.camp):(this.hasTarget(r.Passive_target.selfCar)&&this.addBuffAndAttrToNpc(!0,!1,C,C.camp),this.hasTarget(r.Passive_target.selfHero)&&(C.removeBuffFromAllHero(this.config.buff),C.removeBuffFromAllHero(this.config.buff2)),this.hasTarget(r.Passive_target.selfNpc)&&this.effectToAllNpc(!1,C.camp)))}}else if(this.config.type==r.Passive_Type.extra_heroLv_attr||this.config.type==r.Passive_Type.extra_heroStar_attr){this.modAttr>0&&this.pBindNpcObj.modAttr(this.config.attr_type,-this.modAttr);var s=0;this.config.type==r.Passive_Type.extra_heroLv_attr?s=this.countHeroTotal(!0,r.HERO_TOTAL_TYPE.NUM):this.config.type==r.Passive_Type.extra_heroStar_attr&&(s=this.countHeroTotal(!0,r.HERO_TOTAL_TYPE.STAR)),s>0?(this.modAttr=this.config.attr_value*s,this.modAttr>0&&this.pBindNpcObj.modAttr(this.config.attr_type,this.modAttr)):this.modAttr=0}else if(this.config.type==r.Passive_Type.buff_no_prof){if(!1===this.checkProfPassiveSkill()){if(this.effectToAllHero(!0,this.pBindNpcObj.camp),this.effectToAllNpc(!0,this.pBindNpcObj.camp),d.default.getInstance().isCoop()){var c=d.default.getInstance().getCoopCarCamp(this.pBindNpcObj.camp);0!=c&&(this.effectToAllHero(!0,c),this.effectToAllNpc(!0,c))}}else if(this.effectToAllHero(!1,this.pBindNpcObj.camp),this.effectToAllNpc(!1,this.pBindNpcObj.camp),d.default.getInstance().isCoop()){var l=d.default.getInstance().getCoopCarCamp(this.pBindNpcObj.camp);0!=l&&(this.effectToAllHero(!1,l),this.effectToAllNpc(!1,l))}}else if(this.config.type==r.Passive_Type.summoned_live_time){if(!this.checkEffectCondition(!0,e))return;if(this.effectToAllSummoned(this.checkProfCondition(),this.pBindNpcObj.camp),d.default.getInstance().isCoop()){var u=d.default.getInstance().getCoopCarCamp(this.pBindNpcObj.camp);0!=u&&this.effectToAllSummoned(this.checkProfCondition(),u)}}else if(this.config.type==r.Passive_Type.superpose_damage_prof){var h=this.countSameProfNum();this.modAttr=r.AttrParam+h*this.config.attr_value}else if(this.config.type==r.Passive_Type.change_skill)this.checkExtraCondition()&&0!=this.config.extra_condition_value2&&this.pBindNpcObj.changeSkill(this.config.extra_condition_value2);else if(this.config.type==r.Passive_Type.all_same_prof){var p;if(this.isEffecting&&this.effectToHero(!1,t,!0,e),p=this.checkExtraCondition(),!this.isEffecting&&!p||this.isEffecting&&p)return;if(this.isEffecting=p,this.effectToAllHero(p,this.pBindNpcObj.camp),d.default.getInstance().isCoop()){var f=d.default.getInstance().getCoopCarCamp(this.pBindNpcObj.camp);0!=f&&this.effectToAllHero(p,f)}}else if(this.config.type==r.Passive_Type.buff_prof){var g=d.default.getInstance().getCarByCamp(this.pBindNpcObj.camp);if(g&&(this.config.extra_condition_type==r.Passive_Condition.specialOCC?this.effectToSpecialOCC(!0,g.camp):this.effectToSameOccupation(!0,this.pBindNpcObj.occupation,g.camp),d.default.getInstance().isCoop())){var m=d.default.getInstance().getCoopCarByCamp(this.pBindNpcObj.camp);m&&(this.config.extra_condition_type==r.Passive_Condition.specialOCC?this.effectToSpecialOCC(!0,m.camp):this.effectToSameOccupation(!0,this.pBindNpcObj.occupation,m.camp))}}else if(this.config.type==r.Passive_Type.buff_car_monster&&this.config.extra_condition_type==r.Passive_Condition.haveOCC){var _=this.countSameProfNum()*this.config.attr_value;if(this.modAttr!=_){var y=null;d.default.getInstance().isCoop()&&(y=d.default.getInstance().getCoopCarByCamp(this.pBindNpcObj.camp)),(C=d.default.getInstance().getCarByCamp(this.pBindNpcObj.camp))&&(this.addBuffAndAttrToNpc(!0,!1,C,C.camp),this.effectToAllHero(!1,this.pBindNpcObj.camp),this.effectToAllNpc(!1,this.pBindNpcObj.camp),y&&(this.addBuffAndAttrToNpc(!0,!1,y,y.camp),this.effectToAllHero(!1,y.camp),this.effectToAllNpc(!1,y.camp))),this.modAttr=_,C&&(this.addBuffAndAttrToNpc(!0,!0,C,C.camp),this.effectToAllHero(!0,this.pBindNpcObj.camp),this.effectToAllNpc(!0,this.pBindNpcObj.camp),y&&(this.addBuffAndAttrToNpc(!0,!0,y,y.camp),this.effectToAllHero(!0,y.camp),this.effectToAllNpc(!0,y.camp)))}}}else{if(this.config.extra_condition_type!=r.Passive_Condition.population)return;var v=d.default.getInstance().getOpponentsCarCamp(this.pBindNpcObj.camp);if(v){var C;(C=d.default.getInstance().getCarByCamp(v))&&this.addBuffAndAttrToNpc(!1,this.checkProfCondition(),C,v);var S=d.default.getInstance().getCoopCarByCamp(v);S&&this.addBuffAndAttrToNpc(!1,this.checkProfCondition(),S,S.camp),this.hasTarget(r.Passive_target.opponentsNpc)&&this.effectToAllNpc(this.checkProfCondition(),this.pBindNpcObj.camp)}}},t.onCastSpirit=function(e,t){this.isPassiveSkillVaild()&&t==this.pBindNpcObj.camp&&(this.summonSpirit(e),this.summonNpc())},t.summonSpirit=function(e){if(this.config&&this.config.type==r.Passive_Type.summon_spirit){console.log("onSummonSpirit:",e);var t=Math.floor(100*Math.random())+1;if(Number(this.config.extra_condition_value)>=t){var o=.5;e!=r.Enum_Elf_Card.muElf&&e!=r.Enum_Elf_Card.moElf||(o=1);var i=d.default.getInstance().getController();i&&i.onScheduleOnce(e,this.pBindNpcObj.getCamp(),o)}}},t.summonNpc=function(){if(this.config&&this.config.type==r.Passive_Type.summon_npc){var e=Math.floor(100*Math.random())+1;if(Number(this.config.extra_condition_value)>=e){var t=d.default.getInstance().getPlayerModelByCamp(this.pBindNpcObj.getCamp());if(t){var o=t.getHeroSummonId(this.pBindNpcObj.getCamp(),this.pBindNpcObj.heroTemplateId);d.default.getInstance().summon(this.config.extra_condition_value2,this.pBindNpcObj.getLevel(),this.pBindNpcObj.getCamp(),50,0,!0,this.pBindNpcObj.starAttParam,this.pBindNpcObj.starHpParam,o);var i=d.default.getInstance().getNpcById(o);i&&i.setTheSummonerInfo(this.pBindNpcObj.heroTemplateId,this.pBindNpcObj.isHero(),(0,c.getRoleIdentity)(this.pBindNpcObj.getCamp())),this.pBindNpcObj.summonMonsterCount++,t.sendCastSkillToServer(2,this.templateId,[],[this.pBindNpcObj.heroTemplateId,0,this.config.extra_condition_value2])}}}},t.onCarLvUp=function(){if(this.isPassiveSkillVaild()&&this.config.type==r.Passive_Type.compare_enemy_carLv){var e=d.default.getInstance().getPlayerModelByCamp(this.pBindNpcObj.camp),t=0;if(e&&(t=e.getMaxHeroNum(),d.default.getInstance().isCoop())){var o=d.default.getInstance().getCoopCarCamp(this.pBindNpcObj.camp),i=d.default.getInstance().getPlayerModelByCamp(o);i&&(t+=i.getMaxHeroNum())}var a=d.default.getInstance().getOpponentsCarCamp(this.pBindNpcObj.camp),n=d.default.getInstance().getPlayerModelByCamp(a),s=0;n&&(s=n.getMaxHeroNum());var c=t-s,l=this.config.extra_condition_type,u=this.config.extra_condition_value;if(l&&l==r.Passive_Condition.moreCarLv){var h=c>=u;if(!this.isEffecting&&!h||this.isEffecting&&h)return;this.isEffecting=h;var p=d.default.getInstance().getCarByCamp(this.pBindNpcObj.camp);if(p&&(this.addBuffAndAttrToNpc(!0,h,p,p.camp),d.default.getInstance().isCoop())){var f=d.default.getInstance().getCoopCarByCamp(this.pBindNpcObj.camp);f&&this.addBuffAndAttrToNpc(!0,h,f,f.camp)}this.effectToAllHero(h,this.pBindNpcObj.camp),this.effectToAllNpc(h,this.pBindNpcObj.camp)}}},t.getTargetHPDamagePlus=function(e){if(!this.config)return 0;if(e&&this.config.type==r.Passive_Type.extra_curHp_attr){if(this.modAttr=Math.floor(100-100*e.hp/e.getMaxHp()),d.default.getInstance().isCoop()&&this.pBindNpcObj.isBoss()&&e.isCar()){var t=d.default.getInstance().getCoopCarByCamp(e.camp);t&&(this.modAttr=Math.floor(100-100*(e.hp+t.hp)/(e.getMaxHp()+t.getMaxHp())))}return this.modAttr>100&&(this.modAttr=100),Math.floor(this.pBindNpcObj.getAttack()*this.config.attr_value*this.modAttr/1e3)}return 0},t.getTargetHPExtraDamage=function(e){if(!this.config)return 0;if(e&&this.config.type==r.Passive_Type.extra_maxHp_attack){if(this.modAttr=e.getMaxHp(),d.default.getInstance().isCoop()&&this.pBindNpcObj&&this.pBindNpcObj.isBoss()&&e.isCar()){var t=d.default.getInstance().getCoopCarByCamp(e.camp);t&&(this.modAttr=this.modAttr+t.getMaxHp())}return this.config.attr_value*this.modAttr/100}if(e&&this.config.type==r.Passive_Type.extra_curHp_attack){if(this.modAttr=e.tmpHp,d.default.getInstance().isCoop()&&this.pBindNpcObj&&this.pBindNpcObj.isBoss()&&e.isCar()){var o=d.default.getInstance().getCoopCarByCamp(e.camp);o&&(this.modAttr=this.modAttr+o.tmpHp)}return this.config.attr_value*this.modAttr/100}return 0},t.getHealPercent=function(e){if(!this.config)return 0;if(this.config.type==r.Passive_Type.extra_hp){if(this.modAttr=e.getMaxHp(),d.default.getInstance().isCoop()){var t=d.default.getInstance().getCoopCarByCamp(e.camp);t&&(this.modAttr=this.modAttr+t.getMaxHp())}return this.config.attr_value*this.modAttr/1e3}return 0},t.getAllSameProfValue=function(){return this.config&&this.config.type==r.Passive_Type.all_same_prof&&this.isEffecting?this.config.extra_condition_value2:0},t.getEventPR=function(){return this.config&&this.config.extra_condition_type==r.Passive_Condition.probability?this.config.extra_condition_value:0},t.getProfMinusNum=function(){return this.config&&this.config.type==r.Passive_Type.prof_num_minus&&this.config.extra_condition_type==r.Passive_Condition.profNumMinus?this.config.extra_condition_value:0},t.addBuffToNpc=function(e,t,o){d.default.getInstance().gameState!=r.Game_State.Reconnect&&(t?(o.addBuff(this.config.buff,this.pBindNpcObj),o.addBuff(this.config.buff2,this.pBindNpcObj)):(o.removeBuffByTemplateId(this.config.buff),o.removeBuffByTemplateId(this.config.buff2)))},t.addBuffToNpc2=function(e){d.default.getInstance().gameState!=r.Game_State.Reconnect&&e.addBuff(this.config.buff,this.pBindNpcObj)},t.addBuffToNpcById=function(e){if(d.default.getInstance().gameState!=r.Game_State.Reconnect){var t=d.default.getInstance().getNpcList()[e];t&&(this.hasTarget(r.Passive_target.opponentsNpc)||t.isCar()&&this.hasTarget(r.Passive_target.opponentsNpc))&&(t.addBuff(this.config.buff,this.pBindNpcObj),t.addBuff(this.config.buff2,this.pBindNpcObj))}},t.addAttrToNpc=function(e,t,o){if(t){var i=this.config.attr_value;this.config.type==r.Passive_Type.buff_car_monster&&this.config.extra_condition_type==r.Passive_Condition.haveOCC&&(i=this.modAttr),o.modAttr(this.config.attr_type,i)}else{var a=this.config.attr_value;this.config.attr_type==r.Npc_Attr_Type.maxHp&&o.hp<Math.abs(this.config.attr_value)&&(a=o.hp+100),this.config.type==r.Passive_Type.buff_car_monster&&this.config.extra_condition_type==r.Passive_Condition.haveOCC&&(a=this.modAttr),o.modAttr(this.config.attr_type,-a)}},t.addBuffAndAttrToNpc=function(e,t,o,i){0==this.config.buff&&0==this.config.buff2||this.addBuffToNpc(e,t,o,i),0!=this.config.attr_value&&this.addAttrToNpc(e,t,o,i)},t.effectToAllNpc=function(e,t){var o=d.default.getInstance().getNpcList();for(var i in o){var a=o[i];if(a&&!a.isDead()&&(a.isNpc()||a.isSummoned()))switch(this.config.type){case r.Passive_Type.buff_all_prof:case r.Passive_Type.buff_soldier:case r.Passive_Type.buff_hunter:case r.Passive_Type.buff_Mage:case r.Passive_Type.buff_prisst:case r.Passive_Type.buff_summoned:case r.Passive_Type.buff_no_prof:case r.Passive_Type.compare_enemy_carLv:case r.Passive_Type.buff_car_population:if(!this.checkEffectCondition(!0,a.camp))continue;this.addBuffAndAttrToNpc(!0,e,a,t);break;case r.Passive_Type.debuff_enemy:if(!this.checkEffectCondition(!1,a.camp))continue;this.addBuffAndAttrToNpc(!1,e,a,t);break;case r.Passive_Type.buff_car_monster:if(!this.checkEffectCondition(!0,a.camp))continue;this.addBuffAndAttrToNpc(!0,e,a,t)}}},t.effectToAllSummoned=function(e,t){var o=d.default.getInstance().getNpcList();for(var i in o){var a=o[i];a&&a.camp==t&&0==a.isDead()&&a.isSummoned()&&(this.config.type==r.Passive_Type.summoned_live_time?this.addSummonedSustainTime(e,a):this.addBuffAndAttrToNpc(!0,e,a,t))}},t.isProfPassive=function(e){return e==r.Passive_Type.buff_soldier||e==r.Passive_Type.buff_hunter||e==r.Passive_Type.buff_Mage||e==r.Passive_Type.buff_prisst||e==r.Passive_Type.buff_summoned||e==r.Passive_Type.buff_ninja||e==r.Passive_Type.buff_car_population},t.checkProfPassiveSkill=function(){var e=this,t=[],o=d.default.getInstance().getCarByCamp(this.pBindNpcObj.camp);if(o)for(var i in o.heroList){var a=o.heroList[i];a&&t.push(a)}if(d.default.getInstance().isCoop()){var s=d.default.getInstance().getCoopCarByCamp(this.pBindNpcObj.camp);if(s)for(var c in s.heroList){var l=s.heroList[c];l&&t.push(l)}}for(var u=function(t,o,i){var a=n.default.getInstance().getPassiveSkillConfig(o);if(!a)return!1;if(!e.isProfPassive(a.type)&&a.type!=r.Passive_Type.panda)return!1;for(var s=new Set,c=0;c<t.length;c++){i.occupation==t[c].occupation&&s.add(t[c].heroTemplateId);for(var l=t[c].getProfMinusNum();l>0;)s.add(9990+l),l--}var d=a.extra_condition_type,u=a.extra_condition_value;return!(d&&1==d&&s.size<u)},h=!1,p=0;p<t.length;p++){for(var f in t[p].pPassiveSkillObjList)if(t[p].pPassiveSkillObjList[f]&&1==u.call(this,t,f,t[p])){h=!0;break}if(1==h)break;if(t[p].maxPassiveSkillObjList)for(var g in t[p].maxPassiveSkillObjList)if(t[p].maxPassiveSkillObjList[g]){var m=t[p].maxPassiveSkillObjList[g].templateId;if(1==u.call(this,t,m,t[p])){h=!0;break}}}return 1==h?(this.isEffecting=!1,!0):(this.isEffecting=!0,!1)},t.checkProfCondition=function(){if(this.config.extra_condition_type!=r.Passive_Condition.population)return!1;var e=d.default.getInstance().getCarByCamp(this.pBindNpcObj.camp);if(e){var t=new Set;if(e.getHeroProfNum(this.pBindNpcObj.occupation,t),d.default.getInstance().isCoop()){var o=d.default.getInstance().getCoopCarByCamp(this.pBindNpcObj.camp);o&&o.getHeroProfNum(this.pBindNpcObj.occupation,t)}if(this.config.extra_condition_value<=t.size)return!0;if(this.config.extra_condition_value>t.size)return!1}return!1},t.checkProfConditionAll=function(){if(1!=this.config.extra_condition_type)return!1;var e=d.default.getInstance().getCarByCamp(this.pBindNpcObj.camp);if(e){var t=new Set;if(e.getHeroProfNum(this.pBindNpcObj.occupation,t),d.default.getInstance().isCoop()){var o=d.default.getInstance().getCoopCarByCamp(this.pBindNpcObj.camp);o&&o.getHeroProfNum(this.pBindNpcObj.occupation,t)}else if(d.default.getInstance().isPvP()){var i=d.default.getInstance().getOpponentsCarCamp(this.pBindNpcObj.camp),a=d.default.getInstance().getCarByCamp(i);a&&a.getHeroProfNum(this.pBindNpcObj.occupation,t)}if(this.config.extra_condition_value<=t.size)return!0;if(this.config.extra_condition_value>t.size)return!1}return!1},t.addSummonedSustainTime=function(e,t){e&&(t.summonedSustainTime-=r.SummonedSustainTime*this.config.attr_value/100)},t.addSummonedAttr=function(e,t){e&&t.modAttr(this.config.attr_type,this.config.attr_value*this.pBindNpcObj.summonMonsterCount)},t.checkEffectTarget=function(){var e=d.default.getInstance().getCarByCamp(this.pBindNpcObj.camp),t=null,o=this.getTargetList();for(var a in o)if(o[a]==r.Passive_target.selfCar){if(this.pBindNpcObj.isCar()){d.default.getInstance().isCoop()&&(t=d.default.getInstance().getCoopCarByCamp(this.pBindNpcObj.camp)),e&&(this.modAttr=Math.floor(100-100*e.tmpHp/e.getMaxHp()),t&&(this.modAttr=Math.floor(100-100*(e.tmpHp+t.tmpHp)/(e.getMaxHp()+t.getMaxHp())),t.modAttr(this.config.attr_type,this.config.attr_value*this.modAttr)),this.pBindNpcObj.modAttr(this.config.attr_type,this.config.attr_value*this.modAttr));continue}if(d.default.getInstance().isCoop()&&(e=this.pBindNpcObj.camp!=r.PLAYER_CAMP.opponents&&this.pBindNpcObj.camp!=r.PLAYER_CAMP.opponentsCoop?2==i.default.matchRoleIdentity?d.default.getInstance().getCarByCamp(1):d.default.getInstance().getCarByCamp(3):d.default.getInstance().getCarByCamp(r.PLAYER_CAMP.opponents)),e){var n=e.addPassiveSkill(this.templateId,this.config.kind);n&&cc.director.on("Event_ChangeHp",this.onHpChange,n)}}else o[a]==r.Passive_target.onlySelf&&(cc.director.on("Event_ChangeHp",this.onHpChange,this),this.pBindNpcObj.isBoss()?this.modAttr=0:(d.default.getInstance().isCoop()&&(t=d.default.getInstance().getCoopCarByCamp(this.pBindNpcObj.camp)),e&&(this.modAttr=Math.floor(100-100*e.tmpHp/e.getMaxHp()),t&&(this.modAttr=Math.floor(100-100*(e.tmpHp+t.tmpHp)/(e.getMaxHp()+t.getMaxHp()))),this.pBindNpcObj.modAttr(this.config.attr_type,this.config.attr_value*this.modAttr))))},t.checkCoopPSCondition=function(){var e=d.default.getInstance().getCoopSameHeroPS(this.pBindNpcObj,this.config.kind);return Number(e)>=Number(this.templateId)?{valid:!1,skillId:Number(e)}:{valid:!0,skillId:Number(e)}},t.countSameProfNum=function(){var e=d.default.getInstance().getCarByCamp(this.pBindNpcObj.camp);if(e){var t=new Set;if(e.getSameProfNum(this.pBindNpcObj.occupation,t),d.default.getInstance().isCoop()){var o=d.default.getInstance().getCoopCarByCamp(this.pBindNpcObj.camp);o&&o.getSameProfNum(this.pBindNpcObj.occupation,t)}return t.size>1?t.size:1}return 1},t.countHeroTotal=function(e,t){var o=0,i=this.pBindNpcObj.camp;e||(i=d.default.getInstance().getOpponentsCarCamp(this.pBindNpcObj.camp));var a=d.default.getInstance().getCarByCamp(i);if(a){var n=a.heroList;for(var s in n)!(h=n[s])||h.heroTemplateId==this.pBindNpcObj.heroTemplateId&&e||(t==r.HERO_TOTAL_TYPE.NUM?o+=1:t==r.HERO_TOTAL_TYPE.STAR&&(o+=h.star));if(d.default.getInstance().isCoop()){var c=d.default.getInstance().getCoopCarByCamp(i);if(c){var l=c.heroList;for(var u in l){var h;(h=l[u])&&(t==r.HERO_TOTAL_TYPE.NUM?o+=1:t==r.HERO_TOTAL_TYPE.STAR&&(o+=h.star))}}}}return o},t.countSpecialHeroNum=function(e,t){var o=0,i=this.pBindNpcObj.camp;e||(i=d.default.getInstance().getOpponentsCarCamp(this.pBindNpcObj.camp));var a=d.default.getInstance().getCarByCamp(i);if(a&&(a.getHeroObjById(t)&&o++,d.default.getInstance().isCoop())){var n=d.default.getInstance().getCoopCarByCamp(i);n&&n.getHeroObjById(t)&&o++}return o},t.checkExtraCondition=function(){if(this.config.extra_condition_type==r.Passive_Condition.population);else if(this.config.extra_condition_type==r.Passive_Condition.specialHero){if(this.countSpecialHeroNum(!0,this.config.extra_condition_value)>0)return!0}else if(this.config.extra_condition_type==r.Passive_Condition.noSpecialHero){if(0==this.countSpecialHeroNum(!0,this.config.extra_condition_value))return!0}else if(this.config.extra_condition_type==r.Passive_Condition.allSameProf){if(this.countSameProfNum()==this.countHeroTotal(!0,r.HERO_TOTAL_TYPE.NUM)+1)return!0}else{if(this.config.extra_condition_type==r.Passive_Condition.specialHeros){if(""==this.config.extra_condition_value3)return!1;var e=this.config.extra_condition_value3.split("#");for(var t in e){var o=Number(e[t]);if(0==o||0==this.countSpecialHeroNum(!0,o))return!1}return!0}if(this.config.extra_condition_type==r.Passive_Condition.noSpecialHeros){if(""==this.config.extra_condition_value3)return!0;var i=this.config.extra_condition_value3.split("#");for(var a in i){var n=Number(i[a]);if(0==n||0==this.countSpecialHeroNum(!0,n))return!0}return!1}}return!1},t.getTargetList=function(){return""==this.config.target?[]:this.config.target.split("|")},t.hasTarget=function(e){var t=this.getTargetList();if(0==t.length)return!0;for(var o in t)if(Number(t[o])==e)return!0;return!1},t.setEquipInvalid=function(e){if(d.default.getInstance().isCoop()&&this.pBindNpcObj.camp==r.PLAYER_CAMP.opponents){var t=d.default.getInstance().getPlayerModelByCamp(r.PLAYER_CAMP.myPlayer),o=d.default.getInstance().getPlayerModelByCamp(r.PLAYER_CAMP.coopPlayer);t&&t.setEquipInvaild(e),o&&o.setEquipInvaild(e)}else if(d.default.getInstance().isCoop()){var i=d.default.getInstance().getPlayerModelByCamp(r.PLAYER_CAMP.opponents);i&&i.setEquipInvaild(e)}else{var a=d.default.getInstance().getPvpPlayerByCamp(this.pBindNpcObj.camp);a&&a.setEquipInvaild(e)}},t.setWhosyourdaddyState=function(e,t){if(void 0===t&&(t=!1),this.pBindNpcObj){var o=this.getTargetList();for(var i in o)if(o[i]==r.Passive_target.selfCar){var a=null;(a=d.default.getInstance().isCoop()?(0,c.getRoleIdentity)(this.pBindNpcObj.camp)==r.PLAYER_IDENTITY.home?d.default.getInstance().getCoopCarByCamp(this.pBindNpcObj.camp):(0,c.getRoleIdentity)(this.pBindNpcObj.camp)==r.PLAYER_IDENTITY.away?d.default.getInstance().getCarByCamp(this.pBindNpcObj.camp):d.default.getInstance().getCarByCamp(r.PLAYER_CAMP.opponents):d.default.getInstance().getCarByCamp(this.pBindNpcObj.camp))&&(a.setWhosyourdaddyState(e),a.setWhosyourdaddyBuffID(this.config.buff,t),a.setWhosyourdaddyBuffID(this.config.buff2,t))}else o[i]==r.Passive_target.onlySelf&&(this.pBindNpcObj.setWhosyourdaddyState(e),this.pBindNpcObj.setWhosyourdaddyBuffID(this.config.buff,t),this.pBindNpcObj.setWhosyourdaddyBuffID(this.config.buff2,t))}},t.checkEnemyNumAddAttr=function(){if(this.pBindNpcObj){var e=0,t=d.default.getInstance().getOpponentsCarCamp(this.pBindNpcObj.camp),o=d.default.getInstance().getCoopCarCamp(t),i=d.default.getInstance().getNpcList();for(var a in i){var n=i[a];n&&(n.isDead()||n.camp!=t&&n.camp!=o||(e+=1))}var r=this.config.attr_value*e;r!=this.modAttr&&(this.pBindNpcObj.modAttr(this.config.attr_type,r-this.modAttr),console.log("checkEnemyNumAddAttr:",this.pBindNpcObj.attr[this.config.attr_type]),this.modAttr=r)}},t.checkEnemyHeroProfNum=function(e){if(this.pBindNpcObj&&this.checkEffectCondition(!1,e)){var t=0,o=d.default.getInstance().getOpponentsCarCamp(this.pBindNpcObj.camp),i=d.default.getInstance().getCoopCarCamp(o),a=[];this.config.extra_condition_type==r.Passive_Condition.specialOCC&&(a=this.config.extra_condition_value3.split("#"));var n=d.default.getInstance().getCarByCamp(o);if(n&&a.length>0)for(var s in a){var c=Number(a[s]);if(0!=c){var l=new Set;n.getSameProfNum(c,l),t+=l.size}}if(d.default.getInstance().isCoop()){var u=d.default.getInstance().getCarByCamp(i);if(u&&a.length>0)for(var h in a){var p=Number(a[h]);if(0!=p){var f=new Set;u.getSameProfNum(p,f),t+=f.size}}}this.modAttr=t,this.config.extra_condition_type==r.Passive_Condition.specialOCC&&(this.modAttr>1&&!this.isEffecting?this.isEffecting=!0:this.modAttr<=1&&this.isEffecting&&(this.isEffecting=!1))}},t.getEnemyHeroProfValue=function(){if(!this.isPassiveSkillVaild())return 1;var e=r.AttrParam;return this.config.type==r.Passive_Type.enemy_profNum_add_damage&&this.config.extra_condition_type==r.Passive_Condition.specialOCC&&(this.isEffecting?e=Number(this.config.extra_condition_value):this.isEffecting||(e=r.AttrParam)),e/r.AttrParam},t.changeDropBox=function(e){this.pBindNpcObj&&(d.default.getInstance().getController().monkeyDropBoxConfig[this.pBindNpcObj.camp]=e?{sprite:this.config.extra_condition_value3,spineId:Number(this.config.extra_condition_value)}:{sprite:r.DROPBOXSPRITE,spineId:r.DROPBOXSPINEID})},t.checkEnemyPopulationNum=function(e){if(this.pBindNpcObj&&this.checkEffectCondition(!1,e)){var t=0,o=0,i=d.default.getInstance().getOpponentsCarCamp(this.pBindNpcObj.camp),a=d.default.getInstance().getCoopCarCamp(i),n=d.default.getInstance().getCarByCamp(i);if(n&&(t=n.getHeroNum()),d.default.getInstance().isCoop()){var r=d.default.getInstance().getCarByCamp(a);r&&(o=r.getHeroNum())}this.modAttr=10*t+o}},t.getEnemyPopulationAddValue=function(){var e=r.AttrParam;if(this.config.type==r.Passive_Type.enemy_population_add_damage){var t=this.pBindNpcObj.getNextSkillIndex();10*t+t!=this.modAttr&&(e=Number(this.config.extra_condition_value))}return e/r.AttrParam},t.onNpcDodge=function(e){if(this.isPassiveSkillVaild()&&this.checkEffectCondition(!0,e))if(this.config.type==r.Passive_Type.car_dodge_self_add_buff)this.addBuffAndAttrToNpc(!0,!0,this.pBindNpcObj,this.pBindNpcObj.camp);else if(this.config.type==r.Passive_Type.car_dodge_add_buff){var t=d.default.getInstance().getCarByCamp(this.pBindNpcObj.camp),o=null;d.default.getInstance().isCoop()&&(o=d.default.getInstance().getCoopCarByCamp(this.pBindNpcObj.camp)),this.hasTarget(r.Passive_target.selfCar)&&t&&(this.addBuffAndAttrToNpc(!0,!0,t,t.camp),o&&this.addBuffAndAttrToNpc(!0,!0,o,o.camp))}},e}();o.default=h,t.exports=o.default,cc._RF.pop()},{"../../common/CombatModule":"CombatModule","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/ConfigUtils":"ConfigUtils","../../utils/ConstValue":"ConstValue","../../utils/Debug":"Debug","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils","../../utils/Tools":"Tools","../CombatManager":"CombatManager"}],PetPrizeTableData:[function(e,t,o){"use strict";cc._RF.push(t,"7f0dfgfqrRNRLVl100jdtw0","PetPrizeTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.PetPrizeTableData=void 0;var i=e("../TableReader"),a=e("./BaseTableData"),n=function(){function e(){this.id=0,this.petId=0,this.level=0,this.prize=new Array,this.desc="",this.extraParam="",this.extraParam2="",this.extraParam3=""}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.petId=e.getNumber(),this.level=e.getNumber();for(var o=e.getString(),n=new i.TableReader(o);n.getPos()<n.getLen();){var r=new a.DropItem;r.readOriginal(n),this.prize.push(r)}this.desc=e.getString(),this.extraParam=e.getString(),this.extraParam2=e.getString(),this.extraParam3=e.getString()},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"PetPrizeTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.PetPrizeTableData=n,cc._RF.pop()},{"../TableReader":"TableReader","./BaseTableData":"BaseTableData"}],PetTableData:[function(e,t,o){"use strict";cc._RF.push(t,"5b0dcgYwP9AJKhX2AUNXkbC","PetTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.PetTableData=void 0;var i=e("../TableReader"),a=function(){function e(){this.id=0,this.addCupInit=0,this.addCupLv=0}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.addCupInit=e.getNumber(),this.addCupLv=e.getNumber()},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"PetTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.PetTableData=a,cc._RF.pop()},{"../TableReader":"TableReader"}],PlayerChangeNameView:[function(e,t,o){"use strict";cc._RF.push(t,"e3719Iv1o9O/pOP1AsTARHU","PlayerChangeNameView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=e("../../common/PlayerModule"),l=e("../../utils/LogUtil"),d=e("../../network/ClientNetwork"),u=e("../../network/protocol/RoleProtocols"),h=e("../../modules/base/GameView"),p=e("../../network/protocol/RoleProtocols"),f=e("../../network/protocol/RoleProtocols"),g=e("../../network/protocol/TypeProtocols"),m=e("../../TableReader"),_=e("../../StaticData/ModifyNameNumTableData"),y=e("../../utils/GameUtils"),v=e("../../utils/GamePlatform"),C=e("../../utils/QQGameHallUtils"),S=e("../../utils/KSMinigameUtils"),T=e("../../Global/GameGlobal"),I=cc._decorator,N=I.ccclass,b=I.property,w=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.costNum=null,t.costIcon=null,t.m_labelNewName="",t.m_nCostNum=0,t.m_nCostItemID=0,t.m_nErrorCodeStart=70,t}return a(t,e),t.path=function(){return"ui/playerInfo/changeName"},t.prototype.start=function(){var e=this,t=c.default.getRoleAttrValByKey(g.ROLE_ATTR_VALUES.ROLE_ATTR_MODIFYNAMENUM);m.PreLoadCsv("ModifyNameNumTableData").then(function(){t>_.ModifyNameNumTableData.getDataMap().size-1&&(t=_.ModifyNameNumTableData.getDataMap().size-1);var o=_.ModifyNameNumTableData.getById(t).cost[0];e.m_nCostNum=o.dropNum,e.m_nCostItemID=o.dropID,e.costNum.string=o.dropNum.toString(),y.setIconByItemId(o.dropID,e.costIcon)}),this.onListenProtocol()},t.prototype.onEditingEnd=function(e){this.m_labelNewName=e.string},t.prototype.onRequestChangeRoleName=function(){if(""!==this.m_labelNewName)if(this.m_nCostNum>c.default.getItemCountByBag(this.m_nCostItemID))y.ERRORTIPS(this.m_nErrorCodeStart+4);else if(v.GamePlatform.isQQGameRoom()){var e=this;C.QQGameHallUtils.Instance.chatFilterAsync(this.m_labelNewName,C.QQGameHallUtils.CHAT_FILTER_SCENETYPE_NAME).then(function(t){if(""==t||t==e.m_labelNewName){var o=new f.C_Role_ModifyRoleName;o.roleName=e.m_labelNewName,d.ClientNetwork.getInstance().Send(u.ROLE_CLIENT_ENUM.P_Role_ModifyRoleName,o)}else y.ERRORTIPS(e.m_nErrorCodeStart+2)})}else if(v.GamePlatform.isKuaishouMiniGame()){var t=this;S.KSMinigameUtils.Instance.chatFilterAsync(this.m_labelNewName,S.KSMinigameUtils.CHAT_FILTER_SCENETYPE_NAME).then(function(e){if(1!=e){var o=new f.C_Role_ModifyRoleName;o.roleName=t.m_labelNewName,d.ClientNetwork.getInstance().Send(u.ROLE_CLIENT_ENUM.P_Role_ModifyRoleName,o)}else T.G.StringManager.PopStringOnce("\u5185\u5bb9\u542b\u6709\u8fdd\u89c4\u5185\u5bb9")})}else{var o=new f.C_Role_ModifyRoleName;o.roleName=this.m_labelNewName,d.ClientNetwork.getInstance().Send(u.ROLE_CLIENT_ENUM.P_Role_ModifyRoleName,o)}else y.ERRORTIPS(this.m_nErrorCodeStart+2)},t.prototype.onListenProtocol=function(){var e=this;d.ClientNetwork.getInstance().listenProtocol(u.ROLE_CLIENT_ENUM.P_Role_ModifyRoleName,function(t){t.resetPos();var o=new p.S_Role_ModifyRoleName;if(o.read(t))if(0===o.errorcode){e.closeView(),y.ERRORTIPS(e.m_nErrorCodeStart),c.default.roleName=e.m_labelNewName;var i=h.default.getViewByName("PlayerInfoView");i&&i.view&&i.view.onRefreshPlayerName();var a=h.default.getViewByName("MainSceneView");a&&a.view&&a.view.onShowPlayerName()}else l.default.info(o),y.ERRORTIPS(e.m_nErrorCodeStart+o.errorcode)},this)},t.prototype.onDestroy=function(){d.ClientNetwork.getInstance().removeMessageTarget(this)},n([b(cc.Label)],t.prototype,"costNum",void 0),n([b(cc.Sprite)],t.prototype,"costIcon",void 0),n([s.Register_Class,N],t)}(r.default);o.default=w,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/ModifyNameNumTableData":"ModifyNameNumTableData","../../TableReader":"TableReader","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/base/GameView":"GameView","../../network/ClientNetwork":"ClientNetwork","../../network/protocol/RoleProtocols":"RoleProtocols","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/GamePlatform":"GamePlatform","../../utils/GameUtils":"GameUtils","../../utils/KSMinigameUtils":"KSMinigameUtils","../../utils/LogUtil":"LogUtil","../../utils/QQGameHallUtils":"QQGameHallUtils"}],PlayerCombatModel:[function(e,t,o){"use strict";cc._RF.push(t,"96cb0S+RddBxJgA05OBEeAi","PlayerCombatModel"),o.__esModule=!0,o.default=void 0;var i=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=b();if(t&&t.has(e))return t.get(e);var o={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var n=i?Object.getOwnPropertyDescriptor(e,a):null;n&&(n.get||n.set)?Object.defineProperty(o,a,n):o[a]=e[a]}return o.default=e,t&&t.set(e,o),o}(e("../common/CombatModule")),a=N(e("../common/PlayerModule")),n=e("../network/ClientNetwork"),r=e("../network/FightNetwork"),s=e("../network/LocalMessage"),c=e("../network/protocol/FightProtocols"),l=N(e("../utils/ConfigUtils")),d=N(e("../utils/Tools")),u=N(e("./CombatManager")),h=N(e("../utils/GameTools")),p=N(e("./CombatStatistic")),f=N(e("../controller/Guide/GuideController")),g=e("../utils/GameUtils"),m=e("../network/protocol/TypeProtocols"),_=N(e("../modules/manager/EventManager")),y=N(e("../common/EventConst")),v=(N(e("../modules/manager/cheat/CheatValue")),e("../modules/manager/cheat/SafeNumber")),C=e("../utils/RandomSeed"),S=N(e("../utils/Debug")),T=N(e("../network/protocol/long")),I=N(e("../common/NetworkProtocolCommon"));function N(e){return e&&e.__esModule?e:{default:e}}function b(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return b=function(){return e},e}var w=e("../utils/ConstValue"),E=w.Car_Max_Level,P=w.Game_State,R=w.PLAYER_CAMP,L=w.Enum_Elf_Card,A=w.PLAYER_IDENTITY,D=(w.Buff_Type,w.HERO_PROF_TYPE),M=w.Passive_Type,B=w.INT_MAX_MONEY,k=function(){function e(){var e=this;this.carInfo={id:0,templateId:0,level:1,bindedHeroInfo:{},tbHeroList:{},tbHeroPosInfo:{},tbFightHeroList:[],heroNum:0,carLvUpCost:[],tbBindHeroInfo:{},tbSummonInfo:{},tbHeroSummonedNum:{},tbEquipInfo:{},boxSliveNum:new v.SafeNumber(0),getSummonListIdByCamp:function(e){return this.tbSummonInfo[e]},getBindHeroInfoByLevel:function(e){return this.tbBindHeroInfo[e]},setBindHeroInfoByLevel:function(e){return this.tbBindHeroInfo[e]=null},setHeroSummonId:function(e,t){this.tbHeroSummonedNum[e]=e+t},getHeroSummonId:function(e){return this.tbHeroSummonedNum[e]?this.tbHeroSummonedNum[e]=this.tbHeroSummonedNum[e]+1:this.tbHeroSummonedNum[e]=e+1}},this.camp=0,this.money=0;var t=u.default.getInstance().getController().getCheatValueCom();t&&t.checkObjCheat(this,this.getProtectStr),this.totalDamage=0,this.totalHeal=0,this.combatStatistic=new p.default,this.behaviorRecord=[],this.behaviorTimer=0,setInterval(function(){u.default.getInstance().gameState==P.Fighting&&e.behaviorTimer++},1e3),this.carRefreshCount=0,this.cardIdVec=[],this.changeSpritPR=new v.SafeNumber(0),this.changSpritRS=null,this.bossChangeSpritPR=new v.SafeNumber(0),this.bossChangSpritRS=null,this.equipInvaildState=!1,this.sliverInvaildState=!1,this.sellSliverInvaildState=!1,this.sliverChangeVec=[],this.sliverChangeOnOff=a.default.checkModulerOnOffState(68),this.onListenMessage()}var t=e.prototype;return t.getProtectStr=function(){return"8089#"+this.money},t.restart=function(){var e=l.default.getInstance().getCarConfig(1);for(var t in this.setMoney(e?e.player_money:0),this.carInfo.level=1,this.carInfo.bindedHeroInfo.level=1,this.carInfo.tbHeroList)this.carInfo.tbHeroList[t]=null;this.carInfo.tbHeroList={},this.carInfo.tbHeroPosInfo={},this.carInfo.heroNum=0},t.initData=function(e,t,o,a){if(this.camp=e,i.default.matchType==m.FIGHT_TYPE.FIGHT_TYPE_FOG_HIDDEN){var n=Number((0,g.getConfigIntValue)("fogHiddenBeginMoney"));this.addMoney(n),this.camp!=R.myPlayer&&(this.setMoney(n),(0,g.isRobot)(this.camp)||(this.combatStatistic.slivers=n,this.combatStatistic.maxSlivers=this.money))}else{var r=l.default.getInstance().getCarConfig(1);this.addMoney(r?r.player_money:0),this.camp!=R.myPlayer&&(this.setMoney(r?r.player_money:0),(0,g.isRobot)(this.camp)||(this.combatStatistic.slivers=r?r.player_money:0,this.combatStatistic.maxSlivers=this.money))}this.carInfo.id=t||d.default.getInstance().genId(),this.carInfo.templateId=o;var s=l.default.getInstance().getCarConfig(o);this.carInfo.level=a,this.carInfo.tbFightHeroList=s.hero_list.split("|"),this.carInfo.carLvUpCost=s.lv_up_cost.split("|");var c=s.bind_hero_list.split("|");for(var h in c){var p=c[h].split("#"),f=(a=Number(p[0]),Number(p[1])),_=Number(p[2]),y=Number(p[3]);if(a>0){var v=l.default.getInstance().getHeroConfig(f);this.carInfo.tbBindHeroInfo[a]={templateId:f,pos:y,level:1,npcTemplateId:v.npc_id,starLevel:_}}}var S=s.summon_list.split("|");for(var h in a=0,S)a+=1,p=S[h].split("#"),this.carInfo.tbSummonInfo[p[0]]=p[1];u.default.getInstance().isSkyCastle()&&(this.randomSeed=new C.RandomSeed,this.randomSeed.RandomSeed((0,g.getRoleIdentity)(this.camp)))},t.getFightHero=function(){return this.carInfo.tbFightHeroList},t.getMaxHeroNum=function(){return this.carInfo.level},t.getCurHeroNum=function(){return this.carInfo.heroNum},t.getLevel=function(){return this.carInfo.level},t.reqCarLevelUp=function(e){if(void 0===e&&(e=!1),this.carInfo.level>=E)return-1;var t=this.carInfo.carLvUpCost[this.carInfo.level-1];if(0==e){if(t>this.money)return-2;this.useMoney(t)}this.carInfo.level=this.carInfo.level+1;var o=u.default.getInstance().getCarByCamp(this.camp);return o&&(cc.director.emit("Event_carLvUp",this.camp),o.refreshLevel(this.carInfo.level)),this.saveBehaviorRecord("CarUp"),1},t.getHeroPos=function(){var e=1;for(e=1;e<100;e++)if(!this.carInfo.tbHeroPosInfo[e])return e},t.getSkyOpponentCampId=function(e){var t=this.randomSeed.randomMinMaxInt(1,2);return u.default.getInstance().isSkyCastleEnemy(e)?1==t?(0,g.getRoleIdentity)(R.myPlayer)==A.home?R.myPlayer:R.coopPlayer:(0,g.getRoleIdentity)(R.myPlayer)==A.home?R.coopPlayer:R.myPlayer:1==t?R.opponents:R.opponentsCoop},t.getOpponentCampId=function(){if(u.default.getInstance().isSkyCastle())return this.getSkyOpponentCampId(this.camp);var e=0;return u.default.getInstance().isCoop()?this.camp==R.myPlayer?e=R.coopPlayer:this.camp==R.coopPlayer&&(e=R.myPlayer):e=this.camp==R.myPlayer?R.opponents:R.myPlayer,e},t.findFallStarHeros=function(e){var t=this.getOpponentCampId(),o=u.default.getInstance().getCarByCamp(t),i=null;if(u.default.getInstance().isSkyCastle()&&(i=u.default.getInstance().getCoopCarByCamp(t)),!o||Object.keys(o.heroList).length<=0||0==o.getFallStarHerosNum(e)){if(!u.default.getInstance().isSkyCastle())return[];if(!i||Object.keys(i.heroList).length<=0||0==i.getFallStarHerosNum(e))return[];o=i}if(e){var a=[];for(var n in o.heroList)if(n<90){var r=o.heroList[n];r&&r.heroTemplateId==e&&a.push(r)}return a}var s=[],c=!0;for(var l in o.heroList)if(l<90){var d=o.heroList[l];d&&d.star>1&&d.star<4&&(c=!1,s.push(d))}return 1==c?[]:s},t.findUpStarHeros=function(e){var t=u.default.getInstance().getCarByCamp(this.camp);if(!t||Object.keys(t.heroList).length<=0)return[];if(e){var o=[];for(var i in t.heroList)if(i<90){var a=t.heroList[i];a&&a.heroTemplateId==e&&o.push(a)}return o}var n=!0;for(var r in t.heroList)if(r<90){var s=t.heroList[r];if(s){var c=l.default.getInstance().getHeroConfig(s.heroTemplateId);s.star<c.max_lv&&(n=!1)}}if(1==n)return[];var d=[];for(var h in t.heroList)if(h<90){var p=t.heroList[h];if(p){var f=l.default.getInstance().getHeroConfig(p.heroTemplateId);p.star<f.max_lv&&d.push(p)}}return d},t.opponentCarHeroFallStar=function(e,t,o){t||(o=!0);var i=new cc.Node("elfNodeFallStar");i.parent=u.default.getInstance().getController().mapNode,i.addComponent(sp.Skeleton),i.x=i.parent.width/2,i.y=i.parent.height/2+90,i.scale=.8;var a=l.default.getInstance().getHeroConfig(e),n=l.default.getInstance().getNpcTemplateConfig(a.npc_id,1).res_id,r=null;if(!o){var s=t.camp,c=u.default.getInstance().getPlayerModelByCamp(s);c&&(r=c.carInfo.tbHeroList[t.heroTemplateId])&&(r.starLevel>1?r.starLevel--:o=!0)}return cc.resources.load(l.default.getInstance().getResConfig(n).animation,sp.SkeletonData,function(e,a){if(e)S.default.error("load elfNode err:"+e.message);else if(cc.isValid(i)){var n=i.getComponent(sp.Skeleton);if(n){if(n.skeletonData=a,n.setSkin("default"),n.setAnimation(0,"idle",!0),d.default.playAudioEffect("combat/audio/animation/skill_qiu"),!t)return void setTimeout(function(){i.destroy()},500);var s=t.node.convertToWorldSpaceAR(cc.v2(0,0));s=i.parent.convertToNodeSpaceAR(s),cc.tween(i).delay(.5).parallel(cc.tween().to(.25,{position:s}),cc.tween().to(.25,{scale:.25})).call(function(){i.destroy();var e=t.camp,a=u.default.getInstance().getCarByCamp(e);return a?u.default.getInstance().getPlayerModelByCamp(e)?void(1==o||t.star<=1||r&&a.refreshFallHeroInfo(r)):cc.log("\u6ca1\u6709\u5bf9\u65b9\u7684\u6570\u636e"):i.destroy()}).start()}}}),o},t.selfCarHeroUpStar=function(e,t,o){var i=this;t||(o=!0);var a=new cc.Node("elfNode");a.parent=u.default.getInstance().getController().mapNode,a.addComponent(sp.Skeleton),a.x=a.parent.width/2,a.y=a.parent.height/2+90,a.scale=.8;var n=l.default.getInstance().getHeroConfig(e),r=l.default.getInstance().getNpcTemplateConfig(n.npc_id,1).res_id,s=!1,c=!1,h=null;if(!o&&(h=this.carInfo.tbHeroList[t.heroTemplateId])){h.starLevel++,h.starLevel>n.max_lv&&(h.starLevel=n.max_lv,s=!0,o=!0);var p=l.default.getInstance().getHeroConfig(t.heroTemplateId);h.starLevel>=p.max_lv&&(c=!0)}return cc.resources.load(l.default.getInstance().getResConfig(r).animation,sp.SkeletonData,function(n,r){if(n)S.default.error("load elfNode err:"+n.message);else if(cc.isValid(a)){var l=a.getComponent(sp.Skeleton);if(l){if(l.skeletonData=r,l.setSkin("default"),l.setAnimation(0,"idle",!0),d.default.playAudioEffect("combat/audio/animation/skill_qiu"),!t)return void setTimeout(function(){a.destroy()},500);var p=t.node.convertToWorldSpaceAR(cc.v2(0,0));p=a.parent.convertToNodeSpaceAR(p),cc.tween(a).delay(.5).parallel(cc.tween().to(.25,{position:p}),cc.tween().to(.25,{scale:.25})).call(function(){a.destroy();var n=u.default.getInstance().getCarByCamp(i.camp);if(!n)return a.destroy();if(1!=o){if(!s&&(h&&n.refreshHeroInfo(h,c,e),c&&t&&u.default.getInstance().isCoop())){var r=u.default.getInstance().getCoopCarCamp(i.camp);i.checkOtherPlayerHeroPassiveSkill(r,t)}}else u.default.getInstance().getCarByCamp(i.camp).playUpFailEffect(i.carInfo.tbHeroList[t.heroTemplateId])}).start()}}}),o},t.checkUpstarProb=function(e,t,o){var i=this;void 0===o&&(o=!1);var a=l.default.getInstance().getHeroConfig(e);t||(t=0);var n=Number(a.starProb.split("|")[t]),r=function(){for(var t=l.default.getInstance().getHeroTalentTableDataCfg(),a="",n=[],r=i.getHeroCardLevel(e,o),s=0,c=Object.keys(t);s<c.length;s++){var d=c[s];t.hasOwnProperty(d)&&t[d].heroId==e&&n.push(t[d])}if(n.forEach(function(e){Number(r)>=e.level&&(a=e.skillIdList)}),""!=a){var u=a.split("|");for(var h in u){var p=l.default.getInstance().getPassiveSkillConfig(Number(u[h]));if(p&&29==p.type)return p.attr_value}}return 0}.call(this)+n;r>101&&(r=101);var s=h.default.getRandomInt(1,101);return u.default.getInstance().isSkyCastle()&&(s=this.randomSeed.randomMinMaxInt(1,101)),s>r},t.onElfModifyEquip=function(e,t,o,i){var a=this;if(0==i){var n;n=!u.default.getInstance().isCoop()||this.camp!=R.myPlayer&&this.camp!=R.coopPlayer?this.camp:u.default.getInstance().getSelfCar().camp,u.default.getInstance().getController().onSaveChangeEquip(n,o)}t=u.default.getInstance().isCoop()&&!u.default.getInstance().isSkyCastle()||1==this.camp?u.default.getInstance().getController().fightCardViewScript._equipListNode:u.default.getInstance().getController().fightCardViewScript._opponentEquipListNode,o<=0&&(i=!0);var r=new cc.Node("elfNodeEquip");r.parent=u.default.getInstance().getController().node,r.addComponent(sp.Skeleton),r.x=0,r.y=90,r.scale=.8;var s=l.default.getInstance().getHeroConfig(e),c=l.default.getInstance().getNpcTemplateConfig(s.npc_id,1).res_id;cc.resources.load(l.default.getInstance().getResConfig(c).animation,sp.SkeletonData,function(e,o){if(e)S.default.error("load elfEquipNode err:"+e.message);else if(cc.isValid(r)){var n=r.getComponent(sp.Skeleton);if(n){if(n.skeletonData=o,n.setSkin("default"),n.setAnimation(0,"idle",!0),d.default.playAudioEffect("combat/audio/animation/skill_qiu"),!t)return void setTimeout(function(){r.destroy()},500);var s=t.convertToWorldSpaceAR(cc.v2(0,0));s=r.parent.convertToNodeSpaceAR(s),cc.tween(r).delay(.5).parallel(cc.tween().to(.25,{position:s}),cc.tween().to(.25,{scale:.25})).call(function(){if(r.destroy(),1!=i){var e;e=!u.default.getInstance().isCoop()||a.camp!=R.myPlayer&&a.camp!=R.coopPlayer?a.camp:u.default.getInstance().getSelfCar().camp;var t=u.default.getInstance().getPlayerModelByCamp(e),o=0;for(var n in t.carInfo.tbEquipInfo)o=Number(n);o>0&&u.default.getInstance().getController().onChangeEquip(e,o)}}).start()}}})},t.onGetRandomEquip=function(e){var t,o=i.default.getDropEquipList(),a=o[e]?o[e]:[],n=[501,502,503,504];if((t=a.length<=0?0:a[a.length-1]._templateId)>0)for(var r=0;r<n.length;r++)if(n[r]==t){n.splice(r,1);break}return t<=0?0:n[h.default.getRand(n.length)]},t.reqHeroLevelDown=function(e){var t=this.carInfo.tbHeroList[e];if(t.starLevel>1){t.starLevel--;var o=u.default.getInstance().getCarByCamp(this.camp);o&&o.refreshFallHeroInfo(t)}},t.reqHeroLevelUp=function(e,t,o,i,a,r){void 0===t&&(t=!1),void 0===o&&(o=null),void 0===i&&(i=0),void 0===a&&(a=!1),void 0===r&&(r=!1);var c=u.default.getInstance().getCarByCamp(this.camp);if(!c)return-1;if(t&&e>=L.fireworkElf)return e-=L.fireworkElf,this.combatStatistic.addStatisticHero(this.camp,e),this.onActionFireWork(e,null,t,a),-5;t&&e>L.rainbowElf&&(0,g.isSpirit)(e-L.rainbowElf)&&(e-=L.rainbowElf,r=!0);var p=!1,f=l.default.getInstance().getHeroConfig(e),m=this.getHeroLevel(e),_=f.starSellPrice.split("|")[m];if(this.money<_&&0==t)return-1;if(this.combatStatistic.addStatisticHero(this.camp,e),2==f.hero_type){if(0==t&&this.isChangeSprit(e)&&!r)return this.onActionFireWork(e,null,t,a),-5;if(e==L.rainbowElf)this.useRainbowElf(e,t,a);else if(35==e)this.onActionElf(e,null,t,a,r);else if(34==e)if(this.nHeroLvUpAdditionParam=null,1==t){var y=null,v=this.findUpStarHeros(o);v.length>0&&(y=v[0]),i=!!(i&&i>0),this.selfCarHeroUpStar(e,y,i)}else{var C=null,S=!0,T=this.findUpStarHeros();if(T.length>0){var I=h.default.getRand(T.length);u.default.getInstance().isSkyCastle()&&(I=this.randomSeed.randomMinMaxInt(1,T.length)-1),C=T[I],this.nHeroLvUpAdditionParam=C.heroTemplateId,S=this.checkUpstarProb(e,0,r)}if(1==(S=this.selfCarHeroUpStar(e,C,S)))return 0==t&&0==a&&n.ClientNetwork.getInstance().pushLocalMessage(s.LOCAL_MESSAGE.LocalMsg_BuyFightCard,this.camp),-4;0==t&&0==a&&n.ClientNetwork.getInstance().pushLocalMessage(s.LOCAL_MESSAGE.LocalMsg_BuyFightCard,this.camp)}else{if(39==e)return this.onUseDropCard(e,r),t||a||(n.ClientNetwork.getInstance().pushLocalMessage(s.LOCAL_MESSAGE.LocalMsg_BuyFightCard,this.camp),cc.director.emit("Event_SummonSpirit",e,R.myPlayer),this.sendCardClearToServer()),r||this.onStatisticHeroLvUp(e),-1;if(40==e)if(this.nHeroLvUpAdditionParam=null,1==t){var N=null,b=this.findFallStarHeros(o);b.length>0&&(N=b[0]),i=!!(i&&i>0),this.opponentCarHeroFallStar(e,N,i)}else{var w=null,E=!0,P=this.findFallStarHeros();if(P.length>0){var A=h.default.getRand(P.length);u.default.getInstance().isSkyCastle()&&(A=this.randomSeed.randomMinMaxInt(1,P.length)-1),w=P[A],this.nHeroLvUpAdditionParam=w.heroTemplateId,E=this.checkUpstarProb(e,0,r)}if(1==(E=this.opponentCarHeroFallStar(e,w,E)))return this.nHeroLvUpAdditionParam=null,0==t&&0==a&&n.ClientNetwork.getInstance().pushLocalMessage(s.LOCAL_MESSAGE.LocalMsg_BuyFightCard,this.camp),-4;0==t&&0==a&&n.ClientNetwork.getInstance().pushLocalMessage(s.LOCAL_MESSAGE.LocalMsg_BuyFightCard,this.camp)}else if(44==e){var M=null;if(this.carInfo.tbHeroList[e])(M=this.carInfo.tbHeroList[e].elfHeroObj).node.x=u.default.getInstance().getController().mapNode.width/2,M.node.y=u.default.getInstance().getController().mapNode.height/2+90,M.node.scale=.8,M.node.active=!0;else{var B=this.getHeroCardLevel(e,r);this.carInfo.tbHeroList[e]={id:d.default.getInstance().genId(),templateId:e,starLevel:1,pos:100,npcTemplateId:f.npc_id,level:B};var k=c.addHero(this.carInfo.tbHeroList[e]);this.carInfo.tbHeroList[e].elfHeroObj=k,k&&(M=k)}if(M){var G=c.node.convertToWorldSpaceAR(cc.v2(0,0));G=M.node.parent.convertToNodeSpaceAR(G),cc.tween(M.node).delay(.5).parallel(cc.tween().to(.25,{position:G}),cc.tween().to(.25,{scale:.25})).call(function(){if(M.node.active=!1,M.pSkillObjList)for(var e in M.pSkillObjList)M.pSkillObjList[e]&&M.pSkillObjList[e].doSkill()}).start(),0!=t||a||n.ClientNetwork.getInstance().pushLocalMessage(s.LOCAL_MESSAGE.LocalMsg_BuyFightCard,this.camp)}}else if(e==L.moElf)this.onActionElf(e,c,t,a,r);else if(e==L.tuElf)if(1==t){var O;O=u.default.getInstance().getCarByCamp(this.camp),i=!!(i&&i>0),this.selfCarUpStar(e,O,i)}else{var H,V;if(H=u.default.getInstance().getCarByCamp(this.camp),V=this.checkUpstarProb(e,0,r),this.selfCarUpStar(e,H,V),1==V)return 0==t&&0==a&&n.ClientNetwork.getInstance().pushLocalMessage(s.LOCAL_MESSAGE.LocalMsg_BuyFightCard,this.camp),-4;0==t&&0==a&&n.ClientNetwork.getInstance().pushLocalMessage(s.LOCAL_MESSAGE.LocalMsg_BuyFightCard,this.camp)}}return r||this.onStatisticHeroLvUp(e),1}var F=this.carInfo.tbHeroList[e];if(f.occupation!=D.Engineer){var U=u.default.getInstance().getCarByCamp(this.camp);if(!F&&this.carInfo.heroNum-U.getEngineerNum()>=this.carInfo.level)return U&&(U.getHeroNum()!=this.carInfo.heroNum&&(this.carInfo.heroNum=U.getHeroNum()),this.carInfo.level=U.getLevel()),-2}var x=F?F.starLevel:0,Y=f.max_lv;if(x>=Y)return-3;if(1==this.checkUpstarProb(e,m)&&0==t)return u.default.getInstance().getCarByCamp(this.camp).playUpFailEffect(this.carInfo.tbHeroList[e]),n.ClientNetwork.getInstance().pushLocalMessage(s.LOCAL_MESSAGE.LocalMsg_BuyFightCard,this.camp),-4;if(x+f.up_level>=Y?(u.default.getInstance().addMaxStarHero(e),x=Y,p=!0):x+=f.up_level,F)F.starLevel=x,this.saveBehaviorRecord("HeroUpStar");else{var j=this.getHeroPos();if(f.occupation==D.Engineer&&(j=f.hero_pos,this.carInfo.tbHeroPosInfo[j]))return-6;var W=this.getHeroCardLevel(e);this.carInfo.tbHeroList[e]={id:d.default.getInstance().genId(),templateId:e,starLevel:x,pos:j,npcTemplateId:f.npc_id,level:W},this.carInfo.tbHeroPosInfo[j]=e,this.carInfo.heroNum=this.carInfo.heroNum+1,this.saveBehaviorRecord("HeroBattle")}if(c.refreshHeroInfo(this.carInfo.tbHeroList[e],p),p){var z=u.default.getInstance().getCarByCamp(this.camp).getHeroObjById(e);if(z&&u.default.getInstance().isCoop()){var K=u.default.getInstance().getCoopCarCamp(this.camp);this.checkOtherPlayerHeroPassiveSkill(K,z)}}return this.onStatisticHeroLvUp(e),1},t.getCarLvUpCost=function(){return this.carInfo.carLvUpCost[this.carInfo.level-1]},t.setMoney=function(e){var t=u.default.getInstance().getController().getCheatValueCom();t&&t.checkObjCheat(this,this.getProtectStr),this.money=e,a.default.checkModulerOnOffState(66)&&this.money>B&&(this.money=B),t&&t.protectObj(this,this.getProtectStr)},t.isExtraSliverType=function(e){return e==m.SP_CHANGE_TYPE.SP_CHANGE_TYPE_ADD_OBLATION||e==m.SP_CHANGE_TYPE.SP_CHANGE_TYPE_ADD_THIEF},t.isSellSliverType=function(e){return e==m.SP_CHANGE_TYPE.SP_CHANGE_TYPE_ADD_SELL_HERO},t.addMoney=function(e,t){if(void 0===t&&(t=m.SP_CHANGE_TYPE.SP_CHANGE_TYPE_INIT),0!=e&&!(this.getSliverInvalidState()&&this.isExtraSliverType(t)||this.getSellSliverInvalidState()&&this.isSellSliverType(t))&&(this.camp==R.myPlayer||(0,g.isReplaced)(this.camp)||(0,g.isRobot)(this.camp))){var o=e,i=u.default.getInstance().getController().getCheatValueCom();i&&i.checkObjCheat(this,this.getProtectStr),this.money=this.money+e,a.default.checkModulerOnOffState(66)&&this.money>B&&(o=e-(this.money-B),this.money=B),i&&i.protectObj(this,this.getProtectStr),this.camp==R.myPlayer&&t!=m.SP_CHANGE_TYPE.SP_CHANGE_TYPE_ADD_MINE&&this.sendSliverToServer(e,1,t),cc.director.emit("Event_MoneyChange",o,this.camp,t),this.combatStatistic.countSliverNum(e),this.combatStatistic.countMaxSliverNum(this.money),this.recordSliverChange(e)}},t.useMoney=function(e,t){if(void 0===t&&(t=m.SP_CHANGE_TYPE.SP_CHANGE_TYPE_INIT),this.money<e||0==e)return!1;if(this.camp==R.myPlayer||(0,g.isReplaced)(this.camp)||(0,g.isRobot)(this.camp)){var o=u.default.getInstance().getController().getCheatValueCom();o&&o.checkObjCheat(this,this.getProtectStr),this.money=this.money-e,o&&o.protectObj(this,this.getProtectStr),this.camp==R.myPlayer&&this.sendSliverToServer(-1*e,0,t),cc.director.emit("Event_MoneyChange",-e,this.camp,t);var i=u.default.getInstance().getCarByCamp(this.camp);i&&i.sliverCurseEffect(Math.abs(e)),this.recordSliverChange(-1*e)}return!0},t.getCurMoney=function(){return Math.floor(this.money)},t.onKillNpc=function(e){this.addMoney(e.attrModel.money)},t.isDead=function(){return this.attrModel.hp<=0},t.getHeroFightList=function(){return this.carInfo.tbHeroList},t.getHeroLevel=function(e){return this.carInfo.tbHeroList[e]?this.carInfo.tbHeroList[e].starLevel:0},t.getHeroSummonId=function(e,t){var o=1e7*(0,g.getRoleIdentity)(e)+1e5*t;return this.carInfo.getHeroSummonId(o)},t.setHeroSummonId=function(e,t,o){var i=1e7*(0,g.getRoleIdentity)(e)+1e5*t;return this.carInfo.setHeroSummonId(i,o)},t.reqSellHero=function(e,t){void 0===t&&(t=!1);var o=this.carInfo.tbHeroList[e];if(!o)return-1;if(!u.default.getInstance().getCarByCamp(this.camp))return-1;if(0==t){var i=u.default.getInstance().getCarByCamp(this.camp).getHeroObjById(e);if(i){var a=i.getSellMoreMoney(o.starLevel,1);a>0&&this.addMoney(a,m.SP_CHANGE_TYPE.SP_CHANGE_TYPE_ADD_SELL_HERO)}}if(2==l.default.getInstance().getHeroConfig(e).hero_type)return this.carInfo.tbHeroList[e]=null,u.default.getInstance().getCarByCamp(this.camp).deleteHero(o.pos),1;var n=o.pos;this.carInfo.tbHeroPosInfo[n]=null,this.carInfo.tbHeroList[e]=null,this.carInfo.heroNum=this.carInfo.heroNum-1;var r=u.default.getInstance().getCarByCamp(this.camp).heroList[n];if(u.default.getInstance().getCarByCamp(this.camp).deleteHero(n),u.default.getInstance().deleteMaxStarHero(e),r&&u.default.getInstance().isCoop()){var s=u.default.getInstance().getCoopCarCamp(this.camp);this.checkOtherPlayerHeroPassiveSkill(s,r)}return this.saveBehaviorRecord("HeroDelete"),1},t.checkOtherPlayerHeroPassiveSkill=function(e,t){var o=u.default.getInstance().getCarByCamp(e);if(o){var i=o.heroList;if(i){var a=t.passiveSkillIdList.split("|"),n=t.maxPassiveSkillIdList.split("|");for(var r in i){var s=i[r];s&&s.heroTemplateId==t.heroTemplateId&&(a&&s.pPassiveSkillObjList&&this.checkHeroPassiveSkill(s,s.pPassiveSkillObjList,a),n&&s.maxPassiveSkillObjList&&this.checkHeroPassiveSkill(s,s.maxPassiveSkillObjList,n))}}}},t.checkHeroPassiveSkill=function(e,t,o){for(var i in o){var a=l.default.getInstance().getPassiveSkillConfig(o[i]);if(a){if(0==a.buff&&a.type!=M.change_spirit)continue;for(var n in t){var r=t[n];a.kind==r.config.kind&&(r.unbind(),r.init(n,e),_.default.Instance.emit(y.default.BattleChangeHero,e.getCamp()))}}}},t.carIsMaxLevel=function(){if(this.carInfo.level>=E)return 1},t.getClickHeroTemplateByPos=function(e){for(var t in this.carInfo.tbHeroPosInfo)if(e==t){var o=this.carInfo.tbHeroPosInfo[t];return Number(o)}},t.getHeroNumWeightParam=function(e){var t=this.carInfo.tbHeroList[e],o=l.default.getInstance().getHeroConfig(e).random_num;if(t){var i=o-t.starLevel;return i<1&&(i=0),i}return o},t.addTotalDamage=function(e,t){this.totalDamage=this.totalDamage+t,this.combatStatistic.countHeroDamage(this.camp,e,t)},t.getTotalDamage=function(){return this.totalDamage},t.addTotalHeal=function(e,t){this.totalHeal=this.totalHeal+t,this.combatStatistic.countHeroHeal(this.camp,e,t)},t.getTotalHeal=function(){return this.totalHeal},t.unregistMessage=function(){n.ClientNetwork.getInstance().removeLocalMessage(s.LOCAL_MESSAGE.LocalMsg_UpdateCarInfo,this)},t.sendCarLvUpToServer=function(e,t){if(i.default.getCombatType()!=i.CombatType.PVE){var o=new c.C_Fight_Update_Car_SYNC;o.roleID=t,o.updateCar.camp=this.camp,o.updateCar.level=e,r.FightNetwork.getInstance().Send(c.FIGHT_CLIENT_ENUM.P_Fight_Update_Car_SYNC,o),i.default.matchType==m.FIGHT_TYPE.FIGHT_TYPE_FOG_HIDDEN&&u.default.getInstance().reqFightResult(!1,!0),console.log("HHHHHHHHHHHHHHHHHHH fightserver sendCarLvUpToServer level"+e)}},t.sendHeroLvUpToServer=function(e,t,o){if(i.default.getCombatType()!=i.CombatType.PVE){var n=new c.C_Fight_Update_Hero_SYNC;n.roleID=a.default.UUID,n.updateHero.camp=this.camp,n.updateHero.heroTemplateId=e,n.updateHero.pos=t,n.updateHero.heroNpcId=o,n.updateHero.heroTrainLv=this.getHeroLevel(e),r.FightNetwork.getInstance().Send(c.FIGHT_CLIENT_ENUM.P_Fight_Update_Hero_SYNC,n),console.log("HHHHHHHHHHHHHHHHHHH fightserver sendHeroLvUpToServer heroTemplateId"+e)}},t.sendHeroSellToServer=function(e,t){if(i.default.getCombatType()!=i.CombatType.PVE){var o=new c.C_Fight_Sell_Hero_SYNC;o.roleID=a.default.UUID,o.sellHero.camp=this.camp,o.sellHero.heroTemplateId=e,o.sellHero.pos=t,r.FightNetwork.getInstance().Send(c.FIGHT_CLIENT_ENUM.P_Fight_Sell_Hero_SYNC,o),console.log("HHHHHHHHHHHHHHHHHHH fightserver sendHeroSellToServer heroTemplateId"+e)}},t.sendSliverToServer=function(e,t,o){if(i.default.getCombatType()!=i.CombatType.PVE){var n=new c.C_Fight_Silver_SYNC;if(this.camp==R.myPlayer)n.roleID=a.default.UUID;else{var s=i.default.getMatchBattleInfo(!1);n.roleID=s.roleID}n.silver=new c.T_Fight_Silver_Struct,n.silver.Silver=this.getCurMoney(),n.silver.SilverChange=100*e,n.silver.type=o,n.silver.SilverChangeType=t,r.FightNetwork.getInstance().Send(c.FIGHT_CLIENT_ENUM.P_Fight_Silver_SYNC,n)}},t.sendBeginSilverToServer=function(){var e=this.getCurMoney(),t=new c.C_Fight_Silver_SYNC;t.roleID=a.default.UUID,t.silver=new c.T_Fight_Silver_Struct,t.silver.Silver=e,t.silver.SilverChange=0,t.silver.type=m.SP_CHANGE_TYPE.SP_CHANGE_TYPE_BEGIN,t.silver.SilverChangeType=1,r.FightNetwork.getInstance().Send(c.FIGHT_CLIENT_ENUM.P_Fight_Silver_SYNC,t)},t.sendAddBuffToServer=function(e,t,o){if(u.default.getInstance().gameState!=P.Reconnect&&i.default.getCombatType()!=i.CombatType.PVE&&(this.camp==R.myPlayer||!u.default.getInstance().isPvP())){var n=new c.C_Fight_Add_Buff_SYNC;n.roleId=a.default.UUID,n.buffType=e,n.buffId=t,n.buffDuration=o,r.FightNetwork.getInstance().Send(c.FIGHT_CLIENT_ENUM.P_Fight_Add_Buff_SYNC,n),console.log("HHHHHHHHHHHHHHHHHHH fightserver sendAddBuffToServer buffId"+t)}},t.sendRemoveBuffToServer=function(e,t){if(u.default.getInstance().gameState!=P.Reconnect&&i.default.getCombatType()!=i.CombatType.PVE&&(this.camp==R.myPlayer||!u.default.getInstance().isPvP())){var o=new c.C_Fight_Remove_Buff_SYNC;o.roleId=a.default.UUID,o.buffType=e,o.buffId=t,r.FightNetwork.getInstance().Send(c.FIGHT_CLIENT_ENUM.P_Fight_Remove_Buff_SYNC,o),console.log("HHHHHHHHHHHHHHHHHHH fightserver sendRemoveBuffToServer buffId"+t)}},t.sendCastSkillToServer=function(e,t,o,n){if(i.default.getCombatType()!=i.CombatType.PVE){var s=new c.C_Fight_Skill_SYNC;this.camp==R.myPlayer?s.roleID=a.default.UUID:s.roleID=T.default.fromNumber(this.camp),s.skillStruct.ownerType=e,s.skillStruct.skillID=t,s.skillStruct.targetVec=o,s.skillStruct.randomResultVec=n,r.FightNetwork.getInstance().Send(c.FIGHT_CLIENT_ENUM.P_Fight_Skill_SYNC,s)}},t.onHandleSkillSync=function(e){var t=new c.S_Fight_Skill_SYNC,o=(t=e).skillStruct.ownerType,i=t.skillStruct.skillID,a=t.skillStruct.randomResultVec[0],n=(t.skillStruct.randomResultVec[1],t.skillStruct.randomResultVec[2]);if(1==o){var r=u.default.getInstance().getCarByCamp(this.camp);if(r){var s=r.getHeroObjById(a);if(s&&s.pSkillObjList&&s.pSkillObjList[i]){var l=u.default.getInstance().getCarByCamp(R.myPlayer);if(l)for(var d in t.skillStruct.targetVec){var h=t.skillStruct.targetVec[d],p=l.getHeroObjById(h);p&&s.pSkillObjList[i].doSkill(p)}}}}else if(2==o){var f=u.default.getInstance().getCarByCamp(this.camp);if(f){var m=f.getHeroObjById(a);if(m){var _=this.getHeroSummonId(this.camp,a);u.default.getInstance().summon(n,m.getLevel(),this.camp,50,0,!0,m.starAttParam,m.starHpParam,_);var y=u.default.getInstance().getNpcById(_);y&&y.setTheSummonerInfo(a,!0,(0,g.getRoleIdentity)(this.camp)),m.summonMonsterCount++}}}},t.saveBehaviorRecord=function(){},t.getCarRefreshCount=function(){return this.carRefreshCount},t.getCardIdVec=function(){return this.cardIdVec},t.setCarRefreshCount=function(e){this.carRefreshCount=e},t.setCardIdVec=function(e){this.cardIdVec=e},t.checkElfCardCondition=function(e){return u.default.getInstance().getCarByCamp(e)?(n.ClientNetwork.getInstance().pushLocalMessage(s.LOCAL_MESSAGE.LocalMsg_BuyFightCard,this.camp),1):-1},t.getHeroOnCarNum=function(){var e=u.default.getInstance().getCarByCamp(this.camp);return e?e.getHeroNum()-e.getEngineerNum():0},t.onActionFireWork=function(e,t,o,i){var a=new cc.Node("elfNode");a.parent=u.default.getInstance().getController().mapNode,a.addComponent(sp.Skeleton),a.x=a.parent.width/2,a.y=a.parent.height/2+90,a.scale=.8;var r=l.default.getInstance().getHeroConfig(e),c=l.default.getInstance().getNpcTemplateConfig(r.npc_id,1).res_id;cc.resources.load(l.default.getInstance().getResConfig(c).animation,sp.SkeletonData,function(e,t){if(e)S.default.error("load elfNode err:"+e.message);else if(cc.isValid(a)){var o=a.getComponent(sp.Skeleton);o&&(o.skeletonData=t,o.setSkin("default"),o.setAnimation(0,"idle",!0),d.default.playAudioEffect("combat/audio/animation/skill_qiu"),cc.tween(a).delay(.5).call(function(){a.destroy();var e=new cc.Node("elfNodeFireWork");e.parent=u.default.getInstance().getController().mapNode,e.addComponent(sp.Skeleton),e.x=e.parent.width/2,e.y=e.parent.height/2+150,e.scale=1,cc.resources.load(l.default.getInstance().getResConfig(4e4).animation,sp.SkeletonData,function(t,o){if(t)S.default.error("load elfNode err:"+t.message);else if(cc.isValid(e)){var i=e.getComponent(sp.Skeleton);i&&(i.skeletonData=o,i.setSkin("default"),i.setAnimation(0,"idle",!0),d.default.playAudioEffect("combat/audio/animation/skill_qiu"),i.setCompleteListener(function(t){"idle"===(t.animation?t.animation.name:"")&&e.destroy()}))}})}).start())}}),0!=o||i||n.ClientNetwork.getInstance().pushLocalMessage(s.LOCAL_MESSAGE.LocalMsg_BuyFightCard,this.camp)},t.onActionElf=function(e,t,o,i,a){var r=u.default.getInstance().getCarByCamp(this.camp);if(!r)return-1;var c=null,h=l.default.getInstance().getHeroConfig(e);if(this.carInfo.tbHeroList[e])(c=this.carInfo.tbHeroList[e].elfHeroObj).node.x=u.default.getInstance().getController().mapNode.width/2,c.node.y=u.default.getInstance().getController().mapNode.height/2+90,c.node.scale=.8,c.node.active=!0;else{var p=this.getHeroCardLevel(e,a);this.carInfo.tbHeroList[e]={id:d.default.getInstance().genId(),templateId:e,starLevel:1,pos:100+e,npcTemplateId:h.npc_id,level:p};var f=r.addHero(this.carInfo.tbHeroList[e]);this.carInfo.tbHeroList[e].elfHeroObj=f,f&&(c=f)}if(c){if(t){var g=t.node.convertToWorldSpaceAR(cc.v2(0,0));g=c.node.parent.convertToNodeSpaceAR(g),cc.tween(c.node).delay(.5).parallel(cc.tween().to(.25,{position:g}),cc.tween().to(.25,{scale:.25})).call(function(){if(c.node.active=!1,c.pSkillObjList)for(var e in c.pSkillObjList)c.pSkillObjList[e]&&c.pSkillObjList[e].doSkill()}).start()}else cc.tween(c.node).delay(.5).call(function(){if(c.node.active=!1,c.pSkillObjList)for(var e in c.pSkillObjList)c.pSkillObjList[e]&&c.pSkillObjList[e].doSkill()}).start();0!=o||i||n.ClientNetwork.getInstance().pushLocalMessage(s.LOCAL_MESSAGE.LocalMsg_BuyFightCard,this.camp)}},t.onUseDropCard=function(e,t){switch(e){case L.huanElf:this.onRoleChangeEquip(e,t)}},t.onRoleChangeEquip=function(e,t){var o=function(e){var o=0;return i.default.getMatchBattleInfo(!0).heros.forEach(function(i){t?i.heroID==L.rainbowElf&&(o=i.heroLevel):i.heroID==e&&(o=i.heroLevel)}),o}.call(this,e);if(1!=u.default.getInstance().getSelfCombatModel().checkUpstarProb(e,0,t)){var n=i.default.getMatchBattleInfo(!1);if(n&&1==n.bRobot){var s=null,l=null;if(u.default.getInstance().isCoop()?s=u.default.getInstance().getPlayerModelByCamp(R.myPlayer):(s=u.default.getInstance().getPlayerModelByCamp(R.myPlayer),l=u.default.getInstance().getPlayerModelByCamp(R.opponents)),s){var d=u.default.getInstance().getSelfCombatModel().onGetRandomEquip(R.myPlayer);u.default.getInstance().getSelfCombatModel().onElfModifyEquip(e,null,d,!1)}if(o>=15&&l){var h=u.default.getInstance().getSelfCombatModel().onGetRandomEquip(R.opponents);l.onElfModifyEquip(e,null,h,!1)}}else{var p=new c.C_Fight_Operate_Equip_SYNC;if(p.carId=e,p.roleId=a.default.UUID,u.default.getInstance().isCoop()){var f=i.default.getMatchBattleInfo(!1);i.default.matchRoleIdentity==A.away&&(p.roleId=f.roleID)}p.operateType=c.OPERATE_TYPE.OPERATE_TYPE_CHANGE_EQUIP1,o>=15&&(p.operateType=c.OPERATE_TYPE.OPERATE_TYPE_CHANGE_EQUIP2,u.default.getInstance().isCoop()&&!u.default.getInstance().isSkyCastle()&&(p.operateType=c.OPERATE_TYPE.OPERATE_TYPE_CHANGE_EQUIP1)),r.FightNetwork.getInstance().Send(c.FIGHT_CLIENT_ENUM.P_Fight_Operate_Equip_SYNC,p)}}else u.default.getInstance().getSelfCombatModel().onElfModifyEquip(e,null,e,!0)},t.onAllRoleChangeEquip=function(e){var t=i.default.getMatchBattleInfo(!1);if(t&&1==t.bRobot){var o=null,n=null;if(u.default.getInstance().isCoop()?o=u.default.getInstance().getPlayerModelByCamp(R.myPlayer):(o=u.default.getInstance().getPlayerModelByCamp(R.myPlayer),n=u.default.getInstance().getPlayerModelByCamp(R.opponents)),o){var s=u.default.getInstance().getSelfCombatModel().onGetRandomEquip(R.myPlayer);u.default.getInstance().getSelfCombatModel().onElfModifyEquip(e,null,s,!1)}if(n){var l=u.default.getInstance().getSelfCombatModel().onGetRandomEquip(R.opponents);n.onElfModifyEquip(e,null,l,!1)}}else{var d=new c.C_Fight_Operate_Equip_SYNC;if(d.carId=e,d.roleId=a.default.UUID,u.default.getInstance().isCoop()){var h=i.default.getMatchBattleInfo(!1);i.default.matchRoleIdentity==A.away&&(d.roleId=h.roleID)}d.operateType=c.OPERATE_TYPE.OPERATE_TYPE_CHANGE_EQUIP2,u.default.getInstance().isCoop()&&(d.operateType=c.OPERATE_TYPE.OPERATE_TYPE_CHANGE_EQUIP1),r.FightNetwork.getInstance().Send(c.FIGHT_CLIENT_ENUM.P_Fight_Operate_Equip_SYNC,d)}},t.sendHeroLvDownToServer=function(e){if(i.default.getCombatType()!=i.CombatType.PVE){var t=new c.C_Fight_Operate_Equip_SYNC;t.roleId=a.default.UUID,t.carId=i.default.matchRoleIdentity,t.target=e,t.operateType=c.OPERATE_TYPE.OPERATE_TYPE_HERO_LVDOWN,r.FightNetwork.getInstance().Send(c.FIGHT_CLIENT_ENUM.P_Fight_Operate_Equip_SYNC,t),console.log("HHHHHHHHHHHHHHHHHHH fightserver sendHeroLvDownToServer heroTemplateId"+e)}},t.onListenMessage=function(){var e=this;n.ClientNetwork.getInstance().listenLocalMessage(s.LOCAL_MESSAGE.LocalMsg_CheatValue,function(t){t[0]==R.myPlayer&&e.combatStatistic.countHeroDamage(t[0],t[1],999999999)})},t.onStatisticHeroLvUp=function(e){f.default._Instance.getGuideStatus()||this.combatStatistic.countHeroLvUp(this.camp,e)},t.onGetSpiritLv=function(e){var t=this.combatStatistic.getHeroLv(this.camp,e);return t>4&&(t=4),t},t.sendCardClearToServer=function(){var e=new c.C_Fight_Refresh_Card_Count_SYNC;e.roleID=a.default.UUID,e.refreshNum=u.default.getInstance().getSelfCombatModel().getCarRefreshCount(),e.cardIdVec=[],u.default.getInstance().getSelfCombatModel().setCardIdVec(e.cardIdVec),r.FightNetwork.getInstance().Send(c.FIGHT_CLIENT_ENUM.P_Fight_Refresh_Card_Count_SYNC,e)},t.setChangeSpritPR=function(e){this.changeSpritPR.value=e},t.getChangeSpritPR=function(){return this.changeSpritPR.value},t.setChangeSpritRS=function(e){-1!=e?(this.changSpritRS||(this.changSpritRS=new C.RandomSeed),this.changSpritRS.RandomSeed(e)):this.changSpritRS=null},t.setBossChangeSpritPR=function(e){this.bossChangeSpritPR.value=e},t.getBossChangeSpritPR=function(){return this.bossChangeSpritPR.value},t.setBossChangeSpritRS=function(e){-1!=e?(this.bossChangSpritRS||(this.bossChangSpritRS=new C.RandomSeed),this.bossChangSpritRS.RandomSeed(e)):this.bossChangSpritRS=null},t.useRainbowElf=function(e,t,o){var a=u.default.getInstance().getCarByCamp(this.camp);if(!a)return-1;var r=null,c=l.default.getInstance().getHeroConfig(e),d=this.combatStatistic.getHeroLv(this.camp,e);i.default.matchType==m.FIGHT_TYPE.FIGHT_TYPE_BATTLE_GREAT_SAILING&&(d=this.combatStatistic.refreshTimes);var h=this.getHeroCardLevel(e);this.carInfo.tbHeroList[e]={id:e,templateId:e,starLevel:1,pos:100+e,npcTemplateId:c.npc_id,level:h};var p=a.addHero(this.carInfo.tbHeroList[e]);this.carInfo.tbHeroList[e].elfHeroObj=p,p&&(r=p),r&&(cc.tween(r.node).delay(.3).call(function(){r.node.active=!1;var e=new cc.Node("elfNodeRaindow");e.parent=u.default.getInstance().getController().mapNode,e.addComponent(sp.Skeleton),e.x=e.parent.width/2,e.y=e.parent.height/2+150,e.scale=1,cc.resources.load(l.default.getInstance().getResConfig(220).animation,sp.SkeletonData,function(o,i){if(o)S.default.error("load elfNode err:"+o.message);else if(cc.isValid(e)){var a=e.getComponent(sp.Skeleton);a&&(a.skeletonData=i,a.setSkin("default"),a.setAnimation(0,"idle",!0),a.setCompleteListener(function(o){if("idle"===(o.animation?o.animation.name:"")&&(e.destroy(),!t&&r.pSkillObjList))for(var i in r.pSkillObjList)r.pSkillObjList[i]&&(r.pSkillObjList[i].randomSeed.RandomSeed(d),r.pSkillObjList[i].doSkill())}))}})}).start(),0!=t||o||n.ClientNetwork.getInstance().pushLocalMessage(s.LOCAL_MESSAGE.LocalMsg_BuyFightCard,this.camp))},t.isChangeSprit=function(e){var t=this.getChangeSpritPR(),o=this.getBossChangeSpritPR();if(0==t&&0==o)return!1;if(e==L.guangElf&&this.getHeroCardLevel(e)>=18)return!1;if(e!=L.fireworkElf){if(this.changSpritRS&&Math.floor(100*this.changSpritRS.getRandom())+1<Number(t))return!0;if(this.bossChangSpritRS&&Math.floor(100*this.bossChangSpritRS.getRandom())+1<Number(o))return!0}return!1},t.setEquipInvaild=function(e){if(this.equipInvaildState!=e){this.equipInvaildState=e;var t=u.default.getInstance().getController()._downPrefabNode;t&&((this.camp==R.myPlayer||this.camp==R.coopPlayer?t.getChildByName("EquipBag").getChildByName("invalid"):t.getChildByName("EquipBag_b").getChildByName("invalid")).active=e);var o=i.default.getDropEquipList();if(o[this.camp]){var a=null,n=0;o[this.camp].forEach(function(e){e&&n<e.equipStar&&(n=e.equipStar,a=e)}),a&&e?a.destroy():a&&!e&&a.onReconnectInit(a.equipId,a.camp,a.equipStar)}}},t.getEquipInvaildState=function(){return this.equipInvaildState},t.setSliverInvalid=function(e){this.sliverInvaildState!=e&&(this.sliverInvaildState=e)},t.getSliverInvalidState=function(){return this.sliverInvaildState},t.setSellSliverInvalid=function(e){this.sellSliverInvaildState!=e&&(this.sellSliverInvaildState=e)},t.getSellSliverInvalidState=function(){return this.sellSliverInvaildState},t.selfCarUpStar=function(e,t,o){var i=this;t||(o=!0);var a=new cc.Node("elfNode");a.parent=u.default.getInstance().getController().mapNode,a.addComponent(sp.Skeleton),a.x=a.parent.width/2,a.y=a.parent.height/2+90,a.scale=.8;var n=l.default.getInstance().getHeroConfig(e),r=l.default.getInstance().getNpcTemplateConfig(n.npc_id,1).res_id,s=!1;o||(t.setCarUpgradeState(!0),this.carInfo.level++,this.carInfo.level>E&&(this.carInfo.level=E,s=!0)),cc.resources.load(l.default.getInstance().getResConfig(r).animation,sp.SkeletonData,function(e,n){if(e)S.default.error("load elfNode err:"+e.message);else if(cc.isValid(a)){var r=a.getComponent(sp.Skeleton);if(r){if(r.skeletonData=n,r.setSkin("default"),r.setAnimation(0,"idle",!0),d.default.playAudioEffect("combat/audio/animation/skill_qiu"),!t)return void setTimeout(function(){a.destroy()},500);var c=t.node.convertToWorldSpaceAR(cc.v2(0,0));c=a.parent.convertToNodeSpaceAR(c),cc.tween(a).delay(.5).parallel(cc.tween().to(.25,{position:c}),cc.tween().to(.25,{scale:.25})).call(function(){if(a.destroy(),!t)return a.destroy();o||s||(cc.director.emit("Event_carLvUp",i.camp),t.refreshLevel(i.carInfo.level),u.default.getInstance().getController()&&u.default.getInstance().getController().fightCardViewScript.refCarInfo(),i.saveBehaviorRecord("CarUp"))}).start()}}})},t.getHeroCardLevel=function(e,t){void 0===t&&(t=!1);var o=1,i=Number(e);if(t&&(i=Number(L.rainbowElf)),this.camp==R.myPlayer)o=a.default.getHeroCarData()[i].heroLevel;else{var n=(0,g.getMatchPlayerCard)(i,this.camp);n&&(o=n.heroLevel)}return o},t.recordSliverChange=function(e,t){if(void 0===t&&(t=!0),this.sliverChangeOnOff&&(e>0&&this.sliverChangeVec.push(e),this.sliverChangeVec.length>=50||!t)){var o="sp:";for(var i in this.sliverChangeVec)o+=Math.floor(100*this.sliverChangeVec[i])/100,o+="_";I.default.callRoleClientLog(o),this.sliverChangeVec=[]}},e}();o.default=k,t.exports=o.default,cc._RF.pop()},{"../common/CombatModule":"CombatModule","../common/EventConst":"EventConst","../common/NetworkProtocolCommon":"NetworkProtocolCommon","../common/PlayerModule":"PlayerModule","../controller/Guide/GuideController":"GuideController","../modules/manager/EventManager":"EventManager","../modules/manager/cheat/CheatValue":"CheatValue","../modules/manager/cheat/SafeNumber":"SafeNumber","../network/ClientNetwork":"ClientNetwork","../network/FightNetwork":"FightNetwork","../network/LocalMessage":"LocalMessage","../network/protocol/FightProtocols":"FightProtocols","../network/protocol/TypeProtocols":"TypeProtocols","../network/protocol/long":"long","../utils/ConfigUtils":"ConfigUtils","../utils/ConstValue":"ConstValue","../utils/Debug":"Debug","../utils/GameTools":"GameTools","../utils/GameUtils":"GameUtils","../utils/RandomSeed":"RandomSeed","../utils/Tools":"Tools","./CombatManager":"CombatManager","./CombatStatistic":"CombatStatistic"}],PlayerHeadView:[function(e,t,o){"use strict";cc._RF.push(t,"327eaBGl9ZFzpFwmPrhRUqF","PlayerHeadView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../Global/GameGlobal"),s=e("../../modules/base/BaseView"),c=e("../../modules/base/Decorators"),l=e("../../utils/GameTools"),d=e("../../utils/ConfigUtils"),u=e("../../common/PlayerModule"),h=e("../../utils/LogUtil"),p=e("../../modules/manager/LoadResManager"),f=e("../../network/ClientNetwork"),g=e("../../StaticData/StringValueTableData"),m=e("../../network/protocol/RoleProtocols"),_=e("../../modules/base/GameView"),y=e("../../network/protocol/TypeProtocols"),v=e("../../utils/GameUtils"),C=e("../../utils/GamePlatform"),S=e("../../network/LocalMessage"),T=e("../../StaticData/PetTableData"),I=e("../../common/EventConst"),N=e("../../modules/manager/EventManager"),b=e("../../StaticData/PetPrizeTableData"),w=cc._decorator,E=w.ccclass,P=w.property,R=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.headScroll=null,t.headPrefab=null,t.frameScroll=null,t.framePrefab=null,t.changeHeadNode=null,t.changeFrameNode=null,t.changeMapNode=null,t.changeMapItemNode=null,t.petScroll=null,t.petPrefab=null,t.changePetNode=null,t.petInfo=null,t.petInfo2=null,t}return a(t,e),t.path=function(){return"ui/playerInfo/changeIcon"},t.prototype.onLoad=function(){var e=this;this.changeHeadNode.opacity=0,this.changeFrameNode.opacity=0,this.changePetNode.opacity=0,this.changeMapNode.opacity=0,this.node.getChildByName("playerinfo_listbg").active=!1,this.node.getChildByName("playerinfo_frame_listbg").active=!1,this.node.getChildByName("playerinfo_pet_listbg").active=!1,this.changeHeadNode.on(cc.Node.EventType.TOUCH_END,function(){e.onClickChangeHead()}),this.changeFrameNode.on(cc.Node.EventType.TOUCH_END,function(){e.onClickChangeHeadFrame()}),this.changePetNode.on(cc.Node.EventType.TOUCH_END,function(){e._redpoint_pet.active=!1,u.default.setPetRedDot(!1),f.ClientNetwork.getInstance().pushLocalMessage(S.LOCAL_MESSAGE.LocalMsg_RefreshPetRedDot),e.onClickChangePet()}),this._redpoint_pet=this.node.getChildByName("redpoint_pet"),this._redpoint_pet.active=u.default.getPetRedDot(),this._btn_tips_pet=this.node.getChildByName("playerinfo_pet_listbg").getChildByName("TipsButton"),this._tips_pet=this.node.getChildByName("playerinfo_pet_listbg").getChildByName("tips"),this._clickNode_pet=this._tips_pet.getChildByName("clickNode"),this._tips_pet.active=!1,this._btn_tips_pet.on(cc.Node.EventType.TOUCH_END,function(){e._tips_pet.active=!0}),this._clickNode_pet.on(cc.Node.EventType.TOUCH_END,function(){e._tips_pet.active=!1}),this.changeMapNode.on(cc.Node.EventType.TOUCH_END,function(){e.onClickMapTabCallBack()}),this.node.getChildByName("redpoint_map").active=u.default.getMainMapSkinRedpoint()},t.prototype.start=function(){this.changeHeadNode.opacity=255,this.node.getChildByName("playerinfo_listbg").active=!0,this.initHeadInfo(),this.initHeadFrameInfo(),this.initPetInfo(),this.onListenProtocol(),this.initMapList()},t.prototype.initHeadInfo=function(){var e=this;this.headPrefab.active=!1;var t=[];C.GamePlatform.isWechat()&&u.default.checkModulerOnOffState(30)&&(t=[{id:0,bUrlHead:!0}]);var o=d.default.getInstance().data["StaticData/ItemTableData"];for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&4===o[i].type&&t.push(o[i]);var a=Math.ceil(t.length/5),n=Math.floor(this.headPrefab.height*this.headPrefab.scale)+this.headScroll.content.getComponent(cc.Layout).spacingY;this.headScroll.content.height=n*a+this.headScroll.content.getComponent(cc.Layout).spacingY,this._haveHeadArr=[],u.default.getRoleBagItems().forEach(function(t){t&&4===d.default.getInstance().getItemByID(t.itemId).type&&e._haveHeadArr.push(t)});var r=function(t){var o=null;return e._haveHeadArr.forEach(function(e){e.itemId===t&&(o=e)}),o};t.forEach(function(t){if(t.bUrlHead)t.bHave=1;else{var o=r.call(e,t.id);t.bHave=o?1:0}}),t.sort(function(e,t){return t.bHave-e.bHave}),l.default.startFraming(t.length,function(o){e.createHeadNode(t[o])})},t.prototype.canShowHeadFrame=function(e){return null!=e&&5==e.type&&(v.getItemTotalNumByItemId(e.id)>0||!(Number(e.source)<0)&&!(Number(e.source)>0&&u.default.getCurSeasonData().seasonID>Number(e.source)))},t.prototype.initHeadFrameInfo=function(){var e=this;this.framePrefab.active=!1;var t=[],o=d.default.getInstance().data["StaticData/ItemTableData"];for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&5===o[i].type&&this.canShowHeadFrame(o[i])&&t.push(o[i]);var a=Math.ceil(t.length/5),n=Math.floor(this.framePrefab.height*this.framePrefab.scale)+this.frameScroll.content.getComponent(cc.Layout).spacingY;this.frameScroll.content.height=n*a+this.frameScroll.content.getComponent(cc.Layout).spacingY;var r=[];u.default.getRoleBagItems().forEach(function(e){e&&5===d.default.getInstance().getItemByID(e.itemId).type&&r.push(e)});var s=function(e){var t=null;return r.forEach(function(o){o.itemId===e&&(t=o)}),t};t.forEach(function(t){var o=s.call(e,t.id);o?(t.bHave=1,t.itemUUID=o.itemUUID):t.bHave=0}),t.sort(function(e,t){return t.bHave!=e.bHave?e.bHave<t.bHave?1:-1:e.quality!=t.quality?e.quality<t.quality?1:-1:e.id<t.id?-1:void 0}),l.default.startFraming(t.length,function(o){e.createHeadFrameNode(t[o])})},t.prototype.createHeadFrameNode=function(e){var t=this,o=cc.instantiate(this.framePrefab);o.active=!0,o.parent=this.frameScroll.content,o.describe=e.desc,p.default.loadSpriteFrame(d.default.getInstance().getItemByID(e.id).icon).then(function(t){if(o.getComponent(cc.Sprite).spriteFrame=t,1==e.bHave){o.itemUUID=e.itemUUID,o.HeadFrameId=e.id;var i=u.default.getRoleAttrValByKey(y.ROLE_ATTR_VALUES.ROLE_ATTR_HEADFRAMEID);e.id==i&&(o.getChildByName("select").active=!0)}else l.default.setNodeBright(o,!1)}).catch(function(e){h.default.info(e)}),o.on(cc.Node.EventType.TOUCH_END,function(e){if(!e.target.itemUUID)return r.G.StringManager.PopString(e.target.describe);t.onRequestRoleHeadFrameUp(e)})},t.prototype.onClickChangeHead=function(){this.node.getChildByName("playerinfo_listbg").active=!0,this.node.getChildByName("playerinfo_frame_listbg").active=!1,this.node.getChildByName("playerinfo_pet_listbg").active=!1,this.node.getChildByName("playerinfo_map_listbg").active=!1,this.changeHeadNode.opacity=255,this.changeFrameNode.opacity=0,this.changePetNode.opacity=0,this.changeMapNode.opacity=0},t.prototype.onClickChangeHeadFrame=function(){this.node.getChildByName("playerinfo_listbg").active=!1,this.node.getChildByName("playerinfo_frame_listbg").active=!0,this.node.getChildByName("playerinfo_pet_listbg").active=!1,this.node.getChildByName("playerinfo_map_listbg").active=!1,this.changeHeadNode.opacity=0,this.changeFrameNode.opacity=255,this.changePetNode.opacity=0,this.changeMapNode.opacity=0},t.prototype.createHeadNode=function(e){var t=this,o=cc.instantiate(this.headPrefab);o.active=!0,o.parent=this.headScroll.content;var i=function(e){var o=null;return t._haveHeadArr.forEach(function(t){t.itemId===e&&(o=t)}),o};if(e.bUrlHead){o.HeadId=e.id,C.GamePlatform.isWechat()&&v.setRemoteHeadIcon(u.default.getHeadUrl(),e.id,o.getChildByName("icon").getComponent(cc.Sprite));var a=u.default.getRoleAttrValByKey(y.ROLE_ATTR_VALUES.ROLE_ATTR_HEADID);e.id==a&&(o.getChildByName("select").active=!0)}else p.default.loadSpriteFrame(d.default.getInstance().getItemByID(e.id).icon).then(function(a){o.getChildByName("icon").getComponent(cc.Sprite).spriteFrame=a;var n=i.call(t,e.id);if(n){o.itemUUID=n.itemUUID,o.HeadId=e.id;var r=u.default.getRoleAttrValByKey(y.ROLE_ATTR_VALUES.ROLE_ATTR_HEADID);e.id==r&&(o.getChildByName("select").active=!0)}else l.default.setNodeBright(o,!1)}).catch(function(e){h.default.info(e)});o.on(cc.Node.EventType.TOUCH_END,function(e){if(0!=e.target.HeadId)return e.target.itemUUID?void t.onRequestRoleHeadUp(e):r.G.StringManager.PopString(g.StringValueTableData.getById(14).string_value);t.onRequestRoleUrlHead(e)})},t.prototype.onRequestRoleHeadUp=function(e){var t=new m.C_Role_HeadUp;t.itemUUID=e.target.itemUUID,f.ClientNetwork.getInstance().Send(m.ROLE_CLIENT_ENUM.P_Role_HeadUp,t)},t.prototype.onRequestRoleUrlHead=function(){var e=new m.C_Role_SetUrlHead;e.IsUseUrl=!0,e.headUrl=u.default.getHeadUrl(),f.ClientNetwork.getInstance().Send(m.ROLE_CLIENT_ENUM.P_Role_SetUrlHead,e)},t.prototype.onRequestRoleHeadFrameUp=function(e){var t=new m.C_Role_HeadFrameUp;t.itemUUID=e.target.itemUUID,f.ClientNetwork.getInstance().Send(m.ROLE_CLIENT_ENUM.P_Role_HeadFrameUp,t)},t.prototype.onListenProtocol=function(){var e=this;f.ClientNetwork.getInstance().listenProtocol(m.ROLE_CLIENT_ENUM.P_Role_HeadUp,function(t){t.resetPos();var o=new m.S_Role_HeadUp;if(o.read(t))if(0===o.errorcode){e.closeView();var i=_.default.getViewByName("PlayerInfoView");i&&i.view&&i.view.onRefreshPlayerHead();var a=_.default.getViewByName("MainSceneView");a&&a.view&&a.view.onShowPlayerHead()}else h.default.info(o)},this),f.ClientNetwork.getInstance().listenProtocol(m.ROLE_CLIENT_ENUM.P_Role_SetUrlHead,function(t){t.resetPos();var o=new m.S_Role_SetUrlHead;if(o.read(t))if(0===o.errorcode){e.closeView();var i=_.default.getViewByName("PlayerInfoView");i&&i.view&&i.view.onRefreshPlayerHead();var a=_.default.getViewByName("MainSceneView");a&&a.view&&a.view.onShowPlayerHead()}else h.default.info(o)},this),f.ClientNetwork.getInstance().listenProtocol(m.ROLE_CLIENT_ENUM.P_Role_HeadFrameUp,function(t){t.resetPos();var o=new m.S_Role_HeadFrameUp;if(o.read(t))if(0===o.errorcode){e.closeView();var i=_.default.getViewByName("PlayerInfoView");i&&i.view&&i.view.onRefreshPlayerHeadFrame();var a=_.default.getViewByName("MainSceneView");a&&a.view&&a.view.onShowPlayerHeadFrame()}else h.default.info(o)},this),f.ClientNetwork.getInstance().listenProtocol(m.ROLE_CLIENT_ENUM.P_Role_PetUp,function(t){t.resetPos();var o=new m.S_Role_PetUp;o.read(t)&&0===o.errorcode&&(e.initPetInfo(),f.ClientNetwork.getInstance().pushLocalMessage(S.LOCAL_MESSAGE.LocalMsg_Refresh_pet))},this),f.ClientNetwork.getInstance().listenProtocol(m.ROLE_CLIENT_ENUM.P_Role_ItemMapSkinUp,function(t){t.resetPos();var o=new m.S_Role_ItemMapSkinUp;if(o.read(t))if(0===o.errorcode){e.closeView();var i=_.default.getViewByName("PlayerInfoView");i&&i.view&&i.view.closeView(),N.default.Instance.emit(I.default.ChangeMainSceneEvent)}else r.G.StringManager.PopString("S_Role_ItemMapSkinUp ERROR "+o.errorcode)},this)},t.prototype.onDestroy=function(){f.ClientNetwork.getInstance().removeMessageTarget(this)},t.prototype.onClickChangePet=function(){this.node.getChildByName("playerinfo_listbg").active=!1,this.node.getChildByName("playerinfo_frame_listbg").active=!1,this.node.getChildByName("playerinfo_pet_listbg").active=!0,this.node.getChildByName("playerinfo_map_listbg").active=!1,this.changeHeadNode.opacity=0,this.changeFrameNode.opacity=0,this.changePetNode.opacity=255,this.changeMapNode.opacity=0,this._tips_pet.active=!1},t.prototype.initPetInfo=function(){var e=this;this.petScroll.content.removeAllChildren(),this.petPrefab.active=!1;var t=[],o=d.default.getInstance().data["StaticData/ItemTableData"];for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&10===o[i].type&&t.push(o[i]);var a=Math.ceil(t.length/5),n=Math.floor(this.petPrefab.height*this.petPrefab.scale)+this.petScroll.content.getComponent(cc.Layout).spacingY;this.petScroll.content.height=n*a+this.petScroll.content.getComponent(cc.Layout).spacingY;var r=[];u.default.getRoleBagItems().forEach(function(e){null!=e&&10===d.default.getInstance().getItemByID(e.itemId).type&&r.push(e)});var s=function(e){var t=null;return r.forEach(function(o){o.itemId===e&&(t=o)}),t};t.forEach(function(t){var o=s.call(e,t.id);o?(t.bHave=1,t.itemUUID=o.itemUUID):t.bHave=0}),t.sort(function(e,t){return t.bHave-e.bHave}),l.default.startFraming(t.length,function(o){e.createPetNode(t[o])});var c=u.default.getRoleAttrValByKey(y.ROLE_ATTR_VALUES.ROLE_ATTR_PETID);this.showSelectPetInfo(c)},t.prototype.showSelectPetInfo=function(e,t){void 0===t&&(t=-1);var o=e,i=this.petInfo.getChildByName("petLabel").getComponent(cc.Label),a=this.petInfo.getChildByName("cupLabel").getComponent(cc.Label),n=this.petInfo.getChildByName("txt_name").getComponent(cc.Label),r=this.petInfo.getChildByName("jiangbei");if(100==o)i.string="\u65e0",a.string="",n.string="\u672a\u4f69\u6234\u4fe1\u4f7f\uff1a",r.active=!1;else{i.string="\u4f69\u6234\u8be5\u4fe1\u4f7f\u83b7\u80dc\u540e";var s=this.getPetAddCupNum(o);a.string="+"+s;var c=d.default.getInstance().getItemByID(o);n.string=c.name+"\uff1a",r.active=!0}var l=this.petInfo2.getChildByName("txt_desc").getComponent(cc.Label),u=this.petInfo2.getChildByName("icon").getComponent(cc.Sprite),h=this.petInfo2.getChildByName("txt_num").getComponent(cc.Label);if(100==o)l.string="\u65e0",u.spriteFrame=null,h.string="";else{var f=t;t<=0&&(f=this.getPetLevelById(o));var g=1e3*o+f,m=b.PetPrizeTableData.getById(g);if(null!=m){l.string=m.desc;var _=m.prize[0],y=d.default.getInstance().getDorpItemsByID(_.dropID);if(y){var v=y.dropRandom.split("#")[0];(c=d.default.getInstance().getItemByID(v))&&(p.default.loadSpriteFrame(c.icon).then(function(e){u.spriteFrame=e}).catch(function(e){console.log("PlayerHeadView, initPetInfo, load pet passive icon error=",e)}),3==c.type&&(y=d.default.getInstance().getDorpItemsByID(v))),h.string="X"+y.dropRandom.split("#")[2]}}else console.log("PlayerHeadView, initPetInfo, petPrizeTable is null!! selectedId="+o+",level="+f)}},t.prototype.createPetNode=function(e){var t=this,o=cc.instantiate(this.petPrefab);o.active=!0,o.parent=this.petScroll.content,o.describe=e.desc,p.default.loadSpriteFrame(d.default.getInstance().getItemByID(e.id).icon).then(function(i){if(o.getChildByName("icon").getComponent(cc.Sprite).spriteFrame=i,1==e.bHave){o.itemUUID=e.itemUUID,o.PetId=e.id;var a=u.default.getRoleAttrValByKey(y.ROLE_ATTR_VALUES.ROLE_ATTR_PETID);e.id==a&&(o.getChildByName("select").active=!0,t.lastSelectPetNode=o)}else l.default.setNodeBright(o,!1)}).catch(function(e){h.default.info(e)});var i=this.getPetLevelById(e.id);1==e.bHave&&e.id>100?o.getChildByName("level").getComponent(cc.Label).string="Lv"+i:o.getChildByName("level").getComponent(cc.Label).string="",o.on(cc.Node.EventType.TOUCH_END,function(o){o.target.itemUUID||r.G.StringManager.PopString(o.target.describe),1==e.bHave?t.onRequestPetUp(o):(null!=t.lastSelectPetNode&&(t.lastSelectPetNode.getChildByName("select").active=!1),t.lastSelectPetNode=o.target,t.lastSelectPetNode.getChildByName("select").active=!0,t.showSelectPetInfo(e.id,1))})},t.prototype.onRequestPetUp=function(e){var t=new m.C_Role_PetUp;t.itemUUID=e.target.itemUUID,f.ClientNetwork.getInstance().Send(m.ROLE_CLIENT_ENUM.P_Role_PetUp,t)},t.prototype.getPetLevelById=function(e){var t=v.getItemTotalNumByItemId(e);if(console.log("PlayerHeadView, getPetLevelById, petId="+e+", num="+t),t>0){var o=parseInt(v.getConfigIntValue("pet_level_max"));return t>o?o:t}return 1},t.prototype.getPetAddCupNum=function(e){var t=3,o=T.PetTableData.getById(e),i=this.getPetLevelById(e);return null!=o&&i>0&&(t=o.addCupInit+(i-1)*o.addCupLv),t},t.prototype.onClickMapTabCallBack=function(){this.changeHeadNode.opacity=0,this.changeFrameNode.opacity=0,this.changePetNode.opacity=0,this.changeMapNode.opacity=255,this.node.getChildByName("playerinfo_listbg").active=!1,this.node.getChildByName("playerinfo_frame_listbg").active=!1,this.node.getChildByName("playerinfo_pet_listbg").active=!1,this.node.getChildByName("playerinfo_map_listbg").active=!0,this.node.getChildByName("redpoint_map").active=!1,u.default.setMainMapSkinRedpoint(!1),N.default.Instance.emit(I.default.SyncRoleItemMapSkinEvent)},t.prototype.initMapList=function(){var e=this,t=this.node.getChildByName("playerinfo_map_listbg").children[0];t.getComponent(cc.ScrollView).content.destroyAllChildren();var o=[],i=d.default.getInstance().data["StaticData/ItemTableData"];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&7===i[a].type&&o.push(i[a]);var n=function(e){var t=null;return u.default.getRoleBagItems().forEach(function(o){7===d.default.getInstance().getItemByID(o.itemId).type&&o.itemId==e&&(t=o)}),t};o.forEach(function(t){var o=n.call(e,t.id);o?(t.bHave=1,t.itemUUID=o.itemUUID):t.bHave=0}),o.sort(function(e,t){return t.bHave-e.bHave}),o.forEach(function(o){e.createMapItemNode(o).parent=t.getComponent(cc.ScrollView).content})},t.prototype.createMapItemNode=function(e){var t=this,o=cc.instantiate(this.changeMapItemNode);o.active=!0,o.describe=e.desc;var i="main_map/map_"+e.id;return p.default.loadSpriteFrame(i).then(function(t){if(o.getChildByName("mapNode").getComponent(cc.Sprite).spriteFrame=t,1==e.bHave){o.getChildByName("selectNode").active=!0,o.itemUUID=e.itemUUID,o.HeadFrameId=e.id;var i=u.default.getRoleAttrValByKey(y.ROLE_ATTR_VALUES.ROLE_ATTR_MAPSKINID);i<=0&&(i=701),o.getChildByName("selectNode").children[0].active=!1,i==e.id&&(o.getChildByName("selectNode").children[0].active=!0),o.getChildByName("suo").active=!1}else l.default.setNodeBright(o,!1),o.getChildByName("selectNode").active=!1,o.getChildByName("suo").active=!0}).catch(function(e){h.default.info(e)}),o.on(cc.Node.EventType.TOUCH_END,function(e){if(!e.target.itemUUID)return r.G.StringManager.PopString(e.target.describe);if(1!=e.target.getChildByName("selectNode").children[0].active)t.callRoleItemMapSkinUp(e.target.itemUUID);else{t.closeView();var o=_.default.getViewByName("PlayerInfoView");o&&o.view&&o.view.closeView()}}),o},t.prototype.callRoleItemMapSkinUp=function(e){var t=new m.C_Role_ItemMapSkinUp;t.itemUUID=e,f.ClientNetwork.getInstance().Send(m.ROLE_CLIENT_ENUM.P_Role_ItemMapSkinUp,t)},n([P(cc.ScrollView)],t.prototype,"headScroll",void 0),n([P(cc.Node)],t.prototype,"headPrefab",void 0),n([P(cc.ScrollView)],t.prototype,"frameScroll",void 0),n([P(cc.Node)],t.prototype,"framePrefab",void 0),n([P(cc.Node)],t.prototype,"changeHeadNode",void 0),n([P(cc.Node)],t.prototype,"changeFrameNode",void 0),n([P(cc.Node)],t.prototype,"changeMapNode",void 0),n([P(cc.Node)],t.prototype,"changeMapItemNode",void 0),n([P(cc.ScrollView)],t.prototype,"petScroll",void 0),n([P(cc.Node)],t.prototype,"petPrefab",void 0),n([P(cc.Node)],t.prototype,"changePetNode",void 0),n([P(cc.Node)],t.prototype,"petInfo",void 0),n([P(cc.Node)],t.prototype,"petInfo2",void 0),n([c.Register_Class,E],t)}(s.default);o.default=R,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/PetPrizeTableData":"PetPrizeTableData","../../StaticData/PetTableData":"PetTableData","../../StaticData/StringValueTableData":"StringValueTableData","../../common/EventConst":"EventConst","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/base/GameView":"GameView","../../modules/manager/EventManager":"EventManager","../../modules/manager/LoadResManager":"LoadResManager","../../network/ClientNetwork":"ClientNetwork","../../network/LocalMessage":"LocalMessage","../../network/protocol/RoleProtocols":"RoleProtocols","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/ConfigUtils":"ConfigUtils","../../utils/GamePlatform":"GamePlatform","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils","../../utils/LogUtil":"LogUtil"}],PlayerInfoView:[function(e,t,o){"use strict";cc._RF.push(t,"ad975x48MhAEKLhza7pI8cA","PlayerInfoView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../network/protocol/TypeProtocols"),c=e("../../utils/ConfigUtils"),l=e("../../modules/base/Decorators"),d=e("../../StaticData/StringValueTableData"),u=e("../../network/ClientNetwork"),h=e("../../common/PlayerModule"),p=e("../../modules/base/GameView"),f=e("../../utils/ResourcesManager"),g=e("../../utils/GameUtils"),m=e("../../Global/GameGlobal"),_=e("../../utils/GameUtils"),y=e("../../utils/Tools"),v=e("../../utils/GameUtils"),C=e("../../network/protocol/FriendProtocls"),S=e("../../utils/GamePlatform"),T=e("../../utils/WechatUtils"),I=e("../../utils/QQMiniGameUtils"),N=e("../../model/ServerAddrInfo"),b=e("../../network/LocalMessage"),w=e("../../common/CommandValue"),E=e("../../utils/GameTools"),P=e("../sociaty/SociatyModel"),R=e("../sociaty/SociatyCtrl"),L=e("../../common/EventConst"),A=e("../../modules/manager/EventManager"),D=e("../../utils/QQGameHallUtils"),M=e("../../StaticData/HeroSkinTableData"),B=cc._decorator,k=B.ccclass,G=B.property,O=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.headNode=null,t.headFrameNode=null,t.playerNameLab=null,t.playerUUIDLab=null,t.playerCupLab=null,t.playerWinNumLab=null,t.playerLoseNumLab=null,t.playerRateLab=null,t.playerMaxCupLab=null,t.playerMaxRoundLab=null,t.audioSwitchLab=null,t.serverGroup=null,t.vipServiceBtn=null,t.bottomLayout=null,t.subGameBtn=null,t._IsBlack=!1,t.m_goodFriendNum=0,t.m_playerName="",t.m_playerScore=0,t.m_manageJoyType=0,t}var o;return a(t,e),o=t,t.path=function(){return"ui/playerInfo/PlayerInfo"},t.prototype.onLoad=function(){var e=this,t=this.bottomLayout.node;this._addFriendBtnNode=t.getChildByName("friendApplyBtn"),this._removeFriendBtnNode=t.getChildByName("friendRemoveBtn"),this._redpoint_head=this.headNode.getChildByName("redpoint_head"),this.m_btn_invite_union=t.getChildByName("btn_invite_union"),this.m_btn_appointOroutgoing=t.getChildByName("btn_appointOroutgoing"),this.m_btn_transfer_president=t.getChildByName("btn_transfer_president"),this.m_btn_leave=t.getChildByName("btn_leave"),this.onAudioSwitchCallBack(null,null),u.ClientNetwork.getInstance().listenProtocol(C.FRIEND_CLIENT_ENUM.P_Friend_GetGoodFriend,function(e){e.resetPos();var t=new C.S_Friend_GetGoodFriend;if(t.read(e)&&0==t.errorcode){var o=Array.from(t.goodfriend.keys());this.m_goodFriendNum=o.length,this.onShowFriendBtn(t.goodfriend)}},this),u.ClientNetwork.getInstance().listenProtocol(C.FRIEND_CLIENT_ENUM.P_Friend_GetBlackList,function(e){e.resetPos();var o=new C.S_Friend_GetBlackList;if(o.read(e)&&0==o.errorcode){this.onShowBlackFriendBtn(o.blacklist),h.default.setBlackFriendsData(o.blacklist);var i=p.default.getViewByName("ChickenDinnerMainView");i&&i.view&&(t.getChildByName("chatBtn").active=!1);var a=p.default.getViewByName("NavigationMainView");a&&a.view&&(t.getChildByName("chatBtn").active=!1),p.default.getViewNodeByName("FogHiddenMainView")&&(t.getChildByName("chatBtn").active=!1),p.default.getViewNodeByName("MachineryCityMainView")&&(t.getChildByName("chatBtn").active=!1)}},this),u.ClientNetwork.getInstance().listenProtocol(C.FRIEND_CLIENT_ENUM.P_Friend_ApplyFriend,function(e){e.resetPos();var t=new C.S_Friend_ApplyFriend;t.read(e)&&(0==t.errorcode?(this._addFriendBtnNode.getComponent(cc.Button).enableAutoGrayEffect=!0,this._addFriendBtnNode.getComponent(cc.Button).interactable=!1,m.G.StringManager.PopString(d.StringValueTableData.getById(20).string_value)):v.ERRORTIPS(19+t.errorcode))},this),u.ClientNetwork.getInstance().listenProtocol(C.FRIEND_CLIENT_ENUM.P_Friend_DelFriend,function(e){e.resetPos();var t=new C.S_Friend_DelFriend;t.read(e)&&0==t.errorcode&&(this._addFriendBtnNode.active=!0,this._removeFriendBtnNode.active=!1,m.G.StringManager.PopString(d.StringValueTableData.getById(21).string_value))},this),u.ClientNetwork.getInstance().listenProtocol(C.FRIEND_CLIENT_ENUM.P_Friend_AddBlackList,function(e){e.resetPos();var t=new C.S_Friend_AddBlackList;if(t.read(e)){if(0!=t.errorcode)return void v.ERRORTIPS(56+t.errorcode);this._IsBlack=!0;var o=new C.C_Friend_GetBlackList;u.ClientNetwork.getInstance().Send(C.FRIEND_CLIENT_ENUM.P_Friend_GetBlackList,o),m.G.StringManager.PopString(m.G.StringManager.getString("ADD_BLACKSUCC"))}},this),u.ClientNetwork.getInstance().listenProtocol(C.FRIEND_CLIENT_ENUM.P_Friend_DelBlackList,function(e){e.resetPos();var t=new C.S_Friend_DelBlackList;if(t.read(e)){if(0!=t.errorcode)return void v.ERRORTIPS(64+t.errorcode);this._IsBlack=!1;var o=new C.C_Friend_GetGoodFriend;u.ClientNetwork.getInstance().Send(C.FRIEND_CLIENT_ENUM.P_Friend_GetGoodFriend,o);var i=new C.C_Friend_GetBlackList;u.ClientNetwork.getInstance().Send(C.FRIEND_CLIENT_ENUM.P_Friend_GetBlackList,i),m.G.StringManager.PopString(m.G.StringManager.getString("DELETE_BLACKSUCC"))}},this),E.default.registerTouchEvent(this.m_btn_invite_union,this.__btn_invite_clickHandler,this),E.default.registerTouchEvent(this.m_btn_appointOroutgoing,this.__btn_appointOroutgoing_clickHandler,this),E.default.registerTouchEvent(this.m_btn_transfer_president,this.__btn_transfer_president_clickHandler,this),E.default.registerTouchEvent(this.m_btn_leave,this.__btn_leave_clickHandler,this),S.GamePlatform.isWechat()?wx.getStorageSync("wxAuth")||(T.WechatUtils.getInstance().userAuth(function(){e.onCloseAuthPopTip()},function(){e.onCloseAuthPopTip()}),p.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:m.G.StringManager.getString("WECHAT_AUTH_CLICK"),onlyConfirmBtn:!0,confirmCb:function(){}})):S.GamePlatform.isQQMiniGame()&&(qq.getStorageSync("wxAuth")||(I.QQMiniGameUtils.getInstance().userAuth(function(){e.onCloseAuthPopTip()},function(){e.onCloseAuthPopTip()}),p.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:m.G.StringManager.getString("WECHAT_AUTH_CLICK").replace(/"\u5fae\u4fe1"/g,"QQ"),onlyConfirmBtn:!0,confirmCb:function(){}})))},t.prototype.start=function(){var e=new C.C_Friend_GetGoodFriend;u.ClientNetwork.getInstance().Send(C.FRIEND_CLIENT_ENUM.P_Friend_GetGoodFriend,e);var t=new C.C_Friend_GetBlackList;u.ClientNetwork.getInstance().Send(C.FRIEND_CLIENT_ENUM.P_Friend_GetBlackList,t)},t.prototype.init=function(e){var t=this;if(console.log("PlayerInfoView, init data=",e),!e.data.roleID)return this.closeView();this._curPlayerId=e.data.roleID,this._addFriendBtnNode.active=!1,this._removeFriendBtnNode.active=!1;var i,a=this.bottomLayout.node;a.getChildByName("chatBtn").active=!0,a.getChildByName("blackBtn").active=!0,a.getChildByName("deleteBtn").active=!1,a.getChildByName("proUserBtn").active=!1,a.getChildByName("proPrivacyBtn").active=!1,this.vipServiceBtn.active=!1,this.subGameBtn.active=this.subGameBtnCanShow(),this.onSetPlayerInfoView(e.data),this.onSetProficiencyInfo(e.data,e.proficiencyData),this.node.getChildByName("info").getChildByName("AudioSwitch").active=!1,this.node.getChildByName("info").getChildByName("changeName").active=!1,this.node.getChildByName("info").getChildByName("icon").getComponent(cc.Button).interactable=!1,this.node.getChildByName("info").getChildByName("icon").getChildByName("gear").active=!1,this.node.getChildByName("heroLayout").active=!0,this.node.getChildByName("info").getChildByName("cdkNode").active=!1,1==h.default.UUID.equals(e.data.roleID)?(this.node.getChildByName("info").getChildByName("AudioSwitch").active=!0,this.node.getChildByName("info").getChildByName("changeName").active=!0,this.node.getChildByName("info").getChildByName("icon").getComponent(cc.Button).interactable=!0,this.node.getChildByName("info").getChildByName("icon").getChildByName("gear").active=!0,this.node.getChildByName("heroLayout").active=!1,this.node.getChildByName("info").getChildByName("cdkNode").active=!0,a.getChildByName("chatBtn").active=!1,a.getChildByName("blackBtn").active=!1,S.GamePlatform.is_lyH5sq&&(a.getChildByName("deleteBtn").active=!0),S.GamePlatform.is_ly5add7&&(a.getChildByName("proUserBtn").active=!0,a.getChildByName("proPrivacyBtn").active=!0),this.vipServiceBtn.active=o.vipBtnCanShow(),this._redpoint_head.active=h.default.getPetRedDot()||h.default.getMainMapSkinRedpoint(),u.ClientNetwork.getInstance().listenLocalMessage(b.LOCAL_MESSAGE.LocalMsg_RefreshPetRedDot,function(){var e=h.default.getPetRedDot()||h.default.getMainMapSkinRedpoint();t._redpoint_head.active=e,t.setVipBtnRedpointVisible()},this),this.setVipBtnRedpointVisible(),this.m_btn_leave.active=!1,this.m_btn_appointOroutgoing.active=!1,this.m_btn_transfer_president.active=!1,this.m_btn_invite_union.active=!1):this.subGameBtn.active=!1,(i=p.default.getViewByName("ChickenDinnerMainView"))&&i.view&&(a.getChildByName("chatBtn").active=!1),(i=p.default.getViewByName("NavigationMainView"))&&i.view&&(a.getChildByName("chatBtn").active=!1),p.default.getViewNodeByName("FogHiddenMainView")&&(a.getChildByName("chatBtn").active=!1),p.default.getViewNodeByName("MachineryCityMainView")&&(a.getChildByName("chatBtn").active=!1);var n=p.default.getViewByName("MainSceneView");if(n&&n.view||(a.getChildByName("chatBtn").active=!1,this.m_btn_leave.active=!1,this.m_btn_appointOroutgoing.active=!1,this.m_btn_transfer_president.active=!1,this.m_btn_invite_union.active=!1),console.log("PlayerInfoView, data.qqHallVipInfo=",e.data.qqHallVipInfo),S.GamePlatform.isQQGameRoom()&&e.data.qqHallVipInfo){this.node.getChildByName("info").getChildByName("bluevip").active=!0;var r=e.data.qqHallVipInfo[0],s=e.data.qqHallVipInfo[1],c=e.data.qqHallVipInfo[2],l=e.data.qqHallVipInfo[3];D.QQGameHallUtils.setBlueIcon(this.node.getChildByName("info").getChildByName("bluevip").getChildByName("icon"),!1,r,s,c,l),D.QQGameHallUtils.setBlueIcon(this.node.getChildByName("info").getChildByName("bluevip").getChildByName("year"),!0,r,s)}else this.node.getChildByName("info").getChildByName("bluevip").active=!1},t.prototype.onShowFriendBtn=function(e){var t=this;1==function(e){var o=!1;return e.forEach(function(e){1==e.base.roleID.equals(t._curPlayerId)&&(o=!0)}),o}.call(this,e)?(this._addFriendBtnNode.active=!1,this._removeFriendBtnNode.active=!0):(this._addFriendBtnNode.active=!0,this._removeFriendBtnNode.active=!1),(1==h.default.UUID.equals(this._curPlayerId)||this._IsBlack)&&(this._addFriendBtnNode.active=!1,this._removeFriendBtnNode.active=!1,this.bottomLayout.node.getChildByName("chatBtn").active=!1)},t.prototype.onShowBlackFriendBtn=function(e){var t=this;if(1==function(e){return e.forEach(function(e){1==e.base.roleID.equals(t._curPlayerId)&&(t._IsBlack=!0)}),t._IsBlack}.call(this,e))this._addFriendBtnNode.active=!1,this._removeFriendBtnNode.active=!1,this.bottomLayout.node.getChildByName("chatBtn").active=!1,this.bottomLayout.node.getChildByName("blackBtn").getChildByName("nil").getComponent(cc.Label).string="\u79fb\u9664\u9ed1\u540d\u5355";else{this.bottomLayout.node.getChildByName("blackBtn").getChildByName("nil").getComponent(cc.Label).string="\u52a0\u5165\u9ed1\u540d\u5355",this.bottomLayout.node.getChildByName("chatBtn").active=!0;var o=p.default.getViewByName("MainSceneView");o&&o.view||(this.bottomLayout.node.getChildByName("chatBtn").active=!1)}1==h.default.UUID.equals(this._curPlayerId)&&(this._addFriendBtnNode.active=!1,this._removeFriendBtnNode.active=!1,this.bottomLayout.node.getChildByName("chatBtn").active=!1)},t.prototype.onSetProficiencyInfo=function(e,t){var o=this,i=this.node.getChildByName("proficiencyNode");i.active=!1;var a=t.get(500);if(a&&(a.worldRank>0&&a.worldRank<=Number(g.getConfigIntValue("proficiency_world_rank_max_num"))||a.localRank>0&&a.localRank<=Number(g.getConfigIntValue("car_hp_local_rank_max_num")))){i.active=!0;var n="";a.worldRank>0&&a.worldRank<=Number(g.getConfigIntValue("proficiency_world_rank_max_num"))?n=m.G.StringManager.getString("COMBAT_EFFECTIVENESS",a.worldRank):a.localRank>0&&a.localRank<=Number(g.getConfigIntValue("car_hp_local_rank_max_num"))&&(n=m.G.StringManager.getString("COMBAT_EFFECTIVENESS_PROCINCE",a.ipName,a.localRank)),i.getChildByName("rankInfo").getComponent(cc.Label).string=n}1==this.node.getChildByName("heroLayout").active&&e.heros.size>0&&this.node.getChildByName("heroLayout").on(cc.Node.EventType.TOUCH_START,function(){o.onProficiencyCallBack(e.heros,t)})},t.prototype.onSetPlayerInfoView=function(e){var t=this;this.initPlayerSociatyInfo(e),this.m_playerName=e.nickName,this.playerNameLab.string=e.nickName,g.setRemoteHeadIcon(e.headUrl,e.headID,this.headNode.getComponent(cc.Sprite)),e.headFrameID<=0&&(e.headFrameID=200),f.default.loadSprite("ui/headFrame/frame_"+e.headFrameID,this.headFrameNode.getComponent(cc.Sprite));var o=h.default.otherUUidTransformRoieId(e.roleID);this.playerUUIDLab.string=o.toString(),this.playerCupLab.string=e.score,this.m_playerScore=e.score,this.playerMaxCupLab.string=e.maxScore,console.log("servergroup playerinfo group="+e.aiid);var i=e.aiid,a=N.ServerAddrInfo.getInstance().getServerInfoByGroupId(i);a&&(this.serverGroup.string="[S"+a.groupId+"]"+a.name);var n=function(){var t=0,o=0,i=0;return e.fightType.forEach(function(e,a){1==a?(e.winNum>o&&(o=e.winNum),e.lostNum>i&&(i=e.lostNum)):2==a&&e.maxRound>t&&(t=e.maxRound)}),[t,o,i]}.call(this);this.playerMaxRoundLab.string=n[0].toString(),this.playerWinNumLab.string=n[1].toString(),this.playerLoseNumLab.string=n[2].toString();var r=Math.floor(n[1]/(n[1]+n[2])*100);if(isNaN(r)&&(r=0),this.playerRateLab.string=0===r?r.toString():r+"%",1==this.node.getChildByName("heroLayout").active&&e.heros.size>0){var s=this.node.getChildByName("heroNodeTemp");s.active=!1;var l=["ui/common_res/quality1","ui/common_res/quality2","ui/common_res/quality3","ui/common_res/quality4"];e.heros.forEach(function(e){var o=cc.instantiate(s);o.parent=t.node.getChildByName("heroLayout"),o.active=!0;var i=c.default.getInstance().getItemByID(e.heroID);if(i)if(f.default.loadSprite(l[i.quality-1],o.getComponent(cc.Sprite)),e.skinId>0){var a=M.HeroSkinTableData.getById(e.skinId),n=c.default.getInstance().data["StaticData/ItemTableData"][a.itemId];f.default.loadSprite(n.icon,o.getChildByName("icon").getComponent(cc.Sprite))}else f.default.loadSprite(i.icon,o.getChildByName("icon").getComponent(cc.Sprite))})}this._playerData=e},t.prototype.initPlayerSociatyInfo=function(e){var t=this.node.getChildByName("sociatyInfoNode"),o=t.getChildByName("txt_null"),i=t.getChildByName("unionInfo"),a=i.getChildByName("sociatyNameLyout"),n=a.getChildByName("txt_union_name").getComponent(cc.Label),r=a.getChildByName("img_job20"),c=a.getChildByName("img_job30"),l=P.default.instance().SociatyPlayerData;if(r.active=!1,c.active=!1,this.m_btn_leave.active=!1,this.m_btn_appointOroutgoing.active=!1,this.m_btn_transfer_president.active=!1,this.m_btn_invite_union.active=!1,this.m_manageJoyType=0,e.sociatyID.length>0&&0!=Number(e.sociatyID)){if(o.active=!1,i.active=!0,n.string=e.sociatyName,i.getChildByName("lianmengbiaozhi").getChildByName("unionLvLab").getComponent(cc.Label).string=e.sociatyLevel+"",e.sociatyJob==s.SOCIATY_JOB.SOCIATY_JOB_OFFICIAL&&(r.active=!0),e.sociatyJob==s.SOCIATY_JOB.SOCIATY_JOB_PRESIDENT&&(c.active=!0),this.m_btn_leave.active=!1,this.m_btn_appointOroutgoing.active=!1,this.m_btn_transfer_president.active=!1,this.m_btn_invite_union.active=!1,l.sociatyID==e.sociatyID&&!h.default.UUID.equals(e.roleID)){if(l.job==s.SOCIATY_JOB.SOCIATY_JOB_PRESIDENT){this.m_btn_leave.active=!0,this.m_btn_transfer_president.active=!0;var d=this.m_btn_appointOroutgoing.getComponentInChildren(cc.Label);e.sociatyJob==s.SOCIATY_JOB.SOCIATY_JOB_OFFICIAL?(this.m_btn_appointOroutgoing.active=!0,d.string=m.G.StringManager.getWorldString("sociaty_text1"),this.m_manageJoyType=2):(this.m_btn_appointOroutgoing.active=!0,d.string=m.G.StringManager.getWorldString("sociaty_text2"),this.m_manageJoyType=1)}l.job!=s.SOCIATY_JOB.SOCIATY_JOB_PRESIDENT&&l.job!=s.SOCIATY_JOB.SOCIATY_JOB_OFFICIAL||(this.m_btn_leave.active=!0)}}else o.active=!0,i.active=!1,"0"!=l.sociatyID&&l.job>s.SOCIATY_JOB.SOCIATY_JOB_MEMBER&&!h.default.UUID.equals(e.roleID)&&(this.m_btn_invite_union.active=!0)},t.prototype.onClickHeadCallBack=function(){p.default.addPopView("BaseCtrl","PlayerHeadView","PlayerHeadView")},t.prototype.onClickChangeNameCallBack=function(){h.default.checkModulerOnOffState(30)?p.default.addPopView("BaseCtrl","PlayerChangeNameView","PlayerChangeNameView"):m.G.StringManager.PopString(m.G.StringManager.getString("FUNCTION_CLOSE"))},t.prototype.onRefreshPlayerHead=function(){var e=h.default.getRoleAttrValByKey(s.ROLE_ATTR_VALUES.ROLE_ATTR_HEADID);g.setRemoteHeadIcon(h.default.getHeadUrl(),e,this.headNode.getComponent(cc.Sprite))},t.prototype.onRefreshPlayerHeadFrame=function(){var e=h.default.getRoleAttrValByKey(s.ROLE_ATTR_VALUES.ROLE_ATTR_HEADFRAMEID);e<=0&&(e=200),f.default.loadSprite("ui/headFrame/frame_"+e,this.headFrameNode.getComponent(cc.Sprite))},t.prototype.onRefreshPlayerName=function(){this.playerNameLab.string=h.default.roleName},t.prototype.onAudioSwitchCallBack=function(e,t){t&&(1==y.checkGameMuteVolume()?_.setLocalData("GameVolume","1"):_.setLocalData("GameVolume","0"),y.initGameVolume());var o=y.checkGameMuteVolume();this.audioSwitchLab.string=1==o?m.G.StringManager.getString("AUDIO_SWITCH_OFF"):m.G.StringManager.getString("AUDIO_SWITCH_ON")},t.prototype.onApplyFriendCallBack=function(){if(parseInt(g.getConfigIntValue("friend_max_friend_list_num"))-1<this.m_goodFriendNum)m.G.StringManager.PopString(m.G.StringManager.getString("APPLY_MAX"));else{var e=h.default.otherUUidTransformRoieId(this._curPlayerId),t=new C.C_Friend_ApplyFriend;t.applyRoleShowID=e.toString(),u.ClientNetwork.getInstance().Send(C.FRIEND_CLIENT_ENUM.P_Friend_ApplyFriend,t)}},t.prototype.onRemoveFriendCallBack=function(){var e=h.default.otherUUidTransformRoieId(this._curPlayerId),t=new C.C_Friend_DelFriend;t.friendRoleShowID=e.toString(),u.ClientNetwork.getInstance().Send(C.FRIEND_CLIENT_ENUM.P_Friend_DelFriend,t)},t.prototype.onBlackFriendCallBack=function(){var e=this;if(this._IsBlack){var t=h.default.otherUUidTransformRoieId(this._curPlayerId),o=new C.C_Friend_DelBlackList;o.blackRoleShowID=t.toString(),u.ClientNetwork.getInstance().Send(C.FRIEND_CLIENT_ENUM.P_Friend_DelBlackList,o)}else{var i=h.default.getBlackFriendsData(),a={};i.size>=0&&(a=Array.from(i.keys()));var n=parseInt(g.getConfigIntValue("friend_max_black_list_num"));a.length<=n-1?p.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:m.G.StringManager.getString("BLACK_TIP"),confirmCb:function(){var t=h.default.otherUUidTransformRoieId(e._curPlayerId),o=new C.C_Friend_AddBlackList;o.blackRoleShowID=t.toString(),u.ClientNetwork.getInstance().Send(C.FRIEND_CLIENT_ENUM.P_Friend_AddBlackList,o),u.ClientNetwork.getInstance().pushLocalMessage(b.LOCAL_MESSAGE.LocalMsg_SystemCallFriendAddBlack,{roleid:t,roleName:e.m_playerName,roleScore:e.m_playerScore})}}):m.G.StringManager.PopString(m.G.StringManager.getString("BLACK_MAX"))}},t.prototype.onClickCDKCallBack=function(){"lektn"==S.GamePlatform.getMiYaVideoType().toString().slice(0,5)?p.default.addPopView("BaseCtrl","ExchangeCodeView","ExchangeCodeView"):p.default.addPopView("BaseCtrl","CDKEYView","CDKEYView")},t.prototype.onClicChatCallBack=function(){this.closeView();var e=p.default.getViewByName("RankListView");e&&e.view.closeView();var t=p.default.getViewByName("FriendMainView");t&&t.view.closeView();var o=p.default.getViewByName("ActivityGoldenLeagueView");o&&o.view.closeView(),setTimeout(function(){var e=p.default.getViewByName("ActivityMainView");e&&e.view&&e.view.closeView()},300);var i=p.default.getViewByName("SociatyMainView");i&&i.view.closeView();var a=p.default.getViewByName("AnniversaryRankView");a&&a.view.closeView();var n=p.default.getViewByName("AnniversaryMainView");n&&n.view.closeView();var r=p.default.getViewByName("MainSceneView");r&&r.view&&(r.view,A.default.Instance.emit(L.default.SyncChatViewChange,[w.ChatViewVisible.Popup,3,this._playerData]))},t.prototype.onCloseAuthPopTip=function(){var e=p.default.getViewByName("TipPopWindowView");e&&e.view&&e.view.closeView(),S.GamePlatform.isWechat()?wx.setStorage({key:"wxAuth",data:!0}):S.GamePlatform.isQQMiniGame()&&qq.setStorage({key:"wxAuth",data:!0})},t.prototype.onDestroy=function(){u.ClientNetwork.getInstance().removeMessageTarget(this),A.default.Instance.off(this)},t.vipBtnCanShow=function(){var e=parseInt(g.getConfigIntValue("vipService_show_btn"));return"bigBlue"==S.GamePlatform.getMiYaVideoTypeNoSet()&&(e=parseInt(g.getConfigIntValue("vipService_show_btn_bigBlue"))),-1!=e&&h.default.getRoleAttrValByKey(s.ROLE_ATTR_VALUES.ROLE_ATTR_RECHARGENUM)>=e},t.vipBtnRedDotCanShow=function(){return!(!o.vipBtnCanShow()||1==parseInt(g.getLocalData("vipservicereddot")))},t.prototype.vipBtnClick=function(){p.default.addPopView("BaseCtrl","VipServiceView","VipServiceView"),this.closeView(),this.vipServiceBtn.getChildByName("redpoint_vip").active&&(_.setLocalData("vipservicereddot",1),u.ClientNetwork.getInstance().pushLocalMessage(b.LOCAL_MESSAGE.LocalMsg_RefreshPetRedDot))},t.prototype.subGameBtnCanShow=function(){var e=parseInt(g.getConfigIntValue("subgame_score_limit"));return h.default.getRoleAttrValByKey(s.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE)<e},t.prototype.subGameBtnClick=function(){p.default.addPopView("BaseCtrl","SubGameHallView","SubGameHallView")},t.prototype.setVipBtnRedpointVisible=function(){var e=o.vipBtnRedDotCanShow();this.vipServiceBtn.getChildByName("redpoint_vip").active=e},t.prototype.__btn_invite_clickHandler=function(){if(Number(this.playerCupLab.string)<Number(g.getConfigIntValue("sociaty_open_score")))return m.G.StringManager.PopString(m.G.StringManager.getString("JOIN_SOCIATY_TEXT3"));R.default.c_Sociaty_RoleInvite(this._playerData.roleID)},t.prototype.__btn_appointOroutgoing_clickHandler=function(){var e=this;1==this.m_manageJoyType?p.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:m.G.StringManager.getWorldString("change_job_tip1",this.playerNameLab.string),confirmCb:function(){R.default.c_Sociaty_RoleChangeJob(e._playerData.roleID,s.SOCIATY_JOB.SOCIATY_JOB_OFFICIAL)}}):2==this.m_manageJoyType&&p.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:m.G.StringManager.getWorldString("change_job_tip2",this.playerNameLab.string),confirmCb:function(){R.default.c_Sociaty_RoleChangeJob(e._playerData.roleID,s.SOCIATY_JOB.SOCIATY_JOB_MEMBER)}})},t.prototype.__btn_transfer_president_clickHandler=function(){var e=this,t=m.G.StringManager.getWorldString("union_is_transfer");p.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:t,onlyConfirmBtn:!1,confirmCb:function(){R.default.c_Sociaty_RoleChangeJob(e._playerData.roleID,s.SOCIATY_JOB.SOCIATY_JOB_PRESIDENT)}})},t.prototype.__btn_leave_clickHandler=function(){R.default.c_Sociaty_RoleKickPlayer(this._playerData.roleID)},t.prototype.onProficiencyCallBack=function(e,t){p.default.addPopView("BaseCtrl","HeroGroupProficiency","HeroGroupProficiency",{heros:e,proficiencyData:t})},t.prototype.onClickZhuXiaoCallBack=function(){S.GamePlatform.is_lyH5sq&&AppActivity.ZhuXiao()},t.prototype.showProtocolUser=function(){p.default.addPopView("BaseCtrl","UserProtocolView","UserProtocolView",{showClose:S.GamePlatform.Is5Add7SmallBag()})},t.prototype.showProtocolPrivacy=function(){p.default.addPopView("BaseCtrl","PrivacyProtocolView","PrivacyProtocolView",{showClose:S.GamePlatform.Is5Add7SmallBag()})},n([G({type:cc.Node,displayName:"\u73a9\u5bb6\u5934\u50cf"})],t.prototype,"headNode",void 0),n([G({type:cc.Node,displayName:"\u73a9\u5bb6\u5934\u50cf\u6846"})],t.prototype,"headFrameNode",void 0),n([G({type:cc.Label,displayName:"\u73a9\u5bb6\u540d\u79f0"})],t.prototype,"playerNameLab",void 0),n([G({type:cc.Label,displayName:"\u73a9\u5bb6UUID"})],t.prototype,"playerUUIDLab",void 0),n([G({type:cc.Label,displayName:"\u73a9\u5bb6\u676f\u6570"})],t.prototype,"playerCupLab",void 0),n([G({type:cc.Label,displayName:"\u80dc\u5229"})],t.prototype,"playerWinNumLab",void 0),n([G({type:cc.Label,displayName:"\u5931\u8d25"})],t.prototype,"playerLoseNumLab",void 0),n([G({type:cc.Label,displayName:"\u80dc\u7387"})],t.prototype,"playerRateLab",void 0),n([G({type:cc.Label,displayName:"\u6700\u9ad8\u676f\u6570"})],t.prototype,"playerMaxCupLab",void 0),n([G({type:cc.Label,displayName:"\u6700\u9ad8\u56de\u5408"})],t.prototype,"playerMaxRoundLab",void 0),n([G({type:cc.Label,displayName:"\u58f0\u97f3\u5f00\u5173"})],t.prototype,"audioSwitchLab",void 0),n([G({type:cc.Label,displayName:"\u670d\u52a1\u5668\u533a"})],t.prototype,"serverGroup",void 0),n([G({type:cc.Node,displayName:"VIP\u5ba2\u670d\u6309\u94ae"})],t.prototype,"vipServiceBtn",void 0),n([G({type:cc.Layout,displayName:"\u5e95\u90e8\u6309\u94aelayout"})],t.prototype,"bottomLayout",void 0),n([G({type:cc.Node,displayName:"\u5c0f\u6e38\u620f\u5165\u53e3\u6309\u94ae"})],t.prototype,"subGameBtn",void 0),o=n([l.Register_Class,k],t)}(r.default);o.default=O,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/HeroSkinTableData":"HeroSkinTableData","../../StaticData/StringValueTableData":"StringValueTableData","../../common/CommandValue":"CommandValue","../../common/EventConst":"EventConst","../../common/PlayerModule":"PlayerModule","../../model/ServerAddrInfo":"ServerAddrInfo","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/base/GameView":"GameView","../../modules/manager/EventManager":"EventManager","../../network/ClientNetwork":"ClientNetwork","../../network/LocalMessage":"LocalMessage","../../network/protocol/FriendProtocls":"FriendProtocls","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/ConfigUtils":"ConfigUtils","../../utils/GamePlatform":"GamePlatform","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils","../../utils/QQGameHallUtils":"QQGameHallUtils","../../utils/QQMiniGameUtils":"QQMiniGameUtils","../../utils/ResourcesManager":"ResourcesManager","../../utils/Tools":"Tools","../../utils/WechatUtils":"WechatUtils","../sociaty/SociatyCtrl":"SociatyCtrl","../sociaty/SociatyModel":"SociatyModel"}],PlayerModule:[function(e,t,o){"use strict";cc._RF.push(t,"0e0a5UUpD1Axa30UWVXma4B","PlayerModule"),Object.defineProperty(o,"__esModule",{value:!0}),o.HeroCarModule=o.ItemsModule=o.ItemType=void 0;var i,a=e("../utils/ConfigUtils"),n=e("../network/protocol/ObjCollection"),r=e("../network/protocol/RoleProtocols"),s=e("../network/ClientNetwork"),c=e("../network/LocalMessage"),l=e("../modules/manager/EventManager"),d=e("./EventConst"),u=e("../network/protocol/FriendProtocls"),h=e("../utils/GamePlatform"),p=e("../modules/manager/cheat/SafeNumber"),f=e("../utils/GameUtils"),g=e("../utils/GameTools"),m=e("../network/protocol/TypeProtocols");(function(e){e[e.Material=1]="Material",e[e.Cards=2]="Cards",e[e.Box=3]="Box",e[e.Head=4]="Head",e[e.HeadFrame=5]="HeadFrame",e[e.Emoji=6]="Emoji",e[e.BattleSkin=7]="BattleSkin",e[e.BattleEquip=8]="BattleEquip"})(i=o.ItemType||(o.ItemType={}));var _=function(){function e(){this._itemId=0,this._itemUUID=0,this._itemName="",this._itemCount=0,this._itemType=i.Material}return Object.defineProperty(e.prototype,"itemId",{get:function(){return this._itemId},set:function(e){this._itemId=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"itemName",{get:function(){return this._itemName},set:function(e){this._itemName=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"itemUUID",{get:function(){return this._itemUUID},set:function(e){this._itemUUID=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"itemCount",{get:function(){return this._itemCount},set:function(e){this._itemCount=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"itemType",{get:function(){return this._itemType},set:function(e){this._itemType=e},enumerable:!1,configurable:!0}),e}();o.ItemsModule=_;var y=function(){function e(){this._heroID=new p.SafeNumber(0),this._heroUUId=0,this._heroLevel=new p.SafeNumber(1),this._bHeroLock=!1,this._bHeroBattle=!1}return Object.defineProperty(e.prototype,"heroId",{get:function(){return this._heroId},set:function(e){this._heroId=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_heroId",{get:function(){return this._heroID.value},set:function(e){this._heroID.value=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"heroUUId",{get:function(){return this._heroUUId},set:function(e){this._heroUUId=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"heroLevel",{get:function(){return this._heroLevel.value},set:function(e){this._heroLevel.value=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bHeroLock",{get:function(){return this._bHeroLock},set:function(e){this._bHeroLock=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bHeroBattle",{get:function(){return this._bHeroBattle},set:function(e){this._bHeroBattle=e},enumerable:!1,configurable:!0}),e}();o.HeroCarModule=y;var v=function(){function e(){this._petRedDot=!1,this._mainMapSkinRedpoint=!1,this.m_serverTimeInit_localTime=0,this.m_serverTimeInit=0,this._gold=0,this._diamond=0,this._heroCars=[],this._bagItems=[],this._roleAttrValue=[],this._roleInfoData=new r.T_Information_Data,this._legendData=new r.T_Role_LegendData,this._playerTaskData=new r.T_Role_Task,this._playerFriendsData=new u.S_Friend_SynLoginData,this._playerMailData=new r.T_Role_Mail,this._intervalId=null,this._privateChatSimData=null,this._rechargeData=new r.T_Role_Recharge_Data,this._fightReconnectData=null,this._watchadboxData=new r.T_TotalWatchADBox,this._shareData=new r.T_ShareData,this._seasonData=new r.T_SeasonData,this._fightBalance=null,this._activityData=null,this._blackFriendsData=new u.S_Friend_GetBlackList,this._clientData=new r.T_Client_Data,this._clientTaskAddCountData=[],this._gameTime=new r.T_Game_Time,this._rechargePrizeData=null,this._moduleViewOnOffData=new n.ObjMap,this._voucher=0,this._heroProficiencyData=new n.ObjMap,this._systemChatCount=0,this._worldChatCount=0,this._activityChatCount=0,this._systemChats=new Array,this._playerLocalScore=0,this._weekCoopChatCount=0,this._battleCardTabNameMap=new Map,this._scoreFundMapData=new Map}return e.instance=function(){return this._instance||(this._instance=new this),this._instance},e.prototype.synData=function(e){this.setBattlePveData(e.chapterData),this.setRoleBagItems(e.roleBag.items),this.fightHeroArrayIndex=e.battlearray.defineID-1,this.setHeroData(e),this.setRoleAttrValues(e.roleAttrValue),this.setRoleInfoData(e.information),this.UUID=e.roleId,console.log("\u73a9\u5bb6UUID="+this.UUID),this._playerStrId=e.strId,this.roleName=e.roleName,this.setLegendData(e.legendData),this.setRoleTaskData(e.roleTask),this.setRoleMailData(e.roleMail),this.setServersTime(e.currTime),this.setRoleRechargeData(e.recharge),this.setWatchadboxData(e.watchadbox),this.setShareData(e.share),this.setSeasonData(e.season),this.setClientData(e.clientData),this.setGameTime(e.gameTime),g.default.callSystemCheckChatCount(this.getRoleAttrValByKey(m.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE),this.getRoleAttrValByKey(m.ROLE_ATTR_VALUES.ROLE_ATTR_RECHARGENUM),m.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_SYSTEM),g.default.callSystemCheckChatCount(this.getRoleAttrValByKey(m.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE),this.getRoleAttrValByKey(m.ROLE_ATTR_VALUES.ROLE_ATTR_RECHARGENUM),m.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_WORLD),this.setPlayerScoreFundData(e.chapterData)},Object.defineProperty(e.prototype,"fightHeroArrayIndex",{get:function(){return this._fightHeroArrayIndex},set:function(e){this._fightHeroArrayIndex=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"goldNum",{get:function(){return this._gold},set:function(e){this._gold=e,s.ClientNetwork.getInstance().pushLocalMessage(c.LOCAL_MESSAGE.LocalMsg_SyncGold),l.default.Instance.emit(d.default.SyncGoldChange)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"diamondNum",{get:function(){return this._diamond},set:function(e){this._diamond=e,s.ClientNetwork.getInstance().pushLocalMessage(c.LOCAL_MESSAGE.LocalMsg_SyncDiamond),l.default.Instance.emit(d.default.SyncDiamondChange)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"achPointNum",{get:function(){return this._achPoint},set:function(e){this._achPoint=e,s.ClientNetwork.getInstance().pushLocalMessage(c.LOCAL_MESSAGE.LocalMsg_SyncAchPoint)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"voucherNum",{get:function(){return this._voucher},set:function(e){this._voucher=e,s.ClientNetwork.getInstance().pushLocalMessage(c.LOCAL_MESSAGE.LocalMsg_SyncVoucher),l.default.Instance.emit(d.default.SyncVoucherChange)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"UUID",{get:function(){return this._playerUUID},set:function(e){this._playerUUID=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"roleName",{get:function(){return this._playerName},set:function(e){this._playerName=e},enumerable:!1,configurable:!0}),e.prototype.uuidTransformRoieId=function(){if(this._playerUUID){var e=this._playerUUID.toString();return 17==e.length?e.substring(0,4)+e.substring(11,17):16==e.length?e.substring(0,3)+e.substring(10,16):e.substring(0,2)+e.substring(9,15)}},e.prototype.otherUUidTransformRoieId=function(e){var t=e.toString();return 17==t.length?t.substring(0,4)+t.substring(11,17):16==t.length?t.substring(0,3)+t.substring(10,16):t.substring(0,2)+t.substring(9,15)},e.prototype.getHeadUrl=function(){return h.GamePlatform.isWechat()?wx.getStorageSync("wxImage")||"":h.GamePlatform.isQQMiniGame()&&qq.getStorageSync("wxImage")||""},e.prototype.getBattlePveData=function(){return this._battlePve},e.prototype.changeBattlePveData=function(){},e.prototype.setBattlePveData=function(e){this._battlePve=e},e.prototype.setPlayerScoreFundData=function(e){this._scoreFundMapData.set(88889,e.chapterInfoMap.get(88889)),this._scoreFundMapData.set(88890,e.chapterInfoMap.get(88890))},e.prototype.getScoreFundData=function(){return this._scoreFundMapData},e.prototype.getRoleBagItems=function(){return this._bagItems},e.prototype.changeRoleBagItem=function(e){var t=this,o=e.changeItem,i=e.deleteItem;e.compensate,o.length>0&&o.forEach(function(e){if(t._bagItems[e.itemID])t._bagItems[e.itemID].itemCount=e.itemNum;else{var o=new _;o.itemId=e.itemID,o.itemUUID=e.ItemUUID,o.itemCount=e.itemNum,o.itemName=e.itemName,o.itemType=a.default.getInstance().getItemByID(e.itemID).type,t._bagItems[o.itemId]=o}var i=a.default.getInstance().getItemByID(e.itemID);if(2===i.type){var n=t._heroCars[e.itemID];n&&(n.heroUUId=e.ItemUUID,n.heroLevel=e.itemLevel,n.bHeroLock=!0,l.default.Instance.emit(d.default.SycnClientCarHpChangeEvent))}else 10===i.type&&100!=e.itemID?t.syncClientTaskUpdateCountToServer(i.type,!0):7===i.type?(t.setMainMapSkinRedpoint(!0),l.default.Instance.emit(d.default.SyncRoleItemMapSkinEvent)):11===i.type&&801!=e.itemID?t.syncClientTaskUpdateCountToServer(i.type,!0):i.type==m.TYPE_ITEM.TYPE_ITEM_HEROSKIN&&s.ClientNetwork.getInstance().pushLocalMessage(c.LOCAL_MESSAGE.LocalMsg_itemChange_heroSkin,{itemId:e.itemID});1001==e.itemID&&(t.goldNum=e.itemNum),1002==e.itemID&&(t.diamondNum=e.itemNum),1005==e.itemID&&(t.achPointNum=e.itemNum),1007==e.itemID&&s.ClientNetwork.getInstance().pushLocalMessage(c.LOCAL_MESSAGE.LocalMsg_itemChange_sweepCard),21e4==e.itemID&&s.ClientNetwork.getInstance().pushLocalMessage(c.LOCAL_MESSAGE.LocalMsg_itemChange_selectCard),1013==e.itemID&&(t.voucherNum=e.itemNum),1012==e.itemID&&l.default.Instance.emit(d.default.SyncDemonFruitChangeEvent)});var n=function(e){var o=null;return t._bagItems.forEach(function(t){t&&t.itemUUID.toNumber()==e.toNumber()&&(o=t)}),o};i.length>0&&i.forEach(function(e){var o=n.call(t,e);o&&(1001==o.itemId&&(t.goldNum=0),1002==o.itemId&&(t.diamondNum=0),1013==o.itemId&&(t.voucherNum=0),delete t._bagItems[o.itemId])}),l.default.Instance.emit(d.default.SycnChangeRoleBag)},e.prototype.setRoleBagItems=function(e){var t=this;this._bagItems=[],e.forEach(function(e){var o=new _;o.itemId=e.itemID,a.default.getInstance().getItemByID(e.itemID)&&(o.itemUUID=e.ItemUUID,o.itemCount=e.itemNum,o.itemName=e.itemName,o.itemType=a.default.getInstance().getItemByID(e.itemID).type,t._bagItems[o.itemId]=o,1001==o.itemId&&(t.goldNum=o.itemCount),1002==o.itemId&&(t.diamondNum=o.itemCount),1005==o.itemId&&(t.achPointNum=o.itemCount),1013==o.itemId&&(t.voucherNum=o.itemCount))})},e.prototype.getItemTotalCountByType=function(e){var t=new Set;return this._bagItems.forEach(function(o){o&&o.itemType==e&&t.add(o.itemId)}),t.delete(100),t.size},e.prototype.getItemCountByBag=function(e){var t=0,o=this._bagItems[e];return o&&(t=o.itemCount),t},e.prototype.getItemByBag=function(e){return this._bagItems[e]},e.prototype.setRoleAttrValues=function(e){var t=this;e.forEach(function(e,o){t._roleAttrValue[o]=e,o==m.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE&&t.setLocalScore(e)})},e.prototype.getRoleAttrValByKey=function(e){var t=this._roleAttrValue[e];return null==t&&(t=0),t},e.prototype.setRoleAttrValByKey=function(e,t){var o=this._roleAttrValue[e];this._roleAttrValue[e]=t,s.ClientNetwork.getInstance().pushLocalMessage(c.LOCAL_MESSAGE.LocalMsg_SynRoleAttrVal,e,o,t)},e.prototype.setRoleInfoData=function(e){this._roleInfoData=e,s.ClientNetwork.getInstance().pushLocalMessage(c.LOCAL_MESSAGE.LocalMsg_SynRoleInformationData)},e.prototype.getRoleInfoData=function(){return this._roleInfoData},e.prototype.setLegendData=function(e){this._legendData=e},e.prototype.getLegendData=function(){return this._legendData.chapterInfoMap},e.prototype.getGoldNum=function(){return this.getItemCountByBag(1001)},e.prototype.setHeroData=function(e){var t=this;this.initHeroCarModule(),e.roleBag.items.forEach(function(e){if(2===a.default.getInstance().getItemByID(e.itemID).type){var o=t._heroCars[e.itemID];o&&(o.heroUUId=e.ItemUUID,o.heroLevel=e.itemLevel,o.bHeroLock=!0)}}),this.setBattleHeroCards(e)},e.prototype.setBattleHeroCards=function(e){var t=this;this._heroBattleArray=[];var o=function(e){var o=null;return t._heroCars.forEach(function(t){t&&1==t.bHeroLock&&1==t.heroUUId.equals(e)&&(o=t)}),o};e.battlearray.idData.forEach(function(e,i){var a=[];e.indexData.forEach(function(e,i){var n=o.call(t,e.heroUUID);n&&(a[i]=n)}),t._heroBattleArray[i-1]=a}),this.setBattleCardGroupName(e.battlearray)},e.prototype.setBattleCardGroupName=function(e){var t=this;e.idData.forEach(function(e,o){t._battleCardTabNameMap.set(o,e.battleArray)})},e.prototype.getBattleCardGroupName=function(e){var t;return null!==(t=this._battleCardTabNameMap.get(e))&&void 0!==t?t:e.toString()},e.prototype.initHeroCarModule=function(){for(var e=a.default.getInstance().data["StaticData/HeroTableData"],t=0,o=Object.keys(e);t<o.length;t++){var i=o[t];if(e.hasOwnProperty(i)&&e[i].id&&e[i].id<1e3){var n=new y;n.heroId=e[i].id,this._heroCars[n.heroId]=n}}},e.prototype.getHeroCarData=function(){return this._heroCars},e.prototype.getBattleHeroCarData=function(e){return this._heroBattleArray[e]},e.prototype.setRoleTaskData=function(e){this._playerTaskData=e},e.prototype.refreshRoleTaskDate=function(e){var t=this;e.forEach(function(e){t._playerTaskData.tasks.set(e.taskID,e)})},e.prototype.deleteRoleTaskDate=function(e){var t=this;e.forEach(function(e){t._playerTaskData.tasks.delete(e)})},e.prototype.refreshRoleExtraTaskData=function(e){this._playerTaskData.extra=e},e.prototype.getRoleTaskData=function(){return this._playerTaskData},e.prototype.setFriendsData=function(e){this._playerFriendsData=e},e.prototype.getFriendsData=function(){return this._playerFriendsData},e.prototype.setBlackFriendsData=function(e){this._blackFriendsData=e},e.prototype.getBlackFriendsData=function(){return this._blackFriendsData},e.prototype.setRoleMailData=function(e){this._playerMailData=e},e.prototype.getRoleMailData=function(){return this._playerMailData.mails},e.prototype.setServersTime=function(e){var t=this;this.m_serverTimeInit=e,this.m_serverTimeInit_localTime=(new Date).getTime(),this._intervalId&&(clearInterval(this._intervalId),this._intervalId=null),this._playerServersTime=e,this._intervalId=setInterval(function(){t._playerServersTime++},1e3)},e.prototype.getServersTime=function(){return this._playerServersTime},e.prototype.getServersTime2=function(){var e=this.m_serverTimeInit+((new Date).getTime()-this.m_serverTimeInit_localTime)/1e3;return Math.floor(e)},e.prototype.setHistoryWorldChats=function(e){this._historyWorldChat=e.chats},e.prototype.getHistoryWorldChats=function(){return this._historyWorldChat},e.prototype.setSynPrivateChatSimData=function(e){this._privateChatSimData=e.simData},e.prototype.getPrivateChatSimData=function(){return this._privateChatSimData},e.prototype.setRoleRechargeData=function(e){this._rechargeData=e},e.prototype.getRoleRechargeData=function(){return this._rechargeData.recharges},e.prototype.setFightReconnectData=function(e){this._fightReconnectData=e},e.prototype.getFightReconnectData=function(){return this._fightReconnectData},e.prototype.setRechargePrizeData=function(e){this._rechargePrizeData=e},e.prototype.getRechargePrizeData=function(){return this._rechargePrizeData},e.prototype.setWatchadboxData=function(e){this._watchadboxData=e},e.prototype.getWatchadboxData=function(){return this._watchadboxData},e.prototype.setShareData=function(e){this._shareData=e},e.prototype.getSharePrenticeData=function(){return this._shareData.players},e.prototype.setSeasonData=function(e){this._seasonData=e},e.prototype.getCurSeasonData=function(){return this._seasonData.entity.get(0)?this._seasonData.entity.get(0):null},e.prototype.getLastSeasonData=function(){return this._seasonData.last.get(0)?this._seasonData.last.get(0):null},e.prototype.setDrawPrizeData=function(e){this._drawPrizeData=e},e.prototype.getDrawPrizeData=function(){return this._drawPrizeData.get(1)},e.prototype.setFightBalanceData=function(e){this._fightBalance=e},e.prototype.getFightBalanceData=function(){return this._fightBalance},e.prototype.setActivityData=function(e){this._activityData=e},e.prototype.getActivityData=function(){return this._activityData},e.prototype.setActivityDataSingle=function(e){this._activityData&&this._activityData.set(e.activityID,e)},e.prototype.setActivityClose=function(e){this._activityData&&this._activityData.delete(e)},e.prototype.setClientData=function(e){this._clientData=e},e.prototype.getClientData=function(){return this._clientData.intMap},e.prototype.setClientTaskAddCountData=function(e){this._clientTaskAddCountData=e},e.prototype.getClientTaskAddCountData=function(){return this._clientTaskAddCountData},e.prototype.setGameTime=function(e){this._gameTime=e},e.prototype.getGameTime=function(){return this._gameTime},e.prototype.SyncCostGet=function(e){this._costGetMap=e,s.ClientNetwork.getInstance().pushLocalMessage(c.LOCAL_MESSAGE.LocalMsg_SyncCostGet)},e.prototype.getCostGetDataByID=function(e){var t=0;return this._costGetMap&&this._costGetMap.costGetMap.has(e)&&(t=this._costGetMap.costGetMap.get(e)),t},e.prototype.setPetRedDot=function(e){this._petRedDot=e},e.prototype.getPetRedDot=function(){return this._petRedDot},e.prototype.setMainMapSkinRedpoint=function(e){this._mainMapSkinRedpoint=e},e.prototype.getMainMapSkinRedpoint=function(){return this._mainMapSkinRedpoint},e.prototype.setCarSkinRed=function(e){this._carSkinRedDot=e},e.prototype.getCarSkinRed=function(){return this._carSkinRedDot},e.prototype.setPlayerOnOffDataInfo=function(e){this._moduleViewOnOffData=e},e.prototype.getPlayerOnOffDataInfo=function(){return this._moduleViewOnOffData},e.prototype.checkModulerOnOffState=function(e){var t=!1;return this._moduleViewOnOffData&&this._moduleViewOnOffData.size>0&&this._moduleViewOnOffData.forEach(function(o,i){e===i&&(t=o)}),t},e.prototype.syncClientTaskUpdateCountToServer=function(e,t){10==e?s.ClientNetwork.getInstance().pushLocalMessage(c.LOCAL_MESSAGE.LocalMsg_itemChange_pet,{isNew:t,itemTotalNum:this.getItemTotalCountByType(e)}):11==e&&s.ClientNetwork.getInstance().pushLocalMessage(c.LOCAL_MESSAGE.LocalMsg_itemChange_carSkin,{isNew:t,itemTotalNum:this.getItemTotalCountByType(e)});var o=0;if(this._bagItems.forEach(function(t){null!=t&&t.itemType==e&&100!=t.itemId&&o<t.itemCount&&(o=t.itemCount)}),10==e){var i=parseInt(f.getConfigIntValue("pet_level_max"));o>i&&(o=i),s.ClientNetwork.getInstance().pushLocalMessage(c.LOCAL_MESSAGE.LocalMsg_ClientTaskUpdateCount,{classifyId:3,valueCount:o})}else 11==e&&(i=parseInt(f.getConfigIntValue("car_skin_level_max")),o>i&&(o=i),s.ClientNetwork.getInstance().pushLocalMessage(c.LOCAL_MESSAGE.LocalMsg_ClientTaskUpdateCount,{classifyId:5,valueCount:o}))},e.prototype.setHeroProficiencyData=function(e){this._heroProficiencyData=e},e.prototype.getHeroProficiencyData=function(){return this._heroProficiencyData},e.prototype.getHeroProficiencyDataById=function(e){return this._heroProficiencyData.get(e)},e.prototype.setSystemChatCount=function(e,t){t==m.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_SYSTEM||t==m.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_ACTIVITY||t==m.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_WEEK_COOPERATION?(this._systemChatCount=e,this._activityChatCount=e,this._weekCoopChatCount=e):t==m.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_WORLD&&(this._worldChatCount=e),this.setLocalScore(this.getRoleAttrValByKey(m.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE))},e.prototype.getSystemChatCount=function(){return this._systemChatCount},e.prototype.getWorldChatCount=function(){return this._worldChatCount},e.prototype.getActivityChatCount=function(){return this._activityChatCount},e.prototype.getWeekCoopChatCount=function(){return this._weekCoopChatCount},e.prototype.addSystemChatData=function(e){this._systemChats.push(e)},e.prototype.getSystemChats=function(){return this._systemChats},e.prototype.setLocalScore=function(e){this._playerLocalScore=e},e.prototype.getLocalScore=function(){return this._playerLocalScore},e}();o.default=v.instance(),cc._RF.pop()},{"../modules/manager/EventManager":"EventManager","../modules/manager/cheat/SafeNumber":"SafeNumber","../network/ClientNetwork":"ClientNetwork","../network/LocalMessage":"LocalMessage","../network/protocol/FriendProtocls":"FriendProtocls","../network/protocol/ObjCollection":"ObjCollection","../network/protocol/RoleProtocols":"RoleProtocols","../network/protocol/TypeProtocols":"TypeProtocols","../utils/ConfigUtils":"ConfigUtils","../utils/GamePlatform":"GamePlatform","../utils/GameTools":"GameTools","../utils/GameUtils":"GameUtils","./EventConst":"EventConst"}],PopLayer:[function(e,t,o){"use strict";cc._RF.push(t,"214b4izH4dGE4JRcShhO1Mi","PopLayer");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0}),o.PopLayerInterface=o.POPLYAERSTATE=void 0;var n,r=e("./GuideLayer");(function(e){e[e.POPLYAERSTATE_CHEEK=0]="POPLYAERSTATE_CHEEK",e[e.POPLYAERSTATE_OPER=1]="POPLYAERSTATE_OPER"})(n=o.POPLYAERSTATE||(o.POPLYAERSTATE={}));var s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isZoomAnimation=!0,t.isLeftAnimation=!1,t.isRightAnimation=!1,t.m_popType=n.POPLYAERSTATE_CHEEK,t}return a(t,e),t.prototype.onLoad=function(){cc.log("HHHHHHHHHHHH PopLayerInterface onload"),n.POPLYAERSTATE_CHEEK==this.m_popType&&this.node.on(cc.Node.EventType.TOUCH_START,this.touchLayer,this,!0)},t.prototype.setCheeckState=function(){this.m_popType=n.POPLYAERSTATE_CHEEK},t.prototype.setOperatorState=function(){this.m_popType=n.POPLYAERSTATE_OPER},t.prototype.onClose=function(){cc.log("HHHHHHHHHHHHHHHHHH close")},t.prototype.touchLayer=function(){cc.log("HHHHHHHHHHHHHHHHHH touchLayer")},t.prototype.setVisible=function(e){e?this.node.active=!0:this.node.removeFromParent()},t.prototype.actionFinished=function(){},t}(r.NodeNameLayer);o.PopLayerInterface=s;var c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.resetNode=function(){},t.touchLayer=function(){},t}(r.NodeNameLayer);o.default=c,cc._RF.pop()},{"./GuideLayer":"GuideLayer"}],PopUpBuyView:[function(e,t,o){"use strict";cc._RF.push(t,"983d4RPhJlG3ZfTeFc/Fgu6","PopUpBuyView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=e("../../network/ClientNetwork"),l=e("../../network/LocalMessage"),d=e("../../StaticData/RechargeTableData"),u=e("../../utils/ConfigUtils"),h=e("../../utils/GameTools"),p=cc._decorator,f=p.ccclass,g=(p.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.m_rechargeId_saodangka=112,t}return a(t,e),t.path=function(){return"ui/shop/prefab/popupbuy"},t.prototype.start=function(){var e=this;c.ClientNetwork.getInstance().listenLocalMessage(l.LOCAL_MESSAGE.LocalMsg_RechargeSuccess,function(){e.closeView()},this),this.initBuy_saodangka()},t.prototype.initBuy_saodangka=function(){var e=this,t=this.node.getChildByName("saodangka").getChildByName("btn_buy"),o=this.node.getChildByName("saodangka").getChildByName("itemLayout"),i=d.RechargeTableData.getById(this.m_rechargeId_saodangka);t.getChildByName("txt").getComponent(cc.Label).string="\uffe5"+Math.floor(h.default.getRechargeMoneyByPlatform(i)/100),o.removeAllChildren(),i.prize.forEach(function(e){if(u.default.getInstance().getItemByID(e.dropID)){var t=e.dropID,i=e.dropNum;h.default.createNormalItemsWithNames(t,i,o,function(e){e.getChildByName("txt_name").active=!1})}}),t.off(cc.Node.EventType.TOUCH_END),t.on(cc.Node.EventType.TOUCH_END,function(){e.onCharge_Sodangka(i)},this)},t.prototype.onCharge_Sodangka=function(e){var t={rechargeID:e.id,rechargeNum:1};this.sendEvent("SendProtocolRecharge",t)},n([s.Register_Class,f],t)}(r.default));o.default=g,cc._RF.pop()},{"../../StaticData/RechargeTableData":"RechargeTableData","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../network/ClientNetwork":"ClientNetwork","../../network/LocalMessage":"LocalMessage","../../utils/ConfigUtils":"ConfigUtils","../../utils/GameTools":"GameTools"}],PrivacyProtocolView:[function(e,t,o){"use strict";cc._RF.push(t,"37a0dhF3mRD7KsAPT5QP6zi","PrivacyProtocolView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=e("../../network/ClientNetwork"),l=e("../../network/LocalMessage"),d=e("../../utils/GamePlatform"),u=e("../../utils/QQMiniGameUtils"),h=e("../../StaticData/WorldNoticeTableData"),p=cc._decorator,f=p.ccclass,g=p.property,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.m_txt_content=null,t}return a(t,e),t.path=function(){return"ui/protocol/PrivacyProtocolView"},t.prototype.start=function(){d.GamePlatform.isQQGameRoom()?this.requestProtocolByType("qqdating"):d.GamePlatform.isKuaishouMiniGame()?this.requestProtocolByType("kuaishou"):d.GamePlatform.Is5Add7SmallBag()?this.m_txt_content.string=h.WorldNoticeTableData.getById(2).content:this.requestProtocolByType()},t.prototype.init=function(e){e.showClose&&e.showClose?(this.node.getChildByName("close").active=!0,this.node.getChildByName("btncancel").active=!1,this.node.getChildByName("btnconfirm").active=!1):(this.node.getChildByName("close").active=!1,this.node.getChildByName("btncancel").active=!0,this.node.getChildByName("btnconfirm").active=!0)},t.prototype.onClickAgree=function(){c.ClientNetwork.getInstance().pushLocalMessage(l.LOCAL_MESSAGE.LocalMsg_AgreePrivacyProtocol)},t.prototype.onClickDisagree=function(){u.QQMiniGameUtils.getInstance().quitGame()},t.prototype.requestProtocolByType=function(e,t){void 0===e&&(e=""),void 0===t&&(t=2);var o="https://mszctest.gameserver.iplay11g.com/gmsys/weblogic/webc/getuserhelp.php?type="+t+"&platform="+e,i=this,a=new XMLHttpRequest;a.onload=function(){if(a.status>=200&&a.status<400){console.log("requestProtocolByType success",a);var e=a.responseText;if(e){var t=JSON.parse(e).value;i.m_txt_content.string=t}}},a.onerror=function(){console.log("requestProtocolByType Error, type="+t)},a.open("GET",o,!0),a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.timeout=1e4,a.send()},n([g(cc.RichText)],t.prototype,"m_txt_content",void 0),n([s.Register_Class,f],t)}(r.default);o.default=m,cc._RF.pop()},{"../../StaticData/WorldNoticeTableData":"WorldNoticeTableData","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../network/ClientNetwork":"ClientNetwork","../../network/LocalMessage":"LocalMessage","../../utils/GamePlatform":"GamePlatform","../../utils/QQMiniGameUtils":"QQMiniGameUtils"}],ProficiencyHelp:[function(e,t,o){"use strict";cc._RF.push(t,"fa1d8M8Y8tOQpuw+Bgcc/az","ProficiencyHelp");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../Global/GameGlobal"),s=e("../../utils/ConfigUtils"),c=e("../../common/PlayerModule"),l=e("../../utils/ResourcesManager"),d=e("../../modules/base/BaseView"),u=e("../../modules/base/Decorators"),h=e("../../utils/GameTools"),p=e("../../utils/GamePlatform"),f=e("../../StaticData/ProficiencyTableData"),g=e("../../utils/GameUtils"),m=e("../../network/ClientNetwork"),_=e("../../network/protocol/RoleProtocols"),y=e("../../common/CommandValue"),v=cc._decorator,C=v.ccclass,S=v.property,T=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.bCallShare=!1,t.heroId=0,t.shareLevel=0,t.levelName="",t.selNodeArray=[],t.scoreNodeArray=[],t}return a(t,e),t.path=function(){return"ui/heroCardBag/prefab/proficiencyHelp"},t.prototype.start=function(){var e=this;if(p.GamePlatform.isWechat()){var t=function(){if(1==e.bCallShare&&(console.log("\ufffd\ufffd\ufffd\ufffd\ufffd\u0279\ufffd"),e.bCallShare=!1,cc.isValid(e.node))){wx.offShow(t);var o=new _.C_Role_ProficiencyShare;o.heroId=e.heroId,o.shareLevel=e.shareLevel,m.ClientNetwork.getInstance().Send(_.ROLE_CLIENT_ENUM.P_Role_ProficiencyShare,o)}};wx.onShow(t)}var o=this.node.getChildByName("shareNode");h.default.registerTouchEvent(o,function(){if(p.GamePlatform.isWechat()){var t=s.default.getInstance().getHeroConfig(e.heroId).name,o=r.G.StringManager.getString("HERO_PROFICIENCY_DEFAULT",t,e.levelName);if(e.levelName.length<=0&&(o="\ufffd\ufffd\u01ff\u04e2\ufffd\u06e3\ufffd\u02ed\ufffd\ufffd\ufffd\ufffd\u057d\ufffd\u04a3\ufffd"),1==e.checkHeroIsRank(e.heroId)){var i=c.default.getHeroProficiencyDataById(e.heroId);i&&(console.log("\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd ",i),i.worldRank>0&&i.worldRank<=Number(g.getConfigIntValue("proficiency_world_rank_max_num"))?o=r.G.StringManager.getString("HERO_PROFICIENCY",i.worldRank,s.default.getInstance().getHeroConfig(e.heroId).name):i.localRank>0&&i.localRank<=Number(g.getConfigIntValue("proficiency_local_rank_max_num"))&&(o=r.G.StringManager.getString("HERO_PROFICIENCY_PROCINCE",i.ipName,i.localRank,s.default.getInstance().getHeroConfig(e.heroId).name)))}wx.shareAppMessage({title:o,imageUrl:"https://tfjl-1300944069.file.myqcloud.com/heroRankShare.png"}),e.bCallShare=!0}else{var a=new _.C_Role_ProficiencyShare;a.heroId=e.heroId,a.shareLevel=e.shareLevel,m.ClientNetwork.getInstance().Send(_.ROLE_CLIENT_ENUM.P_Role_ProficiencyShare,a)}})},t.prototype.init=function(e){var t=this;if(this.selNodeArray[Number(e.ProficiencyLv)-1].active=!0,f.ProficiencyTableData.getDataMap().forEach(function(e,o){t.scoreNodeArray[Number(o)-1].getComponent(cc.Label).string=e.minProficiency.toString()}),e.heroId){var o=this.node.getChildByName("proficiencyNode");if(o){var i=c.default.getHeroProficiencyDataById(e.heroId);if(i){o.getChildByName("proficiencylv").getComponent(cc.Label).string+=e.ProficiencyData.lvName,this.levelName=e.ProficiencyData.lvName,o.getChildByName("proficiencyNum").getComponent(cc.Label).string+=i.proficiency.toString();var a=s.default.getInstance().getItemByID(e.heroId),n=o.getChildByName("heroIcon").getComponent(cc.Sprite);if(l.default.loadSprite(a.icon,n,function(){}),i.worldRank>0&&i.worldRank<=Number(g.getConfigIntValue("proficiency_world_rank_max_num"))||i.localRank>0&&i.localRank<=Number(g.getConfigIntValue("proficiency_local_rank_max_num"))){var d=o.getChildByName("proficiencyInfo");d.active=!0;var u="";i.worldRank>0&&i.worldRank<=Number(g.getConfigIntValue("proficiency_world_rank_max_num"))?u=r.G.StringManager.getString("HERO_PROFICIENCY",i.worldRank,a.name):i.localRank>0&&i.localRank<=Number(g.getConfigIntValue("proficiency_local_rank_max_num"))&&(u=r.G.StringManager.getString("HERO_PROFICIENCY_PROCINCE",i.ipName,i.localRank,a.name)),d.getComponent(cc.Label).string=u}}}if(p.GamePlatform.isWechat()){if(0==c.default.checkModulerOnOffState(y.ModulerViewOnOff.ProficiencyShare))return this.node.getChildByName("shareNode").active=!1;var h=this.checkShareNodeState(e.heroId);this.node.getChildByName("shareNode").active=h;var m=this.getShareRewards(e.heroId);m&&m[0]&&(this.node.getChildByName("shareNode").children[3].getComponent(cc.Label).string=m[0].dropNum),this.heroId=e.heroId}else this.node.getChildByName("shareNode").active=!1}},t.prototype.getShareRewards=function(e){var t=null,o=c.default.getHeroProficiencyDataById(e);return o&&f.ProficiencyTableData.getDataMap().forEach(function(e){o.proficiency>=e.minProficiency&&o.proficiency<=e.maxProficiency&&(t=e.sharePrize)}),t},t.prototype.checkShareNodeState=function(e){var t=c.default.getHeroProficiencyDataById(e);if(t){var o=this.getProficiencyCurLevel(t.proficiency);if(o>=Number(g.getConfigIntValue("proficiency_share_level_num")))return(1!=t.shareData.has(o)||1!=t.shareData.get(o))&&(this.shareLevel=o,!0)}return!1},t.prototype.getProficiencyCurLevel=function(e){var t=0;return f.ProficiencyTableData.getDataMap().forEach(function(o){e>=o.minProficiency&&e<=o.maxProficiency&&(t=o.id)}),t},t.prototype.checkHeroIsRank=function(e){var t=c.default.getHeroProficiencyDataById(e);return!(!t||!(t.worldRank<=Number(g.getConfigIntValue("proficiency_world_rank_max_num"))||t.localRank<=Number(g.getConfigIntValue("proficiency_local_rank_max_num"))))},n([S(cc.Node)],t.prototype,"selNodeArray",void 0),n([S(cc.Node)],t.prototype,"scoreNodeArray",void 0),n([u.Register_Class,C],t)}(d.default);o.default=T,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/ProficiencyTableData":"ProficiencyTableData","../../common/CommandValue":"CommandValue","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../network/ClientNetwork":"ClientNetwork","../../network/protocol/RoleProtocols":"RoleProtocols","../../utils/ConfigUtils":"ConfigUtils","../../utils/GamePlatform":"GamePlatform","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils","../../utils/ResourcesManager":"ResourcesManager"}],ProficiencyTableData:[function(e,t,o){"use strict";cc._RF.push(t,"34a4cnk0lpMIJ1XBu6OVtvF","ProficiencyTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.ProficiencyTableData=void 0;var i=e("../TableReader"),a=e("./BaseTableData"),n=function(){function e(){this.id=0,this.minProficiency=0,this.maxProficiency=0,this.winAdd=0,this.lostDel=0,this.icon="",this.sharePrize=new Array,this.lvName=""}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.minProficiency=e.getNumber(),this.maxProficiency=e.getNumber(),this.winAdd=e.getNumber(),this.lostDel=e.getNumber(),this.icon=e.getString();for(var o=e.getString(),n=new i.TableReader(o);n.getPos()<n.getLen();){var r=new a.DropItem;r.readOriginal(n),this.sharePrize.push(r)}this.lvName=e.getString()},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"ProficiencyTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.ProficiencyTableData=n,cc._RF.pop()},{"../TableReader":"TableReader","./BaseTableData":"BaseTableData"}],PushGiftTableData:[function(e,t,o){"use strict";cc._RF.push(t,"2af8fhlsVZNLJ2a1c8sGQdY","PushGiftTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.PushGiftTableData=void 0;var i=e("../TableReader"),a=function(){function e(){this.id=0,this.rechargeId=0,this.goldNum=0,this.time=0,this.limit=0,this.type=0,this.conditionHero="",this.conditionTotalChargeNum=0,this.condition3=0,this.condition4=0}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.rechargeId=e.getNumber(),this.goldNum=e.getNumber(),this.time=e.getNumber(),this.limit=e.getNumber(),this.type=e.getNumber(),this.conditionHero=e.getString(),this.conditionTotalChargeNum=e.getNumber(),this.condition3=e.getNumber(),this.condition4=e.getNumber()},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"PushGiftTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.PushGiftTableData=a,cc._RF.pop()},{"../TableReader":"TableReader"}],PushGiftUtils:[function(e,t,o){"use strict";cc._RF.push(t,"2f2915cHV1H55jWoQWqZ6ou","PushGiftUtils"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../../load"),a=e("../../common/PlayerModule"),n=e("../../modules/base/GameView"),r=e("../../modules/manager/ViewManager"),s=e("../../network/protocol/TypeProtocols"),c=e("../../StaticData/PushGiftTableData"),l=e("../../StaticData/RechargeTableData"),d=e("../../utils/ConfigUtils"),u=function(){function e(){this.isPopup=!1}return Object.defineProperty(e,"Instance",{get:function(){return null==e.g_instance&&(e.g_instance=new e),e.g_instance},enumerable:!1,configurable:!0}),e.prototype.sortList=function(e,t){return e.endTime>t.endTime?-1:e.endTime<t.endTime?1:0},e.prototype.clearAllGift=function(){this.giftList=[]},e.prototype.getAllGifts=function(){return console.log("PushGiftUtils, getAllGifts start, giftList=",this.giftList),null==this.giftList?[]:(this.checkAdPushGift(),console.log("PushGiftUtils, getAllGifts end, giftList=",this.giftList),this.giftList)},e.prototype.checkAdPushGift=function(){if(null!=this.giftList&&this.giftList!=[])for(var e=this.giftList.length-1;e>=0;e--){var t=this.giftList[e],o=c.PushGiftTableData.getById(t.id);if(o&&3==o.type){var i=o.rechargeId;this.IsTaskFinished(i)&&this.giftList.splice(e,1)}}},e.prototype.IsTaskFinished=function(e){var t=Array.from(a.default.getRoleTaskData().tasks.values()),o=!1;return t.forEach(function(t){e==t.taskID&&t.taskState==s.TASK_STATE.TASK_STATE_FINISH&&(o=!0)}),o},e.prototype.updateData2=function(e){console.log("PushGiftUtils, updateData2 start, pList=",e),this.giftList=e,null==this.giftList&&(this.giftList=[]),this.giftList.sort(this.sortList),console.log("PushGiftUtils, updateData2 end, pList=",e)},e.prototype.updateData=function(e){console.log("PushGiftUtils, updateData start, pList=",e),this.giftList=e,null==this.giftList&&(this.giftList=[]),this.giftList.sort(this.sortList),this.isPopup=!0;for(var t=0;t<this.giftList.length;t++)if(this.giftList[t].isFirst){this.isPopup=!1;break}this.checkPopUpView(),console.log("PushGiftUtils, updateData end, pList=",e)},e.prototype.checkPopUpView=function(){if((!i.getSubmitReviewShopState()||cc.sys.os!=cc.sys.OS_IOS)&&(console.log("PushGiftUtils, checkPopUpView!!!  giftList=",this.giftList,",ViewManager.nodeList.length="+r.default.nodeList.length),1!=this.isPopup)){var e=n.default.getViewByName("MainSceneView");if(null!=e&&null!=e.view&&!(r.default.nodeList.length>1)&&null!=this.giftList&&0!=this.giftList.length){var t=this.giftList[this.giftList.length-1];null!=t?(n.default.addPopView("ShopMainCtrl","PushGiftView","PushGiftView",t),this.isPopup=!0):console.log("PushGiftUtils, gift == null")}}},e.prototype.showGiftView=function(){n.default.addPopView("ShopMainCtrl","PushGiftView","PushGiftView")},e.prototype.getHeroNameByGiftId=function(e){try{var t=c.PushGiftTableData.getById(e),o=l.RechargeTableData.getById(t.rechargeId).prize[0],i=d.default.getInstance().getDorpItemsByID(o.dropID).dropRandom.split("|")[0].split("#")[0],a=d.default.getInstance().getHeroConfig(i);if(a)return a.name}catch(n){}return"\u9650\u65f6\u793c\u5305"},e.prototype.getGiftNameById=function(e){var t=c.PushGiftTableData.getById(e);return 2==t.type||3==t.type?t.condition3+"\u676f":this.getHeroNameByGiftId(e)},e.prototype.getEntranceRemainTime=function(){if(null==this.giftList||0==this.giftList.length)return-1;for(var e=-1,t=0;t<this.giftList.length;t++){var o=this.giftList[t];o.endTime>a.default.getServersTime2()&&(e<0||o.endTime<e)&&(e=o.endTime)}return e},e.prototype.hasGift=function(){if(null==this.giftList||0==this.giftList.length)return!1;this.checkAdPushGift();for(var e=0;e<this.giftList.length;e++)if(this.giftList[e].endTime>a.default.getServersTime2())return!0;return!1},e}();o.default=u,cc._RF.pop()},{"../../../load":"load","../../StaticData/PushGiftTableData":"PushGiftTableData","../../StaticData/RechargeTableData":"RechargeTableData","../../common/PlayerModule":"PlayerModule","../../modules/base/GameView":"GameView","../../modules/manager/ViewManager":"ViewManager","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/ConfigUtils":"ConfigUtils"}],PushGiftView:[function(e,t,o){"use strict";cc._RF.push(t,"138bbcd6TBGmYowGC7+Zy06","PushGiftView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../common/NetworkProtocolCommon"),s=e("../../common/PlayerModule"),c=e("../../modules/base/BaseView"),l=e("../../modules/base/Decorators"),d=e("../../network/ClientNetwork"),u=e("../../network/protocol/RoleProtocols"),h=e("../../StaticData/PushGiftTableData"),p=e("../../StaticData/RechargeTableData"),f=e("../../StaticData/TaskTableData"),g=e("../../utils/ByteDanceMiniGameUtils"),m=e("../../utils/ConfigUtils"),_=e("../../utils/GamePlatform"),y=e("../../utils/GameTools"),v=e("../../utils/GameUtils"),C=e("../../utils/RewardedVideoAd"),S=e("../../utils/RewardedVideoUnitIdConst"),T=e("../../utils/subUtils/SpineMaker"),I=e("../../utils/TimeOffSetManager"),N=e("./PushGiftUtils"),b=cc._decorator,w=b.ccclass,E=b.property,P=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.txt_charge=null,t.btn_charge=null,t.gift1=null,t.gift2=null,t.heroImage=null,t.txt_time=null,t.tabBarPrefab=null,t.scrollContent=null,t.txt_charge_cup=null,t.btn_charge_cup=null,t.gift1_cup=null,t.gift2_cup=null,t.gift3_cup=null,t.heroImage_cup=null,t.txt_time_cup=null,t.txt_charge_ad=null,t.btn_charge_ad=null,t.heroImage_ad=null,t.txt_time_ad=null,t}return a(t,e),t.path=function(){return"ui/pushGift/PushGift"},t.prototype.init=function(e){this.currentData=e},t.prototype.onLoad=function(){},t.prototype.start=function(){d.ClientNetwork.getInstance().listenProtocol(u.ROLE_CLIENT_ENUM.P_Role_Push_Gift,function(e){console.log("\u6536\u5230\u63a8\u9001\u793c\u5305"),e.resetPos();var t=new u.S_Role_Push_Gift;t.read(e)&&(console.log("\u6536\u5230\u63a8\u9001\u793c\u5305\uff0crsp=",t),0==t.errorcode&&(null==t.list||0==t.list.length?this.closeView():(N.default.Instance.updateData2(t.list),this.updateTabs())))},this),d.ClientNetwork.getInstance().listenProtocol(u.ROLE_CLIENT_ENUM.P_Role_TakeTask,function(){this.updateTabs()},this),this.updateTabs()},t.prototype.updateTabs=function(){var e=this;if(this.allGifts=N.default.Instance.getAllGifts(),0!=this.allGifts.length){this.scrollContent.removeAllChildren(),this.btnList=[];for(var t=function(t){var i=o.allGifts[t];if(i.endTime-s.default.getServersTime2()<=0)return"continue";var a=cc.instantiate(o.tabBarPrefab);a.active=!0,a.name=t.toString(),a.parent=o.scrollContent,a.getChildByName("label").getComponent(cc.Label).string=N.default.Instance.getGiftNameById(i.id),a.on(cc.Node.EventType.TOUCH_END,function(){e.selectBtn(parseInt(a.name))},o),o.btnList.push(a)},o=this,i=0;i<this.allGifts.length;i++)t(i);0!=this.btnList.length?this.selectBtn(0):this.closeView()}else this.closeView()},t.prototype.selectBtn=function(e){if(!(e<0||e>=this.btnList.length)){this.prevBtn&&v.setTexture(this.prevBtn.getChildByName("Background").getComponent(cc.Sprite),"ui/pushGift/res/2"),this.prevBtn=this.btnList[e],v.setTexture(this.prevBtn.getChildByName("Background").getComponent(cc.Sprite),"ui/pushGift/res/1"),this.unschedule(this.updateTime),this.unschedule(this.updateTime_cup),this.currentData=this.allGifts[e];var t=this.currentData.id;this.giftTableData=h.PushGiftTableData.getById(t),2==this.giftTableData.type?this.showPage_cup(e):3==this.giftTableData.type?this.showPage_advertisement(e):this.showPage(e)}},t.prototype.showPage=function(e){var t=this;this.node.getChildByName("viewNode").active=!0,this.node.getChildByName("viewNodeCup").active=!1,this.node.getChildByName("viewNodeAdvertisement").active=!1,this.currentData=this.allGifts[e];var o=this.currentData.id;this.giftTableData=h.PushGiftTableData.getById(o),console.log("PushGiftView, id="+o+", type="+this.giftTableData.type),this.rechargeTableData=p.RechargeTableData.getById(this.giftTableData.rechargeId),this.txt_charge.getComponent(cc.Label).string="\uffe5"+Math.floor(y.default.getRechargeMoneyByPlatform(this.rechargeTableData)/100);var i=this.rechargeTableData.prize[0];console.log("PushGiftView, dropItem=",i);var a=m.default.getInstance().getDorpItemsByID(i.dropID).dropRandom.split("|"),n=a[0].split("#");if(v.setIconByItemId(i.dropID,this.gift1.getChildByName("heroImg").getComponent(cc.Sprite)),this.gift1.getChildByName("txt_itemNum").getComponent(cc.Label).string=n[1].toString(),this.heroImage){var r=m.default.getInstance().getDorpItemsByID(i.dropID).dropRandom.split("#")[0],s=m.default.getInstance().getHeroConfig(r),c=m.default.getInstance().getNpcTemplateConfig(s.npc_id,1),l=m.default.getInstance().getResConfig(c.res_id);T.SpineMaker.createSpineV2(c.res_id,this.heroImage).then(function(e){e&&(l.uiScale>0?t.heroImage.scale=l.uiScale/100:t.heroImage.scale=1,e.setAnimation(0,"idle",!0))})}var d=a[1].split("#");console.log("PushGiftView, dropItem2=",d),v.setIconByItemId(1001,this.gift2.getChildByName("heroImg").getComponent(cc.Sprite)),this.gift2.getChildByName("txt_itemNum").getComponent(cc.Label).string=d[1].toString(),this.btn_charge.off(cc.Node.EventType.TOUCH_END),this.btn_charge.on(cc.Node.EventType.TOUCH_END,function(){t.onRecharge()}),this.showTime()},t.prototype.showTime=function(){this.updateTime(),this.schedule(this.updateTime,1)},t.prototype.updateTime=function(){var e,t,o,i,a=this.currentData.endTime-s.default.getServersTime2();if(a<=0)return this.unschedule(this.updateTime),void this.updateTabs();this.txt_time.getComponent(cc.Label).string=(e=1e3*a,t=Math.floor(e/36e5),o=Math.floor(e%36e5/6e4),i=Math.floor(e%6e4)/1e3,I.TimeOffSetManager.getTimeStr(t,o,i)+"\u540e\u6d88\u5931")},t.prototype.onRecharge=function(){var e={rechargeID:this.rechargeTableData.id,rechargeNum:1};this.sendEvent("SendProtocolRecharge",e)},t.prototype.showPage_cup=function(e){var t=this;this.node.getChildByName("viewNode").active=!1,this.node.getChildByName("viewNodeCup").active=!0,this.node.getChildByName("viewNodeAdvertisement").active=!1,this.currentData=this.allGifts[e];var o=this.currentData.id;this.giftTableData=h.PushGiftTableData.getById(o),console.log("PushGiftView, id="+o+", type="+this.giftTableData.type),this.rechargeTableData=p.RechargeTableData.getById(this.giftTableData.rechargeId),this.txt_charge_cup.getComponent(cc.Label).string="\uffe5"+Math.floor(y.default.getRechargeMoneyByPlatform(this.rechargeTableData)/100);var i=this.rechargeTableData.prize[0];console.log("PushGiftView, dropItem=",i);var a=m.default.getInstance().getDorpItemsByID(i.dropID).dropRandom.split("|"),n=a[0].split("#");v.setIconByItemId(n[0],this.gift1_cup.getChildByName("heroImg").getComponent(cc.Sprite)),this.gift1_cup.getChildByName("txt_itemNum").getComponent(cc.Label).string=n[1].toString();var r=a[1].split("#");v.setIconByItemId(r[0],this.gift2_cup.getChildByName("heroImg").getComponent(cc.Sprite)),this.gift2_cup.getChildByName("txt_itemNum").getComponent(cc.Label).string=r[1].toString();var s=a[2].split("#");if(v.setIconByItemId(s[0],this.gift3_cup.getChildByName("heroImg").getComponent(cc.Sprite)),this.gift3_cup.getChildByName("txt_itemNum").getComponent(cc.Label).string=s[1].toString(),this.heroImage_cup){var c=n[0],l=m.default.getInstance().getHeroConfig(c),d=m.default.getInstance().getNpcTemplateConfig(l.npc_id,1),u=m.default.getInstance().getResConfig(d.res_id);T.SpineMaker.createSpineV2(d.res_id,this.heroImage_cup).then(function(e){e&&(u.uiScale>0?t.heroImage_cup.scale=u.uiScale/100:t.heroImage_cup.scale=1,e.setAnimation(0,"idle",!0))})}this.btn_charge_cup.off(cc.Node.EventType.TOUCH_END),this.btn_charge_cup.on(cc.Node.EventType.TOUCH_END,function(){t.onRecharge_cup()}),this.showTime_cup()},t.prototype.showTime_cup=function(){this.updateTime_cup(),this.schedule(this.updateTime_cup,1)},t.prototype.updateTime_cup=function(){var e,t,o,i,a=this.currentData.endTime-s.default.getServersTime2();if(a<=0)return this.unschedule(this.updateTime_cup),void this.updateTabs();this.txt_time_cup.getComponent(cc.Label).string=(e=1e3*a,t=Math.floor(e/36e5),o=Math.floor(e%36e5/6e4),i=Math.floor(e%6e4)/1e3,I.TimeOffSetManager.getTimeStr(t,o,i)+"\u540e\u6d88\u5931")},t.prototype.onRecharge_cup=function(){this.onRecharge()},t.prototype.showPage_advertisement=function(e){var t=this;this.node.getChildByName("viewNode").active=!1,this.node.getChildByName("viewNodeCup").active=!1,this.node.getChildByName("viewNodeAdvertisement").active=!0,this.currentData=this.allGifts[e];var o=this.currentData.id;this.giftTableData=h.PushGiftTableData.getById(o),console.log("PushGiftView, id="+o+", type="+this.giftTableData.type);var i=this.giftTableData.rechargeId,a=f.TaskTableData.getById(i).info3.split("|"),n=this.node.getChildByName("viewNodeAdvertisement").getChildByName("boxReward");n.getChildByName("card1").getChildByName("txt_num").getComponent(cc.Label).string="X"+a[0].toString(),n.getChildByName("card2").getChildByName("txt_num").getComponent(cc.Label).string="X"+a[1].toString(),n.getChildByName("card3").getChildByName("txt_num").getComponent(cc.Label).string="X"+a[2].toString(),n.getChildByName("card4").getChildByName("txt_num").getComponent(cc.Label).string="X"+a[3].toString(),this.txt_charge_ad.getComponent(cc.Label).string="",this.btn_charge_ad.off(cc.Node.EventType.TOUCH_END),this.btn_charge_ad.on(cc.Node.EventType.TOUCH_END,function(){t.onRecharge_ad()}),this.showTime_ad(),this.changeAdButtonSkins()},t.prototype.showTime_ad=function(){this.updateTime_ad(),this.schedule(this.updateTime_ad,1)},t.prototype.updateTime_ad=function(){var e,t,o,i,a=this.currentData.endTime-s.default.getServersTime2();if(a<=0)return this.unschedule(this.updateTime_ad),void this.updateTabs();this.txt_time_ad.getComponent(cc.Label).string=(e=1e3*a,t=Math.floor(e/36e5),o=Math.floor(e%36e5/6e4),i=Math.floor(e%6e4)/1e3,I.TimeOffSetManager.getTimeStr(t,o,i)+"\u540e\u6d88\u5931")},t.prototype.onRecharge_ad=function(){var e=this.currentData.id;this.giftTableData=h.PushGiftTableData.getById(e);var t=this.giftTableData.rechargeId,o=this;C.default.createVideo({name:"AdvertisementPushGift",adUnitId:S.RewardedVideoUnitIdConst.SociatyDonateBox,advertID:S.RewardedVideoClientIdConst.SociatyDonateBox,finishCb:function(){0!=o.isVaild()&&r.default.callPushGiftAdvertiseTask(t)}})},t.prototype.changeAdButtonSkins=function(){_.GamePlatform.isByteDanceMiniGame()&&(g.default.getInstance().changeSkinOfAdButton(this.btn_charge_ad,"advertise"),this.txt_charge_ad.string="\u514d\u8d39\u9886\u53d6")},n([E(cc.Label)],t.prototype,"txt_charge",void 0),n([E(cc.Node)],t.prototype,"btn_charge",void 0),n([E(cc.Node)],t.prototype,"gift1",void 0),n([E(cc.Node)],t.prototype,"gift2",void 0),n([E(cc.Node)],t.prototype,"heroImage",void 0),n([E(cc.Node)],t.prototype,"txt_time",void 0),n([E(cc.Node)],t.prototype,"tabBarPrefab",void 0),n([E(cc.Node)],t.prototype,"scrollContent",void 0),n([E(cc.Label)],t.prototype,"txt_charge_cup",void 0),n([E(cc.Node)],t.prototype,"btn_charge_cup",void 0),n([E(cc.Node)],t.prototype,"gift1_cup",void 0),n([E(cc.Node)],t.prototype,"gift2_cup",void 0),n([E(cc.Node)],t.prototype,"gift3_cup",void 0),n([E(cc.Node)],t.prototype,"heroImage_cup",void 0),n([E(cc.Node)],t.prototype,"txt_time_cup",void 0),n([E(cc.Label)],t.prototype,"txt_charge_ad",void 0),n([E(cc.Node)],t.prototype,"btn_charge_ad",void 0),n([E(cc.Node)],t.prototype,"heroImage_ad",void 0),n([E(cc.Node)],t.prototype,"txt_time_ad",void 0),n([l.Register_Class,w],t)}(c.default);o.default=P,cc._RF.pop()},{"../../StaticData/PushGiftTableData":"PushGiftTableData","../../StaticData/RechargeTableData":"RechargeTableData","../../StaticData/TaskTableData":"TaskTableData","../../common/NetworkProtocolCommon":"NetworkProtocolCommon","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../network/ClientNetwork":"ClientNetwork","../../network/protocol/RoleProtocols":"RoleProtocols","../../utils/ByteDanceMiniGameUtils":"ByteDanceMiniGameUtils","../../utils/ConfigUtils":"ConfigUtils","../../utils/GamePlatform":"GamePlatform","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils","../../utils/RewardedVideoAd":"RewardedVideoAd","../../utils/RewardedVideoUnitIdConst":"RewardedVideoUnitIdConst","../../utils/TimeOffSetManager":"TimeOffSetManager","../../utils/subUtils/SpineMaker":"SpineMaker","./PushGiftUtils":"PushGiftUtils"}],PveRewards:[function(e,t,o){"use strict";cc._RF.push(t,"40046Qv4YNP2ptODE9nDkTn","PveRewards");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../utils/ConfigUtils"),s=e("../../utils/GameTools"),c=e("../../common/PlayerModule"),l=e("../../network/protocol/RoleProtocols"),d=e("../../network/ClientNetwork"),u=e("../../Global/GameGlobal"),h=e("../../network/LocalMessage"),p=cc._decorator,f=p.ccclass,g=(p.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._mapId=0,t._needDrawIndex=0,t._boxNodeArr=[],t._currProgress=0,t}return a(t,e),t.prototype.onLoad=function(){this._closeNode=this.node.getChildByName("close"),this._drawRewardNode=this.node.getChildByName("btn_challenge"),this._noRewardNode=this.node.getChildByName("btn_challenge1"),this._proBarNode=this.node.getChildByName("ProgressBar"),this._boxNodePre=this.node.getChildByName("BoxNode"),this._boxNodePre.active=!1,this._rewardScrollView=this.node.getChildByName("reward_list").getComponent(cc.ScrollView)},t.prototype.init=function(e,t,o){if(this._mapId=e,this._currProgress=t,this._playerPveData=o,this._battleCfg=r.default.getInstance().getBattleCfg(),this._battleCfg[this._mapId]){for(var i=null,a=this._battleCfg[this._mapId].wave_rewards.split("|"),n=Number(a[a.length-1]),c=function(e){var o=cc.instantiate(l._boxNodePre);o.active=!0,o.parent=l._proBarNode,o.getChildByName("vaule").getComponent(cc.Label).string=a[e],o.x=l._proBarNode.width*(Number(a[e])/n),o.y=20,l._boxNodeArr.push(o),o.getChildByName("box").on(cc.Node.EventType.TOUCH_END,l.onClickBoxCallBack,l),e==a.length-1&&(o.getChildByName("xiegang").active=!1),1==l.checkDrawRewards(e)&&(o.getChildByName("box").getChildByName("Background").active=!1,o.getChildByName("box").getChildByName("Background1").active=!0),t>=Number(a[e])&&(i=o),s.default.createRedPointNode(function(e){e.parent=o.getChildByName("box")})},l=this,d=0;d<a.length;d++)c(d);i||(i=this._boxNodeArr[0]),this.onSelectBoxCallBack(i.getChildByName("box")),this._battleCfg[this._mapId]&&(this._proBarNode.getComponent(cc.ProgressBar).progress=t/this._battleCfg[this._mapId].wave),this.onRoleGetChapterReward(),this.onNodeEvevt(),this.refreshRedPoint()}else cc.log("not battleCfg")},t.prototype.onRoleGetChapterReward=function(){d.ClientNetwork.getInstance().listenProtocol(l.ROLE_CLIENT_ENUM.P_Role_GetChapterReward,function(e){var t=this;e.resetPos();var o=new l.S_Role_GetChapterReward;if(o.read(e))if(0===o.errorcode){var i=c.default.getBattlePveData();i.chapterInfoMap.forEach(function(e){e.chapterId===t._mapId&&e.rewardBoxStateMap.forEach(function(o,i){i==Number(t._needDrawIndex)&&e.rewardBoxStateMap.set(i,1)})}),c.default.setBattlePveData(i),this._playerPveData=i,this._selectBoxNode&&(this._selectBoxNode.getChildByName("Background").active=!1,this._selectBoxNode.getChildByName("Background1").active=!0),this._noRewardNode.active=!1,this._drawRewardNode.active=!1,this.refreshRedPoint(),d.ClientNetwork.getInstance().pushLocalMessage(h.LOCAL_MESSAGE.LocalMsg_RefreshPveRedPoint)}else u.G.StringManager.PopString(r.default.getInstance().getStringValueCfg(2).string_value)},this)},t.prototype.onNodeEvevt=function(){var e=this;this._closeNode.on(cc.Node.EventType.TOUCH_END,function(){e.node.destroy()}),this._drawRewardNode.on(cc.Node.EventType.TOUCH_END,function(){var t=new l.C_Role_GetChapterReward;t.chapterId=e._mapId,t.chapterRewardIndex=Number(e._needDrawIndex),d.ClientNetwork.getInstance().Send(l.ROLE_CLIENT_ENUM.P_Role_GetChapterReward,t)})},t.prototype.onSelectBoxCallBack=function(e){for(var t=0;t<this._boxNodeArr.length;t++){var o=this._boxNodeArr[t].getChildByName("box");o==e?(o.getChildByName("active1").active=!0,this.initRewards(t)):o.getChildByName("active1").active=!1}this._selectBoxNode=e},t.prototype.onClickBoxCallBack=function(e){this.onSelectBoxCallBack(e.target)},t.prototype.checkDrawRewards=function(e){var t=this,o=!1,i=this._battleCfg[this._mapId].wave_rewards.split("|"),a=null;return this._playerPveData.chapterInfoMap.forEach(function(e){e.chapterId===t._mapId&&(a=e.rewardBoxStateMap)}),a&&a.forEach(function(t,a){a==i[e]&&1==t&&(o=!0)}),o},t.prototype.initRewards=function(e){var t=this;if(this._battleCfg[this._mapId]){var o="";o=0===e?this._battleCfg[this._mapId].level_rewards1:1==e?this._battleCfg[this._mapId].level_rewards2:2==e?this._battleCfg[this._mapId].level_rewards3:3==e?this._battleCfg[this._mapId].level_rewards4:4==e?this._battleCfg[this._mapId].level_rewards5:this._battleCfg[this._mapId].level_rewards6,this._rewardScrollView.content.removeAllChildren();var i=o.split("|");for(var a in i){var n=i[a].split("#");s.default.createNormalItems(n[0],n[1],this._rewardScrollView.content)}}var r=this._battleCfg[this._mapId].wave_rewards.split("|"),c=null;this._playerPveData.chapterInfoMap.forEach(function(e){e.chapterId===t._mapId&&(c=e.rewardBoxStateMap)}),this._currProgress>=r[e]?(this._noRewardNode.active=!1,this._drawRewardNode.active=!0,c&&c.forEach(function(o,i){i==r[e]&&1==o&&(t._noRewardNode.active=!1,t._drawRewardNode.active=!1,t._boxNodeArr[e].getChildByName("box").getChildByName("Background").active=!1,t._boxNodeArr[e].getChildByName("box").getChildByName("Background1").active=!0)})):(this._noRewardNode.active=!0,this._drawRewardNode.active=!1),this._needDrawIndex=r[e]},t.prototype.refreshRedPoint=function(){if(cc.isValid(this.node))for(var e=this._battleCfg[this._mapId].wave_rewards.split("|"),t=0;t<e.length;t++)this._boxNodeArr[t].getChildByName("box").getChildByName("redPointNode").active=!1,this._currProgress>=Number(e[t])&&1==!this.checkDrawRewards(t)&&(this._boxNodeArr[t].getChildByName("box").getChildByName("redPointNode").active=!0)},n([f],t)}(cc.Component));o.default=g,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../common/PlayerModule":"PlayerModule","../../network/ClientNetwork":"ClientNetwork","../../network/LocalMessage":"LocalMessage","../../network/protocol/RoleProtocols":"RoleProtocols","../../utils/ConfigUtils":"ConfigUtils","../../utils/GameTools":"GameTools"}],PveTemplate:[function(e,t,o){"use strict";cc._RF.push(t,"ca3e3npHmRBHZkhg1mChFs8","PveTemplate");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../utils/ResourcesManager"),s=e("../../common/PlayerModule"),c=e("../../utils/ConfigUtils"),l=e("../../Global/GameGlobal"),d=e("../../utils/GameTools"),u=cc._decorator,h=u.ccclass,p=(u.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._mapId=0,t._curChapterProgress=0,t}return a(t,e),t.prototype.onLoad=function(){this._mapResNode=this.node.getChildByName("map"),this._diffNode=this.node.getChildByName("diff"),this._levelPro=this.node.getChildByName("ongoing").getChildByName("progress"),this._passNode=this.node.getChildByName("clear"),this._lockNode=this.node.getChildByName("lock"),this._selectNode=this.node.getChildByName("selected"),this._rewardNode=this.node.getChildByName("reward")},t.prototype.start=function(){var e=this;this.node.on(cc.Node.EventType.TOUCH_END,function(){1!=e._lockNode.active?1!=e._passNode.active||l.G.StringManager.PopString(l.G.StringManager.getString("PVE_SUCCESS")):l.G.StringManager.PopString(l.G.StringManager.getString("PVE_FAIL"))},this),this._rewardNode.on(cc.Node.EventType.TOUCH_END,function(){r.default.loadPrefab("ui/pve/pve_reward",e._sourceNode,function(t){t.getComponent("PveRewards").init(e._mapId,e._curChapterProgress,e._PlayerData)})},this)},t.prototype.init=function(e,t){var o=this;r.default.loadSprite(e.map_res,this._mapResNode.getComponent(cc.Sprite));for(var i=0;i<e.difficulty;i++)this._diffNode.getChildByName(i+"").active=!0;var a=s.default.getBattlePveData();this._PlayerData=a,a.currentChapterId>e.id?(this._passNode.active=!0,this._lockNode.active=!1):(this._passNode.active=!1,this._lockNode.active=!0),a.currentChapterId==e.id?(this._selectNode.active=!0,this._lockNode.active=!1):this._selectNode.active=!1,a.chapterInfoMap.forEach(function(t){t.chapterId===e.id&&(o._levelPro.getComponent(cc.Label).string=t.chapterProgress+"/"+e.wave,o._curChapterProgress=t.chapterProgress)}),this._sourceNode=t,this._mapId=e.id,d.default.createRedPointNode(function(e){e.parent=o._rewardNode,o._redPointNode=e,!0===o.checkAvailableRewards(o._mapId,o._curChapterProgress)?o._redPointNode.active=!0:o._redPointNode.active=!1})},t.prototype.checkAvailableRewards=function(e,t){var o=c.default.getInstance().getBattleCfg();if(!o[e])return cc.log("not battleCfg"),!1;for(var i=!1,a=o[e].wave_rewards.split("|"),n=function(o){if(t>=Number(a[o])){var n=null;s.default.getBattlePveData().chapterInfoMap.forEach(function(t){t.chapterId===e&&(n=t.rewardBoxStateMap)}),n&&n.forEach(function(e,t){t==Number(a[o])&&0==e&&(i=!0)})}},r=0;r<a.length;r++)n(r);return i},n([h],t)}(cc.Component));o.default=p,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../common/PlayerModule":"PlayerModule","../../utils/ConfigUtils":"ConfigUtils","../../utils/GameTools":"GameTools","../../utils/ResourcesManager":"ResourcesManager"}],PveView:[function(e,t,o){"use strict";cc._RF.push(t,"89ab6HDVmlEyagRdUGC/bj5","PveView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../utils/ConfigUtils"),s=e("../../common/CombatModule"),c=e("../../common/PlayerModule"),l=e("../../Global/GameGlobal"),d=e("../../utils/UIManager"),u=e("../../network/ClientNetwork"),h=e("../../network/LocalMessage"),p=cc._decorator,f=p.ccclass,g=(p.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.onLoad=function(){this._battleNode=this.node.getChildByName("battleNode"),this._scrollView=this.node.getChildByName("allMaps").getComponent(cc.ScrollView)},t.prototype.start=function(){var e=this;this._battleNode.on(cc.Node.EventType.TOUCH_END,this.onClickBattleNode,this),this.initScrollContent(),u.ClientNetwork.getInstance().listenLocalMessage(h.LOCAL_MESSAGE.LocalMsg_RefreshPveRedPoint,function(){for(var t=c.default.getBattlePveData(),o=function(o){var i=e._scrollView.content.children[o].getComponent("PveTemplate");i._redPointNode.active=!1,t.chapterInfoMap.forEach(function(e){i._mapId==e.chapterId&&!0===i.checkAvailableRewards(e.chapterId,e.chapterProgress)&&(i._redPointNode.active=!0)})},i=0;i<e._scrollView.content.children.length;i++)o(i)},this)},t.prototype.initScrollContent=function(){var e=this;cc.resources.load("ui/pve/pve_map",cc.Prefab,function(t,o){if(t)cc.log("load ui/pve/pve_map err:",t);else{var i=r.default.getInstance().getBattleCfg();for(var a in i)if(1===i[a].type){var n=cc.instantiate(o);e._scrollView.content.addChild(n),n.getComponent("PveTemplate").init(i[a],e.node),c.default.getBattlePveData().currentChapterId==i[a].id&&(e._mapId=i[a].id,e._mathId=i[a].bath_id)}}})},t.prototype.onClickBackNode=function(){this.node&&this.node.destroy()},t.prototype.onClickBattleNode=function(){s.default.setCombatType(s.CombatType.PVE),s.default.setBatchMonsterId(this._mathId),s.default.setBattleMapId(this._mapId),l.G.UIManager.LoadScene(d.SceneName.PveFightScene,d.SceneTag.PveFightScene)},n([f],t)}(cc.Component));o.default=g,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../common/CombatModule":"CombatModule","../../common/PlayerModule":"PlayerModule","../../network/ClientNetwork":"ClientNetwork","../../network/LocalMessage":"LocalMessage","../../utils/ConfigUtils":"ConfigUtils","../../utils/UIManager":"UIManager"}],QQBlueReviewItem:[function(e,t,o){"use strict";cc._RF.push(t,"76ba9meRhNIa7t8avEjgiOt","QQBlueReviewItem");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../utils/QQGameHallUtils"),s=e("../../utils/ResourcesManager"),c=cc._decorator,l=c.ccclass,d=(c.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.start=function(){},t.prototype.init=function(e){this.tableData=e;var t=this.tableData.dropId;r.QQGameHallUtils.showItemsToContainer(t,this.node.getChildByName("reward"));var o=this.tableData.level,i=r.QQGameHallUtils.getBlueVipIconUrlByLV(o);s.default.loadSprite(i,this.node.getChildByName("icon").getComponent(cc.Sprite))},n([l],t)}(cc.Component));o.default=d,cc._RF.pop()},{"../../utils/QQGameHallUtils":"QQGameHallUtils","../../utils/ResourcesManager":"ResourcesManager"}],QQBlueReview:[function(e,t,o){"use strict";cc._RF.push(t,"c99cfi73vRPnqMCvZbvDSuC","QQBlueReview");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=e("../../network/protocol/TypeProtocols"),l=e("../../utils/GameUtils"),d=e("../../utils/QQGameHallUtils"),u=e("./QQBlueReviewItem"),h=cc._decorator,p=h.ccclass,f=h.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.scrollContent=null,t}return a(t,e),t.path=function(){return"ui/qqhall/qqblueReview"},t.prototype.start=function(){var e=this,t=d.QQGameHallUtils.getTableDataByType(c.QQHALL_REWARD_TYPE.QQHALL_REWARD_TYPE_BLUE_DAY_LEVEL);this.scrollContent.removeAllChildren();for(var o=function(o){l.LoadNode("ui/qqhall/qqblueReviewItem").then(function(i){i.parent=e.scrollContent,i.getComponent(u.default).init(t[o])})},i=0;i<t.length;i++)o(i)},n([f(cc.Node)],t.prototype,"scrollContent",void 0),n([s.Register_Class,p],t)}(r.default);o.default=g,cc._RF.pop()},{"../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/GameUtils":"GameUtils","../../utils/QQGameHallUtils":"QQGameHallUtils","./QQBlueReviewItem":"QQBlueReviewItem"}],QQBlueVipView:[function(e,t,o){"use strict";cc._RF.push(t,"770edW7HWlNBL7SWM+IwTes","QQBlueVipView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=e("../../network/ClientNetwork"),l=e("../../network/protocol/RoleProtocols"),d=e("../../network/protocol/TypeProtocols"),u=e("../../utils/GameTools"),h=e("../../utils/GameUtils"),p=e("../../utils/QQGameHallUtils"),f=e("../../utils/ResourcesManager"),g=e("./QQHallListItem"),m=cc._decorator,_=m.ccclass,y=m.property,v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.scrollContent_level=null,t.scrollContent_day=null,t}return a(t,e),t.path=function(){return"ui/qqhall/qqbluevip"},t.prototype.onLoad=function(){this.node_panelNew=this.node.getChildByName("giftNew"),this.node_panelLevel=this.node.getChildByName("giftLevel"),this.node_panelDay=this.node.getChildByName("giftDay")},t.prototype.start=function(){var e=this;c.ClientNetwork.getInstance().listenProtocol(l.ROLE_CLIENT_ENUM.P_Role_QQHall_GetReward,function(t){t.resetPos();var o=new l.S_Role_QQHall_GetReward;o.read(t)&&0==o.errorcode&&1==e.node.active&&(e.initPanelNew(),e.initPanelLevel(),e.initPanelDay())},this);var t=this.node.getChildByName("top").getChildByName("btn_buyBlue"),o=this.node.getChildByName("top").getChildByName("btn_buyYearBlue");p.QQGameHallUtils.isBlueVip()&&f.default.loadSprite("qqhall/rebuy",t.getChildByName("Background").getComponent(cc.Sprite)),p.QQGameHallUtils.isBlueVipYear()&&f.default.loadSprite("qqhall/rebuy_year",o.getChildByName("Background").getComponent(cc.Sprite)),u.default.registerTouchEvent(t,function(){p.QQGameHallUtils.getInstance().openBuyBlueVip(3)},this),u.default.registerTouchEvent(o,function(){p.QQGameHallUtils.getInstance().openBuyBlueVip(3,12)},this),u.default.registerTouchEvent(this.node.getChildByName("top").getChildByName("btn_goto"),function(){p.QQGameHallUtils.openBlueVipWebsite()},this),this.onClickTabNew()},t.prototype.initPanelNew=function(){var e=this.node_panelNew.getChildByName("finish"),t=this.node_panelNew.getChildByName("finish_year"),o=this.node_panelNew.getChildByName("btn_new_lingqu"),i=this.node_panelNew.getChildByName("btn_yearNew_lingqu"),a=p.QQGameHallUtils.getTableDataByType(d.QQHALL_REWARD_TYPE.QQHALL_REWARD_TYPE_BLUE_NEW)[0].dropId;p.QQGameHallUtils.showItemsToContainer(a,this.node_panelNew.getChildByName("reward"));var n=p.QQGameHallUtils.getTableDataByType(d.QQHALL_REWARD_TYPE.QQHALL_REWARD_TYPE_BLUE_YEAR)[0].dropId;p.QQGameHallUtils.showItemsToContainer(n,this.node_panelNew.getChildByName("reward_year")),u.default.registerTouchEvent(o,function(){var e=new l.C_Role_QQHall_GetReward;e.type=d.QQHALL_REWARD_TYPE.QQHALL_REWARD_TYPE_BLUE_NEW,e.level=0,c.ClientNetwork.getInstance().Send(l.ROLE_CLIENT_ENUM.P_Role_QQHall_GetReward,e)},this),u.default.registerTouchEvent(i,function(){var e=new l.C_Role_QQHall_GetReward;e.type=d.QQHALL_REWARD_TYPE.QQHALL_REWARD_TYPE_BLUE_YEAR,e.level=0,c.ClientNetwork.getInstance().Send(l.ROLE_CLIENT_ENUM.P_Role_QQHall_GetReward,e)},this),u.default.registerTouchEvent(this.node_panelNew.getChildByName("btn_buyBlue"),function(){p.QQGameHallUtils.getInstance().openBuyBlueVip(3)},this),u.default.registerTouchEvent(this.node_panelNew.getChildByName("btn_buyYearBlue"),function(){p.QQGameHallUtils.getInstance().openBuyBlueVip(3,12)},this),p.QQGameHallUtils.isBlueVip()?(this.node_panelNew.getChildByName("btn_buyBlue").active=!1,p.QQGameHallUtils.isRewardReceived(d.QQHALL_REWARD_TYPE.QQHALL_REWARD_TYPE_BLUE_NEW,0)?(e.active=!0,o.active=!1):(e.active=!1,o.active=!0)):(o.active=!1,this.node_panelNew.getChildByName("btn_buyBlue").active=!0,e.active=!1),p.QQGameHallUtils.isBlueVipYear()?(this.node_panelNew.getChildByName("btn_buyYearBlue").active=!1,p.QQGameHallUtils.isRewardReceived(d.QQHALL_REWARD_TYPE.QQHALL_REWARD_TYPE_BLUE_YEAR,0)?(t.active=!0,i.active=!1):(t.active=!1,i.active=!0)):(i.active=!1,this.node_panelNew.getChildByName("btn_buyYearBlue").active=!0,t.active=!1)},t.prototype.initPanelLevel=function(){var e=this,t=p.QQGameHallUtils.getTableDataByType(d.QQHALL_REWARD_TYPE.QQHALL_REWARD_TYPE_BLUE_LEVEL);this.scrollContent_level.removeAllChildren();for(var o=function(o){h.LoadNode("ui/qqhall/qqhallLIstItem").then(function(i){i.parent=e.scrollContent_level,i.getComponent(g.default).init(t[o])})},i=0;i<t.length;i++)o(i)},t.prototype.initPanelDay=function(){var e=this,t=[];t.push(p.QQGameHallUtils.getTableDataByType(d.QQHALL_REWARD_TYPE.QQHALL_REWARD_TYPE_BLUE_DAY_YEAR)[0]);var o=p.QQGameHallUtils.getBlueVipLv();o<1&&(o=1),o>7&&(o=7),t.push(p.QQGameHallUtils.getTableDataByType(d.QQHALL_REWARD_TYPE.QQHALL_REWARD_TYPE_BLUE_DAY_LEVEL)[o-1]),t.push(p.QQGameHallUtils.getTableDataByType(d.QQHALL_REWARD_TYPE.QQHALL_REWARD_TYPE_BLUE_DAY_SUPER)[0]),this.scrollContent_day.removeAllChildren();for(var i=function(o){h.LoadNode("ui/qqhall/qqhallLIstItem").then(function(i){i.parent=e.scrollContent_day,i.getComponent(g.default).init(t[o])})},a=0;a<t.length;a++)i(a)},t.prototype.onClickTabNew=function(){this.node_panelNew.active=!0,this.node_panelLevel.active=!1,this.node_panelDay.active=!1,this.initPanelNew()},t.prototype.onClickTabLevel=function(){this.node_panelNew.active=!1,this.node_panelLevel.active=!0,this.node_panelDay.active=!1,this.initPanelLevel()},t.prototype.onClickTabDay=function(){this.node_panelNew.active=!1,this.node_panelLevel.active=!1,this.node_panelDay.active=!0,this.initPanelDay()},n([y(cc.Node)],t.prototype,"scrollContent_level",void 0),n([y(cc.Node)],t.prototype,"scrollContent_day",void 0),n([s.Register_Class,_],t)}(r.default);o.default=v,cc._RF.pop()},{"../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../network/ClientNetwork":"ClientNetwork","../../network/protocol/RoleProtocols":"RoleProtocols","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils","../../utils/QQGameHallUtils":"QQGameHallUtils","../../utils/ResourcesManager":"ResourcesManager","./QQHallListItem":"QQHallListItem"}],QQExchange:[function(e,t,o){"use strict";cc._RF.push(t,"cd43cetzbpFMqrPPanj/Mit","QQExchange");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../modules/base/BaseView"),s=e("../modules/base/Decorators"),c=e("../network/ClientNetwork"),l=e("../modules/base/GameView"),d=e("../network/protocol/RoleProtocols"),u=e("../network/protocol/TypeProtocols"),h=e("../utils/GamePlatform"),p=e("../common/PlayerModule"),f=e("../StaticData/TaskTableData"),g=e("../Global"),m=cc._decorator,_=m.ccclass,y=m.property,v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.RewardNode=null,t.tip=null,t.tipOver=null,t.taskId=0,t.isReceive=!1,t}return a(t,e),t.path=function(){return"ui/CommonPrefab/QQExchange"},t.prototype.onLoad=function(){var e=this;c.ClientNetwork.getInstance().listenProtocol(d.ROLE_CLIENT_ENUM.P_Role_ClientTaskAddCount,function(t){t.resetPos();var o=new d.S_Role_ClientTaskAddCount;o.read(t)&&0==o.errorcode&&(e.isReceive=!0)},this),c.ClientNetwork.getInstance().listenProtocol(d.ROLE_CLIENT_ENUM.P_Role_TakeTask,function(e){e.resetPos();var t=new d.S_Role_TakeTask;t.read(e)&&0==t.errorcode&&t.prize.length>0&&l.default.addPopView("BaseCtrl","AcquirePopupView","AcquirePopupView",{items:t.prize})},this)},t.prototype.start=function(){g.default.Instance._isShowQQExchange=!0;var e=[];if(Array.from(p.default.getRoleTaskData().tasks.values()).forEach(function(t){var o=f.TaskTableData.getById(t.taskID);o&&58==o.clientType&&e.push(t)}),e.length>0){var t=f.TaskTableData.getById(e[0].taskID);if(this.taskId=e[0].taskID,e[0].taskState==u.TASK_STATE.TASK_STATE_FINISH)this.RewardNode.active=!1,this.tip.active=!0;else if(e[0].taskCount/t.finishCount>=1)this.isReceive=!0;else{var o=new d.C_Role_ClientTaskAddCount;o.taskID=e[0].taskID,o.count=1,c.ClientNetwork.getInstance().Send(d.ROLE_CLIENT_ENUM.P_Role_ClientTaskAddCount,o)}}else this.RewardNode.active=!1,this.tip.active=!1,this.tipOver.active=!0},t.prototype.okBtnCallBack=function(){if(this.closeView(),h.GamePlatform.isQQMiniGame()&&0!=this.isReceive){var e=new d.C_Role_TakeTask;e.taskID=this.taskId,c.ClientNetwork.getInstance().Send(d.ROLE_CLIENT_ENUM.P_Role_TakeTask,e)}},t.prototype.onDestroy=function(){c.ClientNetwork.getInstance().removeMessageTarget(this)},n([y(cc.Node)],t.prototype,"RewardNode",void 0),n([y(cc.Node)],t.prototype,"tip",void 0),n([y(cc.Node)],t.prototype,"tipOver",void 0),n([s.Register_Class,_],t)}(r.default);o.default=v,cc._RF.pop()},{"../Global":"Global","../StaticData/TaskTableData":"TaskTableData","../common/PlayerModule":"PlayerModule","../modules/base/BaseView":"BaseView","../modules/base/Decorators":"Decorators","../modules/base/GameView":"GameView","../network/ClientNetwork":"ClientNetwork","../network/protocol/RoleProtocols":"RoleProtocols","../network/protocol/TypeProtocols":"TypeProtocols","../utils/GamePlatform":"GamePlatform"}],QQGameHallUtils:[function(e,t,o){"use strict";cc._RF.push(t,"41ac4ouRNlIkZC3ANIqFUkz","QQGameHallUtils");var i=this&&this.__awaiter||function(e,t,o,i){return new(o||(o=Promise))(function(a,n){function r(e){try{c(i.next(e))}catch(t){n(t)}}function s(e){try{c(i.throw(e))}catch(t){n(t)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(r,s)}c((i=i.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){var o,i,a,n,r={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return n={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function s(e){return function(t){return c([e,t])}}function c(n){if(o)throw new TypeError("Generator is already executing.");for(;r;)try{if(o=1,i&&(a=2&n[0]?i.return:n[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return r.label++,{value:n[1],done:!1};case 5:r.label++,i=n[1],n=[0];continue;case 7:n=r.ops.pop(),r.trys.pop();continue;default:if(!(a=(a=r.trys).length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){r=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){r.label=n[1];break}if(6===n[0]&&r.label<a[1]){r.label=a[1],a=n;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(n);break}a[2]&&r.ops.pop(),r.trys.pop();continue}n=t.call(e,r)}catch(s){n=[6,s],i=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.QQGameHallUtils=void 0;var n=e("../../load"),r=e("../common/PlayerModule"),s=e("../Global/GameGlobal"),c=e("../network/ClientNetwork"),l=e("../network/LocalMessage"),d=e("../network/protocol/RechargeProtocols"),u=e("../network/protocol/RoleProtocols"),h=e("../StaticData/RechargeTableData"),p=e("./GamePlatform"),f=e("./GameUtils"),g=e("./subUtils/TypeDef"),m=e("../common/NetworkProtocolCommon"),_=e("../network/protocol/TypeProtocols"),y=e("../modules/base/GameView"),v=e("../StaticData/TaskTableData"),C=e("../TalkingDataAPI"),S=e("./LogUtil"),T=e("../model/ServerAddrInfo"),I=e("./ResourcesManager"),N=e("./GameTools"),b=e("./ConfigUtils"),w=e("../StaticData/QQHallRewardTableData"),E=e("./TimeOffSetManager"),P=e("./MD5"),R=function(){function e(){this.m_nPlatformOS=1,this.m_strEncryptedData="",this.m_strIv="",this.m_weichatLoginData=null,this.m_gameClubBtn=null,this.m_syncLiveTime=null,this.m_bFeishuConversion=!1,this.m_click_auth=!1,this.appid="1108243339"}return e.getInstance=function(){return this.Instance||(this.Instance=new e),this.Instance},e.prototype.getWechatLoginData=function(){return this.m_weichatLoginData},e.prototype.getWechatOS=function(){return this.m_nPlatformOS},e.prototype.requestQQServer=function(){var e="https://mszcs1.gameserver.iplay11g.com/gmsys/weblogic/webc/qqhallloginbygroup.php";!0===this.getSubmitState()&&(e="https://mszctest.gameserver.iplay11g.com/gmsys/weblogic/webc/qqhallloginbygroup.php"),e=e+"?accountname="+this.m_weichatLoginData.accountname+"&open_id="+this.m_weichatLoginData.openid+"&systematic="+this.m_nPlatformOS+"&session_key="+this.m_weichatLoginData.session_key+"&ver="+n.wechatminiLoaclGameVer+"&groupid="+g.GlobalVar.getServerGroup().toString(),console.log("QQGameHallUtils, requestQQServer, url="+e);var t=this,o=new XMLHttpRequest;o.onreadystatechange=function(){if(4==o.readyState&&o.status>=200&&o.status<400){var e=JSON.parse(o.responseText);console.log("qq dating, loginbygroup=",e),e?(t.m_weichatLoginData.sign=e.sign,c.ClientNetwork.getInstance().pushLocalMessage(l.LOCAL_MESSAGE.LocalMsg_GetServerAddr,e)):console.log("qq dating, loginbygroup Error, return is null")}},o.onerror=function(){console.log("qq dating, loginbygroup Error"),c.ClientNetwork.getInstance().pushLocalMessage(l.LOCAL_MESSAGE.LocalMsg_GetServerAddr,{error:-2})},o.open("GET",e,!0),o.send()},e.prototype.userLogin=function(){console.log("QQ\u6e38\u620f\u5927\u5385, userLogin!"),this.onLogin()},e.prototype.onLogin=function(){console.log("qq dating, onLogin!"),cc.sys.os==cc.sys.OS_IOS?this.m_nPlatformOS=2:cc.sys.os==cc.sys.OS_WINDOWS&&(this.m_nPlatformOS=3);var t=T.ServerAddrInfo.getInstance().getServerListUrl();console.log("qq dating, onLogin url="+t),this.openid=p.GamePlatform.getQQGameUrlParam("openid"),this.openKey=p.GamePlatform.getQQGameUrlParam("openKey"),this.pf=p.GamePlatform.getQQGameUrlParam("pf"),this.pfKey=p.GamePlatform.getQQGameUrlParam("pfKey"),t=t+"?openid="+this.openid+"&openKey="+this.openKey+"&systematic="+this.m_nPlatformOS,console.log("qq dating, get qqservergroup, url="+t);var o=this,i=new XMLHttpRequest;i.onreadystatechange=function(){if(4==i.readyState&&i.status>=200&&i.status<400){var t=JSON.parse(i.responseText);console.log("qq dating, get qqservergroup=",t),t?(o.m_weichatLoginData=t.data,JSON.stringify(t.servers),T.ServerAddrInfo.getInstance().initServerList(t.servers),c.ClientNetwork.getInstance().pushLocalMessage(l.LOCAL_MESSAGE.LocalMsg_SDK_LoginRet,{error:0}),e.Instance.report_login(),e.Instance.report_register()):(console.log("qq dating, get qqservergroup Error, return is null"),c.ClientNetwork.getInstance().pushLocalMessage(l.LOCAL_MESSAGE.LocalMsg_SDK_LoginRet,{error:-2}))}},i.onerror=function(){console.log("qq dating, get qqservergroup Error"),c.ClientNetwork.getInstance().pushLocalMessage(l.LOCAL_MESSAGE.LocalMsg_SDK_LoginRet,{error:-2})},i.open("GET",t,!0),i.send()},e.prototype.getUserInfo=function(){S.default.log("qq dating, getUserInfo!");var e=this;qq.getUserInfo({success:function(t){e.storageUserInfo(t),e.m_strEncryptedData=t.encryptedData,e.m_strIv=t.iv,e.userLogin()},fail:function(){console.log("getUserInfo fail")}})},e.prototype.storageUserInfo=function(e){var t=e.userInfo;console.log("getUserInfo success"+t.nickName+t.avatarUrl),f.setLocalData("wxNickName",t.nickName),f.setLocalData("wxImage",t.avatarUrl),f.setLocalData("wxSex",t.gender),f.setLocalData("wxAuth",!0)},e.prototype.userInfoSetInSQL=function(e){qq.getStorage({key:"third_Session",success:function(t){qq.request({url:"Our Server ApiUrl",data:{third_Session:t.data,nickName:e.nickName,avatarUrl:e.avatarUrl,gender:e.gender,province:e.province,city:e.city,country:e.country},success:function(){}})}})},e.prototype.userAuth=function(e,t){void 0===e&&(e=null),void 0===t&&(t=null);var o=this,i=qq.getSystemInfoSync(),a=i.screenWidth,n=i.screenHeight;qq.getSetting({success:function(i){if(console.log(i.authSetting),i.authSetting["scope.userInfo"])console.log("\u7528\u6237\u5df2\u6388\u6743"),e&&e();else{console.log("\u7528\u6237\u672a\u6388\u6743");var r=qq.createUserInfoButton({type:"text",text:"",style:{left:0,top:0,width:a,height:n,backgroundColor:"#00000000",color:"#000000",fontSize:0,textAlign:"center",lineHeight:n}});r.offTap(function(){console.log("\u7528\u6237\u6388\u6743:offTap",i)}),r.onTap(function(i){o.m_click_auth||(o.m_click_auth=!0,setTimeout(function(){o.m_click_auth=!1},1e3),i.userInfo?(console.log("\u7528\u6237\u6388\u6743:",i),o.storageUserInfo(i),e&&e(),r.destroy()):(console.log("\u7528\u6237\u62d2\u7edd\u6388\u6743:",i),t&&t(),r.destroy()))})}}})},e.prototype.noticeServerPay=function(e){var t=new d.C_Recharge_Role_WeiXinGameMidasPay;t.orderuuid=e,c.ClientNetwork.getInstance().Send(d.RECHARGE_CLIENT_ENUM.P_Recharge_Role_WeiXinGameMidasPay,t,!1)?(cc.error("SendData NCS_ROLE_TEST_ADD_CHONGZHI finish!"),f.setLocalData("userPayRechargeInfo",""),console.log("pay success"+f.getLocalData("userPayRechargeInfo",""))):cc.error("SendData NCS_ROLE_TEST_ADD_CHONGZHI Error!")},e.prototype.pay=function(e,t,o){var i=this;console.log("rechargeId="+e+", rechargeInfo="+o),console.log("GlobalVar.getZoneId()="+g.GlobalVar.getZoneId());var a=h.RechargeTableData.getById(e);if(a){console.log("buyQuantity="+a.moneyQQ);var n="https://mszcs1.gameserver.iplay11g.com/gmsys/weblogic/web/qqhallprepay.php";!0===this.getSubmitState()&&(n="https://mszctest.gameserver.iplay11g.com/gmsys/weblogic/web/qqhallprepay.php"),n=n+"?bill_no="+o+"&rechargeId="+e+"&money="+Math.floor(a.moneyQQ/10)+"&openid="+this.openid+"&openKey="+this.openKey+"&pf="+this.pf+"&pfKey="+this.pfKey+"&rechargeInfo="+a.info,console.log("qq dating, pay url=",n);var r=new XMLHttpRequest;r.onreadystatechange=function(){if(4==r.readyState&&r.status>=200&&r.status<400){console.log("qq dating, prepay, responseText: ",r.responseText),console.log("qq dating, prepay, xMLHttpRequest: ",r),console.log("qq dating, prepay, responseText: ",r.responseText);var e=JSON.parse(r.responseText);if(console.log("qq dating, prepay, jsonArr: ",e),null!=e&&0==e.ret){e.token;var t=e.url_params;GameAPI.BuyBox.show(i.appid,t,0,a.info,function(){console.log("BuyBox, close!")},function(){console.log("BuyBox, success!")})}else console.log("qq dating, prepay Error2")}},r.onerror=function(){console.log("qq dating, prepay Error")},r.open("GET",n,!0),r.send()}else f.MESSAGETIPS("RECHARGE_ID_NOTEXIST")},e.prototype.inviteFriend=function(e,t,o,i,a,n){void 0===n&&(n=null),s.G.UIManager.isFinghtingScene()},e.prototype.checkInviteInfo=function(){if(p.GamePlatform.isQQGameRoom()){var e=p.GamePlatform.getQQGameUrlParam("invitor");if(e&&e.length>0){console.log("qqhall checkInviteInfo invitor="+e);var t=new u.C_Role_ShareBindMaster;t.masterID=e,c.ClientNetwork.getInstance().Send(u.ROLE_CLIENT_ENUM.P_Role_ShareBindMaster,t,!1)}}},e.prototype.getChannelID=function(){return 5e4},e.prototype.onCreatGameClubBtn=function(e){if(!this.m_gameClubBtn){var t=qq.getSystemInfoSync(),o=e.getBoundingBoxToWorld(),i=cc.size(e.width+10,e.height+10),a=cc.view.getFrameSize(),n=cc.director.getWinSize(),r=o.x/n.width*a.width+t.safeArea.left+2*t.statusBarHeight,s=(n.height-o.y-i.height)/n.height*a.height,c=i.width/n.width*a.width,l=i.height/n.height*a.height;this.m_gameClubBtn=qq.createGameClubButton({type:"text",text:"",style:{left:r,top:s,width:c,height:l,lineHeight:0,backgroundColor:"",color:"#3296fa",textAlign:"center",fontSize:16,borderRadius:4}})}},e.prototype.wxReportAnalytics=function(e,t){p.GamePlatform.isQQMiniGame()&&qq.reportAnalytics(e,t)},e.prototype.wxOpenChannelsLive=function(){qq.openChannelsLive?qq.openChannelsLive({finderUserName:"sphKR1PR00Z3jIQ",success:function(e){console.log("\u6253\u5f00\u89c6\u9891\u53f7\u76f4\u64ad\u6210\u529f  ",e)},fail:function(e){console.log("\u6253\u5f00\u89c6\u9891\u53f7\u76f4\u64ad\u5931\u8d25 ",e)},complete:function(e){console.log("\u6253\u5f00\u89c6\u9891\u53f7\u76f4\u64ad\u8c03\u7528\u7ed3\u675f\u7684\u56de\u8c03\u51fd\u6570",e)}}):qq.showModal({title:"\u63d0\u793a",content:"\u5f53\u524d\u5fae\u4fe1\u7248\u672c\u8fc7\u4f4e\uff0c\u65e0\u6cd5\u4f7f\u7528\u8be5\u529f\u80fd\uff0c\u8bf7\u5347\u7ea7\u5230\u6700\u65b0\u5fae\u4fe1\u7248\u672c\u540e\u91cd\u8bd5\u3002"})},e.prototype.wxOnGameLiveStateChange=function(){var e=this;this.wxOffGameLiveStateChange(),qq.onGameLiveStateChange&&qq.onGameLiveStateChange(function(t){if("start"===t.state){e.setSameLiveFeedId(t.feedId),e.wxSyncLiveTimeUpdate();var o=new u.C_Role_Live_Begin;c.ClientNetwork.getInstance().Send(u.ROLE_CLIENT_ENUM.P_Role_Live_Begin,o)}"end"===t.state&&(e.m_syncLiveTime&&(clearInterval(e.m_syncLiveTime),e.m_syncLiveTime=null),e.wxGetUserRecentGameLiveInfo())})},e.prototype.wxGetUserRecentGameLiveInfo=function(){var e=this,t=this.getGameLiveFeedId();t&&(qq.getUserGameLiveDetails?qq.getUserGameLiveDetails({feedIdList:[t],success:function(t){var o=new u.C_Role_WeiXinAnalyzingMessage;o.encryptedData=t.encryptedData,o.iv=t.iv,c.ClientNetwork.getInstance().Send(u.ROLE_CLIENT_ENUM.P_Role_WeiXinAnalyzingMessage,o),e.setSameLiveFeedId("")},fail:function(t){setTimeout(function(){if(0!=t.err_code)e.wxGetUserRecentGameLiveInfo();else{qq.showModal({title:"\u63d0\u793a",content:"\u83b7\u53d6\u5fae\u4fe1\u76f4\u64ad\u6570\u636e\u9519\u8bef\uff0c\u8bf7\u4e0a\u4f20\u65e5\u5fd7\u5230\u5fae\u4fe1\uff01"});var o=r.default.uuidTransformRoieId();C.TalkingDataAPI.event("getUserGameLiveDetails.fail",{code:t.err_code,playerId:o})}},200)}}):qq.showModal({title:"\u63d0\u793a",content:"\u5f53\u524d\u5fae\u4fe1\u7248\u672c\u8fc7\u4f4e\uff0c\u65e0\u6cd5\u4f7f\u7528\u8be5\u529f\u80fd\uff0c\u8bf7\u5347\u7ea7\u5230\u6700\u65b0\u5fae\u4fe1\u7248\u672c\u540e\u91cd\u8bd5\u3002"}))},e.prototype.wxSyncLiveTimeUpdate=function(){var e=this;this.m_syncLiveTime&&(clearInterval(this.m_syncLiveTime),this.m_syncLiveTime=null),this.m_syncLiveTime=setInterval(function(){if(e.wxGetGameLiveState()){var t=new u.C_Role_Live_Update;c.ClientNetwork.getInstance().Send(u.ROLE_CLIENT_ENUM.P_Role_Live_Update,t),setTimeout(function(){var e=[];Array.from(r.default.getRoleTaskData().tasks.values()).forEach(function(t){var o=v.TaskTableData.getById(t.taskID);o.type==_.TASK_TYPE.TASK_TYPE_COUNT_CLIENT&&o.clientType==_.TASK_CLIENT_TYPE.TASK_CLIENT_TYPE_ACHIEVEMENT_LIVE_TIME&&e.push(t)});var t=r.default.getRoleAttrValByKey(_.ROLE_ATTR_VALUES.ROLE_ATTR_DAYLIVETIME);e.forEach(function(e){e.taskCount=t});for(var o=0;o<e.length;o++){var i=new u.C_Role_ClientTaskUpdateCount;i.taskID=e[o].taskID,i.count=e[o].taskCount,c.ClientNetwork.getInstance().Send(u.ROLE_CLIENT_ENUM.P_Role_ClientTaskUpdateCount,i,!1)}c.ClientNetwork.getInstance().pushLocalMessage(l.LOCAL_MESSAGE.LocalMsg_RefreshTask);var a=y.default.getViewByName("MainSceneView");a&&a.view&&a.view.onSyncChangeLiveTaskData()},500)}else clearInterval(e.m_syncLiveTime),e.m_syncLiveTime=null},6e4)},e.prototype.wxOffGameLiveStateChange=function(){qq.offGameLiveStateChange&&qq.offGameLiveStateChange()},e.prototype.wxGetGameLiveState=function(){return!!qq.getGameLiveState&&qq.getGameLiveState().isLive},e.prototype.wxOpenChannelsLiveCollection=function(){qq.openChannelsLiveCollection?qq.openChannelsLiveCollection({openIds:["odsRR5Ew66DsDUAorrT1Ygq3kNzU","odsRR5LjOn0uTKVnZp6m6HsSXVlo","odsRR5LjOn0uTKVnZp6m6HsSXVlo","odsRR5Dad9eLrm4wydhun9EyxWD0"]}):qq.showModal({title:"\u63d0\u793a",content:"\u5f53\u524d\u5fae\u4fe1\u7248\u672c\u8fc7\u4f4e\uff0c\u65e0\u6cd5\u4f7f\u7528\u8be5\u529f\u80fd\uff0c\u8bf7\u5347\u7ea7\u5230\u6700\u65b0\u5fae\u4fe1\u7248\u672c\u540e\u91cd\u8bd5\u3002"})},e.prototype.getGameLiveFeedId=function(){var e=f.getLocalData("GameLiveFeedId");return e.length<=0?null:e},e.prototype.setSameLiveFeedId=function(e){f.setLocalData("GameLiveFeedId",e)},e.prototype.onSendUcConversionInfo=function(e,t){var o=this;if(qq.getStorageSync("uc_trackid"))qq.getStorage({key:"uc_trackid",success:function(i){console.log(i.data),o.onSyncUcreturnback(i.data,e,t)}});else{var i=function(){var e=qq.getLaunchOptionsSync().query;return e.uctrackid?(console.log("\u6253\u5370\u53c2\u6570",e.uctrackid),e.uctrackid):null}.call(this);if(!i)return C.TalkingDataAPI.event("ucNoTrackid"),m.default.callRoleClientLog("ucNoTrackid"),void console.log("not get ucNoTrackid!");qq.setStorage({key:"uc_trackid",data:i,success:function(){o.onSyncUcreturnback(i,e,t)}})}},e.prototype.onSyncUcreturnback=function(e,t,o){console.log("\u6253\u5370\u53c2\u6570Uc  ",e,t,o),e&&(o=o||"1",qq.request({url:"https://mszctest.gameserver.iplay11g.com/gmsys/weblogic/webc/ucreturnback.php",data:{type:t,money:o},success:function(e){console.log("onSendUC success",e.data),C.TalkingDataAPI.event("onSendUC.success",{code:e.data}),m.default.callRoleClientLog(e.data)},fail:function(e){console.log("onSendUC failed1"+e),C.TalkingDataAPI.event("onSendUC.failed",{code:e}),m.default.callRoleClientLog("onSendUC.failed")}}))},e.prototype.onSendBiliConversionInfo=function(e,t){var o=this;if(qq.getStorageSync("bili_trackid"))qq.getStorage({key:"bili_trackid",success:function(i){console.log(i.data),o.onSyncBilireturnback(i.data,e,t)}});else{var i=function(){var e=qq.getLaunchOptionsSync().query;return e.trackid?(console.log("\u6253\u5370\u53c2\u6570",e.trackid),e.trackid):null}.call(this);if(!i)return C.TalkingDataAPI.event("biliNoTrackid"),m.default.callRoleClientLog("biliNoTrackid"),void console.log("not get biliNoTrackid!");qq.setStorage({key:"bili_trackid",data:i,success:function(){o.onSyncBilireturnback(i,e,t)}})}},e.prototype.onSyncBilireturnback=function(e,t,o){console.log("\u6253\u5370\u53c2\u6570B\u7ad9  ",e,t,o),e&&(o=o||1,qq.request({url:"https://mszcs1.gameserver.iplay11g.com/gmsys/weblogic/webc/bilibilireturnback.php",data:{conv_type:t,track_id:e,conv_value:o},success:function(e){console.log("onSendBili success",e.data),C.TalkingDataAPI.event("onSendBili.success",{code:e.data}),m.default.callRoleClientLog(e.data)},fail:function(e){console.log("onSendBili failed1"+e),C.TalkingDataAPI.event("onSendBili.failed",{code:e}),m.default.callRoleClientLog("onSendBili.failed")}}))},e.prototype.onSendFeishuConversionInfo=function(e,t){var o=this;if(qq.getStorageSync("feishu_clue_token"))qq.getStorage({key:"feishu_clue_token",success:function(i){console.log(i.data),o.onSyncFeishureturnback(i.data,e,t)}});else{var i=function(){var e=qq.getLaunchOptionsSync().query;return e.clue_token?e.clue_token:null}.call(this);if(!i)return C.TalkingDataAPI.event("feishuNoClueToken"),m.default.callRoleClientLog("feishuNoClueToken"),console.log("not get clue_token!");qq.setStorage({key:"feishu_clue_token",data:i,success:function(){o.onSyncFeishureturnback(i,e,t)}})}},e.prototype.onSyncFeishureturnback=function(e,t,o){console.log("\u6253\u5370\u53c2\u6570\u6296\u97f3  ",e,this.m_weichatLoginData.accountname,this.m_weichatLoginData.openid),e&&(o=o||0,qq.request({url:"https://mszctest.gameserver.iplay11g.com/gmsys/weblogic/webc/feishureturnback.php",data:{clue_token:e,union_id:this.m_weichatLoginData.accountname,open_id:this.m_weichatLoginData.openid,event_type:t,props:{pay_amount:o}},success:function(e){console.log("onSendFeishu success",e.data),C.TalkingDataAPI.event("onSendFeishu.success",{code:e.data}),m.default.callRoleClientLog(e.data)},fail:function(e){console.log("onSendFeishu failed1"+e),C.TalkingDataAPI.event("onSendFeishu.failed",{code:e}),m.default.callRoleClientLog("onSendFeishu.failed")}}))},e.prototype.shareRenderTexture=function(e){var t=cc.game.canvas,o=t.width,i=t.height,a=1*o,n=1*i,r=0*o,s=0*i,c=t.toTempFilePathSync({x:r,y:s,width:a,height:n,destWidth:500,destHeight:400});console.log("getRenderTexture"+c),qq.shareAppMessage({title:e,imageUrl:c})},e.prototype.getSubmitState=function(){return!1},e.prototype.openBuyBlueVip=function(e,t){void 0===e&&(e=3),void 0===t&&(t=-1);var o=this;t<0?GameAPI.NewOpenGameVIPService.show(this.appid,function(){console.log("GameAPI.NewOpenGameVIPService close!"),o.refreshBlueVipData()},"VIP.APP"+this.appid+"PLATqqgamemini",e):GameAPI.NewOpenGameVIPService.show(this.appid,function(){console.log("GameAPI.NewOpenGameVIPService close!"),o.refreshBlueVipData()},"VIP.APP"+this.appid+"PLATqqgamemini",e,t)},e.prototype.refreshBlueVipData=function(){console.log("refreshBlueVipData \u5237\u65b0\u84dd\u94bb\u7b49\u7ea7");var e="https://mszcs1.gameserver.iplay11g.com/gmsys/weblogic/web/qqhallgetinfo.php";!0===this.getSubmitState()&&(e="https://mszctest.gameserver.iplay11g.com/gmsys/weblogic/web/qqhallgetinfo.php"),e=e+"?openid="+this.m_weichatLoginData.openid+"&openKey="+this.m_weichatLoginData.session_key,console.log("refreshBlueVipData \u5237\u65b0\u84dd\u94bb\u7b49\u7ea7, url="+e);var t=new XMLHttpRequest;t.onreadystatechange=function(){if(4==t.readyState&&t.status>=200&&t.status<400){var e=JSON.parse(t.responseText);if(console.log("qq dating, refreshBlueVipData=",e),null!=e&&0==e.ret){console.log("refreshBlueVipData \u8bf7\u6c42\u670d\u52a1\u5668\u5237\u65b0\u84dd\u94bb\u7b49\u7ea7");var o=new u.C_Role_QQHall_RefreshBlueData;o.is_blue_vip=e.is_blue_vip,o.is_blue_year_vip=e.is_blue_year_vip,o.blue_vip_level=e.blue_vip_level,o.is_super_blue_vip=e.is_super_blue_vip,c.ClientNetwork.getInstance().Send(u.ROLE_CLIENT_ENUM.P_Role_QQHall_RefreshBlueData,o)}else console.log("qq dating, refreshBlueVipData Error, return is null")}},t.onerror=function(){console.log("qq dating, refreshBlueVipData Error"),c.ClientNetwork.getInstance().pushLocalMessage(l.LOCAL_MESSAGE.LocalMsg_GetServerAddr,{error:-2})},t.open("GET",e,!0),t.send()},e.getTableDataByType=function(e){var t=[];return w.QQHallRewardTableData.getDataMap().forEach(function(o){o.type==e&&t.push(o)}),t},e.showItemsToContainer=function(e,t,o){if(void 0===o&&(o=!1),null!=t){t.removeAllChildren();var i=b.default.getInstance().getDorpItemsByID(e).dropRandom.split("|"),a=function(e){var a=i[e].split("#"),n=a[0];b.default.getInstance().getItemByID(n).icon,N.default.createNormalItems(n,a[1],t,function(e){e.scale=.7;var t=b.default.getInstance().getItemByID(n);o&&2===t.type&&e.on(cc.Node.EventType.TOUCH_END,function(){y.default.addPopView("BaseCtrl","DrawNewHeroCardView","DrawNewHeroCardView",{heroId:n,bShowNew:!0,bAction:!0})})})};for(var n in i)a(n)}},e.isBlueVip=function(){var e=r.default.getRoleInfoData().qqHallBlueVipVector;return null!=e&&null!=e[0]&&1==e[0]},e.isBlueVipYear=function(){var e=r.default.getRoleInfoData().qqHallBlueVipVector;return null!=e&&null!=e[1]&&1==e[1]},e.isBlueVipSuper=function(){var e=r.default.getRoleInfoData().qqHallBlueVipVector;return null!=e&&null!=e[3]&&1==e[3]},e.getBlueVipLv=function(){var e=r.default.getRoleInfoData().qqHallBlueVipVector;return null!=e&&null!=e[2]?e[2]:1},e.isRewardReceived=function(e,t){var o=e+"_"+t;return r.default.getRoleInfoData().qqHallRewardsVector.indexOf(o)>-1},e.openBlueVipWebsite=function(){console.log("\u6253\u5f00\u84dd\u94bb\u5b98\u7f51\u7f51\u9875"),window.open("http://gamevip.qq.com/?ADTAG=VIP.WEB.TFJL")},e.getBlueVipIconUrlByLV=function(e,t){void 0===t&&(t=!1);var o="\u84dd\u94bb_0007_0";return t?(o="super",e>0&&(o="super"+e)):1==e?o="\u84dd\u94bb_0008_01":2==e?o="\u84dd\u94bb_0000_02":3==e?o="\u84dd\u94bb_0001_03":4==e?o="\u84dd\u94bb_0002_04":5==e?o="\u84dd\u94bb_0003_05":6==e?o="\u84dd\u94bb_0004_06":7==e?o="\u84dd\u94bb_0005_07":8==e&&(o="\u84dd\u94bb_0006_08"),"qqhall/"+o},e.setBlueIcon=function(e,t,o,i,a,n){if(void 0===t&&(t=!1),void 0===o&&(o=!1),void 0===i&&(i=!1),void 0===a&&(a=1),void 0===n&&(n=!1),0==o)e.active=!1;else{e.active=!0;var r=e.getComponent(cc.Sprite),s="";t?i?(s="qqhall/year",I.default.loadSprite(s,r)):e.active=!1:(s=this.getBlueVipIconUrlByLV(a,n),I.default.loadSprite(s,r))}},e.prototype.get_iversion=function(){return n.wechatminiLoaclGameVer},e.prototype.get_userip=function(){return"127.0.0.1"},e.prototype.get_svrip=function(){return"127.0.0.1"},e.prototype.get_iworldid=function(){return 1},e.prototype.get_domain=function(){return 10},e.prototype.get_seqId=function(){var e=this.get_timestamp();return this.openid+e.toString()},e.prototype.get_timestamp=function(){return r.default.getServersTime2()},e.prototype.get_dtEventTime=function(){return E.TimeOffSetManager.getFormatDate()},e.prototype.get_opuid=function(){return r.default.UUID},e.prototype.get_opopenid=function(){return this.openid},e.prototype.get_level=function(){return r.default.getRoleAttrValByKey(_.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE)},e.prototype.get_action_time=function(){return this.get_timestamp()},e.prototype.report_login=function(){if(0!=p.GamePlatform.isQQGameRoom()){this.doReport({actionid:1,optype:3})}},e.prototype.report_register=function(){if(0!=p.GamePlatform.isQQGameRoom()){this.doReport({actionid:2,optype:3})}},e.prototype.reprot_logout=function(){if(0!=p.GamePlatform.isQQGameRoom()){this.doReport({actionid:9,optype:3})}},e.prototype.reprot_playerLogin=function(){if(0!=p.GamePlatform.isQQGameRoom()){this.doReport({actionid:11,optype:3})}},e.prototype.reprot_createPlayer=function(){if(0!=p.GamePlatform.isQQGameRoom()){this.doReport({actionid:12,optype:3})}},e.prototype.reprot_playerLogout=function(){if(0!=p.GamePlatform.isQQGameRoom()){this.doReport({actionid:13,optype:3})}},e.prototype.doReport=function(e){e.dtEventTime=this.get_dtEventTime(),e.iversion=this.get_iversion(),e.appid=this.appid,e.userip=this.get_userip(),e.svrip=this.get_svrip(),e.action_time=this.get_action_time(),e.domain=this.get_domain(),e.iworldid=this.get_iworldid(),e.opuid=this.get_opuid(),e.opopenid=this.get_opopenid(),e.level=this.get_level();var t=[];Object.entries(e).forEach(function(e){var o=e[0],i=e[1];t.push(o+"="+i)});var o=t.join("&");console.log("\u5927\u5385\u4e0a\u62a5, arrStr=",o);var i={title:{app_id:this.appid,app_name:"tafangjingling",timestamp:this.get_timestamp(),seq_id:this.get_seqId(),retry_times:"0"},data:[{log_name:"log_common",log_fields:o}]};console.log("\u5927\u5385\u4e0a\u62a5, value=",i);var a=(new P.default).hex_md5(JSON.stringify(i)+"webgame@2019J5v6ByRT");console.log("\u5927\u5385\u4e0a\u62a5, signature=",a);var n=new XMLHttpRequest;n.onload=function(){console.log("\u5927\u5385\u4e0a\u62a5, onload!")},n.onreadystatechange=function(){if(console.log("\u5927\u5385\u4e0a\u62a5, onreadystatechange, readyState="+n.readyState+", status="+n.status),4==n.readyState&&console.log("\u5927\u5385\u4e0a\u62a5, onreadystatechange, http=",n),4==n.readyState&&n.status>=200&&n.status<400){var e=JSON.parse(n.responseText);console.log("\u5927\u5385\u4e0a\u62a5, response=",e)}},n.onerror=function(){console.log("\u5927\u5385\u4e0a\u62a5, onerror!")},n.open("POST","https://mszctest.gameserver.iplay11g.com/gmsys/weblogic/webc/qqhallreport.php",!0);var r={};r.content=i,r.signature=a,r.version="1.0";var s=JSON.stringify(r);console.log("\u5927\u5385\u4e0a\u62a5, sendValue=",s),n.send(s)},e.prototype.chatFilter=function(e,t,o,i){void 0===o&&(o=null),void 0===i&&(i=null);var a=new XMLHttpRequest;a.onload=function(){console.log("\u5927\u5385\u654f\u611f\u8bcd, onload!")},a.onreadystatechange=function(){if(console.log("\u5927\u5385\u654f\u611f\u8bcd, onreadystatechange, readyState="+a.readyState+", status="+a.status),4==a.readyState&&console.log("\u5927\u5385\u654f\u611f\u8bcd, onreadystatechange, http=",a),4==a.readyState&&a.status>=200&&a.status<400){var t=JSON.parse(a.responseText);if(console.log("\u5927\u5385\u654f\u611f\u8bcd, response=",t),0==t.ret){var n=e,r=0;null!=t.text_result_list_[0]&&(n=t.text_result_list_[0].result_text_,r=t.text_result_list_[0].check_ret_),o.apply(i,[n,r])}else o.apply(i)}},a.onerror=function(){console.log("\u5927\u5385\u654f\u611f\u8bcd, onerror!"),o.apply(i)},a.open("POST","https://mszctest.gameserver.iplay11g.com/gmsys/weblogic/webc/qqhallchatfilter.php",!0);var n={};n.content=e,n.sceneType=t,n.openid=this.openid,n.openkey=this.openKey;var r=JSON.stringify(n);console.log("\u5927\u5385\u654f\u611f\u8bcd, sendValue=",r),a.send(r)},e.prototype.chatFilterAsync=function(e,t){return i(this,void 0,void 0,function(){var o;return a(this,function(){return o=this,[2,new Promise(function(i){var a=new XMLHttpRequest;a.onload=function(){console.log("\u5927\u5385\u654f\u611f\u8bcd2, onload!")},a.onreadystatechange=function(){if(console.log("\u5927\u5385\u654f\u611f\u8bcd2, onreadystatechange, readyState="+a.readyState+", status="+a.status),4==a.readyState&&console.log("\u5927\u5385\u654f\u611f\u8bcd2, onreadystatechange, http=",a),4==a.readyState&&a.status>=200&&a.status<400){var t=JSON.parse(a.responseText);if(console.log("\u5927\u5385\u654f\u611f\u8bcd2, response=",t),0==t.ret){var o=e;null!=t.text_result_list_[0]&&(o=t.text_result_list_[0].result_text_,t.text_result_list_[0].check_ret_),i(o)}else i("")}},a.onerror=function(){console.log("\u5927\u5385\u654f\u611f\u8bcd2, onerror!"),i("")},a.open("POST","https://mszctest.gameserver.iplay11g.com/gmsys/weblogic/webc/qqhallchatfilter.php",!0);var n={};n.content=e,n.sceneType=t,n.openid=o.openid,n.openkey=o.openKey;var r=JSON.stringify(n);console.log("\u5927\u5385\u654f\u611f\u8bcd2, sendValue=",r),a.send(r)})]})})},e.Instance=null,e.SDK_TYPE=15,e.JING_FEN_ID=60117,e.CHAT_FILTER_SCENETYPE_NAME=1,e.CHAT_FILTER_SCENETYPE_MSG=2,e.CHAT_FILTER_SCENETYPE_TITLE=3,e.CHAT_FILTER_SCENETYPE_COMMENT=4,e.CHAT_FILTER_SCENETYPE_SIGN=5,e.CHAT_FILTER_SCENETYPE_SEARCH=6,e.CHAT_FILTER_SCENETYPE_OTHER=7,e}();o.QQGameHallUtils=R,cc._RF.pop()},{"../../load":"load","../Global/GameGlobal":"GameGlobal","../StaticData/QQHallRewardTableData":"QQHallRewardTableData","../StaticData/RechargeTableData":"RechargeTableData","../StaticData/TaskTableData":"TaskTableData","../TalkingDataAPI":"TalkingDataAPI","../common/NetworkProtocolCommon":"NetworkProtocolCommon","../common/PlayerModule":"PlayerModule","../model/ServerAddrInfo":"ServerAddrInfo","../modules/base/GameView":"GameView","../network/ClientNetwork":"ClientNetwork","../network/LocalMessage":"LocalMessage","../network/protocol/RechargeProtocols":"RechargeProtocols","../network/protocol/RoleProtocols":"RoleProtocols","../network/protocol/TypeProtocols":"TypeProtocols","./ConfigUtils":"ConfigUtils","./GamePlatform":"GamePlatform","./GameTools":"GameTools","./GameUtils":"GameUtils","./LogUtil":"LogUtil","./MD5":"MD5","./ResourcesManager":"ResourcesManager","./TimeOffSetManager":"TimeOffSetManager","./subUtils/TypeDef":"TypeDef"}],QQHallListItem:[function(e,t,o){"use strict";cc._RF.push(t,"bc0b5ZsRzFHOLxFzqGGGmWM","QQHallListItem");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../Global/GameGlobal"),s=e("../../modules/base/GameView"),c=e("../../network/ClientNetwork"),l=e("../../network/protocol/RoleProtocols"),d=e("../../network/protocol/TypeProtocols"),u=e("../../utils/GameTools"),h=e("../../utils/QQGameHallUtils"),p=cc._decorator,f=p.ccclass,g=p.property,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.label=null,t.text="hello",t}return a(t,e),t.prototype.onLoad=function(){console.log("QQHallListItem, onLoad")},t.prototype.start=function(){},t.prototype.init=function(e){this.tableData=e,this.showRewards(),this.showBtn(),console.log("QQHallListItem, init, tableData id="+e.id),this.title1=this.node.getChildByName("node_title").getChildByName("labelTitle1"),this.title2=this.node.getChildByName("node_title").getChildByName("labelTitle2"),this.title3=this.node.getChildByName("node_title").getChildByName("labelTitle3"),this.title1.active=!1,this.title2.active=!1,this.title3.active=!1,this.tableData.type==d.QQHALL_REWARD_TYPE.QQHALL_REWARD_TYPE_HALL_LEVEL?(this.title1.active=!0,this.title1.getComponent(cc.Label).string="\u676f\u6570\u8fbe\u5230"+e.level):this.tableData.type==d.QQHALL_REWARD_TYPE.QQHALL_REWARD_TYPE_BLUE_LEVEL?(this.title1.active=!0,this.title1.getComponent(cc.Label).string="\u676f\u6570\u8fbe\u5230"+e.level):this.tableData.type==d.QQHALL_REWARD_TYPE.QQHALL_REWARD_TYPE_BLUE_DAY_YEAR?(this.title1.active=!0,this.title1.getComponent(cc.Label).string="\u5e74\u8d39\u84dd\u94bb\u6bcf\u65e5\u793c\u5305"):this.tableData.type==d.QQHALL_REWARD_TYPE.QQHALL_REWARD_TYPE_BLUE_DAY_LEVEL?(this.title2.active=!0,this.title3.active=!0,this.title2.getComponent(cc.Label).string="\u84dd\u94bbLV"+e.level+"\u6bcf\u65e5\u793c\u5305",u.default.registerTouchEvent(this.title3,function(){s.default.addPopView("BaseCtrl","QQBlueReview","QQBlueReview")},this)):this.tableData.type==d.QQHALL_REWARD_TYPE.QQHALL_REWARD_TYPE_BLUE_DAY_SUPER&&(this.title1.active=!0,this.title1.getComponent(cc.Label).string="\u84dd\u94bb\u8c6a\u534e\u7248\u6bcf\u65e5\u793c\u5305")},t.prototype.showRewards=function(){var e=this.tableData.dropId;h.QQGameHallUtils.showItemsToContainer(e,this.node.getChildByName("reward"))},t.prototype.showBtn=function(){var e=this.node.getChildByName("btn_buyBlue"),t=this.node.getChildByName("btn_buyYearBlue"),o=this.node.getChildByName("btn_new_lingqu"),i=this.node.getChildByName("finish");e.active=!1,t.active=!1,o.active=!1,i.active=!1,u.default.registerTouchEvent(e,function(){h.QQGameHallUtils.getInstance().openBuyBlueVip(3)},this),u.default.registerTouchEvent(t,function(){h.QQGameHallUtils.getInstance().openBuyBlueVip(3,12)},this),this.tableData.type==d.QQHALL_REWARD_TYPE.QQHALL_REWARD_TYPE_HALL_LEVEL?h.QQGameHallUtils.isRewardReceived(d.QQHALL_REWARD_TYPE.QQHALL_REWARD_TYPE_HALL_LEVEL,this.tableData.level)?i.active=!0:(o.active=!0,u.default.registerTouchEvent(o,this.onHallLevelLingqu,this)):this.tableData.type==d.QQHALL_REWARD_TYPE.QQHALL_REWARD_TYPE_BLUE_LEVEL?h.QQGameHallUtils.isBlueVip()?h.QQGameHallUtils.isRewardReceived(d.QQHALL_REWARD_TYPE.QQHALL_REWARD_TYPE_BLUE_LEVEL,this.tableData.level)?i.active=!0:(o.active=!0,u.default.registerTouchEvent(o,this.onBlueLevelLingqu,this)):e.active=!0:this.tableData.type==d.QQHALL_REWARD_TYPE.QQHALL_REWARD_TYPE_BLUE_DAY_YEAR?h.QQGameHallUtils.isBlueVipYear()?h.QQGameHallUtils.isRewardReceived(d.QQHALL_REWARD_TYPE.QQHALL_REWARD_TYPE_BLUE_DAY_YEAR,0)?i.active=!0:(o.active=!0,u.default.registerTouchEvent(o,this.onBlueDayYearLingqu,this)):t.active=!0:this.tableData.type==d.QQHALL_REWARD_TYPE.QQHALL_REWARD_TYPE_BLUE_DAY_LEVEL?h.QQGameHallUtils.isBlueVip()?h.QQGameHallUtils.isRewardReceived(d.QQHALL_REWARD_TYPE.QQHALL_REWARD_TYPE_BLUE_DAY_LEVEL,this.tableData.level)?i.active=!0:(o.active=!0,u.default.registerTouchEvent(o,this.onBlueDayLevel,this)):e.active=!0:this.tableData.type==d.QQHALL_REWARD_TYPE.QQHALL_REWARD_TYPE_BLUE_DAY_SUPER&&(h.QQGameHallUtils.isBlueVipSuper()?h.QQGameHallUtils.isRewardReceived(d.QQHALL_REWARD_TYPE.QQHALL_REWARD_TYPE_BLUE_DAY_SUPER,0)?i.active=!0:(o.active=!0,u.default.registerTouchEvent(o,this.onBlueDaySuper,this)):(o.active=!0,u.default.setNodeBright(o,!1),u.default.registerTouchEvent(o,function(){r.G.StringManager.PopString("\u5f00\u901a\u84dd\u94bb\u8c6a\u534e\u7248\u53ef\u9886\u53d6")},this)))},t.prototype.onHallLevelLingqu=function(){var e=new l.C_Role_QQHall_GetReward;e.type=d.QQHALL_REWARD_TYPE.QQHALL_REWARD_TYPE_HALL_LEVEL,e.level=this.tableData.level,c.ClientNetwork.getInstance().Send(l.ROLE_CLIENT_ENUM.P_Role_QQHall_GetReward,e)},t.prototype.onBlueLevelLingqu=function(){var e=new l.C_Role_QQHall_GetReward;e.type=d.QQHALL_REWARD_TYPE.QQHALL_REWARD_TYPE_BLUE_LEVEL,e.level=this.tableData.level,c.ClientNetwork.getInstance().Send(l.ROLE_CLIENT_ENUM.P_Role_QQHall_GetReward,e)},t.prototype.onBlueDayYearLingqu=function(){var e=new l.C_Role_QQHall_GetReward;e.type=d.QQHALL_REWARD_TYPE.QQHALL_REWARD_TYPE_BLUE_DAY_YEAR,e.level=0,c.ClientNetwork.getInstance().Send(l.ROLE_CLIENT_ENUM.P_Role_QQHall_GetReward,e)},t.prototype.onBlueDayLevel=function(){var e=new l.C_Role_QQHall_GetReward;e.type=d.QQHALL_REWARD_TYPE.QQHALL_REWARD_TYPE_BLUE_DAY_LEVEL,e.level=this.tableData.level,c.ClientNetwork.getInstance().Send(l.ROLE_CLIENT_ENUM.P_Role_QQHall_GetReward,e)},t.prototype.onBlueDaySuper=function(){var e=new l.C_Role_QQHall_GetReward;e.type=d.QQHALL_REWARD_TYPE.QQHALL_REWARD_TYPE_BLUE_DAY_SUPER,e.level=0,c.ClientNetwork.getInstance().Send(l.ROLE_CLIENT_ENUM.P_Role_QQHall_GetReward,e)},n([g(cc.Label)],t.prototype,"label",void 0),n([g],t.prototype,"text",void 0),n([f],t)}(cc.Component);o.default=m,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../modules/base/GameView":"GameView","../../network/ClientNetwork":"ClientNetwork","../../network/protocol/RoleProtocols":"RoleProtocols","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/GameTools":"GameTools","../../utils/QQGameHallUtils":"QQGameHallUtils"}],QQHallRewardTableData:[function(e,t,o){"use strict";cc._RF.push(t,"e31426DnyRG74pjInLhh42z","QQHallRewardTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.QQHallRewardTableData=void 0;var i=e("../TableReader"),a=function(){function e(){this.id=0,this.type=0,this.level=0,this.dropId=0,this.title="",this.desc=""}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.type=e.getNumber(),this.level=e.getNumber(),this.dropId=e.getNumber(),this.title=e.getString(),this.desc=e.getString()},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"QQHallRewardTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.QQHallRewardTableData=a,cc._RF.pop()},{"../TableReader":"TableReader"}],QQHallVipView:[function(e,t,o){"use strict";cc._RF.push(t,"f1fe0sQpoxItJruCr+f+FNd","QQHallVipView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../common/PlayerModule"),s=e("../../modules/base/BaseView"),c=e("../../modules/base/Decorators"),l=e("../../network/ClientNetwork"),d=e("../../network/protocol/RoleProtocols"),u=e("../../network/protocol/TypeProtocols"),h=e("../../utils/GameUtils"),p=e("../../utils/QQGameHallUtils"),f=e("./QQHallListItem"),g=cc._decorator,m=g.ccclass,_=g.property,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.scrollContent=null,t}return a(t,e),t.path=function(){return"ui/qqhall/qqhallvip"},t.prototype.onLoad=function(){this.node_panelNew=this.node.getChildByName("giftNew"),this.node_panelLevel=this.node.getChildByName("giftLevel"),this.node_panelDay=this.node.getChildByName("giftDay");var e=r.default.getRoleInfoData();console.log("QQHallVipView, \u84dd\u94bb\u7b49\u7ea7\u4fe1\u606f, qqhallvipinfo=",e.qqHallBlueVipVector),console.log("QQHallVipView, \u7279\u6743\u5956\u52b1\u9886\u53d6\u4fe1\u606f, qqhallrewards=",e.qqHallRewardsVector)},t.prototype.start=function(){var e=this;l.ClientNetwork.getInstance().listenProtocol(d.ROLE_CLIENT_ENUM.P_Role_QQHall_GetReward,function(t){t.resetPos();var o=new d.S_Role_QQHall_GetReward;o.read(t)&&0==o.errorcode&&1==e.node.active&&(e.initPanelNew(),e.initPanelLevel(),e.initPanelDay())},this),this.onClickTabNew()},t.prototype.initPanelNew=function(){var e=p.QQGameHallUtils.getTableDataByType(u.QQHALL_REWARD_TYPE.QQHALL_REWARD_TYPE_HALL_NEW)[0].dropId;p.QQGameHallUtils.showItemsToContainer(e,this.node_panelNew.getChildByName("reward")),p.QQGameHallUtils.isRewardReceived(u.QQHALL_REWARD_TYPE.QQHALL_REWARD_TYPE_HALL_NEW,0)?(this.node_panelNew.getChildByName("btn_lingqu").active=!1,this.node_panelNew.getChildByName("finish").active=!0):(this.node_panelNew.getChildByName("btn_lingqu").active=!0,this.node_panelNew.getChildByName("finish").active=!1)},t.prototype.initPanelLevel=function(){var e=this,t=p.QQGameHallUtils.getTableDataByType(u.QQHALL_REWARD_TYPE.QQHALL_REWARD_TYPE_HALL_LEVEL);this.scrollContent.removeAllChildren();for(var o=function(o){h.LoadNode("ui/qqhall/qqhallLIstItem").then(function(i){i.parent=e.scrollContent,i.getComponent(f.default).init(t[o])})},i=0;i<t.length;i++)o(i)},t.prototype.initPanelDay=function(){var e=p.QQGameHallUtils.getTableDataByType(u.QQHALL_REWARD_TYPE.QQHALL_REWARD_TYPE_HALL_DAY)[0].dropId;p.QQGameHallUtils.showItemsToContainer(e,this.node_panelDay.getChildByName("reward")),p.QQGameHallUtils.isRewardReceived(u.QQHALL_REWARD_TYPE.QQHALL_REWARD_TYPE_HALL_DAY,0)?(this.node_panelDay.getChildByName("btn_giftday_lingqu").active=!1,this.node_panelDay.getChildByName("finish").active=!0):(this.node_panelDay.getChildByName("btn_giftday_lingqu").active=!0,this.node_panelDay.getChildByName("finish").active=!1)},t.prototype.onClickTabNew=function(){this.node_panelNew.active=!0,this.node_panelLevel.active=!1,this.node_panelDay.active=!1,this.initPanelNew()},t.prototype.onClickTabLevel=function(){this.node_panelNew.active=!1,this.node_panelLevel.active=!0,this.node_panelDay.active=!1,this.initPanelLevel()},t.prototype.onClickTabDay=function(){this.node_panelNew.active=!1,this.node_panelLevel.active=!1,this.node_panelDay.active=!0,this.initPanelDay()},t.prototype.onClickGetRewardNew=function(){var e=new d.C_Role_QQHall_GetReward;e.type=u.QQHALL_REWARD_TYPE.QQHALL_REWARD_TYPE_HALL_NEW,e.level=0,l.ClientNetwork.getInstance().Send(d.ROLE_CLIENT_ENUM.P_Role_QQHall_GetReward,e)},t.prototype.onClickGetRewardDay=function(){var e=new d.C_Role_QQHall_GetReward;e.type=u.QQHALL_REWARD_TYPE.QQHALL_REWARD_TYPE_HALL_DAY,e.level=0,l.ClientNetwork.getInstance().Send(d.ROLE_CLIENT_ENUM.P_Role_QQHall_GetReward,e)},n([_(cc.Node)],t.prototype,"scrollContent",void 0),n([c.Register_Class,m],t)}(s.default);o.default=y,cc._RF.pop()},{"../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../network/ClientNetwork":"ClientNetwork","../../network/protocol/RoleProtocols":"RoleProtocols","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/GameUtils":"GameUtils","../../utils/QQGameHallUtils":"QQGameHallUtils","./QQHallListItem":"QQHallListItem"}],QQMiniGameUtils:[function(e,t,o){"use strict";cc._RF.push(t,"b2f9dINx7pO67xiC4J5bfk/","QQMiniGameUtils"),Object.defineProperty(o,"__esModule",{value:!0}),o.QQMiniGameUtils=o.DanceJumpPostEventType=void 0;var i,a=e("../../load"),n=e("../common/PlayerModule"),r=e("../Global/GameGlobal"),s=e("../network/ClientNetwork"),c=e("../network/LocalMessage"),l=e("../network/protocol/MatchProtocols"),d=e("../network/protocol/RechargeProtocols"),u=e("../network/protocol/RoleProtocols"),h=e("../StaticData/RechargeTableData"),p=e("./GamePlatform"),f=e("./GameUtils"),g=e("./subUtils/TypeDef"),m=e("../common/NetworkProtocolCommon"),_=e("../network/protocol/TypeProtocols"),y=e("../modules/base/GameView"),v=e("../StaticData/TaskTableData"),C=e("../TalkingDataAPI"),S=e("./LogUtil"),T=e("../model/ServerAddrInfo"),I=e("../view/activity/ActivityModule");(function(e){e.Active_Type="0",e.Active_Register_Type="1",e.Active_Pay_Type="2",e.Next_Day_Open="6",e.Game_Addiction="25"})(i=o.DanceJumpPostEventType||(o.DanceJumpPostEventType={}));var N=function(){function e(){this.m_nPlatformOS=1,this.m_strEncryptedData="",this.m_strIv="",this.isOpenDanceJumpQQ="",this.m_weichatLoginData=null,this.m_gameClubBtn=null,this.m_syncLiveTime=null,this.m_bFeishuConversion=!1,this.m_click_auth=!1}return e.getInstance=function(){return this.Instance||(this.Instance=new e),this.Instance},e.prototype.getWechatLoginData=function(){return this.m_weichatLoginData},e.prototype.getWechatOS=function(){return this.m_nPlatformOS},e.prototype.requestQQServer=function(){var e="https://mszcs1.gameserver.iplay11g.com/gmsys/weblogic/webc/qqloginbygroup.php";!0===a.getSubmitReviewState()&&(e="https://mszctest.gameserver.iplay11g.com/gmsys/weblogic/webc/qqloginbygroup.php");var t=this;qq.request({url:e,data:{accountname:this.m_weichatLoginData.accountname,open_id:this.m_weichatLoginData.openid,systematic:t.m_nPlatformOS,session_key:this.m_weichatLoginData.session_key,ver:a.wechatminiLoaclGameVer,groupid:g.GlobalVar.getServerGroup().toString()},success:function(e){if(e){var o=JSON.stringify(e.data);console.log("servergroup res.data="+o),t.m_weichatLoginData.sign=e.data.sign,s.ClientNetwork.getInstance().pushLocalMessage(c.LOCAL_MESSAGE.LocalMsg_GetServerAddr,e.data)}else s.ClientNetwork.getInstance().pushLocalMessage(c.LOCAL_MESSAGE.LocalMsg_GetServerAddr,{error:-2})},fail:function(e){console.log("requestWXServer failed1"+e),s.ClientNetwork.getInstance().pushLocalMessage(c.LOCAL_MESSAGE.LocalMsg_GetServerAddr,{error:-2})}})},e.prototype.userLogin=function(){console.log("QQMiniGameUtils, userLogin!");var e=this;qq.checkSession({success:function(){console.log("checkSession");try{e.onLogin()}catch(t){console.log("AccountScene onLoginRet fail"),e.onLogin()}},fail:function(){e.onLogin()}})},e.prototype.onLogin=function(){console.log("QQMiniGameUtils, onLogin!");var e=this;cc.sys.os==cc.sys.OS_IOS?this.m_nPlatformOS=2:cc.sys.os==cc.sys.OS_WINDOWS&&(this.m_nPlatformOS=3);var t=T.ServerAddrInfo.getInstance().getServerListUrl();console.log("QQMiniGameUtils, onLogin url="+t),qq.login({success:function(o){S.default.log("onLogin qq.login success",o),o.code&&(console.log(e.m_nPlatformOS),qq.request({url:t,data:{jscode:o.code,systematic:e.m_nPlatformOS,ver:a.wechatminiLoaclGameVer},success:function(t){if(S.default.log("onLogin code2Session callback succ!",t),t){var o=JSON.stringify(t.data);console.log("servergroup qqgetserverlist res.data="+o),e.m_weichatLoginData=t.data.data;var i=JSON.stringify(t.data.servers);console.log("servergroup qqgetserverlist servers="+i),T.ServerAddrInfo.getInstance().initServerList(t.data.servers),s.ClientNetwork.getInstance().pushLocalMessage(c.LOCAL_MESSAGE.LocalMsg_SDK_LoginRet,{error:0})}else s.ClientNetwork.getInstance().pushLocalMessage(c.LOCAL_MESSAGE.LocalMsg_SDK_LoginRet,{error:-2})},fail:function(e){S.default.log("onLogin failed1",e),s.ClientNetwork.getInstance().pushLocalMessage(c.LOCAL_MESSAGE.LocalMsg_SDK_LoginRet,{error:-2})}}))},fail:function(e){S.default.log("onLogin qq.login failed",e),s.ClientNetwork.getInstance().pushLocalMessage(c.LOCAL_MESSAGE.LocalMsg_SDK_LoginRet,{error:-2})}})},e.prototype.getUserInfo=function(){S.default.log("QQMiniGameUtils, getUserInfo!");var e=this;qq.getUserInfo({success:function(t){e.storageUserInfo(t),e.m_strEncryptedData=t.encryptedData,e.m_strIv=t.iv,e.userLogin()},fail:function(){console.log("getUserInfo fail")}})},e.prototype.storageUserInfo=function(e){var t=e.userInfo;console.log("getUserInfo success"+t.nickName+t.avatarUrl),qq.setStorage({key:"wxNickName",data:t.nickName}),qq.setStorage({key:"wxImage",data:t.avatarUrl}),qq.setStorage({key:"wxSex",data:t.gender}),qq.setStorage({key:"wxAuth",data:!0})},e.prototype.userInfoSetInSQL=function(e){qq.getStorage({key:"third_Session",success:function(t){qq.request({url:"Our Server ApiUrl",data:{third_Session:t.data,nickName:e.nickName,avatarUrl:e.avatarUrl,gender:e.gender,province:e.province,city:e.city,country:e.country},success:function(){}})}})},e.prototype.userAuth=function(e,t){void 0===e&&(e=null),void 0===t&&(t=null);var o=this,i=qq.getSystemInfoSync(),a=i.screenWidth,n=i.screenHeight;qq.getSetting({success:function(i){if(console.log(i.authSetting),i.authSetting["scope.userInfo"])console.log("\u7528\u6237\u5df2\u6388\u6743"),e&&e();else{console.log("\u7528\u6237\u672a\u6388\u6743");var r=qq.createUserInfoButton({type:"text",text:"",style:{left:0,top:0,width:a,height:n,backgroundColor:"#00000000",color:"#000000",fontSize:0,textAlign:"center",lineHeight:n}});r.offTap(function(){console.log("\u7528\u6237\u6388\u6743:offTap",i)}),r.onTap(function(i){o.m_click_auth||(o.m_click_auth=!0,setTimeout(function(){o.m_click_auth=!1},1e3),i.userInfo?(console.log("\u7528\u6237\u6388\u6743:",i),o.storageUserInfo(i),e&&e(),r.destroy()):(console.log("\u7528\u6237\u62d2\u7edd\u6388\u6743:",i),t&&t(),r.destroy()))})}}})},e.prototype.noticeServerPay=function(e){var t=new d.C_Recharge_Role_WeiXinGameMidasPay;t.orderuuid=e,s.ClientNetwork.getInstance().Send(d.RECHARGE_CLIENT_ENUM.P_Recharge_Role_WeiXinGameMidasPay,t,!1)?(cc.error("SendData NCS_ROLE_TEST_ADD_CHONGZHI finish!"),f.setLocalData("userPayRechargeInfo",""),console.log("pay success"+f.getLocalData("userPayRechargeInfo",""))):cc.error("SendData NCS_ROLE_TEST_ADD_CHONGZHI Error!")},e.prototype.pay=function(e,t,o){if(cc.sys.os!=cc.sys.OS_IOS){console.log("rechargeId="+e+", rechargeInfo="+o),console.log("GlobalVar.getZoneId()="+g.GlobalVar.getZoneId());var i=h.RechargeTableData.getById(e);i?(console.log("buyQuantity="+i.money),cc.sys.os==cc.sys.OS_ANDROID||cc.sys.os==cc.sys.OS_WINDOWS?(cc.sys.os,cc.sys.OS_WINDOWS,f.setLocalData("userPayRechargeInfo",o),console.log("pay prepare="+f.getLocalData("userPayRechargeInfo","")),qq.requestMidasPayment({prepayId:o,starCurrency:Math.floor(.1*i.money),setEnv:0,success:function(){console.log("qq\u652f\u4ed8\u6210\u529f")},fail:function(e){var t=e.errMsg,o=e.errCode;console.log("qq\u652f\u4ed8\u5931\u8d25",t,o),f.setLocalData("userPayRechargeInfo",""),console.log("pay fail"+f.getLocalData("userPayRechargeInfo",""))}})):(cc.sys.os,cc.sys.OS_IOS)):f.MESSAGETIPS("RECHARGE_ID_NOTEXIST")}else qq.showModal({title:"\u6e29\u99a8\u63d0\u793a~",content:"\u8be5\u7248\u672c\u672a\u5f00\u653e\u5145\u503c\u529f\u80fd",showCancel:!1,confirmText:"\u786e\u5b9a\u9000\u51fa",success:function(){}})},e.prototype.inviteFriend=function(e,t,o,i,a,n){if(void 0===n&&(n=null),!r.G.UIManager.isFinghtingScene()){qq.shareAppMessage({title:e,imageUrlId:t,imageUrl:o,query:i});var c=new u.C_Role_ClientFinishShare;c.shareID=a,c.is_share=0,s.ClientNetwork.getInstance().Send(u.ROLE_CLIENT_ENUM.P_Role_ClientFinishShare,c),setTimeout(function(){n&&n()},500)}},e.prototype.checkInviteInfo=function(e){if(p.GamePlatform.isQQMiniGame()){var t;for(var o in(t=e||qq.getLaunchOptionsSync()).query){if("battle"==o){var i=t.query.battle;if(i){console.log("checkInviteInfo battleInfo"+i);var a=i.split(".");if((n=new l.C_Match_Duel_Fight).fightType=Number(a[0]),n.useRoom=0,n.roomID=a[1],n.params.push(f.getConfigVersion()),I.default.isChickenDinnerMatching())return r.G.StringManager.PopString(r.G.StringManager.getString("CHICKENDINNER_MATCHING")),m.default.callRoleClientLog("CHICKENDINNER_MATCHING3"),void console.log("isChickenDinnerMatching code=3");s.ClientNetwork.getInstance().Send(l.MATCH_CLIENT_ENUM.P_Match_Duel_Fight,n,!1)}}if("invite"==o){var n,c=t.query.invite;c&&(console.log("checkInviteInfo inviteInfo"+c),(n=new u.C_Role_ShareBindMaster).masterID=c,s.ClientNetwork.getInstance().Send(u.ROLE_CLIENT_ENUM.P_Role_ShareBindMaster,n,!1))}}}},e.prototype.getChannelID=function(){var e=qq.getLaunchOptionsSync();S.default.log("QQMiniGameUtils, getChannelID(), qq.getLaunchOptionsSync=",e);var t=e.query,o=(t.gdt_vid,t.weixinadinfo),i=t.channel,a=t.ad_id,n=t.unit_id;if(a)return Number(a)%1e9;if(n)return Number(n);var r=0;return o&&o.split("."),i?(r=Number(i),qq.setStorage({key:"wxaid",data:r}),r):(console.log("getChannelID "+JSON.stringify(e)),5e4)},e.prototype.onCreatGameClubBtn=function(e){if(!this.m_gameClubBtn){var t=qq.getSystemInfoSync(),o=e.getBoundingBoxToWorld(),i=cc.size(e.width+10,e.height+10),a=cc.view.getFrameSize(),n=cc.director.getWinSize(),r=o.x/n.width*a.width+t.safeArea.left+2*t.statusBarHeight,s=(n.height-o.y-i.height)/n.height*a.height,c=i.width/n.width*a.width,l=i.height/n.height*a.height;this.m_gameClubBtn=qq.createGameClubButton({type:"text",text:"",style:{left:r,top:s,width:c,height:l,lineHeight:0,backgroundColor:"",color:"#3296fa",textAlign:"center",fontSize:16,borderRadius:4}})}},e.prototype.wxReportAnalytics=function(e,t){p.GamePlatform.isQQMiniGame()&&qq.reportAnalytics(e,t)},e.prototype.wxOpenChannelsLive=function(){qq.openChannelsLive?qq.openChannelsLive({finderUserName:"sphKR1PR00Z3jIQ",success:function(e){console.log("\u6253\u5f00\u89c6\u9891\u53f7\u76f4\u64ad\u6210\u529f  ",e)},fail:function(e){console.log("\u6253\u5f00\u89c6\u9891\u53f7\u76f4\u64ad\u5931\u8d25 ",e)},complete:function(e){console.log("\u6253\u5f00\u89c6\u9891\u53f7\u76f4\u64ad\u8c03\u7528\u7ed3\u675f\u7684\u56de\u8c03\u51fd\u6570",e)}}):qq.showModal({title:"\u63d0\u793a",content:"\u5f53\u524d\u5fae\u4fe1\u7248\u672c\u8fc7\u4f4e\uff0c\u65e0\u6cd5\u4f7f\u7528\u8be5\u529f\u80fd\uff0c\u8bf7\u5347\u7ea7\u5230\u6700\u65b0\u5fae\u4fe1\u7248\u672c\u540e\u91cd\u8bd5\u3002"})},e.prototype.wxOnGameLiveStateChange=function(){var e=this;this.wxOffGameLiveStateChange(),qq.onGameLiveStateChange&&qq.onGameLiveStateChange(function(t){if("start"===t.state){e.setSameLiveFeedId(t.feedId),e.wxSyncLiveTimeUpdate();var o=new u.C_Role_Live_Begin;s.ClientNetwork.getInstance().Send(u.ROLE_CLIENT_ENUM.P_Role_Live_Begin,o)}"end"===t.state&&(e.m_syncLiveTime&&(clearInterval(e.m_syncLiveTime),e.m_syncLiveTime=null),e.wxGetUserRecentGameLiveInfo())})},e.prototype.wxGetUserRecentGameLiveInfo=function(){var e=this,t=this.getGameLiveFeedId();t&&(qq.getUserGameLiveDetails?qq.getUserGameLiveDetails({feedIdList:[t],success:function(t){var o=new u.C_Role_WeiXinAnalyzingMessage;o.encryptedData=t.encryptedData,o.iv=t.iv,s.ClientNetwork.getInstance().Send(u.ROLE_CLIENT_ENUM.P_Role_WeiXinAnalyzingMessage,o),e.setSameLiveFeedId("")},fail:function(t){setTimeout(function(){if(0!=t.err_code)e.wxGetUserRecentGameLiveInfo();else{qq.showModal({title:"\u63d0\u793a",content:"\u83b7\u53d6\u5fae\u4fe1\u76f4\u64ad\u6570\u636e\u9519\u8bef\uff0c\u8bf7\u4e0a\u4f20\u65e5\u5fd7\u5230\u5fae\u4fe1\uff01"});var o=n.default.uuidTransformRoieId();C.TalkingDataAPI.event("getUserGameLiveDetails.fail",{code:t.err_code,playerId:o})}},200)}}):qq.showModal({title:"\u63d0\u793a",content:"\u5f53\u524d\u5fae\u4fe1\u7248\u672c\u8fc7\u4f4e\uff0c\u65e0\u6cd5\u4f7f\u7528\u8be5\u529f\u80fd\uff0c\u8bf7\u5347\u7ea7\u5230\u6700\u65b0\u5fae\u4fe1\u7248\u672c\u540e\u91cd\u8bd5\u3002"}))},e.prototype.wxSyncLiveTimeUpdate=function(){var e=this;this.m_syncLiveTime&&(clearInterval(this.m_syncLiveTime),this.m_syncLiveTime=null),this.m_syncLiveTime=setInterval(function(){if(e.wxGetGameLiveState()){var t=new u.C_Role_Live_Update;s.ClientNetwork.getInstance().Send(u.ROLE_CLIENT_ENUM.P_Role_Live_Update,t),setTimeout(function(){var e=[];Array.from(n.default.getRoleTaskData().tasks.values()).forEach(function(t){var o=v.TaskTableData.getById(t.taskID);o.type==_.TASK_TYPE.TASK_TYPE_COUNT_CLIENT&&o.clientType==_.TASK_CLIENT_TYPE.TASK_CLIENT_TYPE_ACHIEVEMENT_LIVE_TIME&&e.push(t)});var t=n.default.getRoleAttrValByKey(_.ROLE_ATTR_VALUES.ROLE_ATTR_DAYLIVETIME);e.forEach(function(e){e.taskCount=t});for(var o=0;o<e.length;o++){var i=new u.C_Role_ClientTaskUpdateCount;i.taskID=e[o].taskID,i.count=e[o].taskCount,s.ClientNetwork.getInstance().Send(u.ROLE_CLIENT_ENUM.P_Role_ClientTaskUpdateCount,i,!1)}s.ClientNetwork.getInstance().pushLocalMessage(c.LOCAL_MESSAGE.LocalMsg_RefreshTask);var a=y.default.getViewByName("MainSceneView");a&&a.view&&a.view.onSyncChangeLiveTaskData()},500)}else clearInterval(e.m_syncLiveTime),e.m_syncLiveTime=null},6e4)},e.prototype.wxOffGameLiveStateChange=function(){qq.offGameLiveStateChange&&qq.offGameLiveStateChange()},e.prototype.wxGetGameLiveState=function(){return!!qq.getGameLiveState&&qq.getGameLiveState().isLive},e.prototype.wxOpenChannelsLiveCollection=function(){qq.openChannelsLiveCollection?qq.openChannelsLiveCollection({openIds:["odsRR5Ew66DsDUAorrT1Ygq3kNzU","odsRR5LjOn0uTKVnZp6m6HsSXVlo","odsRR5LjOn0uTKVnZp6m6HsSXVlo","odsRR5Dad9eLrm4wydhun9EyxWD0"]}):qq.showModal({title:"\u63d0\u793a",content:"\u5f53\u524d\u5fae\u4fe1\u7248\u672c\u8fc7\u4f4e\uff0c\u65e0\u6cd5\u4f7f\u7528\u8be5\u529f\u80fd\uff0c\u8bf7\u5347\u7ea7\u5230\u6700\u65b0\u5fae\u4fe1\u7248\u672c\u540e\u91cd\u8bd5\u3002"})},e.prototype.getGameLiveFeedId=function(){var e=f.getLocalData("GameLiveFeedId");return e.length<=0?null:e},e.prototype.setSameLiveFeedId=function(e){f.setLocalData("GameLiveFeedId",e)},e.prototype.onSendUcConversionInfo=function(e,t){var o=this;if(qq.getStorageSync("uc_trackid"))qq.getStorage({key:"uc_trackid",success:function(i){console.log(i.data),o.onSyncUcreturnback(i.data,e,t)}});else{var i=function(){var e=qq.getLaunchOptionsSync().query;return e.uctrackid?(console.log("\u6253\u5370\u53c2\u6570",e.uctrackid),e.uctrackid):null}.call(this);if(!i)return C.TalkingDataAPI.event("ucNoTrackid"),m.default.callRoleClientLog("ucNoTrackid"),void console.log("not get ucNoTrackid!");qq.setStorage({key:"uc_trackid",data:i,success:function(){o.onSyncUcreturnback(i,e,t)}})}},e.prototype.onSyncUcreturnback=function(e,t,o){console.log("\u6253\u5370\u53c2\u6570Uc  ",e,t,o),e&&(o=o||"1",qq.request({url:"https://mszctest.gameserver.iplay11g.com/gmsys/weblogic/webc/ucreturnback.php",data:{type:t,money:o},success:function(e){console.log("onSendUC success",e.data),C.TalkingDataAPI.event("onSendUC.success",{code:e.data}),m.default.callRoleClientLog(e.data)},fail:function(e){console.log("onSendUC failed1"+e),C.TalkingDataAPI.event("onSendUC.failed",{code:e}),m.default.callRoleClientLog("onSendUC.failed")}}))},e.prototype.onSendBiliConversionInfo=function(e,t){var o=this;if(qq.getStorageSync("bili_trackid"))qq.getStorage({key:"bili_trackid",success:function(i){console.log(i.data),o.onSyncBilireturnback(i.data,e,t)}});else{var i=function(){var e=qq.getLaunchOptionsSync().query;return e.trackid?(console.log("\u6253\u5370\u53c2\u6570",e.trackid),e.trackid):null}.call(this);if(!i)return C.TalkingDataAPI.event("biliNoTrackid"),m.default.callRoleClientLog("biliNoTrackid"),void console.log("not get biliNoTrackid!");qq.setStorage({key:"bili_trackid",data:i,success:function(){o.onSyncBilireturnback(i,e,t)}})}},e.prototype.onSyncBilireturnback=function(e,t,o){console.log("\u6253\u5370\u53c2\u6570B\u7ad9  ",e,t,o),e&&(o=o||1,qq.request({url:"https://mszcs1.gameserver.iplay11g.com/gmsys/weblogic/webc/bilibilireturnback.php",data:{conv_type:t,track_id:e,conv_value:o},success:function(e){console.log("onSendBili success",e.data),C.TalkingDataAPI.event("onSendBili.success",{code:e.data}),m.default.callRoleClientLog(e.data)},fail:function(e){console.log("onSendBili failed1"+e),C.TalkingDataAPI.event("onSendBili.failed",{code:e}),m.default.callRoleClientLog("onSendBili.failed")}}))},e.prototype.onSendFeishuConversionInfo=function(e,t){var o=this;if(qq.getStorageSync("feishu_clue_token"))qq.getStorage({key:"feishu_clue_token",success:function(i){console.log(i.data),o.onSyncFeishureturnback(i.data,e,t)}});else{var i=function(){var e=qq.getLaunchOptionsSync().query;return e.clue_token?e.clue_token:null}.call(this);if(!i)return C.TalkingDataAPI.event("feishuNoClueToken"),m.default.callRoleClientLog("feishuNoClueToken"),console.log("not get clue_token!");qq.setStorage({key:"feishu_clue_token",data:i,success:function(){o.onSyncFeishureturnback(i,e,t)}})}},e.prototype.onSyncFeishureturnback=function(e,t,o){console.log("\u6253\u5370\u53c2\u6570\u6296\u97f3  ",e,this.m_weichatLoginData.accountname,this.m_weichatLoginData.openid),e&&(o=o||0,qq.request({url:"https://mszctest.gameserver.iplay11g.com/gmsys/weblogic/webc/feishureturnback.php",data:{clue_token:e,union_id:this.m_weichatLoginData.accountname,open_id:this.m_weichatLoginData.openid,event_type:t,props:{pay_amount:o}},success:function(e){console.log("onSendFeishu success",e.data),C.TalkingDataAPI.event("onSendFeishu.success",{code:e.data}),m.default.callRoleClientLog(e.data)},fail:function(e){console.log("onSendFeishu failed1"+e),C.TalkingDataAPI.event("onSendFeishu.failed",{code:e}),m.default.callRoleClientLog("onSendFeishu.failed")}}))},e.prototype.shareRenderTexture=function(e){var t=cc.game.canvas,o=t.width,i=t.height,a=1*o,n=1*i,r=0*o,s=0*i,c=t.toTempFilePathSync({x:r,y:s,width:a,height:n,destWidth:500,destHeight:400});console.log("getRenderTexture"+c),qq.shareAppMessage({title:e,imageUrl:c})},e.prototype.quitGame=function(){qq.showModal({title:"\u63d0\u793a",content:"\u4e0d\u540c\u610f\u7528\u6237\u534f\u8bae\u548c\u9690\u79c1\u653f\u7b56\u65e0\u6cd5\u7ee7\u7eed\u6e38\u620f\uff01\u662f\u5426\u786e\u5b9a\u5173\u95ed\u6e38\u620f\uff1f",success:function(e){e.confirm?(console.log("\u7528\u6237\u70b9\u51fb\u786e\u5b9a"),qq.exitMiniProgram({})):e.cancel&&console.log("\u7528\u6237\u70b9\u51fb\u53d6\u6d88")}})},e.prototype.requestUsersIP=function(){return qq.request({url:"https://pv.sohu.com/cityjson?ie=utf-8",success:function(e){if(e){var t=JSON.parse(e.data.match(/.*(\{[^\}]+\}).*/)[1]||"{}");return console.log("ip =>",t.cip,t),t.cip}console.log("requestUsersIP1 get IP res  fail ")},fail:function(e){console.log("requestUsersIP get IP fail"+e)}}),""},e.prototype.onSendDouYinConversionInfo=function(e){var t=this;qq.request({url:"https://mszctest.gameserver.iplay11g.com/gmsys/weblogic/webc/qqgamedouyinadvertiseclient.php",method:"POST",success:function(o){console.log("onSendDouYinConversionInfo success",o.data);var a=JSON.stringify(o.data);console.log("onSendDouYinConversionInfo res.data="+a),o.data.length<=0||(qq.getStorageSync("isDancejumpQQ")?qq.getStorage({key:"isDancejumpQQ",success:function(o){console.log(o.data),t.onSyncDanceJumpQQturnback(o.data,i.Active_Type),t.onSyncDanceJumpQQturnback(o.data,e)}}):qq.setStorage({key:"isDancejumpQQ",data:o.data,success:function(){t.onSyncDanceJumpQQturnback(o.data,i.Active_Type),t.onSyncDanceJumpQQturnback(o.data,e)}}))},fail:function(e){console.log("onSendDouYinConversionInfo failed1"+e)}})},e.prototype.requestDanceJumpQQIsOpen=function(){var e="https://mszcs1.gameserver.iplay11g.com/gmsys/gameClubOpenlink.php?"+Math.random(),t=this;qq.request({url:e+"?"+Math.random(),data:{x:"",y:""},header:{"content-type":"application/json"},method:"GET",success:function(e){e&&(t.isOpenDanceJumpQQ=e.data.isOpenBack)},fail:function(e){console.log("gameClub get Openlink fail"+e)}})},e.prototype.onSyncDanceJumpQQturnback=function(e,t,o){if(void 0===o&&(o=0),"1"==this.isOpenDanceJumpQQ)if(e.length<=0)console.log("tdata.length========null=====");else{console.log("onSyncDanceJumpQQturnback=============",e);var i=0,a="";cc.sys.os==cc.sys.OS_IOS?(i=1,a=e.idfa):cc.sys.os==cc.sys.OS_ANDROID?(i=0,a=e.imei):i=3,qq.request({url:"https://ad.oceanengine.com/track/activate/",data:{callback:e.callback_url,event_type:t,idfa:e.idfa,imei:e.imei,muid:a,os:i},method:"POST",header:{"content-type":"application/json"},success:function(e){console.log("onSyncDanceJumpQQturnback success",e)},fail:function(e){console.log("onSyncDanceJumpQQturnback failed",e)}})}else console.log("this.isOpenDanceJumpQQ========false=====")},e.prototype.addToDesktop=function(){if(0!=p.GamePlatform.isQQMiniGame()){console.log("addToDesktop, qq.onTouchEnd");try{qq.saveAppToDesktop({success:function(){console.log("qq\u6dfb\u52a0\u684c\u9762\u6210\u529f"),m.default.callAddShortcutTask()},fail:function(e){console.log("qq\u6dfb\u52a0\u684c\u9762\u5931\u8d25",e)}})}catch(e){}}},e.prototype.addToCollect=function(){if(0!=p.GamePlatform.isQQMiniGame()){console.log("addToCollect, qq.onTouchEnd");try{qq.addToFavorites({title:"\u6dfb\u52a0\u6536\u85cf\u6807\u9898",imageUrl:"",query:"origin=collect",success:function(e){console.log("addToFavorites success",e),m.default.callAddShortcutTask(2)},fail:function(e){console.log("addToFavorites fail",e)},complete:function(e){console.log("addToFavorites info",e)}})}catch(e){}}},e.Instance=null,e}();o.QQMiniGameUtils=N,cc._RF.pop()},{"../../load":"load","../Global/GameGlobal":"GameGlobal","../StaticData/RechargeTableData":"RechargeTableData","../StaticData/TaskTableData":"TaskTableData","../TalkingDataAPI":"TalkingDataAPI","../common/NetworkProtocolCommon":"NetworkProtocolCommon","../common/PlayerModule":"PlayerModule","../model/ServerAddrInfo":"ServerAddrInfo","../modules/base/GameView":"GameView","../network/ClientNetwork":"ClientNetwork","../network/LocalMessage":"LocalMessage","../network/protocol/MatchProtocols":"MatchProtocols","../network/protocol/RechargeProtocols":"RechargeProtocols","../network/protocol/RoleProtocols":"RoleProtocols","../network/protocol/TypeProtocols":"TypeProtocols","../view/activity/ActivityModule":"ActivityModule","./GamePlatform":"GamePlatform","./GameUtils":"GameUtils","./LogUtil":"LogUtil","./subUtils/TypeDef":"TypeDef"}],RandRechargeGroupTableData:[function(e,t,o){"use strict";cc._RF.push(t,"6141apLtrBCsqxbNU0Vd26O","RandRechargeGroupTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.RandRechargeGroupTableData=o.RandRechargeRefreshTime=void 0;var i=e("../TableReader"),a=function(){function e(){this.hour=0,this.minute=0}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.hour=e.getNumber(),this.minute=e.getNumber()},e}();o.RandRechargeRefreshTime=a;var n=function(){function e(){this.id=0,this.refreshNum=0,this.IsNowRepeat=!1,this.historyNoRefreshNum=0,this.refreshTime=new Array,this.dayHandRefreshNum=0,this.handRefreshCD=0,this.clientType=0}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.refreshNum=e.getNumber(),this.IsNowRepeat=e.getBoolean(),this.historyNoRefreshNum=e.getNumber();for(var o=e.getString(),n=new i.TableReader(o);n.getPos()<n.getLen();){var r=new a;r.readOriginal(n),this.refreshTime.push(r)}this.dayHandRefreshNum=e.getNumber(),this.handRefreshCD=e.getNumber(),this.clientType=e.getNumber()},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"RandRechargeGroupTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.RandRechargeGroupTableData=n,cc._RF.pop()},{"../TableReader":"TableReader"}],RandShopItemTableData:[function(e,t,o){"use strict";cc._RF.push(t,"f0e02LMCntK9pQSy639izAF","RandShopItemTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.RandShopItemTableData=void 0;var i=e("../TableReader"),a=e("./BaseTableData"),n=function(){function e(){this.id=0,this.group=0,this.cost=new Array,this.give=new Array,this.buyNum=0,this.weight=0,this.repeatAddWeight=0,this.repeatDelWeight=0,this.minScore=0,this.maxScore=0,this.replaceReset=!1}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.group=e.getNumber();for(var o=e.getString(),n=new i.TableReader(o);n.getPos()<n.getLen();)(s=new a.DropItem).readOriginal(n),this.cost.push(s);o=e.getString();for(var r=new i.TableReader(o);r.getPos()<r.getLen();){var s;(s=new a.DropItem).readOriginal(r),this.give.push(s)}this.buyNum=e.getNumber(),this.weight=e.getNumber(),this.repeatAddWeight=e.getNumber(),this.repeatDelWeight=e.getNumber(),this.minScore=e.getNumber(),this.maxScore=e.getNumber(),this.replaceReset=e.getBoolean()},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"RandShopItemTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.RandShopItemTableData=n,cc._RF.pop()},{"../TableReader":"TableReader","./BaseTableData":"BaseTableData"}],RandShopPositionTableData:[function(e,t,o){"use strict";cc._RF.push(t,"c931dGNakdFdI9V0ruakFlS","RandShopPositionTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.RandShopPositionTableData=void 0;var i=e("../TableReader"),a=function(){function e(){this.id=0,this.group=0,this.replaceGroup=0,this.replaceNeedNum=0,this.conditionScore=0,this.conditionLevel=0,this.conditionRound=0}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.group=e.getNumber(),this.replaceGroup=e.getNumber(),this.replaceNeedNum=e.getNumber(),this.conditionScore=e.getNumber(),this.conditionLevel=e.getNumber(),this.conditionRound=e.getNumber()},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"RandShopPositionTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.RandShopPositionTableData=a,cc._RF.pop()},{"../TableReader":"TableReader"}],RandShopTableData:[function(e,t,o){"use strict";cc._RF.push(t,"606f90GpI9EG5cfHQdVhErw","RandShopTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.RandShopTableData=void 0;var i=e("../TableReader"),a=function(){function e(){this.id=0,this.name="",this.position=new Array,this.IsDayRefresh=!1,this.IsBuyRefreshPosition=!1,this.dayCDRefreshNum=new Array}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.name=e.getString();for(var o=e.getString(),a=new i.TableReader(o);a.getPos()<a.getLen();){var n=void 0;n=a.getNumber(),this.position.push(n)}this.IsDayRefresh=e.getBoolean(),this.IsBuyRefreshPosition=e.getBoolean(),o=e.getString();for(var r=new i.TableReader(o);r.getPos()<r.getLen();)n=void 0,n=r.getNumber(),this.dayCDRefreshNum.push(n)},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"RandShopTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.RandShopTableData=a,cc._RF.pop()},{"../TableReader":"TableReader"}],RandomHeroView:[function(e,t){"use strict";cc._RF.push(t,"f399cx7g0tOqasPtDO5Spo5","RandomHeroView");var o,i=(o=e("../utils/ConfigUtils"))&&o.__esModule?o:{default:o};cc.Class({extends:cc.Component,properties:{heroIcon:cc.Sprite,heroName:cc.Label,eff:cc.Node},init:function(e,t,o){this.game=e,this.game.node.addChild(this.node),this.playerCombatModel=this.game.playerModel1;var i=this;this.spineNode=this.eff.getComponent(sp.Skeleton),this.spineNode.setAnimation(0,"idle",!0),this.background=this.node.getChildByName("bg"),this.eff=this.node.getChildByName("eff"),this.background.active=!1,this.heroName.string=" ",this.nTargetHeroId=t,this.nAddMoney=o,255!=t?setTimeout(function(){i.pubShowHeroInfo()},1500):setTimeout(function(){i.pubShowInfo()},1500)},pubShowInfo:function(){var e=this;this.background.active=!0,this.eff.active=!1,cc.resources.load("npcImage/18",cc.SpriteFrame,function(t,o){e._replaceSpriteFrame=o,e.heroIcon.spriteFrame=e._replaceSpriteFrame}),this.heroName.string="\u91d1\u5e01"+this.nAddMoney,setTimeout(function(){e.node.active=!1},1e3)},pubShowHeroInfo:function(){var e=this;this.background.active=!0,this.eff.active=!1;var t=i.default.getInstance().getHeroConfig(this.nTargetHeroId);cc.resources.load("npcImage/"+t.image,cc.SpriteFrame,function(t,o){e._replaceSpriteFrame=o,e.heroIcon.spriteFrame=e._replaceSpriteFrame}),this.heroName.string=t.name,setTimeout(function(){e.node.active=!1},1e3)}}),cc._RF.pop()},{"../utils/ConfigUtils":"ConfigUtils"}],RandomSeed:[function(e,t,o){"use strict";cc._RF.push(t,"7205bUQtZlEM7to9UKnQ3ya","RandomSeed"),Object.defineProperty(o,"__esModule",{value:!0}),o.RandomSeed=void 0;var i=e("../common/CombatModule"),a=e("./seedrandom"),n=1/Number.MAX_VALUE,r=function(){function e(){}return e.prototype.RandomSeed=function(e){if(0!=i.default.matchSeedIds.length){e%=i.default.matchSeedIds.length,this.index=e;var t=i.default.matchSeedIds[this.index];this.r=t,this.baseSeed=t,this.rnd=a(this.r)}},e.prototype.getRandom=function(){return this.index++,this.index>=i.default.matchSeedIds.length&&(this.index=0),this.rnd()},e.prototype.getSeed=function(){return this.baseSeed},e.prototype.getIndex=function(){return this.index},e.prototype.logInfo=function(e){void 0===e&&(e=""),console.log(e+" seed:"+this.getSeed()+" index:"+this.getIndex()+"rand"+Math.abs(this.r*n))},e.prototype.randomMinMaxInt=function(e,t){return e>t?-1:(this.index++,this.index>=i.default.matchSeedIds.length&&(this.index=0),Math.floor(e+this.rnd()*(t+1-e)))},e}();o.RandomSeed=r,cc._RF.pop()},{"../common/CombatModule":"CombatModule","./seedrandom":"seedrandom"}],RankListItem:[function(e,t,o){"use strict";cc._RF.push(t,"96a31b8Gb5Dp61MnoHEkATx","RankListItem");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../network/protocol/TypeProtocols"),s=e("../../Global/GameGlobal"),c=e("../../utils/GameUtils"),l=e("../../utils/GameTools"),d=e("../../modules/base/GameView"),u=e("../../modules/manager/LoadResManager"),h=e("../sociaty/SociatyCtrl"),p=e("../sociaty/SociatyModel"),f=e("../../utils/GamePlatform"),g=e("../../utils/QQGameHallUtils"),m=cc._decorator,_=m.ccclass,y=m.property,v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.player_pve_name_label=null,t.player_pvp_name_label=null,t.other_name_label=null,t.rank_label=null,t.round_label=null,t.round_time_label=null,t.score_label=null,t.winrate_label=null,t.player_icon=null,t.other_icon=null,t.pvp_node=null,t.pve_node=null,t.sociaty_node=null,t.achievement_node=null,t.anniversary_node=null,t.fogHidden_node=null,t.rank1=null,t.rank2=null,t.rank3=null,t.rank_number=null,t.sociatyNameLab=null,t}return a(t,e),t.prototype.start=function(){},t.prototype.initData=function(e,t,o){var i=this;this.rank1.active=1==t,this.rank2.active=2==t,this.rank3.active=3==t,this.rank_number.active=t>3;var a,n=JSON.parse(o);if(this.pvp_node.active=e==r.FIGHT_TYPE.FIGHT_TYPE_BATTLE,this.pve_node.active=e==r.FIGHT_TYPE.FIGHT_TYPE_COOPERATION||e==r.RANKLIST_TYPE.RANKLIST_TYPE_WEEK_COOPERATION||e==r.RANKLIST_TYPE.RANKLIST_TYPE_OCCUPATION,this.sociaty_node.active=e==r.RANKLIST_TYPE.RANKLIST_TYPE_SOCIATY,this.achievement_node.active=e==r.RANKLIST_TYPE.RANKLIST_TYPE_ACHIEVEMENT,this.anniversary_node.active=e==r.RANKLIST_TYPE.RANKLIST_TYPE_ANNIVERSARY_TRIAL,this.fogHidden_node.active=e==r.RANKLIST_TYPE.RANKLIST_TYPE_FOGHIDDEN1||e==r.RANKLIST_TYPE.RANKLIST_TYPE_FOGHIDDEN2||e==r.RANKLIST_TYPE.RANKLIST_TYPE_FOGHIDDEN3,this.rank_label.string=t.toString(),e==r.FIGHT_TYPE.FIGHT_TYPE_COOPERATION||e==r.RANKLIST_TYPE.RANKLIST_TYPE_WEEK_COOPERATION||e==r.RANKLIST_TYPE.RANKLIST_TYPE_OCCUPATION){e!=r.RANKLIST_TYPE.RANKLIST_TYPE_WEEK_COOPERATION&&e!=r.RANKLIST_TYPE.RANKLIST_TYPE_OCCUPATION||(this.node.scale=.88);var m=function(e){var t=e%6e4/1e3;return parseInt((e%36e5/6e4).toString())+" \u5206 "+t+" \u79d2 "};this.round_time_label.string=m.call(this,1e3*n.totaltime),n.totaltime<=0?this.round_time_label.node.active=!1:this.round_time_label.node.active=!0,this.round_label.string=s.G.StringManager.getString("MY_ROUND",n.round);var _=n.roles,y=0,v=function(e){if(Object.prototype.hasOwnProperty.call(_,e)){var t=null;if(R=_[e],1==y)if(C.player_pve_name_label.string=R.nickname,C.player_pvp_name_label.string=R.nickname,R.headid=R.headid<=0?1:R.headid,c.setRemoteHeadIcon(R.headurl,R.headid,C.player_icon),t=C.player_icon,C.pve_node.getChildByName("pvp_role_sociaty").getComponent(cc.Label).string=R.sociatyName?R.sociatyName:"",f.GamePlatform.isQQGameRoom()&&R.isBlueVip>=0){C.pve_node.getChildByName("layout_name").getChildByName("bluevip").active=!0;var o=R.isBlueVip,i=R.isBlueYear,a=R.blueVipLv,n=R.isBlueSuperVip;g.QQGameHallUtils.setBlueIcon(C.pve_node.getChildByName("layout_name").getChildByName("bluevip").getChildByName("icon"),!1,o,i,a,n),g.QQGameHallUtils.setBlueIcon(C.pve_node.getChildByName("layout_name").getChildByName("bluevip").getChildByName("year"),!0,o,i),o&&i&&R.nickname.length>5?C.player_pve_name_label.fontSize=20:C.player_pve_name_label.fontSize=25}else C.pve_node.getChildByName("layout_name").getChildByName("bluevip").active=!1;else C.other_name_label.string=R.nickname,R.headid=R.headid<=0?1:R.headid,c.setRemoteHeadIcon(R.headurl,R.headid,C.other_icon),t=C.other_icon,C.pve_node.getChildByName("pvp_role_sociaty1").getComponent(cc.Label).string=R.sociatyName?R.sociatyName:"",f.GamePlatform.isQQGameRoom()&&R.isBlueVip>=0?(C.pve_node.getChildByName("layout_name2").getChildByName("bluevip").active=!0,o=R.isBlueVip,i=R.isBlueYear,a=R.blueVipLv,n=R.isBlueSuperVip,g.QQGameHallUtils.setBlueIcon(C.pve_node.getChildByName("layout_name2").getChildByName("bluevip").getChildByName("icon"),!1,o,i,a,n),g.QQGameHallUtils.setBlueIcon(C.pve_node.getChildByName("layout_name2").getChildByName("bluevip").getChildByName("year"),!0,o,i)):C.pve_node.getChildByName("layout_name2").getChildByName("bluevip").active=!1;if(y++,t){t.node.roleid=R.roleid;var r=R.headframeid;(r<=0||r>=2e3)&&(r=200),u.default.loadSpriteFrame("ui/headFrame/frame_"+r).then(function(e){t.node&&(t.node.getChildByName("headframe").getComponent(cc.Sprite).spriteFrame=e)}),l.default.registerTouchEvent(t.node,function(e){var t=d.default.getViewByName("MainSceneView");t&&t.view&&t.view.onCallGetRoleSimpleInfo(e.target.roleid)})}}},C=this;for(var S in _)v(S)}if(e==r.FIGHT_TYPE.FIGHT_TYPE_BATTLE){if(this.score_label.string=s.G.StringManager.getString("MY_SCORE",n.score),Object.prototype.hasOwnProperty.call(n,"winrate")){var T=n.winrate;this.winrate_label.string=s.G.StringManager.getString("WIN_RATE",T)}else this.winrate_label.string=s.G.StringManager.getString("WIN_RATE",0);if("role"in n){var I=n.role;if(this.player_pvp_name_label.string=I.nickname,this.sociatyNameLab.string=I.sociatyName?I.sociatyName:"",I.headid=I.headid<=0?1:I.headid,c.setRemoteHeadIcon(I.headurl,I.headid,this.player_icon),((a=I.headframeid)<=0||a>=2e3)&&(a=200),u.default.loadSpriteFrame("ui/headFrame/frame_"+a).then(function(e){i.player_icon.node.getChildByName("headframe").getComponent(cc.Sprite).spriteFrame=e}),this.player_icon.node.roleid=I.roleid,l.default.registerTouchEvent(this.player_icon.node,function(e){var t=d.default.getViewByName("MainSceneView");t&&t.view&&t.view.onCallGetRoleSimpleInfo(e.target.roleid)}),f.GamePlatform.isQQGameRoom()&&I.isBlueVip>=0){this.pvp_node.getChildByName("bluevip").active=!0;var N=I.isBlueVip,b=I.isBlueYear,w=I.blueVipLv,E=I.isBlueSuperVip;g.QQGameHallUtils.setBlueIcon(this.pvp_node.getChildByName("bluevip").getChildByName("icon"),!1,N,b,w,E),g.QQGameHallUtils.setBlueIcon(this.pvp_node.getChildByName("bluevip").getChildByName("year"),!0,N,b)}else this.pvp_node.getChildByName("bluevip").active=!1}}(e==r.RANKLIST_TYPE.RANKLIST_TYPE_SOCIATY&&(this.node.getChildByName("player1").active=!1,this.sociaty_node.getChildByName("sociaty_name").getComponent(cc.Label).string=n.sociatyName,this.sociaty_node.getChildByName("sociaty_id").getComponent(cc.Label).string=n.sociatyId,this.sociaty_node.getChildByName("renuw").children[0].getComponent(cc.Label).string=n.sociatyNum+"/"+n.sociatyMaxNum,this.sociaty_node.getChildByName("huizhang").children[0].getComponent(cc.Label).string=n.sociatyPresidentName,this.sociaty_node.getChildByName("sociaty_lv").getComponent(cc.Label).string=s.G.StringManager.getString("SOCIATY_LEVEL_TEXT",n.sociatyLevel),this.sociaty_node.getChildByName("score").children[0].getComponent(cc.Label).string=n.sociatyTotalScore,this.node.sociatyId=n.sociatyId,l.default.registerTouchEvent(this.node,function(e){p.default.instance().bPopSociatyInfoView=!0,h.default.c_Sociaty_RoleGetSociatyData(e.target.sociatyId+"")})),e==r.RANKLIST_TYPE.RANKLIST_TYPE_ACHIEVEMENT&&(this.achievement_node.getChildByName("score").getComponent(cc.Label).string=n.score,"roles"in n)&&(I=n.roles[Object.keys(n.roles)],this.achievement_node.getChildByName("pvp_role_name").getComponent(cc.Label).string=I.nickname,this.achievement_node.getChildByName("pvp_role_sociaty").getComponent(cc.Label).string=I.sociatyName?I.sociatyName:"",I.headid=I.headid<=0?1:I.headid,c.setRemoteHeadIcon(I.headurl,I.headid,this.player_icon),((a=I.headframeid)<=0||a>=2e3)&&(a=200),u.default.loadSpriteFrame("ui/headFrame/frame_"+a).then(function(e){i.player_icon.node.getChildByName("headframe").getComponent(cc.Sprite).spriteFrame=e}),this.player_icon.node.roleid=I.roleid,l.default.registerTouchEvent(this.player_icon.node,function(e){var t=d.default.getViewByName("MainSceneView");t&&t.view&&t.view.onCallGetRoleSimpleInfo(e.target.roleid)}),f.GamePlatform.isQQGameRoom()&&I.isBlueVip>=0?(this.achievement_node.getChildByName("bluevip").active=!0,N=I.isBlueVip,b=I.isBlueYear,w=I.blueVipLv,E=I.isBlueSuperVip,g.QQGameHallUtils.setBlueIcon(this.achievement_node.getChildByName("bluevip").getChildByName("icon"),!1,N,b,w,E),g.QQGameHallUtils.setBlueIcon(this.achievement_node.getChildByName("bluevip").getChildByName("year"),!0,N,b)):this.achievement_node.getChildByName("bluevip").active=!1),e==r.RANKLIST_TYPE.RANKLIST_TYPE_ANNIVERSARY_TRIAL)&&(this.node.scale=.88,this.anniversary_node.getChildByName("score").getComponent(cc.Label).string=s.G.StringManager.getString("MY_SCORE",n.score),Object.prototype.hasOwnProperty.call(n,"winrate")?(T=n.winrate,this.anniversary_node.getChildByName("winrate").getComponent(cc.Label).string=s.G.StringManager.getString("WIN_RATE",T)):this.anniversary_node.getChildByName("winrate").getComponent(cc.Label).string=s.G.StringManager.getString("WIN_RATE",0),"role"in n&&(I=n.role,this.anniversary_node.getChildByName("pvp_role_name").getComponent(cc.Label).string=I.nickname,this.anniversary_node.getChildByName("pvp_role_sociaty").getComponent(cc.Label).string=I.sociatyName?I.sociatyName:"",I.headid=I.headid<=0?1:I.headid,c.setRemoteHeadIcon(I.headurl,I.headid,this.player_icon),((a=I.headframeid)<=0||a>=2e3)&&(a=200),u.default.loadSpriteFrame("ui/headFrame/frame_"+a).then(function(e){i.player_icon.node.getChildByName("headframe").getComponent(cc.Sprite).spriteFrame=e}),this.player_icon.node.roleid=I.roleid,l.default.registerTouchEvent(this.player_icon.node,function(e){var t=d.default.getViewByName("MainSceneView");t&&t.view&&t.view.onCallGetRoleSimpleInfo(e.target.roleid)}),f.GamePlatform.isQQGameRoom()&&I.isBlueVip>=0?(this.anniversary_node.getChildByName("bluevip").active=!0,N=I.isBlueVip,b=I.isBlueYear,w=I.blueVipLv,E=I.isBlueSuperVip,g.QQGameHallUtils.setBlueIcon(this.anniversary_node.getChildByName("bluevip").getChildByName("icon"),!1,N,b,w,E),g.QQGameHallUtils.setBlueIcon(this.anniversary_node.getChildByName("bluevip").getChildByName("year"),!0,N,b)):this.anniversary_node.getChildByName("bluevip").active=!1));if(e==r.RANKLIST_TYPE.RANKLIST_TYPE_FOGHIDDEN1||e==r.RANKLIST_TYPE.RANKLIST_TYPE_FOGHIDDEN2||e==r.RANKLIST_TYPE.RANKLIST_TYPE_FOGHIDDEN3){var P=this.fogHidden_node.children[1].getChildByName("time");m=function(e){var t=e%864e5/36e5,o=e%36e5/6e4,i=e%6e4/1e3;return parseInt(t.toString())>0?parseInt(t.toString())+" \u65f6 "+parseInt(o.toString())+" \u5206 "+i+" \u79d2 ":parseInt(o.toString())+" \u5206 "+i+" \u79d2 "},P.getComponent(cc.Label).string=m.call(this,1e3*n.totaltime),n.totaltime<=0?P.active=!1:P.active=!0,e==r.RANKLIST_TYPE.RANKLIST_TYPE_FOGHIDDEN2?(this.fogHidden_node.children[1].getChildByName("star2").active=!0,this.fogHidden_node.children[1].getChildByName("star1").active=!1,this.fogHidden_node.children[1].getChildByName("star3").active=!1):e==r.RANKLIST_TYPE.RANKLIST_TYPE_FOGHIDDEN1?(this.fogHidden_node.children[1].getChildByName("star2").active=!1,this.fogHidden_node.children[1].getChildByName("star1").active=!0,this.fogHidden_node.children[1].getChildByName("star3").active=!1):e==r.RANKLIST_TYPE.RANKLIST_TYPE_FOGHIDDEN3&&(this.fogHidden_node.children[1].getChildByName("star2").active=!1,this.fogHidden_node.children[1].getChildByName("star1").active=!1,this.fogHidden_node.children[1].getChildByName("star3").active=!0);var R,L=this.fogHidden_node.getChildByName("layout_name").getChildByName("pve_role_name"),A=this.fogHidden_node.getChildByName("layout_name2").getChildByName("pve_other_name"),D=(_=n.roles,y=0,function(e){if(Object.prototype.hasOwnProperty.call(_,e)){var t=null;if(R=_[e],1==y)if(L.getComponent(cc.Label).string=R.nickname,R.headid=R.headid<=0?1:R.headid,c.setRemoteHeadIcon(R.headurl,R.headid,M.player_icon),t=M.player_icon,M.fogHidden_node.getChildByName("pvp_role_sociaty").getComponent(cc.Label).string=R.sociatyName?R.sociatyName:"",f.GamePlatform.isQQGameRoom()&&R.isBlueVip>=0){M.fogHidden_node.getChildByName("layout_name").getChildByName("bluevip").active=!0;var o=R.isBlueVip,i=R.isBlueYear,a=R.blueVipLv,n=R.isBlueSuperVip;g.QQGameHallUtils.setBlueIcon(M.fogHidden_node.getChildByName("layout_name").getChildByName("bluevip").getChildByName("icon"),!1,o,i,a,n),g.QQGameHallUtils.setBlueIcon(M.fogHidden_node.getChildByName("layout_name").getChildByName("bluevip").getChildByName("year"),!0,o,i),o&&i&&R.nickname.length>5?L.getComponent(cc.Label).fontSize=20:L.getComponent(cc.Label).fontSize=25}else M.fogHidden_node.getChildByName("layout_name").getChildByName("bluevip").active=!1;else A.getComponent(cc.Label).string=R.nickname,R.headid=R.headid<=0?1:R.headid,c.setRemoteHeadIcon(R.headurl,R.headid,M.fogHidden_node.getChildByName("player2").getComponent(cc.Sprite)),t=M.fogHidden_node.getChildByName("player2").getComponent(cc.Sprite),M.fogHidden_node.getChildByName("pvp_role_sociaty1").getComponent(cc.Label).string=R.sociatyName?R.sociatyName:"",f.GamePlatform.isQQGameRoom()&&R.isBlueVip>=0?(M.fogHidden_node.getChildByName("layout_name2").getChildByName("bluevip").active=!0,o=R.isBlueVip,i=R.isBlueYear,a=R.blueVipLv,n=R.isBlueSuperVip,g.QQGameHallUtils.setBlueIcon(M.fogHidden_node.getChildByName("layout_name2").getChildByName("bluevip").getChildByName("icon"),!1,o,i,a,n),g.QQGameHallUtils.setBlueIcon(M.fogHidden_node.getChildByName("layout_name2").getChildByName("bluevip").getChildByName("year"),!0,o,i)):M.fogHidden_node.getChildByName("layout_name2").getChildByName("bluevip").active=!1;if(y++,t){t.node.roleid=R.roleid;var r=R.headframeid;(r<=0||r>=2e3)&&(r=200),u.default.loadSpriteFrame("ui/headFrame/frame_"+r).then(function(e){t.node&&(t.node.getChildByName("headframe").getComponent(cc.Sprite).spriteFrame=e)}),l.default.registerTouchEvent(t.node,function(e){var t=d.default.getViewByName("MainSceneView");t&&t.view&&t.view.onCallGetRoleSimpleInfo(e.target.roleid)})}}}),M=this;for(var S in _)D(S)}},n([y(cc.Label)],t.prototype,"player_pve_name_label",void 0),n([y(cc.Label)],t.prototype,"player_pvp_name_label",void 0),n([y(cc.Label)],t.prototype,"other_name_label",void 0),n([y(cc.Label)],t.prototype,"rank_label",void 0),n([y(cc.Label)],t.prototype,"round_label",void 0),n([y(cc.Label)],t.prototype,"round_time_label",void 0),n([y(cc.Label)],t.prototype,"score_label",void 0),n([y(cc.Label)],t.prototype,"winrate_label",void 0),n([y(cc.Sprite)],t.prototype,"player_icon",void 0),n([y(cc.Sprite)],t.prototype,"other_icon",void 0),n([y(cc.Node)],t.prototype,"pvp_node",void 0),n([y(cc.Node)],t.prototype,"pve_node",void 0),n([y(cc.Node)],t.prototype,"sociaty_node",void 0),n([y(cc.Node)],t.prototype,"achievement_node",void 0),n([y(cc.Node)],t.prototype,"anniversary_node",void 0),n([y(cc.Node)],t.prototype,"fogHidden_node",void 0),n([y(cc.Node)],t.prototype,"rank1",void 0),n([y(cc.Node)],t.prototype,"rank2",void 0),n([y(cc.Node)],t.prototype,"rank3",void 0),n([y(cc.Node)],t.prototype,"rank_number",void 0),n([y(cc.Label)],t.prototype,"sociatyNameLab",void 0),n([_],t)}(cc.Component);o.default=v,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../modules/base/GameView":"GameView","../../modules/manager/LoadResManager":"LoadResManager","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/GamePlatform":"GamePlatform","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils","../../utils/QQGameHallUtils":"QQGameHallUtils","../sociaty/SociatyCtrl":"SociatyCtrl","../sociaty/SociatyModel":"SociatyModel"}],RankListPrizeTableData:[function(e,t,o){"use strict";cc._RF.push(t,"f088cl+3jFNrrUzNkmkgSqn","RankListPrizeTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.RankListPrizeTableData=void 0;var i=e("../TableReader"),a=e("./BaseTableData"),n=function(){function e(){this.id=0,this.rankMin=0,this.rankMax=0,this.type=0,this.mailid=0,this.prize=new Array}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.rankMin=e.getNumber(),this.rankMax=e.getNumber(),this.type=e.getNumber(),this.mailid=e.getNumber();for(var o=e.getString(),n=new i.TableReader(o);n.getPos()<n.getLen();){var r=new a.DropItem;r.readOriginal(n),this.prize.push(r)}},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"RankListPrizeTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.RankListPrizeTableData=n,cc._RF.pop()},{"../TableReader":"TableReader","./BaseTableData":"BaseTableData"}],RankListView:[function(e,t,o){"use strict";cc._RF.push(t,"93153I52FVGZ5cRgW9eJBNy","RankListView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../Global/GameGlobal"),s=e("../../network/protocol/TypeProtocols"),c=e("../../common/PlayerModule"),l=e("../../modules/base/BaseView"),d=e("../../modules/manager/LoadResManager"),u=e("../../utils/LogUtil"),h=e("../../modules/base/Decorators"),p=e("../../utils/GamePlatform"),f=e("../../../load"),g=e("../../network/protocol/TypeProtocols"),m=e("../../utils/GameTools"),_=e("../sociaty/SociatyModel"),y=e("../../utils/List"),v=cc._decorator,C=v.ccclass,S=v.property,T=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.my_rank_label=null,t.my_rank_num=null,t.my_round_label=null,t.my_round_time_label=null,t.my_score_label=null,t.my_winrate_label=null,t.my_winrate_num=null,t.coopScrollList=null,t.pvpScrollRank=null,t.my_score_icon=null,t.my_sociaty_score_icon=null,t.pvpTabLayoutNode=null,t.pvpScrollList=null,t.sociatyScrollList=null,t.achievementScrollList=null,t.my_achievement_icon=null,t.my_achievement_score_label=null,t.tPvpRankListData=[],t.tPvpRankIdxArr=[],t.tCoopRankListData=[],t.tSociatyRankListData=[],t.curSelectRankIndex=0,t.achievementRankPageIdx=1,t.achievementRankMaxPage=0,t.tAchievementRankListData=[],t}return a(t,e),t.path=function(){return"ui/ranklist/ranklist"},t.prototype.init=function(){var e=this;this.pvpTabLayoutNode.node.children.forEach(function(t,o){t.children[1].active=!1,t.children[2].getComponent(cc.Label).string=(o+1).toString(),m.default.registerTouchEvent(t,function(t){e.onClickPvpTabCallBack(t)})}),this.onClickPvpRankTabCallBack()},t.prototype.onLoad=function(){this.pvpScrollList.node.on("scroll-to-bottom",this.onScrollBottom,this),this.pvpScrollList.node.on("bounce-bottom",this.onScrollBottom,this),this.pvpScrollList.node.on("scroll-began",this.onScrollScrolling,this),this.achievementScrollList.node.on("bounce-bottom",this.onAchievementScrollBottom,this)},t.prototype.onScrollBottom=function(){this.pvpTabLayoutNode.node.active=!0},t.prototype.onScrollScrolling=function(){this.pvpTabLayoutNode.node.active=!1},t.prototype.onAchievementScrollBottom=function(){this.achievementRankPageIdx>=this.achievementRankMaxPage||(this.achievementRankPageIdx++,this.callAchievementRankList())},t.prototype.start=function(){var e=this;d.default.loadPrefab("ui/CommonPrefab/TopView").then(function(t){t.parent=e.node,t.getComponent("TopView").bindExitEvent(function(){e.closeView()})}).catch(function(e){u.default.info(e)})},t.prototype.onClickPvpRankTabCallBack=function(){this.curSelectRankIndex!=s.RANKLIST_TYPE.RANKLIST_TYPE_BATTLE&&(this.my_round_label.node.active=!1,this.my_round_time_label.node.active=!1,this.my_score_label.node.active=!0,this.my_score_icon.node.active=!0,this.my_winrate_label.node.active=!1,this.my_sociaty_score_icon.node.active=!1,this.pvpScrollRank.node.active=!0,this.my_achievement_icon.node.active=!1,this.my_achievement_score_label.node.active=!1,this.onClickPvpTabCallBack(),this.sociatyScrollList.scrollTo(-1,.2),this.pvpScrollList.scrollTo(-1,.2),this.coopScrollList.scrollTo(-1,.2),this.achievementScrollList.scrollTo(-1,.2),this.coopScrollList.node.active=!1,this.sociatyScrollList.node.active=!1,this.pvpScrollList.node.active=!0,this.achievementScrollList.node.active=!1,this.curSelectRankIndex=s.RANKLIST_TYPE.RANKLIST_TYPE_BATTLE)},t.prototype.onClickCoopRankTabCallBack=function(){this.curSelectRankIndex!=s.RANKLIST_TYPE.RANKLIST_TYPE_COOPERATION&&(this.my_round_time_label.node.active=!1,this.my_round_label.node.active=!0,this.my_score_label.node.active=!1,this.my_score_icon.node.active=!1,this.my_winrate_label.node.active=!1,this.my_sociaty_score_icon.node.active=!1,this.pvpScrollRank.node.active=!1,this.my_achievement_icon.node.active=!1,this.my_achievement_score_label.node.active=!1,this.callCoopRankList(),this.sociatyScrollList.scrollTo(-1,.2),this.pvpScrollList.scrollTo(-1,.2),this.coopScrollList.scrollTo(-1,.2),this.achievementScrollList.scrollTo(-1,.2),this.sociatyScrollList.node.active=!1,this.pvpScrollList.node.active=!1,this.coopScrollList.node.active=!0,this.achievementScrollList.node.active=!1,this.curSelectRankIndex=s.RANKLIST_TYPE.RANKLIST_TYPE_COOPERATION)},t.prototype.onClickSociatyTabCallBack=function(){this.curSelectRankIndex!=s.RANKLIST_TYPE.RANKLIST_TYPE_SOCIATY&&(this.pvpScrollRank.node.active=!1,this.my_round_label.node.active=!1,this.my_round_time_label.node.active=!1,this.my_score_label.node.active=!0,this.my_score_icon.node.active=!1,this.my_winrate_label.node.active=!1,this.my_sociaty_score_icon.node.active=!0,this.my_achievement_icon.node.active=!1,this.my_achievement_score_label.node.active=!1,this.callSociatyRankList(),this.sociatyScrollList.scrollTo(-1,.2),this.pvpScrollList.scrollTo(-1,.2),this.coopScrollList.scrollTo(-1,.2),this.achievementScrollList.scrollTo(-1,.2),this.coopScrollList.node.active=!1,this.pvpScrollList.node.active=!1,this.sociatyScrollList.node.active=!0,this.achievementScrollList.node.active=!1,this.curSelectRankIndex=s.RANKLIST_TYPE.RANKLIST_TYPE_SOCIATY)},t.prototype.onClickAchievementRankTabCallBack=function(){this.curSelectRankIndex!=s.RANKLIST_TYPE.RANKLIST_TYPE_ACHIEVEMENT&&(this.my_round_time_label.node.active=!1,this.my_round_label.node.active=!1,this.my_score_label.node.active=!1,this.my_score_icon.node.active=!1,this.my_winrate_label.node.active=!1,this.my_sociaty_score_icon.node.active=!1,this.pvpScrollRank.node.active=!1,this.my_achievement_icon.node.active=!0,this.my_achievement_score_label.node.active=!0,this.callAchievementRankList(),this.sociatyScrollList.scrollTo(-1,.2),this.pvpScrollList.scrollTo(-1,.2),this.coopScrollList.scrollTo(-1,.2),this.achievementScrollList.scrollTo(-1,.2),this.sociatyScrollList.node.active=!1,this.pvpScrollList.node.active=!1,this.coopScrollList.node.active=!1,this.achievementScrollList.node.active=!0,this.curSelectRankIndex=s.RANKLIST_TYPE.RANKLIST_TYPE_ACHIEVEMENT)},t.prototype.callCoopRankList=function(){var e=this,t=r.G.StringManager.getString("RANKLIST_URL");(p.GamePlatform.isWechat()||p.GamePlatform.isQQMiniGame()||p.GamePlatform.isByteDanceMiniGame()||p.GamePlatform.isKuaishouMiniGame())&&(t=f.getSubmitReviewState()?r.G.StringManager.getString("RANKLIST_URL"):r.G.StringManager.getString("RANKLIST_URL_MOBILE")),(p.GamePlatform.getMiYa()||p.GamePlatform.isQQGameRoom())&&(t=r.G.StringManager.getString("RANKLIST_URL_MOBILE"));var o=c.default.uuidTransformRoieId();"bigBlue"==p.GamePlatform.getMiYaVideoTypeNoSet()&&(t=r.G.StringManager.getString("RANKLIST_URL_MOBILE_BIGBLUE")),"ly5add7"==p.GamePlatform.getMiYaVideoTypeNoSet()&&(t=r.G.StringManager.getString("RANKLIST_URL_MOBILE_ADDCHANNEL")),t+="?",t+="ranktype="+s.RANKLIST_TYPE.RANKLIST_TYPE_COOPERATION,t+="&roleid="+o,t+="&page=1";var i=new XMLHttpRequest;i.onreadystatechange=function(){if(4==i.readyState&&i.status>=200&&i.status<400){var t=i.responseText.toString();t=(t=(t=t.replace('"','"')).replace("\ufeff","")).replace(" ","");var o=JSON.parse(t),a=o.ranktype,n=o.page;Number(s.RANKLIST_TYPE.RANKLIST_TYPE_COOPERATION)==Number(a)&&1==Number(n)&&e.resolvingCoopRankData(o)}},i.open("GET",t,!0),i.send()},t.prototype.resolvingCoopRankData=function(e){var t=0,o=0,i=0,a=0;if(this.tCoopRankListData=[],this.my_rank_label.string=r.G.StringManager.getString("MY_RANK"),"playerrank"in e){if(this.my_rank_num.string=e.playerrank,"playerdata"in e){var n=JSON.parse(e.playerdata);e.ranktype==s.RANKLIST_TYPE.RANKLIST_TYPE_COOPERATION?(t=n.round,o=n.totaltime):(i=n.score,Object.prototype.hasOwnProperty.call(n,"winrate")&&(a=n.winrate)),this.my_winrate_label.node.active=!0}}else this.my_rank_num.string=r.G.StringManager.getString("NO_RANK"),this.my_winrate_label.node.active=!1,i=c.default.getRoleAttrValByKey(g.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE);if(e.ranktype==s.RANKLIST_TYPE.RANKLIST_TYPE_COOPERATION)0==t&&(t=(l=c.default.getRoleInfoData()).fightData.typeData.get(2).maxRound),this.my_round_label.string=r.G.StringManager.getString("MY_ROUND",t),this.my_winrate_label.node.active=!1,this.my_round_time_label.string=function(e){var t=e%6e4/1e3;return parseInt((e%36e5/6e4).toString())+" \u5206 "+t+" \u79d2 "}.call(this,1e3*o),this.my_round_time_label.node.active=!(o<=0);else{if(0==a){var l,d=(l=c.default.getRoleInfoData()).fightData.typeData.get(1).totalWinNum,u=l.fightData.typeData.get(1).totalLostNum+d;u>0&&(a=Math.floor(d/u*100))}this.my_score_label.string=r.G.StringManager.getString("MY_SCORE",i),this.my_score_label.fontSize=32,this.my_winrate_label.string=r.G.StringManager.getString("MY_WIN_RATE"),this.my_winrate_num.string=a.toString()+"%",this.my_winrate_label.node.active=!0}if("ranklist"in e){var h=e.ranklist;for(var p in h)Object.prototype.hasOwnProperty.call(h,p)&&this.tCoopRankListData.push(h[p])}this.coopScrollList.numItems=this.tCoopRankListData.length},t.prototype.onRefreshCoopRankItemEvent=function(e,t){var o=this.tCoopRankListData[t];e.getComponent("RankListItem").initData(s.RANKLIST_TYPE.RANKLIST_TYPE_COOPERATION,t+1,o)},t.prototype.onClickPvpTabCallBack=function(e){var t=this;if(!e)return this.pvpTabLayoutNode.node.children[0].children[1].active=!0,void this.callPvpRankList(1);1!=e.target.children[1].active&&this.pvpTabLayoutNode.node.children.forEach(function(o,i){o.children[1].active=!1,o==e.target&&(o.children[1].active=!0,t.callPvpRankList(i+1))})},t.prototype.callPvpRankList=function(e){var t=this,o=r.G.StringManager.getString("RANKLIST_URL");(p.GamePlatform.isWechat()||p.GamePlatform.isQQMiniGame()||p.GamePlatform.isByteDanceMiniGame()||p.GamePlatform.isKuaishouMiniGame())&&(o=f.getSubmitReviewState()?r.G.StringManager.getString("RANKLIST_URL"):r.G.StringManager.getString("RANKLIST_URL_MOBILE")),(p.GamePlatform.getMiYa()||p.GamePlatform.isQQGameRoom())&&(o=r.G.StringManager.getString("RANKLIST_URL_MOBILE"));var i=c.default.uuidTransformRoieId();"bigBlue"==p.GamePlatform.getMiYaVideoTypeNoSet()&&(o=r.G.StringManager.getString("RANKLIST_URL_MOBILE_BIGBLUE")),"ly5add7"==p.GamePlatform.getMiYaVideoTypeNoSet()&&(o=r.G.StringManager.getString("RANKLIST_URL_MOBILE_ADDCHANNEL")),o+="?",o+="ranktype="+s.RANKLIST_TYPE.RANKLIST_TYPE_BATTLE,o+="&roleid="+i,o+="&page="+e;var a=new XMLHttpRequest;a.onreadystatechange=function(){if(4==a.readyState&&a.status>=200&&a.status<400){var o=a.responseText.toString();o=(o=(o=o.replace('"','"')).replace("\ufeff","")).replace(" ","");var i=JSON.parse(o),n=i.ranktype,r=i.page;Number(s.RANKLIST_TYPE.RANKLIST_TYPE_BATTLE)==Number(n)&&Number(r)==e?(t.resolvingPvpRankData(i),t.pvpScrollList.scrollTo(-1,.1)):t.pvpScrollList.numItems=0}},a.open("GET",o,!0),a.send()},t.prototype.resolvingPvpRankData=function(e){this.pvpTabLayoutNode.node.active=!1,this.tPvpRankListData=[],this.tPvpRankIdxArr=[];var t=0,o=0;if(this.my_rank_label.string=r.G.StringManager.getString("MY_RANK"),"playerrank"in e){if(this.my_rank_num.string=e.playerrank,"playerdata"in e){var i=JSON.parse(e.playerdata);t=i.score,Object.prototype.hasOwnProperty.call(i,"winrate")&&(o=i.winrate),this.my_winrate_label.node.active=!0}}else this.my_rank_num.string=r.G.StringManager.getString("NO_RANK"),this.my_winrate_label.node.active=!1,t=c.default.getRoleAttrValByKey(g.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE);if(0==o){var a=c.default.getRoleInfoData(),n=a.fightData.typeData.get(1).totalWinNum,s=a.fightData.typeData.get(1).totalLostNum+n;s>0&&(o=Math.floor(n/s*100))}if(this.my_score_label.string=r.G.StringManager.getString("MY_SCORE",t),this.my_score_label.fontSize=32,this.my_winrate_label.string=r.G.StringManager.getString("MY_WIN_RATE"),this.my_winrate_num.string=o.toString()+"%",this.my_winrate_label.node.active=!0,"ranklist"in e){var l=e.ranklist;for(var d in l)Object.prototype.hasOwnProperty.call(l,d)&&(this.tPvpRankIdxArr.push(Number(d)),this.tPvpRankListData.push(l[d]))}this.pvpScrollList.numItems=this.tPvpRankListData.length,this.tPvpRankListData.length<5&&(this.pvpTabLayoutNode.node.active=!0)},t.prototype.onRefreshPvpRankItemEvent=function(e,t){var o=this.tPvpRankListData[t];e.getComponent("RankListItem").initData(s.FIGHT_TYPE.FIGHT_TYPE_BATTLE,this.tPvpRankIdxArr[t],o)},t.prototype.callSociatyRankList=function(){var e=this,t=r.G.StringManager.getString("RANKLIST_URL");(p.GamePlatform.isWechat()||p.GamePlatform.isQQMiniGame()||p.GamePlatform.isByteDanceMiniGame()||p.GamePlatform.isKuaishouMiniGame())&&(t=f.getSubmitReviewState()?r.G.StringManager.getString("RANKLIST_URL"):r.G.StringManager.getString("RANKLIST_URL_MOBILE")),(p.GamePlatform.getMiYa()||p.GamePlatform.isQQGameRoom())&&(t=r.G.StringManager.getString("RANKLIST_URL_MOBILE"));var o=c.default.uuidTransformRoieId();"bigBlue"==p.GamePlatform.getMiYaVideoTypeNoSet()&&(t=r.G.StringManager.getString("RANKLIST_URL_MOBILE_BIGBLUE")),"ly5add7"==p.GamePlatform.getMiYaVideoTypeNoSet()&&(t=r.G.StringManager.getString("RANKLIST_URL_MOBILE_ADDCHANNEL")),t+="?",t+="ranktype="+s.RANKLIST_TYPE.RANKLIST_TYPE_SOCIATY,t+="&roleid="+o,t+="&page=1";var i=new XMLHttpRequest;i.onreadystatechange=function(){if(4==i.readyState&&i.status>=200&&i.status<400){var t=i.responseText.toString();t=(t=(t=t.replace('"','"')).replace("\ufeff","")).replace(" ","");var o=JSON.parse(t),a=o.ranktype,n=o.page;Number(s.RANKLIST_TYPE.RANKLIST_TYPE_SOCIATY)==Number(a)&&1==Number(n)?e.resolvingSociatyRankData(o):e.sociatyScrollList.numItems=0}},i.open("GET",t,!0),i.send()},t.prototype.resolvingSociatyRankData=function(e){this.tSociatyRankListData=[];var t,o="",i="",a=0,n=_.default.instance().SociatyPlayerData;if(t=n.sociatyID.length<=0||0==Number(n.sociatyID)?0:Number(n.sociatyID),"ranklist"in e){var s=e.ranklist;for(var c in s)if(Object.prototype.hasOwnProperty.call(s,c)){this.tSociatyRankListData.push(s[c]);var l=JSON.parse(s[c]);t==Number(l.sociatyId)&&(o=c,i=l.sociatyLevel,a=l.sociatyTotalScore)}}this.sociatyScrollList.numItems=this.tSociatyRankListData.length,this.my_rank_label.string=r.G.StringManager.getString("MY_RANK"),this.my_winrate_label.string=r.G.StringManager.getString("MY_SOCIATY"),this.my_score_label.string=a.toString(),this.my_score_label.fontSize=28,this.my_winrate_num.string=r.G.StringManager.getWorldString("common_level",i),o.length>0?(this.my_rank_num.string=o,this.my_winrate_label.node.active=!0):(this.my_rank_num.string=r.G.StringManager.getString("NO_RANK"),this.my_winrate_label.node.active=!0,t>0?(this.my_winrate_num.string=r.G.StringManager.getWorldString("common_level",n.sociatyLevel),this.my_score_label.string=_.default.instance().getMemberTotalScore().toString()):this.my_winrate_num.string="\u6682\u65e0\u8054\u76df")},t.prototype.onRefreshSociatyRankItemEvent=function(e,t){var o=this.tSociatyRankListData[t];e.getComponent("RankListItem").initData(s.RANKLIST_TYPE.RANKLIST_TYPE_SOCIATY,t+1,o)},t.prototype.callAchievementRankList=function(){var e=this,t=m.default.getDevelopRankListUrl();t+="?",t+="ranktype="+s.RANKLIST_TYPE.RANKLIST_TYPE_ACHIEVEMENT,t+="&roleid="+c.default.uuidTransformRoieId(),t+="&page="+this.achievementRankPageIdx;var o=new XMLHttpRequest;o.onreadystatechange=function(){if(4==o.readyState&&o.status>=200&&o.status<400){var t=o.responseText.toString();t=(t=(t=t.replace('"','"')).replace("\ufeff","")).replace(" ","");var i=JSON.parse(t),a=i.page;e.achievementRankMaxPage=i.maxpage,Number(i.ranktype)==s.RANKLIST_TYPE.RANKLIST_TYPE_ACHIEVEMENT&&Number(a)==e.achievementRankPageIdx&&e.resolvingAchievementRankData(i)}},o.open("GET",t,!0),o.send()},t.prototype.resolvingAchievementRankData=function(e){if(1==Number(e.page)&&(this.tAchievementRankListData=[]),this.my_rank_num.string=r.G.StringManager.getString("NO_RANK"),this.my_achievement_score_label.string=c.default.getItemCountByBag(1005),"playerrank"in e&&(this.my_rank_num.string=e.playerrank,"playerdata"in e)){var t=JSON.parse(e.playerdata);this.my_achievement_score_label.string=t.score}if("ranklist"in e){var o=e.ranklist;for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&this.tAchievementRankListData.push(o[i])}this.achievementScrollList.numItems=this.tAchievementRankListData.length},t.prototype.onRefreshAchievementRankEvent=function(e,t){var o=this.tAchievementRankListData[t];e.getComponent("RankListItem").initData(s.RANKLIST_TYPE.RANKLIST_TYPE_ACHIEVEMENT,t+1,o)},t.prototype.onDestroy=function(){this.pvpScrollList.node&&(this.pvpScrollList.node.off("scroll-to-bottom",this.onScrollBottom,this),this.pvpScrollList.node.off("bounce-bottom",this.onScrollBottom,this),this.pvpScrollList.node.off("scroll-began",this.onScrollScrolling,this))},n([S(cc.Label)],t.prototype,"my_rank_label",void 0),n([S(cc.Label)],t.prototype,"my_rank_num",void 0),n([S(cc.Label)],t.prototype,"my_round_label",void 0),n([S(cc.Label)],t.prototype,"my_round_time_label",void 0),n([S(cc.Label)],t.prototype,"my_score_label",void 0),n([S(cc.Label)],t.prototype,"my_winrate_label",void 0),n([S(cc.Label)],t.prototype,"my_winrate_num",void 0),n([S(y.default)],t.prototype,"coopScrollList",void 0),n([S(cc.ScrollView)],t.prototype,"pvpScrollRank",void 0),n([S(cc.Sprite)],t.prototype,"my_score_icon",void 0),n([S(cc.Sprite)],t.prototype,"my_sociaty_score_icon",void 0),n([S(cc.Layout)],t.prototype,"pvpTabLayoutNode",void 0),n([S(y.default)],t.prototype,"pvpScrollList",void 0),n([S(y.default)],t.prototype,"sociatyScrollList",void 0),n([S(y.default)],t.prototype,"achievementScrollList",void 0),n([S(cc.Sprite)],t.prototype,"my_achievement_icon",void 0),n([S(cc.Label)],t.prototype,"my_achievement_score_label",void 0),n([h.Register_Class,C],t)}(l.default);o.default=T,cc._RF.pop()},{"../../../load":"load","../../Global/GameGlobal":"GameGlobal","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/manager/LoadResManager":"LoadResManager","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/GamePlatform":"GamePlatform","../../utils/GameTools":"GameTools","../../utils/List":"List","../../utils/LogUtil":"LogUtil","../sociaty/SociatyModel":"SociatyModel"}],RebootClientView:[function(e,t,o){"use strict";cc._RF.push(t,"92929ADhGpLS4YYepOBPpNA","RebootClientView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=cc._decorator,l=c.ccclass,d=(c.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.path=function(){return"ui/reboot_client/RebootClient"},n([s.Register_Class,l],t)}(r.default));o.default=d,cc._RF.pop()},{"../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators"}],ReceiveRewardView:[function(e,t,o){"use strict";cc._RF.push(t,"beaadb4QYhMlbuYcvRLzhtj","ReceiveRewardView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../modules/base/BaseView"),s=e("../utils/GameTools"),c=e("../modules/base/Decorators"),l=e("../utils/GamePlatform"),d=e("../utils/ByteDanceMiniGameUtils"),u=cc._decorator,h=u.ccclass,p=u.property,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.RewardNode=null,t}return a(t,e),t.path=function(){return"ui/CommonPrefab/DoubleReward"},t.prototype.onLoad=function(){},t.prototype.start=function(){this.changeAdButtonSkins()},t.prototype.init=function(e){var t=this;e.tRewards&&e.tRewards.forEach(function(e){s.default.createNormalItems(e.itemId,e.itemNum,t.RewardNode)}),this._data=e,(l.GamePlatform.isQQGameRoom()||l.GamePlatform.IsH5SmallBag()||l.GamePlatform.IsMiYaIosH5()||l.GamePlatform.IsDysbSmallBag()||l.GamePlatform.Is5Add7SmallBag())&&(this.node.getChildByName("taskinfo").getChildByName("double").active=!1,this.node.getChildByName("taskinfo").getChildByName("regular").setPosition(0,-140))},t.prototype.onGetRewardCallBack=function(){this._data.cb1&&this._data.cb1()},t.prototype.onDoubleRewardCallBack=function(){this._data.cb2&&this._data.cb2()},t.prototype.changeAdButtonSkins=function(){l.GamePlatform.isByteDanceMiniGame()&&d.default.getInstance().changeSkinOfAdButton(this.node.getChildByName("taskinfo").getChildByName("double"),"advertise205-75")},n([p(cc.Node)],t.prototype,"RewardNode",void 0),n([c.Register_Class,h],t)}(r.default);o.default=f,cc._RF.pop()},{"../modules/base/BaseView":"BaseView","../modules/base/Decorators":"Decorators","../utils/ByteDanceMiniGameUtils":"ByteDanceMiniGameUtils","../utils/GamePlatform":"GamePlatform","../utils/GameTools":"GameTools"}],RechargeProtocols:[function(e,t,o){"use strict";cc._RF.push(t,"c29caBZA8VOt4DKuLX3O6+m","RechargeProtocols"),e("DataViewRW"),e("ObjCollection"),e("long");var i=e("./BaseProtocols").T_Reward;(function(e){e[e.P_Recharge_Begin=8e6]="P_Recharge_Begin",e[e.P_Recharge_Role_Recharge=8000001]="P_Recharge_Role_Recharge",e[e.P_Recharge_Role_WeiXinGameMidasPay=8000002]="P_Recharge_Role_WeiXinGameMidasPay"})(o.RECHARGE_CLIENT_ENUM||(o.RECHARGE_CLIENT_ENUM={})),function(e){e[e.ErrorCode_Recharge_Client_Success=0]="ErrorCode_Recharge_Client_Success",e[e.ErrorCode_Recharge_Client_Failed=1]="ErrorCode_Recharge_Client_Failed",e[e.ErrorCode_Recharge_Client_Continue=2]="ErrorCode_Recharge_Client_Continue",e[e.ErrorCode_Recharge_Client_NoRole=3]="ErrorCode_Recharge_Client_NoRole",e[e.ErrorCode_Recharge_Client_CanNotRechrge=4]="ErrorCode_Recharge_Client_CanNotRechrge",e[e.ErrorCode_Recharge_Client_PlatformError=5]="ErrorCode_Recharge_Client_PlatformError",e[e.ErrorCode_Recharge_Client_SDKTypeError=6]="ErrorCode_Recharge_Client_SDKTypeError",e[e.ErrorCode_Recharge_Client_NoRechargeFun=7]="ErrorCode_Recharge_Client_NoRechargeFun",e[e.ErrorCode_Recharge_Client_CreateOrderError=8]="ErrorCode_Recharge_Client_CreateOrderError",e[e.ErrorCode_Recharge_Client_RandRechargeFailed=9]="ErrorCode_Recharge_Client_RandRechargeFailed",e[e.ErrorCode_Recharge_Client_RechargeNoReady=10]="ErrorCode_Recharge_Client_RechargeNoReady",e[e.ErrorCode_Recharge_Client_AgainOrder=11]="ErrorCode_Recharge_Client_AgainOrder",e[e.ErrorCode_Recharge_Client_ScoreRechargeFailed=12]="ErrorCode_Recharge_Client_ScoreRechargeFailed",e[e.ErrorCode_Recharge_Client_VoucherNotEnough=13]="ErrorCode_Recharge_Client_VoucherNotEnough"}(o.ErrorCode_Recharge_Client||(o.ErrorCode_Recharge_Client={}));var a=function(){function e(){this.rechargeID=0,this.rechargeNum=0,this.isUseVoucher=0,this.wxPayType=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<16||(this.rechargeID=e.getInt32(),this.rechargeNum=e.getInt32(),this.isUseVoucher=e.getInt32(),this.wxPayType=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.rechargeID),e.setInt32(this.rechargeNum),e.setInt32(this.isUseVoucher),e.setInt32(this.wxPayType)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Recharge_Role_Recharge=a;var n=function(){function e(){this.errorcode=0,this.rechargeID=0,this.rechargeNum=0,this.rechargeValue="",this.prize=[],this.wxPayType=0}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<16)return!1;this.errorcode=e.getInt32(),this.rechargeID=e.getInt32(),this.rechargeNum=e.getInt32();var t=e.getUint32();if(e.getLen()-e.getPos()<t)return!1;if(this.rechargeValue=e.getString(t),e.getLen()-e.getPos()<4)return!1;var o=e.getUint32();this.prize=[];for(var a=0;a<o;++a){var n=new i;if(!n.read(e))return!1;this.prize.push(n)}return!(e.getLen()-e.getPos()<4||(this.wxPayType=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setInt32(this.rechargeID),e.setInt32(this.rechargeNum),e.setString(this.rechargeValue),e.setUint32(this.prize.length),this.prize.forEach(function(t){t.writeNoEnd(e)}),e.setInt32(this.wxPayType)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Recharge_Role_Recharge=n;var r=function(){function e(){this.orderuuid=""}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();return!(e.getLen()-e.getPos()<t||(this.orderuuid=e.getString(t),0))},e.prototype.writeNoEnd=function(e){e.setString(this.orderuuid)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Recharge_Role_WeiXinGameMidasPay=r,cc._RF.pop()},{"./BaseProtocols":"BaseProtocols",DataViewRW:"DataViewRW",ObjCollection:"ObjCollection",long:"long"}],RechargeTableData:[function(e,t,o){"use strict";cc._RF.push(t,"119a5lw6PZCq6badzNglWaR","RechargeTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.RechargeTableData=void 0;var i=e("../TableReader"),a=e("./BaseTableData"),n=function(){function e(){this.id=0,this.info="",this.money=0,this.moneyQQ=0,this.firstPrize=new Array,this.prize=new Array,this.limitMaxNum=0,this.limitMaxDayNum=0,this.limitVipLevel=0,this.extraType=0,this.extraParam1=0,this.extraParam2=0,this.infoname="",this.name="",this.icon="",this.basePicture="",this.special_label="",this.icon_title="",this.icon_type_bg="",this.icon_box_name="",this.original_cost=0,this.isPopGeneral=0,this.first_show=0}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.info=e.getString(),this.money=e.getNumber(),this.moneyQQ=e.getNumber();for(var o=e.getString(),n=new i.TableReader(o);n.getPos()<n.getLen();)(s=new a.DropItem).readOriginal(n),this.firstPrize.push(s);o=e.getString();for(var r=new i.TableReader(o);r.getPos()<r.getLen();){var s;(s=new a.DropItem).readOriginal(r),this.prize.push(s)}this.limitMaxNum=e.getNumber(),this.limitMaxDayNum=e.getNumber(),this.limitVipLevel=e.getNumber(),this.extraType=e.getNumber(),this.extraParam1=e.getNumber(),this.extraParam2=e.getNumber(),this.infoname=e.getString(),this.name=e.getString(),this.icon=e.getString(),this.basePicture=e.getString(),this.special_label=e.getString(),this.icon_title=e.getString(),this.icon_type_bg=e.getString(),this.icon_box_name=e.getString(),this.original_cost=e.getNumber(),this.isPopGeneral=e.getNumber(),this.first_show=e.getNumber()},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"RechargeTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.RechargeTableData=n,cc._RF.pop()},{"../TableReader":"TableReader","./BaseTableData":"BaseTableData"}],ReconnectLayer:[function(e,t,o){"use strict";cc._RF.push(t,"29327KrC8NDtLDKY36RCtin","ReconnectLayer");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../combat/CombatManager"),s=e("../common/CombatModule"),c=e("../common/PlayerModule"),l=e("../Global/GameGlobal"),d=e("../modules/base/GameView"),u=e("../network/ClientNetwork"),h=e("../network/protocol/LoginProtocols"),p=e("../utils/ConstValue"),f=e("../utils/GamePlatform"),g=e("../utils/GameUtils"),m=e("../utils/subUtils/GuideLayer"),_=e("../utils/subUtils/PopLayer"),y=e("../utils/subUtils/TypeDef"),v=e("../utils/UIManager"),C=e("../utils/WechatUtils"),S=e("./FightNetwork"),T=e("./LocalMessage"),I=e("./protocol/LoginProtocols"),N=e("./protocol/LoginProtocols"),b=e("./protocol/LoginProtocols"),w=e("./protocol/LoginProtocols"),E=e("../controller/Guide/GuideController"),P=e("../../load"),R=e("../combat/FightResultView"),L=e("./FightReconnectLayer"),A=e("../utils/GameLoading"),D=e("../model/ServerAddrInfo"),M=e("../utils/QQMiniGameUtils"),B=e("../utils/ByteDanceMiniGameUtils"),k=e("../utils/RewardedVideoAd"),G=e("../utils/QQGameHallUtils"),O=e("../utils/KSMinigameUtils"),H=cc._decorator,V=H.ccclass,F=H.property,U=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.m_lblTips=null,t.m_lblTrying=null,t.m_lblOK=null,t.m_lblLogout=null,t.m_lblTime=null,t.m_miOK=null,t.m_miLogout=null,t.rootNode=null,t.m_lblTimeout=null,t.m_roleId=0,t.m_roleName="",t.time=0,t.autoConnectWhenDisconnect=!0,t.m_fTimeout=0,t.m_bStopReconnect=!1,t.status=0,t.showRestart=!1,t}var o;return a(t,e),o=t,t.setShowLayer=function(e){this.bShowLayer=e},t.setReconnectReason=function(e){console.log("HHHHHHHHHHHHHHHHHHH  setReconnectReason close"+e),this.reconnectReason=e},t.getReconnectReason=function(){return this.reconnectReason},t.prototype.onLoad=function(){console.log("HHHHHHHHHHHHHHHHHHH  ReconnectLayer.onLoad"),this.m_fTimeout=10;var e=this;cc.director.on("javaBridgeLoginSuccess",this.reLogin,this),u.ClientNetwork.getInstance().listenProtocol(h.LOGIN_CLIENT_ENUM.P_Login_RequestRole,function(e){console.log("HHHHHHHHHHHHHHHHHHH  ReconnectLayer.NCS_LOGIN_REQUEST_ROLE 1");var t=new h.S_Login_RequestRole;if(!t.read(e))return!1;if(console.log("HHHHHHHHHHHHHHHHHHH  ReconnectLayer.NCS_LOGIN_REQUEST_ROLE 2"),t.roles.size<=0)l.G.UIManager.getRunningScene(),o.CloseReconnectLayer();else{var i=new I.C_Login_ChooseRole,a=Array.from(t.roles.values());i.roleId=a[0].roleID,u.ClientNetwork.getInstance().Send(h.LOGIN_CLIENT_ENUM.P_Login_ChooseRole,i)}},this),u.ClientNetwork.getInstance().listenLocalMessage(T.LOCAL_MESSAGE.LocalMsg_SmallBagLogin,function(e){this.reLogin(e[0],e[1],e[2])}.bind(this),this),u.ClientNetwork.getInstance().listenProtocol(h.LOGIN_CLIENT_ENUM.P_Login_ChooseRole,function(e){if(console.log("HHHHHHHHHHHHHHHHHHH  ReconnectLayer.NCS_LOGIN_CHOOSE_ROLE 1"),!(new w.S_Login_ChooseRole).read(e))return cc.error("STRUCT_NCS_LOGIN_CHOOSE_ROLE_RESULT read Error"),void u.ClientNetwork.getInstance().Disconnect();m.NodeNameLayer.m_BEnableGuide=!0,o.CloseReconnectLayer();var t=g.getLocalData("userPayRechargeInfo","");console.log("pay repay reconnect"+g.getLocalData("userPayRechargeInfo","")),t&&""!=t&&f.GamePlatform.isWechat()&&C.WechatUtils.getInstance().noticeServerPay(t),k.default.reconnectFunc(),f.GamePlatform.isQQGameRoom()&&G.QQGameHallUtils.getInstance().refreshBlueVipData()},this),u.ClientNetwork.getInstance().listenLocalMessage(T.LOCAL_MESSAGE.LocalMsg_ConnectFailed,function(){console.log("HHHHHHHHHHHHHHHHHHH  ReconnectLayer.LocalMsg_ConnectFailed"),e.m_bStopReconnect||e.ReconnectServer()}.bind(this),this),u.ClientNetwork.getInstance().listenExtraMsg(u.EXTRA_MSG.EXTRA_MSG_CONNCET_SUCCEED,function(){if(console.log("HHHHHHHHHHHHHHHHHHH  ReconnectLayer.EXTRA_MSG_CONNCET_SUCCEED"),l.G.UIManager.hideWaitingLayer(l.G.UIManager.getCurSceneName()),f.GamePlatform.isWechat()){(E=new N.C_Login_ValidateOnline).sdkType=2,E.sdkID=1,E.clientType=2,E.accountName=C.WechatUtils.getInstance().getWechatLoginData().accountname,E.sign=C.WechatUtils.getInstance().getWechatLoginData().sign,E.extra=[];var e=wx.getLaunchOptionsSync().query,t=e.clue_token,o=e.trackid,i=e.uctrackid,a=e.channel,n=e.ksUnitId,c=e.wxgamecid,m=e.c;if(t?E.entranceID=60102:o?E.entranceID=60106:i?E.entranceID=60108:n?E.entranceID=60116:m?E.entranceID=60244:c?"CCBgAAoXkpQY9zqJTvv4tB"==c?E.entranceID=60183:"CCBgAAoXkpQY9zqJTvv4tK"==c?(E.entranceID=60239,E.extra.push(c)):"CCBgAAoXkpQY9zqJTvv4tL"==c?(E.entranceID=60240,E.extra.push(c)):"CCBgAAoXkpQY9zqJTvv4tI"==c?(E.entranceID=60241,E.extra.push(c)):"CCBgAAoXkpQY9zqJTvv4tH"==c?(E.entranceID=60242,E.extra.push(c)):"CCBgAAoXkpQY9zqJTvv4tM"==c&&(E.entranceID=60243,E.extra.push(c)):C.WechatUtils.Instance.isFrom360dianjing()?E.entranceID=60245:E.entranceID=5e4,"xingtu"==a)E.entranceID=60110;else if("chuanshanjia"==a)E.entranceID=60109;else for(var _=1;_<101;_++)if(a=="xingtu"+_){E.entranceID=_<=50?60132+_:60135+_;break}try{(T=wx.getStorageSync("wxImage"))&&(E.headUrl=T);var v=wx.getStorageSync("wxaid");v&&(E.packageID=v)}catch(k){console.log("loginScene headUrl fail")}l.G.StringManager.PopStringOnceEnd(),u.ClientNetwork.getInstance().Send(h.LOGIN_CLIENT_ENUM.P_Login_ValidateOnline,E)}else if(f.GamePlatform.isQQMiniGame()){(E=new N.C_Login_ValidateOnline).sdkType=9,E.sdkID=0,E.clientType=2,E.accountName=M.QQMiniGameUtils.getInstance().getWechatLoginData().accountname,E.sign=M.QQMiniGameUtils.getInstance().getWechatLoginData().sign,E.packageID=M.QQMiniGameUtils.getInstance().getChannelID(),console.log("req.packageID ==========  ",E.packageID),E.entranceID=60107,qq.getStorageSync("isDancejumpQQ")&&(E.entranceID=60119);try{(T=qq.getStorageSync("wxImage"))&&(E.headUrl=T);var S="accountName";(I=qq.getStorageSync("wxNickName"))&&g.setLocalData(S,I)}catch(k){console.log("loginScene headUrl fail")}l.G.StringManager.PopStringOnceEnd(),u.ClientNetwork.getInstance().Send(h.LOGIN_CLIENT_ENUM.P_Login_ValidateOnline,E)}else if(f.GamePlatform.isByteDanceMiniGame()){(E=new N.C_Login_ValidateOnline).sdkType=B.default.SDK_TYPE,E.sdkID=0,E.clientType=2,E.accountName=B.default.getInstance().getWechatLoginData().accountname,E.sign=B.default.getInstance().getWechatLoginData().sign,E.packageID=B.default.getInstance().getChannelID(),console.log("req.packageID ==========  ",E.packageID),E.entranceID=B.default.JING_FEN_ID;try{(T=tt.getStorageSync("wxImage"))&&(E.headUrl=T),S="accountName",(I=tt.getStorageSync("wxNickName"))&&g.setLocalData(S,I)}catch(k){console.log("loginScene headUrl fail")}l.G.StringManager.PopStringOnceEnd(),u.ClientNetwork.getInstance().Send(h.LOGIN_CLIENT_ENUM.P_Login_ValidateOnline,E)}else if(f.GamePlatform.isQQGameRoom())(E=new N.C_Login_ValidateOnline).sdkType=G.QQGameHallUtils.SDK_TYPE,E.sdkID=0,E.clientType=2,E.accountName=G.QQGameHallUtils.getInstance().getWechatLoginData().accountname,E.sign=G.QQGameHallUtils.getInstance().getWechatLoginData().sign,E.packageID=G.QQGameHallUtils.getInstance().getChannelID(),console.log("req.packageID ==========  ",E.packageID),E.entranceID=G.QQGameHallUtils.JING_FEN_ID,l.G.StringManager.PopStringOnceEnd(),u.ClientNetwork.getInstance().Send(h.LOGIN_CLIENT_ENUM.P_Login_ValidateOnline,E);else if(f.GamePlatform.isKuaishouMiniGame()){(E=new N.C_Login_ValidateOnline).sdkType=O.KSMinigameUtils.SDK_TYPE,E.sdkID=0,E.clientType=2,E.accountName=O.KSMinigameUtils.getInstance().getWechatLoginData().accountname,E.sign=O.KSMinigameUtils.getInstance().getWechatLoginData().sign,E.packageID=O.KSMinigameUtils.getInstance().getChannelID(),console.log("req.packageID ==========  ",E.packageID),E.entranceID=O.KSMinigameUtils.JING_FEN_ID;try{var T,I;(T=ks.getStorageSync("wxImage"))&&(E.headUrl=T),S="accountName",(I=ks.getStorageSync("wxNickName"))&&g.setLocalData(S,I)}catch(k){console.log("loginScene headUrl fail")}l.G.StringManager.PopStringOnceEnd(),u.ClientNetwork.getInstance().Send(h.LOGIN_CLIENT_ENUM.P_Login_ValidateOnline,E)}else if(f.GamePlatform.IsMiYa()||f.GamePlatform.IsSmallBag()||f.GamePlatform.IsH5SmallBag()||f.GamePlatform.IsMiYaIosH5()){var w=f.GamePlatform.getMiYaLoginData();if(w){var E=new N.C_Login_ValidateOnline,P=f.GamePlatform.getMiYaVideoType(),R=P.toString().slice(0,5),L=f.GamePlatform.getMiYaAnchorType();if(E.sdkType=w.sdktype,E.sdkID=w.sdkid,"ylh"==P?E.entranceID=60103:"csj"==P?E.entranceID=60101:"gdt"==P?E.entranceID=60105:"mzf"==P?E.entranceID=340:"lektn"==R?E.entranceID=60111:"yltt"==P?E.entranceID=60112:"ks"==P?E.entranceID=60114:"ylks"==P?E.entranceID=60115:"bigBlue"==P?E.entranceID=342:"leniu"==P?E.entranceID=343:"zc"==P?E.entranceID=60118:"mayiH5yl"==P?E.entranceID=60122:"mayiH5my"==P?E.entranceID=60123:"lyH5sq"==P?E.entranceID=347:"issueByDance"==P?E.entranceID=60132:"mayiH5gdt"==P?E.entranceID=60105:"lyH5dysb"==P?E.entranceID=348:"ly5add7"==P?f.GamePlatform.is_hykb?E.entranceID=60185:(console.log("ly5add7-----------------pid=",f.GamePlatform.pid),E.entranceID=f.GamePlatform.pid):"ttss"==P?E.entranceID=60184:"mayiH5xfc"==P?E.entranceID=60238:"tab"!=P&&"mayiH5tab"!=P||(E.entranceID=60104),""!=L)for(_=1;_<9;_++)if(L=="anchor"+_){E.entranceID=60123+_;break}E.clientType=2,E.accountName=w.accountname,E.sign=w.sign,E.headUrl="",u.ClientNetwork.getInstance().Send(h.LOGIN_CLIENT_ENUM.P_Login_ValidateOnline,E)}}else(E=new b.C_Login_Validate).account=y.GlobalVar.getAccountName(),E.passwd=y.GlobalVar.getPassword(),E.zoneid=y.GlobalVar.getZoneId(),E.platformId=y.GlobalVar.getPlatform(),u.ClientNetwork.getInstance().Send(h.LOGIN_CLIENT_ENUM.P_Login_Validate,E);if(l.G.UIManager.isFinghtingScene())r.default.getInstance().gameState==p.Game_State.End?(s.default.matchReconnectData=null,s.default.destroy(),r.default.getInstance().exitMap(),l.G.UIManager.gotoMainScene(null,function(){d.default.addLayerView("BaseCtrl","MainSceneView","MainSceneView")})):(s.default.getMatchBattleInfo(!1)&&1==s.default.getMatchBattleInfo(!1).bRobot&&(r.default.getInstance().gameState=p.Game_State.End),s.default.matchReconnectData=null,s.default.destroy(),r.default.getInstance().exitMap(),l.G.UIManager.gotoMainScene(null,function(){d.default.addLayerView("BaseCtrl","MainSceneView","MainSceneView")}));else{A.default.isShowing()&&A.default.hide();var D=d.default.getViewByName("MatchMainView");D&&D.view&&D.view.closeView()}}.bind(this),this),u.ClientNetwork.getInstance().listenLocalMessage(T.LOCAL_MESSAGE.LocalMsg_GetServerAddr,function(t){if(0!=t[0].error)return console.log("Wechat failed"),-2==t[0].error?l.G.StringManager.PopString(l.G.StringManager.getString("CONNECT_NO_NET")):l.G.StringManager.PopString(l.G.StringManager.getString("CONNECT_ERROR")),void e.setLabel(!1);l.G.UIManager.showWaitingLayer(l.G.UIManager.getRunningScene().name);var o="wss://"+t[0].webname+":"+t[0].webport;y.GlobalVar.setServerURL(o),u.ClientNetwork.getInstance().Connect(o)&&setTimeout(function(){u.ClientNetwork.getInstance().getWebSocket()&&u.ClientNetwork.getInstance().getWebSocket().readyState===WebSocket.OPEN||(l.G.StringManager.PopString(l.G.StringManager.getString("CONNECT_ERROR")),e.setLabel(!1))},6e3)}.bind(this),this),this.setLabel(!1),g.backgroundFitScreen(this.node.parent,this.node.parent.getChildByName("CCLayerColor"))},t.prototype.onDestroy=function(){console.log("HHHHHHHHHHHHHHHHHHH  ReconnectLayer.onDestroy"),o.m_pfnSucceedCallback=null,o.m_pCallbackTarget=null,o.bShowLayer=!0,o.reconnectLayerShowing=!1},t.prototype.setLabel=function(e){console.log("HHHHHHHHHHHHHHHHHHH  ReconnectLayer.setLabel"),cc.isValid(this)&&(this.m_miOK.node.active=!e,this.m_miLogout.node.active=!e,this.m_lblLogout.node.active=!e,this.m_lblOK.node.active=!e,this.m_lblTips.node.active=!e,this.m_lblTrying.node.active=e,this.m_lblTime.node.active=e,o.bEnterBattleTimeout?this.m_lblTimeout.node.active=!e:this.m_lblTimeout.node.active=!1,e?(this.time=5,this.setTime(),this.schedule(this.setTime,1)):(this.unschedule(this.setTime),this.m_lblTime.string=""))},t.setEnterBattleTimeout=function(e){this.bEnterBattleTimeout=e},t.prototype.onConnectFailed=function(){console.log("HHHHHHHHHHHHHHHHHHH  ReconnectLayer.onConnectFailed"),u.ClientNetwork.getInstance().pushLocalMessage(T.LOCAL_MESSAGE.LocalMsg_ConnectFailed,null)},t.prototype.isShow=function(){return console.log("HHHHHHHHHHHHHHHHHHH  ReconnectLayer.isShow"),!0},t.prototype.ReconnectServer=function(){console.log("HHHHHHHHHHHHHHHHHHH  ReconnectLayer.ReconnectServer 1"),this.setLabel(!0),this.reconnectRequestServerList()},t.prototype.setTime=function(){var e="("+this.time+"s)";this.m_lblTime.string=e,this.time>0&&(this.time=this.time-1)},t.prototype.onRequestCurVersion=function(){console.log("HHHHHHHHHHHHHHHHHHH  ReconnectLayer.onRequestCurVersion");var e=this;console.log("HHHHHHHHHHHHHHHHHHH  ReconnectLayer.onRequestCurVersion.cb1"),e.m_bStopReconnect=!1,e.ReconnectServer(),o.bEnterBattleTimeout&&(o.bEnterBattleTimeout=!1)},t.prototype.reLogin=function(e,t,o){g.setLocalData("wxdata",e),g.setLocalData("token",t),g.setLocalData("uid",o),D.ServerAddrInfo.getInstance().requestMiYaServer()},t.prototype.menuCallbackOK=function(){console.log("HHHHHHHHHHHHHHHHHHH  ReconnectLayer.menuCallbackOK"),this.showRestart||(this.status=0,this.onRequestCurVersion(),this.m_bStopReconnect=!1)},t.ShowReconnectLayer=function(e,t,i){var a=this;if(void 0===e&&(e=0),void 0===t&&(t=!1),void 0===i&&(i=!1),console.log("HHHHHHHHHHHHHHHHHHH  ReconnectLayer.ShowReconnectLayer"),console.log(e),console.log(t),console.log(i),L.default.CloseFightReconnectLayer(),S.FightNetwork.getInstance().Disconnect(),v.UIManager.isAppEnterHideShow&&(v.UIManager.isAppEnterHideShow=!1),l.G.UIManager.isFinghtingScene()){if(1==R.default._isShow&&1==o.getReconnectReason())return;r.default.getInstance().gameState=p.Game_State.Reconnect}o.reconnectLayerShowing=!0,c.default.setFightReconnectData(null),g.setTouchEnabled(!0);var n=l.G.UIManager.getRunningScene(),s=new v.PopLayerParam;s.isLeftAnimation=!1,s.m_popType=_.POPLYAERSTATE.POPLYAERSTATE_OPER,s.isZoomAnimation=!0;var d=n.getComponentInChildren(o);if(d){d.rootNode.active=this.bShowLayer;var u=l.G.UIManager.getMask(v.PopNodeTag.ReconnectLayer);return u&&(u.active=this.bShowLayer),void(e>0&&d.setTimeout(e))}l.G.UIManager.showPopLayer(v.PrefabUrl.ReconnectLayer,!0,!1,v.PopNodeTag.ReconnectLayer,v.PopNodeType.Normal,s).then(function(i){if(console.log("HHHHHHHHHHHHHHHHHHH  ReconnectLayer.ShowReconnectLayer.showPopLayer"),i&&cc.isValid(a)&&cc.isValid(n)){var r=n.getComponentInChildren(o);r.rootNode.active=a.bShowLayer;var s=l.G.UIManager.getMask(v.PopNodeTag.ReconnectLayer);s&&(s.active=a.bShowLayer),r?e>0&&r.setTimeout(e):cc.error("pReconnect=%d, pScene=%d",r,n),a.bShowLayer||(console.log("HHHHHHHHHHHHHHHHHHH  ReconnectLayer.ShowReconnectLayer.showPopLayer 1"),r.ReconnectServer()),t&&(console.log("HHHHHHHHHHHHHHHHHHH  ReconnectLayer.ShowReconnectLayer.showPopLayer 2"),r.menuCallbackOK()),a.bEnterBattleTimeout&&(r.m_lblTimeout.node.active=!0,r.m_lblTips.node.active=!1)}}).catch(function(e){cc.error(e)}),l.G.StringManager.PopStringOnceEnd()},t.SetReconnectSucceedCallback=function(e,t){console.log("HHHHHHHHHHHHHHHHHHH  ReconnectLayer.SetReconnectSucceedCallback"),e&&t&&(o.m_pCallbackTarget=e,o.m_pfnSucceedCallback=t)},t.CloseReconnectLayer=function(){console.log("HHHHHHHHHHHHHHHHHHH  ReconnectLayer.CloseReconnectLayer");var e=l.G.UIManager.getRunningScene().getComponentInChildren(o);e&&(e.unschedule(e.onTimeout),l.G.UIManager.popPopNode(v.PopNodeTag.ReconnectLayer)),this.bShowLayer=!0,o.reconnectLayerShowing=!1},t.prototype.onSync=function(){console.log("HHHHHHHHHHHHHHHHHHH  ReconnectLayer.onSync"),o.m_pCallbackTarget&&o.m_pfnSucceedCallback&&(console.log("HHHHHHHHHHHHHHHHHHH  ReconnectLayer.onSync 1"),o.m_pfnSucceedCallback.call(o.m_pCallbackTarget))},t.prototype.menuCallbackLogout=function(){console.log("HHHHHHHHHHHHHHHHHHH  ReconnectLayer.menuCallbackLogout 1"),this.showRestart||(console.log("HHHHHHHHHHHHHHHHHHH  ReconnectLayer.menuCallbackLogout 2"),this.status=1,this.onRequestCurVersion())},t.prototype.setTimeout=function(e){console.log("HHHHHHHHHHHHHHHHHHH  ReconnectLayer.setTimeout"),this.m_fTimeout=e},t.prototype.onTimeout=function(){console.log("HHHHHHHHHHHHHHHHHHH  ReconnectLayer.onTimeout"),l.G.UIManager.getRunningScene().getComponentInChildren(o)&&this.onRequestCurVersion()},t.prototype.reconnectRequestServerList=function(){console.log("HHHHHHHHHHHHHHHHHHH  ReconnectLayer.reconnectRequestServerList");var e="https://mszcs1.gameserver.iplay11g.com/gmsys/resVer.php?"+Math.random(),t=this,o=function(){if(cc.isValid(t)){var o=new XMLHttpRequest;o.timeout=5e3;var i=e;o.open("GET",i,!0),console.log("HHHHHHHHHHHH state = "+o.readyState),o.send(),o.onload=function(){if(cc.isValid(t))try{var e=f.GamePlatform.safeJsonParse(o.response);e&&t.onReconnectDealRequestServerList(e)}catch(i){console.log("JSON.parse(request.response) error"),t.setLabel(!1)}},o.ontimeout=function(){cc.isValid(t)&&(console.log("HHHHHHHHHHHHHHHHHH ontimeout"),t.setLabel(!1))},o.onerror=function(){cc.isValid(t)&&(console.log("HHHHHHHHHHHHHHHHHH onerror"),t.setLabel(!1))},o.onabort=function(){cc.isValid(t)&&(console.log("HHHHHHHHHHHHHHHHHH abort"),t.setLabel(!1))}}};cc.sys.os==cc.sys.OS_IOS?g.isTest()?console.log("HHHHHHHHHHHHHHHHHHH  ReconnectLayer.reconnectRequestServerList 1"):(console.log("HHHHHHHHHHHHHHHHHHH  ReconnectLayer.reconnectRequestServerList 2"),o()):(console.log("HHHHHHHHHHHHHHHHHHH  ReconnectLayer.reconnectRequestServerList 3"),o())},t.compareVer=function(e){if(e&&""!=e){console.log("wechatminiRemoteGameVer"+e),console.log("wechatminiLoaclGameVer"+P.wechatminiLoaclGameVer);for(var t=P.wechatminiLoaclGameVer.split("."),o=e.split("."),i=Math.max(t.length,o.length);t.length<i;)t.push("0");for(;o.length<i;)o.push("0");for(var a=0;a<i;a++){var n=parseInt(t[a]),r=parseInt(o[a]);if(n>r)return!1;if(n<r)return!0}}return!1},t.prototype.onReconnectDealRequestServerList=function(e){var t=this;if(console.log("HHHHHHHHHHHHHHHHHHH  ReconnectLayer.onReconnectDealRequestServerList"),console.log("HHHHHHHHHHHHHH data = "),console.log(e),e&&(console.log(e.gameVer),console.log(e.resVer)),e.length<=0)this.setLabel(!1);else if(f.GamePlatform.isWechat())o.compareVer(e.gameVer)?wx.showModal({title:"\u6e29\u99a8\u63d0\u793a~",content:"\u68c0\u6d4b\u5230\u65b0\u7248\u672c\uff0c\u9000\u51fa\u540e\u8bf7\u91cd\u65b0\u8fdb\u5165\u5c0f\u6e38\u620f\u4f53\u9a8c~",showCancel:!1,confirmText:"\u786e\u5b9a\u9000\u51fa",success:function(e){e.confirm&&wx.exitMiniProgram()}}):0==this.status?C.WechatUtils.getInstance().requestWXServer():1==this.status&&(l.G.UIManager.isFinghtingScene()&&(E.default.Instance.getGuideStatus()&&E.default.Instance.reset(),r.default.getInstance().gameState=p.Game_State.End,s.default.matchReconnectData=null,s.default.destroy(),r.default.getInstance().exitMap()),o.CloseReconnectLayer(),cc.audioEngine.stopAll(),l.G.UIManager.LoadScene(v.SceneName.LoginScene,v.SceneTag.LoginScene,v.SceneType.Type0,null));else if(f.GamePlatform.isQQMiniGame())o.compareVer(e.gameVer)?qq.showModal({title:"\u6e29\u99a8\u63d0\u793a~",content:"\u68c0\u6d4b\u5230\u65b0\u7248\u672c\uff0c\u9000\u51fa\u540e\u8bf7\u91cd\u65b0\u8fdb\u5165\u5c0f\u6e38\u620f\u4f53\u9a8c~",showCancel:!1,confirmText:"\u786e\u5b9a\u9000\u51fa",success:function(e){e.confirm&&qq.exitMiniProgram()}}):0==this.status?M.QQMiniGameUtils.getInstance().requestQQServer():1==this.status&&(l.G.UIManager.isFinghtingScene()&&(E.default.Instance.getGuideStatus()&&E.default.Instance.reset(),r.default.getInstance().gameState=p.Game_State.End,s.default.matchReconnectData=null,s.default.destroy(),r.default.getInstance().exitMap()),o.CloseReconnectLayer(),cc.audioEngine.stopAll(),l.G.UIManager.LoadScene(v.SceneName.LoginScene,v.SceneTag.LoginScene,v.SceneType.Type0,null));else if(f.GamePlatform.isByteDanceMiniGame())o.compareVer(e.gameVer)?tt.showModal({title:"\u6e29\u99a8\u63d0\u793a~",content:"\u68c0\u6d4b\u5230\u65b0\u7248\u672c\uff0c\u9000\u51fa\u540e\u8bf7\u91cd\u65b0\u8fdb\u5165\u5c0f\u6e38\u620f\u4f53\u9a8c~",showCancel:!1,confirmText:"\u786e\u5b9a\u9000\u51fa",success:function(e){e.confirm&&tt.exitMiniProgram()}}):0==this.status?B.default.getInstance().requestByteDanceServer():1==this.status&&(l.G.UIManager.isFinghtingScene()&&(E.default.Instance.getGuideStatus()&&E.default.Instance.reset(),r.default.getInstance().gameState=p.Game_State.End,s.default.matchReconnectData=null,s.default.destroy(),r.default.getInstance().exitMap()),o.CloseReconnectLayer(),cc.audioEngine.stopAll(),l.G.UIManager.LoadScene(v.SceneName.LoginScene,v.SceneTag.LoginScene,v.SceneType.Type0,null));else if(f.GamePlatform.isQQGameRoom())0==this.status?G.QQGameHallUtils.getInstance().requestQQServer():1==this.status&&(l.G.UIManager.isFinghtingScene()&&(E.default.Instance.getGuideStatus()&&E.default.Instance.reset(),r.default.getInstance().gameState=p.Game_State.End,s.default.matchReconnectData=null,s.default.destroy(),r.default.getInstance().exitMap()),o.CloseReconnectLayer(),cc.audioEngine.stopAll(),l.G.UIManager.LoadScene(v.SceneName.LoginScene,v.SceneTag.LoginScene,v.SceneType.Type0,null));else if(f.GamePlatform.isKuaishouMiniGame())o.compareVer(e.gameVer)?ks.showModal({title:"\u6e29\u99a8\u63d0\u793a~",content:"\u68c0\u6d4b\u5230\u65b0\u7248\u672c\uff0c\u9000\u51fa\u540e\u8bf7\u91cd\u65b0\u8fdb\u5165\u5c0f\u6e38\u620f\u4f53\u9a8c~",showCancel:!1,confirmText:"\u786e\u5b9a\u9000\u51fa",success:function(e){e.confirm&&ks.exitMiniProgram()}}):0==this.status?O.KSMinigameUtils.getInstance().requestServer():1==this.status&&(l.G.UIManager.isFinghtingScene()&&(E.default.Instance.getGuideStatus()&&E.default.Instance.reset(),r.default.getInstance().gameState=p.Game_State.End,s.default.matchReconnectData=null,s.default.destroy(),r.default.getInstance().exitMap()),o.CloseReconnectLayer(),cc.audioEngine.stopAll(),l.G.UIManager.LoadScene(v.SceneName.LoginScene,v.SceneTag.LoginScene,v.SceneType.Type0,null));else if(f.GamePlatform.is_meituan)console.log("reconnect--------emituan"),u.ClientNetwork.getInstance().Connect(y.GlobalVar.getServerURL());else if(0==this.status)if(f.GamePlatform.getMiYa()||f.GamePlatform.IsSmallBag()||f.GamePlatform.IsH5SmallBag()||f.GamePlatform.IsMiYaIosH5()){var i=f.GamePlatform.getMiYaVideoTypeNoSet();if("bigBlue"==i||"miyaIosH5"==i)return this.reLogin(g.getLocalData("wxdata"),g.getLocalData("token"),g.getLocalData("uid")),void setTimeout(function(){cc.isValid(t)&&t.setLabel(!1)},6e3);if(f.GamePlatform.IsYLSmallBag()||f.GamePlatform.IsMYSmallBag()||f.GamePlatform.IsLYSmallBag()||f.GamePlatform.IsDysbSmallBag()||f.GamePlatform.Is5Add7SmallBag())return AppActivity.RequestLogin(),void setTimeout(function(){cc.isValid(t)&&t.setLabel(!1)},6e3);f.GamePlatform.isAndroid()?jsb.reflection.callStaticMethod("org/cocos2dx/javascript/AppActivity","RequestLogin","()V"):(this.reLogin(g.getLocalData("wxdata"),g.getLocalData("token"),g.getLocalData("uid")),setTimeout(function(){cc.isValid(t)&&t.setLabel(!1)},6e3))}else u.ClientNetwork.getInstance().Connect(y.GlobalVar.getServerURL());else 1==this.status&&(l.G.UIManager.isFinghtingScene()&&(E.default.Instance.getGuideStatus()&&E.default.Instance.reset(),r.default.getInstance().gameState=p.Game_State.End,s.default.matchReconnectData=null,s.default.destroy(),r.default.getInstance().exitMap()),o.CloseReconnectLayer(),cc.audioEngine.stopAll(),l.G.UIManager.LoadScene(v.SceneName.LoginScene,v.SceneTag.LoginScene,v.SceneType.Type0,null))},t.show=function(){return console.log("HHHHHHHHHHHHHHHHHHH  ReconnectLayer.show"),!!l.G.UIManager.getRunningScene().getComponentInChildren(o)},t.m_pfnSucceedCallback=null,t.m_pCallbackTarget=null,t.bShowLayer=!0,t.reconnectReason=0,t.reconnectLayerShowing=!1,t.bEnterBattleTimeout=!1,n([F(cc.Label)],t.prototype,"m_lblTips",void 0),n([F(cc.Label)],t.prototype,"m_lblTrying",void 0),n([F(cc.Label)],t.prototype,"m_lblOK",void 0),n([F(cc.Label)],t.prototype,"m_lblLogout",void 0),n([F(cc.Label)],t.prototype,"m_lblTime",void 0),n([F(cc.Button)],t.prototype,"m_miOK",void 0),n([F(cc.Button)],t.prototype,"m_miLogout",void 0),n([F(cc.Node)],t.prototype,"rootNode",void 0),n([F(cc.Label)],t.prototype,"m_lblTimeout",void 0),o=n([V],t)}(m.NodeNameLayer);o.default=U,cc._RF.pop()},{"../../load":"load","../Global/GameGlobal":"GameGlobal","../combat/CombatManager":"CombatManager","../combat/FightResultView":"FightResultView","../common/CombatModule":"CombatModule","../common/PlayerModule":"PlayerModule","../controller/Guide/GuideController":"GuideController","../model/ServerAddrInfo":"ServerAddrInfo","../modules/base/GameView":"GameView","../network/ClientNetwork":"ClientNetwork","../network/protocol/LoginProtocols":"LoginProtocols","../utils/ByteDanceMiniGameUtils":"ByteDanceMiniGameUtils","../utils/ConstValue":"ConstValue","../utils/GameLoading":"GameLoading","../utils/GamePlatform":"GamePlatform","../utils/GameUtils":"GameUtils","../utils/KSMinigameUtils":"KSMinigameUtils","../utils/QQGameHallUtils":"QQGameHallUtils","../utils/QQMiniGameUtils":"QQMiniGameUtils","../utils/RewardedVideoAd":"RewardedVideoAd","../utils/UIManager":"UIManager","../utils/WechatUtils":"WechatUtils","../utils/subUtils/GuideLayer":"GuideLayer","../utils/subUtils/PopLayer":"PopLayer","../utils/subUtils/TypeDef":"TypeDef","./FightNetwork":"FightNetwork","./FightReconnectLayer":"FightReconnectLayer","./LocalMessage":"LocalMessage","./protocol/LoginProtocols":"LoginProtocols"}],RecruitTableData:[function(e,t,o){"use strict";cc._RF.push(t,"935dbRMA4JBbr/zP7YbVPhv","RecruitTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.RecruitTableData=void 0;var i=e("../TableReader"),a=e("./BaseTableData"),n=function(){function e(){this.id=0,this.index=0,this.count=0,this.prizes=new Array,this.seasonId=0}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.index=e.getNumber(),this.count=e.getNumber();for(var o=e.getString(),n=new i.TableReader(o);n.getPos()<n.getLen();){var r=new a.ItemInfo;r.readOriginal(n),this.prizes.push(r)}this.seasonId=e.getNumber()},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"RecruitTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.RecruitTableData=n,cc._RF.pop()},{"../TableReader":"TableReader","./BaseTableData":"BaseTableData"}],ResourceLoader:[function(e,t,o){"use strict";cc._RF.push(t,"76f9fXTKVVIQYSnaRVng+Cy","ResourceLoader");var i=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r},a=this&&this.__awaiter||function(e,t,o,i){return new(o||(o=Promise))(function(a,n){function r(e){try{c(i.next(e))}catch(t){n(t)}}function s(e){try{c(i.throw(e))}catch(t){n(t)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(r,s)}c((i=i.apply(e,t||[])).next())})},n=this&&this.__generator||function(e,t){var o,i,a,n,r={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return n={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function s(e){return function(t){return c([e,t])}}function c(n){if(o)throw new TypeError("Generator is already executing.");for(;r;)try{if(o=1,i&&(a=2&n[0]?i.return:n[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return r.label++,{value:n[1],done:!1};case 5:r.label++,i=n[1],n=[0];continue;case 7:n=r.ops.pop(),r.trys.pop();continue;default:if(!(a=(a=r.trys).length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){r=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){r.label=n[1];break}if(6===n[0]&&r.label<a[1]){r.label=a[1],a=n;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(n);break}a[2]&&r.ops.pop(),r.trys.pop();continue}n=t.call(e,r)}catch(s){n=[6,s],i=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.ResourceLoaderLayer=o.ResoureGameState=void 0;var r,s=e("../network/protocol/ObjCollection"),c=e("../StaticData/LoadingBgTableData"),l=e("../StaticData/LoadingTipsTableData"),d=e("../utils/GameUtils"),u=e("./ResourcesConfig"),h=e("./UIManager"),p=e("../utils/GameUtils"),f=e("../common/PlayerModule"),g=e("../network/protocol/TypeProtocols"),m=e("./ConfigUtils"),_=e("../common/CombatModule"),y=e("../modules/manager/subGame/SubGameManager"),v=e("../view/mainScene/CarSkinUtils"),C=e("./ResourcesManager"),S=e("./ConstValue"),T=e("../utils/ConstValue"),I=T.CAR_TEMPLATE_ID,N=T.PLAYER_IDENTITY,b=T.Car_Max_Level;(function(e){e[e.ResoureGameState_Main=0]="ResoureGameState_Main",e[e.ResoureGameState_Pve=1]="ResoureGameState_Pve",e[e.ResoureGameState_Pvp=2]="ResoureGameState_Pvp",e[e.ResourceGameState_subgame=3]="ResourceGameState_subgame",e[e.Other=4]="Other"})(r=o.ResoureGameState||(o.ResoureGameState={}));var w=cc._decorator,E=w.ccclass,P=(w.property,function(){function e(){}var t;return t=e,e.clearResourceData=function(){t.m_Plist_Png_Resources.clear(),t.m_FightPlistResourceMap.clear(),t.m_LoadedRelativePlist.clear(),t.g_ResourceProgress=0,t.m_PngResources.clear(),t.allSounds.splice(0,t.allSounds.length),t.allSpineData.splice(0,t.allSpineData.length),t.allJson.splice(0,t.allJson.length),t.allPrefab.splice(0,t.allPrefab.length),t.allFont.splice(0,t.allFont.length),t.allBundle.splice(0,t.allBundle.length),t.m_Type=null,t.g_GameState=r.Other},e.setGameStateOther=function(){this.g_GameState=r.Other,console.log("HHHHHHHHHHHHHHHHHHHH setGameStateOther = "+this.g_GameState)},e.getState=function(){return this.g_GameState},e.setType=function(e){this.m_Type=e,this.initGameState(),console.log("HHHHHHHHHHHHHHHHHHHH setType = "+this.g_GameState)},e.setGameState=function(e){this.g_GameState=e,console.log("HHHHHHHHHHHHHHHHHHHH setGameState = "+this.g_GameState)},e.initGameState=function(){switch(this.m_Type){case h.ResourceType.game_main_from_out_game:this.g_GameState=r.ResoureGameState_Main;break;case h.ResourceType.game_main_from_pve:case h.ResourceType.game_main_from_pvp:this.g_GameState=r.Other;break;case h.ResourceType.fight_pve_from_main:this.g_GameState=r.ResoureGameState_Pve;break;case h.ResourceType.fight_pvp_from_main:this.g_GameState=r.ResoureGameState_Pvp;break;case h.ResourceType.subgame_from_main:this.g_GameState=r.ResourceGameState_subgame;break;default:this.g_GameState=r.Other}},e.getRandAction=function(e){switch(e){case l.LoadingTipsActionType.LoadingTipsActionType_Move:return cc.moveBy(.5,new cc.Vec2(-200,0));case l.LoadingTipsActionType.LoadingTipsActionType_Rotate:return cc.rotateBy(.5,360);case l.LoadingTipsActionType.LoadingTipsActionType_FadeOut:return cc.fadeOut(.5);case l.LoadingTipsActionType.LoadingTipsActionType_Jump:return cc.jumpBy(.5,new cc.Vec2(-200,0),20,5);case l.LoadingTipsActionType.LoadingTipsActionType_Scale:return cc.scaleBy(.5,2,2);default:return this.getRandAction(p.getRand(l.LoadingTipsActionType.LoadingTipsActionType_Max))}},e.randomImgBg=function(){if(h.ResourceType.fight_pvp_from_main==this.m_Type){if(11==_.default.getBattleMapId())return d.removeFileSuffix("combat/map/map_99/99.png");if(12==_.default.getBattleMapId()||_.default.getBattleMapId()<=7)return d.removeFileSuffix("combat/map/map_108/108.png");if(13==_.default.getBattleMapId())return d.removeFileSuffix("combat/map/map_111/111.png")}if(15==_.default.getBattleMapId())return d.removeFileSuffix("combat/map/map_113/113.png");if(16==_.default.getBattleMapId())return d.removeFileSuffix("combat/map/map_114/114.png");if(17==_.default.getBattleMapId())return d.removeFileSuffix("combat/map/map_115/115.png");if(18==_.default.getBattleMapId())return d.removeFileSuffix("combat/map/705.png");if(19==_.default.getBattleMapId())return d.removeFileSuffix("combat/map/map_117/117.png");if(h.ResourceType.game_main_from_out_game==this.m_Type){var e=f.default.getRoleAttrValByKey(g.ROLE_ATTR_VALUES.ROLE_ATTR_MAPSKINID);return e<=0&&(e=701),"combat/map/"+e}if(h.ResourceType.fight_pve_from_main==this.m_Type){if(14==_.default.getBattleMapId())return d.removeFileSuffix("combat/map/112.png");var o=c.LoadingBgTableData.getById(100);return d.removeFileSuffix(o.resPath)}var i=new Array,a=f.default.getRoleAttrValByKey(g.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE),n=f.default.getRoleAttrValByKey(g.ROLE_ATTR_VALUES.ROLE_ATTR_RECHARGENUM);if(c.LoadingBgTableData.getDataMap().forEach(function(e){e.levelStart<=a&&e.levelEnd>=a&&(e.rmbNumStart<=0?i.push(e):e.rmbNumEnd<0?e.rmbNumStart<=n&&i.push(e):e.rmbNumStart<=n&&e.rmbNumEnd>n&&i.push(e))}),i.length>0){t.loadIndex=i.length-1;var r=i[t.loadIndex].resPath;return d.removeFileSuffix(r)}return o=c.LoadingBgTableData.getById(6),d.removeFileSuffix(o.resPath)},e.getSpineDataById=function(e,t){void 0===t&&(t=!1);var o=m.default.getInstance().getResConfig(e);if(o){var i=d.removeFileSuffix(o.animation);if(this.allSpineData.push(i),this.m_PngResources.add(i),t&&(C.default.pushReleaseAssets(1,{path:i,resType:cc.SpriteFrame}),C.default.pushReleaseAssets(1,{path:i,resType:cc.Texture2D}),C.default.pushReleaseAssets(1,{path:i,resType:sp.SkeletonData})),""!=o.behit){var a=d.removeFileSuffix(o.behit);this.allSpineData.push(a),this.m_PngResources.add(a)}}else console.log("cannot find spine id "+e)},e.getSpineUrlById=function(e){var t=m.default.getInstance().getResConfig(e);if(t)return d.removeFileSuffix(t.strJson);console.log("cannot find spine id "+e)},e.getSkillDataByID=function(e){var t=m.default.getInstance().getSkillConfig(e);if(t){if(this.allSounds.push(d.removeFileSuffix(t.skill_audio)),0!=t.flyingObjId){var o=m.default.getInstance().getFlyingObjConfig(t.flying_obj);o&&this.getSpineDataById(o.res_id)}var i=t.summon_npc.split("|");if(i)for(var a in i){var n=m.default.getInstance().getNpcTemplateConfig(i[a],1);n&&(this.getSpineDataById(n.res_id),this.getSkillDataByID(n.skill_id))}}else console.log("cannot find skill id "+e)},e.getFightHeroNeedResource=function(e){var t=this,o=_.default.getMatchBattleInfo(e);o&&o.heros.forEach(function(e){var o=m.default.getInstance().getHeroConfig(e.heroID);if(o){var i=m.default.getInstance().getNpcTemplateConfig(o.npc_id,e.heroLevel);i&&(t.getSpineDataById(i.res_id),t.getSkillDataByID(i.skill_id))}})},e.getFightCarNeedResource=function(){if(0==C.default.funcOpen())for(var e=1;e<7;++e)this.getSpineDataById(e);else this.getFightCarNeedResourceByCamp(!0),this.getFightCarNeedResourceByCamp(!1)},e.getFightCarNeedResourceByCamp=function(e){var t=0,o=0,i=I.pvp;_.default.getCombatType()==_.CombatType.COOP?i=_.default.matchRoleIdentity==N.away?e?I.coop_front:I.coop_back:e?I.coop_back:I.coop_front:_.default.getCombatType()!=_.CombatType.SOLO&&_.default.getCombatType()!=_.CombatType.DUEL||(i=I.pvp);var a=_.default.getCarSkinId(e?S.PLAYER_CAMP.myPlayer:S.PLAYER_CAMP.opponents);a>0&&a!=v.default.CAR_DEFAULT_SKIN_ID&&(o=v.default.Instance.getCarTableDataResIdOffset(a));var n=m.default.getInstance().getCarConfig(i);n&&(t=n.npc_id+o);for(var r=0,s=1;s<=b;s++){var c=m.default.getInstance().getNpcTemplateConfig(t,s);c&&(r=c.res_id),r>0&&(this.getSpineDataById(r,!0),e?console.log("carpreload mycar resId="+r):console.log("carpreload enemycar resId="+r))}},e.getFightHeroNeedResourceById=function(e){var t=m.default.getInstance().getHeroConfig(e);if(t){var o=m.default.getInstance().getNpcTemplateConfig(t.npc_id,1);o&&(this.getSpineDataById(o.res_id),this.getSkillDataByID(o.skill_id))}},e.getFightMonsterNeedResourceById=function(e){var t=m.default.getInstance().getNpcTemplateConfig(e,1);t&&(this.getSpineDataById(t.res_id),this.getSkillDataByID(t.skill_id))},e.getMainNeedResource=function(){return a(this,void 0,void 0,function(){var e;return n(this,function(){for(e=0;e<u.g_GameMainPngResources.length;++e)this.m_PngResources.add(d.removeFileSuffix(u.g_GameMainPngResources[e]));for(e=0;e<u.g_GameMainPlistPngResources.length;++e)this.m_Plist_Png_Resources.add(d.removeFileSuffix(u.g_GameMainPlistPngResources[e]));for(e=0;e<u.g_GameMainPreLoadPrefab.length;++e)this.allPrefab.push(d.removeFileSuffix(u.g_GameMainPreLoadPrefab[e]));if(f.default.getRoleAttrValByKey(g.ROLE_ATTR_VALUES.ROLE_ATTR_GUIDE)<1)for(e=0;e<u.g_PveFightFontResources.length;++e)this.allFont.push(d.removeFileSuffix(u.g_PveFightFontResources[e]));return[2]})})},e.getPveFightNeedResource=function(){return a(this,void 0,void 0,function(){var e,t,o,i;return n(this,function(){for(i=0;i<u.g_PveFightPngResources.length;++i)this.m_PngResources.add(d.removeFileSuffix(u.g_PveFightPngResources[i]));for(i=0;i<u.g_PveFightPlistPngResources.length;++i)this.m_Plist_Png_Resources.add(d.removeFileSuffix(u.g_PveFightPlistPngResources[i]));for(i=0;i<u.g_PveFightFontResources.length;++i)this.allFont.push(d.removeFileSuffix(u.g_PveFightFontResources[i]));for(i=0;i<u.g_PveFightSpineResources.length;++i)this.allSpineData.push(d.removeFileSuffix(u.g_PveFightSpineResources[i])),this.m_PngResources.add(d.removeFileSuffix(u.g_PveFightSpineResources[i]));for(i=0;i<u.g_PvePreLoadPrefab.length;++i)this.allPrefab.push(d.removeFileSuffix(u.g_PvePreLoadPrefab[i]));for(o in e=_.default.getBattleMapId(),t=m.default.getInstance().getBattleCfg())if(t[o].id==e){this.allPrefab.push(t[o].battle_res),this.allSounds.push(d.removeFileSuffix("music/"+t[o].music));break}if(f.default.getRoleAttrValByKey(g.ROLE_ATTR_VALUES.ROLE_ATTR_GUIDE)<1){for(i=0;i<u.g_GuidePreLoadPrefab.length;++i)this.allPrefab.push(d.removeFileSuffix(u.g_GuidePreLoadPrefab[i]));this.getFightHeroNeedResourceById(3),this.getFightHeroNeedResourceById(5),this.getFightHeroNeedResourceById(9),this.getFightHeroNeedResourceById(10),this.getFightHeroNeedResourceById(11),this.getFightHeroNeedResourceById(28),this.getFightMonsterNeedResourceById(601),this.getFightMonsterNeedResourceById(602),this.getFightMonsterNeedResourceById(603),this.getFightMonsterNeedResourceById(604),this.getFightMonsterNeedResourceById(605),this.getFightMonsterNeedResourceById(606)}return this.getFightCarNeedResource(),[2]})})},e.getPvpFightNeedResource=function(){for(var e=0;e<u.g_PvpFightPngResources.length;++e)this.m_PngResources.add(d.removeFileSuffix(u.g_PvpFightPngResources[e]));for(e=0;e<u.g_PvPFightPlistPngResources.length;++e)this.m_Plist_Png_Resources.add(d.removeFileSuffix(u.g_PvPFightPlistPngResources[e]));for(e=0;e<u.g_PveFightFontResources.length;++e)this.allFont.push(d.removeFileSuffix(u.g_PveFightFontResources[e]));for(e=0;e<u.g_PvePreLoadPrefab.length;++e)this.allPrefab.push(d.removeFileSuffix(u.g_PvePreLoadPrefab[e]));for(e=0;e<u.g_PveFightSpineResources.length;++e)this.allSpineData.push(d.removeFileSuffix(u.g_PveFightSpineResources[e])),this.m_PngResources.add(d.removeFileSuffix(u.g_PveFightSpineResources[e]));var t=_.default.getBattleMapId(),o=m.default.getInstance().getBattleCfg();for(var i in o)if(o[i].id==t){this.allPrefab.push(o[i].battle_res),this.allSounds.push(d.removeFileSuffix("music/"+o[i].music));break}this.getFightCarNeedResource()},e.getSubGameNeedResource=function(){var e=y.default.getSubGameBundleName();this.allBundle.push(e)},e.insertFightPlistResourceMap=function(){},e.getPveNeedFightFont=function(e){cc.resources.get(e,cc.Font)||cc.resources.load(e,cc.Font,function(){})},e.removeUnUsedFrameAndTexture=function(e){void 0===e&&(e=!1)},e.clearMainResource=function(){this.getMainNeedResource(),this.m_PngResources.forEach(function(e){cc.resources.release(e,cc.SpriteFrame)});for(var e=0;e<this.allSpineData.length;e++)cc.resources.release(this.allSpineData[e],sp.SkeletonData);for(this.allSpineData=[],e=0;e<this.allJson.length;e++)cc.resources.release(this.allJson[e],cc.JsonAsset);for(this.allJson=[],e=0;e<this.allFont.length;e++)cc.resources.release(this.allFont[e],cc.Font);for(this.allFont=[],e=0;e<this.allPrefab.length;e++)cc.resources.release(this.allPrefab[e],cc.Prefab);for(this.allPrefab=[],e=0;e<this.allSounds.length;e++)cc.resources.release(this.allSounds[e],cc.AudioClip);this.allSounds=[],this.allBundle=[],t.removeUnUsedFrameAndTexture(!0),this.clearTmpData()},e.clearFightResources=function(){this.getPveFightNeedResource(),this.m_PngResources.forEach(function(e){cc.resources.release(e,cc.SpriteFrame)});for(var e=0;e<this.allSpineData.length;e++)cc.resources.release(this.allSpineData[e],sp.SkeletonData);for(this.allSpineData=[],e=0;e<this.allJson.length;e++)cc.resources.release(this.allJson[e],cc.JsonAsset);for(this.allJson=[],e=0;e<this.allFont.length;e++)cc.resources.release(this.allFont[e],cc.Font);for(this.allFont=[],e=0;e<this.allPrefab.length;e++)cc.resources.release(this.allPrefab[e],cc.Prefab);for(this.allPrefab=[],e=0;e<this.allSounds.length;e++)cc.resources.release(this.allSounds[e],cc.AudioClip);this.allSounds=[],this.allBundle=[],t.removeUnUsedFrameAndTexture(),this.clearTmpData()},e.clearTmpData=function(){this.m_PngResources.clear(),this.m_Plist_Png_Resources.clear(),this.m_FightPlistResourceMap.clear(),this.m_LoadedRelativePlist.clear(),this.allSounds=[]},e.g_ResourceProgress=0,e.m_Plist_Png_Resources=new s.ObjSet,e.m_FightPlistResourceMap=new s.ObjMap,e.m_LoadedRelativePlist=new s.ObjSet,e.m_PngResources=new s.ObjSet,e.allSounds=new Array,e.allSpineData=new Array,e.allJson=new Array,e.allPrefab=new Array,e.allFont=new Array,e.allBundle=new Array,e.m_Type=null,e.loadIndex=-1,e.g_GameState=r.Other,t=i([E],e)}());o.ResourceLoaderLayer=P,cc._RF.pop()},{"../StaticData/LoadingBgTableData":"LoadingBgTableData","../StaticData/LoadingTipsTableData":"LoadingTipsTableData","../common/CombatModule":"CombatModule","../common/PlayerModule":"PlayerModule","../modules/manager/subGame/SubGameManager":"SubGameManager","../network/protocol/ObjCollection":"ObjCollection","../network/protocol/TypeProtocols":"TypeProtocols","../utils/ConstValue":"ConstValue","../utils/GameUtils":"GameUtils","../view/mainScene/CarSkinUtils":"CarSkinUtils","./ConfigUtils":"ConfigUtils","./ConstValue":"ConstValue","./ResourcesConfig":"ResourcesConfig","./ResourcesManager":"ResourcesManager","./UIManager":"UIManager"}],ResourcesConfig:[function(e,t,o){"use strict";cc._RF.push(t,"4714bZy5T9J7bBnEjIXGR/K","ResourcesConfig"),Object.defineProperty(o,"__esModule",{value:!0}),o.g_ResourceLoaderResource=o.g_GuidePreLoadPrefab=o.g_PvePreLoadPrefab=o.g_PvPFightPlistPngResources=o.g_PveFightFontResources=o.g_PveFightPlistPngResources=o.g_PvpFightPngResources=o.g_GameMainPreLoadPrefab=o.g_PveFightSpineResources=o.g_PveFightPngResources=o.g_GameMainPlistPngResources=o.g_GameMainPngResources=void 0,o.g_GameMainPngResources=["ui/common_res/zhizhang","ui/drawcard/res/bg_drawcard"],o.g_GameMainPlistPngResources=[],o.g_PveFightPngResources=["ui/hero_star/1","ui/common_res/parachute","ui/equip/img/suozijialv","ui/cardpic_l/3","ui/bag/img/1"],o.g_PveFightSpineResources=["buff/dianran","buff/gongsu","buff/jiansu","buff/xuanyun","combat/effect/shengji/shengji","combat/effect/shengji_zhanchang/shengji_zhanchang"],o.g_GameMainPreLoadPrefab=["ui/mainScene/mainView","ui/match/match","ui/match/matchMain","ui/shop/prefab/shop_main","ui/task/taskPrefabs/taskLayer","ui/playerInfo/PlayerInfo","ui/drawcard/prefab/drawCardMain","ui/heroCardBag/prefab/card_main","ui/sociaty/prefab/SociatyMain","ui/CommonPrefab/Reconnect","ui/CommonPrefab/FightReconnect"],o.g_PvpFightPngResources=[],o.g_PveFightPlistPngResources=[],o.g_PveFightFontResources=["font/Label_shuzilv","font/Label_shuzihong","font/Label_shuzibai","font/Label_shuzicheng","font/Label_shuzizi"],o.g_PvPFightPlistPngResources=[],o.g_PvePreLoadPrefab=["ui/down/Down","ui/blood/fight_top","ui/result/lose","ui/result/win","ui/heroCardBag/prefab/battle_card_info","ui/heroCardBag/prefab/CardAttr"],o.g_GuidePreLoadPrefab=["ui/guide/Guide","ui/guide/finger","ui/guide/GuideTalk"],o.g_ResourceLoaderResource=[],cc._RF.pop()},{}],ResourcesManager:[function(e,t,o){"use strict";cc._RF.push(t,"1ff98+bBWZCtoSvkV7zU9DS","ResourcesManager"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../common/CommandValue"),a=e("../common/PlayerModule"),n=e("./GamePlatform"),r=function(){function e(){this.mainReleaseAssets=new Map,this.fightReleaseAssets=new Map,this._mainMustReleaseAssets=new Set}return e.instance=function(){return this._instance||(this._instance=new this,this._instance.init()),this._instance},e.prototype.funcOpen=function(){return!0},e.prototype.funcPrefabOpen=function(){return!0},e.prototype.funcZeroRefOpen=function(){var e=n.GamePlatform.isWechat()||n.GamePlatform.isByteDanceMiniGame()||n.GamePlatform.isKuaishouMiniGame()||n.GamePlatform.isQQMiniGame();return a.default.checkModulerOnOffState(i.ModulerViewOnOff.OutFightReleaseUnUse)&&(e&&n.GamePlatform.isIOS()||!1)},e.prototype.funcMainPrefabOpen=function(){var e=n.GamePlatform.isWechat()||n.GamePlatform.isByteDanceMiniGame()||n.GamePlatform.isKuaishouMiniGame()||n.GamePlatform.isQQMiniGame();return a.default.checkModulerOnOffState(69)&&(e&&n.GamePlatform.isIOS()||!1)},e.prototype.init=function(){this._mainMustReleaseAssets.add("ui/drawcard/prefab/drawCardMain"),this._mainMustReleaseAssets.add("ui/shop/prefab/shop_main"),this._mainMustReleaseAssets.add("ui/activity/prefab/ActivityMain"),this._mainMustReleaseAssets.add("ui/playerInfo/PlayerInfo"),this._mainMustReleaseAssets.add("ui/advertising_gifts/prefab/AdvertisingGifts"),this._mainMustReleaseAssets.add("ui/invite/inviteFriend"),this._mainMustReleaseAssets.add("ui/ranklist/ranklist"),this._mainMustReleaseAssets.add("ui/mail/mail_main"),this._mainMustReleaseAssets.add("ui/announcement/announcement_main"),this._mainMustReleaseAssets.add("ui/friend/friendMain"),this._mainMustReleaseAssets.add("ui/gameClub/GameClubMain"),this._mainMustReleaseAssets.add("ui/battle_pass/prefab/BattlePass"),this._mainMustReleaseAssets.add("ui/chaunqi/prefab/ChuanQi"),this._mainMustReleaseAssets.add("ui/drawcard/prefab/OptionalBoxNode"),this._mainMustReleaseAssets.add("ui/drawcard/prefab/drawCardTips"),this._mainMustReleaseAssets.add("ui/sociaty/prefab/NotJoinedSociaty"),this._mainMustReleaseAssets.add("ui/sociaty/prefab/SociatyApply"),this._mainMustReleaseAssets.add("ui/sociaty/prefab/SociatyAuctionAttention"),this._mainMustReleaseAssets.add("ui/sociaty/prefab/SociatyAuctionDetails"),this._mainMustReleaseAssets.add("ui/sociaty/prefab/SociatyAuctionLog"),this._mainMustReleaseAssets.add("ui/sociaty/prefab/SociatyAuction"),this._mainMustReleaseAssets.add("ui/sociaty/prefab/SociatyBoxIntroduce"),this._mainMustReleaseAssets.add("ui/sociaty/prefab/SociatyBoxOrigin"),this._mainMustReleaseAssets.add("ui/sociaty/prefab/SociatyCreateRedEnvelope"),this._mainMustReleaseAssets.add("ui/sociaty/prefab/SociatyCreat"),this._mainMustReleaseAssets.add("ui/sociaty/prefab/SociatyDonation"),this._mainMustReleaseAssets.add("ui/sociaty/prefab/SociatyFightMatch"),this._mainMustReleaseAssets.add("ui/sociaty/prefab/SociatyFightRank"),this._mainMustReleaseAssets.add("ui/sociaty/prefab/SociatyFightTip"),this._mainMustReleaseAssets.add("ui/sociaty/prefab/SociatyInfo"),this._mainMustReleaseAssets.add("ui/sociaty/prefab/SociatyInvited"),this._mainMustReleaseAssets.add("ui/sociaty/prefab/SociatyJoinSuccess"),this._mainMustReleaseAssets.add("ui/sociaty/prefab/SociatyOpenRedEnvelope"),this._mainMustReleaseAssets.add("ui/sociaty/prefab/SociatyRedEnvelopeTip"),this._mainMustReleaseAssets.add("ui/sociaty/prefab/SociatyRule"),this._mainMustReleaseAssets.add("ui/sociaty/prefab/SociatySearch"),this._mainMustReleaseAssets.add("ui/sociaty/prefab/SociatyShopTip"),this._mainMustReleaseAssets.add("ui/navigation/NavigationIntroduce"),this._mainMustReleaseAssets.add("ui/navigation/NavigationMain"),this._mainMustReleaseAssets.add("ui/chaunqi/prefab/ChuanQiPalace"),this._mainMustReleaseAssets.add("ui/chaunqi/prefab/IntroduceView"),this._mainMustReleaseAssets.add("ui/chaunqi/prefab/RewardsPreview"),this._mainMustReleaseAssets.add("ui/chaunqi/prefab/PalaceRewardsPreview"),this._mainMustReleaseAssets.add("ui/activity/prefab/ActivityFristRechargeView"),this._mainMustReleaseAssets.add("ui/advertising_gifts/prefab/AdvertisingGiftsGuangGao"),this._mainMustReleaseAssets.add("ui/advertising_gifts/prefab/AdvertisingGifts"),this._mainMustReleaseAssets.add("ui/advertising_gifts/prefab/AdvertisingGiftsMain"),this._mainMustReleaseAssets.add("ui/advertising_gifts/prefab/AdvertisingGiftsMengXin")},e.prototype.pushReleaseAssets=function(e,t){if(0!=this.funcOpen()&&t&&t.path&&t.resType){var o=null;if(0==e?o=this.mainReleaseAssets:1==e&&(o=this.fightReleaseAssets),null!=o){var i=o.get(t.path);if(i)i.add(t.resType);else{var a=new Set;a.add(t.resType),o.set(t.path,a)}}}},e.prototype.addMainScenePrefab=function(){var e=this;this._mainMustReleaseAssets.forEach(function(t){var o={path:t,resType:cc.Prefab};e.pushReleaseAssets(0,o)})},e.prototype.releaseAssets=function(e){var t=null;if(0==e?(this.addMainScenePrefab(),t=this.mainReleaseAssets):1==e&&(t=this.fightReleaseAssets),t.size<=0)return!1;console.log("memory before count="+cc.assetManager.assets.count);for(var o=function(e,t){t.forEach(function(t){if(e.length>0&&t){var o=cc.resources.get(e,t);o&&(console.log("res_release_dump "+e+" "+t.name),cc.assetManager.releaseAsset(o))}})},i=0,a=t.entries();i<a.length;i++){var n=a[i];o(n[0],n[1])}if(t.clear(),1==this.funcMainPrefabOpen()&&0==e&&(console.log("memory release mainprefab"),this.releasePrefab(1)),1==this.funcPrefabOpen()&&1==e&&this.releasePrefab(0),1==this.funcZeroRefOpen()&&1==e){console.log("release000");var r=this;cc.assetManager.assets.forEach(function(e){e.refCount<=0&&r.prefabCanRelease(e.name)&&cc.assetManager.releaseAsset(e)})}return console.log("memory after count="+cc.assetManager.assets.count),!0},e.prototype.prefabCanRelease=function(e){return"mainView"!=e&&!e.includes("main_map")&&!e.includes("Reconnect")},e.prototype.prefabCanReleaseEnterFight=function(e){if(0==this.prefabCanRelease(e))return!1;var t=new Set;t.add("Down"),t.add("fight_top"),t.add("lose"),t.add("win"),t.add("battle_card_info"),t.add("CardAttr"),t.add("card");for(var o=0,i=t;o<i.length;o++){var a=i[o];if(e.includes(a))return!1}return!0},e.prototype.loadPrefab=function(e,t,o){cc.resources.load(e,cc.Prefab,function(i,a){if(i)console.error("load prefab path: "+e+" faild!!!");else{var n=cc.instantiate(a);t&&(n.parent=t),n.position=cc.Vec3.ZERO,o&&o(n,a)}})},e.prototype.loadSprite=function(e,t,o){cc.resources.load(e,cc.SpriteFrame,function(i,a){i?console.error("load picture path: "+e+" faild!!!"):t&&t.node&&cc.isValid(t.node)&&(t.spriteFrame=a,o&&o(a))})},e.prototype.loadSpine=function(e,t){cc.resources.load(e,sp.SkeletonData,function(o,i){if(o)console.log("load asset url:"+e+" faild!!!");else{var a=new cc.Node,n=a.addComponent(sp.Skeleton);n&&(n.skeletonData=i,n.setSkin("default"),n.setAnimation(0,"idle",!0)),t&&t(a,i)}})},e.prototype.loadBundle=function(e,t){cc.assetManager.loadBundle(e,function(o,i){o&&console.log("load bundle url:"+e+" faild!!!"),t&&t(i)})},e.prototype.loadBundleAsync=function(e,t){return new Promise(function(o){cc.assetManager.loadBundle(e,function(e,i){e?(cc.error(e),o(null)):(t&&t(e,i),o(i))})})},e.prototype.getBundle=function(e){return cc.assetManager.getBundle(e)||null},e.prototype.releaseBundle=function(e){var t=cc.assetManager.getBundle(e);t&&t.releaseAll()},e.prototype.removeBundle=function(e){var t=cc.assetManager.getBundle(e);t&&(this.releaseBundle(e),cc.assetManager.removeBundle(t))},e.prototype.dumpTextureSize=function(){var e=0;cc.assetManager.assets.forEach(function(t){if(t instanceof cc.Texture2D){var o=t.width*t.height*4;e+=o,console.log("DT url="+t.url+" name="+t.name+" size="+o/1024)}}),console.log("DT total size "+e/1024/1024+" M")},e.prototype.releasePrefab=function(e){var t=this;cc.assetManager.assets.forEach(function(o){o instanceof cc.Prefab&&(0==e&&t.prefabCanRelease(o.name)&&cc.assetManager.releaseAsset(o),1==e&&t.prefabCanReleaseEnterFight(o.name)&&cc.assetManager.releaseAsset(o))})},e}();o.default=r.instance(),cc._RF.pop()},{"../common/CommandValue":"CommandValue","../common/PlayerModule":"PlayerModule","./GamePlatform":"GamePlatform"}],RewardedVideoAd:[function(e,t,o){"use strict";cc._RF.push(t,"c8817ZKzJlHcrl+q3qRw2Tq","RewardedVideoAd"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../network/ClientNetwork"),a=e("./GamePlatform"),n=e("../Global/GameGlobal"),r=e("./WechatUtils"),s=e("../common/PlayerModule"),c=e("../modules/base/GameView"),l=e("./WechatUtils"),d=e("../network/protocol/RoleProtocols"),u=e("../TalkingDataAPI"),h=e("../StaticData/CostGetTableData"),p=e("./ByteDanceMiniGameUtils"),f=e("./RewardedVideoUnitIdConst"),g=e("../network/LocalMessage"),m=e("../network/protocol/SociatyProtocols"),_=function(){function e(){this._curPlayVideoName="",this._bLoadVideo=!0,this._loadIndex=0,this._bClick=!1,this.m_adCardItemId=1010,this.m_adCardNum=0,this.m_thisIntData=null,this.m_useGoldState=0,this.m_useAdCardState=0,this.lastFailTime=0,this.finishCb_reconnect=null}return e.instance=function(){return this._instance||(this._instance=new this,this._instance.init()),this._instance},e.prototype.getAdCardNum=function(){return this.m_adCardNum},e.prototype.init=function(){var e=this;i.ClientNetwork.getInstance().listenProtocol(d.ROLE_CLIENT_ENUM.P_Role_Get_Item_Num,function(t){t.resetPos();var o=new d.S_Role_Get_Item_Num;o.read(t)&&0===o.errorcode&&o.itemId==e.m_adCardItemId&&(console.log("\u83b7\u53d6\u5230\u5e7f\u544a\u5361\u6570\u91cf="+o.itemNum),e.m_adCardNum=o.itemNum,o.itemNum<=0?e.createVideo2(e.m_thisIntData):c.default.addPopView("BaseCtrl","AdJumpTipView","AdJumpTipView",{data:e.m_thisIntData,callBack:function(){e.m_thisIntData&&(e.m_thisIntData.finishCb&&(e.m_thisIntData.finishCb(),e.m_useAdCardState=1),e.m_thisIntData=null)}}))},this);var t=new Map;t.set(d.ROLE_CLIENT_ENUM.P_Role_Add_Fight_Cooperation_Num,d.S_Role_Add_Fight_Cooperation_Num),t.set(d.ROLE_CLIENT_ENUM.P_Role_ReceiveFightWinExtra,d.S_Role_ReceiveFightWinExtra),t.set(d.ROLE_CLIENT_ENUM.P_Role_ReceiveFightLoserProtect,d.S_Role_ReceiveFightLoserProtect),t.set(d.ROLE_CLIENT_ENUM.P_Role_TakeTask,d.S_Role_TakeTask),t.set(d.ROLE_CLIENT_ENUM.P_Role_RandShopRefresh,d.S_Role_RandShopRefresh),t.set(d.ROLE_CLIENT_ENUM.P_Role_RandRechargeRefresh,d.S_Role_RandRechargeRefresh),t.set(d.ROLE_CLIENT_ENUM.P_Role_Cost_Get,d.S_Role_Cost_Get),t.set(d.ROLE_CLIENT_ENUM.P_Role_TakeTaskBox,d.S_Role_TakeTaskBox),t.set(m.SOCIATY_CLIENT_ENUM.P_Sociaty_RoleDonate,m.S_Sociaty_RoleDonate),i.ClientNetwork.getInstance().listenLocalMessage(g.LOCAL_MESSAGE.LocalMsg_JumpAdGetReward,function(o){var a=o[0];if(a.resetPos(),t.get(o[1])){var n=new(t.get(o[1]));if(n.read(a)){if(0===n.errorcode){var r=0;if(1==e.m_useAdCardState?r=4:1==e.m_useGoldState&&(r=2),r>0){var s=new d.C_Role_Cost_Get;s.id=h.CostGetTableData.getById(r).id,s.count=1,i.ClientNetwork.getInstance().Send(d.ROLE_CLIENT_ENUM.P_Role_Cost_Get,s)}}e.m_useGoldState=0,e.m_useAdCardState=0}}},this)},e.prototype.loadCreateRewardedVideoAd=function(){[f.RewardedVideoUnitIdConst.CoopAddCount,f.RewardedVideoUnitIdConst.ShopRefresh,f.RewardedVideoUnitIdConst.ShopGiftRefresh,f.RewardedVideoUnitIdConst.TaskFreeBox,f.RewardedVideoUnitIdConst.TaskDoubleReward,f.RewardedVideoUnitIdConst.ReceiveFightWinExtra,f.RewardedVideoUnitIdConst.ReceiveFightLoserProtect,f.RewardedVideoUnitIdConst.SociatyDonateBox].forEach(function(t){var o=e.caches[t];o||(o={},e.caches[t]=o,a.GamePlatform.isQQMiniGame()?o.rewardedVideoAd=qq.createRewardedVideoAd({adUnitId:t}):a.GamePlatform.isByteDanceMiniGame()?o.rewardedVideoAd=tt.createRewardedVideoAd({adUnitId:t}):a.GamePlatform.isWechat()&&(o.rewardedVideoAd=wx.createRewardedVideoAd({adUnitId:t})),o.rewardedVideoAd&&(o.rewardedVideoAd.onError(function(e){console.log("\u5e7f\u544a\u52a0\u8f7d\u5931\u8d25\uff1a",e),u.TalkingDataAPI.event("rewardedVideoAd.onError",{code:e.errCode})}),o.rewardedVideoAd.onLoad(function(){console.log("\u5e7f\u544a\u52a0\u8f7d\u6210\u529f")})))})},e.prototype.compareVersion=function(e,t){e=e.split("."),t=t.split(".");for(var o=Math.max(e.length,t.length);e.length<o;)e.push("0");for(;t.length<o;)t.push("0");for(var i=0;i<o;i++){var a=parseInt(e[i]),n=parseInt(t[i]);if(a>n)return 1;if(a<n)return-1}return 0},e.prototype.isCanShowVideo=function(){var e=!1;if(a.GamePlatform.isWechat()){var t=wx.getSystemInfoSync().SDKVersion;-1===this.compareVersion(t,"2.0.4")?console.log("=====\u7248\u672c\u4e0d\u591f2.0.4\uff0c\u89c6\u9891\u5e7f\u544a\u4e0d\u80fd\u7528"):e=!0}else e=!0;return e},e.prototype.buyVideoByGold=function(){var e=this,t=h.CostGetTableData.getById(2).cost[0].itemNum;c.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:n.G.StringManager.getString("ADVERTISING_LOAD_FAIL",t),confirmCb:function(){if(s.default.getGoldNum()<Number(t))return n.G.StringManager.PopString("\u91d1\u5e01\u4e0d\u8db3\uff01");e._data&&(e._data.finishCb&&(e._data.finishCb(),e.m_useGoldState=1),e._data=null)}})},e.prototype.createVideo=function(e){console.log("================================createVideo, data.adUnitId="+e.adUnitId),e.time=(new Date).getTime(),null!=e.cb&&null==e.finishCb&&(e.finishCb=e.cb),this.m_thisIntData=e;var t=new d.C_Role_Get_Item_Num;t.itemId=this.m_adCardItemId,i.ClientNetwork.getInstance().Send(d.ROLE_CLIENT_ENUM.P_Role_Get_Item_Num,t),console.log("RewardedVideoAd, createVideo, \u8bf7\u6c42\u5e7f\u544a\u5361\u6570\u91cf")},e.prototype.createVideo2=function(t){var o=this;if(console.log("================================createVideo2, data.adUnitId="+t.adUnitId),this.finishCb_reconnect=null,this._data=t,(a.GamePlatform.getMiYa()||a.GamePlatform.is_bigBlueH5)&&!a.GamePlatform.is_lyH5dysb&&!a.GamePlatform.is_ly5add7){console.log("miya---------------------no video==================",t.advertID);var r=new d.C_Role_ClientBeginAdvert;r.advertID=t.advertID,i.ClientNetwork.getInstance().Send(d.ROLE_CLIENT_ENUM.P_Role_ClientBeginAdvert,r),cc.audioEngine.pauseMusic();var s=(new Date).getTime();return a.GamePlatform.setVideoShowTime(s),a.GamePlatform.setMiYaVideoRwd(t),n.G.UIManager.showWaitingLayer(n.G.UIManager.getCurSceneName()),a.GamePlatform.is_play_video=!0,a.GamePlatform.is_bigBlueH5||a.GamePlatform.is_mayiH5yl||a.GamePlatform.is_mayiH5my||a.GamePlatform.is_lyH5sq?void AppActivity.showAds():void(a.GamePlatform.isAndroid()?jsb.reflection.callStaticMethod("org/cocos2dx/javascript/AppActivity","showAds","()V"):jsb.reflection.callStaticMethod("AppController","showAds"))}if(a.GamePlatform.isWechat()||a.GamePlatform.isQQMiniGame()||a.GamePlatform.isByteDanceMiniGame()||a.GamePlatform.isKuaishouMiniGame()){if(t.adUnitId){n.G.UIManager.showWaitingLayer(n.G.UIManager.getCurSceneName());var c=e.caches[t.adUnitId];if(!c){if(c={},e.caches[t.adUnitId]=c,a.GamePlatform.isQQMiniGame())c.rewardedVideoAd=qq.createRewardedVideoAd({adUnitId:t.adUnitId});else if(a.GamePlatform.isByteDanceMiniGame())c.rewardedVideoAd=tt.createRewardedVideoAd({adUnitId:t.adUnitId});else{if(!wx.createRewardedVideoAd)return a.GamePlatform.isWechat()?wx.showModal({title:"\u63d0\u793a",content:"\u5f53\u524d\u5fae\u4fe1\u7248\u672c\u8fc7\u4f4e\uff0c\u65e0\u6cd5\u4f7f\u7528\u8be5\u529f\u80fd\uff0c\u8bf7\u5347\u7ea7\u5230\u6700\u65b0\u5fae\u4fe1\u7248\u672c\u540e\u91cd\u8bd5\u3002"}):n.G.StringManager.PopString("\u5f53\u524d\u7248\u672c\u8fc7\u4f4e\uff0c\u65e0\u6cd5\u4f7f\u7528\u8be5\u529f\u80fd\uff0c\u8bf7\u5347\u7ea7\u5230\u6700\u65b0\u7248\u672c\u540e\u91cd\u8bd5");c.rewardedVideoAd=wx.createRewardedVideoAd({adUnitId:t.adUnitId})}c.rewardedVideoAd.onError(function(e){console.log("\u5e7f\u544a\u52a0\u8f7d\u5931\u8d25\uff1a",e)}),c.rewardedVideoAd.onLoad(function(){console.log("\u5e7f\u544a\u52a0\u8f7d\u6210\u529f")})}c.rewardedVideoAd.show().catch(function(){c.rewardedVideoAd.load().then(function(){return c.rewardedVideoAd.show().then(function(){return o.onRewardedVideoAdShowSucceed()})}).catch(function(e){console.log("\u6fc0\u52b1\u89c6\u9891 \u5e7f\u544a\u663e\u793a\u5931\u8d25",e),o.onRewardedVideoAdShowFail(e)})}).then(function(){return o.onRewardedVideoAdShowSucceed()});var l=this,u=function(e){c.rewardedVideoAd.offClose(u),e&&e.isEnded||void 0===e?l._data.finishCb&&(a.GamePlatform.isByteDanceMiniGame()&&0==i.ClientNetwork.getInstance().isConnected()?l.finishCb_reconnect=l._data.finishCb:l._data.finishCb(),p.default.getInstance().reportAd_complete()):p.default.getInstance().reportAd_close(),cc.audioEngine.resumeMusic()};c.rewardedVideoAd.offClose(u),c.rewardedVideoAd.onClose(u)}}else t.finishCb&&t.finishCb()},e.prototype.reconnectFunc=function(){a.GamePlatform.isByteDanceMiniGame()&&null!=this.finishCb_reconnect&&(this.finishCb_reconnect(),this.finishCb_reconnect=null)},e.prototype.onClientBeginAdvert=function(e){var t=new d.C_Role_ClientBeginAdvert;t.advertID=e,i.ClientNetwork.getInstance().Send(d.ROLE_CLIENT_ENUM.P_Role_ClientBeginAdvert,t)},e.prototype.onCallRewards=function(){this._data&&(this._data.finishCb&&this._data.finishCb(),this._data=null)},e.prototype.onRewardedVideoAdShowSucceed=function(){var e=this;if(!this._data)return!1;cc.audioEngine.pauseMusic(),a.GamePlatform.isByteDanceMiniGame()?this.onClientBeginAdvert(this._data.advertID):setTimeout(function(){if(!e._data)return!1;e.onClientBeginAdvert(e._data.advertID),a.GamePlatform.isWechat()&&r.WechatUtils.getInstance().onSendFeishuConversionInfo(l.FeishuPostEventType.Game_Addiction)},2e3),p.default.getInstance().reportAd_click()},e.prototype.onRewardedVideoAdShowFail=function(e){if(a.GamePlatform.isWechat()&&e.errCode){var t=[];t[0]="VideoAd Show Error",t[1]=e.errMsg,t[2]=e.errCode,a.GamePlatform.reportWXLog(t)}this.buyVideoByGold()},e.caches={},e}();o.default=_.instance(),cc._RF.pop()},{"../Global/GameGlobal":"GameGlobal","../StaticData/CostGetTableData":"CostGetTableData","../TalkingDataAPI":"TalkingDataAPI","../common/PlayerModule":"PlayerModule","../modules/base/GameView":"GameView","../network/ClientNetwork":"ClientNetwork","../network/LocalMessage":"LocalMessage","../network/protocol/RoleProtocols":"RoleProtocols","../network/protocol/SociatyProtocols":"SociatyProtocols","./ByteDanceMiniGameUtils":"ByteDanceMiniGameUtils","./GamePlatform":"GamePlatform","./RewardedVideoUnitIdConst":"RewardedVideoUnitIdConst","./WechatUtils":"WechatUtils"}],RewardedVideoUnitIdConst:[function(e,t,o){"use strict";cc._RF.push(t,"cbbeaCbvhZOJrgTE4aXyK0U","RewardedVideoUnitIdConst"),Object.defineProperty(o,"__esModule",{value:!0}),o.RewardedVideoUnitIdConst=o.RewardedVideoClientIdConst=void 0;var i=e("./GamePlatform");(function(e){e[e.Task_Free_Box=1]="Task_Free_Box",e[e.Task_Double_Box=2]="Task_Double_Box",e[e.Shop_Gift_Refresh=3]="Shop_Gift_Refresh",e[e.Shop_Refresh=4]="Shop_Refresh",e[e.Coop_Add_Count=5]="Coop_Add_Count",e[e.ReceiveFightWinExtra=6]="ReceiveFightWinExtra",e[e.ReceiveFightLoserProtect=7]="ReceiveFightLoserProtect",e[e.SociatyDonateBox=8]="SociatyDonateBox"})(o.RewardedVideoClientIdConst||(o.RewardedVideoClientIdConst={}));var a=function(){function e(){}return Object.defineProperty(e,"CoopAddCount",{get:function(){return i.GamePlatform.isQQMiniGame()?"40a18ec1191b40d8cd973271ef731b12":i.GamePlatform.isByteDanceMiniGame()?"17262bhbb7l5aps71p":i.GamePlatform.isKuaishouMiniGame()?"2300003157_01":"adunit-fcc5954a7bae3e7a"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"ShopRefresh",{get:function(){return i.GamePlatform.isQQMiniGame()?"198caef8055758888e9c9c50912e0912":i.GamePlatform.isByteDanceMiniGame()?"n29jnd1cj6d29kf6j3":i.GamePlatform.isKuaishouMiniGame()?"2300003157_01":"adunit-d5d3e7a70d8a9a2e"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"ShopGiftRefresh",{get:function(){return i.GamePlatform.isQQMiniGame()?"7771ad6589c02c914831882cd7f67f27":i.GamePlatform.isByteDanceMiniGame()?"15n3i9ai2c063kmk5k":i.GamePlatform.isKuaishouMiniGame()?"2300003157_01":"adunit-3892181bb06e5b4c"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"TaskFreeBox",{get:function(){return i.GamePlatform.isQQMiniGame()?"f88a248552f30a7f6330acebd00cc6fc":i.GamePlatform.isByteDanceMiniGame()?"e0d59hd3b2bj9h8p8e":i.GamePlatform.isKuaishouMiniGame()?"2300003157_01":"adunit-4da4442307d47104"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"TaskDoubleReward",{get:function(){return i.GamePlatform.isQQMiniGame()?"1bcdeb2fc31e16b3b4941a9f86185534":i.GamePlatform.isByteDanceMiniGame()?"4b21fb05a08d8l7glg":i.GamePlatform.isKuaishouMiniGame()?"2300003157_01":"adunit-ec2e300f91baec73"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"ReceiveFightWinExtra",{get:function(){return i.GamePlatform.isQQMiniGame()?"c5b4d9d3bea5eebb9a6eadc5ffa3e940":i.GamePlatform.isByteDanceMiniGame()?"6h4fgd1lagam771bsh":i.GamePlatform.isKuaishouMiniGame()?"2300003157_01":"adunit-83b903a4be2e8b51"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"ReceiveFightLoserProtect",{get:function(){return i.GamePlatform.isQQMiniGame()?"27bc19e598d458d4732750fb267801ba":i.GamePlatform.isByteDanceMiniGame()?"54n6pa04i242981m2f":i.GamePlatform.isKuaishouMiniGame()?"2300003157_01":"adunit-e24edfe800408e95"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"SociatyDonateBox",{get:function(){return i.GamePlatform.isQQMiniGame()?"27bc19e598d458d4732750fb267801ba":i.GamePlatform.isByteDanceMiniGame()?"54n6pa04i242981m2f":i.GamePlatform.isKuaishouMiniGame()?"2300003157_01":"adunit-bf0d2c116e804503"},enumerable:!1,configurable:!0}),e}();o.RewardedVideoUnitIdConst=a,cc._RF.pop()},{"./GamePlatform":"GamePlatform"}],RewardsPreviewView:[function(e,t,o){"use strict";cc._RF.push(t,"8033afvQelLL6nG3h6GF4gf","RewardsPreviewView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/GameView"),c=e("../../Global/GameGlobal"),l=e("../../StaticData/StringValueTableData"),d=e("../../utils/GameTools"),u=e("../../modules/base/Decorators"),h=cc._decorator,p=h.ccclass,f=h.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ScrollView=null,t.RewardNode=null,t._prizeNum=0,t}return a(t,e),t.path=function(){return"ui/chaunqi/prefab/RewardsPreview"},t.prototype.init=function(e){this._prizeNum=e.prizeNum,this._rewards=e.rewards,0===e.rewardState?this.RewardNode.active=!1:1===e.rewardState?this.RewardNode.active=!0:(this.RewardNode.active=!0,d.default.setNodeBright(this.RewardNode,!1)),this._state=e.rewardState,this._rewards.length>3&&(this.ScrollView.content.getComponent(cc.Layout).spacingX=25),this.initRewards(this._rewards)},t.prototype.initRewards=function(e){var t=this;e.forEach(function(e){d.default.createNormalItems(e.itemID,e.itemNum,t.ScrollView.content,function(e){e.getChildByName("name").active=!0})})},t.prototype.onCloseCallBack=function(){this._btnRes&&this._btnRes.decRef(),this.closeView()},t.prototype.onRewardCallBacks=function(){if(2===this._state)return c.G.StringManager.PopString(l.StringValueTableData.getById(15).string_value);var e=s.default.getViewByName("LegendView");e&&e.view&&e.view.onRewardCallBack(this._prizeNum)},n([f(cc.ScrollView)],t.prototype,"ScrollView",void 0),n([f(cc.Node)],t.prototype,"RewardNode",void 0),n([u.Register_Class,p],t)}(r.default);o.default=g,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/StringValueTableData":"StringValueTableData","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/base/GameView":"GameView","../../utils/GameTools":"GameTools"}],RobotNickNameTableData:[function(e,t,o){"use strict";cc._RF.push(t,"b7a58RRZJRDj68zlYpVOwd+","RobotNickNameTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.RobotNickNameTableData=void 0;var i=e("../TableReader"),a=function(){function e(){this.group=0,this.weight=0,this.nickName=""}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.group=e.getNumber(),this.weight=e.getNumber(),this.nickName=e.getString()},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"RobotNickNameTableData"},e.prototype.isAutoId=function(){return!0},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.RobotNickNameTableData=a,cc._RF.pop()},{"../TableReader":"TableReader"}],RobotTableData:[function(e,t,o){"use strict";cc._RF.push(t,"07014/nzt1F7I1Ouf5oTsDZ","RobotTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.RobotTableData=void 0;var i=e("../TableReader"),a=e("./BaseTableData"),n=function(){function e(){this.id=0,this.aiid=0,this.group=0,this.weight=0,this.nameGroup=0,this.headGroup=0,this.headFrameGroup=0,this.mapSkinGroup=0,this.level=0,this.levelExp=0,this.scoreLevel=0,this.floatWinPro=0,this.heros=new Array,this.allAttr=new Array,this.carUpHp=0}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.aiid=e.getNumber(),this.group=e.getNumber(),this.weight=e.getNumber(),this.nameGroup=e.getNumber(),this.headGroup=e.getNumber(),this.headFrameGroup=e.getNumber(),this.mapSkinGroup=e.getNumber(),this.level=e.getNumber(),this.levelExp=e.getNumber(),this.scoreLevel=e.getNumber(),this.floatWinPro=e.getNumber();for(var o=e.getString(),n=new i.TableReader(o);n.getPos()<n.getLen();){var r=void 0;r=n.getNumber(),this.heros.push(r)}o=e.getString();for(var s=new i.TableReader(o);s.getPos()<s.getLen();)(r=new a.AttrData).readOriginal(s),this.allAttr.push(r);this.carUpHp=e.getNumber()},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"RobotTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.RobotTableData=n,cc._RF.pop()},{"../TableReader":"TableReader","./BaseTableData":"BaseTableData"}],RoleProtocols:[function(e,t,o){"use strict";cc._RF.push(t,"65916Qr7EhLX5qurtZOmFYi","RoleProtocols"),e("DataViewRW");var i=e("ObjCollection"),a=e("long"),n=e("./BaseProtocols").T_Reward,r=e("./BaseProtocols").T_RoleAbstract,s=e("./BaseProtocols").T_Chat_Data,c=e("./BaseProtocols").T_RoleShow,l=e("./BaseProtocols").T_Fight_Extra_Data,d=e("./BaseProtocols").T_GameNotice_Data,u=e("./BaseProtocols").T_Fight_Statistic_info,h=e("./BaseProtocols").T_RoleProficiency;(function(e){e[e.P_Role_Begin=2e6]="P_Role_Begin",e[e.P_Role_RoleEnterLogic=2000001]="P_Role_RoleEnterLogic",e[e.P_Role_SynRoleData=2000002]="P_Role_SynRoleData",e[e.P_Role_SynRoleAttrValue=2000003]="P_Role_SynRoleAttrValue",e[e.P_Role_SynRoleInformationData=2000004]="P_Role_SynRoleInformationData",e[e.P_Role_SynRoleRechargeData=2000005]="P_Role_SynRoleRechargeData",e[e.P_Role_SynItemData=2000006]="P_Role_SynItemData",e[e.P_Role_SynMailData=2000007]="P_Role_SynMailData",e[e.P_Role_SynItemInfoData=2000008]="P_Role_SynItemInfoData",e[e.P_Role_SynTaskData=2000009]="P_Role_SynTaskData",e[e.P_Role_SynExchangeData=2000010]="P_Role_SynExchangeData",e[e.P_Role_SynBattleArrayData=2000011]="P_Role_SynBattleArrayData",e[e.P_Role_SynSignInData=2000012]="P_Role_SynSignInData",e[e.P_Role_SynTimeBoxData=2000013]="P_Role_SynTimeBoxData",e[e.P_Role_SynThemeBoxData=2000014]="P_Role_SynThemeBoxData",e[e.P_Role_SynSeasonData=2000015]="P_Role_SynSeasonData",e[e.P_Role_SynShareData=2000016]="P_Role_SynShareData",e[e.P_Role_ModifyTime=2000017]="P_Role_ModifyTime",e[e.P_Role_ReadMail=2000018]="P_Role_ReadMail",e[e.P_Role_DeleteReadMail=2000019]="P_Role_DeleteReadMail",e[e.P_Role_DeleteAllReadMail=2000020]="P_Role_DeleteAllReadMail",e[e.P_Role_ReceiveMailAnnex=2000021]="P_Role_ReceiveMailAnnex",e[e.P_Role_ReceiveAllMailAnnex=2000022]="P_Role_ReceiveAllMailAnnex",e[e.P_Role_OnExchange=2000023]="P_Role_OnExchange",e[e.P_Role_HeroLevelUp=2000024]="P_Role_HeroLevelUp",e[e.P_Role_BattleArraySetDefine=2000025]="P_Role_BattleArraySetDefine",e[e.P_Role_BattleArrayUp=2000026]="P_Role_BattleArrayUp",e[e.P_Role_BattleArrayDown=2000027]="P_Role_BattleArrayDown",e[e.P_Role_BattleArrayChange=2000028]="P_Role_BattleArrayChange",e[e.P_Role_Take_Score_Achievement_Reward=2000029]="P_Role_Take_Score_Achievement_Reward",e[e.P_Role_FightBalance=2000030]="P_Role_FightBalance",e[e.P_Role_ResetWinLostNum=2000031]="P_Role_ResetWinLostNum",e[e.P_Role_UpdateClientInt=2000032]="P_Role_UpdateClientInt",e[e.P_Role_SignInReceivePrize=2000033]="P_Role_SignInReceivePrize",e[e.P_Role_SetGuide=2000034]="P_Role_SetGuide",e[e.P_Role_Fight_Reconnect=2000035]="P_Role_Fight_Reconnect",e[e.P_Role_SeasonClearLastData=2000036]="P_Role_SeasonClearLastData",e[e.P_Role_SeasonReceiveForeverScorePrize=2000037]="P_Role_SeasonReceiveForeverScorePrize",e[e.P_Role_SeasonReceiveScorePrize=2000038]="P_Role_SeasonReceiveScorePrize",e[e.P_Role_GetRoleSimpleInfo=2000039]="P_Role_GetRoleSimpleInfo",e[e.P_Role_UpdateRoleCardData=2000040]="P_Role_UpdateRoleCardData",e[e.P_Role_SynHistoryWorldChat=2000041]="P_Role_SynHistoryWorldChat",e[e.P_Role_Get_Fight_Record_Battle=2000042]="P_Role_Get_Fight_Record_Battle",e[e.P_Role_Get_Fight_Record_Cooperation=2000043]="P_Role_Get_Fight_Record_Cooperation",e[e.P_Role_SynTotalSignInData=2000044]="P_Role_SynTotalSignInData",e[e.P_Role_TotalSignInReceivePrize=2000045]="P_Role_TotalSignInReceivePrize",e[e.P_Role_GetCDKReward=2000046]="P_Role_GetCDKReward",e[e.P_Role_BroadcastGameNotice=2000047]="P_Role_BroadcastGameNotice",e[e.P_Role_ItemMapSkinUp=2000048]="P_Role_ItemMapSkinUp",e[e.P_Role_BattleArrayUpBatch=2000049]="P_Role_BattleArrayUpBatch",e[e.P_Role_Fight_Report=2000050]="P_Role_Fight_Report",e[e.P_Role_ReportData=2000051]="P_Role_ReportData",e[e.P_Role_SynIndulge=2000052]="P_Role_SynIndulge",e[e.P_Role_IndulgeLogout=2000053]="P_Role_IndulgeLogout",e[e.P_Role_TotalWatchADBoxData=2000054]="P_Role_TotalWatchADBoxData",e[e.P_Role_TotalWatchADBoxReceivePrize=2000055]="P_Role_TotalWatchADBoxReceivePrize",e[e.P_Role_BossDropItems=2000056]="P_Role_BossDropItems",e[e.P_Role_UpdateChapter=2000057]="P_Role_UpdateChapter",e[e.P_Role_GetChapterReward=2000058]="P_Role_GetChapterReward",e[e.P_Role_SoloDropItems=2000059]="P_Role_SoloDropItems",e[e.P_Role_SyncDrawPrize=2000060]="P_Role_SyncDrawPrize",e[e.P_Role_DrawPrize=2000061]="P_Role_DrawPrize",e[e.P_Role_SynRandShopData=2000062]="P_Role_SynRandShopData",e[e.P_Role_GetRandShop=2000063]="P_Role_GetRandShop",e[e.P_Role_RandShopBuy=2000064]="P_Role_RandShopBuy",e[e.P_Role_RandShopRefresh=2000065]="P_Role_RandShopRefresh",e[e.P_Role_ModifyRoleName=2000066]="P_Role_ModifyRoleName",e[e.P_Role_SynRandRechargeData=2000067]="P_Role_SynRandRechargeData",e[e.P_Role_GetRandRecharge=2000068]="P_Role_GetRandRecharge",e[e.P_Role_RandRechargeRefresh=2000069]="P_Role_RandRechargeRefresh",e[e.P_Role_GetLegendReward=2000070]="P_Role_GetLegendReward",e[e.P_Role_SynTaskExtraData=2000071]="P_Role_SynTaskExtraData",e[e.P_Role_TakeTask=2000072]="P_Role_TakeTask",e[e.P_Role_ClientTaskAddCount=2000073]="P_Role_ClientTaskAddCount",e[e.P_Role_ClientTaskAddAdvert=2000074]="P_Role_ClientTaskAddAdvert",e[e.P_Role_TakeTaskBox=2000075]="P_Role_TakeTaskBox",e[e.P_Role_ReplaceRandTask=2000076]="P_Role_ReplaceRandTask",e[e.P_Role_HeadUp=2000077]="P_Role_HeadUp",e[e.P_Role_HeadFrameUp=2000078]="P_Role_HeadFrameUp",e[e.P_Role_HeadFrameDown=2000079]="P_Role_HeadFrameDown",e[e.P_Role_SetUrlHead=2000080]="P_Role_SetUrlHead",e[e.P_Role_Add_Fight_Cooperation_Num=2000081]="P_Role_Add_Fight_Cooperation_Num",e[e.P_Role_Buy_Fight_Cooperation_Num=2000082]="P_Role_Buy_Fight_Cooperation_Num",e[e.P_Role_GetFirstRechargeReward=2000083]="P_Role_GetFirstRechargeReward",e[e.P_Role_GetPVPDoubleReward=2000084]="P_Role_GetPVPDoubleReward",e[e.P_Role_SynExpressionArrayData=2000085]="P_Role_SynExpressionArrayData",e[e.P_Role_IndulgeArrivalTime=2000086]="P_Role_IndulgeArrivalTime",e[e.P_Role_ReceiveMonthCardPrize=2000087]="P_Role_ReceiveMonthCardPrize",e[e.P_Role_SetIndulgeBirth=2000088]="P_Role_SetIndulgeBirth",e[e.P_Role_SetIndulge=2000089]="P_Role_SetIndulge",e[e.P_Role_ExpressionArrayUp=2000090]="P_Role_ExpressionArrayUp",e[e.P_Role_ExpressionArrayChange=2000091]="P_Role_ExpressionArrayChange",e[e.P_Role_FightBalanceReceiveAdditional=2000092]="P_Role_FightBalanceReceiveAdditional",e[e.P_Role_ReceiveFightWinExtra=2000093]="P_Role_ReceiveFightWinExtra",e[e.P_Role_ShareBindMaster=2000094]="P_Role_ShareBindMaster",e[e.P_Role_ShareReceiveSharePrize=2000095]="P_Role_ShareReceiveSharePrize",e[e.P_Role_ShareReceiveRankPrize=2000096]="P_Role_ShareReceiveRankPrize",e[e.P_Role_ClientBeginAdvert=2000097]="P_Role_ClientBeginAdvert",e[e.P_Role_SetCooperationExtra=2000098]="P_Role_SetCooperationExtra",e[e.P_Role_SynGrowthFundData=2000099]="P_Role_SynGrowthFundData",e[e.P_Role_GetGrowthFundData=2000100]="P_Role_GetGrowthFundData",e[e.P_Role_ClientFinishShare=2000101]="P_Role_ClientFinishShare",e[e.P_Role_ReceiveDayFirstFightWin=2000102]="P_Role_ReceiveDayFirstFightWin",e[e.P_Role_ReceiveCooperADPrize=2000103]="P_Role_ReceiveCooperADPrize",e[e.P_Role_SynForbidChatTimeRemaining=2000104]="P_Role_SynForbidChatTimeRemaining",e[e.P_Role_SynCondShareData=2000105]="P_Role_SynCondShareData",e[e.P_Role_CondShareReceivePrize=2000106]="P_Role_CondShareReceivePrize",e[e.P_Role_ShareEnter=2000107]="P_Role_ShareEnter",e[e.P_Role_ClientLog=2000108]="P_Role_ClientLog",e[e.P_Role_ReceiveFightLoserProtect=2000109]="P_Role_ReceiveFightLoserProtect",e[e.P_Role_WatchADCostGold=2000110]="P_Role_WatchADCostGold",e[e.P_Role_BattlePass_GetReward=2000111]="P_Role_BattlePass_GetReward",e[e.P_Role_DrawBox_GetReward=2000112]="P_Role_DrawBox_GetReward",e[e.P_Role_Cost_Get=2000113]="P_Role_Cost_Get",e[e.P_Role_ShowJumpWeiXinApp=2000114]="P_Role_ShowJumpWeiXinApp",e[e.P_Role_WeiXinAnalyzingMessage=2000115]="P_Role_WeiXinAnalyzingMessage",e[e.P_Role_Live_Begin=2000116]="P_Role_Live_Begin",e[e.P_Role_Live_Update=2000117]="P_Role_Live_Update",e[e.P_Role_WeiXinGetAnchorData=2000118]="P_Role_WeiXinGetAnchorData",e[e.P_Role_ItemChatBubbleUp=2000119]="P_Role_ItemChatBubbleUp",e[e.P_Role_SyncSecKillRecharge=2000120]="P_Role_SyncSecKillRecharge",e[e.P_Role_OnOffDataInfo=2000121]="P_Role_OnOffDataInfo",e[e.P_Role_Live_CreateRoom_ActivityID=2000122]="P_Role_Live_CreateRoom_ActivityID",e[e.P_Role_Live_SyncQuery=2000123]="P_Role_Live_SyncQuery",e[e.P_Role_MiYaIndulge=2000124]="P_Role_MiYaIndulge",e[e.P_Role_ClientTaskUpdateCount=2000125]="P_Role_ClientTaskUpdateCount",e[e.P_Role_Get_Server_Time=2000126]="P_Role_Get_Server_Time",e[e.P_Role_Cooperation_Sweep=2000127]="P_Role_Cooperation_Sweep",e[e.P_Role_SynLuckyGift=2000128]="P_Role_SynLuckyGift",e[e.P_Role_SelectLuckyGift=2000129]="P_Role_SelectLuckyGift",e[e.P_Role_ChangeEquip=2000130]="P_Role_ChangeEquip",e[e.P_Role_SyncCostGet=2000131]="P_Role_SyncCostGet",e[e.P_Role_PetUp=2000132]="P_Role_PetUp",e[e.P_Role_Day_Recharge_Select=2000133]="P_Role_Day_Recharge_Select",e[e.P_Role_BattlePass_Select=2000134]="P_Role_BattlePass_Select",e[e.P_Role_Reboot_Client=2000135]="P_Role_Reboot_Client",e[e.P_Role_QQHall_GetReward=2000136]="P_Role_QQHall_GetReward",e[e.P_Role_QQHall_RefreshBlueData=2000137]="P_Role_QQHall_RefreshBlueData",e[e.P_Role_Car_Skin_Change=2000138]="P_Role_Car_Skin_Change",e[e.P_Role_Push_Gift=2000139]="P_Role_Push_Gift",e[e.P_Role_Get_Item_Num=2000140]="P_Role_Get_Item_Num",e[e.P_Role_Chat_Status=2000141]="P_Role_Chat_Status",e[e.P_Role_Continue_Recharge_GetReward=2000142]="P_Role_Continue_Recharge_GetReward",e[e.P_Role_GetSubscribeData=2000143]="P_Role_GetSubscribeData",e[e.P_Role_SetSubscribe=2000144]="P_Role_SetSubscribe",e[e.P_Role_SetLocaltionInfo=2000145]="P_Role_SetLocaltionInfo",e[e.P_Role_ProficiencyShare=2000146]="P_Role_ProficiencyShare",e[e.P_Role_SyncProficiencyData=2000147]="P_Role_SyncProficiencyData",e[e.P_Role_SendCarHpToServer=2000148]="P_Role_SendCarHpToServer",e[e.P_Role_SkyCastle_Recharge_Select=2000149]="P_Role_SkyCastle_Recharge_Select",e[e.P_Role_UseChooseBox=2000150]="P_Role_UseChooseBox",e[e.P_Role_HeroChangeSkin=2000151]="P_Role_HeroChangeSkin",e[e.P_Role_SetSelfSelect=2000152]="P_Role_SetSelfSelect",e[e.P_Role_SetBattleArrayName=2000153]="P_Role_SetBattleArrayName",e[e.P_Role_GetScoreFundRewards=2000154]="P_Role_GetScoreFundRewards",e[e.P_Role_SynChapterData=2000155]="P_Role_SynChapterData",e[e.P_Role_Call_Php=2000156]="P_Role_Call_Php",e[e.P_Role_SyncNewerThreeDaysGift=2000157]="P_Role_SyncNewerThreeDaysGift",e[e.P_Role_Continue_Recharge_GetReward_2=2000158]="P_Role_Continue_Recharge_GetReward_2"})(o.ROLE_CLIENT_ENUM||(o.ROLE_CLIENT_ENUM={}));var p=function(){function e(){this.year=0,this.month=0,this.day=0,this.hour=0,this.minnute=0,this.second=0,this.weedDay=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<28||(this.year=e.getInt32(),this.month=e.getInt32(),this.day=e.getInt32(),this.hour=e.getInt32(),this.minnute=e.getInt32(),this.second=e.getInt32(),this.weedDay=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.year),e.setInt32(this.month),e.setInt32(this.day),e.setInt32(this.hour),e.setInt32(this.minnute),e.setInt32(this.second),e.setInt32(this.weedDay)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Game_Time=p;var f=function(){function e(){this.maxRound=0,this.winNum=0,this.lostNum=0,this.totalWinNum=0,this.totalLostNum=0,this.seriesWinNum=0,this.seriesLostNum=0,this.winlostResetNum=0,this.additionalDayNum=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<36||(this.maxRound=e.getInt32(),this.winNum=e.getInt32(),this.lostNum=e.getInt32(),this.totalWinNum=e.getInt32(),this.totalLostNum=e.getInt32(),this.seriesWinNum=e.getInt32(),this.seriesLostNum=e.getInt32(),this.winlostResetNum=e.getInt32(),this.additionalDayNum=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.maxRound),e.setInt32(this.winNum),e.setInt32(this.lostNum),e.setInt32(this.totalWinNum),e.setInt32(this.totalLostNum),e.setInt32(this.seriesWinNum),e.setInt32(this.seriesLostNum),e.setInt32(this.winlostResetNum),e.setInt32(this.additionalDayNum)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Information_FightTypeData=f;var g=function(){function e(){this.typeData=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();if(e.getLen()-e.getPos()<40*t)return!1;this.typeData.clear();for(var o=0;o<t;++o){var i;i=e.getInt32();var a=new f;if(!a.read(e))return!1;this.typeData.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setUint32(this.typeData.size),this.typeData.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Information_FightData=g;var m=function(){function e(){this.fightData=new g,this.encourageNum=0,this.encourageDayNum=0,this.encourageTime=0,this.cooperationDayLeftNum=0,this.cooperationDayWatchAdNum=0,this.supportBoxNum=0,this.supportBoxDayNum=0,this.supportBoxLastTime=0,this.cooperationDayBuyNum=0,this.cooperationDayGiveNum=0,this.cooperationDayNum=0,this.fightLoserProtectDayNum=0,this.fightLoserDecScore=0,this.fightWinDayNum=0,this.fightWinExtra=!1,this.weekCardAddCooperationExtraNum=0,this.cooperationExtra=!1,this.usedCooperationLastExtraEnd=!1,this.dayFirstWinNum=0,this.dayFirstIsWin=!1,this.cooperADNum=0,this.cooperADRoundNum=0,this.isGetFirstRechargeReward=!1,this.fightLookADDoubleCount=0,this.cooperationDayHelpNum=0,this.qqHallBlueVipVector=[],this.qqHallRewardsVector=[],this.heroSkinMap=new i.ObjMap,this.selfSelectMap=new i.ObjMap}return e.prototype.read=function(e){if(!this.fightData.read(e))return!1;if(e.getLen()-e.getPos()<89)return!1;this.encourageNum=e.getInt32(),this.encourageDayNum=e.getInt32(),this.encourageTime=e.getInt32(),this.cooperationDayLeftNum=e.getInt32(),this.cooperationDayWatchAdNum=e.getInt32(),this.supportBoxNum=e.getInt32(),this.supportBoxDayNum=e.getInt32(),this.supportBoxLastTime=e.getInt32(),this.cooperationDayBuyNum=e.getInt32(),this.cooperationDayGiveNum=e.getInt32(),this.cooperationDayNum=e.getInt32(),this.fightLoserProtectDayNum=e.getInt32(),this.fightLoserDecScore=e.getInt32(),this.fightWinDayNum=e.getInt32(),this.fightWinExtra=e.getBool(),this.weekCardAddCooperationExtraNum=e.getInt32(),this.cooperationExtra=e.getBool(),this.usedCooperationLastExtraEnd=e.getBool(),this.dayFirstWinNum=e.getInt32(),this.dayFirstIsWin=e.getBool(),this.cooperADNum=e.getInt32(),this.cooperADRoundNum=e.getInt32(),this.isGetFirstRechargeReward=e.getBool(),this.fightLookADDoubleCount=e.getInt32(),this.cooperationDayHelpNum=e.getInt32();var t=e.getUint32();if(e.getLen()-e.getPos()<4*t)return!1;this.qqHallBlueVipVector=[];for(var o=0;o<t;++o){var i;i=e.getInt32(),this.qqHallBlueVipVector.push(i)}if(e.getLen()-e.getPos()<4)return!1;var a=e.getUint32();this.qqHallRewardsVector=[];for(var n=0;n<a;++n){var r;if(e.getLen()-e.getPos()<4)return!1;var s=e.getUint32();if(e.getLen()-e.getPos()<s)return!1;r=e.getString(s),this.qqHallRewardsVector.push(r)}if(e.getLen()-e.getPos()<4)return!1;var c=e.getUint32();if(e.getLen()-e.getPos()<12*c)return!1;this.heroSkinMap.clear();for(var l=0;l<c;++l){var d,u;d=e.getLong(),u=e.getInt32(),this.heroSkinMap.set(d,u)}if(e.getLen()-e.getPos()<4)return!1;var h=e.getUint32();if(e.getLen()-e.getPos()<8*h)return!1;this.selfSelectMap.clear();for(var p=0;p<h;++p){var f,g;f=e.getInt32(),g=e.getInt32(),this.selfSelectMap.set(f,g)}return!0},e.prototype.writeNoEnd=function(e){this.fightData.writeNoEnd(e),e.setInt32(this.encourageNum),e.setInt32(this.encourageDayNum),e.setInt32(this.encourageTime),e.setInt32(this.cooperationDayLeftNum),e.setInt32(this.cooperationDayWatchAdNum),e.setInt32(this.supportBoxNum),e.setInt32(this.supportBoxDayNum),e.setInt32(this.supportBoxLastTime),e.setInt32(this.cooperationDayBuyNum),e.setInt32(this.cooperationDayGiveNum),e.setInt32(this.cooperationDayNum),e.setInt32(this.fightLoserProtectDayNum),e.setInt32(this.fightLoserDecScore),e.setInt32(this.fightWinDayNum),e.setBool(this.fightWinExtra),e.setInt32(this.weekCardAddCooperationExtraNum),e.setBool(this.cooperationExtra),e.setBool(this.usedCooperationLastExtraEnd),e.setInt32(this.dayFirstWinNum),e.setBool(this.dayFirstIsWin),e.setInt32(this.cooperADNum),e.setInt32(this.cooperADRoundNum),e.setBool(this.isGetFirstRechargeReward),e.setInt32(this.fightLookADDoubleCount),e.setInt32(this.cooperationDayHelpNum),e.setUint32(this.qqHallBlueVipVector.length),this.qqHallBlueVipVector.forEach(function(t){e.setInt32(t)}),e.setUint32(this.qqHallRewardsVector.length),this.qqHallRewardsVector.forEach(function(t){e.setString(t)}),e.setUint32(this.heroSkinMap.size),this.heroSkinMap.forEach(function(t,o){e.setLong(o),e.setInt32(t)}),e.setUint32(this.selfSelectMap.size),this.selfSelectMap.forEach(function(t,o){e.setInt32(o),e.setInt32(t)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Information_Data=m;var _=function(){function e(){this.intMap=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();if(e.getLen()-e.getPos()<8*t)return!1;this.intMap.clear();for(var o=0;o<t;++o){var i,a;i=e.getInt32(),a=e.getInt32(),this.intMap.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setUint32(this.intMap.size),this.intMap.forEach(function(t,o){e.setInt32(o),e.setInt32(t)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Client_Data=_;var y=function(){function e(){this.bFirstPrize=!1,this.totalNum=0,this.dayNum=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<9||(this.bFirstPrize=e.getBool(),this.totalNum=e.getInt32(),this.dayNum=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setBool(this.bFirstPrize),e.setInt32(this.totalNum),e.setInt32(this.dayNum)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Role_Recharge_Single=y;var v=function(){function e(){this.recharges=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();if(e.getLen()-e.getPos()<13*t)return!1;this.recharges.clear();for(var o=0;o<t;++o){var i;i=e.getInt32();var a=new y;if(!a.read(e))return!1;this.recharges.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setUint32(this.recharges.size),this.recharges.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Role_Recharge_Data=v;var C=function(){function e(){this.itemNum=0,this.compensateVec=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.itemNum=e.getInt32();var t=e.getUint32();this.compensateVec=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.compensateVec.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.itemNum),e.setUint32(this.compensateVec.length),this.compensateVec.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Role_Item_Compensate=C;var S=function(){function e(){this.ItemUUID=a.fromValue(0),this.itemID=0,this.ownUUID=a.fromValue(0),this.createTime=0,this.expiryCDTime=0,this.itemName="",this.itemNum=1,this.itemPos=0,this.itemLevel=1,this.itemExp=0}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<32)return!1;this.ItemUUID=e.getLong(),this.itemID=e.getInt32(),this.ownUUID=e.getLong(),this.createTime=e.getInt32(),this.expiryCDTime=e.getInt32();var t=e.getUint32();return!(e.getLen()-e.getPos()<t||(this.itemName=e.getString(t),e.getLen()-e.getPos()<16||(this.itemNum=e.getInt32(),this.itemPos=e.getInt32(),this.itemLevel=e.getInt32(),this.itemExp=e.getInt32(),0)))},e.prototype.writeNoEnd=function(e){e.setLong(this.ItemUUID),e.setInt32(this.itemID),e.setLong(this.ownUUID),e.setInt32(this.createTime),e.setInt32(this.expiryCDTime),e.setString(this.itemName),e.setInt32(this.itemNum),e.setInt32(this.itemPos),e.setInt32(this.itemLevel),e.setInt32(this.itemExp)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Role_Item=S;var T=function(){function e(){this.items=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();this.items.clear();for(var o=0;o<t;++o){var i;i=e.getLong();var a=new S;if(!a.read(e))return!1;this.items.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setUint32(this.items.size),this.items.forEach(function(t,o){e.setLong(o),t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Role_Bag=T;var I=function(){function e(){this.annex=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();this.annex=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.annex.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setUint32(this.annex.length),this.annex.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Role_MailAnnex=I;var N=function(){function e(){this.mailUUID=a.fromValue(0),this.mailId=0,this.createTime=0,this.state=0,this.title="",this.fromName="",this.msg="",this.annex=new I}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<24)return!1;this.mailUUID=e.getLong(),this.mailId=e.getInt32(),this.createTime=e.getInt32(),this.state=e.getInt32();var t=e.getUint32();if(e.getLen()-e.getPos()<t)return!1;if(this.title=e.getString(t),e.getLen()-e.getPos()<4)return!1;var o=e.getUint32();if(e.getLen()-e.getPos()<o)return!1;if(this.fromName=e.getString(o),e.getLen()-e.getPos()<4)return!1;var i=e.getUint32();return!(e.getLen()-e.getPos()<i||(this.msg=e.getString(i),!this.annex.read(e)))},e.prototype.writeNoEnd=function(e){e.setLong(this.mailUUID),e.setInt32(this.mailId),e.setInt32(this.createTime),e.setInt32(this.state),e.setString(this.title),e.setString(this.fromName),e.setString(this.msg),this.annex.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Role_SingleMail=N;var b=function(){function e(){this.mails=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();this.mails.clear();for(var o=0;o<t;++o){var i;i=e.getLong();var a=new N;if(!a.read(e))return!1;this.mails.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setUint32(this.mails.size),this.mails.forEach(function(t,o){e.setLong(o),t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Role_Mail=b;var w=function(){function e(){this.delNum=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.delNum=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.delNum)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Role_ItemInfo_Day=w;var E=function(){function e(){this.day=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();if(e.getLen()-e.getPos()<8*t)return!1;this.day.clear();for(var o=0;o<t;++o){var i;i=e.getInt32();var a=new w;if(!a.read(e))return!1;this.day.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setUint32(this.day.size),this.day.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Role_ItemInfo=E;var P=function(){function e(){this.taskID=0,this.taskState=0,this.taskCount=0,this.taskCDTime=0,this.extraState=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<20||(this.taskID=e.getInt32(),this.taskState=e.getInt32(),this.taskCount=e.getInt32(),this.taskCDTime=e.getInt32(),this.extraState=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.taskID),e.setInt32(this.taskState),e.setInt32(this.taskCount),e.setInt32(this.taskCDTime),e.setInt32(this.extraState)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Role_SingleTask=P;var R=function(){function e(){this.bTake=!1}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<1||(this.bTake=e.getBool(),0))},e.prototype.writeNoEnd=function(e){e.setBool(this.bTake)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Task_Box_Data=R;var L=function(){function e(){this.boxs=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();if(e.getLen()-e.getPos()<5*t)return!1;this.boxs.clear();for(var o=0;o<t;++o){var i;i=e.getInt32();var a=new R;if(!a.read(e))return!1;this.boxs.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setUint32(this.boxs.size),this.boxs.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Task_Group_Data=L;var A=function(){function e(){this.taskID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.taskID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.taskID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Task_Rand_Task_Data=A;var D=function(){function e(){}return e.prototype.read=function(){return!0},e.prototype.writeNoEnd=function(){},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Task_Rand_History_Task_Data=D;var M=function(){function e(){this.tasks=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();if(e.getLen()-e.getPos()<4*t)return!1;this.tasks.clear();for(var o=0;o<t;++o){var i;i=e.getInt32();var a=new D;if(!a.read(e))return!1;this.tasks.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setUint32(this.tasks.size),this.tasks.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Task_Rand_History_Data=M;var B=function(){function e(){this.taskgroup=new i.ObjMap,this.randTask=new i.ObjMap,this.replaceRandTaskNum=0,this.randTaskHistory=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();this.taskgroup.clear();for(var o=0;o<t;++o){var i;i=e.getInt32();var a=new L;if(!a.read(e))return!1;this.taskgroup.set(i,a)}if(e.getLen()-e.getPos()<4)return!1;var n=e.getUint32();if(e.getLen()-e.getPos()<8*n)return!1;this.randTask.clear();for(var r=0;r<n;++r){var s;s=e.getInt32();var c=new A;if(!c.read(e))return!1;this.randTask.set(s,c)}if(e.getLen()-e.getPos()<8)return!1;this.replaceRandTaskNum=e.getInt32();var l=e.getUint32();this.randTaskHistory=[];for(var d=0;d<l;++d){var u=new M;if(!u.read(e))return!1;this.randTaskHistory.push(u)}return!0},e.prototype.writeNoEnd=function(e){e.setUint32(this.taskgroup.size),this.taskgroup.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)}),e.setUint32(this.randTask.size),this.randTask.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)}),e.setInt32(this.replaceRandTaskNum),e.setUint32(this.randTaskHistory.length),this.randTaskHistory.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Task_Extra_Data=B;var k=function(){function e(){this.tasks=new i.ObjMap,this.extra=new B}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();if(e.getLen()-e.getPos()<24*t)return!1;this.tasks.clear();for(var o=0;o<t;++o){var i;i=e.getInt32();var a=new P;if(!a.read(e))return!1;this.tasks.set(i,a)}return!!this.extra.read(e)},e.prototype.writeNoEnd=function(e){e.setUint32(this.tasks.size),this.tasks.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)}),this.extra.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Role_Task=k;var G=function(){function e(){}return e.prototype.read=function(){return!0},e.prototype.writeNoEnd=function(){},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_RoleEnterLogic=G;var O=function(){function e(){this.clientVer=""}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();return!(e.getLen()-e.getPos()<t||(this.clientVer=e.getString(t),0))},e.prototype.writeNoEnd=function(e){e.setString(this.clientVer)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_SynRoleData=O;var H=function(){function e(){this.exchangeID=0,this.totleNum=0,this.dayNum=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<12||(this.exchangeID=e.getInt32(),this.totleNum=e.getInt32(),this.dayNum=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.exchangeID),e.setInt32(this.totleNum),e.setInt32(this.dayNum)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Role_ExchangeItem=H;var V=function(){function e(){this.groupID=0,this.exchanges=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.groupID=e.getInt32();var t=e.getUint32();if(e.getLen()-e.getPos()<16*t)return!1;this.exchanges.clear();for(var o=0;o<t;++o){var i;i=e.getInt32();var a=new H;if(!a.read(e))return!1;this.exchanges.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.groupID),e.setUint32(this.exchanges.size),this.exchanges.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Role_ExchangeGroup=V;var F=function(){function e(){this.groups=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();this.groups.clear();for(var o=0;o<t;++o){var i;i=e.getInt32();var a=new V;if(!a.read(e))return!1;this.groups.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setUint32(this.groups.size),this.groups.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Role_ExchangeData=F;var U=function(){function e(){this.heroUUID=a.fromValue(0)}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.heroUUID=e.getLong(),0))},e.prototype.writeNoEnd=function(e){e.setLong(this.heroUUID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Role_BattleArrayIndexData=U;var x=function(){function e(){this.itemID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.itemID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.itemID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Role_BattleRuneIndexData=x;var Y=function(){function e(){this.indexData=new i.ObjMap,this.runeIndexData=new i.ObjMap,this.battleArray=""}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();if(e.getLen()-e.getPos()<12*t)return!1;this.indexData.clear();for(var o=0;o<t;++o){var i;i=e.getInt32();var a=new U;if(!a.read(e))return!1;this.indexData.set(i,a)}if(e.getLen()-e.getPos()<4)return!1;var n=e.getUint32();if(e.getLen()-e.getPos()<8*n)return!1;this.runeIndexData.clear();for(var r=0;r<n;++r){var s;s=e.getInt32();var c=new x;if(!c.read(e))return!1;this.runeIndexData.set(s,c)}if(e.getLen()-e.getPos()<4)return!1;var l=e.getUint32();return!(e.getLen()-e.getPos()<l||(this.battleArray=e.getString(l),0))},e.prototype.writeNoEnd=function(e){e.setUint32(this.indexData.size),this.indexData.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)}),e.setUint32(this.runeIndexData.size),this.runeIndexData.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)}),e.setString(this.battleArray)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Role_BattleArrayIDData=Y;var j=function(){function e(){this.defineID=0,this.idData=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.defineID=e.getInt32();var t=e.getUint32();this.idData.clear();for(var o=0;o<t;++o){var i;i=e.getInt32();var a=new Y;if(!a.read(e))return!1;this.idData.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.defineID),e.setUint32(this.idData.size),this.idData.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Role_BattleArrayData=j;var W=function(){function e(){this.expressionUUID=a.fromValue(0)}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.expressionUUID=e.getLong(),0))},e.prototype.writeNoEnd=function(e){e.setLong(this.expressionUUID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Role_ExpressionArrayIndexData=W;var z=function(){function e(){this.arrayData=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();if(e.getLen()-e.getPos()<12*t)return!1;this.arrayData.clear();for(var o=0;o<t;++o){var i;i=e.getInt32();var a=new W;if(!a.read(e))return!1;this.arrayData.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setUint32(this.arrayData.size),this.arrayData.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Role_ExpressionArrayData=z;var K=function(){function e(){this.takedInfo=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();if(e.getLen()-e.getPos()<8*t)return!1;this.takedInfo.clear();for(var o=0;o<t;++o){var i,a;i=e.getInt32(),a=e.getInt32(),this.takedInfo.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setUint32(this.takedInfo.size),this.takedInfo.forEach(function(t,o){e.setInt32(o),e.setInt32(t)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Role_ScoreAchievementSingle=K;var q=function(){function e(){this.scoreAchievements=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();this.scoreAchievements.clear();for(var o=0;o<t;++o){var i;i=e.getInt32();var a=new K;if(!a.read(e))return!1;this.scoreAchievements.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setUint32(this.scoreAchievements.size),this.scoreAchievements.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Role_ScoreAchievement=q;var Q=function(){function e(){this.shopItemID=0,this.buyNum=0,this.replaceNeedNum=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<12||(this.shopItemID=e.getInt32(),this.buyNum=e.getInt32(),this.replaceNeedNum=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.shopItemID),e.setInt32(this.buyNum),e.setInt32(this.replaceNeedNum)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_RandShopPositionData=Q;var X=function(){function e(){this.positions=new i.ObjMap,this.dayRefreshNum=0,this.dayCDTime=0}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();if(e.getLen()-e.getPos()<16*t)return!1;this.positions.clear();for(var o=0;o<t;++o){var i;i=e.getInt32();var a=new Q;if(!a.read(e))return!1;this.positions.set(i,a)}return!(e.getLen()-e.getPos()<8||(this.dayRefreshNum=e.getInt32(),this.dayCDTime=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setUint32(this.positions.size),this.positions.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)}),e.setInt32(this.dayRefreshNum),e.setInt32(this.dayCDTime)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_RandShopIDData=X;var J=function(){function e(){this.buyNum=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.buyNum=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.buyNum)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_RandRechargeUnit=J;var Z=function(){function e(){this.groupID=0,this.nextRefreshCDTime=0,this.units=new i.ObjMap,this.dayHandRefreshNum=0,this.nextHandRefreshCD=0}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<12)return!1;this.groupID=e.getInt32(),this.nextRefreshCDTime=e.getInt32();var t=e.getUint32();if(e.getLen()-e.getPos()<8*t)return!1;this.units.clear();for(var o=0;o<t;++o){var i;i=e.getInt32();var a=new J;if(!a.read(e))return!1;this.units.set(i,a)}return!(e.getLen()-e.getPos()<8||(this.dayHandRefreshNum=e.getInt32(),this.nextHandRefreshCD=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.groupID),e.setInt32(this.nextRefreshCDTime),e.setUint32(this.units.size),this.units.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)}),e.setInt32(this.dayHandRefreshNum),e.setInt32(this.nextHandRefreshCD)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_RandRechargeGroup=Z;var $=function(){function e(){this.bReceivePrize=!1,this.bReceiveExtra=!1}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<2||(this.bReceivePrize=e.getBool(),this.bReceiveExtra=e.getBool(),0))},e.prototype.writeNoEnd=function(e){e.setBool(this.bReceivePrize),e.setBool(this.bReceiveExtra)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_SignInDayData=$;var ee=function(){function e(){this.days=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();if(e.getLen()-e.getPos()<6*t)return!1;this.days.clear();for(var o=0;o<t;++o){var i;i=e.getInt32();var a=new $;if(!a.read(e))return!1;this.days.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setUint32(this.days.size),this.days.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_SignInData=ee;var te=function(){function e(){this.boxNum=0,this.cdTime=0,this.dayNum=0,this.receiveCD=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<16||(this.boxNum=e.getInt32(),this.cdTime=e.getInt32(),this.dayNum=e.getInt32(),this.receiveCD=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.boxNum),e.setInt32(this.cdTime),e.setInt32(this.dayNum),e.setInt32(this.receiveCD)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_TimeBoxSingleData=te;var oe=function(){function e(){this.boxs=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();if(e.getLen()-e.getPos()<20*t)return!1;this.boxs.clear();for(var o=0;o<t;++o){var i;i=e.getInt32();var a=new te;if(!a.read(e))return!1;this.boxs.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setUint32(this.boxs.size),this.boxs.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_TimeBoxData=oe;var ie=function(){function e(){this.isPrize=!1,this.isRechargePrize=!1}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<2||(this.isPrize=e.getBool(),this.isRechargePrize=e.getBool(),0))},e.prototype.writeNoEnd=function(e){e.setBool(this.isPrize),e.setBool(this.isRechargePrize)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_ThemeBoxEntityLevelData=ie;var ae=function(){function e(){this.boxID=0,this.boxBeginTime=0,this.boxEndTime=0,this.boxLevel=0,this.boxExp=0,this.isRecharge=!1,this.levelData=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<25)return!1;this.boxID=e.getInt32(),this.boxBeginTime=e.getInt32(),this.boxEndTime=e.getInt32(),this.boxLevel=e.getInt32(),this.boxExp=e.getInt32(),this.isRecharge=e.getBool();var t=e.getUint32();if(e.getLen()-e.getPos()<6*t)return!1;this.levelData.clear();for(var o=0;o<t;++o){var i;i=e.getInt32();var a=new ie;if(!a.read(e))return!1;this.levelData.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.boxID),e.setInt32(this.boxBeginTime),e.setInt32(this.boxEndTime),e.setInt32(this.boxLevel),e.setInt32(this.boxExp),e.setBool(this.isRecharge),e.setUint32(this.levelData.size),this.levelData.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_ThemeBoxEntityData=ae;var ne=function(){function e(){this.entity=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();this.entity.clear();for(var o=0;o<t;++o){var i;i=e.getInt32();var a=new ae;if(!a.read(e))return!1;this.entity.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setUint32(this.entity.size),this.entity.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_ThemeBoxData=ne;var re=function(){function e(){this.isPrize=!1,this.isExtra=!1}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<2||(this.isPrize=e.getBool(),this.isExtra=e.getBool(),0))},e.prototype.writeNoEnd=function(e){e.setBool(this.isPrize),e.setBool(this.isExtra)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_SeasonForeverScorePrizeData=re;var se=function(){function e(){this.isPrize=!1,this.isExtra=!1}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<2||(this.isPrize=e.getBool(),this.isExtra=e.getBool(),0))},e.prototype.writeNoEnd=function(e){e.setBool(this.isPrize),e.setBool(this.isExtra)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_SeasonScorePrizeData=se;var ce=function(){function e(){this.seasonID=0,this.seasonBeginTime=0,this.seasonEndTime=0,this.foreverScorePrize=new i.ObjMap,this.scorePrize=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<16)return!1;this.seasonID=e.getInt32(),this.seasonBeginTime=e.getInt32(),this.seasonEndTime=e.getInt32();var t=e.getUint32();if(e.getLen()-e.getPos()<6*t)return!1;this.foreverScorePrize.clear();for(var o=0;o<t;++o){var i;i=e.getInt32();var a=new re;if(!a.read(e))return!1;this.foreverScorePrize.set(i,a)}if(e.getLen()-e.getPos()<4)return!1;var n=e.getUint32();if(e.getLen()-e.getPos()<6*n)return!1;this.scorePrize.clear();for(var r=0;r<n;++r){var s;s=e.getInt32();var c=new se;if(!c.read(e))return!1;this.scorePrize.set(s,c)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.seasonID),e.setInt32(this.seasonBeginTime),e.setInt32(this.seasonEndTime),e.setUint32(this.foreverScorePrize.size),this.foreverScorePrize.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)}),e.setUint32(this.scorePrize.size),this.scorePrize.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_SeasonEntityData=ce;var le=function(){function e(){this.seasonID=0,this.score=0,this.seasonMinScore=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<12||(this.seasonID=e.getInt32(),this.score=e.getInt32(),this.seasonMinScore=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.seasonID),e.setInt32(this.score),e.setInt32(this.seasonMinScore)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_SeasonLastData=le;var de=function(){function e(){this.entity=new i.ObjMap,this.last=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();this.entity.clear();for(var o=0;o<t;++o){var i;i=e.getInt32();var a=new ce;if(!a.read(e))return!1;this.entity.set(i,a)}if(e.getLen()-e.getPos()<4)return!1;var n=e.getUint32();if(e.getLen()-e.getPos()<16*n)return!1;this.last.clear();for(var r=0;r<n;++r){var s;s=e.getInt32();var c=new le;if(!c.read(e))return!1;this.last.set(s,c)}return!0},e.prototype.writeNoEnd=function(e){e.setUint32(this.entity.size),this.entity.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)}),e.setUint32(this.last.size),this.last.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_SeasonData=de;var ue=function(){function e(){}return e.prototype.read=function(){return!0},e.prototype.writeNoEnd=function(){},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_SharePlayerRankData=ue;var he=function(){function e(){this.isReceive=!1}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<1||(this.isReceive=e.getBool(),0))},e.prototype.writeNoEnd=function(e){e.setBool(this.isReceive)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_ShareRankPrizeData=he;var pe=function(){function e(){this.bindTime=0,this.refreshTime=0,this.nickName="",this.headID=0,this.headUrl="",this.headFrameID=0,this.maxScore=0,this.isSharePrize=!1,this.rankPrize=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<12)return!1;this.bindTime=e.getInt32(),this.refreshTime=e.getInt32();var t=e.getUint32();if(e.getLen()-e.getPos()<t)return!1;if(this.nickName=e.getString(t),e.getLen()-e.getPos()<8)return!1;this.headID=e.getInt32();var o=e.getUint32();if(e.getLen()-e.getPos()<o)return!1;if(this.headUrl=e.getString(o),e.getLen()-e.getPos()<13)return!1;this.headFrameID=e.getInt32(),this.maxScore=e.getInt32(),this.isSharePrize=e.getBool();var i=e.getUint32();if(e.getLen()-e.getPos()<5*i)return!1;this.rankPrize.clear();for(var a=0;a<i;++a){var n;n=e.getInt32();var r=new he;if(!r.read(e))return!1;this.rankPrize.set(n,r)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.bindTime),e.setInt32(this.refreshTime),e.setString(this.nickName),e.setInt32(this.headID),e.setString(this.headUrl),e.setInt32(this.headFrameID),e.setInt32(this.maxScore),e.setBool(this.isSharePrize),e.setUint32(this.rankPrize.size),this.rankPrize.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_SharePlayerData=pe;var fe=function(){function e(){this.ranks=new i.ObjMap,this.players=new i.ObjMap,this.daySharePrizeNum=0}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();if(e.getLen()-e.getPos()<8*t)return!1;this.ranks.clear();for(var o=0;o<t;++o){var i;i=e.getLong();var a=new ue;if(!a.read(e))return!1;this.ranks.set(i,a)}if(e.getLen()-e.getPos()<4)return!1;var n=e.getUint32();this.players.clear();for(var r=0;r<n;++r){var s;s=e.getLong();var c=new pe;if(!c.read(e))return!1;this.players.set(s,c)}return!(e.getLen()-e.getPos()<4||(this.daySharePrizeNum=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setUint32(this.ranks.size),this.ranks.forEach(function(t,o){e.setLong(o),t.writeNoEnd(e)}),e.setUint32(this.players.size),this.players.forEach(function(t,o){e.setLong(o),t.writeNoEnd(e)}),e.setInt32(this.daySharePrizeNum)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_ShareData=fe;var ge=function(){function e(){this.showData=new c,this.totalHarm=a.fromValue(0)}return e.prototype.read=function(e){return!(!this.showData.read(e)||e.getLen()-e.getPos()<8||(this.totalHarm=e.getLong(),0))},e.prototype.writeNoEnd=function(e){this.showData.writeNoEnd(e),e.setLong(this.totalHarm)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_FightRecordRoleData=ge;var me=function(){function e(){this.fightTime=0,this.fightType=0,this.isWin=!1,this.score=0,this.scoreChange=0,this.roleInfo=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<21)return!1;this.fightTime=e.getInt32(),this.fightType=e.getInt32(),this.isWin=e.getBool(),this.score=e.getInt32(),this.scoreChange=e.getInt32();var t=e.getUint32();this.roleInfo.clear();for(var o=0;o<t;++o){var i;i=e.getLong();var a=new ge;if(!a.read(e))return!1;this.roleInfo.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.fightTime),e.setInt32(this.fightType),e.setBool(this.isWin),e.setInt32(this.score),e.setInt32(this.scoreChange),e.setUint32(this.roleInfo.size),this.roleInfo.forEach(function(t,o){e.setLong(o),t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_FightRecordBattleData=me;var _e=function(){function e(){this.fightTime=0,this.fightType=0,this.round=0,this.roleIdentity=0,this.roleInfo=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<20)return!1;this.fightTime=e.getInt32(),this.fightType=e.getInt32(),this.round=e.getInt32(),this.roleIdentity=e.getInt32();var t=e.getUint32();this.roleInfo.clear();for(var o=0;o<t;++o){var i;i=e.getLong();var a=new ge;if(!a.read(e))return!1;this.roleInfo.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.fightTime),e.setInt32(this.fightType),e.setInt32(this.round),e.setInt32(this.roleIdentity),e.setUint32(this.roleInfo.size),this.roleInfo.forEach(function(t,o){e.setLong(o),t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_FightRecordCooperationData=_e;var ye=function(){function e(){this.signinRound=0,this.signinIndex=0,this.signinDay=0,this.isReceive=!1,this.isExtraReceive=!1}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<14||(this.signinRound=e.getInt32(),this.signinIndex=e.getInt32(),this.signinDay=e.getInt32(),this.isReceive=e.getBool(),this.isExtraReceive=e.getBool(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.signinRound),e.setInt32(this.signinIndex),e.setInt32(this.signinDay),e.setBool(this.isReceive),e.setBool(this.isExtraReceive)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_TotalSignInData=ye;var ve=function(){function e(){this._data=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();this._data.clear();for(var o=0;o<t;++o){var i;if(e.getLen()-e.getPos()<4)return!1;var a,n=e.getUint32();if(e.getLen()-e.getPos()<n)return!1;i=e.getString(n),a=e.getInt32(),this._data.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setUint32(this._data.size),this._data.forEach(function(t,o){e.setString(o),e.setInt32(t)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_CDKData=ve;var Ce=function(){function e(){this.watchADRound=0,this.watchADIndex=0,this.watchADDay=0,this.watchADNum=0,this.isReceive=!1,this.isExtraReceive=!1}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<18||(this.watchADRound=e.getInt32(),this.watchADIndex=e.getInt32(),this.watchADDay=e.getInt32(),this.watchADNum=e.getInt32(),this.isReceive=e.getBool(),this.isExtraReceive=e.getBool(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.watchADRound),e.setInt32(this.watchADIndex),e.setInt32(this.watchADDay),e.setInt32(this.watchADNum),e.setBool(this.isReceive),e.setBool(this.isExtraReceive)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_TotalWatchADBox=Ce;var Se=function(){function e(){this.num=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.num=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.num)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_HallofFameRoleData=Se;var Te=function(){function e(){this.Data=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();if(e.getLen()-e.getPos()<8*t)return!1;this.Data.clear();for(var o=0;o<t;++o){var i;i=e.getInt32();var a=new Se;if(!a.read(e))return!1;this.Data.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setUint32(this.Data.size),this.Data.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_HallofFameData=Te;var Ie=function(){function e(){this.headID=0,this.headUrl=""}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.headID=e.getInt32();var t=e.getUint32();return!(e.getLen()-e.getPos()<t||(this.headUrl=e.getString(t),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.headID),e.setString(this.headUrl)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_CondSharePlayer=Ie;var Ne=function(){function e(){this.beginTime=0,this.endTime=0,this.players=new i.ObjMap,this.bReceive=!1}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<12)return!1;this.beginTime=e.getInt32(),this.endTime=e.getInt32();var t=e.getUint32();this.players.clear();for(var o=0;o<t;++o){var i;i=e.getLong();var a=new Ie;if(!a.read(e))return!1;this.players.set(i,a)}return!(e.getLen()-e.getPos()<1||(this.bReceive=e.getBool(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.beginTime),e.setInt32(this.endTime),e.setUint32(this.players.size),this.players.forEach(function(t,o){e.setLong(o),t.writeNoEnd(e)}),e.setBool(this.bReceive)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_CondShare=Ne;var be=function(){function e(){this.condshares=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();this.condshares.clear();for(var o=0;o<t;++o){var i;i=e.getInt32();var a=new Ne;if(!a.read(e))return!1;this.condshares.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setUint32(this.condshares.size),this.condshares.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_CondShareData=be;var we=function(){function e(){this.level=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.level=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.level)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_SingleFinalRuneData=we;var Ee=function(){function e(){this.runes=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();if(e.getLen()-e.getPos()<8*t)return!1;this.runes.clear();for(var o=0;o<t;++o){var i;i=e.getInt32();var a=new we;if(!a.read(e))return!1;this.runes.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setUint32(this.runes.size),this.runes.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_FinalRuneData=Ee;var Pe=function(){function e(){this.boxID=0,this.boxState=0,this.stateTime=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<12||(this.boxID=e.getInt32(),this.boxState=e.getInt32(),this.stateTime=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.boxID),e.setInt32(this.boxState),e.setInt32(this.stateTime)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_TimeLockBoxPositionData=Pe;var Re=function(){function e(){this.position=new i.ObjMap,this.dayFreeFastReceiveNum=0}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();if(e.getLen()-e.getPos()<16*t)return!1;this.position.clear();for(var o=0;o<t;++o){var i;i=e.getInt32();var a=new Pe;if(!a.read(e))return!1;this.position.set(i,a)}return!(e.getLen()-e.getPos()<4||(this.dayFreeFastReceiveNum=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setUint32(this.position.size),this.position.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)}),e.setInt32(this.dayFreeFastReceiveNum)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_TimeLockBoxData=Re;var Le=function(){function e(){this.chapterId=0,this.chapterProgress=0,this.rewardBoxStateMap=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<12)return!1;this.chapterId=e.getInt32(),this.chapterProgress=e.getInt32();var t=e.getUint32();if(e.getLen()-e.getPos()<8*t)return!1;this.rewardBoxStateMap.clear();for(var o=0;o<t;++o){var i,a;i=e.getInt32(),a=e.getInt32(),this.rewardBoxStateMap.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.chapterId),e.setInt32(this.chapterProgress),e.setUint32(this.rewardBoxStateMap.size),this.rewardBoxStateMap.forEach(function(t,o){e.setInt32(o),e.setInt32(t)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Role_ChapterInfo=Le;var Ae=function(){function e(){this.currentChapterId=0,this.chapterInfoMap=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.currentChapterId=e.getInt32();var t=e.getUint32();this.chapterInfoMap.clear();for(var o=0;o<t;++o){var i;i=e.getInt32();var a=new Le;if(!a.read(e))return!1;this.chapterInfoMap.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.currentChapterId),e.setUint32(this.chapterInfoMap.size),this.chapterInfoMap.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Role_ChapterData=Ae;var De=function(){function e(){this.chapterInfoMap=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();if(e.getLen()-e.getPos()<8*t)return!1;this.chapterInfoMap.clear();for(var o=0;o<t;++o){var i,a;i=e.getInt32(),a=e.getInt32(),this.chapterInfoMap.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setUint32(this.chapterInfoMap.size),this.chapterInfoMap.forEach(function(t,o){e.setInt32(o),e.setInt32(t)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Role_LegendData=De;var Me=function(){function e(){this.currTime=0,this.roleId=a.fromValue(0),this.strId="",this.roleName="",this.bIndulge=!1,this.indulgeTime=0,this.indulgeDayOnlineTime=0,this.roleAttrValue=new i.ObjMap,this.gameTime=new p,this.information=new m,this.clientData=new _,this.recharge=new v,this.roleBag=new T,this.roleMail=new b,this.roleItemInfo=new E,this.roleTask=new k,this.exchange=new F,this.battlearray=new j,this.expressionarray=new z,this.scoreAchievement=new q,this.signin=new ee,this.timebox=new oe,this.themebox=new ne,this.season=new de,this.share=new fe,this.totalsignin=new ye,this.cdkdata=new ve,this.bCheckFightRoom=!1,this.watchadbox=new Ce,this.halloffame=new Te,this.condshare=new be,this.finalrune=new Ee,this.timelockBox=new Re,this.chapterData=new Ae,this.legendData=new De}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<16)return!1;this.currTime=e.getInt32(),this.roleId=e.getLong();var t=e.getUint32();if(e.getLen()-e.getPos()<t)return!1;if(this.strId=e.getString(t),e.getLen()-e.getPos()<4)return!1;var o=e.getUint32();if(e.getLen()-e.getPos()<o)return!1;if(this.roleName=e.getString(o),e.getLen()-e.getPos()<13)return!1;this.bIndulge=e.getBool(),this.indulgeTime=e.getInt32(),this.indulgeDayOnlineTime=e.getInt32();var i=e.getUint32();if(e.getLen()-e.getPos()<8*i)return!1;this.roleAttrValue.clear();for(var a=0;a<i;++a){var n,r;n=e.getInt32(),r=e.getInt32(),this.roleAttrValue.set(n,r)}return!!(!(e.getLen()-e.getPos()<28)&&this.gameTime.read(e)&&this.information.read(e)&&this.clientData.read(e)&&this.recharge.read(e)&&this.roleBag.read(e)&&this.roleMail.read(e)&&this.roleItemInfo.read(e)&&this.roleTask.read(e)&&this.exchange.read(e)&&this.battlearray.read(e)&&this.expressionarray.read(e)&&this.scoreAchievement.read(e)&&this.signin.read(e)&&this.timebox.read(e)&&this.themebox.read(e)&&this.season.read(e)&&this.share.read(e)&&!(e.getLen()-e.getPos()<14)&&this.totalsignin.read(e)&&this.cdkdata.read(e)&&!(e.getLen()-e.getPos()<19)&&(this.bCheckFightRoom=e.getBool(),this.watchadbox.read(e)&&this.halloffame.read(e)&&this.condshare.read(e)&&this.finalrune.read(e)&&this.timelockBox.read(e)&&this.chapterData.read(e)&&this.legendData.read(e)))},e.prototype.writeNoEnd=function(e){e.setInt32(this.currTime),e.setLong(this.roleId),e.setString(this.strId),e.setString(this.roleName),e.setBool(this.bIndulge),e.setInt32(this.indulgeTime),e.setInt32(this.indulgeDayOnlineTime),e.setUint32(this.roleAttrValue.size),this.roleAttrValue.forEach(function(t,o){e.setInt32(o),e.setInt32(t)}),this.gameTime.writeNoEnd(e),this.information.writeNoEnd(e),this.clientData.writeNoEnd(e),this.recharge.writeNoEnd(e),this.roleBag.writeNoEnd(e),this.roleMail.writeNoEnd(e),this.roleItemInfo.writeNoEnd(e),this.roleTask.writeNoEnd(e),this.exchange.writeNoEnd(e),this.battlearray.writeNoEnd(e),this.expressionarray.writeNoEnd(e),this.scoreAchievement.writeNoEnd(e),this.signin.writeNoEnd(e),this.timebox.writeNoEnd(e),this.themebox.writeNoEnd(e),this.season.writeNoEnd(e),this.share.writeNoEnd(e),this.totalsignin.writeNoEnd(e),this.cdkdata.writeNoEnd(e),e.setBool(this.bCheckFightRoom),this.watchadbox.writeNoEnd(e),this.halloffame.writeNoEnd(e),this.condshare.writeNoEnd(e),this.finalrune.writeNoEnd(e),this.timelockBox.writeNoEnd(e),this.chapterData.writeNoEnd(e),this.legendData.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_SynRoleData=Me;var Be=function(){function e(){this.index=0,this.value=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.index=e.getInt32(),this.value=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.index),e.setInt32(this.value)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_SynRoleAttrValue=Be;var ke=function(){function e(){this._data=new m}return e.prototype.read=function(e){return!!this._data.read(e)},e.prototype.writeNoEnd=function(e){this._data.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_SynRoleInformationData=ke;var Ge=function(){function e(){this._data=new v}return e.prototype.read=function(e){return!!this._data.read(e)},e.prototype.writeNoEnd=function(e){this._data.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_SynRoleRechargeData=Ge;var Oe=function(){function e(){this.changeItem=[],this.deleteItem=[],this.compensate=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();this.changeItem=[];for(var o=0;o<t;++o){var i=new S;if(!i.read(e))return!1;this.changeItem.push(i)}if(e.getLen()-e.getPos()<4)return!1;var a=e.getUint32();if(e.getLen()-e.getPos()<8*a)return!1;this.deleteItem=[];for(var n=0;n<a;++n){var r;r=e.getLong(),this.deleteItem.push(r)}if(e.getLen()-e.getPos()<4)return!1;var s=e.getUint32();this.compensate.clear();for(var c=0;c<s;++c){var l;l=e.getInt32();var d=new C;if(!d.read(e))return!1;this.compensate.set(l,d)}return!0},e.prototype.writeNoEnd=function(e){e.setUint32(this.changeItem.length),this.changeItem.forEach(function(t){t.writeNoEnd(e)}),e.setUint32(this.deleteItem.length),this.deleteItem.forEach(function(t){e.setLong(t)}),e.setUint32(this.compensate.size),this.compensate.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_SynItemData=Oe;var He=function(){function e(){this.changeMail=[],this.deleteMail=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();this.changeMail=[];for(var o=0;o<t;++o){var i=new N;if(!i.read(e))return!1;this.changeMail.push(i)}if(e.getLen()-e.getPos()<4)return!1;var a=e.getUint32();if(e.getLen()-e.getPos()<8*a)return!1;this.deleteMail=[];for(var n=0;n<a;++n){var r;r=e.getLong(),this.deleteMail.push(r)}return!0},e.prototype.writeNoEnd=function(e){e.setUint32(this.changeMail.length),this.changeMail.forEach(function(t){t.writeNoEnd(e)}),e.setUint32(this.deleteMail.length),this.deleteMail.forEach(function(t){e.setLong(t)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_SynMailData=He;var Ve=function(){function e(){this.iteminfo=new E}return e.prototype.read=function(e){return!!this.iteminfo.read(e)},e.prototype.writeNoEnd=function(e){this.iteminfo.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_SynItemInfoData=Ve;var Fe=function(){function e(){this.changeTask=[],this.deleteTask=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();if(e.getLen()-e.getPos()<20*t)return!1;this.changeTask=[];for(var o=0;o<t;++o){var i=new P;if(!i.read(e))return!1;this.changeTask.push(i)}if(e.getLen()-e.getPos()<4)return!1;var a=e.getUint32();if(e.getLen()-e.getPos()<4*a)return!1;this.deleteTask=[];for(var n=0;n<a;++n){var r;r=e.getInt32(),this.deleteTask.push(r)}return!0},e.prototype.writeNoEnd=function(e){e.setUint32(this.changeTask.length),this.changeTask.forEach(function(t){t.writeNoEnd(e)}),e.setUint32(this.deleteTask.length),this.deleteTask.forEach(function(t){e.setInt32(t)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_SynTaskData=Fe;var Ue=function(){function e(){this._data=new B}return e.prototype.read=function(e){return!!this._data.read(e)},e.prototype.writeNoEnd=function(e){this._data.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_SynTaskExtraData=Ue;var xe=function(){function e(){this.exchange=new F}return e.prototype.read=function(e){return!!this.exchange.read(e)},e.prototype.writeNoEnd=function(e){this.exchange.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_SynExchangeData=xe;var Ye=function(){function e(){this.battlearray=new j}return e.prototype.read=function(e){return!!this.battlearray.read(e)},e.prototype.writeNoEnd=function(e){this.battlearray.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_SynBattleArrayData=Ye;var je=function(){function e(){this.expressionarray=new z}return e.prototype.read=function(e){return!!this.expressionarray.read(e)},e.prototype.writeNoEnd=function(e){this.expressionarray.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_SynExpressionArrayData=je;var We=function(){function e(){this.shopID=0,this.shopData=new X}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.shopID=e.getInt32(),!this.shopData.read(e)))},e.prototype.writeNoEnd=function(e){e.setInt32(this.shopID),this.shopData.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_SynRandShopData=We;var ze=function(){function e(){this.groupID=0,this.groupData=new Z}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.groupID=e.getInt32(),!this.groupData.read(e)))},e.prototype.writeNoEnd=function(e){e.setInt32(this.groupID),this.groupData.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_SynRandRechargeData=ze;var Ke=function(){function e(){this.signinData=new ee}return e.prototype.read=function(e){return!!this.signinData.read(e)},e.prototype.writeNoEnd=function(e){this.signinData.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_SynSignInData=Ke;var qe=function(){function e(){this.timeboxData=new oe}return e.prototype.read=function(e){return!!this.timeboxData.read(e)},e.prototype.writeNoEnd=function(e){this.timeboxData.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_SynTimeBoxData=qe;var Qe=function(){function e(){this.themeboxData=new ne}return e.prototype.read=function(e){return!!this.themeboxData.read(e)},e.prototype.writeNoEnd=function(e){this.themeboxData.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_SynThemeBoxData=Qe;var Xe=function(){function e(){this.seasonData=new de,this.legendData=new De}return e.prototype.read=function(e){return!!this.seasonData.read(e)&&!!this.legendData.read(e)},e.prototype.writeNoEnd=function(e){this.seasonData.writeNoEnd(e),this.legendData.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_SynSeasonData=Xe;var Je=function(){function e(){this.shareData=new fe}return e.prototype.read=function(e){return!!this.shareData.read(e)},e.prototype.writeNoEnd=function(e){this.shareData.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_SynShareData=Je;var Ze=function(){function e(){this.currTime=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.currTime=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.currTime)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_ModifyTime=Ze;var $e=function(){function e(){this.mailUUID=a.fromValue(0)}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.mailUUID=e.getLong(),0))},e.prototype.writeNoEnd=function(e){e.setLong(this.mailUUID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_ReadMail=$e;var et=function(){function e(){this.errorcode=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_ReadMail=et;var tt=function(){function e(){this.mailUUID=a.fromValue(0)}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.mailUUID=e.getLong(),0))},e.prototype.writeNoEnd=function(e){e.setLong(this.mailUUID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_DeleteReadMail=tt;var ot=function(){function e(){this.errorcode=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_DeleteReadMail=ot;var it=function(){function e(){}return e.prototype.read=function(){return!0},e.prototype.writeNoEnd=function(){},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_DeleteAllReadMail=it;var at=function(){function e(){this.errorcode=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_DeleteAllReadMail=at;var nt=function(){function e(){this.mailUUID=a.fromValue(0),this.selfSelect=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<12)return!1;this.mailUUID=e.getLong();var t=e.getUint32();if(e.getLen()-e.getPos()<4*t)return!1;this.selfSelect=[];for(var o=0;o<t;++o){var i;i=e.getInt32(),this.selfSelect.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setLong(this.mailUUID),e.setUint32(this.selfSelect.length),this.selfSelect.forEach(function(t){e.setInt32(t)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_ReceiveMailAnnex=nt;var rt=function(){function e(){this.errorcode=0,this.rewards=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.errorcode=e.getInt32();var t=e.getUint32();this.rewards=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.rewards.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setUint32(this.rewards.length),this.rewards.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_ReceiveMailAnnex=rt;var st=function(){function e(){}return e.prototype.read=function(){return!0},e.prototype.writeNoEnd=function(){},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_ReceiveAllMailAnnex=st;var ct=function(){function e(){this.errorcode=0,this.rewards=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.errorcode=e.getInt32();var t=e.getUint32();this.rewards=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.rewards.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setUint32(this.rewards.length),this.rewards.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_ReceiveAllMailAnnex=ct;var lt=function(){function e(){this.groupID=0,this.exchangeID=0,this.exchangeNum=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<12||(this.groupID=e.getInt32(),this.exchangeID=e.getInt32(),this.exchangeNum=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.groupID),e.setInt32(this.exchangeID),e.setInt32(this.exchangeNum)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_OnExchange=lt;var dt=function(){function e(){this.errorcode=0,this.groupID=0,this.exchangeID=0,this.exchangeNum=0,this.prize=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<20)return!1;this.errorcode=e.getInt32(),this.groupID=e.getInt32(),this.exchangeID=e.getInt32(),this.exchangeNum=e.getInt32();var t=e.getUint32();this.prize=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.prize.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setInt32(this.groupID),e.setInt32(this.exchangeID),e.setInt32(this.exchangeNum),e.setUint32(this.prize.length),this.prize.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_OnExchange=dt;var ut=function(){function e(){this.taskID=0,this.isExtra=!1}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<5||(this.taskID=e.getInt32(),this.isExtra=e.getBool(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.taskID),e.setBool(this.isExtra)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_TakeTask=ut;var ht=function(){function e(){this.errorcode=0,this.taskID=0,this.prize=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<12)return!1;this.errorcode=e.getInt32(),this.taskID=e.getInt32();var t=e.getUint32();this.prize=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.prize.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setInt32(this.taskID),e.setUint32(this.prize.length),this.prize.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_TakeTask=ht;var pt=function(){function e(){this.taskID=0,this.count=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.taskID=e.getInt32(),this.count=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.taskID),e.setInt32(this.count)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_ClientTaskAddCount=pt;var ft=function(){function e(){this.errorcode=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_ClientTaskAddCount=ft;var gt=function(){function e(){this.advertID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.advertID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.advertID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_ClientTaskAddAdvert=gt;var mt=function(){function e(){this.errorcode=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_ClientTaskAddAdvert=mt;var _t=function(){function e(){this.groupType=0,this.boxID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.groupType=e.getInt32(),this.boxID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.groupType),e.setInt32(this.boxID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_TakeTaskBox=_t;var yt=function(){function e(){this.errorcode=0,this.groupType=0,this.boxID=0,this.prize=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<16)return!1;this.errorcode=e.getInt32(),this.groupType=e.getInt32(),this.boxID=e.getInt32();var t=e.getUint32();this.prize=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.prize.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setInt32(this.groupType),e.setInt32(this.boxID),e.setUint32(this.prize.length),this.prize.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_TakeTaskBox=yt;var vt=function(){function e(){}return e.prototype.read=function(){return!0},e.prototype.writeNoEnd=function(){},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_IndulgeArrivalTime=vt;var Ct=function(){function e(){this.itemUUID=a.fromValue(0)}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.itemUUID=e.getLong(),0))},e.prototype.writeNoEnd=function(e){e.setLong(this.itemUUID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_HeroLevelUp=Ct;var St=function(){function e(){this.errorcode=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_HeroLevelUp=St;var Tt=function(){function e(){this.arrayID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.arrayID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.arrayID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_BattleArraySetDefine=Tt;var It=function(){function e(){this.errorcode=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_BattleArraySetDefine=It;var Nt=function(){function e(){this.arrayID=0,this.arrayIndex=0,this.itemUUID=a.fromValue(0)}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<16||(this.arrayID=e.getInt32(),this.arrayIndex=e.getInt32(),this.itemUUID=e.getLong(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.arrayID),e.setInt32(this.arrayIndex),e.setLong(this.itemUUID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_BattleArrayUp=Nt;var bt=function(){function e(){this.errorcode=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_BattleArrayUp=bt;var wt=function(){function e(){this.arrayID=0,this.arrayIndex=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.arrayID=e.getInt32(),this.arrayIndex=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.arrayID),e.setInt32(this.arrayIndex)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_BattleArrayDown=wt;var Et=function(){function e(){this.errorcode=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_BattleArrayDown=Et;var Pt=function(){function e(){this.arrayID=0,this.arrayIndex1=0,this.arrayIndex2=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<12||(this.arrayID=e.getInt32(),this.arrayIndex1=e.getInt32(),this.arrayIndex2=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.arrayID),e.setInt32(this.arrayIndex1),e.setInt32(this.arrayIndex2)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_BattleArrayChange=Pt;var Rt=function(){function e(){this.errorcode=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_BattleArrayChange=Rt;var Lt=function(){function e(){this.takeScoreAchievementId=0,this.takeType=1}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.takeScoreAchievementId=e.getInt32(),this.takeType=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.takeScoreAchievementId),e.setInt32(this.takeType)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_Take_Score_Achievement_Reward=Lt;var At=function(){function e(){this.takeScoreAchievementId=0,this.errorcode=0,this.reward=[],this.scoreAchievement=new q}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<12)return!1;this.takeScoreAchievementId=e.getInt32(),this.errorcode=e.getInt32();var t=e.getUint32();this.reward=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.reward.push(i)}return!!this.scoreAchievement.read(e)},e.prototype.writeNoEnd=function(e){e.setInt32(this.takeScoreAchievementId),e.setInt32(this.errorcode),e.setUint32(this.reward.length),this.reward.forEach(function(t){t.writeNoEnd(e)}),this.scoreAchievement.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_Take_Score_Achievement_Reward=At;var Dt=function(){function e(){this.taskIndex=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.taskIndex=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.taskIndex)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_ReplaceRandTask=Dt;var Mt=function(){function e(){this.errorcode=0,this.taskIndex=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.errorcode=e.getInt32(),this.taskIndex=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setInt32(this.taskIndex)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_ReplaceRandTask=Mt;var Bt=function(){function e(){}return e.prototype.read=function(){return!0},e.prototype.writeNoEnd=function(){},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_ReceiveMonthCardPrize=Bt;var kt=function(){function e(){this.errorcode=0,this.prize=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.errorcode=e.getInt32();var t=e.getUint32();this.prize=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.prize.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setUint32(this.prize.length),this.prize.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_ReceiveMonthCardPrize=kt;var Gt=function(){function e(){this.indulgeBirth=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.indulgeBirth=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.indulgeBirth)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_SetIndulgeBirth=Gt;var Ot=function(){function e(){this.errorcode=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_SetIndulgeBirth=Ot;var Ht=function(){function e(){this.heroID=0,this.damageTotal=a.fromValue(0)}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<12||(this.heroID=e.getInt32(),this.damageTotal=e.getLong(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.heroID),e.setLong(this.damageTotal)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_FightBalance_Hero=Ht;var Vt=function(){function e(){this.deathNum=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.deathNum=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.deathNum)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_FightBalance_TypMonster=Vt;var Ft=function(){function e(){this.roleAbstract=new r,this.heros=new i.ObjMap,this.typeMonster=new i.ObjMap,this.totalHarm=a.fromValue(0),this.isGuard=!1,this.statisticInfo=new u}return e.prototype.read=function(e){if(!this.roleAbstract.read(e))return!1;if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();if(e.getLen()-e.getPos()<20*t)return!1;this.heros.clear();for(var o=0;o<t;++o){var i;i=e.getLong();var a=new Ht;if(!a.read(e))return!1;this.heros.set(i,a)}if(e.getLen()-e.getPos()<4)return!1;var n=e.getUint32();if(e.getLen()-e.getPos()<8*n)return!1;this.typeMonster.clear();for(var r=0;r<n;++r){var s;s=e.getInt32();var c=new Vt;if(!c.read(e))return!1;this.typeMonster.set(s,c)}return!(e.getLen()-e.getPos()<9||(this.totalHarm=e.getLong(),this.isGuard=e.getBool(),!this.statisticInfo.read(e)))},e.prototype.writeNoEnd=function(e){this.roleAbstract.writeNoEnd(e),e.setUint32(this.heros.size),this.heros.forEach(function(t,o){e.setLong(o),t.writeNoEnd(e)}),e.setUint32(this.typeMonster.size),this.typeMonster.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)}),e.setLong(this.totalHarm),e.setBool(this.isGuard),this.statisticInfo.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_FightBalance_Role=Ft;var Ut=function(){function e(){this.prize=[],this.encouragePrize=[],this.seriesWinPrize=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();this.prize=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.prize.push(i)}if(e.getLen()-e.getPos()<4)return!1;var a=e.getUint32();this.encouragePrize=[];for(var r=0;r<a;++r){var s=new n;if(!s.read(e))return!1;this.encouragePrize.push(s)}if(e.getLen()-e.getPos()<4)return!1;var c=e.getUint32();this.seriesWinPrize=[];for(var l=0;l<c;++l){var d=new n;if(!d.read(e))return!1;this.seriesWinPrize.push(d)}return!0},e.prototype.writeNoEnd=function(e){e.setUint32(this.prize.length),this.prize.forEach(function(t){t.writeNoEnd(e)}),e.setUint32(this.encouragePrize.length),this.encouragePrize.forEach(function(t){t.writeNoEnd(e)}),e.setUint32(this.seriesWinPrize.length),this.seriesWinPrize.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_FightBalance_Battle_Winner=Ut;var xt=function(){function e(){this.lostDec=[],this.lostPrize=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();this.lostDec=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.lostDec.push(i)}if(e.getLen()-e.getPos()<4)return!1;var a=e.getUint32();this.lostPrize=[];for(var r=0;r<a;++r){var s=new n;if(!s.read(e))return!1;this.lostPrize.push(s)}return!0},e.prototype.writeNoEnd=function(e){e.setUint32(this.lostDec.length),this.lostDec.forEach(function(t){t.writeNoEnd(e)}),e.setUint32(this.lostPrize.length),this.lostPrize.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_FightBalance_Battle_Loster=xt;var Yt=function(){function e(){this.winner=new Ut,this.loster=new xt}return e.prototype.read=function(e){return!!this.winner.read(e)&&!!this.loster.read(e)},e.prototype.writeNoEnd=function(e){this.winner.writeNoEnd(e),this.loster.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_FightBalance_Battle=Yt;var jt=function(){function e(){this.prize=[],this.extraprize=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();this.prize=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.prize.push(i)}if(e.getLen()-e.getPos()<4)return!1;var a=e.getUint32();this.extraprize=[];for(var r=0;r<a;++r){var s=new n;if(!s.read(e))return!1;this.extraprize.push(s)}return!0},e.prototype.writeNoEnd=function(e){e.setUint32(this.prize.length),this.prize.forEach(function(t){t.writeNoEnd(e)}),e.setUint32(this.extraprize.length),this.extraprize.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_FightBalance_CoopRation=jt;var Wt=function(){function e(){this.winNum=0,this.LostNum=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.winNum=e.getInt32(),this.LostNum=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.winNum),e.setInt32(this.LostNum)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_FightBalance_RandomArena=Wt;var zt=function(){function e(){this.score=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.score=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.score)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_FightBlance_GoldenLeague=zt;var Kt=function(){function e(){this.prize=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();this.prize=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.prize.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setUint32(this.prize.length),this.prize.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_FightBalance_Activity_CoopRation=Kt;var qt=function(){function e(){this.themeMedal=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.themeMedal=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.themeMedal)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_FightBalance_ExtraData=qt;var Qt=function(){function e(){this.type=0,this.bWin=!1,this.roles=new i.ObjMap,this.round=0,this.battle=new i.ObjMap,this.coopration=new i.ObjMap,this.randomArena=new i.ObjMap,this.goldenLeague=new i.ObjMap,this.activityCoopration=new i.ObjMap,this.extraData=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<9)return!1;this.type=e.getInt32(),this.bWin=e.getBool();var t=e.getUint32();this.roles.clear();for(var o=0;o<t;++o){var i;i=e.getLong();var a=new Ft;if(!a.read(e))return!1;this.roles.set(i,a)}if(e.getLen()-e.getPos()<8)return!1;this.round=e.getInt32();var n=e.getUint32();this.battle.clear();for(var r=0;r<n;++r){var s;s=e.getInt32();var c=new Yt;if(!c.read(e))return!1;this.battle.set(s,c)}if(e.getLen()-e.getPos()<4)return!1;var l=e.getUint32();this.coopration.clear();for(var d=0;d<l;++d){var u;u=e.getInt32();var h=new jt;if(!h.read(e))return!1;this.coopration.set(u,h)}if(e.getLen()-e.getPos()<4)return!1;var p=e.getUint32();if(e.getLen()-e.getPos()<16*p)return!1;this.randomArena.clear();for(var f=0;f<p;++f){var g;g=e.getLong();var m=new Wt;if(!m.read(e))return!1;this.randomArena.set(g,m)}if(e.getLen()-e.getPos()<4)return!1;var _=e.getUint32();if(e.getLen()-e.getPos()<8*_)return!1;this.goldenLeague.clear();for(var y=0;y<_;++y){var v;v=e.getInt32();var C=new zt;if(!C.read(e))return!1;this.goldenLeague.set(v,C)}if(e.getLen()-e.getPos()<4)return!1;var S=e.getUint32();this.activityCoopration.clear();for(var T=0;T<S;++T){var I;I=e.getInt32();var N=new Kt;if(!N.read(e))return!1;this.activityCoopration.set(I,N)}if(e.getLen()-e.getPos()<4)return!1;var b=e.getUint32();if(e.getLen()-e.getPos()<8*b)return!1;this.extraData.clear();for(var w=0;w<b;++w){var E;E=e.getInt32();var P=new qt;if(!P.read(e))return!1;this.extraData.set(E,P)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.type),e.setBool(this.bWin),e.setUint32(this.roles.size),this.roles.forEach(function(t,o){e.setLong(o),t.writeNoEnd(e)}),e.setInt32(this.round),e.setUint32(this.battle.size),this.battle.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)}),e.setUint32(this.coopration.size),this.coopration.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)}),e.setUint32(this.randomArena.size),this.randomArena.forEach(function(t,o){e.setLong(o),t.writeNoEnd(e)}),e.setUint32(this.goldenLeague.size),this.goldenLeague.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)}),e.setUint32(this.activityCoopration.size),this.activityCoopration.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)}),e.setUint32(this.extraData.size),this.extraData.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_FightBalance=Qt;var Xt=function(){function e(){this.fightType=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.fightType=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.fightType)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_ResetWinLostNum=Xt;var Jt=function(){function e(){this.errorcode=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_ResetWinLostNum=Jt;var Zt=function(){function e(){this.intKey=0,this.intValue=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.intKey=e.getInt32(),this.intValue=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.intKey),e.setInt32(this.intValue)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_UpdateClientInt=Zt;var $t=function(){function e(){this.errorcode=0,this.intKey=0,this.intValue=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<12||(this.errorcode=e.getInt32(),this.intKey=e.getInt32(),this.intValue=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setInt32(this.intKey),e.setInt32(this.intValue)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_UpdateClientInt=$t;var eo=function(){function e(){this.arrayIndex=0,this.itemUUID=a.fromValue(0)}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<12||(this.arrayIndex=e.getInt32(),this.itemUUID=e.getLong(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.arrayIndex),e.setLong(this.itemUUID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_ExpressionArrayUp=eo;var to=function(){function e(){this.errorcode=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_ExpressionArrayUp=to;var oo=function(){function e(){this.arrayIndex1=0,this.arrayIndex2=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.arrayIndex1=e.getInt32(),this.arrayIndex2=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.arrayIndex1),e.setInt32(this.arrayIndex2)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_ExpressionArrayChange=oo;var io=function(){function e(){this.errorcode=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_ExpressionArrayChange=io;var ao=function(){function e(){}return e.prototype.read=function(){return!0},e.prototype.writeNoEnd=function(){},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_Add_Fight_Cooperation_Num=ao;var no=function(){function e(){this.errorcode=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_Add_Fight_Cooperation_Num=no;var ro=function(){function e(){}return e.prototype.read=function(){return!0},e.prototype.writeNoEnd=function(){},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_FightBalanceReceiveAdditional=ro;var so=function(){function e(){this.errorcode=0,this.fightType=0,this.prize=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<12)return!1;this.errorcode=e.getInt32(),this.fightType=e.getInt32();var t=e.getUint32();this.prize=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.prize.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setInt32(this.fightType),e.setUint32(this.prize.length),this.prize.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_FightBalanceReceiveAdditional=so;var co=function(){function e(){this.day=0,this.bExtra=!1}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<5||(this.day=e.getInt32(),this.bExtra=e.getBool(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.day),e.setBool(this.bExtra)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_SignInReceivePrize=co;var lo=function(){function e(){this.errorcode=0,this.prize=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.errorcode=e.getInt32();var t=e.getUint32();this.prize=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.prize.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setUint32(this.prize.length),this.prize.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_SignInReceivePrize=lo;var uo=function(){function e(){this.guide=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.guide=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.guide)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_SetGuide=uo;var ho=function(){function e(){this.errorcode=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_SetGuide=ho;var po=function(){function e(){}return e.prototype.read=function(){return!0},e.prototype.writeNoEnd=function(){},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_Buy_Fight_Cooperation_Num=po;var fo=function(){function e(){this.errorcode=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_Buy_Fight_Cooperation_Num=fo;var go=function(){function e(){this.ret=0,this.fightPattern=0,this.fightType=0,this.fightModule=0,this.roleIdentity=0,this.matchRoles=new i.ObjMap,this.fightServerIp="",this.fightServerPort=0,this.fightServerIpSSL="",this.fightServerPortSSL=0,this.fightToken="",this.seedId=[],this.extraData=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<24)return!1;this.ret=e.getInt32(),this.fightPattern=e.getInt32(),this.fightType=e.getInt32(),this.fightModule=e.getInt32(),this.roleIdentity=e.getInt32();var t=e.getUint32();this.matchRoles.clear();for(var o=0;o<t;++o){var i;i=e.getLong();var a=new r;if(!a.read(e))return!1;this.matchRoles.set(i,a)}if(e.getLen()-e.getPos()<4)return!1;var n=e.getUint32();if(e.getLen()-e.getPos()<n)return!1;if(this.fightServerIp=e.getString(n),e.getLen()-e.getPos()<8)return!1;this.fightServerPort=e.getInt32();var s=e.getUint32();if(e.getLen()-e.getPos()<s)return!1;if(this.fightServerIpSSL=e.getString(s),e.getLen()-e.getPos()<8)return!1;this.fightServerPortSSL=e.getInt32();var c=e.getUint32();if(e.getLen()-e.getPos()<c)return!1;if(this.fightToken=e.getString(c),e.getLen()-e.getPos()<4)return!1;var d=e.getUint32();if(e.getLen()-e.getPos()<4*d)return!1;this.seedId=[];for(var u=0;u<d;++u){var h;h=e.getInt32(),this.seedId.push(h)}if(e.getLen()-e.getPos()<4)return!1;var p=e.getUint32();this.extraData.clear();for(var f=0;f<p;++f){var g;g=e.getLong();var m=new l;if(!m.read(e))return!1;this.extraData.set(g,m)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.ret),e.setInt32(this.fightPattern),e.setInt32(this.fightType),e.setInt32(this.fightModule),e.setInt32(this.roleIdentity),e.setUint32(this.matchRoles.size),this.matchRoles.forEach(function(t,o){e.setLong(o),t.writeNoEnd(e)}),e.setString(this.fightServerIp),e.setInt32(this.fightServerPort),e.setString(this.fightServerIpSSL),e.setInt32(this.fightServerPortSSL),e.setString(this.fightToken),e.setUint32(this.seedId.length),this.seedId.forEach(function(t){e.setInt32(t)}),e.setUint32(this.extraData.size),this.extraData.forEach(function(t,o){e.setLong(o),t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_Fight_Reconnect=go;var mo=function(){function e(){}return e.prototype.read=function(){return!0},e.prototype.writeNoEnd=function(){},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_SeasonClearLastData=mo;var _o=function(){function e(){this.errorcode=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_SeasonClearLastData=_o;var yo=function(){function e(){this.prizeID=0,this.isExtra=!1}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<5||(this.prizeID=e.getInt32(),this.isExtra=e.getBool(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.prizeID),e.setBool(this.isExtra)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_SeasonReceiveForeverScorePrize=yo;var vo=function(){function e(){this.errorcode=0,this.prizeID=0,this.isExtra=!1}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<9||(this.errorcode=e.getInt32(),this.prizeID=e.getInt32(),this.isExtra=e.getBool(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setInt32(this.prizeID),e.setBool(this.isExtra)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_SeasonReceiveForeverScorePrize=vo;var Co=function(){function e(){this.prizeID=0,this.isExtra=!1}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<5||(this.prizeID=e.getInt32(),this.isExtra=e.getBool(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.prizeID),e.setBool(this.isExtra)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_SeasonReceiveScorePrize=Co;var So=function(){function e(){this.errorcode=0,this.prizeID=0,this.isExtra=!1}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<9||(this.errorcode=e.getInt32(),this.prizeID=e.getInt32(),this.isExtra=e.getBool(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setInt32(this.prizeID),e.setBool(this.isExtra)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_SeasonReceiveScorePrize=So;var To=function(){function e(){this.showID=""}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();return!(e.getLen()-e.getPos()<t||(this.showID=e.getString(t),0))},e.prototype.writeNoEnd=function(e){e.setString(this.showID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_GetRoleSimpleInfo=To,function(e){e[e.ErrorCode_GetRoleSimpleInfo_Success=0]="ErrorCode_GetRoleSimpleInfo_Success",e[e.ErrorCode_GetRoleSimpleInfo_CanNotTransmit=1]="ErrorCode_GetRoleSimpleInfo_CanNotTransmit",e[e.ErrorCode_GetRoleSimpleInfo_TransmitFailed=2]="ErrorCode_GetRoleSimpleInfo_TransmitFailed",e[e.ErrorCode_GetRoleSimpleInfo_NoRole=3]="ErrorCode_GetRoleSimpleInfo_NoRole"}(o.ErrorCode_GetRoleSimpleInfo||(o.ErrorCode_GetRoleSimpleInfo={}));var Io=function(){function e(){this.errorcode=0,this.roleAbstract=new r,this.roleProficiency=new h}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),!this.roleAbstract.read(e)||!this.roleProficiency.read(e)))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),this.roleAbstract.writeNoEnd(e),this.roleProficiency.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_GetRoleSimpleInfo=Io;var No=function(){function e(){this.cardid="",this.cardname=""}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();if(e.getLen()-e.getPos()<t)return!1;if(this.cardid=e.getString(t),e.getLen()-e.getPos()<4)return!1;var o=e.getUint32();return!(e.getLen()-e.getPos()<o||(this.cardname=e.getString(o),0))},e.prototype.writeNoEnd=function(e){e.setString(this.cardid),e.setString(this.cardname)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_UpdateRoleCardData=No;var bo=function(){function e(){this.errorcode=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_UpdateRoleCardData=bo;var wo=function(){function e(){this.chats=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();this.chats=[];for(var o=0;o<t;++o){var i=new s;if(!i.read(e))return!1;this.chats.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setUint32(this.chats.length),this.chats.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_SynHistoryWorldChat=wo;var Eo=function(){function e(){this.masterID=""}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();return!(e.getLen()-e.getPos()<t||(this.masterID=e.getString(t),0))},e.prototype.writeNoEnd=function(e){e.setString(this.masterID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_ShareBindMaster=Eo;var Po=function(){function e(){this.errorcode=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_ShareBindMaster=Po;var Ro=function(){function e(){this.shareRoleID=a.fromValue(0)}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.shareRoleID=e.getLong(),0))},e.prototype.writeNoEnd=function(e){e.setLong(this.shareRoleID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_ShareReceiveSharePrize=Ro;var Lo=function(){function e(){this.errorcode=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_ShareReceiveSharePrize=Lo;var Ao=function(){function e(){this.shareRoleID=a.fromValue(0),this.prizeID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<12||(this.shareRoleID=e.getLong(),this.prizeID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setLong(this.shareRoleID),e.setInt32(this.prizeID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_ShareReceiveRankPrize=Ao;var Do=function(){function e(){this.errorcode=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_ShareReceiveRankPrize=Do;var Mo=function(){function e(){}return e.prototype.read=function(){return!0},e.prototype.writeNoEnd=function(){},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_Get_Fight_Record_Battle=Mo;var Bo=function(){function e(){this.errorcode=0,this.record=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.errorcode=e.getInt32();var t=e.getUint32();this.record=[];for(var o=0;o<t;++o){var i=new me;if(!i.read(e))return!1;this.record.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setUint32(this.record.length),this.record.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_Get_Fight_Record_Battle=Bo;var ko=function(){function e(){}return e.prototype.read=function(){return!0},e.prototype.writeNoEnd=function(){},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_Get_Fight_Record_Cooperation=ko;var Go=function(){function e(){this.errorcode=0,this.record=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.errorcode=e.getInt32();var t=e.getUint32();this.record=[];for(var o=0;o<t;++o){var i=new _e;if(!i.read(e))return!1;this.record.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setUint32(this.record.length),this.record.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_Get_Fight_Record_Cooperation=Go;var Oo=function(){function e(){this.totalsignin=new ye}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<14||!this.totalsignin.read(e))},e.prototype.writeNoEnd=function(e){this.totalsignin.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_SynTotalSignInData=Oo;var Ho=function(){function e(){this.isPrize=!1,this.isExtra=!1}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<2||(this.isPrize=e.getBool(),this.isExtra=e.getBool(),0))},e.prototype.writeNoEnd=function(e){e.setBool(this.isPrize),e.setBool(this.isExtra)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_TotalSignInReceivePrize=Ho;var Vo=function(){function e(){this.errorcode=0,this.prize=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.errorcode=e.getInt32();var t=e.getUint32();this.prize=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.prize.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setUint32(this.prize.length),this.prize.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_TotalSignInReceivePrize=Vo;var Fo=function(){function e(){this.cdkstr=""}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();return!(e.getLen()-e.getPos()<t||(this.cdkstr=e.getString(t),0))},e.prototype.writeNoEnd=function(e){e.setString(this.cdkstr)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_GetCDKReward=Fo;var Uo=function(){function e(){this.errorcode=0,this.prize=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.errorcode=e.getInt32();var t=e.getUint32();this.prize=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.prize.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setUint32(this.prize.length),this.prize.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_GetCDKReward=Uo;var xo=function(){function e(){this.noticeData=new d}return e.prototype.read=function(e){return!!this.noticeData.read(e)},e.prototype.writeNoEnd=function(e){this.noticeData.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_BroadcastGameNotice=xo;var Yo=function(){function e(){this.timeRemaining=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.timeRemaining=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.timeRemaining)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_SynForbidChatTimeRemaining=Yo;var jo=function(){function e(){this.itemUUID=a.fromValue(0)}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.itemUUID=e.getLong(),0))},e.prototype.writeNoEnd=function(e){e.setLong(this.itemUUID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_ItemMapSkinUp=jo;var Wo=function(){function e(){this.errorcode=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_ItemMapSkinUp=Wo;var zo=function(){function e(){this.arrayID=0,this.info=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.arrayID=e.getInt32();var t=e.getUint32();if(e.getLen()-e.getPos()<12*t)return!1;this.info.clear();for(var o=0;o<t;++o){var i,a;i=e.getInt32(),a=e.getLong(),this.info.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.arrayID),e.setUint32(this.info.size),this.info.forEach(function(t,o){e.setInt32(o),e.setLong(t)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_BattleArrayUpBatch=zo;var Ko=function(){function e(){this.errorcode=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_BattleArrayUpBatch=Ko;var qo=function(){function e(){this.advertID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.advertID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.advertID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_ClientBeginAdvert=qo;var Qo=function(){function e(){this.errorcode=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_ClientBeginAdvert=Qo;var Xo=function(){function e(){this.roleid=a.fromValue(0),this.fightTime=0,this.fighttype=0,this.nickname=""}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<20)return!1;this.roleid=e.getLong(),this.fightTime=e.getInt32(),this.fighttype=e.getInt32();var t=e.getUint32();return!(e.getLen()-e.getPos()<t||(this.nickname=e.getString(t),0))},e.prototype.writeNoEnd=function(e){e.setLong(this.roleid),e.setInt32(this.fightTime),e.setInt32(this.fighttype),e.setString(this.nickname)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_Fight_Report=Xo;var Jo=function(){function e(){this.errorcode=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_Fight_Report=Jo;var Zo=function(){function e(){this.roleId=a.fromValue(0)}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.roleId=e.getLong(),0))},e.prototype.writeNoEnd=function(e){e.setLong(this.roleId)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.TReportRoleData=Zo;var $o=function(){function e(){}return e.prototype.read=function(){return!0},e.prototype.writeNoEnd=function(){},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_ReportData=$o;var ei=function(){function e(){this.errorcode=0,this.reportNum=0,this.data=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<12)return!1;this.errorcode=e.getInt32(),this.reportNum=e.getInt32();var t=e.getUint32();if(e.getLen()-e.getPos()<8*t)return!1;this.data=[];for(var o=0;o<t;++o){var i=new Zo;if(!i.read(e))return!1;this.data.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setInt32(this.reportNum),e.setUint32(this.data.length),this.data.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_ReportData=ei;var ti=function(){function e(){this.isReceive=!1}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<1||(this.isReceive=e.getBool(),0))},e.prototype.writeNoEnd=function(e){e.setBool(this.isReceive)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_ReceiveFightLoserProtect=ti;var oi=function(){function e(){this.errorcode=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_ReceiveFightLoserProtect=oi;var ii=function(){function e(){this.isReceive=!1}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<1||(this.isReceive=e.getBool(),0))},e.prototype.writeNoEnd=function(e){e.setBool(this.isReceive)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_ReceiveFightWinExtra=ii;var ai=function(){function e(){this.errorcode=0,this.prize=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.errorcode=e.getInt32();var t=e.getUint32();this.prize=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.prize.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setUint32(this.prize.length),this.prize.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_ReceiveFightWinExtra=ai;var ni=function(){function e(){this.bIndulge=!1,this.indulgeTime=0,this.indulgeDayOnlineTime=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<9||(this.bIndulge=e.getBool(),this.indulgeTime=e.getInt32(),this.indulgeDayOnlineTime=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setBool(this.bIndulge),e.setInt32(this.indulgeTime),e.setInt32(this.indulgeDayOnlineTime)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_SynIndulge=ni;var ri=function(){function e(){}return e.prototype.read=function(){return!0},e.prototype.writeNoEnd=function(){},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_IndulgeLogout=ri;var si=function(){function e(){this.bExtra=!1}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<1||(this.bExtra=e.getBool(),0))},e.prototype.writeNoEnd=function(e){e.setBool(this.bExtra)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_SetCooperationExtra=si;var ci=function(){function e(){this.errorcode=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_SetCooperationExtra=ci;var li=function(){function e(){this.isOpen=!1}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<1||(this.isOpen=e.getBool(),0))},e.prototype.writeNoEnd=function(e){e.setBool(this.isOpen)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Role_GrowthFund=li;var di=function(){function e(){this.datas=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();if(e.getLen()-e.getPos()<5*t)return!1;this.datas.clear();for(var o=0;o<t;++o){var i;i=e.getInt32();var a=new li;if(!a.read(e))return!1;this.datas.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setUint32(this.datas.size),this.datas.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_SynGrowthFundData=di;var ui=function(){function e(){}return e.prototype.read=function(){return!0},e.prototype.writeNoEnd=function(){},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_GetGrowthFundData=ui;var hi=function(){function e(){this.error=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.error=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.error)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_GetGrowthFundData=hi;var pi=function(){function e(){this.totalwatchadbox=new Ce}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<18||!this.totalwatchadbox.read(e))},e.prototype.writeNoEnd=function(e){this.totalwatchadbox.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_TotalWatchADBoxData=pi;var fi=function(){function e(){this.isPrize=!1,this.isExtra=!1}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<2||(this.isPrize=e.getBool(),this.isExtra=e.getBool(),0))},e.prototype.writeNoEnd=function(e){e.setBool(this.isPrize),e.setBool(this.isExtra)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_TotalWatchADBoxReceivePrize=fi;var gi=function(){function e(){this.errorcode=0,this.prize=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.errorcode=e.getInt32();var t=e.getUint32();this.prize=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.prize.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setUint32(this.prize.length),this.prize.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_TotalWatchADBoxReceivePrize=gi;var mi=function(){function e(){this.shareID=0,this.is_share=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.shareID=e.getInt32(),this.is_share=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.shareID),e.setInt32(this.is_share)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_ClientFinishShare=mi;var _i=function(){function e(){this.errorcode=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_ClientFinishShare=_i;var yi=function(){function e(){this.isPrize=!1}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<1||(this.isPrize=e.getBool(),0))},e.prototype.writeNoEnd=function(e){e.setBool(this.isPrize)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_ReceiveDayFirstFightWin=yi;var vi=function(){function e(){this.errorcode=0,this.prize=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.errorcode=e.getInt32();var t=e.getUint32();this.prize=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.prize.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setUint32(this.prize.length),this.prize.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_ReceiveDayFirstFightWin=vi;var Ci=function(){function e(){this.isPrize=!1}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<1||(this.isPrize=e.getBool(),0))},e.prototype.writeNoEnd=function(e){e.setBool(this.isPrize)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_ReceiveCooperADPrize=Ci;var Si=function(){function e(){this.errorcode=0,this.prize=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.errorcode=e.getInt32();var t=e.getUint32();this.prize=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.prize.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setUint32(this.prize.length),this.prize.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_ReceiveCooperADPrize=Si;var Ti=function(){function e(){this.condshare=new be}return e.prototype.read=function(e){return!!this.condshare.read(e)},e.prototype.writeNoEnd=function(e){this.condshare.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_SynCondShareData=Ti;var Ii=function(){function e(){this.condshareID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.condshareID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.condshareID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_CondShareReceivePrize=Ii;var Ni=function(){function e(){this.errorcode=0,this.prize=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.errorcode=e.getInt32();var t=e.getUint32();this.prize=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.prize.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setUint32(this.prize.length),this.prize.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_CondShareReceivePrize=Ni;var bi=function(){function e(){this.shareRoleID=""}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();return!(e.getLen()-e.getPos()<t||(this.shareRoleID=e.getString(t),0))},e.prototype.writeNoEnd=function(e){e.setString(this.shareRoleID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_ShareEnter=bi;var wi=function(){function e(){this.npcId=0,this.posX=0,this.posY=0,this.roles=[],this.fightToken=""}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<16)return!1;this.npcId=e.getInt32(),this.posX=e.getInt32(),this.posY=e.getInt32();var t=e.getUint32();if(e.getLen()-e.getPos()<8*t)return!1;this.roles=[];for(var o=0;o<t;++o){var i;i=e.getLong(),this.roles.push(i)}if(e.getLen()-e.getPos()<4)return!1;var a=e.getUint32();return!(e.getLen()-e.getPos()<a||(this.fightToken=e.getString(a),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.npcId),e.setInt32(this.posX),e.setInt32(this.posY),e.setUint32(this.roles.length),this.roles.forEach(function(t){e.setLong(t)}),e.setString(this.fightToken)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_BossDropItems=wi;var Ei=function(){function e(){this.errorcode=0,this.posX=0,this.posY=0,this.dropItems=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<16)return!1;this.errorcode=e.getInt32(),this.posX=e.getInt32(),this.posY=e.getInt32();var t=e.getUint32();if(e.getLen()-e.getPos()<8*t)return!1;this.dropItems.clear();for(var o=0;o<t;++o){var i,a;i=e.getInt32(),a=e.getInt32(),this.dropItems.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setInt32(this.posX),e.setInt32(this.posY),e.setUint32(this.dropItems.size),this.dropItems.forEach(function(t,o){e.setInt32(o),e.setInt32(t)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_BossDropItems=Ei;var Pi=function(){function e(){this.chapterId=0,this.chapterProgress=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.chapterId=e.getInt32(),this.chapterProgress=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.chapterId),e.setInt32(this.chapterProgress)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_UpdateChapter=Pi;var Ri=function(){function e(){this.errorcode=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_UpdateChapter=Ri;var Li=function(){function e(){this.chapterId=0,this.chapterRewardIndex=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.chapterId=e.getInt32(),this.chapterRewardIndex=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.chapterId),e.setInt32(this.chapterRewardIndex)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_GetChapterReward=Li;var Ai=function(){function e(){this.errorcode=0,this.prize=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.errorcode=e.getInt32();var t=e.getUint32();this.prize=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.prize.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setUint32(this.prize.length),this.prize.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_GetChapterReward=Ai;var Di=function(){function e(){this.daynum=0,this.totalnum=0,this.guideNum=0,this.round=0,this.roundDrawNum=0,this.rewardBoxStateMap=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<24)return!1;this.daynum=e.getInt32(),this.totalnum=e.getInt32(),this.guideNum=e.getInt32(),this.round=e.getInt32(),this.roundDrawNum=e.getInt32();var t=e.getUint32();if(e.getLen()-e.getPos()<8*t)return!1;this.rewardBoxStateMap.clear();for(var o=0;o<t;++o){var i,a;i=e.getInt32(),a=e.getInt32(),this.rewardBoxStateMap.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.daynum),e.setInt32(this.totalnum),e.setInt32(this.guideNum),e.setInt32(this.round),e.setInt32(this.roundDrawNum),e.setUint32(this.rewardBoxStateMap.size),this.rewardBoxStateMap.forEach(function(t,o){e.setInt32(o),e.setInt32(t)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_DrawPrizeDetail=Di;var Mi=function(){function e(){}return e.prototype.read=function(){return!0},e.prototype.writeNoEnd=function(){},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_SyncDrawPrize=Mi;var Bi=function(){function e(){this.detail=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();this.detail.clear();for(var o=0;o<t;++o){var i;i=e.getInt32();var a=new Di;if(!a.read(e))return!1;this.detail.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setUint32(this.detail.size),this.detail.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_SyncDrawPrize=Bi;var ki=function(){function e(){this.type=0,this.num=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.type=e.getInt32(),this.num=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.type),e.setInt32(this.num)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_DrawPrize=ki;var Gi=function(){function e(){this.error=0,this.type=0,this.prize=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<12)return!1;this.error=e.getInt32(),this.type=e.getInt32();var t=e.getUint32();this.prize=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.prize.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.error),e.setInt32(this.type),e.setUint32(this.prize.length),this.prize.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_DrawPrize=Gi;var Oi=function(){function e(){this.id=0,this.fightToken=""}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.id=e.getInt32();var t=e.getUint32();return!(e.getLen()-e.getPos()<t||(this.fightToken=e.getString(t),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.id),e.setString(this.fightToken)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_SoloDropItems=Oi;var Hi=function(){function e(){this.errorcode=0,this.dropItems=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.errorcode=e.getInt32();var t=e.getUint32();if(e.getLen()-e.getPos()<8*t)return!1;this.dropItems.clear();for(var o=0;o<t;++o){var i,a;i=e.getInt32(),a=e.getInt32(),this.dropItems.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setUint32(this.dropItems.size),this.dropItems.forEach(function(t,o){e.setInt32(o),e.setInt32(t)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_SoloDropItems=Hi;var Vi=function(){function e(){this.shopID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.shopID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.shopID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_GetRandShop=Vi;var Fi=function(){function e(){this.shopID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.shopID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.shopID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_GetRandShop=Fi;var Ui=function(){function e(){this.shopID=0,this.shopPosition=0,this.shopItemID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<12||(this.shopID=e.getInt32(),this.shopPosition=e.getInt32(),this.shopItemID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.shopID),e.setInt32(this.shopPosition),e.setInt32(this.shopItemID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_RandShopBuy=Ui;var xi=function(){function e(){this.errorcode=0,this.prize=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.errorcode=e.getInt32();var t=e.getUint32();this.prize=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.prize.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setUint32(this.prize.length),this.prize.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_RandShopBuy=xi;var Yi=function(){function e(){this.shopID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.shopID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.shopID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_RandShopRefresh=Yi;var ji=function(){function e(){this.errorcode=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_RandShopRefresh=ji;var Wi=function(){function e(){this.isIndulge=!1}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<1||(this.isIndulge=e.getBool(),0))},e.prototype.writeNoEnd=function(e){e.setBool(this.isIndulge)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_SetIndulge=Wi;var zi=function(){function e(){this.errorcode=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_SetIndulge=zi;var Ki=function(){function e(){this.roleName=""}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();return!(e.getLen()-e.getPos()<t||(this.roleName=e.getString(t),0))},e.prototype.writeNoEnd=function(e){e.setString(this.roleName)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_ModifyRoleName=Ki;var qi=function(){function e(){this.errorcode=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_ModifyRoleName=qi;var Qi=function(){function e(){this.groupID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.groupID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.groupID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_GetRandRecharge=Qi;var Xi=function(){function e(){this.groupID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.groupID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.groupID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_GetRandRecharge=Xi;var Ji=function(){function e(){this.groupID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.groupID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.groupID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_RandRechargeRefresh=Ji;var Zi=function(){function e(){this.errorcode=0,this.groupID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.errorcode=e.getInt32(),this.groupID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setInt32(this.groupID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_RandRechargeRefresh=Zi;var $i=function(){function e(){this.scoreVec=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();if(e.getLen()-e.getPos()<4*t)return!1;this.scoreVec=[];for(var o=0;o<t;++o){var i;i=e.getInt32(),this.scoreVec.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setUint32(this.scoreVec.length),this.scoreVec.forEach(function(t){e.setInt32(t)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_GetLegendReward=$i;var ea=function(){function e(){this.errorcode=0,this.scoreVec=[],this.prize=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.errorcode=e.getInt32();var t=e.getUint32();if(e.getLen()-e.getPos()<4*t)return!1;this.scoreVec=[];for(var o=0;o<t;++o){var i;i=e.getInt32(),this.scoreVec.push(i)}if(e.getLen()-e.getPos()<4)return!1;var a=e.getUint32();this.prize=[];for(var r=0;r<a;++r){var s=new n;if(!s.read(e))return!1;this.prize.push(s)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setUint32(this.scoreVec.length),this.scoreVec.forEach(function(t){e.setInt32(t)}),e.setUint32(this.prize.length),this.prize.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_GetLegendReward=ea;var ta=function(){function e(){this.itemUUID=a.fromValue(0)}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.itemUUID=e.getLong(),0))},e.prototype.writeNoEnd=function(e){e.setLong(this.itemUUID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_HeadUp=ta;var oa=function(){function e(){this.errorcode=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_HeadUp=oa;var ia=function(){function e(){this.itemUUID=a.fromValue(0)}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.itemUUID=e.getLong(),0))},e.prototype.writeNoEnd=function(e){e.setLong(this.itemUUID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_HeadFrameUp=ia;var aa=function(){function e(){this.errorcode=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_HeadFrameUp=aa;var na=function(){function e(){}return e.prototype.read=function(){return!0},e.prototype.writeNoEnd=function(){},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_HeadFrameDown=na;var ra=function(){function e(){this.errorcode=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_HeadFrameDown=ra;var sa=function(){function e(){this.IsUseUrl=!1,this.headUrl=""}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<5)return!1;this.IsUseUrl=e.getBool();var t=e.getUint32();return!(e.getLen()-e.getPos()<t||(this.headUrl=e.getString(t),0))},e.prototype.writeNoEnd=function(e){e.setBool(this.IsUseUrl),e.setString(this.headUrl)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_SetUrlHead=sa;var ca=function(){function e(){this.errorcode=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_SetUrlHead=ca;var la=function(){function e(){}return e.prototype.read=function(){return!0},e.prototype.writeNoEnd=function(){},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_GetFirstRechargeReward=la;var da=function(){function e(){this.errorcode=0,this.prize=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.errorcode=e.getInt32();var t=e.getUint32();this.prize=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.prize.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setUint32(this.prize.length),this.prize.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_GetFirstRechargeReward=da;var ua=function(){function e(){}return e.prototype.read=function(){return!0},e.prototype.writeNoEnd=function(){},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_GetPVPDoubleReward=ua;var ha=function(){function e(){this.errorcode=0,this.lookAdNum=0,this.prize=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<12)return!1;this.errorcode=e.getInt32(),this.lookAdNum=e.getInt32();var t=e.getUint32();this.prize=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.prize.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setInt32(this.lookAdNum),e.setUint32(this.prize.length),this.prize.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_GetPVPDoubleReward=ha;var pa=function(){function e(){this.logMassage=""}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();return!(e.getLen()-e.getPos()<t||(this.logMassage=e.getString(t),0))},e.prototype.writeNoEnd=function(e){e.setString(this.logMassage)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_ClientLog=pa;var fa=function(){function e(){this.errorcode=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_ClientLog=fa;var ga=function(){function e(){this.watchADCount=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.watchADCount=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.watchADCount)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_WatchADCostGold=ga;var ma=function(){function e(){this.errorcode=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_WatchADCostGold=ma;var _a=function(){function e(){this.index=0,this.type=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.index=e.getInt32(),this.type=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.index),e.setInt32(this.type)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_BattlePassData=_a;var ya=function(){function e(){this.getRewards=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();if(e.getLen()-e.getPos()<8*t)return!1;this.getRewards=[];for(var o=0;o<t;++o){var i=new _a;if(!i.read(e))return!1;this.getRewards.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setUint32(this.getRewards.length),this.getRewards.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_BattlePass_GetReward=ya;var va=function(){function e(){this.errorcode=0,this.prize=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.errorcode=e.getInt32();var t=e.getUint32();this.prize=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.prize.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setUint32(this.prize.length),this.prize.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_BattlePass_GetReward=va;var Ca=function(){function e(){this.round=0,this.count=0,this.reward=new n}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.round=e.getInt32(),this.count=e.getInt32(),!this.reward.read(e)))},e.prototype.writeNoEnd=function(e){e.setInt32(this.round),e.setInt32(this.count),this.reward.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_DrawBox_GetReward=Ca;var Sa=function(){function e(){this.errorcode=0,this.prize=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.errorcode=e.getInt32();var t=e.getUint32();this.prize=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.prize.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setUint32(this.prize.length),this.prize.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_DrawBox_GetReward=Sa;var Ta=function(){function e(){this.id=0,this.count=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.id=e.getInt32(),this.count=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.id),e.setInt32(this.count)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_Cost_Get=Ta;var Ia=function(){function e(){this.errorcode=0,this.prize=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.errorcode=e.getInt32();var t=e.getUint32();this.prize=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.prize.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setUint32(this.prize.length),this.prize.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_Cost_Get=Ia;var Na=function(){function e(){}return e.prototype.read=function(){return!0},e.prototype.writeNoEnd=function(){},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_ShowJumpWeiXinApp=Na;var ba=function(){function e(){this.errorcode=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_ShowJumpWeiXinApp=ba;var wa=function(){function e(){this.encryptedData="",this.iv=""}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();if(e.getLen()-e.getPos()<t)return!1;if(this.encryptedData=e.getString(t),e.getLen()-e.getPos()<4)return!1;var o=e.getUint32();return!(e.getLen()-e.getPos()<o||(this.iv=e.getString(o),0))},e.prototype.writeNoEnd=function(e){e.setString(this.encryptedData),e.setString(this.iv)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_WeiXinAnalyzingMessage=wa;var Ea=function(){function e(){this.errorcode=0,this.info=""}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.errorcode=e.getInt32();var t=e.getUint32();return!(e.getLen()-e.getPos()<t||(this.info=e.getString(t),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setString(this.info)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_WeiXinAnalyzingMessage=Ea;var Pa=function(){function e(){}return e.prototype.read=function(){return!0},e.prototype.writeNoEnd=function(){},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_Live_Begin=Pa;var Ra=function(){function e(){}return e.prototype.read=function(){return!0},e.prototype.writeNoEnd=function(){},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_Live_Update=Ra;var La=function(){function e(){}return e.prototype.read=function(){return!0},e.prototype.writeNoEnd=function(){},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_WeiXinGetAnchorData=La;var Aa=function(){function e(){this.data=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();this.data.clear();for(var o=0;o<t;++o){var i;i=e.getLong();var a=new T_Anchor_Info;if(!a.read(e))return!1;this.data.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setUint32(this.data.size),this.data.forEach(function(t,o){e.setLong(o),t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Anchor_Data=Aa;var Da=function(){function e(){this.errorcode=0,this.anchorData=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.errorcode=e.getInt32();var t=e.getUint32();this.anchorData.clear();for(var o=0;o<t;++o){var i;i=e.getInt32();var a=new Aa;if(!a.read(e))return!1;this.anchorData.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setUint32(this.anchorData.size),this.anchorData.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_WeiXinGetAnchorData=Da;var Ma=function(){function e(){}return e.prototype.read=function(){return!0},e.prototype.writeNoEnd=function(){},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_Live_CreateRoom_ActivityID=Ma;var Ba=function(){function e(){this.errorcode=0,this.activityID="",this.longRoomID="",this.deadTime=0}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.errorcode=e.getInt32();var t=e.getUint32();if(e.getLen()-e.getPos()<t)return!1;if(this.activityID=e.getString(t),e.getLen()-e.getPos()<4)return!1;var o=e.getUint32();return!(e.getLen()-e.getPos()<o||(this.longRoomID=e.getString(o),e.getLen()-e.getPos()<4||(this.deadTime=e.getInt32(),0)))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setString(this.activityID),e.setString(this.longRoomID),e.setInt32(this.deadTime)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_Live_CreateRoom_ActivityID=Ba;var ka=function(){function e(){this.longRoomID="",this.queryStr=""}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();if(e.getLen()-e.getPos()<t)return!1;if(this.longRoomID=e.getString(t),e.getLen()-e.getPos()<4)return!1;var o=e.getUint32();return!(e.getLen()-e.getPos()<o||(this.queryStr=e.getString(o),0))},e.prototype.writeNoEnd=function(e){e.setString(this.longRoomID),e.setString(this.queryStr)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_Live_SyncQuery=ka;var Ga=function(){function e(){}return e.prototype.read=function(){return!0},e.prototype.writeNoEnd=function(){},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_Live_SyncQuery=Ga;var Oa=function(){function e(){}return e.prototype.read=function(){return!0},e.prototype.writeNoEnd=function(){},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_MiYaIndulge=Oa;var Ha=function(){function e(){this.errorcode=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_MiYaIndulge=Ha;var Va=function(){function e(){this.taskID=0,this.count=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.taskID=e.getInt32(),this.count=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.taskID),e.setInt32(this.count)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_ClientTaskUpdateCount=Va;var Fa=function(){function e(){this.errorcode=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_ClientTaskUpdateCount=Fa;var Ua=function(){function e(){}return e.prototype.read=function(){return!0},e.prototype.writeNoEnd=function(){},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_Get_Server_Time=Ua;var xa=function(){function e(){this.tGameTime=new p}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<28||!this.tGameTime.read(e))},e.prototype.writeNoEnd=function(e){this.tGameTime.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_Get_Server_Time=xa;var Ya=function(){function e(){this.count=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.count=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.count)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_Cooperation_Sweep=Ya;var ja=function(){function e(){this.errorcode=0,this.prize=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.errorcode=e.getInt32();var t=e.getUint32();this.prize=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.prize.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setUint32(this.prize.length),this.prize.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_Cooperation_Sweep=ja;var Wa=function(){function e(){this.timeId=0,this.rechargeID=0,this.lastTime=0,this.selectId=0,this.isBuy=!1}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<17||(this.timeId=e.getInt32(),this.rechargeID=e.getInt32(),this.lastTime=e.getInt32(),this.selectId=e.getInt32(),this.isBuy=e.getBool(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.timeId),e.setInt32(this.rechargeID),e.setInt32(this.lastTime),e.setInt32(this.selectId),e.setBool(this.isBuy)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_LuckyGiftData=Wa;var za=function(){function e(){}return e.prototype.read=function(){return!0},e.prototype.writeNoEnd=function(){},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_SynLuckyGift=za;var Ka=function(){function e(){this.luckyGifts=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();if(e.getLen()-e.getPos()<17*t)return!1;this.luckyGifts=[];for(var o=0;o<t;++o){var i=new Wa;if(!i.read(e))return!1;this.luckyGifts.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setUint32(this.luckyGifts.length),this.luckyGifts.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_SynLuckyGift=Ka;var qa=function(){function e(){this.timeId=0,this.selectId=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.timeId=e.getInt32(),this.selectId=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.timeId),e.setInt32(this.selectId)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_SelectLuckyGift=qa;var Qa=function(){function e(){this.errorcode=0,this.luckyGift=new Wa}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<21||(this.errorcode=e.getInt32(),!this.luckyGift.read(e)))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),this.luckyGift.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_SelectLuckyGift=Qa;var Xa=function(){function e(){this.fightToken="",this.changeRoles=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();if(e.getLen()-e.getPos()<t)return!1;if(this.fightToken=e.getString(t),e.getLen()-e.getPos()<4)return!1;var o=e.getUint32();if(e.getLen()-e.getPos()<8*o)return!1;this.changeRoles=[];for(var i=0;i<o;++i){var a;a=e.getLong(),this.changeRoles.push(a)}return!0},e.prototype.writeNoEnd=function(e){e.setString(this.fightToken),e.setUint32(this.changeRoles.length),this.changeRoles.forEach(function(t){e.setLong(t)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_ChangeEquip=Xa;var Ja=function(){function e(){this.errorcode=0,this.dropItems=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.errorcode=e.getInt32();var t=e.getUint32();if(e.getLen()-e.getPos()<12*t)return!1;this.dropItems.clear();for(var o=0;o<t;++o){var i,a;i=e.getLong(),a=e.getInt32(),this.dropItems.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setUint32(this.dropItems.size),this.dropItems.forEach(function(t,o){e.setLong(o),e.setInt32(t)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_ChangeEquip=Ja;var Za=function(){function e(){this.costGetMap=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();if(e.getLen()-e.getPos()<8*t)return!1;this.costGetMap.clear();for(var o=0;o<t;++o){var i,a;i=e.getInt32(),a=e.getInt32(),this.costGetMap.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setUint32(this.costGetMap.size),this.costGetMap.forEach(function(t,o){e.setInt32(o),e.setInt32(t)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_SyncCostGet=Za;var $a=function(){function e(){this.itemUUID=a.fromValue(0)}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.itemUUID=e.getLong(),0))},e.prototype.writeNoEnd=function(e){e.setLong(this.itemUUID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_PetUp=$a;var en=function(){function e(){this.errorcode=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_PetUp=en;var tn=function(){function e(){this.selectId=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.selectId=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.selectId)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_Day_Recharge_Select=tn;var on=function(){function e(){this.errorcode=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_Day_Recharge_Select=on;var an=function(){function e(){this.selectId=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.selectId=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.selectId)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_ROle_BattlePass_Select=an;var nn=function(){function e(){this.errorcode=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_ROle_BattlePass_Select=nn;var rn=function(){function e(){}return e.prototype.read=function(){return!0},e.prototype.writeNoEnd=function(){},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_ROLE_REBOOT_CLIENT=rn;var sn=function(){function e(){this.type=0,this.level=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.type=e.getInt32(),this.level=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.type),e.setInt32(this.level)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_QQHall_GetReward=sn;var cn=function(){function e(){this.errorcode=0,this.prize=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.errorcode=e.getInt32();var t=e.getUint32();this.prize=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.prize.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setUint32(this.prize.length),this.prize.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_QQHall_GetReward=cn;var ln=function(){function e(){this.is_blue_vip=!1,this.is_blue_year_vip=!1,this.blue_vip_level=0,this.is_super_blue_vip=!1}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<7||(this.is_blue_vip=e.getBool(),this.is_blue_year_vip=e.getBool(),this.blue_vip_level=e.getInt32(),this.is_super_blue_vip=e.getBool(),0))},e.prototype.writeNoEnd=function(e){e.setBool(this.is_blue_vip),e.setBool(this.is_blue_year_vip),e.setInt32(this.blue_vip_level),e.setBool(this.is_super_blue_vip)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_QQHall_RefreshBlueData=ln;var dn=function(){function e(){this.errorcode=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_QQHall_RefreshBlueData=dn;var un=function(){function e(){this.skinId=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.skinId=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.skinId)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_Car_Skin_Change=un;var hn=function(){function e(){this.errorcode=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_Car_Skin_Change=hn;var pn=function(){function e(){this.id=0,this.endTime=0,this.isFirst=!0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<9||(this.id=e.getInt32(),this.endTime=e.getInt32(),this.isFirst=e.getBool(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.id),e.setInt32(this.endTime),e.setBool(this.isFirst)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_PushGiftData=pn;var fn=function(){function e(){}return e.prototype.read=function(){return!0},e.prototype.writeNoEnd=function(){},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_Push_Gift=fn;var gn=function(){function e(){this.errorcode=0,this.list=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.errorcode=e.getInt32();var t=e.getUint32();if(e.getLen()-e.getPos()<9*t)return!1;this.list=[];for(var o=0;o<t;++o){var i=new pn;if(!i.read(e))return!1;this.list.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setUint32(this.list.length),this.list.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_Push_Gift=gn;var mn=function(){function e(){this.itemId=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.itemId=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.itemId)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_Get_Item_Num=mn;var _n=function(){function e(){this.errorcode=0,this.itemId=0,this.itemNum=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<12||(this.errorcode=e.getInt32(),this.itemId=e.getInt32(),this.itemNum=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setInt32(this.itemId),e.setInt32(this.itemNum)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_Get_Item_Num=_n;var yn=function(){function e(){this.chatStatus=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.chatStatus=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.chatStatus)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_Chat_Status=yn;var vn=function(){function e(){this.onoff=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();if(e.getLen()-e.getPos()<5*t)return!1;this.onoff.clear();for(var o=0;o<t;++o){var i,a;i=e.getInt32(),a=e.getBool(),this.onoff.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setUint32(this.onoff.size),this.onoff.forEach(function(t,o){e.setInt32(o),e.setBool(t)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_OnOffDataInfo=vn;var Cn=function(){function e(){}return e.prototype.read=function(){return!0},e.prototype.writeNoEnd=function(){},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_Continue_Recharge_GetReward=Cn;var Sn=function(){function e(){this.errorcode=0,this.prize=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.errorcode=e.getInt32();var t=e.getUint32();this.prize=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.prize.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setUint32(this.prize.length),this.prize.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_Continue_Recharge_GetReward=Sn;var Tn=function(){function e(){this.sendtype=0,this.sendnum=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.sendtype=e.getInt32(),this.sendnum=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.sendtype),e.setInt32(this.sendnum)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.Role_Subscribe=Tn;var In=function(){function e(){this.subscribe=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();if(e.getLen()-e.getPos()<12*t)return!1;this.subscribe.clear();for(var o=0;o<t;++o){var i;i=e.getInt32();var a=new Tn;if(!a.read(e))return!1;this.subscribe.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setUint32(this.subscribe.size),this.subscribe.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.Role_Subscribe_Data=In;var Nn=function(){function e(){}return e.prototype.read=function(){return!0},e.prototype.writeNoEnd=function(){},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_GetSubscribeData=Nn;var bn=function(){function e(){this.errorcode=0,this.data=new In}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),!this.data.read(e)))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),this.data.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_GetSubscribeData=bn;var wn=function(){function e(){this.type=0,this.sendtype=0,this.sendnum=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<12||(this.type=e.getInt32(),this.sendtype=e.getInt32(),this.sendnum=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.type),e.setInt32(this.sendtype),e.setInt32(this.sendnum)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_SetSubscribe=wn;var En=function(){function e(){this.errorcode=0,this.data=new In}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),!this.data.read(e)))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),this.data.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_SetSubscribe=En;var Pn=function(){function e(){this.country="",this.province="",this.city="",this.isp=""}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();if(e.getLen()-e.getPos()<t)return!1;if(this.country=e.getString(t),e.getLen()-e.getPos()<4)return!1;var o=e.getUint32();if(e.getLen()-e.getPos()<o)return!1;if(this.province=e.getString(o),e.getLen()-e.getPos()<4)return!1;var i=e.getUint32();if(e.getLen()-e.getPos()<i)return!1;if(this.city=e.getString(i),e.getLen()-e.getPos()<4)return!1;var a=e.getUint32();return!(e.getLen()-e.getPos()<a||(this.isp=e.getString(a),0))},e.prototype.writeNoEnd=function(e){e.setString(this.country),e.setString(this.province),e.setString(this.city),e.setString(this.isp)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_SetLocaltionInfo=Pn;var Rn=function(){function e(){this.country="",this.province="",this.city="",this.isp=""}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();if(e.getLen()-e.getPos()<t)return!1;if(this.country=e.getString(t),e.getLen()-e.getPos()<4)return!1;var o=e.getUint32();if(e.getLen()-e.getPos()<o)return!1;if(this.province=e.getString(o),e.getLen()-e.getPos()<4)return!1;var i=e.getUint32();if(e.getLen()-e.getPos()<i)return!1;if(this.city=e.getString(i),e.getLen()-e.getPos()<4)return!1;var a=e.getUint32();return!(e.getLen()-e.getPos()<a||(this.isp=e.getString(a),0))},e.prototype.writeNoEnd=function(e){e.setString(this.country),e.setString(this.province),e.setString(this.city),e.setString(this.isp)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_SetLocaltionInfo=Rn;var Ln=function(){function e(){this.heroId=0,this.shareLevel=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.heroId=e.getInt32(),this.shareLevel=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.heroId),e.setInt32(this.shareLevel)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_ProficiencyShare=Ln;var An=function(){function e(){this.errorCode=0,this.prize=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.errorCode=e.getInt32();var t=e.getUint32();this.prize=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.prize.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorCode),e.setUint32(this.prize.length),this.prize.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_ProficiencyShare=An;var Dn=function(){function e(){this.roleProficiency=new h}return e.prototype.read=function(e){return!!this.roleProficiency.read(e)},e.prototype.writeNoEnd=function(e){this.roleProficiency.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_SyncProficiencyData=Dn;var Mn=function(){function e(){this.carHp=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.carHp=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.carHp)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_SendCarHpToServer=Mn;var Bn=function(){function e(){this.selectId=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.selectId=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.selectId)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_SkyCastle_Recharge_Select=Bn;var kn=function(){function e(){this.errorcode=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_SkyCastle_Recharge_Select=kn;var Gn=function(){function e(){this.boxItemId=0,this.selectItemId=0,this.useBoxNum=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<12||(this.boxItemId=e.getInt32(),this.selectItemId=e.getInt32(),this.useBoxNum=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.boxItemId),e.setInt32(this.selectItemId),e.setInt32(this.useBoxNum)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_UseChooseBox=Gn;var On=function(){function e(){this.errorcode=0,this.prize=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.errorcode=e.getInt32();var t=e.getUint32();this.prize=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.prize.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setUint32(this.prize.length),this.prize.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_UseChooseBox=On;var Hn=function(){function e(){this.heroUUId=a.fromValue(0),this.skinId=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<12||(this.heroUUId=e.getLong(),this.skinId=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setLong(this.heroUUId),e.setInt32(this.skinId)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_HeroChangeSkin=Hn;var Vn=function(){function e(){this.errorcode=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_HeroChangeSkin=Vn;var Fn=function(){function e(){this.type=0,this.selectItemId=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.type=e.getInt32(),this.selectItemId=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.type),e.setInt32(this.selectItemId)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_SetSelfSelect=Fn;var Un=function(){function e(){this.errorcode=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_SetSelfSelect=Un;var xn=function(){function e(){this.battleArrayIndex=0,this.battleArrayName=""}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.battleArrayIndex=e.getInt32();var t=e.getUint32();return!(e.getLen()-e.getPos()<t||(this.battleArrayName=e.getString(t),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.battleArrayIndex),e.setString(this.battleArrayName)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_SetBattleArrayName=xn;var Yn=function(){function e(){this.errorcode=0,this.battleArrayName=""}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.errorcode=e.getInt32();var t=e.getUint32();return!(e.getLen()-e.getPos()<t||(this.battleArrayName=e.getString(t),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setString(this.battleArrayName)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_SetBattleArrayName=Yn;var jn=function(){function e(){this.index=0,this.type=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.index=e.getInt32(),this.type=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.index),e.setInt32(this.type)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_ScoreFundData=jn;var Wn=function(){function e(){this.getRewards=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();if(e.getLen()-e.getPos()<8*t)return!1;this.getRewards=[];for(var o=0;o<t;++o){var i=new jn;if(!i.read(e))return!1;this.getRewards.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setUint32(this.getRewards.length),this.getRewards.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_GetScoreFundRewards=Wn;var zn=function(){function e(){this.errorcode=0,this.prize=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.errorcode=e.getInt32();var t=e.getUint32();this.prize=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.prize.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setUint32(this.prize.length),this.prize.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_GetScoreFundRewards=zn;var Kn=function(){function e(){this.scoreFundData=new Ae}return e.prototype.read=function(e){return!!this.scoreFundData.read(e)},e.prototype.writeNoEnd=function(e){this.scoreFundData.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_SynChapterData=Kn;var qn=function(){function e(){this.type=0,this.params=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.type=e.getInt32();var t=e.getUint32();this.params.clear();for(var o=0;o<t;++o){var i;if(e.getLen()-e.getPos()<4)return!1;var a,n=e.getUint32();if(e.getLen()-e.getPos()<n)return!1;if(i=e.getString(n),e.getLen()-e.getPos()<4)return!1;var r=e.getUint32();if(e.getLen()-e.getPos()<r)return!1;a=e.getString(r),this.params.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.type),e.setUint32(this.params.size),this.params.forEach(function(t,o){e.setString(o),e.setString(t)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_Call_Php=qn;var Qn=function(){function e(){this.type=0,this.result=""}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.type=e.getInt32();var t=e.getUint32();return!(e.getLen()-e.getPos()<t||(this.result=e.getString(t),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.type),e.setString(this.result)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_Call_Php=Qn;var Xn=function(){function e(){}return e.prototype.read=function(){return!0},e.prototype.writeNoEnd=function(){},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_SyncNewerThreeDaysGift=Xn;var Jn=function(){function e(){this.errorcode=0,this.triggerNum=0,this.startTime=0,this.endTime=0,this.isFirst=!1}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<17||(this.errorcode=e.getInt32(),this.triggerNum=e.getInt32(),this.startTime=e.getInt32(),this.endTime=e.getInt32(),this.isFirst=e.getBool(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setInt32(this.triggerNum),e.setInt32(this.startTime),e.setInt32(this.endTime),e.setBool(this.isFirst)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_SyncNewerThreeDaysGift=Jn;var Zn=function(){function e(){}return e.prototype.read=function(){return!0},e.prototype.writeNoEnd=function(){},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Role_Continue_Recharge_GetReward_2=Zn;var $n=function(){function e(){this.errorcode=0,this.prize=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.errorcode=e.getInt32();var t=e.getUint32();this.prize=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.prize.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setUint32(this.prize.length),this.prize.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Role_Continue_Recharge_GetReward_2=$n,cc._RF.pop()},{"./BaseProtocols":"BaseProtocols",DataViewRW:"DataViewRW",ObjCollection:"ObjCollection",long:"long"}],RoleScoreFundTableData:[function(e,t,o){"use strict";cc._RF.push(t,"9ad5c+YhZZNC4nfMY4zI6j+","RoleScoreFundTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.RoleScoreFundTableData=void 0;var i=e("../TableReader"),a=e("./BaseTableData"),n=function(){function e(){this.id=0,this.needScore=0,this.freeRewards=new Array,this.superRewards=new Array,this.otherInfo=""}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.needScore=e.getNumber();for(var o=e.getString(),n=new i.TableReader(o);n.getPos()<n.getLen();)(s=new a.ItemInfo).readOriginal(n),this.freeRewards.push(s);o=e.getString();for(var r=new i.TableReader(o);r.getPos()<r.getLen();){var s;(s=new a.ItemInfo).readOriginal(r),this.superRewards.push(s)}this.otherInfo=e.getString()},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"RoleScoreFundTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.RoleScoreFundTableData=n,cc._RF.pop()},{"../TableReader":"TableReader","./BaseTableData":"BaseTableData"}],RoyaleBattlePassBuyView:[function(e,t,o){"use strict";cc._RF.push(t,"4ca74f1QztDoqmTsAFmZIh/","RoyaleBattlePassBuyView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=e("../../StaticData/CostGetTableData"),l=e("../../Global/GameGlobal"),d=e("../../common/NetworkProtocolCommon"),u=e("../../common/PlayerModule"),h=cc._decorator,p=h.ccclass,f=h.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.m_costLab=null,t.m_getLab=null,t}return a(t,e),t.path=function(){return"ui/royale/prefab/RoyaleBattlePassBuyView"},t.prototype.start=function(){var e=c.CostGetTableData.getById(5),t=l.G.StringManager.m_pDict.COMMON_COSTGET_LAB.split("|")[0],o=l.G.StringManager.formatStr(t,[e.cost[0].itemNum]);this.m_costLab.string=o;var i=l.G.StringManager.m_pDict.COMMON_COSTGET_LAB.split("|")[1],a=l.G.StringManager.formatStr(i,[e.get[0].itemNum]);this.m_getLab.string=a},t.prototype.onClickConfirmCallBack=function(){if(u.default.diamondNum<c.CostGetTableData.getById(5).cost[0].itemNum)return l.G.StringManager.PopWorldString("common_prompt_diamond_insufficient");d.default.callRoleCostGet(5)},n([f(cc.Label)],t.prototype,"m_costLab",void 0),n([f(cc.Label)],t.prototype,"m_getLab",void 0),n([s.Register_Class,p],t)}(r.default);o.default=g,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/CostGetTableData":"CostGetTableData","../../common/NetworkProtocolCommon":"NetworkProtocolCommon","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators"}],RoyaleBattlePassHelpView:[function(e,t,o){"use strict";cc._RF.push(t,"7e21cetYRlALoV4eEu8BHnG","RoyaleBattlePassHelpView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=cc._decorator,l=c.ccclass,d=(c.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.path=function(){return"ui/royale/prefab/RoyaleBattlePassHelpView"},n([s.Register_Class,l],t)}(r.default));o.default=d,cc._RF.pop()},{"../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators"}],RoyaleBattlePassItem:[function(e,t,o){"use strict";cc._RF.push(t,"70428EkT51NuJhMAif3Etg6","RoyaleBattlePassItem");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/manager/LoadResManager"),s=e("../../utils/GameTools"),c=e("../../modules/base/GameView"),l=e("../../Global/GameGlobal"),d=e("../../network/protocol/TypeProtocols"),u=e("../../common/PlayerModule"),h=e("../../utils/ConfigUtils"),p=e("../activity/ActivityModule"),f=e("../../network/protocol/ActivityProtocols"),g=e("../../network/ClientNetwork"),m=cc._decorator.ccclass,_=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.show=function(e,t){this.initCoinInfo(e,t),this.initFreeBoxInof(e,t),this.initLuxuryBoxInfo(e,t)},t.prototype.initLuxuryBoxInfo=function(e,t){var o=this,i=this.node.getChildByName("ExtraRewardsNode");i.reawds=e.extraPrize,i.coinNum=e.coinNum,i.id=e.id,r.default.loadSpriteFrame(e.extraItemIcon).then(function(t){cc.isValid(o.node)&&(i.getChildByName("ExtraRewardsIcon").scale=i.getChildByName("ExtraRewardsIcon").scale*e.extraItemScale/100,i.getChildByName("ExtraRewardsIcon").getComponent(cc.Sprite).spriteFrame=t)}).catch(function(e){cc.error(e)}),i.getChildByName("ExtraRewardsName").getComponent(cc.Label).string=e.extraItemName;var a=this.checkLuxuryRewardLockState();i.getChildByName("suo").active=!a,0==a&&s.default.registerTouchEvent(i.getChildByName("suo"),function(){l.G.StringManager.PopString(l.G.StringManager.getString("ROYALE_BATTLEPASS_SUO"))});var n=0,h=t;1==this.checkBoxReceiveState(e.id,2)?n=2:h>=e.coinNum&&1==a&&(n=1),2==n?(s.default.setNodeBright(i,!1),this.node.getChildByName("waifaguang").active=!1):this.node.getChildByName("waifaguang").active=1==n,i.receiveState=n,s.default.registerTouchEvent(i,function(e){var t=e.target;if(t.reawds)if(t.reawds.length>1)c.default.addPopView("BaseCtrl","BattlePassRewardPreview","BattlePassRewardPreview",{cb:function(){if(1!=u.default.getRoleAttrValByKey(d.ROLE_ATTR_VALUES.ROLE_ATTR_ROYALE_BATTLEPASS))return l.G.StringManager.PopString(l.G.StringManager.getString("ROYALE_BATTLEPASS_SUO"));var e=new f.T_Activity_RoyaleGetBoxsReward;e.index=t.id,e.type=2;var o=new f.C_Activity_RoyaleGetBoxsReward;o.getRewardsVec=[e],g.ClientNetwork.getInstance().Send(f.ACTIVITY_CLIENT_ENUM.P_Activity_RoyaleGetBoxsReward,o)},rewards:t.reawds,rewardState:t.receiveState});else{if(2==t.receiveState)return l.G.StringManager.PopString(l.G.StringManager.getWorldString("common_prompt_receive_over"));if(1==t.receiveState){if(1!=u.default.getRoleAttrValByKey(d.ROLE_ATTR_VALUES.ROLE_ATTR_ROYALE_BATTLEPASS))return l.G.StringManager.PopString(l.G.StringManager.getString("ROYALE_BATTLEPASS_SUO"));var i=new f.T_Activity_RoyaleGetBoxsReward;i.index=t.id,i.type=2;var a=new f.C_Activity_RoyaleGetBoxsReward;a.getRewardsVec=[i],g.ClientNetwork.getInstance().Send(f.ACTIVITY_CLIENT_ENUM.P_Activity_RoyaleGetBoxsReward,a)}else o.checkRewardIsHero(t.reawds[0])&&c.default.addPopView("BaseCtrl","DrawNewHeroCardView","DrawNewHeroCardView",{heroId:t.reawds[0].itemID,bShowNew:!0,bAction:!0})}})},t.prototype.initCoinInfo=function(e){var t=this;this.node.getChildByName("CoinBg").getChildByName("CoinNum").getComponent(cc.Label).string=e.coinNum.toString(),0>=e.coinNum&&r.default.loadSpriteFrame("ui/battle_pass/res/bei1").then(function(e){cc.isValid(t.node)&&(t.node.getChildByName("CoinBg").getComponent(cc.Sprite).spriteFrame=e)})},t.prototype.initFreeBoxInof=function(e,t){var o=this,i=this.node.getChildByName("RewardsNode");i.reawds=e.prize,i.coinNum=e.coinNum,i.id=e.id,r.default.loadSpriteFrame(e.itemIcon).then(function(t){cc.isValid(o.node)&&(i.getChildByName("RewardsIcon").scale=i.getChildByName("RewardsIcon").scale*e.itemScale/100,i.getChildByName("RewardsIcon").getComponent(cc.Sprite).spriteFrame=t)}).catch(function(e){cc.error(e)}),i.getChildByName("RewardsName").getComponent(cc.Label).string=e.itemName;var a=0,n=t;1==this.checkBoxReceiveState(e.id,1)?a=2:n>=e.coinNum&&(a=1),2==a?(s.default.setNodeBright(i,!1),this.node.getChildByName("waifaguangReward").active=!1):this.node.getChildByName("waifaguangReward").active=1==a,i.receiveState=a,s.default.registerTouchEvent(i,function(e){var t=e.target;if(t.reawds.length>1)c.default.addPopView("BaseCtrl","BattlePassRewardPreview","BattlePassRewardPreview",{cb:function(){var e=new f.T_Activity_RoyaleGetBoxsReward;e.index=t.id,e.type=1;var o=new f.C_Activity_RoyaleGetBoxsReward;o.getRewardsVec=[e],g.ClientNetwork.getInstance().Send(f.ACTIVITY_CLIENT_ENUM.P_Activity_RoyaleGetBoxsReward,o)},rewards:t.reawds,rewardState:t.receiveState});else{if(2==t.receiveState)return l.G.StringManager.PopString(l.G.StringManager.getWorldString("common_prompt_receive_over"));if(1==t.receiveState){var i=new f.T_Activity_RoyaleGetBoxsReward;i.index=t.id,i.type=1;var a=new f.C_Activity_RoyaleGetBoxsReward;a.getRewardsVec=[i],g.ClientNetwork.getInstance().Send(f.ACTIVITY_CLIENT_ENUM.P_Activity_RoyaleGetBoxsReward,a)}else o.checkRewardIsHero(t.reawds[0])&&c.default.addPopView("BaseCtrl","DrawNewHeroCardView","DrawNewHeroCardView",{heroId:t.reawds[0].itemID,bShowNew:!0,bAction:!0})}})},t.prototype.checkLuxuryRewardLockState=function(){var e=!1;return 1==u.default.getRoleAttrValByKey(d.ROLE_ATTR_VALUES.ROLE_ATTR_ROYALE_BATTLEPASS)&&(e=!0),e},t.prototype.checkBoxReceiveState=function(e,t){var o=p.default.getChickenDinnerData().normalPrize;return 2==t&&(o=p.default.getChickenDinnerData().superprize),!!o.has(e)&&o.get(e)},t.prototype.checkRewardIsHero=function(e){return!!h.default.getInstance().data["StaticData/HeroTableData"].hasOwnProperty(e.itemID)},n([m],t)}(cc.Component);o.default=_,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../common/PlayerModule":"PlayerModule","../../modules/base/GameView":"GameView","../../modules/manager/LoadResManager":"LoadResManager","../../network/ClientNetwork":"ClientNetwork","../../network/protocol/ActivityProtocols":"ActivityProtocols","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/ConfigUtils":"ConfigUtils","../../utils/GameTools":"GameTools","../activity/ActivityModule":"ActivityModule"}],RoyaleBattlePassTableData:[function(e,t,o){"use strict";cc._RF.push(t,"4230buCQHFLdbJVGwbO4V7B","RoyaleBattlePassTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.RoyaleBattlePassTableData=void 0;var i=e("../TableReader"),a=e("./BaseTableData"),n=function(){function e(){this.id=0,this.coinNum=0,this.itemName="",this.itemIcon="",this.itemScale=0,this.extraItemName="",this.extraItemIcon="",this.extraItemScale=0,this.prize=new Array,this.extraPrize=new Array,this.pointX=0}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.coinNum=e.getNumber(),this.itemName=e.getString(),this.itemIcon=e.getString(),this.itemScale=e.getNumber(),this.extraItemName=e.getString(),this.extraItemIcon=e.getString(),this.extraItemScale=e.getNumber();for(var o=e.getString(),n=new i.TableReader(o);n.getPos()<n.getLen();)(s=new a.ItemInfo).readOriginal(n),this.prize.push(s);o=e.getString();for(var r=new i.TableReader(o);r.getPos()<r.getLen();){var s;(s=new a.ItemInfo).readOriginal(r),this.extraPrize.push(s)}this.pointX=e.getNumber()},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"RoyaleBattlePassTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.RoyaleBattlePassTableData=n,cc._RF.pop()},{"../TableReader":"TableReader","./BaseTableData":"BaseTableData"}],RoyaleBattlePassView:[function(e,t,o){"use strict";cc._RF.push(t,"a1c29rR+bFAf6bbb+YW3QQ8","RoyaleBattlePassView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../StaticData/RoyaleBattlePassTableData"),s=e("../../common/PlayerModule"),c=e("../../modules/base/GameView"),l=e("../../view/activity/ActivityModule"),d=e("../../Global/GameGlobal"),u=e("../../common/EventConst"),h=e("../../modules/manager/EventManager"),p=e("../../utils/GameUtils"),f=e("../../network/protocol/TypeProtocols"),g=e("../../network/protocol/RoleProtocols"),m=e("../../network/ClientNetwork"),_=e("../../modules/base/BaseView"),y=e("../../modules/base/Decorators"),v=e("../../StaticData/ActivityTableData"),C=e("../../network/protocol/RechargeProtocols"),S=e("../../network/protocol/ActivityProtocols"),T=e("../../StaticData/RechargeTableData"),I=e("../../utils/GameTools"),N=cc._decorator,b=N.ccclass,w=N.property,E=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.itemPrefab=null,t.ScrollView=null,t.progressBarNode=null,t.curTrophyNode=null,t.curGetWayLab=null,t.popTipNode=null,t._scrollViewChildNode=[],t._curSeasonData=[],t._boxItemSpacing=300,t.m_skyCardItemId=1014,t.m_skyCardNum=0,t.rewardCount=0,t.nSeasonLeftTime=0,t}return a(t,e),t.path=function(){return"ui/royale/prefab/RoyaleBattlePass"},t.prototype.onLoad=function(){var e=this;this.m_skyCardItemId=Number(p.getConfigIntValue("royale_battlepass_coin_itemid")),m.ClientNetwork.getInstance().listenProtocol(g.ROLE_CLIENT_ENUM.P_Role_Get_Item_Num,function(t){t.resetPos();var o=new g.S_Role_Get_Item_Num;o.read(t)&&0===o.errorcode&&o.itemId==e.m_skyCardItemId&&(e.m_skyCardNum=o.itemNum,e.initSkyCastleBoxInfo())},this),m.ClientNetwork.getInstance().listenProtocol(S.ACTIVITY_CLIENT_ENUM.P_Activity_RoyaleGetBoxsReward,function(t){t.resetPos();var o=new S.S_Activity_RoyaleGetBoxsReward;o.read(t)&&(0==o.errorcode&&o.rewards.length>0&&(e.initSkyCastleBoxInfo(),e.showRewards(o.rewards)),0!=o.errorcode&&d.G.StringManager.PopString("S_Activity_RoyaleGetBoxsReward ERROR "+o.errorcode))},this),m.ClientNetwork.getInstance().listenProtocol(C.RECHARGE_CLIENT_ENUM.P_Recharge_Role_Recharge,function(){console.log("P_Recharge_Role_Recharge===================="),e.initSkyCastleBoxInfo(),1==s.default.getRoleAttrValByKey(f.ROLE_ATTR_VALUES.ROLE_ATTR_ROYALE_BATTLEPASS)&&(e.node.getChildByName("BuyButton").active=!1)},this)},t.prototype.start=function(){var e=this,t=new g.C_Role_Get_Item_Num;t.itemId=this.m_skyCardItemId,m.ClientNetwork.getInstance().Send(g.ROLE_CLIENT_ENUM.P_Role_Get_Item_Num,t),r.RoyaleBattlePassTableData.getDataMap().forEach(function(t){e._curSeasonData.push(t)});var o=Number(p.getConfigIntValue("royale_battlepass_rechargeid")),i=T.RechargeTableData.getById(o),a=I.default.getRechargeMoneyByPlatform(i)/100;this.node.getChildByName("BuyButton").getChildByName("label").getComponent(cc.Label).string="\uffe5"+a;var n=this._curSeasonData;this.progressBarNode.width=n[n.length-1].pointX,this.ScrollView.content.width=this.progressBarNode.width+n[0].pointX-this.itemPrefab.width/2+50,1==s.default.getRoleAttrValByKey(f.ROLE_ATTR_VALUES.ROLE_ATTR_ROYALE_BATTLEPASS)&&(this.node.getChildByName("BuyButton").active=!1)},t.prototype.initCurGetWayInfo=function(){this.curGetWayLab.string=s.default.getRoleAttrValByKey(f.ROLE_ATTR_VALUES.ROLE_ATTR_ROYALE_BOX_COIN_NUM)+"/"+p.getConfigIntValue("royale_battlepass_coin_limited")},t.prototype.initBoxProgress=function(){var e=null;this.curTrophyNode.x=5;var t,o=this._curSeasonData,i=0,a=this.m_skyCardNum;if(o.forEach(function(t,o){a>=t.coinNum&&(e=t,i=o)}),e)if(t=o[i+1]){var n=a-e.coinNum,r=t.coinNum-e.coinNum,s=(t.pointX-e.pointX)*(n/r),c=e.pointX+s;this.curTrophyNode.x=c,isNaN(this.curTrophyNode.x)&&(this.curTrophyNode.x=5),this.progressBarNode.getChildByName("bar").width=c}else this.progressBarNode.getChildByName("bar").width=this.progressBarNode.width,this.curTrophyNode.x=this.progressBarNode.width-5;else(t=o[i])?(n=a,r=t.coinNum,c=s=t.pointX*(n/r),this.curTrophyNode.x=c,isNaN(this.curTrophyNode.x)&&(this.curTrophyNode.x=5),this.progressBarNode.getChildByName("bar").width=c):(this.progressBarNode.getChildByName("bar").width=this.progressBarNode.width,this.curTrophyNode.x=this.progressBarNode.width-5);this.curTrophyNode.getChildByName("CoinLabel").getComponent(cc.Label).string=a.toString()},t.prototype.onRefreshSociatySeasonEndTime=function(){var e=this.node.getChildByName("sociatyEndTimeLab").getComponent(cc.Label),t=v.ActivityTableData.getById(S.ACTIVITY_ID_ENUM.P_Activity_SkyCastle),o=s.default.getServersTime(),i=t.param9-o;if(i<=0)return e.node.active=!1,void this.unschedule(this.onRefreshSociatySeasonEndTime);e.string="\u8ddd\u79bb\u6d3b\u52a8\u7ed3\u675f\u8fd8\u6709:"+function(e){var t=e%864e5/36e5,o=e%36e5/6e4,i=e%6e4/1e3;return parseInt((e/864e5).toString())+" \u5929 "+parseInt(t.toString())+" \u5c0f\u65f6 "+parseInt(o.toString())+" \u5206\u949f "+parseInt(i.toString())+" \u79d2 "}.call(this,1e3*i),0==e.node.active&&(e.node.active=!0)},t.prototype.initSkyCastleBoxInfo=function(){var e=this;this._scrollViewChildNode.forEach(function(e){e.destroy()}),this._scrollViewChildNode=[];var t=c.default.getViewByName("BattlePassRewardPreview");t&&t.view&&(t.view.node.active=!1,t.view.closeView());var o=this._curSeasonData,i=o.length,a=0;this.schedule(function(){var t=cc.instantiate(e.itemPrefab);t.parent=e.progressBarNode,t.getComponent("RoyaleBattlePassItem").show(o[a],e.m_skyCardNum),t.x=o[a].pointX,t.y=-50,t.active=!0,e._scrollViewChildNode.push(t),e.curTrophyNode.setSiblingIndex(99),a++},0,i-1,0);var n=l.default.checkReceiveSociatyBoxPrize();this.node.getChildByName("DrawButton").getComponent(cc.Button).interactable=n.length>0,this.node.getChildByName("DrawButton").getComponent(cc.Button).enableAutoGrayEffect=!(n.length>0),this.initBoxProgress(),this.onScrollToPoint(),this.initCurGetWayInfo()},t.prototype.showRewards=function(e){var t=this,o=function(){var e=t.tRewards.slice(6*t.rewardCount,6*(t.rewardCount+1));e.length>0&&c.default.addPopView("BaseCtrl","AcquirePopupView","AcquirePopupView",{items:e,closeCb:function(){t.rewardCount++,o.call(t)}})};this.rewardCount=0,this.tRewards=e,o.call(this)},t.prototype.onTotalGetRewardCallBack=function(){var e=l.default.checkReceiveSociatyBoxPrize();if(e.length<=0)return d.G.StringManager.PopString(d.G.StringManager.getWorldString("common_prompt_not_rewards"));var t=new S.C_Activity_RoyaleGetBoxsReward;t.getRewardsVec=e,m.ClientNetwork.getInstance().Send(S.ACTIVITY_CLIENT_ENUM.P_Activity_RoyaleGetBoxsReward,t)},t.prototype.onBuyBattlePass=function(){var e={rechargeID:Number(p.getConfigIntValue("royale_battlepass_rechargeid")),rechargeNum:1};this.sendEvent("SendProtocolRecharge",e)},t.prototype.onScrollToPoint=function(){for(var e=!1,t=this.m_skyCardNum,o=0,i=this._curSeasonData.length;o<i;o++){var a=(_=this._curSeasonData[o]).coinNum,n=_.id;if(a){var r=this.m_skyCardNum,c=0,d=l.default.checkBoxReceiveState(n,1);0!=d&&d||r>=a&&(c=1);var u=0,h=l.default.checkBoxReceiveState(n,2);if(0!=h&&h||r>=a&&1==s.default.getRoleAttrValByKey(f.ROLE_ATTR_VALUES.ROLE_ATTR_ROYALE_BATTLEPASS)&&(u=1),1==c||1==u){var p=this.ScrollView.getMaxScrollOffset(),g=_.pointX>p.x?p.x:_.pointX;this.ScrollView.setContentPosition(cc.v2(-g+this.itemPrefab.width,0)),e=!0;break}}}if(0==e){var m=null;for(o=0,i=this._curSeasonData.length;o<i;o++){var _;(_=this._curSeasonData[o]).coinNum&&t>=_.coinNum&&(m=_)}m&&(p=this.ScrollView.getMaxScrollOffset(),g=m.pointX>p.x?p.x:m.pointX,this.ScrollView.setContentPosition(cc.v2(-g+this.itemPrefab.width,0)))}},t.prototype.onClickAddCallBack=function(){c.default.addPopView("BaseCtrl","RoyaleBattlePassBuyView","RoyaleBattlePassBuyView")},t.prototype.onCloseView=function(){this.closeView()},t.prototype.onHelpCallBack=function(){c.default.addPopView("BaseCtrl","RoyaleBattlePassHelpView","RoyaleBattlePassHelpView")},t.prototype.update_pass_currency=function(){if(this.node){var e=new g.C_Role_Get_Item_Num;e.itemId=this.m_skyCardItemId,m.ClientNetwork.getInstance().Send(g.ROLE_CLIENT_ENUM.P_Role_Get_Item_Num,e);var t=c.default.getViewByName("RoyaleBattlePassBuyView");t&&t.view&&t.view.closeView()}},t.prototype.onDestroy=function(){h.default.Instance.off(this,u.default.SkyCastleSyncBoxEvent),h.default.Instance.off(this,u.default.SkyCastleSyncReceiveBoxEvent)},n([w(cc.Node)],t.prototype,"itemPrefab",void 0),n([w(cc.ScrollView)],t.prototype,"ScrollView",void 0),n([w(cc.Node)],t.prototype,"progressBarNode",void 0),n([w(cc.Node)],t.prototype,"curTrophyNode",void 0),n([w(cc.Label)],t.prototype,"curGetWayLab",void 0),n([w(cc.Node)],t.prototype,"popTipNode",void 0),n([y.Register_Class,b],t)}(_.default);o.default=E,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/ActivityTableData":"ActivityTableData","../../StaticData/RechargeTableData":"RechargeTableData","../../StaticData/RoyaleBattlePassTableData":"RoyaleBattlePassTableData","../../common/EventConst":"EventConst","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/base/GameView":"GameView","../../modules/manager/EventManager":"EventManager","../../network/ClientNetwork":"ClientNetwork","../../network/protocol/ActivityProtocols":"ActivityProtocols","../../network/protocol/RechargeProtocols":"RechargeProtocols","../../network/protocol/RoleProtocols":"RoleProtocols","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils","../../view/activity/ActivityModule":"ActivityModule"}],RoyaleIntroduceView:[function(e,t,o){"use strict";cc._RF.push(t,"775c0ODUIJHVa0m687lU0+i","RoyaleIntroduceView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=cc._decorator.ccclass,l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.path=function(){return"ui/royale/RoyaleIntroduce"},n([s.Register_Class,c],t)}(r.default);o.default=l,cc._RF.pop()},{"../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators"}],RoyaleMainView:[function(e,t,o){"use strict";cc._RF.push(t,"8f3c8uMgOZCx5kpklJQ0JE2","RoyaleMainView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../common/EventConst"),s=e("../../common/PlayerModule"),c=e("../../Global/GameGlobal"),l=e("../../modules/base/BaseView"),d=e("../../modules/base/Decorators"),u=e("../../modules/base/GameView"),h=e("../../modules/manager/EventManager"),p=e("../../network/ClientNetwork"),f=e("../../network/protocol/RoleProtocols"),g=e("../../network/protocol/TypeProtocols"),m=e("../../StaticData/DrawPrizePoolTableData"),_=e("../../StaticData/DrawPrizeTableData"),y=e("../../StaticData/StringValueTableData"),v=e("../../utils/ConfigUtils"),C=e("../../utils/GameTools"),S=e("../../utils/GameUtils"),T=cc._decorator,I=T.ccclass,N=T.property,b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.wishBoxPreviewNode=null,t.m_activity_end_time_lab=null,t}return a(t,e),t.path=function(){return"ui/royale/RoyaleMain"},t.prototype.start=function(){var e=this;p.ClientNetwork.getInstance().listenProtocol(f.ROLE_CLIENT_ENUM.P_Role_DrawPrize,function(t){t.resetPos();var o=new f.S_Role_DrawPrize;if(o.read(t))if(0===o.error&&o.prize.length>0){for(var i=function(e){if(2===v.default.getInstance().getItemByID(e).type){var t=s.default.getHeroCarData()[e];if(t&&0==t.bHeroLock)return!0}return!1},a=o.prize.length-1;a>=0;a--){var n=Math.floor(Math.random()*(a+1)),r=o.prize[n];o.prize[n]=o.prize[a],o.prize[a]=r}var c=[];o.prize.forEach(function(t){var o=i.call(e,t.dropID);c.forEach(function(e){e===t.dropID&&(o=!1)}),t.bNew=o,c.push(t.dropID)});var l=u.default.getViewByName("DrawCardShowView");l&&l.view?l.view.refreshView({prize:o.prize}):u.default.addPopView("BaseCtrl","DrawCardShowView","DrawCardShowView",{prize:o.prize}),e.freshWishNumShow()}else console.log("draw fail="+o.error)},this),h.default.Instance.on(r.default.SycnChangeRoleBag,function(){e.freshItemNum(),e.freshWishBoxShow()},this),this.freshItemNum(),this.freshWishNumShow(),this.freshWishBoxShow(),this.freshWishBoxPreview(),this.onRefreshActivityEndTime(),this.schedule(this.onRefreshActivityEndTime,1)},t.prototype.onRefreshActivityEndTime=function(){var e=this.m_activity_end_time_lab,t=s.default.getServersTime(),o=Number(S.getConfigIntValue("royale_activity_end_time"))-t;if(o<=0){this.unschedule(this.onRefreshActivityEndTime);var i=u.default.getViewByName("MainSceneView");return i&&i.view&&i.view.checkRoyaleNodeVisible(),e.string="\u6d3b\u52a8\u5df2\u7ed3\u675f"}e.string=c.G.StringManager.getString("ROYALE_ACTIVITY_END_TIME_TIP")+function(e){var t=e%864e5/36e5,i=e%36e5/6e4,a=e%6e4/1e3;return o>=86400?parseInt((e/864e5).toString())+" \u5929 "+parseInt(t.toString())+" \u5c0f\u65f6 "+parseInt(i.toString())+" \u5206 ":o>=3600?parseInt(t.toString())+" \u5c0f\u65f6 "+parseInt(i.toString())+" \u5206 "+parseInt(a.toString())+" \u79d2 ":o>=60?parseInt(i.toString())+" \u5206 "+parseInt(a.toString())+" \u79d2 ":parseInt(a.toString())+" \u79d2 "}.call(this,1e3*o)},t.prototype.freshItemNum=function(){if(0!=this.node.isValid){var e=Number(S.getConfigIntValue("royale_drawcard_itemid")),t=S.getItemTotalNumByItemId(e);this.node.getChildByName("top").getChildByName("item1").getChildByName("label_num").getComponent(cc.Label).string=t+"";var o=Number(S.getConfigIntValue("royale_baoyu_itemid")),i=S.getItemTotalNumByItemId(o);this.node.getChildByName("top").getChildByName("item2").getChildByName("label_num").getComponent(cc.Label).string=i+""}},t.prototype.freshWishNumShow=function(){var e=s.default.getRoleAttrValByKey(g.ROLE_ATTR_VALUES.ROLE_ATTR_ROYALE_DRAW_LUCKY);this.node.getChildByName("drawCardNode").getChildByName("wish").getChildByName("label_wish").getComponent(cc.Label).string=e+"/100",this.node.getChildByName("drawCardNode").getChildByName("wish").getChildByName("process").getComponent(cc.Sprite).fillRange=-e/100},t.prototype.freshWishBoxShow=function(){var e=this.getkWishBoxKeyNum();this.node.getChildByName("drawCardNode").getChildByName("btn_wishBox").getChildByName("bg").getChildByName("baowulizi").active=e>0},t.prototype.freshWishBoxPreview=function(){var e=_.DrawPrizeTableData.getDataMap().get(3).commonPool[0],t=0,o=[];m.DrawPrizePoolTableData.getDataMap().forEach(function(i){if(i.poolid==e.poolid){var a=i.prize[0],n=i.weight;t+=n;var r=v.default.Instance.getDorpItemsByID(a).dropRandom.split("|")[0],s=Number(r.split("#")[0]),c=Number(r.split("#")[1]),l={};l.itemId=s,l.itemNum=c,l.weight=n,o.push(l)}});for(var i=function(e){var i=o[e];C.default.createNormalItemsWithNames(i.itemId,i.itemNum,a.wishBoxPreviewNode.getChildByName("reward"),function(e){var o;e.scaleX=e.scaleY=.55,e.getChildByName("txt_name").getComponent(cc.Label).string=((o=1e3*i.weight/t)/10).toFixed(o%10>0?1:0)+"%",e.getChildByName("txt_name").getComponent(cc.Label).fontSize=36})},a=this,n=0;n<o.length;n++)i(n)},t.prototype.getkWishBoxKeyNum=function(){var e=Number(S.getConfigIntValue("royale_lucyboxkey_itemid"));return S.getItemTotalNumByItemId(e)},t.prototype.onClickRoyaleChickenDinnerCallBack=function(){var e=s.default.getServersTime();if(Number(S.getConfigIntValue("royale_activity_end_time"))-e<=0)return c.G.StringManager.PopString("\u8679\u732b\u84dd\u5154\u6d3b\u52a8\u5df2\u7ed3\u675f\uff01");u.default.addPopView("BaseCtrl","ChickenDinnerMainView","ChickenDinnerMainView")},t.prototype.onClickOpenBoxView=function(){u.default.addPopView("ShopMainCtrl","RoyaleBattlePassView","RoyaleBattlePassView")},t.prototype.onClickShopCallBack=function(){u.default.addPopView("BaseCtrl","RoyaleShopView","RoyaleShopView")},t.prototype.onClickRechargeView=function(){u.default.addPopView("ShopMainCtrl","RoyaleRechargeView","RoyaleRechargeView")},t.prototype.onClickDrawOne=function(){this.doDraw(1)},t.prototype.onCLickDrawTen=function(){this.doDraw(10)},t.prototype.doDraw=function(e){if(this.getkWishBoxKeyNum()>0)c.G.StringManager.PopStringOnce(c.G.StringManager.getWorldString("royale_can_draw_wishBox"));else{var t=Number(S.getConfigIntValue("royale_drawcard_itemid"));if(S.getItemTotalNumByItemId(t)<e)c.G.StringManager.PopStringOnce(y.StringValueTableData.getById(6).string_value);else{console.log("\u62bd\u5361num="+e);var o=new f.C_Role_DrawPrize;o.type=2,o.num=e,p.ClientNetwork.getInstance().Send(f.ROLE_CLIENT_ENUM.P_Role_DrawPrize,o)}}},t.prototype.onClickWishBox=function(){if(console.log("RoyaleMainView, \u70b9\u51fb\u4e86\u8bb8\u613f\u5b9d\u7bb1"),this.getkWishBoxKeyNum()<=0)c.G.StringManager.PopStringOnce(c.G.StringManager.getWorldString("royale_cannot_draw_wishBox"));else{console.log("\u8bb8\u613f\u5b9d\u7bb1\u62bd\u5361num=1");var e=new f.C_Role_DrawPrize;e.type=3,e.num=1,p.ClientNetwork.getInstance().Send(f.ROLE_CLIENT_ENUM.P_Role_DrawPrize,e)}},t.prototype.onClickIntroduceCallBack=function(){u.default.addPopView("BaseCtrl","RoyaleIntroduceView","RoyaleIntroduceView")},n([N(cc.Node)],t.prototype,"wishBoxPreviewNode",void 0),n([N(cc.Label)],t.prototype,"m_activity_end_time_lab",void 0),n([d.Register_Class,I],t)}(l.default);o.default=b,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/DrawPrizePoolTableData":"DrawPrizePoolTableData","../../StaticData/DrawPrizeTableData":"DrawPrizeTableData","../../StaticData/StringValueTableData":"StringValueTableData","../../common/EventConst":"EventConst","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/base/GameView":"GameView","../../modules/manager/EventManager":"EventManager","../../network/ClientNetwork":"ClientNetwork","../../network/protocol/RoleProtocols":"RoleProtocols","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/ConfigUtils":"ConfigUtils","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils"}],RoyaleRangeTableData:[function(e,t,o){"use strict";cc._RF.push(t,"f64eaKkfVBCP5UndPi0g09Q","RoyaleRangeTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.RoyaleRangeTableData=void 0;var i=e("../TableReader"),a=function(){function e(){this.id=0,this.rangeMin=0,this.rangeMax=0}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.rangeMin=e.getNumber(),this.rangeMax=e.getNumber()},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"RoyaleRangeTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.RoyaleRangeTableData=a,cc._RF.pop()},{"../TableReader":"TableReader"}],RoyaleRankListTableData:[function(e,t,o){"use strict";cc._RF.push(t,"b918dn1EcdJjrTyx/BtPZ4r","RoyaleRankListTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.RoyaleRankListTableData=void 0;var i=e("../TableReader"),a=e("./BaseTableData"),n=function(){function e(){this.id=0,this.rankMin=0,this.rankMax=0,this.rangeId=0,this.prize=new Array}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.rankMin=e.getNumber(),this.rankMax=e.getNumber(),this.rangeId=e.getNumber();for(var o=e.getString(),n=new i.TableReader(o);n.getPos()<n.getLen();){var r=new a.DropItem;r.readOriginal(n),this.prize.push(r)}},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"RoyaleRankListTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.RoyaleRankListTableData=n,cc._RF.pop()},{"../TableReader":"TableReader","./BaseTableData":"BaseTableData"}],RoyaleRechargeView:[function(e,t,o){"use strict";cc._RF.push(t,"a93edwdqL1FkKTgleKpPhEt","RoyaleRechargeView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../common/PlayerModule"),s=e("../../Global/GameGlobal"),c=e("../../modules/base/BaseView"),l=e("../../modules/base/Decorators"),d=e("../../network/ClientNetwork"),u=e("../../network/protocol/RechargeProtocols"),h=e("../../StaticData/RechargeTableData"),p=e("../../utils/ConfigUtils"),f=e("../../utils/GameTools"),g=e("../../utils/GameUtils"),m=cc._decorator,_=m.ccclass,y=m.property,v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.m_btn_buy=null,t.m_btn_buy2=null,t.m_btn_buy3=null,t.m_box1=null,t.m_box2=null,t.m_box3=null,t.rechargeId_buy1=0,t.rechargeId_buy2=0,t.rechargeId_buy3=0,t}return a(t,e),t.path=function(){return"ui/royale/RoyaleRecharge"},t.prototype.onLoad=function(){},t.prototype.start=function(){var e=this;d.ClientNetwork.getInstance().listenProtocol(u.RECHARGE_CLIENT_ENUM.P_Recharge_Role_Recharge,function(){e.initBuyViewDay1(),e.initBuyViewDay2(),e.initBuyViewDay3()},this),this.initBuyViewDay1(),this.initBuyViewDay2(),this.initBuyViewDay3()},t.prototype.initBuyViewDay1=function(){var e=this;this.m_box1.getChildByName("boxReward").removeAllChildren();var t=Number(g.getConfigIntValue("redcat_gift_recharge1")),o=h.RechargeTableData.getById(t);if(null!=o){o.prize.forEach(function(t){var o=p.default.getInstance().getDorpItemsByID(t.dropID);if(o)for(var i=o.dropRandom.split("|"),a=function(t){var o=i[t].split("#"),a=o[0],n=o[1]!=o[2]?"x"+o[1]+"~"+o[2]:"x"+o[1];f.default.createNormalItemsWithNames(a,-1,e.m_box1.getChildByName("boxReward"),function(e){e.getChildByName("txt_name").getComponent(cc.Label).string=n})},n=0;n<i.length;n++)a(n)});var i=f.default.getRechargeMoneyByPlatform(o)/100;this.rechargeId_buy1=t;var a=r.default.getRoleRechargeData().get(this.rechargeId_buy1);null!=a&&a.totalNum>=o.limitMaxNum&&o.limitMaxNum>0?(this.m_btn_buy.getComponent(cc.Button).interactable=!1,this.m_btn_buy.getChildByName("label").getComponent(cc.Label).string=s.G.StringManager.getWorldString("word_yishouwan")):(this.m_btn_buy.getComponent(cc.Button).interactable=!0,this.m_btn_buy.getChildByName("label").getComponent(cc.Label).string=s.G.StringManager.getString("SUPER_SALE_MONEY",i));var n=o.limitMaxNum;if(n<=0)this.node.getChildByName("newBoxRechargeNode").getChildByName("limit1").active=!1;else{var c=null!=a?a.totalNum:0;this.node.getChildByName("newBoxRechargeNode").getChildByName("limit1").active=!0,this.node.getChildByName("newBoxRechargeNode").getChildByName("limit1").getChildByName("label_limit").getComponent(cc.Label).string=s.G.StringManager.getWorldString("word_xiangou")+n+"\u6b21("+c+"/"+n+")"}}},t.prototype.initBuyViewDay2=function(){var e=this;this.m_box2.getChildByName("boxReward").removeAllChildren();var t=Number(g.getConfigIntValue("redcat_gift_recharge2")),o=h.RechargeTableData.getById(t);if(null!=o){o.prize.forEach(function(t){var o=p.default.getInstance().getDorpItemsByID(t.dropID);if(o)for(var i=o.dropRandom.split("|"),a=function(t){var o=i[t].split("#"),a=o[0],n=o[1]!=o[2]?"x"+o[1]+"~"+o[2]:"x"+o[1];f.default.createNormalItemsWithNames(a,-1,e.m_box2.getChildByName("boxReward"),function(e){e.getChildByName("txt_name").getComponent(cc.Label).string=n})},n=0;n<i.length;n++)a(n)});var i=f.default.getRechargeMoneyByPlatform(o)/100;this.rechargeId_buy2=t;var a=r.default.getRoleRechargeData().get(this.rechargeId_buy2);null!=a&&a.totalNum>=o.limitMaxNum&&o.limitMaxNum>0?(this.m_btn_buy2.getComponent(cc.Button).interactable=!1,this.m_btn_buy2.getChildByName("label").getComponent(cc.Label).string=s.G.StringManager.getWorldString("word_yishouwan")):(this.m_btn_buy2.getComponent(cc.Button).interactable=!0,this.m_btn_buy2.getChildByName("label").getComponent(cc.Label).string=s.G.StringManager.getString("SUPER_SALE_MONEY",i));var n=o.limitMaxNum;if(n<=0)this.node.getChildByName("newBoxRechargeNode").getChildByName("limit2").active=!1;else{var c=null!=a?a.totalNum:0;this.node.getChildByName("newBoxRechargeNode").getChildByName("limit2").active=!0,this.node.getChildByName("newBoxRechargeNode").getChildByName("limit2").getChildByName("label_limit").getComponent(cc.Label).string=s.G.StringManager.getWorldString("word_xiangou")+n+"\u6b21("+c+"/"+n+")"}}},t.prototype.initBuyViewDay3=function(){var e=this;this.m_box3.getChildByName("boxReward").removeAllChildren();var t=Number(g.getConfigIntValue("redcat_gift_recharge3")),o=h.RechargeTableData.getById(t);if(null!=o){o.prize.forEach(function(t){var o=p.default.getInstance().getDorpItemsByID(t.dropID);if(o)for(var i=o.dropRandom.split("|"),a=function(t){var o=i[t].split("#"),a=o[0],n=o[1]!=o[2]?"x"+o[1]+"~"+o[2]:"x"+o[1];f.default.createNormalItemsWithNames(a,-1,e.m_box3.getChildByName("boxReward"),function(e){e.getChildByName("txt_name").getComponent(cc.Label).string=n})},n=0;n<i.length;n++)a(n)});var i=f.default.getRechargeMoneyByPlatform(o)/100;this.rechargeId_buy3=t;var a=r.default.getRoleRechargeData().get(this.rechargeId_buy3);null!=a&&a.totalNum>=o.limitMaxNum&&o.limitMaxNum>0?(this.m_btn_buy3.getComponent(cc.Button).interactable=!1,this.m_btn_buy3.getChildByName("label").getComponent(cc.Label).string=s.G.StringManager.getWorldString("word_yishouwan")):(this.m_btn_buy3.getComponent(cc.Button).interactable=!0,this.m_btn_buy3.getChildByName("label").getComponent(cc.Label).string=s.G.StringManager.getString("SUPER_SALE_MONEY",i));var n=o.limitMaxNum;if(n<=0)this.node.getChildByName("newBoxRechargeNode").getChildByName("limit3").active=!1;else{var c=null!=a?a.totalNum:0;this.node.getChildByName("newBoxRechargeNode").getChildByName("limit3").active=!0,this.node.getChildByName("newBoxRechargeNode").getChildByName("limit3").getChildByName("label_limit").getComponent(cc.Label).string="\u9650\u8d2d"+n+"\u6b21("+c+"/"+n+")"}}},t.prototype.onClickBuy=function(){if(!(this.rechargeId_buy1<=0)){var e={rechargeID:this.rechargeId_buy1,rechargeNum:1};this.sendEvent("SendProtocolRecharge",e)}},t.prototype.onClickBuy2=function(){if(!(this.rechargeId_buy2<=0)){var e={rechargeID:this.rechargeId_buy2,rechargeNum:1};this.sendEvent("SendProtocolRecharge",e)}},t.prototype.onClickBuy3=function(){if(!(this.rechargeId_buy3<=0)){var e={rechargeID:this.rechargeId_buy3,rechargeNum:1};this.sendEvent("SendProtocolRecharge",e)}},n([y(cc.Node)],t.prototype,"m_btn_buy",void 0),n([y(cc.Node)],t.prototype,"m_btn_buy2",void 0),n([y(cc.Node)],t.prototype,"m_btn_buy3",void 0),n([y(cc.Node)],t.prototype,"m_box1",void 0),n([y(cc.Node)],t.prototype,"m_box2",void 0),n([y(cc.Node)],t.prototype,"m_box3",void 0),n([l.Register_Class,_],t)}(c.default);o.default=v,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/RechargeTableData":"RechargeTableData","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../network/ClientNetwork":"ClientNetwork","../../network/protocol/RechargeProtocols":"RechargeProtocols","../../utils/ConfigUtils":"ConfigUtils","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils"}],RoyaleRoomTableData:[function(e,t,o){"use strict";cc._RF.push(t,"d6044p3K3pJZZD9tOX2FcDi","RoyaleRoomTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.RoyaleRoomTableData=void 0;var i=e("../TableReader"),a=function(){function e(){this.id=0,this.equipId=0,this.weekday=0,this.weight=0,this.desc="",this.initial_effect_desc="",this.max_effect_desc=""}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.equipId=e.getNumber(),this.weekday=e.getNumber(),this.weight=e.getNumber(),this.desc=e.getString(),this.initial_effect_desc=e.getString(),this.max_effect_desc=e.getString()},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"RoyaleRoomTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.RoyaleRoomTableData=a,cc._RF.pop()},{"../TableReader":"TableReader"}],RoyaleShopView:[function(e,t,o){"use strict";cc._RF.push(t,"8495cPKRgtGbbWXaS2kO/vP","RoyaleShopView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=e("../../network/protocol/RoleProtocols"),l=e("../../network/ClientNetwork"),d=e("../../Global/GameGlobal"),u=e("../../modules/base/GameView"),h=e("../../common/PlayerModule"),p=cc._decorator,f=p.ccclass,g=p.property,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.m_MoneyCountLabel=null,t.m_ShopItemLayout=null,t.m_ShopItemPrefab=null,t.m_nGetRandShopId=7,t.m_consumeItemId=1019,t}return a(t,e),t.path=function(){return"ui/royale/RoyaleShop"},t.prototype.start=function(){var e=this,t=new c.C_Role_GetRandShop;t.shopID=this.m_nGetRandShopId,l.ClientNetwork.getInstance().Send(c.ROLE_CLIENT_ENUM.P_Role_GetRandShop,t),l.ClientNetwork.getInstance().listenProtocol(c.ROLE_CLIENT_ENUM.P_Role_SynRandShopData,function(t){t.resetPos();var o=new c.S_Role_SynRandShopData;o.read(t)&&o.shopID===e.m_nGetRandShopId&&e.initShopListInfo(o.shopData)},this),l.ClientNetwork.getInstance().listenProtocol(c.ROLE_CLIENT_ENUM.P_Role_RandShopBuy,function(t){t.resetPos();var o=new c.S_Role_RandShopBuy;if(o.read(t))if(0===o.errorcode&&o.prize.length>0){u.default.addPopView("BaseCtrl","AcquirePopupView","AcquirePopupView",{items:o.prize});var i=u.default.getViewByName("ShopConfirmBuy");i&&i.view&&(i.view.node.active=!1,i.view.closeView()),e.m_MoneyCountLabel.string=h.default.getItemCountByBag(e.m_consumeItemId)}else d.G.StringManager.PopString("S_Role_RandShopBuy ERROR  "+o.errorcode)},this)},t.prototype.initShopListInfo=function(e){var t=this;this.m_ShopItemLayout.node.destroyAllChildren(),this.scheduleOnce(function(){e.positions.forEach(function(e,o){var i=cc.instantiate(t.m_ShopItemPrefab);i.parent=t.m_ShopItemLayout.node,i.getComponent("NavigationShopItem").init(e,o,t.callRoleRandShopBuy),i.scale=.8})}),this.m_MoneyCountLabel.string=h.default.getItemCountByBag(this.m_consumeItemId)},t.prototype.callRoleRandShopBuy=function(e){var t=new c.C_Role_RandShopBuy;t.shopID=7,t.shopPosition=e.shopPosition,t.shopItemID=e.shopItemID,l.ClientNetwork.getInstance().Send(c.ROLE_CLIENT_ENUM.P_Role_RandShopBuy,t)},n([g(cc.Label)],t.prototype,"m_MoneyCountLabel",void 0),n([g(cc.Layout)],t.prototype,"m_ShopItemLayout",void 0),n([g(cc.Prefab)],t.prototype,"m_ShopItemPrefab",void 0),n([s.Register_Class,f],t)}(r.default);o.default=m,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/base/GameView":"GameView","../../network/ClientNetwork":"ClientNetwork","../../network/protocol/RoleProtocols":"RoleProtocols"}],RoyaleUtils:[function(e,t,o){"use strict";cc._RF.push(t,"ad8006gxk5As52jLyphz7c2","RoyaleUtils"),Object.defineProperty(o,"__esModule",{value:!0}),o.RoyaleUtls=void 0;var i=e("../../common/PlayerModule"),a=function(){function e(){}return Object.defineProperty(e,"Instance",{get:function(){return null==this.g_instance&&(this.g_instance=new e),this.g_instance},enumerable:!1,configurable:!0}),e.prototype.getRecharViewRed=function(){return!(i.default.getCostGetDataByID(e.FREE_COST_ID)>0)},e.FREE_COST_ID=102,e}();o.RoyaleUtls=a,cc._RF.pop()},{"../../common/PlayerModule":"PlayerModule"}],SafeNumber:[function(e,t,o){"use strict";cc._RF.push(t,"6a3fbjgNzJKF43vcdfEm7E6","SafeNumber"),Object.defineProperty(o,"__esModule",{value:!0}),o.SafeNumber=void 0;var i=function(){function e(e){this.key=0,this._value=0,this.value=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value^this.key},set:function(e){this.key=Math.floor(100*Math.random())+8089,this._value=e^this.key},enumerable:!1,configurable:!0}),e}();o.SafeNumber=i,cc._RF.pop()},{}],SeasonClosingView:[function(e,t,o){"use strict";cc._RF.push(t,"fc713pBi3dNrJ5HJVPQIEC4","SeasonClosingView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=e("../../utils/GamePlatform"),l=e("../../../load"),d=e("../../Global/GameGlobal"),u=e("../../network/protocol/TypeProtocols"),h=e("../../common/PlayerModule"),p=e("../../utils/GameTools"),f=e("../../StaticData/RankListPrizeTableData"),g=e("../../utils/GameUtils"),m=e("../../utils/ConfigUtils"),_=e("../../StaticData/BaseTableData"),y=cc._decorator,v=y.ccclass,C=y.property,S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.rankLab=null,t.scoreLab=null,t.rewardLayout=null,t.closeTipNode=null,t.continueTipNode=null,t.lastNode=null,t.newNode=null,t.lastInfoNode=null,t.newInfoNode=null,t.newScoreLab=null,t}return a(t,e),t.path=function(){return"ui/season_closing/prefab/SeasonClosing"},t.prototype.onLoad=function(){var e=this;this.node.on(cc.Node.EventType.TOUCH_END,function(){if(1==e.closeTipNode.active)return e.closeTipNode.active=!1,void e.closeView();1==e.continueTipNode.active&&(e.continueTipNode.active=!1,e.newNode.active=!0,e.newNode.getComponent(sp.Skeleton).setAnimation(0,"idle",!1),e.lastNode.active=!1,e.newInfoNode.active=!0,e.newInfoNode.opacity=0,cc.tween(e.lastInfoNode).to(.5,{opacity:0},{easing:"sineOut"}).call(function(){e.lastInfoNode.active=!1}).start(),cc.tween(e.newInfoNode).delay(.3).to(.5,{opacity:255},{easing:"sineIn"}).call(function(){e.closeTipNode.active=!0}).start())}),g.setLocalData("PopSeasonEnd","1")},t.prototype.start=function(){var e=this;this.lastNode.active=!0,this.lastNode.getComponent(sp.Skeleton).setAnimation(0,"idle",!1),this.lastInfoNode.active=!0,cc.tween(this.lastNode).delay(.5).call(function(){e.continueTipNode.active=!0}).start(),this.newScoreLab.string=h.default.getRoleAttrValByKey(u.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE)},t.prototype.init=function(e){e&&e.nRankNum?this.onShowSelfRankInfo(e.nRankNum):this.onShowSelfRankInfo(0)},t.prototype.onCallRank=function(){var e=d.G.StringManager.getString("RANKLIST_URL");(c.GamePlatform.isWechat()||c.GamePlatform.isQQMiniGame()||c.GamePlatform.isByteDanceMiniGame()||c.GamePlatform.isKuaishouMiniGame())&&(e=l.getSubmitReviewState()?d.G.StringManager.getString("RANKLIST_URL"):d.G.StringManager.getString("RANKLIST_URL_MOBILE")),(c.GamePlatform.getMiYa()||c.GamePlatform.isQQGameRoom())&&(e=d.G.StringManager.getString("RANKLIST_URL_MOBILE"));var t=h.default.uuidTransformRoieId();"bigBlue"==c.GamePlatform.getMiYaVideoTypeNoSet()&&(e=d.G.StringManager.getString("RANKLIST_URL_MOBILE_BIGBLUE")),"ly5add7"==c.GamePlatform.getMiYaVideoTypeNoSet()&&(e=d.G.StringManager.getString("RANKLIST_URL_MOBILE_ADDCHANNEL")),e+="?",e+="ranktype="+u.RANKLIST_TYPE.RANKLIST_TYPE_SEASION_HISTORY,e+="&roleid="+t,e+="&page=1";var o=new XMLHttpRequest;o.onreadystatechange=function(){if(4==o.readyState&&o.status>=200&&o.status<400){var e=o.responseText.toString();e=(e=(e=e.replace('"','"')).replace("\ufeff","")).replace(" ",""),JSON.parse(e)}},o.open("GET",e,!0),o.send()},t.prototype.onShowSelfRankInfo=function(e){var t,o=this,i=e;i>0?(this.rankLab.string=i+"",(t=h.default.getLastSeasonData())&&(this.scoreLab.string=t.score+""),this.rewardLayout.node.active=!0,this.getSeasonRewards(i).forEach(function(e){p.default.createNormalItems(e.dropID,e.dropNum,o.rewardLayout.node,function(e){e.scale=.85})})):(t=h.default.getLastSeasonData())?(this.rewardLayout.node.active=!0,t.score>=3e3?this.getNotRankSeasonRewards().forEach(function(e){p.default.createNormalItems(e.dropID,e.dropNum,o.rewardLayout.node,function(e){e.scale=.85})}):this.rewardLayout.node.active=!1,this.scoreLab.string=t.score+""):this.rewardLayout.node.active=!1,0==this.rewardLayout.node.active&&(this.lastInfoNode.getChildByName("mailSendLab").active=!1)},t.prototype.getNotRankSeasonRewards=function(){var e=[],t=m.default.getInstance().getDorpItemsByID(Number(g.getConfigIntValue("season_rank_not")));if(t){var o=[],i=t.dropRandom.split("|");for(var a in i){var n=i[a].split("#"),r=new _.DropItem;r.dropID=n[0],r.dropNum=n[1],o.push(r)}e=o}return e},t.prototype.getSeasonRewards=function(e){var t=h.default.getCurSeasonData();if(!t||0==t.seasonID)return[];var o=[];f.RankListPrizeTableData.getDataMap().forEach(function(e){e.type==t.seasonID-1&&o.push(e)});for(var i=[],a=0;a<o.length;a++){var n=o[a].rankMin,r=o[a].rankMax;if(e>=n&&e<=r){i=o[a].prize;break}}return i},n([C(cc.Label)],t.prototype,"rankLab",void 0),n([C(cc.Label)],t.prototype,"scoreLab",void 0),n([C(cc.Layout)],t.prototype,"rewardLayout",void 0),n([C(cc.Node)],t.prototype,"closeTipNode",void 0),n([C(cc.Node)],t.prototype,"continueTipNode",void 0),n([C(cc.Node)],t.prototype,"lastNode",void 0),n([C(cc.Node)],t.prototype,"newNode",void 0),n([C(cc.Node)],t.prototype,"lastInfoNode",void 0),n([C(cc.Node)],t.prototype,"newInfoNode",void 0),n([C(cc.Label)],t.prototype,"newScoreLab",void 0),n([s.Register_Class,v],t)}(r.default);o.default=S,cc._RF.pop()},{"../../../load":"load","../../Global/GameGlobal":"GameGlobal","../../StaticData/BaseTableData":"BaseTableData","../../StaticData/RankListPrizeTableData":"RankListPrizeTableData","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/ConfigUtils":"ConfigUtils","../../utils/GamePlatform":"GamePlatform","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils"}],SeasonTableData:[function(e,t,o){"use strict";cc._RF.push(t,"eb1b2F1rWJMiZkd5iUCrKop","SeasonTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.SeasonTableData=void 0;var i=e("../TableReader"),a=function(){function e(){this.id=0,this.beginTime=0,this.lastTime=0,this.minScore=0,this.maxScore=0,this.scoreDecPre=0,this.nameUrl="",this.showPrize=new Array,this.name_word=""}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.beginTime=e.getNumber(),this.lastTime=e.getNumber(),this.minScore=e.getNumber(),this.maxScore=e.getNumber(),this.scoreDecPre=e.getNumber(),this.nameUrl=e.getString();for(var o=e.getString(),a=new i.TableReader(o);a.getPos()<a.getLen();){var n=new DropItem;n.readOriginal(a),this.showPrize.push(n)}this.name_word=e.getString()},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"SeasonTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.SeasonTableData=a,cc._RF.pop()},{"../TableReader":"TableReader"}],SelectHeroCardRewardView:[function(e,t,o){"use strict";cc._RF.push(t,"0e964EfmOZOiJu91VQ48W18","SelectHeroCardRewardView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../modules/base/BaseView"),s=e("../modules/base/Decorators"),c=e("../utils/GameTools"),l=e("../common/PlayerModule"),d=e("../utils/ConfigUtils"),u=e("../network/protocol/BaseProtocols"),h=e("../modules/manager/LoadResManager"),p=e("../Global/GameGlobal"),f=cc._decorator,g=f.ccclass,m=f.property,_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.scrollListNode=null,t._rewardsArrNode=[],t}return a(t,e),t.path=function(){return"ui/CommonPrefab/SelectHeroCardReward"},t.prototype.init=function(e){var t=this;this._tData=e;var o=e.rewards;o.sort(function(e,o){var i=t.checkHaveHero(e.itemID);return(1==t.checkHaveHero(o.itemID)?1:0)-(1==i?1:0)});var i=o.length,a=0;this.schedule(function(){if(o[a]){var n=new u.T_Reward;n.dropType=1,n.dropID=o[a].itemID,n.dropNum=o[a].itemNum,c.default.createNormalItems(o[a].itemID,o[a].itemNum,t.scrollListNode.content,function(o){if(0==t.checkHaveHero(n.dropID)&&e.bNeedBright)c.default.setNodeBright(o,!1);else{var a=new cc.Node("select");a.parent=o;var r=a.addComponent(cc.Sprite);h.default.loadSpriteFrame("ui/drawcard/res/xianzhong").then(function(e){r.spriteFrame=e}),a.active=!1,t._rewardsArrNode.length<=0&&!e.selectId&&(a.active=!0),a.scale=1.22}o.getChildByName("num").active=!1,o.ItemInfo=n,o.on(cc.Node.EventType.TOUCH_END,function(e){t.clickCardCallBack(e.target)}),o.scale=.9,t._rewardsArrNode.push(o),t._rewardsArrNode.length==i&&t.scheduleOnce(function(){if(e.selectId)for(var o=0;o<t._rewardsArrNode.length;o++){var i=t._rewardsArrNode[o];if(i.ItemInfo.dropID==e.selectId){t.clickCardCallBack(i);var a=-i.y-i.height/2,n=t.scrollListNode.getComponent(cc.ScrollView).getMaxScrollOffset();a<0&&(a=0),a>n.y&&(a=n.y),t.scrollListNode.getComponent(cc.ScrollView).setContentPosition(cc.v2(0,a));break}}})})}if(++a>=o.length){var r=Math.ceil(o.length/5),s=Math.floor(t._rewardsArrNode[0].height*t._rewardsArrNode[0].scale)+t.scrollListNode.content.getComponent(cc.Layout).spacingY;t.scrollListNode.content.height=s*r}},0,i-1,0)},t.prototype.clickCardCallBack=function(e){if(!e.getChildByName("select"))return p.G.StringManager.PopString("\u5c1a\u672a\u83b7\u5f97\u6b64\u82f1\u96c4\uff01");this._rewardsArrNode.forEach(function(t){t.getChildByName("select")&&(t.getChildByName("select").active=t==e)})},t.prototype.checkHaveHero=function(e){if(2!=d.default.getInstance().getItemByID(e).type)return!1;for(var t=l.default.getHeroCarData(),o=0;o<t.length;o++)if(t[o]&&e==t[o].heroId&&1==t[o].bHeroLock)return!0;return!1},t.prototype.onClickDetermineCallBack=function(){var e=0;this._rewardsArrNode.forEach(function(t){t.getChildByName("select")&&1==t.getChildByName("select").active&&(e=t.ItemInfo.dropID)}),this._tData.cb&&this._tData.cb(e),this.closeView()},t.prototype.onDestroy=function(){this.unscheduleAllCallbacks()},n([m(cc.ScrollView)],t.prototype,"scrollListNode",void 0),n([s.Register_Class,g],t)}(r.default);o.default=_,cc._RF.pop()},{"../Global/GameGlobal":"GameGlobal","../common/PlayerModule":"PlayerModule","../modules/base/BaseView":"BaseView","../modules/base/Decorators":"Decorators","../modules/manager/LoadResManager":"LoadResManager","../network/protocol/BaseProtocols":"BaseProtocols","../utils/ConfigUtils":"ConfigUtils","../utils/GameTools":"GameTools"}],ServerAddrInfo:[function(e,t,o){"use strict";cc._RF.push(t,"fca56wkl2hKUIkz8clF60Nm","ServerAddrInfo");var i=this&&this.__awaiter||function(e,t,o,i){return new(o||(o=Promise))(function(a,n){function r(e){try{c(i.next(e))}catch(t){n(t)}}function s(e){try{c(i.throw(e))}catch(t){n(t)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(r,s)}c((i=i.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){var o,i,a,n,r={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return n={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function s(e){return function(t){return c([e,t])}}function c(n){if(o)throw new TypeError("Generator is already executing.");for(;r;)try{if(o=1,i&&(a=2&n[0]?i.return:n[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return r.label++,{value:n[1],done:!1};case 5:r.label++,i=n[1],n=[0];continue;case 7:n=r.ops.pop(),r.trys.pop();continue;default:if(!(a=(a=r.trys).length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){r=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){r.label=n[1];break}if(6===n[0]&&r.label<a[1]){r.label=a[1],a=n;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(n);break}a[2]&&r.ops.pop(),r.trys.pop();continue}n=t.call(e,r)}catch(s){n=[6,s],i=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.ServerAddrInfo=o.ServerListStruct=void 0;var n=e("../../load"),r=e("../Global/GameGlobal"),s=e("../network/ClientNetwork"),c=e("../network/LocalMessage"),l=e("../utils/GamePlatform"),d=e("../utils/GameUtils"),u=e("../utils/QQGameHallUtils"),h=e("../utils/subUtils/TypeDef"),p=function(e,t,o){this.groupId=0,this.name="",this.loginTime=0,this.groupId=e,this.name=t,this.loginTime=o};o.ServerListStruct=p;var f=function(){function e(){this._serverList=new Array,this._lastLoginGroup=0,this._newOpenGroup=0,this._maxLoginTime=0}return e.getInstance=function(){return this._self||(this._self=new e),this._self},e.prototype.initServerList=function(e){this._serverList.splice(0,this._serverList.length);for(var t=0;t<e.length;t++){console.log("initserverlist "+t+" groupid = "+e[t].groupid);var o=0;e[t].roles.length>0&&(o=e[t].roles[0].updatetime),console.log("servergroup groupid="+e[t].groupid+" groupname="+e[t].groupname+" loginTime="+o);var i=new p(e[t].groupid,e[t].groupname,o);this._serverList.push(i)}for(var a=0,n=this._serverList;a<n.length;a++){var r=n[a];r.loginTime>this._maxLoginTime&&(this._maxLoginTime=r.loginTime,this._lastLoginGroup=r.groupId),r.groupId>this._newOpenGroup&&(this._newOpenGroup=r.groupId)}this._serverList.sort(this.sortServerList)},e.prototype.sortServerList=function(t,o){return e.getInstance()._maxLoginTime>0&&t.loginTime==e.getInstance()._maxLoginTime?-1e6:e.getInstance()._maxLoginTime>0&&o.loginTime==e.getInstance()._maxLoginTime?1e7:o.groupId-t.groupId},e.prototype.getLastLoginServerInfo=function(){return 0==this._lastLoginGroup?this._serverList[0]:this.getServerInfoByGroupId(this._lastLoginGroup)},e.prototype.getLastLoginGroup=function(){return this._lastLoginGroup},e.prototype.getNewOpenGroup=function(){return this._newOpenGroup},e.prototype.getServerList=function(){return this._serverList},e.prototype.getServerInfoByGroupId=function(e){for(var t=0,o=this._serverList;t<o.length;t++){var i=o[t];if(e==i.groupId)return i}return null},e.prototype.requestMiYaServer=function(){return i(this,void 0,void 0,function(){var e,t,o,i,n,c,u;return a(this,function(){return e=d.getLocalData("wxdata"),t=d.getLocalData("token"),o=d.getLocalData("uid"),i="&systematic=1",l.GamePlatform.isIOS()&&(i="&systematic=2"),n="https://mszcs1.gameserver.iplay11g.com/gmsys/weblogic/webc/miyaloginbygroup.php","testUpdate"==(c=l.GamePlatform.getMiYaVideoType())||"iosBgm"==c?n="https://mszctest.gameserver.iplay11g.com/gmsys/weblogic/webc/miyaloginbygroup.php":"bigBlue"==c&&(n="https://mszcappphp.gameserver.iplay11g.com/gmsys/weblogic/webc/miyaloginbygroup.php"),n+="?",n+="token="+t,n+="&open_id="+o,n+="&channel_id=13",n+=i,n+="&extjson="+e,n+="&groupid="+h.GlobalVar.getServerGroup(),console.log("servergroup requestMiYaServer url="+n),(u=new XMLHttpRequest).onreadystatechange=function(){if(console.log("xMLHttpRequest.readyState=================",u.readyState,"xMLHttpRequest.status=====================",u.status),4==u.readyState&&u.status>=200&&u.status<400){var e=u.responseText.toString();console.log("servergroup requestMiYaServer rsp="+e);var t=l.GamePlatform.safeJsonParse(e);if(t){l.GamePlatform.setMiYaLoginData(t);var o="ws://"+t.wanip+":"+t.wanport;(l.GamePlatform.IsSmallBag()||l.GamePlatform.IsH5SmallBag()||l.GamePlatform.IsMiYaIosH5()||l.GamePlatform.IsMYSmallBag()||l.GamePlatform.IsYLSmallBag()||l.GamePlatform.IsLYSmallBag()||l.GamePlatform.IsDysbSmallBag()||l.GamePlatform.Is5Add7SmallBag())&&(console.log("smallBag login server--------------"),o="wss://"+t.webname+":"+t.webport),h.GlobalVar.setServerURL(o),console.log("servergroup requestMiYaServer serverUrl="+o),s.ClientNetwork.getInstance().Connect(o)||r.G.StringManager.PopString(r.G.StringManager.getString("CONNECT_ERROR"))}}},u.open("GET",n,!0),u.send(),[2]})})},e.prototype.requestPCServer=function(e){return i(this,void 0,void 0,function(){var t,o,i;return a(this,function(){return t=cc.loader.getXMLHttpRequest(),o="http://127.0.0.1:8080/tfjlh5/pcloginbygroup",l.GamePlatform.is_meituan&&(o="http://127.0.0.1:8080/tfjlh5/pcloginbygroup"),i="?accountname="+e+"&groupid="+h.GlobalVar.getServerGroup(),o+=i,console.log("serverUrl=================",o),t.open("GET",""+o),t.onload=function(){console.log("servergroup requestPCServer");var e=l.GamePlatform.safeJsonParse(t.responseText);e?s.ClientNetwork.getInstance().pushLocalMessage(c.LOCAL_MESSAGE.LocalMsg_GetServerAddr,e):s.ClientNetwork.getInstance().pushLocalMessage(c.LOCAL_MESSAGE.LocalMsg_GetServerAddr,{error:-2})},t.onerror=function(e){console.log("version request onerror"+e.toString()),s.ClientNetwork.getInstance().pushLocalMessage(c.LOCAL_MESSAGE.LocalMsg_GetServerAddr,{error:-2})},t.ontimeout=function(){console.log("version request ontimeout"),s.ClientNetwork.getInstance().pushLocalMessage(c.LOCAL_MESSAGE.LocalMsg_GetServerAddr,{error:-2})},t.onabort=function(){console.log("version request onabort"),s.ClientNetwork.getInstance().pushLocalMessage(c.LOCAL_MESSAGE.LocalMsg_GetServerAddr,{error:-2})},t.timeout=5e3,t.send(),[2]})})},e.prototype.requestPCServerList=function(t,o,n){return i(this,void 0,void 0,function(){var i,r;return a(this,function(){return t.length<=0&&(t="8089"),i=cc.loader.getXMLHttpRequest(),r=this.getServerListUrl(),r+="?accountname="+t+"&password="+o,i.open("GET",""+r),i.onload=function(){console.log("servergroup requestPCServerList");var t=l.GamePlatform.safeJsonParse(i.responseText);t?(e.getInstance().initServerList(t.servers),n(0)):n(-1)},i.onerror=function(e){console.log("version request onerror"+e.toString()),n(-2)},i.ontimeout=function(){console.log("version request ontimeout"),n(-3)},i.onabort=function(){console.log("version request onabort"),n(-4)},i.timeout=5e3,i.send(),[2]})})},e.prototype.getServerListUrl=function(){return "http://127.0.0.1:8080/tfjlh5/gameservergroup"},e._self=null,e}();o.ServerAddrInfo=f,cc._RF.pop()},{"../../load":"load","../Global/GameGlobal":"GameGlobal","../network/ClientNetwork":"ClientNetwork","../network/LocalMessage":"LocalMessage","../utils/GamePlatform":"GamePlatform","../utils/GameUtils":"GameUtils","../utils/QQGameHallUtils":"QQGameHallUtils","../utils/subUtils/TypeDef":"TypeDef"}],ServerListItem:[function(e,t,o){"use strict";cc._RF.push(t,"a602617i6NHEqUWjTNhNfxm","ServerListItem");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../model/ServerAddrInfo"),s=e("../../network/ClientNetwork"),c=e("../../network/LocalMessage"),l=e("../../utils/GameUtils"),d=cc._decorator,u=d.ccclass,h=d.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.serverText=null,t.lastLoginIcon=null,t.newGroupIcon=null,t._chooseGroupId=0,t}return a(t,e),t.prototype.show=function(e){this.serverText.node.active=null!=e&&null!=e,e&&(this.serverText.string="\u3010S"+e.groupId+"\u3011"+e.name,this._chooseGroupId=e.groupId),r.ServerAddrInfo.getInstance().getLastLoginGroup()==e.groupId?(this.lastLoginIcon.node.active=!0,l.setTexture(this.lastLoginIcon,"ui/choose_server/img/last")):this.lastLoginIcon.node.active=!1,r.ServerAddrInfo.getInstance().getNewOpenGroup()==e.groupId?(this.newGroupIcon.node.active=!0,l.setTexture(this.newGroupIcon,"ui/choose_server/img/new")):this.newGroupIcon.node.active=!1},t.prototype.chooseBtnClick=function(){s.ClientNetwork.getInstance().pushLocalMessage(c.LOCAL_MESSAGE.LocalMsg_ChooseServer,this._chooseGroupId)},n([h(cc.Label)],t.prototype,"serverText",void 0),n([h(cc.Sprite)],t.prototype,"lastLoginIcon",void 0),n([h(cc.Sprite)],t.prototype,"newGroupIcon",void 0),n([u],t)}(cc.Component);o.default=p,cc._RF.pop()},{"../../model/ServerAddrInfo":"ServerAddrInfo","../../network/ClientNetwork":"ClientNetwork","../../network/LocalMessage":"LocalMessage","../../utils/GameUtils":"GameUtils"}],ServerListMainView:[function(e,t,o){"use strict";cc._RF.push(t,"a3908gut6lE7qmPVZRnVzhS","ServerListMainView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../model/ServerAddrInfo"),s=e("../../modules/base/BaseView"),c=e("../../modules/base/Decorators"),l=e("../../modules/cores/UISuperLayout"),d=e("../../network/ClientNetwork"),u=e("../../network/LocalMessage"),h=e("./ServerListItem"),p=cc._decorator,f=p.ccclass,g=p.property,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.layout=null,t._data=null,t}return a(t,e),t.path=function(){return"ui/choose_server/prefab/ServerList"},t.prototype.init=function(){this._data=r.ServerAddrInfo.getInstance().getServerList(),this.layout.total(this._data.length);var e=this;d.ClientNetwork.getInstance().listenLocalMessage(u.LOCAL_MESSAGE.LocalMsg_ChooseServer,function(){e.closeView()},this)},t.prototype.onRefreshEvent=function(e,t){e.getComponent(h.default).show(this._data[t])},n([g(l.default)],t.prototype,"layout",void 0),n([c.Register_Class,f],t)}(s.default);o.default=m,cc._RF.pop()},{"../../model/ServerAddrInfo":"ServerAddrInfo","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/cores/UISuperLayout":"UISuperLayout","../../network/ClientNetwork":"ClientNetwork","../../network/LocalMessage":"LocalMessage","./ServerListItem":"ServerListItem"}],ShopConfirmBuy:[function(e,t,o){"use strict";cc._RF.push(t,"dcbe2Hh3ABIm6DZ3iK/hbn4","ShopConfirmBuy");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../utils/ConfigUtils"),s=e("../../modules/base/BaseView"),c=e("../../utils/GameTools"),l=e("../../common/PlayerModule"),d=e("../../modules/manager/LoadResManager"),u=e("../../modules/base/Decorators"),h=e("../../modules/base/GameView"),p=["ui/common_res/quality1","ui/common_res/quality2","ui/common_res/quality3","ui/common_res/quality4"],f=cc._decorator,g=f.ccclass,m=f.property,_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.itemNameLab=null,t.itemProgressNode=null,t.itemIconNode=null,t.buyNode=null,t.descNode=null,t}return a(t,e),t.path=function(){return"ui/shop/prefab/countersign_buy"},t.prototype.onLoad=function(){},t.prototype.start=function(){},t.prototype.init=function(e){var t=this;if(!e)return!1;if(c.default.registerTouchEvent(this.buyNode,function(){e.cb&&e.cb()}),2==e.itemData.shopID){var o=this.node.getChildByName("GoldNode");this.descNode.active=!1,o.active=!0,o.y=0,this.itemIconNode.y=0,o.getChildByName("num").getComponent(cc.Label).string=e.itemData.tGive[0].dropNum.toString(),o.getChildByName("name").getComponent(cc.Label).string=["\u4e00\u5c0f\u888b\u91d1\u5e01","\u4e00\u5927\u888b\u91d1\u5e01","\u4e00\u5c0f\u6876\u91d1\u5e01"][e.itemData.shopIndex],d.default.loadSpriteFrame("ui/shop/image/"+["jinbi","jinbi2","jinbi3"][e.itemData.shopIndex]).then(function(e){cc.isValid(t)?o.getChildByName("icon").getComponent(cc.Sprite).spriteFrame=e:console.log(" load sprite_splash error ")}).catch(function(e){cc.error(e)});var i=r.default.getInstance().getItemByID(e.itemData.tCost[0].dropID).icon;return d.default.loadSpriteFrame(i).then(function(e){cc.isValid(t)?t.buyNode.getChildByName("costIcon").getComponent(cc.Sprite).spriteFrame=e:console.log(" load sprite_splash error ")}).catch(function(e){cc.error(e)}),this.buyNode.getChildByName("costIcon").active=!0,void(this.buyNode.getChildByName("label").getComponent(cc.Label).string=e.itemData.tCost[0].dropNum.toString())}this.node.getChildByName("itemNode").active=!0;var a=e.itemData,n=r.default.getInstance().getItemByID(a.tGive[0].dropID);n.isChance&&n.isChance>0&&(this.node.getChildByName("gailv").active=!0,this.node.getChildByName("gailv").children[0].getComponent(cc.Label).string=n.isChance+"%");var s=h.default.getViewByName("NavigationMainView"),u=h.default.getViewByName("SkyCastleShopView");s&&s.view?this.itemNameLab.string=r.default.getInstance().getItemByID(a.tGive[0].dropID).name:u&&u.view?3!=n.type?this.itemNameLab.string=r.default.getInstance().getItemByID(a.tGive[0].dropID).name+"x"+a.tGive[0].dropNum:this.itemNameLab.string=r.default.getInstance().getItemByID(a.tGive[0].dropID).name:this.itemNameLab.string=r.default.getInstance().getItemByID(a.tGive[0].dropID).name+"x"+a.tGive[0].dropNum;var f=r.default.getInstance().getItemByID(a.tCost[0].dropID).icon;if(d.default.loadSpriteFrame(f).then(function(e){cc.isValid(t)?t.buyNode.getChildByName("costIcon").getComponent(cc.Sprite).spriteFrame=e:console.log(" load sprite_splash error ")}).catch(function(e){cc.error(e)}),this.buyNode.getChildByName("label").getComponent(cc.Label).string=a.tCost[0].dropNum.toString(),2===n.type){this.descNode.active=!1,this.itemIconNode.y=0;var g=r.default.getInstance().getHeroConfig(a.tGive[0].dropID),m=l.default.getHeroCarData()[a.tGive[0].dropID];if(m&&0==m.bHeroLock)this.node.getChildByName("itemNode").getChildByName("shop_new").active=!0,this.itemProgressNode.active=!1;else{this.itemProgressNode.active=!0,d.default.loadSpriteFrame("ui/bag/img/bar"+g.hero_color).then(function(e){cc.isValid(t)?t.itemProgressNode.getChildByName("pro_bar").getChildByName("bar").getComponent(cc.Sprite).spriteFrame=e:console.log(" load sprite_splash error ")}).catch(function(e){cc.error(e)});var _=l.default.getHeroCarData()[a.tGive[0].dropID].heroLevel,y=r.default.getInstance().getNpcTemplateConfig(g.npc_id,_).up_res.split("|")[0].split("#"),v=l.default.getItemCountByBag(Number(y[0])),C=Number(y[1]);this.itemProgressNode.getChildByName("pro_bar").getComponent(cc.ProgressBar).progress=v/C,this.itemProgressNode.getChildByName("number").getComponent(cc.Label).string=v+"/"+C}d.default.loadSpriteFrame("ui/cardpic_l/"+g.image).then(function(e){cc.isValid(t)?t.itemIconNode.getChildByName("heroImg").getComponent(cc.Sprite).spriteFrame=e:console.log(" load sprite_splash error ")}).catch(function(e){cc.error(e)})}else{this.itemProgressNode.active=!1,this.descNode.active=!0,this.node.getChildByName("itemNode").getChildByName("info").active=!0,10===n.type||11===n.type||12===n.type?this.descNode.getChildByName("desc").getComponent(cc.Label).string=n.source:this.descNode.getChildByName("desc").getComponent(cc.Label).string=n.desc,this.node.getChildByName("itemNode").getChildByName("info").getComponent(cc.Label).string=n.name;var S=n.icon;(s=h.default.getViewByName("NavigationMainView"))&&s.view&&(S=n.big_icon),u&&u.view&&(S=n.big_icon);var T=h.default.getViewByName("WeekCooperationReliveMainView");T&&T.view&&(S=n.big_icon);var I=h.default.getViewByName("RoyaleMainView");I&&I.view&&(S=n.big_icon);var N=h.default.getViewByName("AnniversaryMainView");N&&N.view&&(S=n.big_icon);var b=h.default.getViewByName("FogHiddenMainView"),w=h.default.getViewByName("MachineryCityMainView");(b&&b.view||w&&w.view)&&(S=n.big_icon),d.default.loadSpriteFrame(S).then(function(e){cc.isValid(t)?t.itemIconNode.getChildByName("heroImg").getComponent(cc.Sprite).spriteFrame=e:console.log(" load sprite_splash error ")}).catch(function(e){cc.error(e)})}d.default.loadSpriteFrame(p[n.quality-1]).then(function(e){cc.isValid(t)?t.itemIconNode.getChildByName("qualityBg").getComponent(cc.Sprite).spriteFrame=e:console.log(" load sprite_splash error ")}).catch(function(e){cc.error(e)})},n([m(cc.Label)],t.prototype,"itemNameLab",void 0),n([m(cc.Node)],t.prototype,"itemProgressNode",void 0),n([m(cc.Node)],t.prototype,"itemIconNode",void 0),n([m(cc.Node)],t.prototype,"buyNode",void 0),n([m(cc.Node)],t.prototype,"descNode",void 0),n([u.Register_Class,g],t)}(s.default);o.default=_,cc._RF.pop()},{"../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/base/GameView":"GameView","../../modules/manager/LoadResManager":"LoadResManager","../../utils/ConfigUtils":"ConfigUtils","../../utils/GameTools":"GameTools"}],ShopContinuousRechargeTipView:[function(e,t,o){"use strict";cc._RF.push(t,"f31b39GBH9N2oVLzX9MbvWV","ShopContinuousRechargeTipView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=cc._decorator,l=c.ccclass,d=(c.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.path=function(){return"ui/shop/prefab/shop_continuous_recharge_tip"},n([s.Register_Class,l],t)}(r.default));o.default=d,cc._RF.pop()},{"../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators"}],ShopHelpView:[function(e,t,o){"use strict";cc._RF.push(t,"0bf9e9KyIZIEJX76wzGTH9w","ShopHelpView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0}),o.SHOP_HELP_TYPE=void 0;var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators");o.SHOP_HELP_TYPE={VOUCHER:1};var c=cc._decorator,l=c.ccclass,d=c.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.voucher=null,t}return a(t,e),t.path=function(){return"ui/shop/prefab/shop_help"},t.prototype.init=function(e){e.type==o.SHOP_HELP_TYPE.VOUCHER&&(this.voucher.active=!0)},n([d(cc.Node)],t.prototype,"voucher",void 0),n([s.Register_Class,l],t)}(r.default);o.default=u,cc._RF.pop()},{"../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators"}],ShopMainCtrl:[function(e,t,o){"use strict";cc._RF.push(t,"b8740qQhyJEn4/HklFsaeNW","ShopMainCtrl");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r,s=e("../../modules/base/BaseCtrl"),c=e("../../modules/base/GameView"),l=e("../../utils/LogUtil"),d=e("../../modules/manager/ViewManager"),u=e("../../network/ClientNetwork"),h=e("../../network/protocol/RoleProtocols"),p=e("../../modules/base/Decorators"),f=e("../../network/protocol/RechargeProtocols"),g=e("../../utils/WechatUtils"),m=e("../../utils/GamePlatform"),_=e("../../network/protocol/RoleProtocols"),y=e("../../StaticData/RandRechargeGroupTableData"),v=e("../../network/LocalMessage"),C=e("../../network/protocol/TypeProtocols"),S=e("../../common/PlayerModule"),T=e("../../StaticData/RechargeTableData"),I=e("../../network/protocol/TypeProtocols"),N=e("../../Global/GameGlobal"),b=e("../../utils/GameUtils"),w=e("../../utils/GameTools"),E=e("../../common/CommandValue"),P=e("../../utils/TimeOffSetManager"),R=cc._decorator,L=R.ccclass;R.property,function(e){e[e.RAND_RECHARGE_SUPER_SALE=1]="RAND_RECHARGE_SUPER_SALE",e[e.RAND_RECHARGE_SUPER_CHOSEN=2]="RAND_RECHARGE_SUPER_CHOSEN",e[e.RAND_RECHARGE_SUPER_SKYCASTLE=3]="RAND_RECHARGE_SUPER_SKYCASTLE"}(r||(r={}));var A=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.view=null,t.sendRechargeTime=0,t}return a(t,e),t.prototype.init=function(){this.onlistenProtocol()},t.prototype.destroy=function(){u.ClientNetwork.getInstance().removeMessageTarget(this)},t.prototype.onlistenProtocol=function(){var e=this;u.ClientNetwork.getInstance().listenLocalMessage(v.LOCAL_MESSAGE.LocalMsg_SyncCostGet,function(){if("ShopMainView<ShopMainView>"==e.view.name&&e.view.node.active){var t=new _.C_Role_Get_Server_Time;u.ClientNetwork.getInstance().Send(h.ROLE_CLIENT_ENUM.P_Role_Get_Server_Time,t),e.view.setNewYearFreeGiftBtnEnableState(!1)}},this),u.ClientNetwork.getInstance().listenProtocol(h.ROLE_CLIENT_ENUM.P_Role_GetScoreFundRewards,function(t){if("ShopMainView<ShopMainView>"==e.view.name&&e.view.node.active){t.resetPos();var o=new _.S_Role_GetScoreFundRewards;if(o.read(t)){if(0!=o.errorcode)return N.G.StringManager.PopString("\u9886\u53d6\u5956\u52b1\u5931\u8d25 "+o.errorcode);c.default.addPopView("BaseCtrl","AcquirePopupView","AcquirePopupView",{items:o.prize})}}},this),u.ClientNetwork.getInstance().listenProtocol(h.ROLE_CLIENT_ENUM.P_Role_SynRandShopData,function(t){if("ShopMainView<ShopMainView>"==e.view.name&&e.view.node.active){t.resetPos();var o=new h.S_Role_SynRandShopData;o.read(t)&&(1===o.shopID?e.view.initItemShop(o.shopData):2===o.shopID&&e.view.initGoldShop(o.shopData))}},this),u.ClientNetwork.getInstance().listenProtocol(h.ROLE_CLIENT_ENUM.P_Role_RandShopBuy,function(t){if("ShopMainView<ShopMainView>"==e.view.name&&e.view.node.active){t.resetPos();var o=new h.S_Role_RandShopBuy;if(o.read(t))if(0===o.errorcode&&o.prize.length>0){c.default.addPopView("BaseCtrl","AcquirePopupView","AcquirePopupView",{items:o.prize});var i=c.default.getViewByName("ShopConfirmBuy");i&&i.view&&(i.view.node.active=!1,i.view.closeView())}else l.default.log("\u8d2d\u4e70\u5931\u8d25")}},this),u.ClientNetwork.getInstance().listenProtocol(h.ROLE_CLIENT_ENUM.P_Role_GetRandShop,function(t){if("ShopMainView<ShopMainView>"==e.view.name&&e.view.node.active){t.resetPos();var o=new h.S_Role_GetRandShop;o.read(t)&&1===o.shopID&&e.onSendProtocolGetRandShop(2)}},this),u.ClientNetwork.getInstance().listenProtocol(h.ROLE_CLIENT_ENUM.P_Role_GetFirstRechargeReward,function(t){if("ShopMainView<ShopMainView>"==e.view.name&&e.view.node.active){t.resetPos();var o=new h.S_Role_GetFirstRechargeReward;o.read(t)&&0===o.errorcode&&(c.default.addPopView("BaseCtrl","AcquirePopupView","AcquirePopupView",{items:o.prize}),e.view&&e.view.pFirstBtnCharge&&(e.view.pFirstBtnCharge.active=!1))}},this),u.ClientNetwork.getInstance().listenProtocol(h.ROLE_CLIENT_ENUM.P_Role_ReceiveMonthCardPrize,function(t){if("ShopMainView<ShopMainView>"==e.view.name&&e.view.node.active){t.resetPos();var o=new _.S_Role_ReceiveMonthCardPrize;o.read(t)&&0===o.errorcode&&(c.default.addPopView("BaseCtrl","AcquirePopupView","AcquirePopupView",{items:o.prize}),e.view&&e.view.onRefreshMonthCardBtn(!0))}},this),u.ClientNetwork.getInstance().listenProtocol(h.ROLE_CLIENT_ENUM.P_Role_SynRandRechargeData,function(t){if("ShopMainView<ShopMainView>"==e.view.name&&e.view.node.active){if(t.resetPos(),(o=new _.S_Role_SynRandRechargeData).read(t)){if(!(i=y.RandRechargeGroupTableData.getById(o.groupData.groupID)))return;i.clientType==r.RAND_RECHARGE_SUPER_SALE?e.view.initSuperSaleShop(o.groupData):i.clientType==r.RAND_RECHARGE_SUPER_CHOSEN&&e.view.initSuperChosenShop(o.groupData,i)}}else if("SkyCastleRechargeView<SkyCastleRechargeView>"==e.view.name&&e.view.node.active){var o,i;if(t.resetPos(),(o=new _.S_Role_SynRandRechargeData).read(t)&&(i=y.RandRechargeGroupTableData.getById(o.groupData.groupID)).clientType==r.RAND_RECHARGE_SUPER_SKYCASTLE)try{e.view.initSkyCastleRecharge(o.groupData)}catch(a){}}},this),u.ClientNetwork.getInstance().listenProtocol(h.ROLE_CLIENT_ENUM.P_Role_SynLuckyGift,function(t){if("ShopMainView<ShopMainView>"==e.view.name&&e.view.node.active){t.resetPos();var o=new _.S_Role_SynLuckyGift;if(o.read(t)){o.luckyGifts.forEach(function(t,i){console.log("index=================",i,"value================",t.rechargeID,"length==========",o.luckyGifts.length),0==e.view.luckyGiftNum?e.view.initLuckyCard(i,t,!1):o.luckyGifts.length>e.view.luckyGiftNum&&i+1==o.luckyGifts.length?e.view.initLuckyCard(i,t,!0):e.view.initLuckyCard(i,t,!1)}),e.view.luckyGiftNum=o.luckyGifts.length;for(var i=o.luckyGifts.length;i<5;i++)e.view["LuckyCardNode"+i].active=!1}}},this),u.ClientNetwork.getInstance().listenProtocol(h.ROLE_CLIENT_ENUM.P_Role_SelectLuckyGift,function(t){if("ShopMainView<ShopMainView>"==e.view.name&&e.view.node.active){t.resetPos();var o=new _.S_Role_SelectLuckyGift;if(o.read(t)&&0===o.errorcode){var i={rechargeID:o.luckyGift.rechargeID,rechargeNum:1};e.onSendProtocolRecharge(i)}}},this),u.ClientNetwork.getInstance().listenLocalMessage(v.LOCAL_MESSAGE.LocalMsg_RechargeSuccess,function(){"ShopMainView<ShopMainView>"==e.view.name&&e.view.node.active&&(e.view.initFirstCharge(),e.view.initMonthCard(),e.view.initDiamondShop(),e.view.initVoucherShop(),e.view.initContinueCharge(),e.view.initLimitTimeCharge(),e.view.initNewYearLoginGift(),e.view.initNewYearReservationGift(),e.view.initNewYearSkinGift(),e.view.initSpringGift(),e.view.initSpringGift_eachDay(),e.view.scheduleOnce(function(){e.view.initScoreFundView()},.5),e.view.initTanxianGift(),e.view.initContinueRechargeGiveSkin())},this),u.ClientNetwork.getInstance().listenProtocol(h.ROLE_CLIENT_ENUM.P_Role_Continue_Recharge_GetReward,function(t){if("ShopMainView<ShopMainView>"==e.view.name&&e.view.node.active){t.resetPos();var o=new h.S_Role_Continue_Recharge_GetReward;if(o.read(t))if(0==o.errorcode)N.G.StringManager.PopString("\u9886\u53d6\u6210\u529f"),o.prize&&o.prize.length>0&&c.default.addPopView("BaseCtrl","AcquirePopupView","AcquirePopupView",{items:o.prize}),e.view.initContinueCharge();else if(-1==o.errorcode){var i=S.default.getRoleAttrValByKey(C.ROLE_ATTR_VALUES.ROLE_ATTR_CONTINUE_RECHARGE_DAYNUM),a=parseInt(b.getConfigIntValue("continuousrRecharge_num"));N.G.StringManager.PopString("\u518d\u8d2d\u4e70"+(a-i)+"\u5929\u540e\u5373\u53ef\u9886\u53d6")}else-2==o.errorcode?N.G.StringManager.PopString("\u5956\u52b1\u5df2\u9886\u53d6"):N.G.StringManager.PopString("\u9886\u53d6\u5931\u8d25"+o.errorcode)}},this)},t.prototype.onSendProtocolGetRandShop=function(e){var t=new h.C_Role_GetRandShop;t.shopID=e,u.ClientNetwork.getInstance().Send(h.ROLE_CLIENT_ENUM.P_Role_GetRandShop,t)},t.prototype.onSendProtocolRandShopBuy=function(e){var t=new h.C_Role_RandShopBuy;t.shopID=e.shopID,t.shopPosition=e.shopPosition,t.shopItemID=e.shopItemID,u.ClientNetwork.getInstance().Send(h.ROLE_CLIENT_ENUM.P_Role_RandShopBuy,t)},t.prototype.onSendProtocolLuckyGiftBuy=function(e){var t=new _.C_Role_SelectLuckyGift;t.timeId=e.timeId,t.selectId=e.selectId,console.log("req.timeId===========================",t.timeId,"req.selectId========================",t.selectId),u.ClientNetwork.getInstance().Send(h.ROLE_CLIENT_ENUM.P_Role_SelectLuckyGift,t)},t.prototype.onSendProtocolRecharge=function(e){var t=this,o=T.RechargeTableData.getById(Number(e.rechargeID));if(o.extraType!=I.TYPE_RECHARGE_EXTRA.TYPE_RECHARGE_EXTRA_VOUCHER&&w.default.getRechargeMoneyByPlatform(o)<=S.default.voucherNum){var i="<outline color=black width=2> <color=#ffffff>"+(N.G.StringManager.getString("VOUCHER_TIP1")+w.default.getRechargeMoneyByPlatform(o)/100)+"</c> <img src='daijinquan' />  <color=#ffffff> "+N.G.StringManager.getString("VOUCHER_TIP2")+"</color> </outline>";c.default.addPopView("BaseCtrl","VoucherConfirmBuy","VoucherConfirmBuy",{content:i,itemData:e,cost:w.default.getRechargeMoneyByPlatform(o),playerVoucher:S.default.voucherNum,confirmCb:function(){t.sendRecharge(e,!0)},cancelCb:function(){t.sendRecharge(e)}})}else this.sendRecharge(e)},t.prototype.sendRecharge=function(e,t){if(void 0===t&&(t=!1),m.GamePlatform.isWechat()&&(cc.sys.os==cc.sys.OS_ANDROID||cc.sys.os==cc.sys.OS_WINDOWS)&&S.default.checkModulerOnOffState(E.ModulerViewOnOff.rechargeProtect)){if(P.TimeOffSetManager.getServerUTCSecond()-this.sendRechargeTime<Number(b.getConfigIntValue("rechargeProtectClick")))return;if(g.WechatUtils.getInstance().m_RetryNoticeServerPay)return console.log("retryNoticeServerPay waite retry"),void N.G.StringManager.PopString(N.G.StringManager.getString("RechargeProtect"))}if(this.sendRechargeTime=P.TimeOffSetManager.getServerUTCSecond(),m.GamePlatform.isWechat())this.wxSendRecharge(e,t);else{console.log("sendRecharge not wx");var o=new f.C_Recharge_Role_Recharge;o.rechargeID=e.rechargeID,o.rechargeNum=e.rechargeNum,o.isUseVoucher=t?1:0,u.ClientNetwork.getInstance().Send(f.RECHARGE_CLIENT_ENUM.P_Recharge_Role_Recharge,o)}},t.prototype.wxSendRecharge=function(e,t){var o=this;if(g.WechatUtils.getInstance().canChangeAndroidWxPay())console.log("wxPayChange checkChange"),g.WechatUtils.getInstance().requestAndroidwxChangePay(S.default.roleID,e.rechargeID,function(i){o.sendRechargeTime=P.TimeOffSetManager.getServerUTCSecond();var a=new f.C_Recharge_Role_Recharge;a.rechargeID=e.rechargeID,a.rechargeNum=e.rechargeNum,a.isUseVoucher=t?1:0,console.log("wxPayChange checkPay result = "+i),a.wxPayType=1==i?g.wxPayType.wxPayType_custormer:g.wxPayType.wxPayType_midas,console.log("wxPayChange choose type = "+a.wxPayType),u.ClientNetwork.getInstance().Send(f.RECHARGE_CLIENT_ENUM.P_Recharge_Role_Recharge,a)});else{console.log("wxPayChange nochange use nomal");var i=new f.C_Recharge_Role_Recharge;i.rechargeID=e.rechargeID,i.rechargeNum=e.rechargeNum,i.isUseVoucher=t?1:0,i.wxPayType=g.WechatUtils.getInstance().getNormalwxPayType(),console.log("wxPayChange noChange type = "+i.wxPayType),u.ClientNetwork.getInstance().Send(f.RECHARGE_CLIENT_ENUM.P_Recharge_Role_Recharge,i)}},t.prototype.onSendGetFirstRechargeReward=function(){var e=new h.C_Role_GetFirstRechargeReward;u.ClientNetwork.getInstance().Send(h.ROLE_CLIENT_ENUM.P_Role_GetFirstRechargeReward,e)},t.prototype.SendGetMonthCardReward=function(){var e=new _.C_Role_ReceiveMonthCardPrize;u.ClientNetwork.getInstance().Send(h.ROLE_CLIENT_ENUM.P_Role_ReceiveMonthCardPrize,e)},t.prototype.onSendProtocolGetSuperSale=function(e){var t=new _.C_Role_GetRandRecharge;t.groupID=e,u.ClientNetwork.getInstance().Send(h.ROLE_CLIENT_ENUM.P_Role_GetRandRecharge,t,!1)},t.prototype.GetRewardContinueRecharge=function(){var e=new h.C_Role_Continue_Recharge_GetReward;u.ClientNetwork.getInstance().Send(h.ROLE_CLIENT_ENUM.P_Role_Continue_Recharge_GetReward,e,!1)},n([d.AddViewEvent("SendProtocolRandShopBuy")],t.prototype,"onSendProtocolRandShopBuy",null),n([d.AddViewEvent("SendProtocolLuckyGift")],t.prototype,"onSendProtocolLuckyGiftBuy",null),n([d.AddViewEvent("SendProtocolRecharge")],t.prototype,"onSendProtocolRecharge",null),n([d.AddViewEvent("SendGetFirstRechargeReward")],t.prototype,"onSendGetFirstRechargeReward",null),n([d.AddViewEvent("SendGetMonthCardReward")],t.prototype,"SendGetMonthCardReward",null),n([d.AddViewEvent("GetRewardContinueRecharge")],t.prototype,"GetRewardContinueRecharge",null),n([p.Register_Class2("ShopMainCtrl"),L],t)}(s.default);o.default=A,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/RandRechargeGroupTableData":"RandRechargeGroupTableData","../../StaticData/RechargeTableData":"RechargeTableData","../../common/CommandValue":"CommandValue","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseCtrl":"BaseCtrl","../../modules/base/Decorators":"Decorators","../../modules/base/GameView":"GameView","../../modules/manager/ViewManager":"ViewManager","../../network/ClientNetwork":"ClientNetwork","../../network/LocalMessage":"LocalMessage","../../network/protocol/RechargeProtocols":"RechargeProtocols","../../network/protocol/RoleProtocols":"RoleProtocols","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/GamePlatform":"GamePlatform","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils","../../utils/LogUtil":"LogUtil","../../utils/TimeOffSetManager":"TimeOffSetManager","../../utils/WechatUtils":"WechatUtils"}],ShopMainView:[function(e,t,o){"use strict";cc._RF.push(t,"e4011+Zg6dNi6R5W3SgvLsJ","ShopMainView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../Global/GameGlobal"),s=e("../../utils/ConfigUtils"),c=e("../../modules/base/BaseView"),l=e("../../utils/LogUtil"),d=e("../../common/PlayerModule"),u=e("../../utils/GameTools"),h=e("../../StaticData/RechargeTableData"),p=e("../../StaticData/LuckyGiftSelectTableData"),f=e("../../StaticData/RandShopItemTableData"),g=e("../../StaticData/RandShopPositionTableData"),m=e("../../modules/manager/LoadResManager"),_=e("../../modules/base/Decorators"),y=e("../../StaticData/WorldTableData"),v=e("../../StaticData/RandShopTableData"),C=e("../../StaticData/StringValueTableData"),S=e("../../modules/base/GameView"),T=e("../../utils/GamePlatform"),I=e("../../network/ClientNetwork"),N=e("../../network/protocol/TypeProtocols"),b=e("../../utils/GameUtils"),w=e("../../utils/TimeOffSetManager"),E=e("../../network/protocol/RoleProtocols"),P=e("../../utils/UIManager"),R=e("../../StaticData/RandRechargeGroupTableData"),L=e("../../StaticData/DiscountRechargeTableData"),A=e("../../utils/subUtils/SpineMaker"),D=e("../../network/protocol/RoleProtocols"),M=e("../../network/protocol/RoleProtocols"),B=e("../../utils/RewardedVideoUnitIdConst"),k=e("../../network/protocol/RoleProtocols"),G=e("../../TableReader"),O=e("../../network/protocol/RoleProtocols"),H=e("../../utils/ResourcesManager"),V=e("../../common/NetworkProtocolCommon"),F=e("../../utils/ByteDanceMiniGameUtils"),U=e("../../utils/RewardedVideoAd"),x=e("../../StaticData/VoucherRechargeTableData"),Y=e("../../modules/manager/EventManager"),j=e("../../common/EventConst"),W=e("./ShopHelpView"),z=e("../mainScene/CarSkinUtils"),K=e("../heroCardBag/HeroSkinUtils"),q=e("../../network/protocol/ActivityProtocols"),Q=e("../../StaticData/CostGetTableData"),X=e("../../common/CommandValue"),J=e("../../StaticData/RoleScoreFundTableData"),Z=cc._decorator,$=Z.ccclass,ee=Z.property,te=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.FirstChargeNode=null,t.MonthCardNode=null,t.SuperSaleNode=null,t.SuperChosenNode=null,t.ItemShopNode=null,t.DiamondShopNode=null,t.GoldShopNode=null,t.ItemPrefab=null,t.DiamondPrefab=null,t.GoldPrefab=null,t.LuckyCardNode0=null,t.LuckyCardNode1=null,t.LuckyCardNode2=null,t.LuckyCardNode3=null,t.LuckyCardNode4=null,t.VoucherNodeAndroid=null,t.VoucherNodeIos=null,t.VoucherPrefab=null,t.continueChargeNode=null,t.limitTimeChargeNode=null,t.newYearFreeGiftNode=null,t.newYearStageGiftNode=null,t.newYearSkinGiftNode=null,t.springGiftNode=null,t.springGiftNode_eachDay=null,t.tanxianGiftNode=null,t.ScoreFundViewNode=null,t.ScoreFundViewRewardItemNode=null,t.ScoreFundViewScrollViewNode=null,t.ScoreFundViewProgressBarNode=null,t.RechargeGiveSkinUiNode=null,t.itemShopRefreshTime=0,t.superChosenRefreshTime=0,t.callback0=null,t.callback1=null,t.callback2=null,t.callback3=null,t.callback4=null,t.luckyGiftNum=0,t.pSuperChosen=null,t.m_newYearFreeGiftBtnCd=0,t.ScoreFundRewardsFreeKey=88889,t.ScoreFundRewardsSuperKey=88890,t.m_selectHeroId=0,t.m_springGift_rechargeId=752,t.m_springGiftEachDay_rechargeId=753,t.m_springGiftEachDay_luckGiftId=6003,t.m_tanxianGift_rechargeId=754,t}return a(t,e),t.path=function(){return"ui/shop/prefab/shop_main"},t.prototype.init=function(e){this._jumpData=null,e&&(this._jumpData=e)},t.prototype.onEnable=function(){if(this.SendGetAllInfo(),1==d.default.checkModulerOnOffState(X.ModulerViewOnOff.NewYearFreeGift)){var e=new E.C_Role_Get_Server_Time;I.ClientNetwork.getInstance().Send(E.ROLE_CLIENT_ENUM.P_Role_Get_Server_Time,e)}var t=this.node.getChildByName("allShops").getComponent(cc.ScrollView);if(this._jumpData){var o=t.content.width;"Diamond"===this._jumpData.skipType?t.scrollTo(cc.v2((this.DiamondShopNode.x+this.DiamondShopNode.width/2)/o)):"Gold"===this._jumpData.skipType?t.scrollTo(cc.v2((this.GoldShopNode.x+this.GoldShopNode.width/2)/o)):"Voucher"===this._jumpData.skipType&&t.scrollTo(cc.v2((this.VoucherNodeAndroid.x+this.VoucherNodeAndroid.width/2)/o)),this._jumpData=null}else t.scrollToTopLeft();this.refreshVoucherNum(),this.initLimitTimeCharge(),this.initNewYearReservationGift(),this.initNewYearSkinGift(),this.initNewYearTimer(),this.initSpringGift(),this.initTimer_spring(),this.initSpringGift_eachDay(),this.initTimer_springEachDay(),this.initScoreFundView(),this.initTanxianGift(),this.initTimer_tanxian(),this.initContinueRechargeGiveSkin()},t.prototype.onLoad=function(){var e=this;m.default.loadPrefab("ui/CommonPrefab/TopView").then(function(t){t.parent=e.node,t.getComponent("TopView").initVoucher(),t.getComponent("TopView").bindExitEvent(function(){e.closeView(!1),cc.find("Canvas").getChildByName("UI_Mask_"+e.node.name).active=!1})}).catch(function(e){l.default.info(e)}),I.ClientNetwork.getInstance().listenProtocol(E.ROLE_CLIENT_ENUM.P_Role_SetSelfSelect,function(){e.initLimitTimeCharge(),e.initNewYearReservationGift(),e.initSpringGift_eachDay(),e.initContinueRechargeGiveSkin()},this),I.ClientNetwork.getInstance().listenProtocol(E.ROLE_CLIENT_ENUM.P_Role_Get_Server_Time,function(t){t.resetPos();var o=new E.S_Role_Get_Server_Time;if(o.read(t)){d.default.setGameTime(o.tGameTime);var i=o.tGameTime.year+"-"+o.tGameTime.month+"-"+o.tGameTime.day+" "+o.tGameTime.hour+":"+o.tGameTime.minnute+":"+o.tGameTime.second;d.default.setServersTime(u.default.timeToTimestamp(i)),e.initNewYearLoginGift()}},this),Y.default.Instance.on(j.default.SyncShopScoreFund,function(){e.initScoreFundView()},this),I.ClientNetwork.getInstance().listenProtocol(E.ROLE_CLIENT_ENUM.P_Role_Continue_Recharge_GetReward_2,function(t){t.resetPos();var o=new E.S_Role_Continue_Recharge_GetReward_2;o.read(t)&&(0==o.errorcode?(o.prize&&o.prize.length>0&&S.default.addPopView("BaseCtrl","AcquirePopupView","AcquirePopupView",{items:o.prize}),e.initContinueRechargeGiveSkin()):-1==o.errorcode?r.G.StringManager.PopString("\u5145\u503c\u5929\u6570\u4e0d\u8db3\uff01"):-2==o.errorcode?r.G.StringManager.PopString("\u5956\u52b1\u5df2\u9886\u53d6"):r.G.StringManager.PopString("\u9886\u53d6\u5931\u8d25"+o.errorcode))},this)},t.prototype.start=function(){var e=this;this.initFirstCharge(),this.initContinueCharge(),this.initMonthCard(),this.initDiamondShop(),this.initVoucherShop();var t=S.default.getViewByName("MainSceneView");t&&t.view&&(this.node.getChildByName("allShops").width=t.view.node.width-50,this.node.getChildByName("allShops").getChildByName("view").width=t.view.node.width-50),this.changeAdButtonSkins(),T.GamePlatform.isQQGameRoom()?this.node.getChildByName("label2").active=!0:this.node.getChildByName("label2").active=!1,Y.default.Instance.on(j.default.SyncVoucherChange,function(){e.refreshVoucherNum()},this)},t.prototype.initLimitTimeCharge=function(){var e=this;if(this.getActivityLeftTime()<=0)this.limitTimeChargeNode.active=!1;else{this.limitTimeChargeNode.active=!0;var t=parseInt(b.getConfigIntValue("christmas_gift_recharge")),o=h.RechargeTableData.getById(t).prize,i=o[0],a=o[1],n=K.default.Instance.getSkinTableDataBySkinItemId(i.dropID),c=K.default.Instance.getNpcTemplateId(a.dropID,n.id),l=s.default.getInstance().getNpcTemplateConfig(c,1).res_id,f=this.limitTimeChargeNode.getChildByName("H_Image");f&&(f.removeAllChildren(),f&&A.SpineMaker.createSpineV2(l,f).then(function(e){e&&e.setAnimation(0,"idle",!0)}));var g=this.limitTimeChargeNode.getChildByName("reward");g.removeAllChildren(),o.forEach(function(e){u.default.createNormalItems(e.dropID,e.dropNum,g,function(t){t.scale=.92,2===s.default.getInstance().getItemByID(e.dropID).type&&t.on(cc.Node.EventType.TOUCH_END,function(){S.default.addPopView("BaseCtrl","DrawNewHeroCardView","DrawNewHeroCardView",{heroId:e.dropID,bShowNew:!0,bAction:!0})})})});var m=this.limitTimeChargeNode.getChildByName("btn_charge");m.rechargeItemInfo={rechargeID:parseInt(b.getConfigIntValue("christmas_gift_recharge")),rechargeNum:1},m.getChildByName("gotoChangeLab").getComponent(cc.Label).string="\uffe5"+(u.default.getRechargeMoneyByPlatform(h.RechargeTableData.getById(t))/100).toString();var _=d.default.getRoleRechargeData().get(t);_&&_.totalNum>0?(m.active=!1,this.limitTimeChargeNode.getChildByName("purchased").active=!0):(m.active=!0,this.limitTimeChargeNode.getChildByName("purchased").active=!1),this.registerTouchEvent(m,function(){e.onBuyLimitTime()});var y=d.default.getRoleInfoData().selfSelectMap.get(N.TYPE_SELF_SELECT.RECHARGE_CHRISTMAS);if(null==y||y<=0)this.limitTimeChargeNode.getChildByName("select").getChildByName("player").active=!0,this.limitTimeChargeNode.getChildByName("select").getChildByName("changeIcon").active=!1,this.limitTimeChargeNode.getChildByName("select").getChildByName("txt").getComponent(cc.Label).string="";else{this.limitTimeChargeNode.getChildByName("select").getChildByName("player").active=!1,this.limitTimeChargeNode.getChildByName("select").getChildByName("changeIcon").active=!0;var v=s.default.getInstance().getItemByID(y);b.setTexture(this.limitTimeChargeNode.getChildByName("select").getChildByName("headframe").getComponent(cc.Sprite),v.icon),this.limitTimeChargeNode.getChildByName("select").getChildByName("txt").getComponent(cc.Label).string="1"}u.default.registerTouchEvent(this.limitTimeChargeNode.getChildByName("select"),function(){if(_&&_.dayNum>0)r.G.StringManager.PopString("\u60a8\u5df2\u8d2d\u4e70\u8fc7\u8be5\u793c\u5305\uff0c\u65e0\u6cd5\u9009\u62e9");else{var t=b.getConfigIntValue("activity_daily_chaozhi_choose"),o=p.LuckyGiftSelectTableData.getById(Number(t)).prize;S.default.addPopView("BaseCtrl","LuckyGiftSelectRewardView","LuckyGiftSelectRewardView",{tRewards:o,index:1,isEveryDayReacharge:!0,parent:e,callBack:e.showSecectRwd_limitTimeRecharge})}}),this.showLimitTimeRechargeTime(),this.schedule(this.showLimitTimeRechargeTime,1)}},t.prototype.onBuyLimitTime=function(){var e=this,t=parseInt(b.getConfigIntValue("christmas_gift_recharge")),o=d.default.getRoleRechargeData().get(t);if(!(o&&o.totalNum>0)){var i=d.default.getRoleInfoData().selfSelectMap.get(N.TYPE_SELF_SELECT.RECHARGE_CHRISTMAS);if(null==i||i<=0)r.G.StringManager.PopString(r.G.StringManager.getString("BATTLEPASS_SELECT_GOLD_TIP"));else{var a=function(){var o={rechargeID:t,rechargeNum:1};e.sendEvent("SendProtocolRecharge",o)};S.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:r.G.StringManager.getString("BUY_EVERYDAYRECHARGE_LASTDAY"),confirmCb:function(){a.call(e)}})}}},t.prototype.showLimitTimeRechargeTime=function(){var e=this.getActivityLeftTime();if(e<0)return this.limitTimeChargeNode.active=!1,void this.unschedule(this.showLimitTimeRechargeTime);this.limitTimeChargeNode.getChildByName("node_time").getChildByName("label_time").getComponent(cc.Label).string="\u5269\u4f59\u65f6\u95f4\uff1a"+w.TimeOffSetManager.formaterWithOutSecond2(e)},t.prototype.showSecectRwd_limitTimeRecharge=function(e){if(0!=e){this.m_selectHeroId=e;var t=new E.C_Role_SetSelfSelect;t.type=N.TYPE_SELF_SELECT.RECHARGE_CHRISTMAS,t.selectItemId=e,I.ClientNetwork.getInstance().Send(E.ROLE_CLIENT_ENUM.P_Role_SetSelfSelect,t)}},t.prototype.getActivityLeftTime=function(e){void 0===e&&(e=8e3);var t=-1;return d.default.getActivityData().forEach(function(e){if(e.activityID==q.ACTIVITY_ID_ENUM.P_Activity_LimitTimeRecharge){var o=d.default.getServersTime2();o>=e.beginTime&&o<=e.endTime&&(t=e.endTime-o)}}),t},t.prototype.initContinueCharge=function(){var e=this,t=parseInt(b.getConfigIntValue("continuousrRecharge_condition"));if(d.default.getRoleAttrValByKey(N.ROLE_ATTR_VALUES.ROLE_ATTR_RECHARGENUM)<t)this.continueChargeNode.active=!1;else{this.continueChargeNode.active=!0;var o=this.continueChargeNode.getChildByName("H_Image");if(o){o.removeAllChildren();var i=z.default.Instance.getCarSpineUrl(z.default.TYPE_MAIN,803);H.default.loadSpine(i,function(e,t){t&&(e.scale=.4,e.parent=o,e.getComponent(sp.Skeleton).setAnimation(0,"walk",!0))})}var a=parseInt(b.getConfigIntValue("continuousrRecharge_id")),n=h.RechargeTableData.getById(a).prize,r=this.continueChargeNode.getChildByName("reward");r.removeAllChildren(),n.forEach(function(e){u.default.createNormalItems(e.dropID,e.dropNum,r,function(){})});var s=d.default.getRoleAttrValByKey(N.ROLE_ATTR_VALUES.ROLE_ATTR_CONTINUE_RECHARGE_DAYNUM),c=parseInt(b.getConfigIntValue("continuousrRecharge_num"));this.continueChargeNode.getChildByName("txt_dayNum").getComponent(cc.Label).string=s+"/"+c;var l=d.default.getRoleAttrValByKey(N.ROLE_ATTR_VALUES.ROLE_ATTR_CONTINUE_RECHARGE_GETSTATUS),p=this.continueChargeNode.getChildByName("btn_get").getChildByName("label_get").getComponent(cc.Label);l>0?(u.default.setNodeBright(this.continueChargeNode.getChildByName("btn_get"),!1),p.string="\u5df2\u9886"):(p.string="\u9886\u53d6",s>=c?u.default.setNodeBright(this.continueChargeNode.getChildByName("btn_get"),!0):u.default.setNodeBright(this.continueChargeNode.getChildByName("btn_get"),!1)),this.registerTouchEvent(this.continueChargeNode.getChildByName("btn_get"),function(){e.sendEvent("GetRewardContinueRecharge")});var f=this.continueChargeNode.getChildByName("btn_charge");f.rechargeItemInfo={rechargeID:parseInt(b.getConfigIntValue("continuousrRecharge_id")),rechargeNum:1},f.getChildByName("gotoChangeLab").getComponent(cc.Label).string="\uffe5"+(u.default.getRechargeMoneyByPlatform(h.RechargeTableData.getById(a))/100).toString();var g=d.default.getRoleAttrValByKey(N.ROLE_ATTR_VALUES.ROLE_ATTR_CONTINUE_RECHARGE_TIME),m=d.default.getServersTime2();console.log("\u8fde\u514515\u5929\uff0c\u4e0a\u6b21\u5145\u503c\u65f6\u95f4="+new Date(1e3*g).toString()),0==w.TimeOffSetManager.getSpanDays(m,g)?(f.active=!1,this.continueChargeNode.getChildByName("purchased").active=!0):(f.active=!0,this.continueChargeNode.getChildByName("purchased").active=!1),this.registerTouchEvent(f,function(t){e.sendEvent("SendProtocolRecharge",t.target.rechargeItemInfo)})}},t.prototype.checkFirstCharge=function(){var e=0;return L.DiscountRechargeTableData.getDataMap().forEach(function(t,o){0===e&&(e=o);var i=d.default.getRoleRechargeData().get(o);i&&0!=i.totalNum&&(e=0)}),e},t.prototype.initFirstCharge=function(){var e=this,t=this.checkFirstCharge();if(0!==t){var o=L.DiscountRechargeTableData.getById(t);if(o){b.setTexture(this.FirstChargeNode.getChildByName("bg").getComponent(cc.Sprite),o.bg);var i=this.FirstChargeNode.getChildByName("H_Image");i&&A.SpineMaker.createSpineV2(o.resId,i).then(function(e){e&&(i.scale=o.scale,e.setAnimation(0,o.animationName,!0))}),this.FirstChargeNode.getChildByName("btn_charge").getChildByName("gotoChangeLab").getComponent(cc.Label).string=r.G.StringManager.getString("SUPER_SALE_MONEY",u.default.getRechargeMoneyByPlatform(h.RechargeTableData.getById(t))/100)}var a=h.RechargeTableData.getById(t).firstPrize,n=this.FirstChargeNode.getChildByName("reward");n.removeAllChildren(),a.forEach(function(e){u.default.createNormalItems(e.dropID,e.dropNum,n,function(t){2===s.default.getInstance().getItemByID(e.dropID).type&&t.on(cc.Node.EventType.TOUCH_END,function(){S.default.addPopView("BaseCtrl","DrawNewHeroCardView","DrawNewHeroCardView",{heroId:e.dropID,bShowNew:!0,bAction:!0})})})});var c=this.FirstChargeNode.getChildByName("btn_charge");c.rechargeItemInfo={rechargeID:t,rechargeNum:1},this.registerTouchEvent(c,function(t){e.sendEvent("SendProtocolRecharge",t.target.rechargeItemInfo)})}else this.FirstChargeNode.active=!1},t.prototype.onRefreshLuckyGiftEndTime=function(e,t){this.unschedule(this["callback"+t]),this["callback"+t]=function(){if(e<=0)return this["LuckyCardNode"+t].getChildByName("remainTime").getComponent(cc.Label).string="\u5df2\u7ed3\u675f",this.unschedule(this["callback"+t]),void(this["LuckyCardNode"+t].active=!1);e--,this["LuckyCardNode"+t].getChildByName("remainTime").getComponent(cc.Label).string=function(e){var t,o=parseInt((e%86400/3600).toString()),i=parseInt((e%3600/60).toString()),a=parseInt((e%60).toString());return t=a<10?"0"+a:a.toString(),(o<10?"0"+o:o.toString())+":"+(i<10?"0"+i:i.toString())+":"+t+"\u540e\u6d88\u5931"}.call(this,e)}.bind(this),this.schedule(this["callback"+t],1)},t.prototype.initLuckyCard=function(e,t,o){var i=this;this["LuckyCardNode"+e].active=!0;var a=this["LuckyCardNode"+e];o&&(a.scale=0,a.opacity=0,cc.tween(a).to(.15,{scale:1.2,opacity:255}).to(.1,{scale:1}).call(function(){}).start()),this.currLuckyGift=this["LuckyCardNode"+e];var n=a.getChildByName("btn_charge"),s=a.getChildByName("player");s.removeAllChildren(),n.getChildByName("gotoChangeLab").getComponent(cc.Label).string=r.G.StringManager.getString("SUPER_SALE_MONEY",u.default.getRechargeMoneyByPlatform(h.RechargeTableData.getById(t.rechargeID))/100),n.rechargeItemInfo={timeId:t.timeId,selectId:0},this.registerTouchEvent(n,function(e){0!=e.target.rechargeItemInfo.selectId?i.sendEvent("SendProtocolLuckyGift",e.target.rechargeItemInfo):r.G.StringManager.PopString(r.G.StringManager.getString("LUCKY_TIP"))}),this.registerTouchEvent(s,function(){i.onSelectHeroRwdBtn(p.LuckyGiftSelectTableData.getById(t.rechargeID).prize,e)}),this.onRefreshLuckyGiftEndTime(t.lastTime,e)},t.prototype.initMonthCard=function(){var e=d.default.getRoleAttrValByKey(N.ROLE_ATTR_VALUES.ROLE_ATTR_PRIVILEGE_MONTHCARDTIME),t=this.MonthCardNode.getChildByName("btn_charge");if(e>0){t.getChildByName("gotoChangeLab").active=!1,t.getChildByName("getRewardLab").active=!0,this.onRefreshMonthCardBtn(1==d.default.getRoleAttrValByKey(N.ROLE_ATTR_VALUES.ROLE_ATTR_PRIVILEGE_MONTHCARDPRIZE));var o=this.MonthCardNode.getChildByName("expire");if(o){o.active=!0;var i=o.getComponent(cc.Label),a=w.TimeOffSetManager.getServerUTCSecond(),n=w.TimeOffSetManager.getSpanDays(a,e),c=Number(b.getConfigIntValue("privilege_month_card_day"));i.string=r.G.StringManager.getString("MONTH_CARD_EXPIRE",c-n)}}var l=h.RechargeTableData.getById(7);t.getChildByName("gotoChangeLab").getComponent(cc.Label).string=r.G.StringManager.getString("SUPER_SALE_MONEY",u.default.getRechargeMoneyByPlatform(l)/100);var p=this.MonthCardNode.getChildByName("reward");if(p){var f=p.getChildByName("total").getComponent(cc.Label);f&&l&&(f.string=l.prize[0].dropNum.toString());var g=p.getChildByName("day").getComponent(cc.Label),m=p.getChildByName("txt_sweepNum").getComponent(cc.Label),_=p.getChildByName("txt_ad").getComponent(cc.Label),y=new Array;if(y.push(g,m,_),g){var v=Number(b.getConfigIntValue("privilege_month_card_prizeid")),C=s.default.getInstance().getDorpItemsByID(v);if(C){var S=C.dropRandom.split("|");for(var T in S){var I=S[T].split("#");y[T].string=I[1]}}}}},t.prototype.onChargeMonthCardCallBack=function(e,t){if(d.default.getRoleAttrValByKey(N.ROLE_ATTR_VALUES.ROLE_ATTR_PRIVILEGE_MONTHCARDTIME)<=0){var o={rechargeID:t,rechargeNum:1};this.sendEvent("SendProtocolRecharge",o)}else this.sendEvent("SendGetMonthCardReward")},t.prototype.onSelectHeroRwdBtn=function(e,t){S.default.addPopView("BaseCtrl","LuckyGiftSelectRewardView","LuckyGiftSelectRewardView",{tRewards:e,index:t,parent:this})},t.prototype.showSecectRwd=function(e,t,o){var i=s.default.getInstance().getItemByID(e),a=this["LuckyCardNode"+t].getChildByName("player");this["LuckyCardNode"+t].getChildByName("btn_charge").rechargeItemInfo.selectId=e,a.removeAllChildren();var n=cc.instantiate(this.ItemPrefab);n.parent=a,n.setPosition(0,-10),n.scale=.7,b.setTexture(n.getChildByName("heroImg").getComponent(cc.Sprite),i.icon),n.getChildByName("name").getComponent(cc.Label).string=i.name+"x"+o,n.getChildByName("bg").active=!1,n.getChildByName("saleNode").active=!0,1007!=e&&1010!=e||(n.getChildByName("qualityBg").active=!0,b.setTexture(n.getChildByName("qualityBg").getComponent(cc.Sprite),"ui/common_res/quality"+i.quality),n.getChildByName("heroImg").scale=1.3)},t.prototype.onRefreshMonthCardBtn=function(e){var t=this.MonthCardNode.getChildByName("btn_charge");t.getChildByName("getRewardLab").active=!e,t.getChildByName("takedLab").active=e,u.default.setNodeBright(t,!e);var o=S.default.getViewByName("MainSceneView");o&&o.view&&o.view.onShopRedpointActive()},t.prototype.initSuperSaleShop=function(e){var t=this;!e||e.units.size<=0||(this.SuperSaleNode.removeAllChildren(),e.units.forEach(function(e,o){var i=h.RechargeTableData.getById(o);i&&b.LoadNode(P.PrefabUrl.ShopSuperSale).then(function(a){var n=a;n.parent=t.SuperSaleNode,i.prize.forEach(function(e){var o=s.default.getInstance().getItemByID(e.dropID),i="";if(3===o.type){var a=s.default.getInstance().getDorpItemsByID(e.dropID);if(a){var r=a.dropRandom.split("|");for(var c in r){var l=r[c].split("#"),d=s.default.getInstance().getItemByID(l[0]);i=d.icon,2===d.type&&(i="ui/cardpic_l/"+l[0]),(u=cc.instantiate(t.ItemPrefab)).parent=n.getChildByName("itemLayout"),u.scale=.7,b.setTexture(u.getChildByName("heroImg").getComponent(cc.Sprite),i),u.getChildByName("name").getComponent(cc.Label).string=d.name+"x"+l[1],u.getChildByName("bg").active=!1,u.getChildByName("saleNode").active=!0}}}else{var u;i=o.icon,2===o.type&&(i="ui/cardpic_l/"+e.dropID),(u=cc.instantiate(t.ItemPrefab)).parent=n.getChildByName("itemLayout"),u.scale=.7,b.setTexture(u.getChildByName("heroImg").getComponent(cc.Sprite),i),u.getChildByName("name").getComponent(cc.Label).string=o.name+"x"+e.dropNum}});var c=n.getChildByName("buy"),l=n.getChildByName("purchased");""!=i.special_label&&b.setTexture(n.getChildByName("off").getComponent(cc.Sprite),i.special_label),i.original_cost>0&&(c.getChildByName("original_cost").getComponent(cc.Label).string=r.G.StringManager.getString("SUPER_SALE_ORIGINAL_MONEY",i.original_cost/100));var d=c.getChildByName("btn_charge"),h=d.getChildByName("gotoChangeLab");if(e.buyNum>0)c.active=!1,l.active=!0;else{h.getComponent(cc.Label).string=r.G.StringManager.getString("SUPER_SALE_MONEY",u.default.getRechargeMoneyByPlatform(i)/100);var p={rechargeID:o,rechargeNum:1};t.registerTouchEvent(d,function(){t.sendEvent("SendProtocolRecharge",p)})}})}))},t.prototype.initSuperChosenShop=function(e,t){var o=this;if(e&&!(e.units.size<=0)){e.units.forEach(function(e,i){var a=h.RechargeTableData.getById(i);a&&a.prize.forEach(function(n){var c=s.default.getInstance().getItemByID(n.dropID),l="";if(3===c.type){var d=s.default.getInstance().getDorpItemsByID(n.dropID);if(d){var h=d.dropRandom.split("|"),p=function(n){var c=h[n].split("#"),d=s.default.getInstance().getItemByID(c[0]);l=d.icon,2===d.type&&(l="ui/cardpic_l/"+c[0]);var p=cc.instantiate(o.ItemPrefab),f="item"+(t.id-1),g=o.SuperChosenNode.getChildByName(f);g.removeAllChildren(),p.parent=g,b.setTexture(p.getChildByName("heroImg").getComponent(cc.Sprite),l),p.getChildByName("name").getComponent(cc.Label).string=d.name+"x"+c[1];var m=p.getChildByName("chosenNode"),_=m.getChildByName("charge");if(m.active=!0,""!=a.special_label&&b.setTexture(m.getChildByName("off").getComponent(cc.Sprite),a.special_label),_.getChildByName("original_cost").getComponent(cc.Label).string=r.G.StringManager.getString("SUPER_SALE_ORIGINAL_MONEY",a.original_cost/100),_.getChildByName("cost").getComponent(cc.Label).string=r.G.StringManager.getString("SUPER_SALE_MONEY",u.default.getRechargeMoneyByPlatform(a)/100),e.buyNum>0)u.default.setNodeBright(p,!1),_.active=!1,m.getChildByName("purchased").active=!0;else{var y={rechargeID:i,rechargeNum:1};o.registerTouchEvent(p,function(){o.sendEvent("SendProtocolRecharge",y)})}};for(var f in h)p(f)}}else{l=c.icon,2===c.type&&(l="ui/cardpic_l/"+n.dropID);var g=cc.instantiate(o.ItemPrefab);g.parent=o.SuperChosenNode.getChildByName("itemLayout"),b.setTexture(g.getChildByName("heroImg").getComponent(cc.Sprite),l),g.getChildByName("name").getComponent(cc.Label).string=c.name+"x"+n.dropNum;var m=g.getChildByName("chosenNode"),_=m.getChildByName("charge");if(e.buyNum>0)u.default.setNodeBright(g,!1),_.active=!1,m.getChildByName("purchased").active=!0;else{var y={rechargeID:i,rechargeNum:1};o.registerTouchEvent(g,function(){o.sendEvent("SendProtocolRecharge",y)}),_.getChildByName("original_cost").getComponent(cc.Label).string=r.G.StringManager.getString("SUPER_SALE_ORIGINAL_MONEY",a.original_cost/100),_.getChildByName("cost").getComponent(cc.Label).string=r.G.StringManager.getString("SUPER_SALE_MONEY",u.default.getRechargeMoneyByPlatform(a)/100)}}})});var i=this.SuperChosenNode.getChildByName("VideoNode"),a=this.SuperChosenNode.getChildByName("VideoQQNode"),n=function(){if(t.dayHandRefreshNum-e.dayHandRefreshNum<=0)return r.G.StringManager.PopString(C.StringValueTableData.getById(17).string_value);if(o.superChosenRefreshTime>0)r.G.StringManager.PopString(r.G.StringManager.formatStr(C.StringValueTableData.getById(13).string_value,[o.superChosenRefreshTime]));else{var i=o;T.GamePlatform.isQQGameRoom()||T.GamePlatform.IsH5SmallBag()||T.GamePlatform.IsMiYaIosH5()||T.GamePlatform.IsDysbSmallBag()||T.GamePlatform.Is5Add7SmallBag()?U.default.createVideo({name:"SuperChosenShop",adUnitId:B.RewardedVideoClientIdConst.Shop_Gift_Refresh,advertID:B.RewardedVideoUnitIdConst.ShopGiftRefresh,finishCb:function(){for(var e=2;e<=5;e++){var o=new D.C_Role_RandRechargeRefresh;o.groupID=e,I.ClientNetwork.getInstance().Send(E.ROLE_CLIENT_ENUM.P_Role_RandRechargeRefresh,o,!1)}i.superChosenRefreshTime=t.handRefreshCD,i.schedule(function(){i.superChosenRefreshTime--},1,t.handRefreshCD-1);var a=S.default.getViewByName("MainSceneView");a&&a.view&&a.view.onClientTaskAddAdvert(B.RewardedVideoClientIdConst.Shop_Gift_Refresh)}}):S.default.addPopView("BaseCtrl","LookVideoView","LookVideoView",{cb:function(){for(var e=2;e<=5;e++){var o=new D.C_Role_RandRechargeRefresh;o.groupID=e,I.ClientNetwork.getInstance().Send(E.ROLE_CLIENT_ENUM.P_Role_RandRechargeRefresh,o,!1)}i.superChosenRefreshTime=t.handRefreshCD,i.schedule(function(){i.superChosenRefreshTime--},1,t.handRefreshCD-1);var a=S.default.getViewByName("MainSceneView");a&&a.view&&a.view.onClientTaskAddAdvert(B.RewardedVideoClientIdConst.Shop_Gift_Refresh)},advertID:B.RewardedVideoClientIdConst.Shop_Gift_Refresh,adUnitId:B.RewardedVideoUnitIdConst.ShopGiftRefresh,sourceName:"SuperChosenShop",content:r.G.StringManager.getString("LOOKVIDEO_REFRESH_TIME",t.dayHandRefreshNum)})}};(T.GamePlatform.isQQGameRoom()||T.GamePlatform.IsH5SmallBag()||T.GamePlatform.IsMiYaIosH5()||T.GamePlatform.IsDysbSmallBag()||T.GamePlatform.Is5Add7SmallBag())&&(i.active=!1,a.active=!0,this.registerTouchEvent(a,function(){n.call(o)})),this.SuperChosenNode.getChildByName("time").getComponent(cc.Label).string=t.dayHandRefreshNum-e.dayHandRefreshNum+"/"+t.dayHandRefreshNum,this.registerTouchEvent(i,function(){n.call(o)})}},t.prototype.initDiamondShop=function(){var e=this;if(this.DiamondShopNode){var t=1292;this.DiamondShopNode.getChildByName("itemLayout").removeAllChildren(),u.default.startFraming(6,function(o){var i=cc.instantiate(e.DiamondPrefab);i.parent=e.DiamondShopNode.getChildByName("itemLayout");var a=h.RechargeTableData.getById(o+1);if(a){i.rechargeItemInfo={rechargeID:a.id,rechargeNum:1},i.getChildByName("name").getComponent(cc.Label).string=y.WorldTableData.getDataMap().get(t).ch,i.getChildByName("cost").getComponent(cc.Label).string=r.G.StringManager.getString("SUPER_SALE_MONEY",u.default.getRechargeMoneyByPlatform(a)/100),i.getChildByName("num").getComponent(cc.Label).string=a.prize[0].dropNum.toString();var n=d.default.getRoleRechargeData().get(a.id);n&&(i.getChildByName("shop_double").active=!n.bFirstPrize),i.getChildByName("shop_double").getChildByName("number_double").getComponent(cc.Label).string=a.firstPrize[0].dropNum.toString(),m.default.loadSpriteFrame("ui/shop/image/zuanshi"+(o+1)).then(function(t){cc.isValid(e)?i.getChildByName("icon").getComponent(cc.Sprite).spriteFrame=t:console.log(" load sprite_splash error ")}).catch(function(e){cc.error(e)}),t++}e.registerTouchEvent(i,function(t){e.sendEvent("SendProtocolRecharge",t.target.rechargeItemInfo)})})}},t.prototype.initItemShop=function(e){var t=this;if(this.ItemShopNode){if(e.positions){this.ItemShopNode.getChildByName("itemLayout").removeAllChildren();var o=Array.from(e.positions.keys());u.default.startFraming(o.length,function(i){var a=e.positions.get(o[i]);t.creatItemTemplate(a.shopItemID,a.buyNum,o[i])})}var i=function(){if(s-e.dayRefreshNum<=0)return r.G.StringManager.PopString(C.StringValueTableData.getById(17).string_value);!1!==t.checkRefreshTime()?T.GamePlatform.isQQGameRoom()||T.GamePlatform.IsH5SmallBag()||T.GamePlatform.IsMiYaIosH5()||T.GamePlatform.IsDysbSmallBag()||T.GamePlatform.Is5Add7SmallBag()?U.default.createVideo({name:"ItemShop",adUnitId:B.RewardedVideoClientIdConst.Shop_Refresh,advertID:B.RewardedVideoUnitIdConst.ShopRefresh,finishCb:function(){var e=new M.C_Role_RandShopRefresh;e.shopID=1,I.ClientNetwork.getInstance().Send(E.ROLE_CLIENT_ENUM.P_Role_RandShopRefresh,e)}}):S.default.addPopView("BaseCtrl","LookVideoView","LookVideoView",{cb:function(){var e=new M.C_Role_RandShopRefresh;e.shopID=1,I.ClientNetwork.getInstance().Send(E.ROLE_CLIENT_ENUM.P_Role_RandShopRefresh,e)},advertID:B.RewardedVideoClientIdConst.Shop_Refresh,adUnitId:B.RewardedVideoUnitIdConst.ShopRefresh,sourceName:"ItemShop"}):r.G.StringManager.PopString(r.G.StringManager.formatStr(C.StringValueTableData.getById(13).string_value,[t.itemShopRefreshTime]))},a=this.ItemShopNode.getChildByName("VideoNode"),n=this.ItemShopNode.getChildByName("VideoQQNode");(T.GamePlatform.isQQGameRoom()||T.GamePlatform.IsH5SmallBag()||T.GamePlatform.IsMiYaIosH5()||T.GamePlatform.IsDysbSmallBag()||T.GamePlatform.Is5Add7SmallBag())&&(a.active=!1,n.active=!0,this.registerTouchEvent(n,function(){i.call(t)}));var s=v.RandShopTableData.getById(1).dayCDRefreshNum.length;this.ItemShopNode.getChildByName("time").getComponent(cc.Label).string=s-e.dayRefreshNum+"/"+s,a.off(cc.Node.EventType.TOUCH_START),a.off(cc.Node.EventType.TOUCH_MOVE),a.off(cc.Node.EventType.TOUCH_END),a.off(cc.Node.EventType.TOUCH_CANCEL),this.registerTouchEvent(a,function(){i.call(t)}),e.dayCDTime&&(this.itemShopRefreshTime=e.dayCDTime,this.schedule(function(){t.itemShopRefreshTime--},1,e.dayCDTime-1))}},t.prototype.creatItemTemplate=function(e,t,o){var i=this,a=cc.instantiate(this.ItemPrefab);if(a.parent=this.ItemShopNode.getChildByName("itemLayout"),a.shopItemInfo={shopID:1,shopPosition:o,shopItemID:e,buyCount:t,tGive:[],tCost:[]},this.registerTouchEvent(a,function(e){if(0!==e.target.shopItemInfo.shopItemID)if(e.target.shopItemInfo.buyCount>0)r.G.StringManager.PopString(C.StringValueTableData.getById(12).string_value);else{if(!e.target.shopItemInfo.tCost[0]){var t=S.default.getViewByName("MainSceneView");return t&&t.view&&(t.view._bHaveShopFreeItem=!1,t.view.onShopRedpointActive()),a.getChildByName("redpoint").active=!1,i.sendEvent("SendProtocolRandShopBuy",e.target.shopItemInfo)}S.default.addPopView("BaseCtrl","ShopConfirmBuy","ShopConfirmBuy",{itemData:e.target.shopItemInfo,cb:function(){var t=f.RandShopItemTableData.getById(e.target.shopItemInfo.shopItemID).cost;if(t[0])if(1001===t[0].dropID){if(d.default.goldNum<t[0].dropNum)return r.G.StringManager.PopString(C.StringValueTableData.getById(4).string_value)}else if(1002===t[0].dropID&&d.default.diamondNum<t[0].dropNum)return r.G.StringManager.PopString(C.StringValueTableData.getById(9).string_value);i.sendEvent("SendProtocolRandShopBuy",e.target.shopItemInfo)}})}else l.default.log("\u672a\u89e3\u9501\u65e0\u9700\u53d1\u9001\u8d2d\u4e70")}),0===e)a.getChildByName("lock").active=!0,a.getChildByName("lock").getChildByName("cup").getComponent(cc.Label).string=g.RandShopPositionTableData.getById(o).conditionScore.toString();else{var n=f.RandShopItemTableData.getById(e).give;if(a.shopItemInfo.tGive=n,2===s.default.getInstance().getItemByID(n[0].dropID).type){var c=s.default.getInstance().getHeroConfig(n[0].dropID),h=d.default.getHeroCarData()[n[0].dropID];if(h&&0==h.bHeroLock)a.getChildByName("shop_new").active=!0;else{m.default.loadSpriteFrame("ui/bag/img/bar"+c.hero_color).then(function(e){cc.isValid(i)?a.getChildByName("cardNumber").getChildByName("pro_bar").getChildByName("bar").getComponent(cc.Sprite).spriteFrame=e:console.log(" load sprite_splash error ")}).catch(function(e){cc.error(e)});var p=d.default.getHeroCarData()[n[0].dropID].heroLevel,_=s.default.getInstance().getNpcTemplateConfig(c.npc_id,p).up_res.split("|")[0].split("#"),y=d.default.getItemCountByBag(Number(_[0])),v=Number(_[1]);a.getChildByName("cardNumber").getChildByName("pro_bar").getComponent(cc.ProgressBar).progress=y/v,a.getChildByName("cardNumber").getChildByName("number").getComponent(cc.Label).string=y+"/"+v}m.default.loadSpriteFrame("ui/cardpic_l/"+c.image).then(function(e){cc.isValid(i)?a.getChildByName("heroImg").getComponent(cc.Sprite).spriteFrame=e:console.log(" load sprite_splash error ")}).catch(function(e){cc.error(e)})}var T=f.RandShopItemTableData.getById(e).cost;a.shopItemInfo.tCost=T,T[0]?(a.getChildByName("priceNode").active=!0,1001===T[0].dropID?(a.getChildByName("priceNode").getChildByName("costGold").active=!0,a.getChildByName("priceNode").getChildByName("costIDiamond").active=!1):1002===T[0].dropID?(a.getChildByName("priceNode").getChildByName("costGold").active=!1,a.getChildByName("priceNode").getChildByName("costIDiamond").active=!0):(a.getChildByName("priceNode").getChildByName("costGold").active=!1,a.getChildByName("priceNode").getChildByName("costIDiamond").active=!1),a.getChildByName("priceNode").getChildByName("cost").getComponent(cc.Label).string=T[0].dropNum.toString()):(a.getChildByName("free").active=!0,t<=0&&(a.getChildByName("redpoint").active=!0)),a.getChildByName("name").getComponent(cc.Label).string=s.default.getInstance().getItemByID(n[0].dropID).name+"x"+n[0].dropNum}t>0&&(a.getChildByName("over").active=!0,a.getChildByName("free").active=!1,a.getChildByName("priceNode").active=!1,a.getChildByName("cardNumber").active=!1,u.default.setNodeBright(a,!1))},t.prototype.showVoucherHelp=function(){S.default.addPopView("BaseCtrl","ShopHelpView","ShopHelpView",{type:W.SHOP_HELP_TYPE.VOUCHER})},t.prototype.refreshVoucherNum=function(){var e=this.node.getChildByName("TopView");e&&e.getComponent("TopView").initVoucher()},t.prototype.initVoucherShop=function(){var e=this;if(1==b.checkOpenVoucher()){this.refreshVoucherNum();var t=this.VoucherNodeAndroid,o=T.GamePlatform.getMiYaVideoTypeNoSet().toString().slice(0,5);if(T.GamePlatform.isIOS()&&"lektn"!=o&&(t=this.VoucherNodeIos),!t)return;t.active=!0,t.getChildByName("itemLayout").removeAllChildren(),x.VoucherRechargeTableData.getDataMap().forEach(function(i){var a=1;if(T.GamePlatform.isIOS()&&"lektn"!=o&&(a=2),i.platform==a){var n=cc.instantiate(e.VoucherPrefab);n.parent=t.getChildByName("itemLayout");var s=h.RechargeTableData.getById(i.rechargeid);s&&(n.rechargeItemInfo={shopID:3,rechargeID:s.id,rechargeNum:1,costNum:u.default.getRechargeMoneyByPlatform(s)/100},n.getChildByName("cost").getComponent(cc.Label).string=r.G.StringManager.getString("SUPER_SALE_MONEY",u.default.getRechargeMoneyByPlatform(s)/100),n.getChildByName("num").getComponent(cc.Label).string=(s.prize[0].dropNum/100).toString(),m.default.loadSpriteFrame(i.icon).then(function(t){cc.isValid(e)?n.getChildByName("icon").getComponent(cc.Sprite).spriteFrame=t:console.log(" load sprite_splash error ")}).catch(function(e){cc.error(e)})),e.registerTouchEvent(n,function(t){e.sendEvent("SendProtocolRecharge",t.target.rechargeItemInfo)})}})}},t.prototype.initGoldShop=function(e){var t=this;if(this.GoldShopNode&&e.positions){this.GoldShopNode.getChildByName("itemLayout").removeAllChildren();var o=[];Array.from(e.positions.keys(),function(e){o.push(e)}),u.default.startFraming(o.length,function(i){var a=e.positions.get(o[i]);t.creatGoldTemplate(a.shopItemID,a.buyNum,i,o[i])})}},t.prototype.creatGoldTemplate=function(e,t,o,i){var a=this,n=cc.instantiate(this.GoldPrefab);n.parent=this.GoldShopNode.getChildByName("itemLayout");var s=f.RandShopItemTableData.getById(e).cost,c=f.RandShopItemTableData.getById(e).give;n.shopItemInfo={shopID:2,shopPosition:i,shopItemID:e,cost:s[0].dropNum,shopIndex:o,tGive:c,tCost:s},this.registerTouchEvent(n,function(e){S.default.addPopView("BaseCtrl","ShopConfirmBuy","ShopConfirmBuy",{itemData:e.target.shopItemInfo,cb:function(){if(d.default.diamondNum<e.target.shopItemInfo.cost)return r.G.StringManager.PopString(C.StringValueTableData.getById(16).string_value);a.sendEvent("SendProtocolRandShopBuy",e.target.shopItemInfo)}})}),s[0]&&(n.getChildByName("priceNode").getChildByName("cost").getComponent(cc.Label).string=s[0].dropNum.toString(),n.getChildByName("num").getComponent(cc.Label).string=c[0].dropNum.toString(),n.getChildByName("name").getComponent(cc.Label).string=["\u4e00\u5c0f\u888b\u91d1\u5e01","\u4e00\u5927\u888b\u91d1\u5e01","\u4e00\u5c0f\u6876\u91d1\u5e01"][o],m.default.loadSpriteFrame("ui/shop/image/"+["jinbi","jinbi2","jinbi3"][o]).then(function(e){cc.isValid(a)?n.getChildByName("icon").getComponent(cc.Sprite).spriteFrame=e:console.log(" load sprite_splash error ")}).catch(function(e){cc.error(e)}))},t.prototype.registerTouchEvent=function(e,t){e.hasEventListener(cc.Node.EventType.TOUCH_START)&&(e.off(cc.Node.EventType.TOUCH_START),e.off(cc.Node.EventType.TOUCH_MOVE),e.off(cc.Node.EventType.TOUCH_END),e.off(cc.Node.EventType.TOUCH_CANCEL)),e.on(cc.Node.EventType.TOUCH_START,function(){e.scale=.92}),e.on(cc.Node.EventType.TOUCH_MOVE,function(){}),e.on(cc.Node.EventType.TOUCH_END,function(o){e.scale=1,t&&t(o)}),e.on(cc.Node.EventType.TOUCH_CANCEL,function(){e.scale=1})},t.prototype.checkRefreshTime=function(){return this.itemShopRefreshTime<=0},t.prototype.SendGetAllInfo=function(){var e=new k.C_Role_GetRandShop;e.shopID=1,I.ClientNetwork.getInstance().Send(E.ROLE_CLIENT_ENUM.P_Role_GetRandShop,e),this.luckyGiftNum=0,console.log("send-----------------------P_Role_SynLuckyGift=============================");var t=new k.C_Role_SynLuckyGift;I.ClientNetwork.getInstance().Send(E.ROLE_CLIENT_ENUM.P_Role_SynLuckyGift,t),G.PreLoadCsv("RandRechargeGroupTableData").then(function(){R.RandRechargeGroupTableData.getDataMap().forEach(function(e){var t=new O.C_Role_GetRandRecharge;t.groupID=e.id,I.ClientNetwork.getInstance().Send(E.ROLE_CLIENT_ENUM.P_Role_GetRandRecharge,t,!1)})})},t.prototype.changeAdButtonSkins=function(){T.GamePlatform.isByteDanceMiniGame()&&(F.default.getInstance().changeSkinOfAdButton(this.SuperChosenNode.getChildByName("VideoNode"),"shop_refresh"),F.default.getInstance().changeSkinOfAdButton(this.ItemShopNode.getChildByName("VideoNode"),"shop_refresh"))},t.prototype.checkNewYearLoginGiftLeftTime=function(){var e=b.getConfigIntValue("newyeargift_gift_free_time");if(new Date(1e3*Number(e.split("|")[0])).getMonth()+1==new Date(1e3*d.default.getServersTime2()).getMonth()+1){var t=new Date(1e3*Number(e.split("|")[0])).getDate();return new Date(1e3*d.default.getServersTime2()).getDate()-t}var o=d.default.getServersTime2()-Number(e.split("|")[0]);return new Date(1e3*o).getDate()},t.prototype.initNewYearLoginGift=function(){var e=this;if(0==d.default.checkModulerOnOffState(X.ModulerViewOnOff.NewYearFreeGift))return this.newYearFreeGiftNode.active=!1;this.setNewYearFreeGiftBtnEnableState(!0);var t=this.checkNewYearLoginGiftLeftTime(),o=b.getConfigIntValue("newyeargift_gift_free").split("|");if(!o[t])return this.newYearFreeGiftNode.active=!1;if(!Q.CostGetTableData.getById(Number(o[t])))return this.newYearFreeGiftNode.active=!1;var i=Q.CostGetTableData.getById(Number(o[t])).get;this.newYearFreeGiftNode.getChildByName("RewardsLayout").destroyAllChildren(),i.forEach(function(t){u.default.createNormalItems(t.itemID,t.itemNum,e.newYearFreeGiftNode.getChildByName("RewardsLayout"),function(e){e.scale=.8})});var a=d.default.getCostGetDataByID(Number(o[t])),n=this.newYearFreeGiftNode.getChildByName("BuyButton"),s=this.newYearFreeGiftNode.getChildByName("BuyButtonNoVideo"),c=function(){if(0==e.newYearFreeGiftNode.getChildByName("BuyButton").bEnable)return console.log("\u7981\u6b62\u70b9\u51fb\u6309\u94ae");if(a>0)return r.G.StringManager.PopWorldString("first_charge_reward");var i=(new Date).getTime();if(i-e.m_newYearFreeGiftBtnCd<2e3)return r.G.StringManager.PopWorldString("sociaty_auction_tip11");e.m_newYearFreeGiftBtnCd=i,U.default.createVideo({name:"NewYearLoginGiftAd",adUnitId:B.RewardedVideoUnitIdConst.SociatyDonateBox,advertID:B.RewardedVideoClientIdConst.SociatyDonateBox,finishCb:function(){V.default.callRoleCostGet(Number(o[t]))}})},l=n;T.GamePlatform.isNoVideoBag()&&(n.active=!1,s.active=!0,l=s),l.children[1].getComponent(cc.Label).string=a>0?"\u5df2\u9886\u53d6":"\u514d\u8d39\u9886\u53d6",a>0?u.default.setNodeBright(l.children[0],!1):u.default.setNodeBright(l.children[0],!0),u.default.registerTouchEvent(l,function(){c.call(e)});try{var h=this.newYearFreeGiftNode.getChildByName("BuyButton").getChildByName("Background");if(h){var p=h.getComponent(cc.Sprite);p&&T.GamePlatform.isByteDanceMiniGame()&&b.setTexture(p,"douyin/advertise205-75")}}catch(f){}},t.prototype.setNewYearFreeGiftBtnEnableState=function(e){this.newYearFreeGiftNode.getChildByName("BuyButton").bEnable=e},t.prototype.initNewYearReservationGift=function(){var e,t=this;if(0==d.default.checkModulerOnOffState(X.ModulerViewOnOff.NewYearRechargeGift))return this.newYearStageGiftNode.active=!1;var o=function(){var e=0;return b.getConfigIntValue("newyeargift_gift_recharge").split("|").forEach(function(t){var o=d.default.getRoleRechargeData().get(Number(t));o&&o.totalNum>0&&e++}),e}.call(this),i=b.getConfigIntValue("newyeargift_gift_recharge").split("|"),a=Number(i[o]);!a||isNaN(a)?(this.newYearStageGiftNode.getChildByName("shouqingNode").active=!0,this.newYearStageGiftNode.getChildByName("BuyButton").active=!1):(this.newYearStageGiftNode.getChildByName("shouqingNode").active=!1,this.newYearStageGiftNode.getChildByName("BuyButton").active=!0,this.newYearStageGiftNode.getChildByName("BuyButton").children[1].getComponent(cc.Label).string="\uffe5"+(u.default.getRechargeMoneyByPlatform(h.RechargeTableData.getById(a))/100).toString()),this.newYearStageGiftNode.getChildByName("RewardsItemNode")&&this.newYearStageGiftNode.getChildByName("RewardsItemNode").destroy();var n;n=!a||isNaN(a)?h.RechargeTableData.getById(Number(i[i.length-1])):h.RechargeTableData.getById(a),u.default.createNormalItems(n.prize[0].dropID,n.prize[0].dropNum,this.newYearStageGiftNode,function(e){e.scale=.8,e.name="RewardsItemNode",e.position=cc.v3(240,-55,0)});var c=d.default.getRoleInfoData(),l=null!=a?a:Number(i[i.length-1]),f=c.selfSelectMap.get(l);if(null==f||f<=0)this.newYearStageGiftNode.getChildByName("select").getChildByName("player").active=!0,this.newYearStageGiftNode.getChildByName("select").getChildByName("changeIcon").active=!1,this.newYearStageGiftNode.getChildByName("select").getChildByName("txt").getComponent(cc.Label).string="";else{this.newYearStageGiftNode.getChildByName("select").getChildByName("player").active=!1,this.newYearStageGiftNode.getChildByName("select").getChildByName("changeIcon").active=!0;var g=s.default.getInstance().getItemByID(f);b.setTexture(this.newYearStageGiftNode.getChildByName("select").getChildByName("headframe").getComponent(cc.Sprite),g.icon);var m=Number(b.getConfigIntValue("SelfSelect_"+l));this.newYearStageGiftNode.getChildByName("select").getChildByName("txt").getComponent(cc.Label).string=null!==(e=""+m)&&void 0!==e?e:""}u.default.registerTouchEvent(this.newYearStageGiftNode.getChildByName("select"),function(){var e=d.default.getRoleRechargeData().get(l);if(e&&e.dayNum>0)return r.G.StringManager.PopString("\u60a8\u5df2\u8d2d\u4e70\u8fc7\u8be5\u793c\u5305\uff0c\u65e0\u6cd5\u9009\u62e9");var o=b.getConfigIntValue("activity_daily_chaozhi_choose"),i=p.LuckyGiftSelectTableData.getById(Number(o)).prize;(i=b.clone(i)).forEach(function(e){var t=Number(b.getConfigIntValue("SelfSelect_"+l));e.itemNum=null!=t?t:1});for(var a=i.length-1;a>=0;a--)2!=s.default.getInstance().getItemByID(i[a].itemID).type&&i.splice(a,1);S.default.addPopView("BaseCtrl","LuckyGiftSelectRewardView","LuckyGiftSelectRewardView",{tRewards:i,index:l,isEveryDayReacharge:!1,parent:t,callBack:function(e,t){if(0!=e){var o=new E.C_Role_SetSelfSelect;o.type=t,o.selectItemId=e,I.ClientNetwork.getInstance().Send(E.ROLE_CLIENT_ENUM.P_Role_SetSelfSelect,o)}else r.G.StringManager.PopString("\u672a\u9009\u62e9\u91d1\u5361")}})}),u.default.registerTouchEvent(this.newYearStageGiftNode.getChildByName("BuyButton"),function(){t.onClickNewYearRechargeCallBack(a)})},t.prototype.onClickNewYearRechargeCallBack=function(e){var t=this,o=d.default.getRoleRechargeData().get(e);if(!(o&&o.totalNum>0)){var i=d.default.getRoleInfoData().selfSelectMap.get(e);if(null==i||i<=0)return r.G.StringManager.PopString(r.G.StringManager.getString("BATTLEPASS_SELECT_GOLD_TIP"));var a=function(){var o={rechargeID:e,rechargeNum:1};t.sendEvent("SendProtocolRecharge",o)};S.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:r.G.StringManager.getString("BUY_EVERYDAYRECHARGE_LASTDAY"),confirmCb:function(){a.call(t)}})}},t.prototype.initNewYearSkinGift=function(){var e=this;if(0==d.default.checkModulerOnOffState(X.ModulerViewOnOff.NewYearSkinGift))return this.newYearSkinGiftNode.active=!1;var t=parseInt(b.getConfigIntValue("newyeargift_skin_recharge")),o=h.RechargeTableData.getById(t).prize,i=o[0],a=o[1],n=K.default.Instance.getSkinTableDataBySkinItemId(i.dropID),r=K.default.Instance.getNpcTemplateId(a.dropID,n.id),c=this.newYearSkinGiftNode.getChildByName("AnimNode");if(c){c.removeAllChildren();var p=s.default.getInstance().getNpcTemplateConfig(r,1).res_id;s.default.getInstance().getResConfig(p).uiScale,m.default.loadSpineNode(s.default.getInstance().getResConfig(p).animation).then(function(e){e.parent=c,e.getComponent(sp.Skeleton).setAnimation(0,"idle",!0)}).catch(function(e){l.default.info(e)})}this.newYearSkinGiftNode.getChildByName("BuyButton").children[1].getComponent(cc.Label).string="\uffe5"+(u.default.getRechargeMoneyByPlatform(h.RechargeTableData.getById(t))/100).toString(),this.newYearSkinGiftNode.getChildByName("RewardsLayout").destroyAllChildren(),h.RechargeTableData.getById(t).prize.forEach(function(t){u.default.createNormalItems(t.dropID,t.dropNum,e.newYearSkinGiftNode.getChildByName("RewardsLayout"),function(e){e.scale=.8,2===s.default.getInstance().getItemByID(t.dropID).type&&e.on(cc.Node.EventType.TOUCH_END,function(){S.default.addPopView("BaseCtrl","DrawNewHeroCardView","DrawNewHeroCardView",{heroId:t.dropID,bShowNew:!1,bAction:!0})})})});var f=d.default.getRoleRechargeData().get(t);f&&f.totalNum>0?(this.newYearSkinGiftNode.getChildByName("shouqingNode").active=!0,this.newYearSkinGiftNode.getChildByName("BuyButton").active=!1):(this.newYearSkinGiftNode.getChildByName("shouqingNode").active=!1,this.newYearSkinGiftNode.getChildByName("BuyButton").active=!0),u.default.registerTouchEvent(this.newYearSkinGiftNode.getChildByName("BuyButton"),function(){var o={rechargeID:t,rechargeNum:1};e.sendEvent("SendProtocolRecharge",o)})},t.prototype.initNewYearTimer=function(){this.unschedule(this.scheduleNewYearActivity),this.schedule(this.scheduleNewYearActivity,1),this.scheduleNewYearActivity()},t.prototype.scheduleNewYearActivity=function(){var e=d.default.getServersTime(),t=b.getConfigIntValue("newyeargift_gift_free_time"),o=b.getConfigIntValue("newyeargift_gift_recharge_time"),i=b.getConfigIntValue("newyeargift_skin_recharge_time");if(1==d.default.checkModulerOnOffState(X.ModulerViewOnOff.NewYearFreeGift))if(e>=Number(t.split("|")[0])&&e<=Number(t.split("|")[1])){this.newYearFreeGiftNode.active=!0;var a=this.checkNewYearLoginGiftLeftTime();b.getConfigIntValue("newyeargift_gift_free").split("|")[a]||(this.newYearFreeGiftNode.active=!1)}else this.newYearFreeGiftNode.active=!1;else this.newYearFreeGiftNode.active=!1;1==d.default.checkModulerOnOffState(X.ModulerViewOnOff.NewYearRechargeGift)&&e>=Number(o.split("|")[0])&&e<=Number(o.split("|")[1])?this.newYearStageGiftNode.active=!0:this.newYearStageGiftNode.active=!1,1==d.default.checkModulerOnOffState(X.ModulerViewOnOff.NewYearSkinGift)&&e>=Number(i.split("|")[0])&&e<=Number(i.split("|")[1])?this.newYearSkinGiftNode.active=!0:this.newYearSkinGiftNode.active=!1,0==this.newYearFreeGiftNode.active&&0==this.newYearStageGiftNode.active&&0==this.newYearSkinGiftNode.active&&this.unschedule(this.scheduleNewYearActivity);var n=Number(o.split("|")[1])-d.default.getServersTime();this.newYearStageGiftNode.getChildByName("TimeLabel").getComponent(cc.Label).string="\u5269\u4f59\u65f6\u95f4\uff1a"+w.TimeOffSetManager.formaterWithOutSecond2(n),1==this.newYearStageGiftNode.getChildByName("shouqingNode").active&&(this.newYearStageGiftNode.active=!1);var r=Number(i.split("|")[1])-d.default.getServersTime();this.newYearSkinGiftNode.getChildByName("TimeLabel").getComponent(cc.Label).string="\u5269\u4f59\u65f6\u95f4\uff1a"+w.TimeOffSetManager.formaterWithOutSecond2(r),1==this.newYearSkinGiftNode.getChildByName("shouqingNode").active&&(this.newYearSkinGiftNode.active=!1)},t.prototype.initSpringGift=function(){var e=this,t=this.springGiftNode.getChildByName("layout"),o=this.springGiftNode.getChildByName("BuyButton"),i=this.springGiftNode.getChildByName("shouqingNode"),a=this.springGiftNode.getChildByName("H_Image"),n=(this.springGiftNode.getChildByName("TimeLabel"),h.RechargeTableData.getById(this.m_springGift_rechargeId));t.removeAllChildren();var c=n.prize;c.forEach(function(e){u.default.createNormalItems(e.dropID,e.dropNum,t,function(e){e.scale=.8})});var p=c[0],f=K.default.Instance.getSkinTableDataBySkinItemId(p.dropID),g=K.default.Instance.getNpcTemplateId(f.heroItemId,f.id);if(a){a.removeAllChildren();var _=s.default.getInstance().getNpcTemplateConfig(g,1).res_id,y=s.default.getInstance().getResConfig(_).uiScale;m.default.loadSpineNode(s.default.getInstance().getResConfig(_).animation).then(function(e){e.parent=a,e.getComponent(sp.Skeleton).setAnimation(0,"idle",!0),e.scale=y/100}).catch(function(e){l.default.info(e)})}var v=d.default.getRoleRechargeData().get(this.m_springGift_rechargeId);v&&v.totalNum>0?(i.active=!0,o.active=!1):(i.active=!1,o.active=!0),o.getChildByName("txt_price").getComponent(cc.Label).string="\uffe5"+(u.default.getRechargeMoneyByPlatform(n)/100).toString(),u.default.registerTouchEvent(o,function(){if(v&&v.totalNum>0)return r.G.StringManager.PopString("\u5df2\u552e\u7f44");var t={rechargeID:e.m_springGift_rechargeId,rechargeNum:1};e.sendEvent("SendProtocolRecharge",t)})},t.prototype.initTimer_spring=function(){this.unschedule(this.scheduleTimer_spring),this.schedule(this.scheduleTimer_spring,1),this.scheduleTimer_spring()},t.prototype.scheduleTimer_spring=function(){var e=d.default.getServersTime2(),t=b.getConfigIntValue("springgift_skin_recharge_time").split("|"),o=Number(t[0]),i=Number(t[1]);if(e>=i)return this.springGiftNode.active=!1,void this.unschedule(this.scheduleTimer_spring);e>o&&e<i?(0==this.springGiftNode.active&&(this.springGiftNode.active=!0),this.springGiftNode.getChildByName("TimeLabel").getComponent(cc.Label).string="\u5269\u4f59\u65f6\u95f4\uff1a"+w.TimeOffSetManager.formaterWithOutSecond2(i-e)):this.springGiftNode.active=!1},t.prototype.initSpringGift_eachDay=function(){var e,t=this,o=this.springGiftNode_eachDay.getChildByName("RewardsLayout"),i=this.springGiftNode_eachDay.getChildByName("BuyButton"),a=this.springGiftNode_eachDay.getChildByName("shouqingNode"),n=this.springGiftNode_eachDay.getChildByName("select"),c=h.RechargeTableData.getById(this.m_springGiftEachDay_rechargeId);o.removeAllChildren(),c.prize.forEach(function(e){u.default.createNormalItems(e.dropID,e.dropNum,o,function(e){e.scale=.8})});var l=d.default.getRoleInfoData().selfSelectMap.get(this.m_springGiftEachDay_rechargeId);if(null==l||l<=0)n.getChildByName("player").active=!0,n.getChildByName("changeIcon").active=!1,n.getChildByName("txt").getComponent(cc.Label).string="";else{n.getChildByName("player").active=!1,n.getChildByName("changeIcon").active=!0;var f=s.default.getInstance().getItemByID(l);b.setTexture(n.getChildByName("headframe").getComponent(cc.Sprite),f.icon);var g=Number(b.getConfigIntValue("SelfSelect_"+this.m_springGiftEachDay_rechargeId));n.getChildByName("txt").getComponent(cc.Label).string=null!==(e=""+g)&&void 0!==e?e:""}var m=d.default.getRoleRechargeData().get(this.m_springGiftEachDay_rechargeId);m&&m.dayNum>0?(a.active=!0,i.active=!1):(a.active=!1,i.active=!0),i.getChildByName("txt_price").getComponent(cc.Label).string="\uffe5"+(u.default.getRechargeMoneyByPlatform(c)/100).toString(),u.default.registerTouchEvent(n,function(){if(m&&m.dayNum>0)return r.G.StringManager.PopString("\u60a8\u5df2\u8d2d\u4e70\u8fc7\u8be5\u793c\u5305\uff0c\u65e0\u6cd5\u9009\u62e9");var e=t.m_springGiftEachDay_luckGiftId,o=p.LuckyGiftSelectTableData.getById(Number(e)).prize;(o=b.clone(o)).forEach(function(e){var o=Number(b.getConfigIntValue("SelfSelect_"+t.m_springGiftEachDay_rechargeId));e.itemNum=null!=o?o:1});for(var i=o.length-1;i>=0;i--)2!=s.default.getInstance().getItemByID(o[i].itemID).type&&o.splice(i,1);S.default.addPopView("BaseCtrl","LuckyGiftSelectRewardView","LuckyGiftSelectRewardView",{tRewards:o,index:t.m_springGiftEachDay_rechargeId,isEveryDayReacharge:!1,parent:t,callBack:function(e,t){if(0!=e){var o=new E.C_Role_SetSelfSelect;o.type=t,o.selectItemId=e,I.ClientNetwork.getInstance().Send(E.ROLE_CLIENT_ENUM.P_Role_SetSelfSelect,o)}else r.G.StringManager.PopString("\u672a\u9009\u62e9\u5361")}})}),u.default.registerTouchEvent(i,function(){var e=d.default.getRoleRechargeData().get(t.m_springGiftEachDay_rechargeId);if(!(e&&e.dayNum>0)){var o=d.default.getRoleInfoData().selfSelectMap.get(t.m_springGiftEachDay_rechargeId);if(null==o||o<=0)return r.G.StringManager.PopString(r.G.StringManager.getString("EVERYDAY_RECHARGE"));var i=function(){var e={rechargeID:t.m_springGiftEachDay_rechargeId,rechargeNum:1};t.sendEvent("SendProtocolRecharge",e)};S.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:r.G.StringManager.getString("BUY_EVERYDAYRECHARGE_LASTDAY"),confirmCb:function(){i.call(t)}})}})},t.prototype.initTimer_springEachDay=function(){this.unschedule(this.scheduleTimer_springEachDay),this.schedule(this.scheduleTimer_springEachDay,1),this.scheduleTimer_springEachDay()},t.prototype.scheduleTimer_springEachDay=function(){var e=d.default.getServersTime2(),t=b.getConfigIntValue("springgift_gift_recharge_time").split("|"),o=Number(t[0]),i=Number(t[1]);if(e>=i)return this.springGiftNode_eachDay.active=!1,void this.unschedule(this.scheduleTimer_springEachDay);e>o&&e<i?0==this.springGiftNode_eachDay.active&&(this.springGiftNode_eachDay.active=!0):this.springGiftNode_eachDay.active=!1},t.prototype.initScoreFundView=function(){var e=this;if(1==this.checkScoreFundTotalRewards())return this.ScoreFundViewNode.active=!1;this.ScoreFundViewScrollViewNode.content.children.forEach(function(e){"rewardItemNode"==e.name&&e.destroy()}),J.RoleScoreFundTableData.getDataMap().forEach(function(t){e.initScoreFundItemInfo(t)}),this.ScoreFundViewProgressBarNode.width=Number(J.RoleScoreFundTableData.getById(J.RoleScoreFundTableData.getDataMap().size).otherInfo),this.ScoreFundViewScrollViewNode.content.width=this.ScoreFundViewProgressBarNode.width+this.ScoreFundViewRewardItemNode.width/2+Number(J.RoleScoreFundTableData.getById(1).otherInfo),this.initScoreFundProgress(),this.ScoreFundViewNode.getChildByName("btn_charge").active=d.default.getRoleAttrValByKey(N.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE_FUND_BATTLEPASS)<=0,this.ScoreFundViewNode.getChildByName("btn_getReward").active=!this.ScoreFundViewNode.getChildByName("btn_charge").active,this.getTotalGetScoreFundRewards().length>0?u.default.setNodeBright(this.ScoreFundViewNode.getChildByName("btn_getReward"),!0):u.default.setNodeBright(this.ScoreFundViewNode.getChildByName("btn_getReward"),!1)},t.prototype.initScoreFundItemInfo=function(e){var t=this,o=cc.instantiate(this.ScoreFundViewRewardItemNode);o.parent=this.ScoreFundViewScrollViewNode.content,o.active=!0,o.name="rewardItemNode",o.x=Number(e.otherInfo),o.getChildByName("FreeNode").width=120,o.getChildByName("FreeNode").height=120,o.getChildByName("FreeNode").ScoreFundId=e.id,u.default.createNormalItems(e.freeRewards[0].itemID,e.freeRewards[0].itemNum,o.getChildByName("FreeNode"),function(i){i.scale=.7,1==t.checkFundRewardState(e.needScore,1)?(u.default.setNodeBright(o.getChildByName("FreeNode"),!1),o.getChildByName("FreeNode").getChildByName("xuanzhong").active=!1):(u.default.setNodeBright(o.getChildByName("FreeNode"),!0),d.default.getRoleAttrValByKey(N.ROLE_ATTR_VALUES.ROLE_ATTR_MAX_SCORE)>=e.needScore?o.getChildByName("FreeNode").getChildByName("xuanzhong").active=!0:o.getChildByName("FreeNode").getChildByName("xuanzhong").active=!1)}),u.default.registerTouchEvent(o.getChildByName("FreeNode"),function(e){if(e&&e.target){var o=e.target.ScoreFundId,i=J.RoleScoreFundTableData.getById(o);if(i&&d.default.getRoleAttrValByKey(N.ROLE_ATTR_VALUES.ROLE_ATTR_MAX_SCORE)>=i.needScore){if(1==t.checkFundRewardState(i.needScore,1))return r.G.StringManager.PopWorldString("common_prompt_receive_over");var a=new E.T_ScoreFundData;a.index=i.needScore,a.type=1,t.callGetScoreFundRewards([a])}}}),o.getChildByName("PayNode").width=120,o.getChildByName("PayNode").height=120,o.getChildByName("PayNode").ScoreFundId=e.id,u.default.createNormalItems(e.superRewards[0].itemID,e.superRewards[0].itemNum,o.getChildByName("PayNode"),function(i){i.scale=.9,1==t.checkFundRewardState(e.needScore,2)?(u.default.setNodeBright(o.getChildByName("PayNode"),!1),o.getChildByName("PayNode").getChildByName("xuanzhong").active=!1):(u.default.setNodeBright(o.getChildByName("PayNode"),!0),d.default.getRoleAttrValByKey(N.ROLE_ATTR_VALUES.ROLE_ATTR_MAX_SCORE)>=e.needScore?o.getChildByName("PayNode").getChildByName("xuanzhong").active=!0:o.getChildByName("PayNode").getChildByName("xuanzhong").active=!1)}),u.default.registerTouchEvent(o.getChildByName("PayNode"),function(e){if(e&&e.target){var o=e.target.ScoreFundId,i=J.RoleScoreFundTableData.getById(o);if(i&&d.default.getRoleAttrValByKey(N.ROLE_ATTR_VALUES.ROLE_ATTR_MAX_SCORE)>=i.needScore){var a=d.default.getRoleAttrValByKey(N.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE_FUND_BATTLEPASS);if(!a||a<=0)return S.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:"\u662f\u5426\u5f00\u901a\u8c6a\u534e\u7248 \u9886\u53d6\u6d77\u91cf\u94bb\u77f3\uff1f",confirmCb:function(){t.onClickBuySuperScoreFund()}});if(1==t.checkFundRewardState(i.needScore,2))return r.G.StringManager.PopWorldString("common_prompt_receive_over");var n=new E.T_ScoreFundData;n.index=i.needScore,n.type=2,t.callGetScoreFundRewards([n])}}}),o.getChildByName("ScoreNode").children[2].getComponent(cc.Label).string=e.needScore+"",d.default.getRoleAttrValByKey(N.ROLE_ATTR_VALUES.ROLE_ATTR_MAX_SCORE)>=e.needScore?(o.getChildByName("ScoreNode").children[1].active=!0,o.getChildByName("ScoreNode").children[0].active=!1):(o.getChildByName("ScoreNode").children[1].active=!1,o.getChildByName("ScoreNode").children[0].active=!0)},t.prototype.checkFundRewardState=function(e,t){var o=d.default.getScoreFundData(),i=o.get(this.ScoreFundRewardsFreeKey).rewardBoxStateMap;return 2==t&&(i=o.get(this.ScoreFundRewardsSuperKey).rewardBoxStateMap),!!i.has(e)&&1==i.get(e)},t.prototype.initScoreFundProgress=function(){var e,t=null,o=1,i=d.default.getRoleAttrValByKey(N.ROLE_ATTR_VALUES.ROLE_ATTR_MAX_SCORE);if(J.RoleScoreFundTableData.getDataMap().forEach(function(e,a){i>=e.needScore&&(t=e,o=a)}),t)if(e=J.RoleScoreFundTableData.getById(o+1)){var a=i-t.needScore,n=e.needScore-t.needScore,r=(Number(e.otherInfo)-Number(t.otherInfo))*(a/n),s=Number(t.otherInfo)+r;this.ScoreFundViewProgressBarNode.getChildByName("bar").width=s}else this.ScoreFundViewProgressBarNode.getChildByName("bar").width=this.ScoreFundViewProgressBarNode.width;else(e=J.RoleScoreFundTableData.getById(o))?(a=i,n=e.needScore,s=r=Number(e.otherInfo)*(a/n),this.ScoreFundViewProgressBarNode.getChildByName("bar").width=s):this.ScoreFundViewProgressBarNode.getChildByName("bar").width=this.ScoreFundViewProgressBarNode.width},t.prototype.checkScoreFundTotalRewards=function(){var e=this,t=!0;return J.RoleScoreFundTableData.getDataMap().forEach(function(o){0!=e.checkFundRewardState(o.needScore,1)&&0!=e.checkFundRewardState(o.needScore,2)||(t=!1)}),t},t.prototype.getTotalGetScoreFundRewards=function(){var e=this,t=[];return J.RoleScoreFundTableData.getDataMap().forEach(function(o){if(d.default.getRoleAttrValByKey(N.ROLE_ATTR_VALUES.ROLE_ATTR_MAX_SCORE)>=o.needScore){0==e.checkFundRewardState(o.needScore,1)&&((i=new E.T_ScoreFundData).index=o.needScore,i.type=1,t.push(i));var i,a=d.default.getRoleAttrValByKey(N.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE_FUND_BATTLEPASS);0==e.checkFundRewardState(o.needScore,2)&&a&&a>0&&((i=new E.T_ScoreFundData).index=o.needScore,i.type=2,t.push(i))}}),t},t.prototype.onClickTotalGetScoreFundRewards=function(){var e=this.getTotalGetScoreFundRewards();e.length>0?this.callGetScoreFundRewards(e):r.G.StringManager.PopString(r.G.StringManager.getWorldString("common_prompt_not_rewards"))},t.prototype.onClickBuySuperScoreFund=function(){var e={rechargeID:Number(b.getConfigIntValue("scorefund_battlepass_rechargeid")),rechargeNum:1};this.sendEvent("SendProtocolRecharge",e)},t.prototype.callGetScoreFundRewards=function(e){var t=new E.C_Role_GetScoreFundRewards;t.getRewards=e,I.ClientNetwork.getInstance().Send(E.ROLE_CLIENT_ENUM.P_Role_GetScoreFundRewards,t)},t.prototype.initTanxianGift=function(){var e=this,t=this.tanxianGiftNode.getChildByName("layout"),o=this.tanxianGiftNode.getChildByName("BuyButton"),i=this.tanxianGiftNode.getChildByName("shouqingNode"),a=this.tanxianGiftNode.getChildByName("H_Image"),n=(this.tanxianGiftNode.getChildByName("TimeLabel"),h.RechargeTableData.getById(this.m_tanxianGift_rechargeId));t.removeAllChildren();var c=n.prize;c.forEach(function(e){u.default.createNormalItems(e.dropID,e.dropNum,t,function(e){e.scale=.8})});var p=c[0],f=K.default.Instance.getSkinTableDataBySkinItemId(p.dropID),g=K.default.Instance.getNpcTemplateId(f.heroItemId,f.id);if(a){a.removeAllChildren();var _=s.default.getInstance().getNpcTemplateConfig(g,1).res_id,y=s.default.getInstance().getResConfig(_).uiScale;m.default.loadSpineNode(s.default.getInstance().getResConfig(_).animation).then(function(e){e.parent=a,e.getComponent(sp.Skeleton).setAnimation(0,"idle",!0),e.scale=y/100}).catch(function(e){l.default.info(e)})}var v=d.default.getRoleRechargeData().get(this.m_tanxianGift_rechargeId);v&&v.totalNum>0?(i.active=!0,o.active=!1):(i.active=!1,o.active=!0),o.getChildByName("txt_price").getComponent(cc.Label).string="\uffe5"+(u.default.getRechargeMoneyByPlatform(n)/100).toString(),u.default.registerTouchEvent(o,function(){if(v&&v.totalNum>0)return r.G.StringManager.PopString("\u5df2\u552e\u7f44");var t={rechargeID:e.m_tanxianGift_rechargeId,rechargeNum:1};e.sendEvent("SendProtocolRecharge",t)})},t.prototype.initTimer_tanxian=function(){this.unschedule(this.scheduleTimer_tanxian),this.schedule(this.scheduleTimer_tanxian,1),this.scheduleTimer_tanxian()},t.prototype.scheduleTimer_tanxian=function(){var e=d.default.getServersTime2(),t=b.getConfigIntValue("tanxian_skin_recharge_time").split("|"),o=Number(t[0]),i=Number(t[1]);if(e>=i)return this.tanxianGiftNode.active=!1,void this.unschedule(this.scheduleTimer_tanxian);e>o&&e<i?(0==this.tanxianGiftNode.active&&(this.tanxianGiftNode.active=!0),this.tanxianGiftNode.getChildByName("TimeLabel").getComponent(cc.Label).string="\u5269\u4f59\u65f6\u95f4\uff1a"+w.TimeOffSetManager.formaterWithOutSecond2(i-e)):this.tanxianGiftNode.active=!1},t.prototype.initContinueRechargeGiveSkin=function(){var e,t=this;if(d.default.getRoleAttrValByKey(N.ROLE_ATTR_VALUES.ROLE_ATTR_CONTINUE_RECHARGE_GETSTATUS_2)>0)return this.unschedule(this.scheduleTimerRechargeGiveSkin),this.RechargeGiveSkinUiNode.getChildByName("time_lab").active=!1,this.RechargeGiveSkinUiNode.active=!1;d.default.getRoleAttrValByKey(N.ROLE_ATTR_VALUES.ROLE_ATTR_CONTINUE_RECHARGE_DAYNUM_2)>0?(this.unschedule(this.scheduleTimerRechargeGiveSkin),this.RechargeGiveSkinUiNode.getChildByName("time_lab").active=!1):(this.unschedule(this.scheduleTimerRechargeGiveSkin),this.schedule(this.scheduleTimerRechargeGiveSkin,1),this.scheduleTimerRechargeGiveSkin());var o=parseInt(b.getConfigIntValue("continueRecharge2_rechargeid")),i=h.RechargeTableData.getById(o).prize,a=this.RechargeGiveSkinUiNode.getChildByName("reward");a.removeAllChildren(),i.forEach(function(e){u.default.createNormalItems(e.dropID,e.dropNum,a,function(e){e.scale=.85})});var n=this.RechargeGiveSkinUiNode.getChildByName("H_Image"),c=K.default.Instance.getSkinTableDataBySkinItemId(Number(b.getConfigIntValue("continueRecharge2_itemId")));if(c){var f=K.default.Instance.getNpcTemplateId(c.heroItemId,c.id);if(n&&n.childrenCount<=0){var g=s.default.getInstance().getNpcTemplateConfig(f,1).res_id,_=s.default.getInstance().getResConfig(g).uiScale;m.default.loadSpineNode(s.default.getInstance().getResConfig(g).animation).then(function(e){e.parent=n,e.getComponent(sp.Skeleton).setAnimation(0,"idle",!0),e.scale=_/100}).catch(function(e){l.default.info(e)})}}var y=d.default.getRoleAttrValByKey(N.ROLE_ATTR_VALUES.ROLE_ATTR_CONTINUE_RECHARGE_DAYNUM_2),v=Number(b.getConfigIntValue("continueRecharge2_maxDay"));this.RechargeGiveSkinUiNode.getChildByName("txt_dayNum").getComponent(cc.Label).string=y+"/"+v;var C=this.RechargeGiveSkinUiNode.getChildByName("btn_get"),T=d.default.getRoleAttrValByKey(N.ROLE_ATTR_VALUES.ROLE_ATTR_CONTINUE_RECHARGE_GETSTATUS_2),P=C.getChildByName("label_get").getComponent(cc.Label);T>0?(u.default.setNodeBright(C,!1),P.string="\u5df2\u9886"):(P.string="\u9886\u53d6",y>=v?u.default.setNodeBright(C,!0):u.default.setNodeBright(C,!1)),u.default.registerTouchEvent(C,function(){if(y<v)return r.G.StringManager.PopString("\u518d\u8d2d\u4e70"+(v-y)+"\u5929\u540e\u5373\u53ef\u9886\u53d6");if(T>0)return r.G.StringManager.PopString("\u5956\u52b1\u5df2\u9886\u53d6");var e=new E.C_Role_Continue_Recharge_GetReward_2;I.ClientNetwork.getInstance().Send(E.ROLE_CLIENT_ENUM.P_Role_Continue_Recharge_GetReward_2,e)});var R=this.RechargeGiveSkinUiNode.getChildByName("btn_charge");R.rechargeItemInfo={rechargeID:o,rechargeNum:1},R.getChildByName("gotoChangeLab").getComponent(cc.Label).string="\uffe5"+(u.default.getRechargeMoneyByPlatform(h.RechargeTableData.getById(o))/100).toString();var L=d.default.getRoleAttrValByKey(N.ROLE_ATTR_VALUES.ROLE_ATTR_CONTINUE_RECHARGE_TIME_2),A=d.default.getServersTime2();console.log("\u6253\u5370\u76ae\u80a4\u5145\u503c,\u4e0a\u6b21\u5145\u503c\u65f6\u95f4="+new Date(1e3*L).toString()),0==w.TimeOffSetManager.getSpanDays(A,L)?(R.active=!1,this.RechargeGiveSkinUiNode.getChildByName("purchased").active=!0):(R.active=!0,this.RechargeGiveSkinUiNode.getChildByName("purchased").active=!1),u.default.registerTouchEvent(R,function(e){t.sendEvent("SendProtocolRecharge",e.target.rechargeItemInfo)});var D=this.RechargeGiveSkinUiNode.getChildByName("select"),M=d.default.getRoleInfoData().selfSelectMap.get(o);if(null==M||M<=0)D.getChildByName("player").active=!0,D.getChildByName("changeIcon").active=!1,D.getChildByName("txt").getComponent(cc.Label).string="";else{D.getChildByName("player").active=!1,D.getChildByName("changeIcon").active=!0;var B=s.default.getInstance().getItemByID(M);b.setTexture(D.getChildByName("headframe").getComponent(cc.Sprite),B.icon);var k=Number(b.getConfigIntValue("SelfSelect_"+o));D.getChildByName("txt").getComponent(cc.Label).string=null!==(e=""+k)&&void 0!==e?e:""}u.default.registerTouchEvent(D,function(){var e=parseInt(b.getConfigIntValue("continueRecharge2_rechargeid")),o=d.default.getRoleRechargeData().get(e);if(o&&o.dayNum>0)return r.G.StringManager.PopString("\u4eca\u65e5\u5df2\u8d2d\u4e70\uff0c\u65e0\u6cd5\u9009\u62e9");var i=p.LuckyGiftSelectTableData.getById(6003).prize;(i=b.clone(i)).forEach(function(t){var o=Number(b.getConfigIntValue("SelfSelect_"+e));t.itemNum=null!=o?o:1});for(var a=i.length-1;a>=0;a--)2!=s.default.getInstance().getItemByID(i[a].itemID).type&&i.splice(a,1);S.default.addPopView("BaseCtrl","LuckyGiftSelectRewardView","LuckyGiftSelectRewardView",{tRewards:i,index:e,isEveryDayReacharge:!1,parent:t,callBack:function(e,t){if(0!=e){var o=new E.C_Role_SetSelfSelect;o.type=t,o.selectItemId=e,I.ClientNetwork.getInstance().Send(E.ROLE_CLIENT_ENUM.P_Role_SetSelfSelect,o)}else r.G.StringManager.PopString("\u672a\u9009\u62e9\u5361")}})}),u.default.registerTouchEvent(this.RechargeGiveSkinUiNode.getChildByName("tipBtnNode"),function(){S.default.addPopView("BaseCtrl","ShopContinuousRechargeTipView","ShopContinuousRechargeTipView")})},t.prototype.scheduleTimerRechargeGiveSkin=function(){var e=b.getConfigIntValue("continueRecharge2_recharge_time").split("|"),t=Number(e[0]),o=Number(e[1]),i=d.default.getServersTime2();if(i<t||i>o)return this.unschedule(this.scheduleTimerRechargeGiveSkin),this.RechargeGiveSkinUiNode.getChildByName("time_lab").active=!1,this.RechargeGiveSkinUiNode.active=!1;this.RechargeGiveSkinUiNode.active=!0;var a=o-i;this.RechargeGiveSkinUiNode.getChildByName("time_lab").getComponent(cc.Label).string="\u6fc0\u6d3b\u5012\u8ba1\u65f6\uff1a"+w.TimeOffSetManager.formaterWithOutSecond2(a),this.RechargeGiveSkinUiNode.getChildByName("time_lab").active=!0},t.prototype.update=function(){cc.find("Canvas").getChildByName("UI_Mask_"+this.node.name).zIndex=this.node.zIndex-1},t.prototype.onDestroy=function(){Y.default.Instance.off(this)},n([ee(cc.Node)],t.prototype,"FirstChargeNode",void 0),n([ee(cc.Node)],t.prototype,"MonthCardNode",void 0),n([ee(cc.Node)],t.prototype,"SuperSaleNode",void 0),n([ee(cc.Node)],t.prototype,"SuperChosenNode",void 0),n([ee(cc.Node)],t.prototype,"ItemShopNode",void 0),n([ee(cc.Node)],t.prototype,"DiamondShopNode",void 0),n([ee(cc.Node)],t.prototype,"GoldShopNode",void 0),n([ee(cc.Prefab)],t.prototype,"ItemPrefab",void 0),n([ee(cc.Prefab)],t.prototype,"DiamondPrefab",void 0),n([ee(cc.Prefab)],t.prototype,"GoldPrefab",void 0),n([ee(cc.Node)],t.prototype,"LuckyCardNode0",void 0),n([ee(cc.Node)],t.prototype,"LuckyCardNode1",void 0),n([ee(cc.Node)],t.prototype,"LuckyCardNode2",void 0),n([ee(cc.Node)],t.prototype,"LuckyCardNode3",void 0),n([ee(cc.Node)],t.prototype,"LuckyCardNode4",void 0),n([ee(cc.Node)],t.prototype,"VoucherNodeAndroid",void 0),n([ee(cc.Node)],t.prototype,"VoucherNodeIos",void 0),n([ee(cc.Prefab)],t.prototype,"VoucherPrefab",void 0),n([ee(cc.Node)],t.prototype,"continueChargeNode",void 0),n([ee(cc.Node)],t.prototype,"limitTimeChargeNode",void 0),n([ee(cc.Node)],t.prototype,"newYearFreeGiftNode",void 0),n([ee(cc.Node)],t.prototype,"newYearStageGiftNode",void 0),n([ee(cc.Node)],t.prototype,"newYearSkinGiftNode",void 0),n([ee(cc.Node)],t.prototype,"springGiftNode",void 0),n([ee(cc.Node)],t.prototype,"springGiftNode_eachDay",void 0),n([ee(cc.Node)],t.prototype,"tanxianGiftNode",void 0),n([ee(cc.Node)],t.prototype,"ScoreFundViewNode",void 0),n([ee(cc.Node)],t.prototype,"ScoreFundViewRewardItemNode",void 0),n([ee(cc.ScrollView)],t.prototype,"ScoreFundViewScrollViewNode",void 0),n([ee(cc.Node)],t.prototype,"ScoreFundViewProgressBarNode",void 0),n([ee(cc.Node)],t.prototype,"RechargeGiveSkinUiNode",void 0),n([_.Register_Class,$],t)}(c.default);o.default=te,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/CostGetTableData":"CostGetTableData","../../StaticData/DiscountRechargeTableData":"DiscountRechargeTableData","../../StaticData/LuckyGiftSelectTableData":"LuckyGiftSelectTableData","../../StaticData/RandRechargeGroupTableData":"RandRechargeGroupTableData","../../StaticData/RandShopItemTableData":"RandShopItemTableData","../../StaticData/RandShopPositionTableData":"RandShopPositionTableData","../../StaticData/RandShopTableData":"RandShopTableData","../../StaticData/RechargeTableData":"RechargeTableData","../../StaticData/RoleScoreFundTableData":"RoleScoreFundTableData","../../StaticData/StringValueTableData":"StringValueTableData","../../StaticData/VoucherRechargeTableData":"VoucherRechargeTableData","../../StaticData/WorldTableData":"WorldTableData","../../TableReader":"TableReader","../../common/CommandValue":"CommandValue","../../common/EventConst":"EventConst","../../common/NetworkProtocolCommon":"NetworkProtocolCommon","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/base/GameView":"GameView","../../modules/manager/EventManager":"EventManager","../../modules/manager/LoadResManager":"LoadResManager","../../network/ClientNetwork":"ClientNetwork","../../network/protocol/ActivityProtocols":"ActivityProtocols","../../network/protocol/RoleProtocols":"RoleProtocols","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/ByteDanceMiniGameUtils":"ByteDanceMiniGameUtils","../../utils/ConfigUtils":"ConfigUtils","../../utils/GamePlatform":"GamePlatform","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils","../../utils/LogUtil":"LogUtil","../../utils/ResourcesManager":"ResourcesManager","../../utils/RewardedVideoAd":"RewardedVideoAd","../../utils/RewardedVideoUnitIdConst":"RewardedVideoUnitIdConst","../../utils/TimeOffSetManager":"TimeOffSetManager","../../utils/UIManager":"UIManager","../../utils/subUtils/SpineMaker":"SpineMaker","../heroCardBag/HeroSkinUtils":"HeroSkinUtils","../mainScene/CarSkinUtils":"CarSkinUtils","./ShopHelpView":"ShopHelpView"}],ShopModel:[function(e,t,o){"use strict";cc._RF.push(t,"ce7a25QTRhNb6PB+g2g7j8a","ShopModel"),o.__esModule=!0,o.default=void 0;var i=n(e("../utils/ConfigUtils")),a=n(e("../utils/Tools"));function n(e){return e&&e.__esModule?e:{default:e}}var r=function(){function e(){this.buildShopData()}e.getInstance=function(){return this.Instance||(this.Instance=new e),this.Instance};var t=e.prototype;return t.buildShopData=function(){this.tbEveryBox=[],this.tbBox=[],this.tbGold=[];var e=i.default.getInstance().getShopConfig();for(var t in e){var o=e[t].id;1==e[t].shop_type?this.tbEveryBox.push(o):2==e[t].shop_type?this.tbBox.push(o):3==e[t].shop_type&&this.tbGold.push(o)}this.refreshTavern()},t.refreshTavern=function(){this.tbRandTavernAll=[];var e=[],t=[],o=[],n=[],r=[],s=[],c=i.default.getInstance().getShopTavernConfig();for(var l in c){var d=c[l].id;1==c[l].pos?o.push(d):2==c[l].pos&&n.push(d)}for(var u in o){var h=i.default.getInstance().getShopTavernConfigID(o[u]);r.push(h.weight)}for(var p=(r=a.default.arrOverAdd(r))[r.length-1],f=0;f<1;f++){var g=Math.random()*p;d=a.default.getArrIndex(g,r,o),e.push(d)}for(var m in n)h=i.default.getInstance().getShopTavernConfigID(n[m]),s.push(h.weight);for(var _=(s=a.default.arrOverAdd(s))[s.length-1],y=0;y<5;){var v=!0;for(var C in g=Math.random()*_,d=a.default.getArrIndex(g,s,n),t)if(d==t[C]){v=!1;break}v&&(t.push(d),y+=1)}for(var S=0;S<6;S++)0==S?this.tbRandTavernAll.push(e[S]):this.tbRandTavernAll.push(t[S-1])},t.getEveryBoxData=function(){return this.tbEveryBox},t.getEveryBoxLimitTimes=function(){var e=this.getEveryBoxData()[0];return i.default.getInstance().getShopConfigByID(e).limitTimes},t.getTavernData=function(){return this.tbRandTavernAll},t.getBoxData=function(){return this.tbBox},t.getGoldData=function(){return this.tbGold},t.getBoxDataByBoxID=function(e){return i.default.getInstance().getShopBoxConfigByID(e)},t.getDropDataByID=function(e){return i.default.getInstance().getShopDropConfigByID(e)},t.getDropDataByType=function(e){var t=[],o=i.default.getInstance().getShopDropConfig();for(var a in o){var n=o[a].id;o[a].lv_limit,o[a].type==e&&t.push(n)}return t},t.getDropRandIDByType=function(e){var t=[],o=this.getDropDataByType(e),i=0;for(var n in o){var r=this.getDropDataByID(o[n]);t.push(r.weight)}for(var s=(t=a.default.arrOverAdd(t))[t.length-1],c=0;c<1;c++){var l=Math.random()*s;i=a.default.getArrIndex(l,t,o)}return i},t.getBoxTypeByBoxID=function(e){var t,o=[];return(t=this.getBoxDataByBoxID(e)).colorNum0>0&&o.push(t.dropBoxType0),t.colorNum1>0&&o.push(t.dropBoxType1),t.colorNum2>0&&o.push(t.dropBoxType2),t.colorNum3>0&&o.push(t.dropBoxType3),t.colorNum4>0&&o.push(t.dropBoxType4),t.colorNum5>0&&o.push(t.dropBoxType5),o},t.getBoxNumByBoxID=function(e){var t,o=[];return(t=this.getBoxDataByBoxID(e)).colorNum0>0&&o.push(t.colorNum0),t.colorNum1>0&&o.push(t.colorNum1),t.colorNum2>0&&o.push(t.colorNum2),t.colorNum3>0&&o.push(t.colorNum3),t.colorNum4>0&&o.push(t.colorNum4),t.colorNum5>0&&o.push(t.colorNum5),o},t.getBoxImageByBoxID=function(e){var t,o=[];return(t=this.getBoxDataByBoxID(e)).colorNum0>0&&o.push(t.colorPic0),t.colorNum1>0&&o.push(t.colorPic1),t.colorNum2>0&&o.push(t.colorPic2),t.colorNum3>0&&o.push(t.colorPic3),t.colorNum4>0&&o.push(t.colorPic4),t.colorNum5>0&&o.push(t.colorPic5),o},e}();o.default=r,r.Instance=null,t.exports=o.default,cc._RF.pop()},{"../utils/ConfigUtils":"ConfigUtils","../utils/Tools":"Tools"}],SingleNodeCache:[function(e,t,o){"use strict";cc._RF.push(t,"18209efZ59OFZCQoweJkjKE","SingleNodeCache");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,s=r.ccclass,c=r.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._persistNode=new cc.Node,t._cacheTag=new Set,t}return a(t,e),t.prototype.canCache=function(e){return this._cacheTag.has(e)},t.prototype.addCachePopTag=function(e){this._cacheTag.add(e)},t.prototype.recycleNode=function(e){if(!this.canCache(parseInt(e.name)))return e.destroy(),void e.removeFromParent(!0);this._persistNode.getChildByName(e.name)||(e.parent=this._persistNode)},t.prototype.getNode=function(e){return this._persistNode.getChildByName(e.toString())},t.prototype.clear=function(){this._persistNode.destroyAllChildren(),this._persistNode.removeAllChildren(!0)},n([c(cc.Node)],t.prototype,"_persistNode",void 0),n([s],t)}(cc.Component);o.default=l,cc._RF.pop()},{}],Skill:[function(e,t,o){"use strict";cc._RF.push(t,"d8a06Z1uOxLaYpbSB5bodLm","Skill"),o.__esModule=!0,o.default=void 0;var i=g(e("../../common/CombatModule")),a=g(e("../../utils/ConfigUtils")),n=e("../../utils/ConstValue"),r=g(e("../../utils/Tools")),s=g(e("../CombatManager")),c=g(e("../../utils/GameTools")),l=e("../../utils/GameUtils"),d=e("../../utils/RandomSeed"),u=e("../../modules/manager/cheat/SafeNumber"),h=g(e("../../utils/Debug")),p=g(e("../../modules/manager/EventManager")),f=g(e("../../common/EventConst"));function g(e){return e&&e.__esModule?e:{default:e}}e("../../network/protocol/TypeProtocols");var m=function(){function e(){this.templateId=0,this.id=0,this.deltaTime=0,this.pBindNpcObj=null,this.pTargetObj=null,this.targetObjList=[],this.config=null,this.castCount=0,this.randomSeed=null,this.skillType=new u.SafeNumber(0),this.randomSkills=[],this.bindCD=0,this.bReconnectDoSkill=!1,this.actionScale=1,this.bDoSkill=!1}var t=e.prototype;return t.init=function(e,t){this.id=r.default.getInstance().genId(),this.templateId=e,this.pBindNpcObj=t,this.config=a.default.getInstance().getSkillConfig(e),this.config&&(this.randomSeed=new d.RandomSeed,this.randomSeed.RandomSeed(this.templateId),this.skillType.value=this.config.type,this.skillType.value==n.SkillType.random||this.skillType.value==n.SkillType.queue||this.skillType.value==n.SkillType.random_sprite?this.randomSkills=this.config.random_skills.split("|"):this.skillType.value==n.SkillType.steal_skill&&(this.bindCD=this.config.cd,this.refreshStealSkillList(),p.default.Instance.on(f.default.BattleChangeHero,this.onBattleChangeHero,this)))},t.unbind=function(){for(var e in this.pBindNpcObj=null,this.pTargetObj=null,this.targetObjList)this.targetObjList[e]=null;this.targetObjList=null,p.default.Instance.off(this,f.default.BattleChangeHero)},t.update=function(e){this.config&&(this.bReconnectDoSkill?this.doSkill():this.deltaTime>0?this.deltaTime=this.deltaTime-1e3*e:this.pBindNpcObj.canDoSkill()&&this.doSkill())},t.calDeltaTime=function(e){if(this.config&&516!=this.pBindNpcObj.templateId&&10060!=this.pBindNpcObj.templateId&&10061!=this.pBindNpcObj.templateId&&10062!=this.pBindNpcObj.templateId&&10063!=this.pBindNpcObj.templateId&&10064!=this.pBindNpcObj.templateId){var t=this.config.cd/(1+.001*(this.pBindNpcObj.getAttackSpeed()-e))-this.deltaTime,o=this.config.cd/(1+.001*this.pBindNpcObj.getAttackSpeed());this.deltaTime=o-t}},t.doSkill=function(e){if(this.skillType.value==n.SkillType.random){var t=this.randomSeed.randomMinMaxInt(1,this.randomSkills.length),o=a.default.getInstance().getSkillConfig(this.randomSkills[t-1]);if(!o)return this.deltaTime=this.config.cd/(1+.001*this.pBindNpcObj.getAttackSpeed()),void(this.deltaTime<10&&(this.deltaTime=10));this.config=o}else if(this.skillType.value==n.SkillType.queue){var i=this.pBindNpcObj.getCastSkillCount()%this.randomSkills.length,r=a.default.getInstance().getSkillConfig(this.randomSkills[i]);if(0!=r.type&&this.pBindNpcObj.setNextSkillIndex(Number(this.randomSkills[i])%10),!r)return this.deltaTime=this.config.cd/(1+.001*this.pBindNpcObj.getAttackSpeed()),void(this.deltaTime<10&&(this.deltaTime=10));this.config=r}else{if(this.skillType.value==n.SkillType.random_sprite){var c=this.randomSeed.randomMinMaxInt(1,this.randomSkills.length),l=this.randomSkills[c-1],d=s.default.getInstance().getController();return void(d&&d.onScheduleOnce(Number(l),this.pBindNpcObj.getCamp(),0,!0))}if(this.skillType.value==n.SkillType.steal_skill){var u=this.randomSeed.randomMinMaxInt(1,this.randomSkills.length),h=a.default.getInstance().getSkillConfig(this.randomSkills[u-1]);if(!h)return this.deltaTime=this.bindCD/(1+.001*this.pBindNpcObj.getAttackSpeed()),void(this.deltaTime<10&&(this.deltaTime=10));this.config=h}}this.targetObjList=[];var p=null;return e?p=e:1==this.config.is_need_aim_target&&(p=this.searchTarget()),0==this.config.is_need_aim_target||p||this.config.sprite_type==n.Enum_Elf_Card.anElf&&!p?(this.doSkillAction(p),this.bReconnectDoSkill||(this.deltaTime=this.config.cd/(1+.001*this.pBindNpcObj.getAttackSpeed()),this.skillType.value==n.SkillType.steal_skill&&(this.deltaTime=this.bindCD/(1+.001*this.pBindNpcObj.getAttackSpeed())),this.deltaTime<10&&(this.deltaTime=10))):1!=this.config.is_need_aim_target||p||this.skillType.value!=n.SkillType.random&&this.skillType.value!=n.SkillType.queue||(this.pBindNpcObj.modCastSkillCount(),this.bReconnectDoSkill||(this.deltaTime=this.config.cd/(1+.001*this.pBindNpcObj.getAttackSpeed()),this.skillType.value==n.SkillType.steal_skill&&(this.deltaTime=this.bindCD/(1+.001*this.pBindNpcObj.getAttackSpeed())),this.deltaTime<10&&(this.deltaTime=10))),this.bReconnectDoSkill=!1,p},t.searchTarget=function(e){var t=null,o=this.getTargetList();for(var i in o)if(t=this.searchTarget1(o[i],e))break;return t},t.searchTarget1=function(e,t){var o=this.pBindNpcObj.camp,a=0;if(e==n.SKILL_TARGET.selfNpc||e==n.SKILL_TARGET.selfCar||e==n.SKILL_TARGET.selfHero?(a=o,s.default.getInstance().isCoop()&&e==n.SKILL_TARGET.selfCar&&(s.default.getInstance().isSkyCastleEnemy(o)?a=n.PLAYER_CAMP.opponents:(0,l.getRoleIdentity)(o)==n.PLAYER_IDENTITY.home&&(a=s.default.getInstance().getCoopCarCamp(o)))):(a=3-o,s.default.getInstance().isCoop()&&(o==n.PLAYER_CAMP.coopPlayer?a=n.PLAYER_CAMP.opponents:o!=n.PLAYER_CAMP.opponents&&o!=n.PLAYER_CAMP.opponentsCoop||(i.default.matchRoleIdentity==n.PLAYER_IDENTITY.home?a=n.PLAYER_CAMP.coopPlayer:i.default.matchRoleIdentity==n.PLAYER_IDENTITY.away&&(a=n.PLAYER_CAMP.myPlayer),this.config.sprite_type!=n.Enum_Elf_Card.anElf&&this.config.sprite_type!=n.Enum_Elf_Card.huanElf&&e!=n.SKILL_TARGET.opponentsHero||(a=this.getOpponentCampId())))),e==n.SKILL_TARGET.selfNpc||e==n.SKILL_TARGET.opponentsNpc||e==n.SKILL_TARGET.opponentsLandNpc||e==n.SKILL_TARGET.opponentsAirNpc){var r=null;return e==n.SKILL_TARGET.opponentsLandNpc?r=n.NPC_POS_TYPE.Land:e==n.SKILL_TARGET.opponentsAirNpc&&(r=n.NPC_POS_TYPE.Air),this.searchNpc(a,t,r)}if(e==n.SKILL_TARGET.selfCar||e==n.SKILL_TARGET.opponentsCar){var c;if((c=s.default.getInstance().getCarByCamp(a))&&this.chkDistance(c,!1)){if(t)return null;if(!this.targetObjList[c.id])return this.targetObjList[c.id]=c,c}return null}if(e==n.SKILL_TARGET.selfHero||e==n.SKILL_TARGET.opponentsHero){if(s.default.getInstance().isSkyCastle()&&(a=this.getSkyOpponentCampId(o)),c=s.default.getInstance().getCarByCamp(a)){var d=null;if(Number(this.config.search_condition)==n.SKILL_SEARCH_CONDITION.maxAttack)d=this.findMaxAttackHero(c);else if(Number(this.config.search_condition)==n.SKILL_SEARCH_CONDITION.GTRLvOne){var u=c.getHeroLvNum(Number(this.config.search_condition));s.default.getInstance().isCoop()&&u<=0&&(c=s.default.getInstance().getCoopCarByCamp(c.camp))&&(u=c.getHeroLvNum(Number(this.config.search_condition)));var h=this.randomSeed.randomMinMaxInt(1,u);c&&(d=c.getHeroByLvType(h,Number(this.config.search_condition)))}else if(Number(this.config.search_condition)==n.SKILL_SEARCH_CONDITION.excludeWarlock){var p=c.getHeroExcludeProfNum(n.HERO_PROF_TYPE.Warlock);s.default.getInstance().isCoop()&&p<=0&&(c=s.default.getInstance().getCoopCarByCamp(c.camp))&&(p=c.getHeroExcludeProfNum(n.HERO_PROF_TYPE.Warlock));var f=this.randomSeed.randomMinMaxInt(1,p);c&&(d=c.getHeroByExProfType(f,n.HERO_PROF_TYPE.Warlock))}else if(Number(this.config.search_condition)==n.SKILL_SEARCH_CONDITION.excludeMaxAttack){var g=this.findMaxAttackHero(c);if(g){var m=Number(g.getAttack()),_=c.getHeroExcludeMaxAttackNum(m);s.default.getInstance().isCoop()&&_<=0&&(c=s.default.getInstance().getCoopCarByCamp(c.camp))&&(_=c.getHeroExcludeMaxAttackNum(m));var y=this.randomSeed.randomMinMaxInt(1,_);c&&((d=c.getHeroExcludeMaxAttack(y,m))||(d=c.getRandHero(1)))}}else{var v=c.getHeroNum();if(v>0){var C=this.randomSeed.randomMinMaxInt(1,v);d=c.getRandHero(C)}else if(s.default.getInstance().isCoop()){var S=s.default.getInstance().getCoopCarByCamp(c.camp);if(S){var T=S.getHeroNum();if(T>0){var I=this.randomSeed.randomMinMaxInt(1,T);d=S.getRandHero(I)}}}}return d}}else if(e==n.SKILL_TARGET.selfBindHero)return this.pBindNpcObj},t.getCoopTargetCamp=function(e){return e==n.PLAYER_CAMP.coopPlayer?n.PLAYER_CAMP.myPlayer:e==n.PLAYER_CAMP.myPlayer?n.PLAYER_CAMP.coopPlayer:e},t.searchNpc=function(e,t,o){var i=s.default.getInstance().getNpcList(),a=0,n=null,r=0;for(var c in i){var l=i[c];if(l&&!l.isDead()&&l.camp==e&&0!=l.canAim()&&(null==o||l.posType==o)&&!this.targetObjList[c]&&this.chkDistance(l,!0)){if(t){if(l.isCar()||t.isCar())continue;var d=Math.abs(t.getWorldPos().x-l.getWorldPos().x),u=Math.abs(t.getWorldPos().y-l.getWorldPos().y);if(d>250||u>100)continue}a+=1;var h=Math.abs(Math.abs(this.pBindNpcObj.getWorldPos().x-l.getWorldPos().x)-.5*l.width);if((0==r||r>h)&&(r=h,n=l),t||a>=2)break}}return n&&(this.targetObjList[n.id]=n),n},t.chkDistance=function(e,t){var o=Math.abs(Math.abs(this.pBindNpcObj.getWorldPos().x-e.getWorldPos().x)-.5*e.width),i=Math.abs(this.pBindNpcObj.getWorldPos().y-e.getWorldPos().y-.5*e.height),a=o<this.getDistanceWidth(),n=!t||i<this.getDistanceHeight();return a&&n},t.getTarget=function(){for(var e in this.targetObjList)if(this.targetObjList[e])return this.targetObjList[e];return null},t.doSkillAction=function(e){var t=this;if(this.pBindNpcObj.chgState(n.NPC_STATE.Attack),this.pBindNpcObj.heroTemplateId!=n.Enum_Elf_Card.moElf&&this.pBindNpcObj.heroTemplateId!=n.Enum_Elf_Card.leiElf&&this.pBindNpcObj.heroTemplateId!=n.Enum_Elf_Card.muElf){var o="attack";if(this.config.act_change&&this.config.act_change.length>0&&(o=this.config.act_change),s.default.getInstance().getStoryState()&&this.pBindNpcObj.camp!=n.PLAYER_CAMP.opponents)this.pBindNpcObj.chgState(n.NPC_STATE.IDLE);else{this.bDoSkill=!1,r.default.playAudioEffect(this.config.skill_audio);var i=this.pBindNpcObj.getSpineNode();if(i&&this.pBindNpcObj.heroTemplateId!=n.Enum_Elf_Card.rainbowElf){i.timeScale=1+.001*this.pBindNpcObj.getAttackSpeed();var a=i.setAnimation(0,o,!1);this.bReconnectDoSkill&&(this.actionScale=this.config.cd/this.deltaTime,this.deltaTime<=0&&(this.actionScale=this.config.cd/1),i.timeScale*=this.actionScale),i.setCompleteListener(function(a){(a.animation?a.animation.name:"")===o&&(t.bDoSkill||(t.onActionDone(e),t.bDoSkill=!0),i.timeScale=1,t.pBindNpcObj.chgState(n.NPC_STATE.IDLE))}),i.setInterruptListener(function(e){(e.animation?e.animation.name:"")===o&&(t.bDoSkill||(t.deltaTime=0))}),a&&i.setTrackEventListener(a,function(o,i){"fire"===(i.data?i.data.name:"")&&(t.bDoSkill||(t.onActionDone(e),t.bDoSkill=!0))})}else this.onActionDone(e),this.bDoSkill=!0}}else if(r.default.playAudioEffect("combat/audio/animation/skill_qiu"),this.onActionDone(e),this.pBindNpcObj.chgState(n.NPC_STATE.IDLE),this.pBindNpcObj.heroTemplateId==n.Enum_Elf_Card.muElf)e.isCar()&&r.default.playEffect("combat/animation/hero/jiaxue/jiaxue_beiji",e.node,cc.v2(50,50),.85);else if(this.pBindNpcObj.heroTemplateId==n.Enum_Elf_Card.moElf&&s.default.getInstance().isCoop()&&e.isCar()){var c=null;if(c=s.default.getInstance().getCoopCarByCamp(e.camp)){var l=this.getBuffList();if(!l||1==l.length&&"0"==l[0])return;for(var d in l)c.addBuff(l[d],this.pBindNpcObj)}}},t.onActionDone=function(e){if(cc.director.emit("Event_AttackTarget",this.pBindNpcObj.heroTemplateId,null,this.pBindNpcObj.camp,!1,!0),this.pBindNpcObj.camp,e||this.config.type==n.SkillType.other||1==this.config.is_need_aim_target&&(e=this.searchTarget()),e&&e.state==n.NPC_STATE.Dead&&!e.isCar()&&1==this.config.is_need_aim_target&&(e=this.searchTarget()),this.config.type==n.SkillType.direct_damage){if(this.pBindNpcObj.attackTarget(e,!1,this.getBehitOffset(),this.getDamageParam()*this.pBindNpcObj.getDamageRatio()),1==this.config.aoe_attack)for(var t=this.searchTarget(e);t;)this.pBindNpcObj.attackTarget(t,!1,this.getBehitOffset(),this.getDamageParam()*this.pBindNpcObj.getDamageRatio()),t=this.searchTarget(e)}else this.config.type==n.SkillType.AddHp&&this.pBindNpcObj.attackTarget(e,!0,this.getBehitOffset(),this.getDamageParam()*this.pBindNpcObj.getDamageRatio());this.pBindNpcObj.modCastSkillCount(),0!=this.config.sprite_type?0==this.config.sprite_pr?(this.doActionSpecialEffect(e),this.config.sprite_type==n.Enum_Elf_Card.anElf&&this.checkFallStarHero()):this.castSprite(this.config.sprite_type,e,this.doActionSpecialEffect):this.doActionSpecialEffect(e)},t.castSprite=function(e,t,o){var c=this,d=this,u=s.default.getInstance().getPlayerModelByCamp(this.pBindNpcObj.camp);if(u.isChangeSprit(e))u.onActionFireWork(e,null,!0,!0);else{var p=!0;if(t)this.config.sprite_type!=n.Enum_Elf_Card.anElf&&this.config.sprite_type!=n.Enum_Elf_Card.huanElf||Math.floor(100*this.randomSeed.getRandom())+1<=this.config.sprite_pr&&(p=!1);else if(p=!0,this.config.sprite_type==n.Enum_Elf_Card.anElf)return void o.call(d,t);var f=new cc.Node("elfNode");f.parent=s.default.getInstance().getController().mapNode,f.addComponent(sp.Skeleton),f.x=f.parent.width/2,f.y=f.parent.height/2+90,f.scale=.8;var g=a.default.getInstance().getHeroConfig(e),m=a.default.getInstance().getNpcTemplateConfig(g.npc_id,1).res_id,_=s.default.getInstance().getPlayerModelByCamp(t.camp);if(!p)if(this.config.sprite_type==n.Enum_Elf_Card.anElf){if(_&&(_.camp==n.PLAYER_CAMP.myPlayer||i.default.opponentsReplaced||(0,l.isRobot)(_.camp))){var y=_.carInfo.tbHeroList[t.heroTemplateId];if(!y)return void o.call(d,t);y.starLevel>1&&(y.starLevel--,_.sendHeroLvDownToServer(t.heroTemplateId))}}else if(this.config.sprite_type==n.Enum_Elf_Card.huanElf)return o.call(d,t),void((i.default.matchRoleIdentity==n.PLAYER_IDENTITY.home||i.default.opponentsReplaced)&&_.onAllRoleChangeEquip(n.Enum_Elf_Card.huanElf));cc.resources.load(a.default.getInstance().getResConfig(m).animation,sp.SkeletonData,function(e,a){if(e)return h.default.error("load elfNode err:"+e.message),void o.call(d,t);if(cc.isValid(f)){var u=f.getComponent(sp.Skeleton);if(u){if(u.skeletonData=a,u.setSkin("default"),u.setAnimation(0,"idle",!0),r.default.playAudioEffect("combat/audio/animation/skill_qiu"),!t)return void setTimeout(function(){f.destroy(),o.call(d,t)},500);var g=t.node.convertToWorldSpaceAR(cc.v2(0,0));g=f.parent.convertToNodeSpaceAR(g),cc.tween(f).delay(.5).parallel(cc.tween().to(.25,{position:g}),cc.tween().to(.25,{scale:.25})).call(function(){c.config.sprite_type==n.Enum_Elf_Card.muElf?r.default.playEffect((0,l.getSpineNameByResId)(11047),t.node,cc.v2(0,-50),.85):c.config.sprite_type==n.Enum_Elf_Card.guangElf&&r.default.playEffect((0,l.getSpineNameByResId)(11045),t.node,cc.v2(0,0),.85),f.destroy(),o.call(d,t);var e=s.default.getInstance().getCarByCamp(t.camp);if(!e)return f.destroy();if(1!=p&&!(c.config.sprite_type==n.Enum_Elf_Card.anElf&&t.star<=1)&&c.config.sprite_type==n.Enum_Elf_Card.anElf&&(_.camp==n.PLAYER_CAMP.myPlayer||i.default.opponentsReplaced||(0,l.isRobot)(_.camp))){var a=_.carInfo.tbHeroList[t.heroTemplateId];e.refreshFallHeroInfo(a)}}).start()}}})}},t.doActionSpecialEffect=function(e){this.pBindNpcObj&&(0!=this.config.flying_obj&&this.emitFlyingObj(e),0!=this.config.obstacle&&s.default.getInstance().createObstacleObj(this.config.obstacle,this.pBindNpcObj,e,this.getBehitOffset(),this.getDamageParam()*this.pBindNpcObj.getDamageRatio()),this.summonNpc(),this.summonTreasureBox(),this.checkSkillNegEffect(),this.checkPREvent(),this.checkBuff(e))},t.emitFlyingObj=function(e){if(s.default.getInstance().emitFlyingObj(this.config.flying_obj,this.pBindNpcObj,e,this.getBehitOffset(),this.getDamageParam()*this.pBindNpcObj.getDamageRatio(),1==this.config.is_need_aim_target),this.config.flying_num>1)for(var t=1;t<this.config.flying_num;t++){var o=0,i=this.searchTarget(e);if(i){s.default.getInstance().emitFlyingObj(this.config.flying_obj,this.pBindNpcObj,i,this.getBehitOffset(),this.getDamageParam()*this.pBindNpcObj.getDamageRatio(),1==this.config.is_need_aim_target);var a=this.getBuffList();if(!a||1==a.length&&"0"==a[0])continue;for(var o in a)i.addBuff(a[o],this.pBindNpcObj)}}},t.summonNpc=function(){var e=this.getSummonNpcList();if(e&&(1!=e.length||"0"!=e[0])){var t=s.default.getInstance().getPlayerModelByCamp(this.pBindNpcObj.getCamp()),o=function(e){if(s.default.getInstance().lockStepManager){var t=s.default.getInstance().lockStepManager.getMosterBlood(e);if(t&&t.curBlood<=0)return!0}return!1};for(var i in e){var a=e[i],r=i%4*50+70*Math.floor(i/4),c=i%4*-1,d=(0,l.getRoleIdentity)(this.pBindNpcObj.getCamp());if(s.default.getInstance().isCoop()&&this.pBindNpcObj.getCamp()!=n.PLAYER_CAMP.opponents&&(r+=10*d),0!=a){var u=this.pBindNpcObj.heroTemplateId;u||(u=this.pBindNpcObj.templateId);var h=t.getHeroSummonId(this.pBindNpcObj.getCamp(),u);for(this.pBindNpcObj.summonMonsterCount++;o(h);)h=t.getHeroSummonId(this.pBindNpcObj.getCamp(),u),this.pBindNpcObj.summonMonsterCount++;if(h>=1e7*d+1e5*(u+1))return;s.default.getInstance().summon(a,this.pBindNpcObj.getLevel(),this.pBindNpcObj.getCamp(),r,c,!0,this.pBindNpcObj.starAttParam,this.pBindNpcObj.starHpParam,h);var p=s.default.getInstance().getNpcById(h);p&&p.setTheSummonerInfo(u,this.pBindNpcObj.isHero(),(0,l.getRoleIdentity)(this.pBindNpcObj.getCamp()))}}}},t.requestTreasureBox=function(e,t){if(this.pBindNpcObj&&s.default.getInstance().gameState==n.Game_State.Fighting){var o=Math.floor(100*Math.random())+1;if(Number(e)<o)return!1;var r=this.pBindNpcObj.camp,c=s.default.getInstance().getCarByCamp(r),d=i.default.getMatchBattleInfo(!1);if(!s.default.getInstance().isSkyCastle()&&(1==c.bAI||d&&1==d.bRobot)){var u=0,h=a.default.getInstance().getDorpItemsByID(2).dropRandom.split("|");for(var p in h){var f=h[p].split("#");u+=Number(f[3])}var g=Math.floor(Math.random()*u),m=0,_=null;for(var y in h){var v=h[y].split("#");if(g<=(m+=Number(v[3]))){_=v;break}}if(!_)return cc.log("\u968f\u673a\u9519\u8bef\uff0c\u6ca1\u6709\u627e\u5230\u6389\u843d\u6570\u636e"),void this.destroy();var C=1;if("skill"==t?C=2:"skillAgain"==t&&(C=3),C=1e3*(0,l.getRoleIdentity)(r)+C,Number(1003==_[0]))s.default.getInstance().getController().onParachuteAct(_[0],r,Number(_[2]),C);else{var S=_[0],T=i.default.getDropEquipList(),I=T[r]?T[r]:[];I.length>0&&(S=I[I.length-1]._templateId),s.default.getInstance().getController().onParachuteAct(S,r,1,C)}}else(s.default.getInstance().isCoop()&&(1==i.default.matchRoleIdentity||1==i.default.opponentsReplaced)||s.default.getInstance().isPvP()&&r==n.PLAYER_CAMP.myPlayer)&&s.default.getInstance().onSendRoleBossDropItems(10030,null,t,this.pBindNpcObj.camp);return!0}},t.summonTreasureBox=function(){if(Number(this.config.summon_box)&&0!==Number(this.config.summon_box)&&this.requestTreasureBox(Number(this.config.summon_box),"skill")&&Number(this.config.summon_box_again)&&0!==Number(this.config.summon_box_again)){var e=this;s.default.getInstance().getController().delayEvent(function(){e.requestTreasureBox(Number(e.config.summon_box_again),"skillAgain")},.5)}},t.blackElfFallStar=function(){var e=[];if(s.default.getInstance().isCoop()){if(this.pBindNpcObj.camp==n.PLAYER_CAMP.opponents){var t=s.default.getInstance().getCarByCamp(1),o=s.default.getInstance().getCarByCamp(3),i=t.getHeroList();for(var a in i)if(a<90){var r=i[a];r&&e.push(r)}var l=o.getHeroList();for(var d in l)if(d<90){var u=l[d];u&&e.push(u)}}}else{var h;h=this.pBindNpcObj.camp==n.PLAYER_CAMP.opponents?n.PLAYER_CAMP.myPlayer:n.PLAYER_CAMP.opponents;var p=s.default.getInstance().getCarByCamp(h).getHeroList();for(var f in p)if(f<90){var g=p[f];g&&e.push(g)}}if(e.length>0){var m=c.default.getRand(e.length);this.initElfBallFlyAnimate(40,e[m],function(){var t=s.default.getInstance().getPlayerModelByCamp(e[m].camp),o=s.default.getInstance().getCarByCamp(e[m].camp),i=t.carInfo.tbHeroList[e[m].heroTemplateId];i.starLevel>1&&(i.starLevel--,o.refreshFallHeroInfo(i))})}},t.initElfBallFlyAnimate=function(e,t,o){var i=new cc.Node("elfNodeFallStar");i.parent=s.default.getInstance().getController().mapNode,i.addComponent(sp.Skeleton),i.x=i.parent.width/2,i.y=i.parent.height/2+90,i.scale=.8;var n=a.default.getInstance().getHeroConfig(e),r=a.default.getInstance().getNpcTemplateConfig(n.npc_id,1).res_id;cc.resources.load(a.default.getInstance().getResConfig(r).animation,sp.SkeletonData,function(e,a){if(e)h.default.error("load elfNode err:"+e.message);else if(cc.isValid(i)){var n=i.getComponent(sp.Skeleton);if(n){if(n.skeletonData=a,n.setSkin("default"),n.setAnimation(0,"idle",!0),!t)return void setTimeout(function(){i.destroy(),o&&o()},500);var r=t.node.convertToWorldSpaceAR(cc.v2(0,0));r=i.parent.convertToNodeSpaceAR(r),cc.tween(i).delay(.5).parallel(cc.tween().to(.25,{position:r}),cc.tween().to(.25,{scale:.25})).call(function(){i.destroy(),o&&o()}).start()}}})},t.checkSkillNegEffect=function(){if(this.config.negative_effect&&""!=this.config.negative_effect){var e=this.config.negative_effect.split("|");for(var t in e){var o=e[t].split("#"),i=Number(o[0]),a=Number(o[1]);if(i==n.SKILL_NEGATIVE_EFFECT.minusCurHp){var r=s.default.getInstance().getCarByCamp(this.pBindNpcObj.camp);r&&r.modAttr(n.Npc_Attr_Type.curHp,-Math.ceil(r.hp*a/n.AttrParam))}}}},t.checkPREvent=function(){if(53==this.pBindNpcObj.heroTemplateId||1==this.config.trigger_event){var e=this.pBindNpcObj.getEventPR();if(Math.floor(100*this.randomSeed.getRandom())+1>Number(e))return;var t=(0,l.getRoleIdentity)(this.pBindNpcObj.camp);cc.director.emit("Event_PR",this.pBindNpcObj.camp,this.pBindNpcObj.id+t)}},t.checkBuff=function(e){if(e){var t=this.getBuffList();if(!t||1==t.length&&"0"==t[0])return;var o=this.getBuffTargetList();for(var i in t)if(!o||1==o.length&&""==o[0])e.addBuff(t[i],this.pBindNpcObj);else for(var a in o)if(o[a]==n.SKILL_TARGET.selfHeroExcludeBind){var r=s.default.getInstance().getCarByCamp(this.pBindNpcObj.camp);if(r){var c=r.getHeroNum()-1,l=this.randomSeed.randomMinMaxInt(1,c),d=null;this.getBuffSearchCondition()==n.SKILL_SEARCH_CONDITION.rand?d=r.getRandExcludeHero(l,this.pBindNpcObj.heroTemplateId):this.getBuffSearchCondition()==n.SKILL_SEARCH_CONDITION.maxAttack&&(d=r.getExcludeHeroByAttrTypeMax(n.Npc_Attr_Type.attack,this.pBindNpcObj.heroTemplateId)),d&&d.addBuff(t[i],this.pBindNpcObj)}}else if(o[a]==n.SKILL_TARGET.opponentsCar){var u=s.default.getInstance().getOpponentsCarCamp(this.pBindNpcObj.camp),h=s.default.getInstance().getCarByCamp(u);if(h&&(h.addBuff(t[i],this.pBindNpcObj),s.default.getInstance().isCoop())){var p=s.default.getInstance().getCoopCarByCamp(u);p&&p.addBuff(t[i],this.pBindNpcObj)}}else o[a]==n.SKILL_TARGET.selfBindHero&&this.pBindNpcObj.addBuff(t[i],this.pBindNpcObj)}},t.getSummonNpcList=function(){return this.config.summon_npc.split("|")},t.getBuffList=function(){return this.config.buff_list.split("|")},t.getBuffTargetList=function(){return this.config.buff_target.split("|")},t.getBuffSearchCondition=function(){return this.config.buff_search_condition},t.getTargetList=function(){return this.config.target.split("|")},t.getDistanceWidth=function(){var e=this.config.search_distance.split("|");return Number(e[0])},t.getDistanceHeight=function(){var e=this.config.search_distance.split("|");return Number(e[1])},t.getBehitOffset=function(){var e=this.config.behit_offset.split("|");return cc.v2(Number(e[0]),Number(e[1]))},t.getDamageParam=function(){return.01*this.config.damage},t.getSkyOpponentCampId=function(e){var t=this.randomSeed.randomMinMaxInt(1,2);return s.default.getInstance().isSkyCastleEnemy(e)?1==t?(0,l.getRoleIdentity)(n.PLAYER_CAMP.myPlayer)==n.PLAYER_IDENTITY.home?n.PLAYER_CAMP.myPlayer:n.PLAYER_CAMP.coopPlayer:(0,l.getRoleIdentity)(n.PLAYER_CAMP.myPlayer)==n.PLAYER_IDENTITY.home?n.PLAYER_CAMP.coopPlayer:n.PLAYER_CAMP.myPlayer:1==t?n.PLAYER_CAMP.opponents:n.PLAYER_CAMP.opponentsCoop},t.getOpponentCampId=function(){var e=0;return s.default.getInstance().isCoop()?this.pBindNpcObj.camp==n.PLAYER_CAMP.myPlayer?e=n.PLAYER_CAMP.coopPlayer:this.pBindNpcObj.camp==n.PLAYER_CAMP.coopPlayer?e=n.PLAYER_CAMP.myPlayer:this.pBindNpcObj.camp==n.PLAYER_CAMP.opponents&&(e=1==this.randomSeed.randomMinMaxInt(1,2)?(0,l.getRoleIdentity)(n.PLAYER_CAMP.myPlayer)==n.PLAYER_IDENTITY.home?n.PLAYER_CAMP.myPlayer:n.PLAYER_CAMP.coopPlayer:(0,l.getRoleIdentity)(n.PLAYER_CAMP.myPlayer)==n.PLAYER_IDENTITY.home?n.PLAYER_CAMP.coopPlayer:n.PLAYER_CAMP.myPlayer):e=this.pBindNpcObj.camp==n.PLAYER_CAMP.myPlayer?n.PLAYER_CAMP.opponents:n.PLAYER_CAMP.myPlayer,e},t.refreshStealSkillList=function(){var e=s.default.getInstance().getOpponentsCarCamp(this.pBindNpcObj.camp);if(e){var t=s.default.getInstance().getCarByCamp(e);t&&t.getAllHeroSkillID(this.randomSkills);var o=s.default.getInstance().getCoopCarByCamp(e);o&&o.getAllHeroSkillID(this.randomSkills)}},t.onBattleChangeHero=function(e){var t=s.default.getInstance().getOpponentsCarCamp(this.pBindNpcObj.camp),o=s.default.getInstance().getCoopCarCamp(t);e!=t&&e!=o||(this.randomSkills=[],this.refreshStealSkillList(),console.log("refreshStealSkillList",this.randomSkills))},t.checkFallStarHero=function(){var e=this.getOpponentCampId(),t=s.default.getInstance().getCarByCamp(e);if(t){var o=null,a=t.getHeroLvNum(n.SKILL_SEARCH_CONDITION.GTRLvOne);s.default.getInstance().isCoop()&&a<=0&&(t=s.default.getInstance().getCoopCarByCamp(t.camp))&&(a=t.getHeroLvNum(n.SKILL_SEARCH_CONDITION.GTRLvOne));var r=this.randomSeed.randomMinMaxInt(1,a);if(t&&(o=t.getHeroByLvType(r,n.SKILL_SEARCH_CONDITION.GTRLvOne)),o){var c=s.default.getInstance().getPlayerModelByCamp(o.camp);if(c&&(c.camp==n.PLAYER_CAMP.myPlayer||i.default.opponentsReplaced||(0,l.isRobot)(c.camp))){var d=c.carInfo.tbHeroList[o.heroTemplateId];if(!d)return;d.starLevel>1&&(d.starLevel--,c.sendHeroLvDownToServer(o.heroTemplateId),t.refreshFallHeroInfo(d))}}}},t.findMaxAttackHero=function(e){var t=e.getHeroByAttrTypeMax(n.Npc_Attr_Type.attack);if(s.default.getInstance().isCoop()){var o=s.default.getInstance().getCoopCarByCamp(e.camp);if(o){var i=o.getHeroByAttrTypeMax(n.Npc_Attr_Type.attack);t?i&&Number(i.getAttack())>Number(t.getAttack())&&(t=i):t=i}}return t},e}();o.default=m,t.exports=o.default,cc._RF.pop()},{"../../common/CombatModule":"CombatModule","../../common/EventConst":"EventConst","../../modules/manager/EventManager":"EventManager","../../modules/manager/cheat/SafeNumber":"SafeNumber","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/ConfigUtils":"ConfigUtils","../../utils/ConstValue":"ConstValue","../../utils/Debug":"Debug","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils","../../utils/RandomSeed":"RandomSeed","../../utils/Tools":"Tools","../CombatManager":"CombatManager"}],SkyCastleArenaView:[function(e,t,o){"use strict";cc._RF.push(t,"5de45NnnqxMKp7QAvh5tVX2","SkyCastleArenaView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=e("../../modules/base/GameView"),l=e("../../common/CombatModule"),d=e("../../Global/GameGlobal"),u=e("../../network/protocol/TypeProtocols"),h=e("./SkyCastleModule"),p=e("../../utils/GameTools"),f=e("../../StaticData/ActivityTableData"),g=e("../../network/protocol/ActivityProtocols"),m=e("../../common/PlayerModule"),_=e("../../network/protocol/TypeProtocols"),y=e("../../StaticData/SkyCastlePrizeTableData"),v=e("../../common/EventConst"),C=e("../../modules/manager/EventManager"),S=e("./SkyCastleUtils"),T=e("../../network/ClientNetwork"),I=e("../../network/LocalMessage"),N=e("../../common/CommandValue"),b=cc._decorator,w=b.ccclass,E=b.property,P=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.m_chatNode=null,t.m_battlePssNode=null,t.m_rewardLayoutNode=null,t.m_typeArrNode=[],t.m_doorSpine=null,t.m_activityTimeLab=null,t}return a(t,e),t.path=function(){return"ui/skyCastleActivity/prefab/SkyCastleArenaMain"},t.prototype.onLoad=function(){T.ClientNetwork.getInstance().listenLocalMessage(I.LOCAL_MESSAGE.LocalMsg_RefreshSkyCastleRed,this.updateRed,this),C.default.Instance.on(v.default.SkyCastleRefreshBoxRedpoint,this.onRefreshBoxRedPoint,this),C.default.Instance.on(v.default.SyncSkyCastleChangeType,this.initRewardsInfo,this),this.hideMainChatView()},t.prototype.start=function(){this.setChatViewVisible(!0),this.initRewardsInfo(),this.onRefreshBoxRedPoint(),this.updateRechargeRed();var e=cc.view.getVisibleSize(),t=e.width/1280;e.height,this.node.getChildByName("shilianzhimen").scaleX=t},t.prototype.refreshActivityCountdown=function(){var e=f.ActivityTableData.getById(g.ACTIVITY_ID_ENUM.P_Activity_SkyCastle),t=m.default.getServersTime(),o=e.param9-t;if(o<=0)return this.m_activityTimeLab.string="\u6d3b\u52a8\u5df2\u7ed3\u675f\uff01",this.node.getChildByName("MatchNode").active=!0,this.node.getChildByName("MatchNode").getComponent(cc.Button).interactable=!1,this.node.getChildByName("MatchNode").getComponent(cc.Button).enableAutoGrayEffect=!0,this.node.getChildByName("AssistBattle").active=!1,void this.unschedule(this.refreshActivityCountdown);this.m_activityTimeLab.string="\u8ddd\u79bb\u6d3b\u52a8\u7ed3\u675f\u8fd8\u6709\uff1a"+function(e){var t=e%864e5/36e5,o=e%36e5/6e4,i=e%6e4/1e3;return parseInt((e/864e5).toString())+" \u5929 "+parseInt(t.toString())+" \u5c0f\u65f6 "+parseInt(o.toString())+" \u5206\u949f "+parseInt(i.toString())+" \u79d2 "}.call(this,1e3*o)},t.prototype.hideMainChatView=function(){C.default.Instance.emit(v.default.SyncChatViewChange,N.ChatViewVisible.Retracting)},t.prototype.setChatViewVisible=function(e){1==e?this.initChatView():this.destroyChatView()},t.prototype.initChatView=function(){var e=c.default.getViewByName("MainSceneView");if(e&&e.view){e.view.onSetChatBtnNodeActive(!1);var t=e.view.getMainChatNode();if(cc.isValid(t)){t.parent=this.node;var o=t.getChildByName("chatMain").getComponent("ChatMainView");o.setShowChannelTab([_.CHAT_CHANNEL_GROUP_TYPE.CHAT_CHANNEL_ACTICITY_GROUP,_.CHAT_CHANNEL_GROUP_TYPE.CHAT_CHANNEL_PRIVATE_GROUP]),o.setChatChannel(_.CHAT_CHANNEL_GROUP_TYPE.CHAT_CHANNEL_ACTICITY_GROUP)}}this.m_chatNode.active=!0},t.prototype.destroyChatView=function(){this.m_chatNode.active=!1},t.prototype.onClickChatBtnCallBack=function(){C.default.Instance.emit(v.default.SyncChatViewChange,[N.ChatViewVisible.Popup,_.CHAT_CHANNEL_GROUP_TYPE.CHAT_CHANNEL_ACTICITY_GROUP])},t.prototype.onSetChatMsg=function(e){if(e.length<=0)return this.m_chatNode.getChildByName("msgNode").active=!1;var t=this.m_chatNode.getChildByName("msgNode"),o=t.getChildByName("label_chat"),i=t.getChildByName("label_chatDotLab");o.getComponent(cc.Label).string=e,i.active=!1,e.length>9&&(i.active=!0),t.active=!0},t.prototype.onSetChatRedpoint=function(e){this.m_chatNode.getChildByName("msgNode").parent.children[1].children[0].active=e},t.prototype.initRewardsInfo=function(){var e=this,t=h.default.Instance.getCurCastleSkyType();if(t<0)return d.G.StringManager.PopString("\u6570\u636e\u5f02\u5e38\uff01");t>=_.SKYCASTLE_TYPE.SKYCASTLE_TYPE_NIGHTMARE&&(this.node.getChildByName("MatchNode").active=!1,this.node.getChildByName("AssistBattle").active=!0),this.m_typeArrNode.forEach(function(e,o){e.active=!1,t==o&&(e.active=!0)}),t>=_.SKYCASTLE_TYPE.SKYCASTLE_TYPE_NIGHTMARE?this.m_doorSpine.setAnimation(0,"idle"+_.SKYCASTLE_TYPE.SKYCASTLE_TYPE_NIGHTMARE,!0):this.m_doorSpine.setAnimation(0,"idle"+(t+1),!0),t+1>=y.SkyCastlePrizeTableData.getDataMap().size&&(t=y.SkyCastlePrizeTableData.getDataMap().size-1,this.m_typeArrNode[t].active=!0),this.m_rewardLayoutNode.childrenCount>0&&this.m_rewardLayoutNode.removeAllChildren(),y.SkyCastlePrizeTableData.getById(t+1).prize.forEach(function(t){p.default.createNormalItems(t.dropID,t.dropNum,e.m_rewardLayoutNode,function(e){e.scale=.7})})},t.prototype.updateRed=function(){this.updateRechargeRed()},t.prototype.updateRechargeRed=function(){var e=S.SkyCastleUtls.Instance.getRecharViewRed();this.node.getChildByName("RechargeNode").getChildByName("redPoint").active=e},t.prototype.onRefreshBoxRedPoint=function(){this.m_battlePssNode.getChildByName("redpoint").active=h.default.Instance.checkBoxRedPoint()},t.prototype.onClickMatchCallBack=function(){var e=f.ActivityTableData.getById(g.ACTIVITY_ID_ENUM.P_Activity_SkyCastle).param1;return m.default.getRoleAttrValByKey(_.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE)<e?d.G.StringManager.PopWorldString(d.G.StringManager.getWorldString("sky_battle_score_limit_tip",e)):0==h.default.Instance.checkSkyCastleOpenState()?d.G.StringManager.PopWorldString(d.G.StringManager.getWorldString("sky_battle_score_limit_tip4")):void c.default.addPopView("BaseCtrl","MatchMainView","MatchMainView",{ntype:l.CombatType.COOP})},t.prototype.onClickFriendCallBack=function(){var e=f.ActivityTableData.getById(g.ACTIVITY_ID_ENUM.P_Activity_SkyCastle).param1;return m.default.getRoleAttrValByKey(_.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE)<e?d.G.StringManager.PopWorldString(d.G.StringManager.getWorldString("sky_battle_score_limit_tip",e)):0==h.default.Instance.checkSkyCastleOpenState()?d.G.StringManager.PopWorldString(d.G.StringManager.getWorldString("sky_battle_score_limit_tip4")):void c.default.addPopView("BaseCtrl","BattleRoomMainView","BattleRoomMainView",{CombatType:l.CombatType.COOP})},t.prototype.onClickAssistFightCallBack=function(){if(0==h.default.Instance.checkSkyCastleOpenState())return d.G.StringManager.PopWorldString(d.G.StringManager.getWorldString("sky_battle_score_limit_tip4"));var e=d.G.StringManager.getString("ASSISTBATTLE_TIP_SKY");c.default.addPopView("BaseCtrl","AssistBattleView","AssistBattleView",{fightType:u.FIGHT_TYPE.FIGHT_TYPE_SKY_CASTLE,title:e.split("|")[0],tips:e.split("|")[1]})},t.prototype.onClickCloseCallBack=function(){this.destroyChatView(),this.closeView(),this.hideMainChatView(),C.default.Instance.off(this,v.default.SkyCastleRefreshBoxRedpoint),C.default.Instance.off(this,v.default.SyncSkyCastleChangeType)},t.prototype.onClickOpenRechargeView=function(){c.default.addPopView("ShopMainCtrl","SkyCastleRechargeView","SkyCastleRechargeView")},t.prototype.onClickOpenBoxView=function(){c.default.addPopView("BaseCtrl","SkyCastleBoxView","SkyCastleBoxView")},t.prototype.onClickOpenShopView=function(){c.default.addPopView("BaseCtrl","SkyCastleShopView","SkyCastleShopView")},t.prototype.onClickHelpCallBack=function(){c.default.addPopView("BaseCtrl","SkyCastleHelpView","SkyCastleHelpView")},n([E(cc.Node)],t.prototype,"m_chatNode",void 0),n([E(cc.Node)],t.prototype,"m_battlePssNode",void 0),n([E(cc.Node)],t.prototype,"m_rewardLayoutNode",void 0),n([E(cc.Node)],t.prototype,"m_typeArrNode",void 0),n([E(sp.Skeleton)],t.prototype,"m_doorSpine",void 0),n([E(cc.Label)],t.prototype,"m_activityTimeLab",void 0),n([s.Register_Class,w],t)}(r.default);o.default=P,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/ActivityTableData":"ActivityTableData","../../StaticData/SkyCastlePrizeTableData":"SkyCastlePrizeTableData","../../common/CombatModule":"CombatModule","../../common/CommandValue":"CommandValue","../../common/EventConst":"EventConst","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/base/GameView":"GameView","../../modules/manager/EventManager":"EventManager","../../network/ClientNetwork":"ClientNetwork","../../network/LocalMessage":"LocalMessage","../../network/protocol/ActivityProtocols":"ActivityProtocols","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/GameTools":"GameTools","./SkyCastleModule":"SkyCastleModule","./SkyCastleUtils":"SkyCastleUtils"}],SkyCastleBoxHelpView:[function(e,t,o){"use strict";cc._RF.push(t,"553d6RF3Z5P27qQyCxXbCRm","SkyCastleBoxHelpView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=cc._decorator,l=c.ccclass,d=(c.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.path=function(){return"ui/skyCastleActivity/prefab/SkyCastleBoxHelpView"},n([s.Register_Class,l],t)}(r.default));o.default=d,cc._RF.pop()},{"../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators"}],SkyCastleBoxItem:[function(e,t,o){"use strict";cc._RF.push(t,"846dbgvlxJGSIXG9n4HVSXQ","SkyCastleBoxItem");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/manager/LoadResManager"),s=e("../../utils/GameTools"),c=e("../../modules/base/GameView"),l=e("../../Global/GameGlobal"),d=e("../../utils/GameUtils"),u=e("../../network/protocol/TypeProtocols"),h=e("../../common/PlayerModule"),p=e("./SkyCastleModule"),f=e("../../utils/ConfigUtils"),g=e("./SkyCastleCtrl"),m=e("../../network/protocol/SociatyProtocols"),_=cc._decorator.ccclass,y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.show=function(e,t){this.initCoinInfo(e,t),this.initFreeBoxInof(e,t),this.initLuxuryBoxInfo(e,t)},t.prototype.initLuxuryBoxInfo=function(e,t){var o=this,i=this.node.getChildByName("ExtraRewardsNode");i.reawds=e.extraPrize,i.coinNum=e.coinNum,i.id=e.id,r.default.loadSpriteFrame(e.extraItemIcon).then(function(t){cc.isValid(o.node)&&(i.getChildByName("ExtraRewardsIcon").scale=i.getChildByName("ExtraRewardsIcon").scale*e.extraItemScale/100,i.getChildByName("ExtraRewardsIcon").getComponent(cc.Sprite).spriteFrame=t)}).catch(function(e){cc.error(e)}),i.getChildByName("ExtraRewardsName").getComponent(cc.Label).string=e.extraItemName;var a=this.checkLuxuryRewardLockState();i.getChildByName("suo").active=!a,0==a&&s.default.registerTouchEvent(i.getChildByName("suo"),function(){l.G.StringManager.PopString(l.G.StringManager.getWorldString("season_prize_get_hint",Number(d.getConfigIntValue("skycastle_box_super_cup_limit"))))});var n=0,p=t;1==this.checkBoxReceiveState(e.id,2)?n=2:p>=e.coinNum&&1==a&&(n=1),2==n?(s.default.setNodeBright(i,!1),this.node.getChildByName("waifaguang").active=!1):this.node.getChildByName("waifaguang").active=1==n,i.receiveState=n,s.default.registerTouchEvent(i,function(e){var t=e.target;if(t.reawds)if(t.reawds.length>1)c.default.addPopView("BaseCtrl","BattlePassRewardPreview","BattlePassRewardPreview",{cb:function(){var e=Number(d.getConfigIntValue("skycastle_box_super_cup_limit"));if(e>h.default.getRoleAttrValByKey(u.ROLE_ATTR_VALUES.ROLE_ATTR_MAX_SCORE))return l.G.StringManager.PopString(l.G.StringManager.getWorldString("season_prize_get_hint",e));var o=new m.T_SociatyBattlePassData;o.index=t.id,o.type=2,g.default.c_SkyCastle_RoleReceiveBoxPrize([o])},rewards:t.reawds,rewardState:t.receiveState});else{if(2==t.receiveState)return l.G.StringManager.PopString(l.G.StringManager.getWorldString("common_prompt_receive_over"));if(1==t.receiveState){var i=Number(d.getConfigIntValue("skycastle_box_super_cup_limit"));if(i>h.default.getRoleAttrValByKey(u.ROLE_ATTR_VALUES.ROLE_ATTR_MAX_SCORE))return l.G.StringManager.PopString(l.G.StringManager.getWorldString("season_prize_get_hint",i));var a=new m.T_SociatyBattlePassData;a.index=t.id,a.type=2,g.default.c_SkyCastle_RoleReceiveBoxPrize([a])}else o.checkRewardIsHero(t.reawds[0])&&c.default.addPopView("BaseCtrl","DrawNewHeroCardView","DrawNewHeroCardView",{heroId:t.reawds[0].itemID,bShowNew:!0,bAction:!0})}})},t.prototype.initCoinInfo=function(e){var t=this;this.node.getChildByName("CoinBg").getChildByName("CoinNum").getComponent(cc.Label).string=e.coinNum.toString(),0>=e.coinNum&&r.default.loadSpriteFrame("ui/battle_pass/res/bei1").then(function(e){cc.isValid(t.node)&&(t.node.getChildByName("CoinBg").getComponent(cc.Sprite).spriteFrame=e)})},t.prototype.initFreeBoxInof=function(e,t){var o=this,i=this.node.getChildByName("RewardsNode");i.reawds=e.prize,i.coinNum=e.coinNum,i.id=e.id,r.default.loadSpriteFrame(e.itemIcon).then(function(t){cc.isValid(o.node)&&(i.getChildByName("RewardsIcon").scale=i.getChildByName("RewardsIcon").scale*e.itemScale/100,i.getChildByName("RewardsIcon").getComponent(cc.Sprite).spriteFrame=t)}).catch(function(e){cc.error(e)}),i.getChildByName("RewardsName").getComponent(cc.Label).string=e.itemName;var a=0,n=t;1==this.checkBoxReceiveState(e.id,1)?a=2:n>=e.coinNum&&(a=1),2==a?(s.default.setNodeBright(i,!1),this.node.getChildByName("waifaguangReward").active=!1):this.node.getChildByName("waifaguangReward").active=1==a,i.receiveState=a,s.default.registerTouchEvent(i,function(e){var t=e.target;if(t.reawds.length>1)c.default.addPopView("BaseCtrl","BattlePassRewardPreview","BattlePassRewardPreview",{cb:function(){var e=new m.T_SociatyBattlePassData;e.index=t.id,e.type=1,g.default.c_SkyCastle_RoleReceiveBoxPrize([e])},rewards:t.reawds,rewardState:t.receiveState});else{if(2==t.receiveState)return l.G.StringManager.PopString(l.G.StringManager.getWorldString("common_prompt_receive_over"));if(1==t.receiveState){var i=new m.T_SociatyBattlePassData;i.index=t.id,i.type=1,g.default.c_SkyCastle_RoleReceiveBoxPrize([i])}else o.checkRewardIsHero(t.reawds[0])&&c.default.addPopView("BaseCtrl","DrawNewHeroCardView","DrawNewHeroCardView",{heroId:t.reawds[0].itemID,bShowNew:!0,bAction:!0})}})},t.prototype.checkLuxuryRewardLockState=function(){var e=Number(d.getConfigIntValue("skycastle_box_super_cup_limit")),t=!1;return h.default.getRoleAttrValByKey(u.ROLE_ATTR_VALUES.ROLE_ATTR_MAX_SCORE)>=e&&(t=!0),t},t.prototype.checkBoxReceiveState=function(e,t){var o=p.default.Instance.skyCastleBoxData().normalPrize;return 2==t&&(o=p.default.Instance.skyCastleBoxData().superprize),!!o.has(e)&&o.get(e)},t.prototype.checkRewardIsHero=function(e){return!!f.default.getInstance().data["StaticData/HeroTableData"].hasOwnProperty(e.itemID)},n([_],t)}(cc.Component);o.default=y,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../common/PlayerModule":"PlayerModule","../../modules/base/GameView":"GameView","../../modules/manager/LoadResManager":"LoadResManager","../../network/protocol/SociatyProtocols":"SociatyProtocols","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/ConfigUtils":"ConfigUtils","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils","./SkyCastleCtrl":"SkyCastleCtrl","./SkyCastleModule":"SkyCastleModule"}],SkyCastleBoxView:[function(e,t,o){"use strict";cc._RF.push(t,"b35df6XjfpCHrC5vjmA6ZaD","SkyCastleBoxView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../StaticData/CastleSkyBoxTableData"),s=e("../../common/PlayerModule"),c=e("../../modules/base/GameView"),l=e("./SkyCastleModule"),d=e("../../Global/GameGlobal"),u=e("./SkyCastleCtrl"),h=e("../../common/EventConst"),p=e("../../modules/manager/EventManager"),f=e("../../utils/GameUtils"),g=e("../../network/protocol/TypeProtocols"),m=e("../../network/protocol/RoleProtocols"),_=e("../../network/ClientNetwork"),y=e("../../modules/base/BaseView"),v=e("../../modules/base/Decorators"),C=e("../../StaticData/ActivityTableData"),S=e("../../network/protocol/ActivityProtocols"),T=cc._decorator,I=T.ccclass,N=T.property,b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.itemPrefab=null,t.ScrollView=null,t.progressBarNode=null,t.curTrophyNode=null,t.curGetWayLab=null,t.popTipNode=null,t._scrollViewChildNode=[],t._curSeasonData=[],t._boxItemSpacing=300,t.m_skyCardItemId=1014,t.m_skyCardNum=0,t.rewardCount=0,t.nSeasonLeftTime=0,t}return a(t,e),t.path=function(){return"ui/skyCastleActivity/prefab/SkyCastleBox"},t.prototype.onLoad=function(){var e=this;this.m_skyCardItemId=Number(f.getConfigIntValue("skycastle_box_coin_itemId")),p.default.Instance.on(h.default.SkyCastleSyncBoxEvent,this.initSkyCastleBoxInfo,this),p.default.Instance.on(h.default.SkyCastleSyncReceiveBoxEvent,this.showRewards,this),_.ClientNetwork.getInstance().listenProtocol(m.ROLE_CLIENT_ENUM.P_Role_Get_Item_Num,function(t){t.resetPos();var o=new m.S_Role_Get_Item_Num;o.read(t)&&0===o.errorcode&&o.itemId==e.m_skyCardItemId&&(e.m_skyCardNum=o.itemNum,e.initSkyCastleBoxInfo())},this)},t.prototype.start=function(){var e=this,t=new m.C_Role_Get_Item_Num;t.itemId=this.m_skyCardItemId,_.ClientNetwork.getInstance().Send(m.ROLE_CLIENT_ENUM.P_Role_Get_Item_Num,t),r.CastleSkyBoxTableData.getDataMap().forEach(function(t){e._curSeasonData.push(t)});var o=this._curSeasonData;this.progressBarNode.width=o[o.length-1].pointX,this.ScrollView.content.width=this.progressBarNode.width+o[0].pointX-this.itemPrefab.width/2+50,this.onRefreshSociatySeasonEndTime(),this.schedule(this.onRefreshSociatySeasonEndTime,1);var i=Number(f.getConfigIntValue("skycastle_box_super_cup_limit")),a=s.default.getRoleAttrValByKey(g.ROLE_ATTR_VALUES.ROLE_ATTR_MAX_SCORE);this.node.getChildByName("sociaty_box_suo").active=!(a>=i),this.node.getChildByName("sociaty_box_suo").children[0].getComponent(cc.Label).string=d.G.StringManager.getString("SOCIATY_BOX_TEXT",i)},t.prototype.initCurGetWayInfo=function(){this.curGetWayLab.string=s.default.getRoleAttrValByKey(g.ROLE_ATTR_VALUES.ROLE_ATTR_SKYCASTLE_BOX_COIN_NUM)+"/"+f.getConfigIntValue("skycastle_box_coin_day_max")},t.prototype.initBoxProgress=function(){var e=null;this.curTrophyNode.x=5;var t,o=this._curSeasonData,i=0,a=this.m_skyCardNum;if(o.forEach(function(t,o){a>=t.coinNum&&(e=t,i=o)}),e)if(t=o[i+1]){var n=a-e.coinNum,r=t.coinNum-e.coinNum,s=(t.pointX-e.pointX)*(n/r),c=e.pointX+s;this.curTrophyNode.x=c,isNaN(this.curTrophyNode.x)&&(this.curTrophyNode.x=5),this.progressBarNode.getChildByName("bar").width=c}else this.progressBarNode.getChildByName("bar").width=this.progressBarNode.width,this.curTrophyNode.x=this.progressBarNode.width-5;else(t=o[i])?(n=a,r=t.coinNum,c=s=t.pointX*(n/r),this.curTrophyNode.x=c,isNaN(this.curTrophyNode.x)&&(this.curTrophyNode.x=5),this.progressBarNode.getChildByName("bar").width=c):(this.progressBarNode.getChildByName("bar").width=this.progressBarNode.width,this.curTrophyNode.x=this.progressBarNode.width-5);this.curTrophyNode.getChildByName("CoinLabel").getComponent(cc.Label).string=a.toString()},t.prototype.onRefreshSociatySeasonEndTime=function(){var e=this.node.getChildByName("sociatyEndTimeLab").getComponent(cc.Label),t=C.ActivityTableData.getById(S.ACTIVITY_ID_ENUM.P_Activity_SkyCastle),o=s.default.getServersTime(),i=t.param9-o;if(i<=0)return e.node.active=!1,void this.unschedule(this.onRefreshSociatySeasonEndTime);e.string="\u8ddd\u79bb\u6d3b\u52a8\u7ed3\u675f\u8fd8\u6709:"+function(e){var t=e%864e5/36e5,o=e%36e5/6e4,i=e%6e4/1e3;return parseInt((e/864e5).toString())+" \u5929 "+parseInt(t.toString())+" \u5c0f\u65f6 "+parseInt(o.toString())+" \u5206\u949f "+parseInt(i.toString())+" \u79d2 "}.call(this,1e3*i),0==e.node.active&&(e.node.active=!0)},t.prototype.initSkyCastleBoxInfo=function(){var e=this;this._scrollViewChildNode.forEach(function(e){e.destroy()}),this._scrollViewChildNode=[];var t=c.default.getViewByName("BattlePassRewardPreview");t&&t.view&&(t.view.node.active=!1,t.view.closeView());var o=this._curSeasonData,i=o.length,a=0;this.schedule(function(){var t=cc.instantiate(e.itemPrefab);t.parent=e.progressBarNode,t.getComponent("SkyCastleBoxItem").show(o[a],e.m_skyCardNum),t.x=o[a].pointX,t.y=-50,t.active=!0,e._scrollViewChildNode.push(t),e.curTrophyNode.setSiblingIndex(99),a++},0,i-1,0);var n=l.default.Instance.checkReceiveSociatyBoxPrize();this.node.getChildByName("DrawButton").getComponent(cc.Button).interactable=n.length>0,this.node.getChildByName("DrawButton").getComponent(cc.Button).enableAutoGrayEffect=!(n.length>0),this.initBoxProgress(),this.onScrollToPoint(),this.initCurGetWayInfo()},t.prototype.showRewards=function(e){var t=this,o=function(){var e=t.tRewards.slice(6*t.rewardCount,6*(t.rewardCount+1));e.length>0&&c.default.addPopView("BaseCtrl","AcquirePopupView","AcquirePopupView",{items:e,closeCb:function(){t.rewardCount++,o.call(t)}})};this.rewardCount=0,this.tRewards=e,o.call(this)},t.prototype.onTotalGetRewardCallBack=function(){var e=l.default.Instance.checkReceiveSociatyBoxPrize();if(e.length<=0)return d.G.StringManager.PopString(d.G.StringManager.getWorldString("common_prompt_not_rewards"));u.default.c_SkyCastle_RoleReceiveBoxPrize(e)},t.prototype.onScrollToPoint=function(){for(var e=!1,t=this.m_skyCardNum,o=0,i=this._curSeasonData.length;o<i;o++){var a=(v=this._curSeasonData[o]).coinNum,n=v.id;if(a){var r=this.m_skyCardNum,c=0,d=l.default.Instance.checkBoxReceiveState(n,1);0!=d&&d||r>=a&&(c=1);var u=0,h=l.default.Instance.checkBoxReceiveState(n,2);if((0==h||!h)&&r>=a){var p=Number(f.getConfigIntValue("skycastle_box_super_cup_limit"));s.default.getRoleAttrValByKey(g.ROLE_ATTR_VALUES.ROLE_ATTR_MAX_SCORE)>=p&&(u=1)}if(1==c||1==u){var m=this.ScrollView.getMaxScrollOffset(),_=v.pointX>m.x?m.x:v.pointX;this.ScrollView.setContentPosition(cc.v2(-_+this.itemPrefab.width,0)),e=!0;break}}}if(0==e){var y=null;for(o=0,i=this._curSeasonData.length;o<i;o++){var v;(v=this._curSeasonData[o]).coinNum&&t>=v.coinNum&&(y=v)}y&&(m=this.ScrollView.getMaxScrollOffset(),_=y.pointX>m.x?m.x:y.pointX,this.ScrollView.setContentPosition(cc.v2(-_+this.itemPrefab.width,0)))}},t.prototype.onClickAddCallBack=function(){console.log("onClickAddCallBack"),this.popTipNode.active=!this.popTipNode.active},t.prototype.onCloseView=function(){this.closeView()},t.prototype.onHelpCallBack=function(){c.default.addPopView("BaseCtrl","SkyCastleBoxHelpView","SkyCastleBoxHelpView")},t.prototype.onDestroy=function(){p.default.Instance.off(this,h.default.SkyCastleSyncBoxEvent),p.default.Instance.off(this,h.default.SkyCastleSyncReceiveBoxEvent),this.unschedule(this.onRefreshSociatySeasonEndTime)},n([N(cc.Node)],t.prototype,"itemPrefab",void 0),n([N(cc.ScrollView)],t.prototype,"ScrollView",void 0),n([N(cc.Node)],t.prototype,"progressBarNode",void 0),n([N(cc.Node)],t.prototype,"curTrophyNode",void 0),n([N(cc.Label)],t.prototype,"curGetWayLab",void 0),n([N(cc.Node)],t.prototype,"popTipNode",void 0),n([v.Register_Class,I],t)}(y.default);o.default=b,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/ActivityTableData":"ActivityTableData","../../StaticData/CastleSkyBoxTableData":"CastleSkyBoxTableData","../../common/EventConst":"EventConst","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/base/GameView":"GameView","../../modules/manager/EventManager":"EventManager","../../network/ClientNetwork":"ClientNetwork","../../network/protocol/ActivityProtocols":"ActivityProtocols","../../network/protocol/RoleProtocols":"RoleProtocols","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/GameUtils":"GameUtils","./SkyCastleCtrl":"SkyCastleCtrl","./SkyCastleModule":"SkyCastleModule"}],SkyCastleCtrl:[function(e,t,o){"use strict";cc._RF.push(t,"c35fcWxz3xERIvZXe1l/Y1T","SkyCastleCtrl");var i=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var a=e("../../network/ClientNetwork"),n=e("../../Global/GameGlobal"),r=e("./SkyCastleModule"),s=e("../../common/EventConst"),c=e("../../modules/manager/EventManager"),l=e("../../network/protocol/ActivityProtocols"),d=cc._decorator.ccclass,u=function(){function e(){}return e.registerSkyCastleProtocol=function(){a.ClientNetwork.getInstance().listenProtocol(l.ACTIVITY_CLIENT_ENUM.P_Activity_SyncSkyCastleData,this.syncSkyCastleData,this),a.ClientNetwork.getInstance().listenProtocol(l.ACTIVITY_CLIENT_ENUM.P_Activity_CastleSkyGetBoxsReward,this.s_SkyCastle_RoleGetBoxData,this)},e.callGetSkyCastleData=function(){var e=new l.C_Activity_GetSkyCastleData;e.activityID=l.ACTIVITY_ID_ENUM.P_Activity_SkyCastle,a.ClientNetwork.getInstance().Send(l.ACTIVITY_CLIENT_ENUM.P_Activity_GetSkyCastleData,e)},e.syncSkyCastleData=function(e){e.resetPos();var t=new l.S_Activity_SyncSkyCastleData;if(t.read(e))if(0==t.error){var o=!1;r.default.Instance.getCurCastleSkyType()==t.castleSkyType&&r.default.Instance.checkSkyCastleOpenState()==t.isOpen||(o=!0),r.default.Instance.onSyncSkyCastleData(t),1==o&&c.default.Instance.emit(s.default.SyncSkyCastleChangeType)}else n.G.StringManager.PopString("S_Activity_SyncSkyCastleData Error "+t.error)},e.c_SkyCastle_RoleReceiveBoxPrize=function(e){if(0==r.default.Instance.checkSkyCastleOpenState())return n.G.StringManager.PopWorldString(n.G.StringManager.getWorldString("sky_battle_score_limit_tip4"));var t=new l.C_Activity_CastleSkyGetBoxsReward;t.getRewardsVec=e,a.ClientNetwork.getInstance().Send(l.ACTIVITY_CLIENT_ENUM.P_Activity_CastleSkyGetBoxsReward,t)},e.s_SkyCastle_RoleGetBoxData=function(e){e.resetPos();var t=new l.S_Activity_CastleSkyGetBoxsReward;t.read(e)&&(0==t.errorcode&&t.rewards.length>0&&(c.default.Instance.emit(s.default.SkyCastleSyncBoxEvent),c.default.Instance.emit(s.default.SkyCastleSyncReceiveBoxEvent,t.rewards),c.default.Instance.emit(s.default.SkyCastleRefreshRedpoint)),0!=t.errorcode&&n.G.StringManager.PopString("S_SkyCastle_RoleReceiveBoxPrize ERROR "+t.errorcode))},i([d],e)}();o.default=u,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../common/EventConst":"EventConst","../../modules/manager/EventManager":"EventManager","../../network/ClientNetwork":"ClientNetwork","../../network/protocol/ActivityProtocols":"ActivityProtocols","./SkyCastleModule":"SkyCastleModule"}],SkyCastleHelpView:[function(e,t,o){"use strict";cc._RF.push(t,"cadeaUVtA5Eh4alVlX15yCQ","SkyCastleHelpView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=cc._decorator.ccclass,l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.path=function(){return"ui/skyCastleActivity/prefab/SkyCastleHelp"},n([s.Register_Class,c],t)}(r.default);o.default=l,cc._RF.pop()},{"../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators"}],SkyCastleModule:[function(e,t,o){"use strict";cc._RF.push(t,"f4d3b5bmxFOprKfidgNeabI","SkyCastleModule");var i=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var a=e("../../common/PlayerModule"),n=e("../../StaticData/CastleSkyBoxTableData"),r=e("../../network/protocol/TypeProtocols"),s=e("../../network/protocol/ActivityProtocols"),c=e("../../utils/GameUtils"),l=cc._decorator.ccclass,d=function(){function e(){this.m_tSkyCastleData=null}var t;return t=e,Object.defineProperty(e,"Instance",{get:function(){return null==t._instance&&(t._instance=new t),t._instance},enumerable:!1,configurable:!0}),e.prototype.onSyncSkyCastleData=function(e){this.m_tSkyCastleData=e},e.prototype.checkSkyCastleOpenState=function(){return!1},e.prototype.skyCastleBoxData=function(){return this.m_tSkyCastleData},e.prototype.getCurCastleSkyType=function(){return this.m_tSkyCastleData?this.m_tSkyCastleData.castleSkyType:-1},e.prototype.checkBoxRedPoint=function(){if(0==t.Instance.checkSkyCastleOpenState())return!1;var e=this.checkReceiveSociatyBoxPrize();return!!e&&e.length>0},e.prototype.checkReceiveSociatyBoxPrize=function(){var e=this,t=[],o=Number(c.getConfigIntValue("skycastle_box_coin_itemId")),i=a.default.getItemCountByBag(o),l=[];return n.CastleSkyBoxTableData.getDataMap().forEach(function(e){l.push(e)}),l.forEach(function(o){var n=0,l=e.checkBoxReceiveState(o.id,1);0!=l&&l||i>=o.coinNum&&(n=1);var d,u=0,h=e.checkBoxReceiveState(o.id,2);if((0==h||!h)&&i>=o.coinNum){var p=Number(c.getConfigIntValue("skycastle_box_super_cup_limit"));a.default.getRoleAttrValByKey(r.ROLE_ATTR_VALUES.ROLE_ATTR_MAX_SCORE)>=p&&(u=1)}1==n&&((d=new s.T_Activity_CastleSkyGetBoxsData).index=o.id,d.type=1,t.push(d)),1==u&&((d=new s.T_Activity_CastleSkyGetBoxsData).index=o.id,d.type=2,t.push(d))}),t},e.prototype.checkBoxReceiveState=function(e,t){if(!this.m_tSkyCastleData)return!1;var o=this.m_tSkyCastleData.normalPrize;return 2==t&&(o=this.m_tSkyCastleData.superprize),!!o.has(e)&&o.get(e)},e._instance=null,t=i([l],e)}();o.default=d,cc._RF.pop()},{"../../StaticData/CastleSkyBoxTableData":"CastleSkyBoxTableData","../../common/PlayerModule":"PlayerModule","../../network/protocol/ActivityProtocols":"ActivityProtocols","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/GameUtils":"GameUtils"}],SkyCastlePrizeTableData:[function(e,t,o){"use strict";cc._RF.push(t,"1d90bm0n+ZF35ZnIREngqsB","SkyCastlePrizeTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.SkyCastlePrizeTableData=void 0;var i=e("../TableReader"),a=e("./BaseTableData"),n=function(){function e(){this.id=0,this.prize=new Array}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber();for(var o=e.getString(),n=new i.TableReader(o);n.getPos()<n.getLen();){var r=new a.DropItem;r.readOriginal(n),this.prize.push(r)}},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"SkyCastlePrizeTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.SkyCastlePrizeTableData=n,cc._RF.pop()},{"../TableReader":"TableReader","./BaseTableData":"BaseTableData"}],SkyCastleRechargeView:[function(e,t,o){"use strict";cc._RF.push(t,"d58fbLf3ylCvJS5UBWDUglt","SkyCastleRechargeView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../common/NetworkProtocolCommon"),s=e("../../common/PlayerModule"),c=e("../../Global/GameGlobal"),l=e("../../modules/base/BaseView"),d=e("../../modules/base/Decorators"),u=e("../../modules/base/GameView"),h=e("../../network/ClientNetwork"),p=e("../../network/LocalMessage"),f=e("../../network/protocol/RechargeProtocols"),g=e("../../network/protocol/RoleProtocols"),m=e("../../network/protocol/TypeProtocols"),_=e("../../StaticData/CostGetTableData"),y=e("../../StaticData/LuckyGiftSelectTableData"),v=e("../../StaticData/RechargeTableData"),C=e("../../utils/ConfigUtils"),S=e("../../utils/GameTools"),T=e("../../utils/GameUtils"),I=e("../../utils/TimeOffSetManager"),N=e("./SkyCastleModule"),b=e("./SkyCastleUtils"),w=cc._decorator,E=w.ccclass,P=w.property,R=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.m_btn_buy=null,t.m_btn_buy2=null,t.m_btn_buy3=null,t.m_box1=null,t.m_box2=null,t.m_box3=null,t.rechargeId_buy2=0,t.rechargeId_buy3=0,t.m_selectHeroId=0,t}return a(t,e),t.path=function(){return"ui/skyCastleActivity/prefab/SkyCastleRecharge"},t.prototype.onLoad=function(){},t.prototype.start=function(){var e=this;h.ClientNetwork.getInstance().listenProtocol(g.ROLE_CLIENT_ENUM.P_Role_SyncCostGet,function(){e.initFreeView(),h.ClientNetwork.getInstance().pushLocalMessage(p.LOCAL_MESSAGE.LocalMsg_RefreshSkyCastleRed)},this),h.ClientNetwork.getInstance().listenProtocol(f.RECHARGE_CLIENT_ENUM.P_Recharge_Role_Recharge,function(){e.callRandRecharge(),e.initSelectView()},this),h.ClientNetwork.getInstance().listenProtocol(g.ROLE_CLIENT_ENUM.P_Role_SkyCastle_Recharge_Select,function(){e.initSelectView()},this),this.initFreeView(),this.callRandRecharge(),this.initSelectView()},t.prototype.initSelectView=function(){var e=this,t=Number(T.getConfigIntValue("skyCastle_select_recharge_id")),o=v.RechargeTableData.getById(t);if(null!=o){this.node.getChildByName("newBoxRechargeNode").getChildByName("box3").getChildByName("boxReward").removeAllChildren(),o.prize.forEach(function(t){var o=C.default.getInstance().getDorpItemsByID(t.dropID);if(o)for(var i=o.dropRandom.split("|"),a=function(t){var o=i[t].split("#"),a=o[0],n=o[1]!=o[2]?"x"+o[1]+"~"+o[2]:"x"+o[1];S.default.createNormalItemsWithNames(a,-1,e.node.getChildByName("newBoxRechargeNode").getChildByName("box3").getChildByName("boxReward"),function(e){e.getChildByName("txt_name").getComponent(cc.Label).string=n})},n=0;n<i.length;n++)a(n)});var i=S.default.getRechargeMoneyByPlatform(o)/100;this.m_btn_buy3.getChildByName("label").getComponent(cc.Label).string="\uffe5"+i;var a=s.default.getRoleAttrValByKey(m.ROLE_ATTR_VALUES.ROLE_ATTR_SKYCASTLE_RECHARGE_TIME),n=s.default.getServersTime2();I.TimeOffSetManager.getSpanDays(n,a)<1?(this.m_btn_buy3.getComponent(cc.Button).interactable=!1,this.m_btn_buy3.getChildByName("label").getComponent(cc.Label).string="\u5df2\u552e\u5b8c"):(this.m_btn_buy3.getComponent(cc.Button).interactable=!0,this.m_btn_buy3.getChildByName("label").getComponent(cc.Label).string=c.G.StringManager.getString("SUPER_SALE_MONEY",i))}var r=s.default.getRoleAttrValByKey(m.ROLE_ATTR_VALUES.ROLE_ATTR_SKYCASTLE_RECHARGE_SELECTID);if(r<=0)this.node.getChildByName("newBoxRechargeNode").getChildByName("box3").getChildByName("select").getChildByName("player").active=!0,this.node.getChildByName("newBoxRechargeNode").getChildByName("box3").getChildByName("select").getChildByName("changeIcon").active=!1,this.node.getChildByName("newBoxRechargeNode").getChildByName("box3").getChildByName("select").getChildByName("txt").getComponent(cc.Label).string="";else{this.node.getChildByName("newBoxRechargeNode").getChildByName("box3").getChildByName("select").getChildByName("player").active=!1,this.node.getChildByName("newBoxRechargeNode").getChildByName("box3").getChildByName("select").getChildByName("changeIcon").active=!0;var l=C.default.getInstance().getItemByID(r);T.setTexture(this.node.getChildByName("newBoxRechargeNode").getChildByName("box3").getChildByName("select").getChildByName("headframe").getComponent(cc.Sprite),l.icon);var d=T.getConfigIntValue("skyCastle_select_recharge_rewardNum");this.node.getChildByName("newBoxRechargeNode").getChildByName("box3").getChildByName("select").getChildByName("txt").getComponent(cc.Label).string="x"+d}S.default.registerTouchEvent(this.node.getChildByName("newBoxRechargeNode").getChildByName("box3").getChildByName("select"),function(){var t=T.getConfigIntValue("activity_daily_chaozhi_choose"),o=y.LuckyGiftSelectTableData.getById(Number(t)).prize;u.default.addPopView("BaseCtrl","LuckyGiftSelectRewardView","LuckyGiftSelectRewardView",{tRewards:o,index:1,isEveryDayReacharge:!0,parent:e})})},t.prototype.showSecectRwd=function(e){if(0!=e){this.m_selectHeroId=e;var t=new g.C_Role_SkyCastle_Recharge_Select;t.selectId=e,h.ClientNetwork.getInstance().Send(g.ROLE_CLIENT_ENUM.P_Role_SkyCastle_Recharge_Select,t)}},t.prototype.callRandRecharge=function(){var e=new g.C_Role_GetRandRecharge;e.groupID=6,h.ClientNetwork.getInstance().Send(g.ROLE_CLIENT_ENUM.P_Role_GetRandRecharge,e,!1);var t=new g.C_Role_GetRandRecharge;t.groupID=7,h.ClientNetwork.getInstance().Send(g.ROLE_CLIENT_ENUM.P_Role_GetRandRecharge,t,!1)},t.prototype.initFreeView=function(){var e=this,t=s.default.getCostGetDataByID(b.SkyCastleUtls.FREE_COST_ID);this.m_btn_buy.getComponent(cc.Button).interactable=!(t>0),this.m_box1.getChildByName("boxReward").removeAllChildren(),_.CostGetTableData.getById(b.SkyCastleUtls.FREE_COST_ID).get.forEach(function(t){var o=t.itemID,i=t.itemNum;S.default.createNormalItemsWithNames(o,-1,e.m_box1.getChildByName("boxReward"),function(e){e.getChildByName("txt_name").getComponent(cc.Label).string="x"+i})})},t.prototype.initSkyCastleRecharge=function(e){console.log("SkyCastleRechargeView, \u968f\u673a\u5145\u503c\u5237\u65b0initSkyCastleRecharge, data=",e),!e||e.units.size<=0||6==e.groupID&&this.initBuyView(e,this.m_box2.getChildByName("boxReward"))},t.prototype.initBuyView=function(e,t){var o=this;t.removeAllChildren(),e.units.forEach(function(i,a){var n=a,r=v.RechargeTableData.getById(n);if(null!=r){r.prize.forEach(function(e){var o=C.default.getInstance().getDorpItemsByID(e.dropID);if(o)for(var i=o.dropRandom.split("|"),a=function(e){var o=i[e].split("#"),a=o[0],n=o[1]!=o[2]?"x"+o[1]+"~"+o[2]:"x"+o[1];S.default.createNormalItemsWithNames(a,-1,t,function(e){e.getChildByName("txt_name").getComponent(cc.Label).string=n})},n=0;n<i.length;n++)a(n)});var l=S.default.getRechargeMoneyByPlatform(r)/100;if(6==e.groupID){o.rechargeId_buy2=n;var d=s.default.getRoleRechargeData().get(o.rechargeId_buy2);null!=d&&d.dayNum>0?(o.m_btn_buy2.getComponent(cc.Button).interactable=!1,o.m_btn_buy2.getChildByName("label").getComponent(cc.Label).string="\u5df2\u552e\u5b8c"):(o.m_btn_buy2.getComponent(cc.Button).interactable=!0,o.m_btn_buy2.getChildByName("label").getComponent(cc.Label).string=c.G.StringManager.getString("SUPER_SALE_MONEY",l))}else if(7==e.groupID){o.rechargeId_buy3=n;var u=s.default.getRoleRechargeData().get(o.rechargeId_buy3);null!=u&&u.dayNum>0?(o.m_btn_buy3.getComponent(cc.Button).interactable=!1,o.m_btn_buy3.getChildByName("label").getComponent(cc.Label).string="\u5df2\u552e\u5b8c"):(o.m_btn_buy3.getComponent(cc.Button).interactable=!0,o.m_btn_buy3.getChildByName("label").getComponent(cc.Label).string=c.G.StringManager.getString("SUPER_SALE_MONEY",l))}}})},t.prototype.onClickBuy=function(){if(0==N.default.Instance.checkSkyCastleOpenState())return c.G.StringManager.PopWorldString(c.G.StringManager.getWorldString("sky_battle_score_limit_tip4"));r.default.callRoleCostGet(b.SkyCastleUtls.FREE_COST_ID)},t.prototype.onClickBuy2=function(){if(0==N.default.Instance.checkSkyCastleOpenState())return c.G.StringManager.PopWorldString(c.G.StringManager.getWorldString("sky_battle_score_limit_tip4"));if(!(this.rechargeId_buy2<=0)){var e={rechargeID:this.rechargeId_buy2,rechargeNum:1};this.sendEvent("SendProtocolRecharge",e)}},t.prototype.onClickBuy3=function(){var e=this;if(0==N.default.Instance.checkSkyCastleOpenState())return c.G.StringManager.PopWorldString(c.G.StringManager.getWorldString("sky_battle_score_limit_tip4"));var t=s.default.getRoleAttrValByKey(m.ROLE_ATTR_VALUES.ROLE_ATTR_SKYCASTLE_RECHARGE_TIME),o=s.default.getServersTime2();if(!(I.TimeOffSetManager.getSpanDays(o,t)<1))if(s.default.getRoleAttrValByKey(m.ROLE_ATTR_VALUES.ROLE_ATTR_SKYCASTLE_RECHARGE_SELECTID)<=0)c.G.StringManager.PopString(c.G.StringManager.getString("BATTLEPASS_SELECT_GOLD_TIP"));else{var i=function(){var t={rechargeID:Number(T.getConfigIntValue("skyCastle_select_recharge_id")),rechargeNum:1};e.sendEvent("SendProtocolRecharge",t)};u.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:c.G.StringManager.getString("BUY_EVERYDAYRECHARGE_LASTDAY"),confirmCb:function(){i.call(e)}})}},n([P(cc.Node)],t.prototype,"m_btn_buy",void 0),n([P(cc.Node)],t.prototype,"m_btn_buy2",void 0),n([P(cc.Node)],t.prototype,"m_btn_buy3",void 0),n([P(cc.Node)],t.prototype,"m_box1",void 0),n([P(cc.Node)],t.prototype,"m_box2",void 0),n([P(cc.Node)],t.prototype,"m_box3",void 0),n([d.Register_Class,E],t)}(l.default);o.default=R,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/CostGetTableData":"CostGetTableData","../../StaticData/LuckyGiftSelectTableData":"LuckyGiftSelectTableData","../../StaticData/RechargeTableData":"RechargeTableData","../../common/NetworkProtocolCommon":"NetworkProtocolCommon","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/base/GameView":"GameView","../../network/ClientNetwork":"ClientNetwork","../../network/LocalMessage":"LocalMessage","../../network/protocol/RechargeProtocols":"RechargeProtocols","../../network/protocol/RoleProtocols":"RoleProtocols","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/ConfigUtils":"ConfigUtils","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils","../../utils/TimeOffSetManager":"TimeOffSetManager","./SkyCastleModule":"SkyCastleModule","./SkyCastleUtils":"SkyCastleUtils"}],SkyCastleShopItem:[function(e,t,o){"use strict";cc._RF.push(t,"2c50fHJPGtMHrazkewEIIbH","SkyCastleShopItem");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../StaticData/RandShopItemTableData"),s=e("../../utils/ConfigUtils"),c=e("../../common/PlayerModule"),l=e("../../modules/manager/LoadResManager"),d=e("../../utils/GameTools"),u=e("../../Global/GameGlobal"),h=e("../../modules/base/GameView"),p=e("./SkyCastleModule"),f=["ui/common_res/quality1","ui/common_res/quality2","ui/common_res/quality3","ui/common_res/quality4"],g=cc._decorator,m=g.ccclass,_=(g.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.tShopObj={shopID:0,shopPosition:0,shopItemID:0,costNum:0,gives:null,costs:null,bSellOut:!1},t.cb=null,t}return a(t,e),t.prototype.init=function(e,t,o){var i=this;if(this.tShopObj.shopID=5,this.tShopObj.shopPosition=t,this.tShopObj.shopItemID=e.shopItemID,this.tShopObj.bSellOut=!1,this.tShopObj.costNum=0,this.cb=o,0==e.shopItemID);else{var a=r.RandShopItemTableData.getById(e.shopItemID).give;this.tShopObj.gives=a;var n=s.default.getInstance().getItemByID(a[0].dropID);if(2===n.type){var u=s.default.getInstance().getHeroConfig(a[0].dropID),h=c.default.getHeroCarData()[a[0].dropID];if(h&&0==h.bHeroLock)this.node.getChildByName("shop_new").active=!0;else{l.default.loadSpriteFrame("ui/bag/img/bar"+u.hero_color).then(function(e){cc.isValid(i)?i.node.getChildByName("cardNumber").getChildByName("pro_bar").getChildByName("bar").getComponent(cc.Sprite).spriteFrame=e:console.log(" load sprite_splash error ")}).catch(function(e){cc.error(e)});var p=c.default.getHeroCarData()[a[0].dropID].heroLevel,g=s.default.getInstance().getNpcTemplateConfig(u.npc_id,p).up_res.split("|")[0].split("#"),m=c.default.getItemCountByBag(Number(g[0])),_=Number(g[1]);this.node.getChildByName("cardNumber").getChildByName("pro_bar").getComponent(cc.ProgressBar).progress=m/_,this.node.getChildByName("cardNumber").getChildByName("number").getComponent(cc.Label).string=m+"/"+_}l.default.loadSpriteFrame("ui/cardpic_l/"+u.image).then(function(e){cc.isValid(i)?i.node.getChildByName("heroImg").getComponent(cc.Sprite).spriteFrame=e:console.log(" load sprite_splash error ")}).catch(function(e){cc.error(e)})}else l.default.loadSpriteFrame(n.big_icon).then(function(e){cc.isValid(i)?i.node.getChildByName("heroImg").getComponent(cc.Sprite).spriteFrame=e:console.log(" load sprite_splash error ")}).catch(function(e){cc.error(e)});3!=n.type?this.node.getChildByName("name").getComponent(cc.Label).string=s.default.getInstance().getItemByID(a[0].dropID).name+"x"+a[0].dropNum:this.node.getChildByName("name").getComponent(cc.Label).string=s.default.getInstance().getItemByID(a[0].dropID).name,l.default.loadSpriteFrame(f[n.quality-1]).then(function(e){cc.isValid(i)?i.node.getChildByName("qualityBg").getComponent(cc.Sprite).spriteFrame=e:console.log(" load sprite_splash error ")}).catch(function(e){cc.error(e)});var y=r.RandShopItemTableData.getById(e.shopItemID);if(y.cost[0]){this.tShopObj.costs=y.cost,this.node.getChildByName("priceNode").active=!0;var v=s.default.getInstance().getItemByID(y.cost[0].dropID).icon;l.default.loadSpriteFrame(v).then(function(e){cc.isValid(i)?i.node.getChildByName("priceNode").getChildByName("costIcon").getComponent(cc.Sprite).spriteFrame=e:console.log(" load sprite_splash error ")}).catch(function(e){cc.error(e)}),this.node.getChildByName("priceNode").getChildByName("cost").getComponent(cc.Label).string=y.cost[0].dropNum.toString(),this.tShopObj.costNum=y.cost[0].dropNum}else this.node.getChildByName("free").active=!0,e.buyNum<=0&&(this.node.getChildByName("redpoint").active=!0);e.buyNum>=y.buyNum&&(this.node.getChildByName("over").active=!0,this.node.getChildByName("free").active=!1,this.node.getChildByName("priceNode").active=!1,this.node.getChildByName("cardNumber").active=!1,d.default.setNodeBright(this.node,!1),this.tShopObj.bSellOut=!0)}},t.prototype.onClickShopItemCallBack=function(){var e=this;return 0==p.default.Instance.checkSkyCastleOpenState()?u.G.StringManager.PopWorldString(u.G.StringManager.getWorldString("sky_battle_score_limit_tip4")):this.tShopObj.shopItemID<=0?u.G.StringManager.PopString(u.G.StringManager.getString("RECHARGE_ID_NOTEXIST")):1==this.tShopObj.bSellOut?u.G.StringManager.PopString(u.G.StringManager.getString("SOCIATY_SHOP_SOLD_OUT_TEXT")):c.default.getItemCountByBag(1015)<this.tShopObj.costNum?u.G.StringManager.PopString(u.G.StringManager.getString("SkyCastle_SHOP_ERROR_TEXT")):void h.default.addPopView("BaseCtrl","ShopConfirmBuy","ShopConfirmBuy",{itemData:{shopID:5,tGive:this.tShopObj.gives,tCost:this.tShopObj.costs},cb:function(){e.cb(e.tShopObj)}})},n([m],t)}(cc.Component));o.default=_,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/RandShopItemTableData":"RandShopItemTableData","../../common/PlayerModule":"PlayerModule","../../modules/base/GameView":"GameView","../../modules/manager/LoadResManager":"LoadResManager","../../utils/ConfigUtils":"ConfigUtils","../../utils/GameTools":"GameTools","./SkyCastleModule":"SkyCastleModule"}],SkyCastleShopView:[function(e,t,o){"use strict";cc._RF.push(t,"6e5d5ZyZ65GqLV6JwOcc4NL","SkyCastleShopView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../network/protocol/RoleProtocols"),s=e("../../network/ClientNetwork"),c=e("../../common/EventConst"),l=e("../../modules/manager/EventManager"),d=e("../../modules/base/GameView"),u=e("../../Global/GameGlobal"),h=e("../../common/PlayerModule"),p=e("../../modules/base/BaseView"),f=e("../../modules/base/Decorators"),g=e("../../StaticData/RandShopItemTableData"),m=e("../../utils/GameTools"),_=e("./SkyCastleModule"),y=cc._decorator,v=y.ccclass,C=y.property,S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.shopItemPrefab=null,t.contributionLab=null,t.shopItemLayout=null,t.carCost=null,t.carNode=null,t.tShopObj={shopID:0,shopPosition:0,shopItemID:0,costNum:0,gives:null,costs:null,bSellOut:!1},t}return a(t,e),t.path=function(){return"ui/skyCastleActivity/prefab/SkyCastleShop"},t.prototype.start=function(){var e=this,t=new r.C_Role_GetRandShop;t.shopID=5,s.ClientNetwork.getInstance().Send(r.ROLE_CLIENT_ENUM.P_Role_GetRandShop,t),l.default.Instance.on(c.default.skyCastleRefreshContributionEvent,this.onRefreshPlayerContribution,this),l.default.Instance.emit(c.default.skyCastleRefreshContributionEvent),this.onRefreshPlayerContribution(),s.ClientNetwork.getInstance().listenProtocol(r.ROLE_CLIENT_ENUM.P_Role_SynRandShopData,function(t){t.resetPos();var o=new r.S_Role_SynRandShopData;o.read(t)&&5===o.shopID&&e.initShopInfo(o.shopData)},this),s.ClientNetwork.getInstance().listenProtocol(r.ROLE_CLIENT_ENUM.P_Role_RandShopBuy,function(t){t.resetPos();var o=new r.S_Role_RandShopBuy;if(o.read(t))if(0===o.errorcode&&o.prize.length>0){d.default.addPopView("BaseCtrl","AcquirePopupView","AcquirePopupView",{items:o.prize});var i=d.default.getViewByName("ShopConfirmBuy");i&&i.view&&(i.view.node.active=!1,i.view.closeView()),e.scheduleOnce(function(){e.onRefreshPlayerContribution()},.6)}else u.G.StringManager.PopString("SkyCastleShopView S_Role_RandShopBuy ERROR  "+o.errorcode)},this)},t.prototype.initShopInfo=function(e){var t=this;this.shopItemLayout.node.destroyAllChildren(),this.scheduleOnce(function(){e.positions.forEach(function(e,o){if(30!=o){var i=cc.instantiate(t.shopItemPrefab);i.parent=t.shopItemLayout.node,i.getComponent("SkyCastleShopItem").init(e,o,t.callRoleRandShopBuy),i.scale=.88}else t.carShow(e,o)})})},t.prototype.onRefreshPlayerContribution=function(){this.contributionLab.string=h.default.getItemCountByBag(1015)},t.prototype.onClickExplainCallBack=function(){d.default.addPopView("BaseCtrl","SociatyShopTipView","SociatyShopTipView")},t.prototype.carShow=function(e,t){this.carData=e;var o=g.RandShopItemTableData.getById(e.shopItemID);this.carCost.getComponent(cc.Label).string=o.cost[0].dropNum.toString(),this.tShopObj.shopID=5,this.tShopObj.shopPosition=t,this.tShopObj.shopItemID=e.shopItemID,e.buyNum>=o.buyNum&&(this.tShopObj.bSellOut=!0,m.default.setNodeBright(this.node.getChildByName("SkyCastleShopItemNode").getChildByName("bg"),!1),this.carNode.node.color=cc.color(128,128,128)),this.tShopObj.gives=o.give,this.tShopObj.costs=o.cost},t.prototype.onClickCarBuyCallBack=function(){var e=this;if(0==_.default.Instance.checkSkyCastleOpenState())return u.G.StringManager.PopWorldString(u.G.StringManager.getWorldString("sky_battle_score_limit_tip4"));var t=g.RandShopItemTableData.getById(this.carData.shopItemID);return this.tShopObj.shopItemID<=0?u.G.StringManager.PopString(u.G.StringManager.getString("RECHARGE_ID_NOTEXIST")):1==this.tShopObj.bSellOut?u.G.StringManager.PopString(u.G.StringManager.getString("SOCIATY_SHOP_SOLD_OUT_TEXT")):h.default.getItemCountByBag(1015)<t.cost[0].dropNum?u.G.StringManager.PopString(u.G.StringManager.getString("SkyCastle_SHOP_ERROR_TEXT")):void d.default.addPopView("BaseCtrl","ShopConfirmBuy","ShopConfirmBuy",{itemData:{shopID:5,tGive:t.give,tCost:t.cost},cb:function(){e.callRoleRandShopBuy(e.tShopObj)}})},t.prototype.callRoleRandShopBuy=function(e){var t=new r.C_Role_RandShopBuy;t.shopID=e.shopID,t.shopPosition=e.shopPosition,t.shopItemID=e.shopItemID,s.ClientNetwork.getInstance().Send(r.ROLE_CLIENT_ENUM.P_Role_RandShopBuy,t)},t.prototype.onDestroy=function(){l.default.Instance.off(this,c.default.skyCastleRefreshContributionEvent),s.ClientNetwork.getInstance().removeMessageTarget(this)},t.prototype.onCloseView=function(){this.closeView()},n([C(cc.Prefab)],t.prototype,"shopItemPrefab",void 0),n([C(cc.Label)],t.prototype,"contributionLab",void 0),n([C(cc.Layout)],t.prototype,"shopItemLayout",void 0),n([C(cc.Label)],t.prototype,"carCost",void 0),n([C(sp.Skeleton)],t.prototype,"carNode",void 0),n([f.Register_Class,v],t)}(p.default);o.default=S,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/RandShopItemTableData":"RandShopItemTableData","../../common/EventConst":"EventConst","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/base/GameView":"GameView","../../modules/manager/EventManager":"EventManager","../../network/ClientNetwork":"ClientNetwork","../../network/protocol/RoleProtocols":"RoleProtocols","../../utils/GameTools":"GameTools","./SkyCastleModule":"SkyCastleModule"}],SkyCastleUtils:[function(e,t,o){"use strict";cc._RF.push(t,"378dcUA+8BFk7l4wRLLIU4t","SkyCastleUtils"),Object.defineProperty(o,"__esModule",{value:!0}),o.SkyCastleUtls=void 0;var i=e("../../common/PlayerModule"),a=function(){function e(){}return Object.defineProperty(e,"Instance",{get:function(){return null==this.g_instance&&(this.g_instance=new e),this.g_instance},enumerable:!1,configurable:!0}),e.prototype.getRecharViewRed=function(){return!(i.default.getCostGetDataByID(e.FREE_COST_ID)>0)},e.FREE_COST_ID=101,e}();o.SkyCastleUtls=a,cc._RF.pop()},{"../../common/PlayerModule":"PlayerModule"}],SociatyApplyItem:[function(e,t,o){"use strict";cc._RF.push(t,"86c90Uzl5tDtqALrHgiuEGo","SociatyApplyItem");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("./SociatyCtrl"),s=e("../../utils/GameUtils"),c=e("../../modules/manager/LoadResManager"),l=e("../../network/protocol/SociatyProtocols"),d=cc._decorator,u=d.ccclass,h=d.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.playerHeadNode=null,t.playerNameLab=null,t.playerCupLab=null,t}return a(t,e),t.prototype.show=function(e){var t=this;s.setRemoteHeadIcon(e.headUrl,e.headID,this.playerHeadNode.getComponent(cc.Sprite));var o=e.headFrameID;(o<=0||o>=2e3)&&(o=200),c.default.loadSpriteFrame("ui/headFrame/frame_"+o).then(function(e){t.playerHeadNode&&(t.playerHeadNode.children[0].getComponent(cc.Sprite).spriteFrame=e)}),this.playerNameLab.string=e.nickName,this.playerCupLab.string=e.score.toString(),this.tApplyPlayerData=e},t.prototype.onClickAgreeCallBack=function(){r.default.c_Sociaty_RoleDispossApplyList(this.tApplyPlayerData.roleID,l.ProType_Sociaty_RoleDispossApplyList.ProType_Sociaty_RoleDispossApplyList_AddPlayer)},t.prototype.onClickRefuseCallBack=function(){r.default.c_Sociaty_RoleDispossApplyList(this.tApplyPlayerData.roleID,l.ProType_Sociaty_RoleDispossApplyList.ProType_Sociaty_RoleDispossApplyList_DelPlayer)},n([h(cc.Node)],t.prototype,"playerHeadNode",void 0),n([h(cc.Label)],t.prototype,"playerNameLab",void 0),n([h(cc.Label)],t.prototype,"playerCupLab",void 0),n([u],t)}(cc.Component);o.default=p,cc._RF.pop()},{"../../modules/manager/LoadResManager":"LoadResManager","../../network/protocol/SociatyProtocols":"SociatyProtocols","../../utils/GameUtils":"GameUtils","./SociatyCtrl":"SociatyCtrl"}],SociatyApplyView:[function(e,t,o){"use strict";cc._RF.push(t,"a474b0daeVM4KHds++D48OT","SociatyApplyView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=e("../../network/protocol/SociatyProtocols"),l=e("./SociatyCtrl"),d=e("../../common/EventConst"),u=e("../../modules/manager/EventManager"),h=e("../../network/protocol/long"),p=e("./SociatyModel"),f=cc._decorator,g=f.ccclass,m=f.property,_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.scrollNode=null,t.notTipLab=null,t.applyItemPrefab=null,t.tApplyListData=[],t}return a(t,e),t.path=function(){return"ui/sociaty/prefab/SociatyApply"},t.prototype.onLoad=function(){l.default.c_Sociaty_RoleGetSociatyApplyData(),u.default.Instance.on(d.default.SyncSociatyApplyData,this.initApplyData,this)},t.prototype.initApplyData=function(e){var t=this;e.forEach(function(e){t.tApplyListData.push(e)});var o=this.tApplyListData.length;if(o>0){var i=0;this.schedule(function(){var e=cc.instantiate(t.applyItemPrefab);e.parent=t.scrollNode.content,e.getComponent("SociatyApplyItem").show(t.tApplyListData[i],i),i++},0,o-1,0)}this.tApplyListData.length<=0?this.notTipLab.node.active=!0:this.notTipLab.node.active=!1},t.prototype.onClickClearListCakllBack=function(){if(!(this.tApplyListData.length<=0)){var e=h.fromNumber(0);l.default.c_Sociaty_RoleDispossApplyList(e,c.ProType_Sociaty_RoleDispossApplyList.ProType_Sociaty_RoleDispossApplyList_ClearList)}},t.prototype.onRemoveSingleListItem=function(e){if(e.dispossType==c.ProType_Sociaty_RoleDispossApplyList.ProType_Sociaty_RoleDispossApplyList_ClearList)return this.tApplyListData=[],this.scrollNode.content.removeAllChildren(),p.default.instance().clearSociatyApplyData(),void u.default.Instance.emit(d.default.SociatyRefreshRedpoint);for(var t=0;t<this.tApplyListData.length;t++)if(1==(i=this.tApplyListData[t]).roleID.equals(e.applyRoleID)){this.tApplyListData.splice(t,1);break}for(var o=0;o<this.scrollNode.content.children.length;o++){var i;if(1==(i=this.scrollNode.content.children[o]).getComponent("SociatyApplyItem").tApplyPlayerData.roleID.equals(e.applyRoleID)){i.destroy(),p.default.instance().deleteSociatyApplyData(e.applyRoleID),u.default.Instance.emit(d.default.SociatyRefreshRedpoint);break}}},t.prototype.onDestroy=function(){u.default.Instance.off(this,d.default.SyncSociatyApplyData),this.unscheduleAllCallbacks()},n([m(cc.ScrollView)],t.prototype,"scrollNode",void 0),n([m(cc.Label)],t.prototype,"notTipLab",void 0),n([m(cc.Prefab)],t.prototype,"applyItemPrefab",void 0),n([s.Register_Class,g],t)}(r.default);o.default=_,cc._RF.pop()},{"../../common/EventConst":"EventConst","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/manager/EventManager":"EventManager","../../network/protocol/SociatyProtocols":"SociatyProtocols","../../network/protocol/long":"long","./SociatyCtrl":"SociatyCtrl","./SociatyModel":"SociatyModel"}],SociatyAuctionAttentionView:[function(e,t,o){"use strict";cc._RF.push(t,"1ddcf8hZ8pOWb3RUUjah27i","SociatyAuctionAttentionView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=e("./SociatyModel"),l=e("../../common/EventConst"),d=e("../../modules/manager/EventManager"),u=e("../../common/PlayerModule"),h=cc._decorator,p=h.ccclass,f=h.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.scrollViewNode=null,t.itemPrefab=null,t.notTipLabNode=null,t.contributeLab=null,t}return a(t,e),t.path=function(){return"ui/sociaty/prefab/SociatyAuctionAttention"},t.prototype.onLoad=function(){d.default.Instance.on(l.default.SyncSociatyChangeAuctionDataEvent,this.onRefreshChangeAuction,this),d.default.Instance.on(l.default.SociatyRefreshContributionEvent,this.onRefreshPlayerContribution,this),d.default.Instance.emit(l.default.SociatyRefreshContributionEvent)},t.prototype.start=function(){var e=this,t=[];c.default.instance().SociatyAuctionData.forEach(function(e){for(var o=0;o<e.focus.length;o++)if(1==u.default.UUID.equals(e.focus[o])){t.push(e);break}}),t.length>0&&3==c.default.instance().getSociatyAuctionState()&&(t=[]),t.forEach(function(t){var o=cc.instantiate(e.itemPrefab);o.parent=e.scrollViewNode.content,o.getComponent("SociatyAuctionItem").onShow(t,!0),o.getComponent("SociatyAuctionItem").onDisabledFocusBtn()}),this.notTipLabNode.active=t.length<=0},t.prototype.onRefreshChangeAuction=function(e){var t=this;if(3==c.default.instance().getSociatyAuctionState()){if(1==this.notTipLabNode.active)return;return this.notTipLabNode.active=!0,this.scrollViewNode.content.destroyAllChildren()}e.length<=0&&this.scrollViewNode.content.childrenCount>0?(this.scrollViewNode.content.destroyAllChildren(),this.notTipLabNode.active=!0):e.forEach(function(e){for(var o=0;o<t.scrollViewNode.content.childrenCount;o++){var i=t.scrollViewNode.content.children[o];if(i.auctionId==e.id){i.getComponent("SociatyAuctionItem").onShow(e),i.getComponent("SociatyAuctionItem").onDisabledFocusBtn();break}}})},t.prototype.onRefreshPlayerContribution=function(){this.contributeLab.string=u.default.getItemCountByBag(1009)},n([f(cc.ScrollView)],t.prototype,"scrollViewNode",void 0),n([f(cc.Prefab)],t.prototype,"itemPrefab",void 0),n([f(cc.Node)],t.prototype,"notTipLabNode",void 0),n([f(cc.Label)],t.prototype,"contributeLab",void 0),n([s.Register_Class,p],t)}(r.default);o.default=g,cc._RF.pop()},{"../../common/EventConst":"EventConst","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/manager/EventManager":"EventManager","./SociatyModel":"SociatyModel"}],SociatyAuctionDetailsView:[function(e,t,o){"use strict";cc._RF.push(t,"9a71es6MfRC5bgxi9eCk3Gy","SociatyAuctionDetailsView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=cc._decorator,l=c.ccclass,d=c.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.scrollViewNode=null,t.itemPrefabNode=null,t.tipLabNode=null,t}return a(t,e),t.path=function(){return"ui/sociaty/prefab/SociatyAuctionDetails"},t.prototype.init=function(e){var t=this;e&&e.tAuctionlogs?(e.tAuctionlogs.sort(function(e,t){return e.auctionTime-t.auctionTime}),e.tAuctionlogs.forEach(function(e){t.createAcutionLogNode(e).parent=t.scrollViewNode.content}),this.tipLabNode.active=e.tAuctionlogs.length<=0):this.closeView()},t.prototype.createAcutionLogNode=function(e){var t=cc.instantiate(this.itemPrefabNode);return t.active=!0,t.children[2].getComponent(cc.Label).string=function(e){var t=new Date(1e3*e);return(t.getHours()<10?"0"+t.getHours():t.getHours())+":"+(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+":"+(t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds())}.call(this,e.auctionTime),t.children[3].getComponent(cc.Label).string=e.roleName,t.children[4].children[0].getComponent(cc.Label).string=e.auctionPrice.toString(),t},n([d(cc.ScrollView)],t.prototype,"scrollViewNode",void 0),n([d(cc.Node)],t.prototype,"itemPrefabNode",void 0),n([d(cc.Node)],t.prototype,"tipLabNode",void 0),n([s.Register_Class,l],t)}(r.default);o.default=u,cc._RF.pop()},{"../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators"}],SociatyAuctionItem:[function(e,t,o){"use strict";cc._RF.push(t,"50e1bpSjcNADKsH11yHRtHe","SociatyAuctionItem");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../utils/GameTools"),s=e("../../utils/ConfigUtils"),c=e("./SociatyModel"),l=e("../../common/PlayerModule"),d=e("../../network/protocol/TypeProtocols"),u=e("../../Global/GameGlobal"),h=e("../../modules/base/GameView"),p=e("../../StaticData/SociatyAuctionTableData"),f=e("./SociatyCtrl"),g=e("../../utils/GameUtils"),m=cc._decorator,_=m.ccclass,y=m.property,v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.itemNameLab=null,t.concernNodeArr=[],t.detailsBtnNode=null,t.buyPriceLab=null,t.auctionPriceLab=null,t.stateNodeArr=[],t.auctionBtn=null,t.buyBtn=null,t.clickFocusButton=null,t.showTime=0,t.durationTime=0,t.bBuy=!1,t.clickFocusTimestamp=0,t}return a(t,e),t.prototype.onShow=function(e,t){this.node.auctionId=e.id,this.showTime=e.beginTime+e.cdTime,this.durationTime=e.beginTime+e.cdTime+e.durationTime,this.tAuctionLogs=e.auctionLogs,this.bBuy=e.isBuy;var o=p.SociatyAuctionTableData.getById(e.prizeId);e.prizes&&e.prizes.length>0&&(t&&1==t&&(this.node.getChildByName("rewardAuctionItemNode")&&this.node.getChildByName("rewardAuctionItemNode").destroy(),r.default.createNormalItems(e.prizes[0].dropID,e.prizes[0].dropNum,this.node,function(e){e.scale=.66,e.x=-395,e.name="rewardAuctionItemNode"})),this.itemNameLab.string=s.default.getInstance().getItemByID(e.prizes[0].dropID).name),this.buyPriceLab.string=o.buyPrice.toString(),this.stateNodeArr.forEach(function(e){e.active=!1}),c.default.instance().SociatyPlayerData.job==d.SOCIATY_JOB.SOCIATY_JOB_OFFICIAL||c.default.instance().SociatyPlayerData.job==d.SOCIATY_JOB.SOCIATY_JOB_PRESIDENT?this.detailsBtnNode.active=!0:this.detailsBtnNode.active=!1,this.concernNodeArr.forEach(function(e){e.active=!1});for(var i=!1,a=0;a<e.focus.length;a++)if(1==l.default.UUID.equals(e.focus[a])){i=!0;break}1==i?this.concernNodeArr[0].active=!0:this.concernNodeArr[1].active=!0;var n=o.basePrice+o.basePrice*(e.auctionNum*o.addPrice/100);this.auctionPriceLab.string=n.toString(),1==e.isBuy?(this.stateNodeArr[this.stateNodeArr.length-1].active=!0,this.buyBtn.interactable=!1,this.buyBtn.enableAutoGrayEffect=!0,this.unschedule(this.onRefreshCountdown)):(this.unschedule(this.onRefreshCountdown),this.onRefreshCountdown(),this.schedule(this.onRefreshCountdown,1),this.buyBtn.interactable=!0,this.buyBtn.enableAutoGrayEffect=!1),this.auctionBtn.node.children[0].children[1].active=!1,this.auctionBtn.node.children[0].children[0].active=!0,this.auctionBtn.interactable=!0,this.auctionBtn.enableAutoGrayEffect=!1,1!=l.default.UUID.equals(e.roleID)&&1!=e.isBuy||(this.auctionBtn.interactable=!1,this.auctionBtn.enableAutoGrayEffect=!0,1==l.default.UUID.equals(e.roleID)&&(this.auctionBtn.node.children[0].children[1].active=!0,this.auctionBtn.node.children[0].children[0].active=!1))},t.prototype.onClickDetailsCallBack=function(){h.default.addPopView("BaseCtrl","SociatyAuctionDetailsView","SociatyAuctionDetailsView",{tAuctionlogs:this.tAuctionLogs})},t.prototype.onClickAuctionCallBack=function(){var e=c.default.instance().getSociatyAuctionState();return 1==e?u.G.StringManager.PopWorldString("sociaty_auction_tip1"):1==this.bBuy?u.G.StringManager.PopWorldString("sociaty_auction_tip3"):Number(this.auctionPriceLab.string)>=Number(this.buyPriceLab.string)?u.G.StringManager.PopWorldString("sociaty_auction_tip8"):l.default.getItemCountByBag(1009)<Number(this.auctionPriceLab.string)?u.G.StringManager.PopWorldString("sociaty_auction_tip9"):3==e?u.G.StringManager.PopWorldString("sociaty_auction_tip12"):void f.default.c_Sociaty_RoleAuction(this.node.auctionId,Number(this.auctionPriceLab.string))},t.prototype.onClickBuyCallBack=function(){var e=this,t=c.default.instance().getSociatyAuctionState();if(1==t)return u.G.StringManager.PopWorldString("sociaty_auction_tip1");if(3==t)return u.G.StringManager.PopWorldString("sociaty_auction_tip12");var o="<outline color=black width=2> <color=#ffffff>\u662f\u5426\u82b1\u8d39"+this.buyPriceLab.string+"</c> <img src='gongxian' />  <color=#ffffff>\u76f4\u63a5\u83b7\u5f97\u8be5\u7269\u54c1\uff1f</color> </outline>";h.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:o,isRichText:!0,confirmCb:function(){if(l.default.getItemCountByBag(1009)<Number(e.buyPriceLab.string))return u.G.StringManager.PopString(u.G.StringManager.getString("SOCIATY_SHOP_ERROR_TEXT"));f.default.c_Sociaty_RoleDirectBuy(e.node.auctionId)}})},t.prototype.onClickFocusCallBack=function(){if(l.default.getServersTime()-this.clickFocusTimestamp<Number(g.getConfigIntValue("sociaty_auction_focus_cd")))return u.G.StringManager.PopWorldString("sociaty_auction_tip11");f.default.c_Sociaty_RoleFocus(this.node.auctionId),this.clickFocusTimestamp=l.default.getServersTime()},t.prototype.onRefreshCountdown=function(){c.default.instance().getSociatyAuctionState(),this.stateNodeArr.forEach(function(e){e.active=!1});var e=l.default.getServersTime(),t=function(e){var t="";if(e>-1){var o=Math.floor(e/3600),i=Math.floor(e/60)%60,a=e%60;t=o<10?"0"+o+":":o+":",i<10&&(t+="0"),t+=i+":",a<10&&(t+="0"),t+=a.toFixed(0)}return t};e<this.showTime?this.stateNodeArr[1]&&cc.isValid(this.node)&&(this.stateNodeArr[1].active=!0,this.stateNodeArr[1].children[0].getComponent(cc.Label).string=t.call(this,this.showTime-e)+"\u540e"):e<this.durationTime&&this.stateNodeArr[0]&&cc.isValid(this.node)&&(this.stateNodeArr[0].active=!0,this.stateNodeArr[0].children[0].getComponent(cc.Label).string=t.call(this,this.durationTime-e)+"\u540e")},t.prototype.onDisabledFocusBtn=function(){this.clickFocusButton.getComponent(cc.Button).enabled=!1},t.prototype.onDestroy=function(){this.unschedule(this.onRefreshCountdown)},n([y(cc.Label)],t.prototype,"itemNameLab",void 0),n([y(cc.Node)],t.prototype,"concernNodeArr",void 0),n([y(cc.Node)],t.prototype,"detailsBtnNode",void 0),n([y(cc.Label)],t.prototype,"buyPriceLab",void 0),n([y(cc.Label)],t.prototype,"auctionPriceLab",void 0),n([y(cc.Node)],t.prototype,"stateNodeArr",void 0),n([y(cc.Button)],t.prototype,"auctionBtn",void 0),n([y(cc.Button)],t.prototype,"buyBtn",void 0),n([y(cc.Button)],t.prototype,"clickFocusButton",void 0),n([_],t)}(cc.Component);o.default=v,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/SociatyAuctionTableData":"SociatyAuctionTableData","../../common/PlayerModule":"PlayerModule","../../modules/base/GameView":"GameView","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/ConfigUtils":"ConfigUtils","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils","./SociatyCtrl":"SociatyCtrl","./SociatyModel":"SociatyModel"}],SociatyAuctionLogItem:[function(e,t,o){"use strict";cc._RF.push(t,"d0f4a4PsJ9HPaSCis91RHPB","SociatyAuctionLogItem");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../StaticData/SociatyAuctionTableData"),s=e("../../utils/GameTools"),c=e("../../utils/ConfigUtils"),l=cc._decorator,d=l.ccclass,u=l.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.itemNameLab=null,t.playerNameLab=null,t.buyPriceLab=null,t.stateNode=[],t}return a(t,e),t.prototype.show=function(e){var t=r.SociatyAuctionTableData.getById(e.auctionId);e.prizes&&e.prizes.length>0&&(s.default.createNormalItems(e.prizes[0].dropID,e.prizes[0].dropNum,this.node,function(e){e.scale=.66,e.x=-395}),this.itemNameLab.string=c.default.getInstance().getItemByID(e.prizes[0].dropID).name);var o="\u65e0",i=t.basePrice;e.logData&&(o=e.logData.roleName,i=e.logData.auctionPrice),this.playerNameLab.string=o,this.buyPriceLab.string=i.toString(),e.logData?(1==e.logData.isAuctionSuccess||e.auctionNum>0)&&(this.stateNode[1].active=!0,this.stateNode[0].active=!1):(this.stateNode[0].active=!0,this.stateNode[1].active=!1)},n([u(cc.Label)],t.prototype,"itemNameLab",void 0),n([u(cc.Label)],t.prototype,"playerNameLab",void 0),n([u(cc.Label)],t.prototype,"buyPriceLab",void 0),n([u(cc.Node)],t.prototype,"stateNode",void 0),n([d],t)}(cc.Component);o.default=h,cc._RF.pop()},{"../../StaticData/SociatyAuctionTableData":"SociatyAuctionTableData","../../utils/ConfigUtils":"ConfigUtils","../../utils/GameTools":"GameTools"}],SociatyAuctionLogView:[function(e,t,o){"use strict";cc._RF.push(t,"853f3vQS2xJLYtnltc5IwWs","SociatyAuctionLogView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=e("./SociatyModel"),l=e("../../utils/List"),d=cc._decorator,u=d.ccclass,h=d.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.scrollViewNode=null,t.itemPrefab=null,t.notTipLabNode=null,t.scrollviewListNode=null,t}return a(t,e),t.path=function(){return"ui/sociaty/prefab/SociatyAuctionLog"},t.prototype.start=function(){var e=[];c.default.instance().SociatyAuctionData.forEach(function(t){t.auctionLogs.sort(function(e,t){return e.auctionTime-t.auctionTime});var o={auctionId:t.prizeId,prizes:t.prizes,auctionNum:t.auctionNum,logData:t.auctionLogs[t.auctionLogs.length-1]};t.isFinished&&e.push(o)}),c.default.instance().getSociatyAuctionState()<3&&(e=[]),this.tListData=e,this.notTipLabNode.active=e.length<=0,this.scrollviewListNode.numItems=e.length},t.prototype.onRefreshAuctionLogItemEvent=function(e,t){var o=this.tListData[t];e.getComponent("SociatyAuctionLogItem").show(o)},n([h(cc.ScrollView)],t.prototype,"scrollViewNode",void 0),n([h(cc.Prefab)],t.prototype,"itemPrefab",void 0),n([h(cc.Node)],t.prototype,"notTipLabNode",void 0),n([h(l.default)],t.prototype,"scrollviewListNode",void 0),n([s.Register_Class,u],t)}(r.default);o.default=p,cc._RF.pop()},{"../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../utils/List":"List","./SociatyModel":"SociatyModel"}],SociatyAuctionTableData:[function(e,t,o){"use strict";cc._RF.push(t,"e4e65G1E41OQqglBSL16iyL","SociatyAuctionTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.SociatyAuctionTableData=void 0;var i=e("../TableReader"),a=e("./BaseTableData"),n=function(){function e(){this.id=0,this.minRank=0,this.maxRank=0,this.basePrice=0,this.buyPrice=0,this.addPrice=0,this.prize=new Array,this.mailid=0}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.minRank=e.getNumber(),this.maxRank=e.getNumber(),this.basePrice=e.getNumber(),this.buyPrice=e.getNumber(),this.addPrice=e.getNumber();for(var o=e.getString(),n=new i.TableReader(o);n.getPos()<n.getLen();){var r=new a.DropItem;r.readOriginal(n),this.prize.push(r)}this.mailid=e.getNumber()},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"SociatyAuctionTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.SociatyAuctionTableData=n,cc._RF.pop()},{"../TableReader":"TableReader","./BaseTableData":"BaseTableData"}],SociatyAuctionView:[function(e,t,o){"use strict";cc._RF.push(t,"17120t4kltDxoh0EGHXNfL1","SociatyAuctionView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=e("../../modules/base/GameView"),l=e("../../common/EventConst"),d=e("../../modules/manager/EventManager"),u=e("./SociatyCtrl"),h=e("../../common/PlayerModule"),p=e("../../Global/GameGlobal"),f=e("./SociatyModel"),g=cc._decorator,m=g.ccclass,_=g.property,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.scrollViewNode=null,t.itemPrefab=null,t.endTimeTipLab=null,t.contributeLab=null,t.pageLab=null,t.pageButtonArr=[],t.curSelectPageNum=1,t.tAuctionArrData=[],t}return a(t,e),t.path=function(){return"ui/sociaty/prefab/SociatyAuction"},t.prototype.onLoad=function(){u.default.c_Sociaty_RoleGetAuctionData(),d.default.Instance.on(l.default.SyncSociatyChangeAuctionStateEvent,this.changeAuctionChangeState,this),d.default.Instance.on(l.default.SyncSociatyGetAuctionDataEvent,this.initAuctionDataInfo,this),d.default.Instance.on(l.default.SyncSociatyChangeAuctionDataEvent,this.onRefreshChangeAuction,this),d.default.Instance.on(l.default.SociatyRefreshContributionEvent,this.onRefreshPlayerContribution,this),d.default.Instance.emit(l.default.SociatyRefreshContributionEvent)},t.prototype.changeAuctionChangeState=function(e){1==e?p.G.StringManager.PopWorldString("sociaty_auction_tip5"):p.G.StringManager.PopWorldString("sociaty_auction_tip4")},t.prototype.initAuctionDataInfo=function(e){var t=this;this.tAuctionArrData=e,3==f.default.instance().getSociatyAuctionState()&&(e=[]);var o=0;e.length>0?this.schedule(function(){var e=cc.instantiate(t.itemPrefab);e.parent=t.scrollViewNode.content,e.active=!1,++o>=10&&t.refreshPageLab()},0,9,0):this.refreshPageLab(),e.length<=0&&this.scrollViewNode.content.childrenCount>0&&this.scrollViewNode.content.destroyAllChildren(),this.endTimeTipLab.node.active=e.length<=0},t.prototype.onRefreshChangeAuction=function(e){var t=this;if(3==f.default.instance().getSociatyAuctionState()){if(1==this.endTimeTipLab.node.active)return;return this.unscheduleAllCallbacks(),this.endTimeTipLab.node.active=!0,d.default.Instance.emit(l.default.SociatyRefreshRedpoint),void this.refreshPageLab()}e.length<=0&&this.scrollViewNode.content.childrenCount>0?this.scrollViewNode.content.destroyAllChildren():e.forEach(function(e){for(var o=0;o<t.scrollViewNode.content.childrenCount;o++){var i=t.scrollViewNode.content.children[o];if(i.auctionId==e.id){i.getComponent("SociatyAuctionItem").onShow(e);break}}}),this.endTimeTipLab.node.active=e.length<=0,this.tAuctionArrData=e},t.prototype.onClickConcernCallBack=function(){c.default.addPopView("BaseCtrl","SociatyAuctionAttentionView","SociatyAuctionAttentionView")},t.prototype.onClickAuctionLogCallBack=function(){c.default.addPopView("BaseCtrl","SociatyAuctionLogView","SociatyAuctionLogView")},t.prototype.onRefreshPlayerContribution=function(){this.contributeLab.string=h.default.getItemCountByBag(1009)},t.prototype.onClickLastPageCallBack=function(){this.curSelectPageNum--,this.curSelectPageNum<=0&&(this.curSelectPageNum=1),this.refreshPageLab()},t.prototype.onClickNextPageCallBack=function(){this.curSelectPageNum++;var e=Math.ceil(this.tAuctionArrData.length/10);this.curSelectPageNum>=e&&(this.curSelectPageNum=e),this.refreshPageLab()},t.prototype.refreshPageLab=function(){var e=this;if(3==f.default.instance().getSociatyAuctionState()||Math.ceil(this.tAuctionArrData.length/10)<=0)return this.pageLab.string="0/0",this.pageButtonArr[0].interactable=!1,this.pageButtonArr[0].enableAutoGrayEffect=!0,this.pageButtonArr[1].interactable=!1,this.pageButtonArr[1].enableAutoGrayEffect=!0,void this.scrollViewNode.content.destroyAllChildren();for(var t=10*(this.curSelectPageNum-1),o=10*this.curSelectPageNum,i=0;i<this.scrollViewNode.content.childrenCount;i++)this.scrollViewNode.content.children[i].active=!1;var a=f.default.instance().SociatyAuctionData.slice(t,o);a&&a.length>0&&(a.forEach(function(t,o){e.scrollViewNode.content.children[o]&&(e.scrollViewNode.content.children[o].active=!0,e.scrollViewNode.content.children[o].getComponent("SociatyAuctionItem").onShow(t,!0))}),this.scrollViewNode.scrollToTop(.1)),this.pageLab.string=this.curSelectPageNum+"/"+Math.ceil(this.tAuctionArrData.length/10),1==this.curSelectPageNum?(this.pageButtonArr[0].interactable=!1,this.pageButtonArr[0].enableAutoGrayEffect=!0,this.pageButtonArr[1].interactable=!0,this.pageButtonArr[1].enableAutoGrayEffect=!1):this.curSelectPageNum==Math.ceil(this.tAuctionArrData.length/10)?(this.pageButtonArr[1].interactable=!1,this.pageButtonArr[1].enableAutoGrayEffect=!0,this.pageButtonArr[0].interactable=!0,this.pageButtonArr[0].enableAutoGrayEffect=!1):(this.pageButtonArr[0].interactable=!0,this.pageButtonArr[0].enableAutoGrayEffect=!1,this.pageButtonArr[1].interactable=!0,this.pageButtonArr[1].enableAutoGrayEffect=!1)},t.prototype.onDestroy=function(){d.default.Instance.off(this),f.default.instance().SociatyAuctionData=[],this.unscheduleAllCallbacks()},n([_(cc.ScrollView)],t.prototype,"scrollViewNode",void 0),n([_(cc.Prefab)],t.prototype,"itemPrefab",void 0),n([_(cc.Label)],t.prototype,"endTimeTipLab",void 0),n([_(cc.Label)],t.prototype,"contributeLab",void 0),n([_(cc.Label)],t.prototype,"pageLab",void 0),n([_(cc.Button)],t.prototype,"pageButtonArr",void 0),n([s.Register_Class,m],t)}(r.default);o.default=y,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../common/EventConst":"EventConst","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/base/GameView":"GameView","../../modules/manager/EventManager":"EventManager","./SociatyCtrl":"SociatyCtrl","./SociatyModel":"SociatyModel"}],SociatyBoxIntroduceView:[function(e,t,o){"use strict";cc._RF.push(t,"8bb6fIVuXhLEpoipJCeXhBP","SociatyBoxIntroduceView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=e("./SociatyModel"),l=e("../../StaticData/SociatyLevelTableData"),d=cc._decorator,u=d.ccclass,h=d.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.expLab=null,t}return a(t,e),t.path=function(){return"ui/sociaty/prefab/SociatyBoxIntroduce"},t.prototype.start=function(){var e=c.default.instance().SociatyData.sociatyDayMedal,t=l.SociatyLevelTableData.getById(c.default.instance().SociatyData.sociatyLevel);this.expLab.string=e+"/"+t.maxDayMedal},n([h(cc.Label)],t.prototype,"expLab",void 0),n([s.Register_Class,u],t)}(r.default);o.default=p,cc._RF.pop()},{"../../StaticData/SociatyLevelTableData":"SociatyLevelTableData","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","./SociatyModel":"SociatyModel"}],SociatyBoxItem:[function(e,t,o){"use strict";cc._RF.push(t,"2b31bI5WtZCaYmMhyzYdcVX","SociatyBoxItem");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/manager/LoadResManager"),s=e("../../utils/GameTools"),c=e("../../modules/base/GameView"),l=e("../../Global/GameGlobal"),d=e("../../utils/GameUtils"),u=e("../../network/protocol/TypeProtocols"),h=e("../../common/PlayerModule"),p=e("./SociatyModel"),f=e("../../utils/ConfigUtils"),g=e("./SociatyCtrl"),m=e("../../network/protocol/SociatyProtocols"),_=cc._decorator.ccclass,y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.show=function(e){this.initCoinInfo(e),this.initFreeBoxInof(e),this.initLuxuryBoxInfo(e)},t.prototype.initLuxuryBoxInfo=function(e){var t=this,o=this.node.getChildByName("ExtraRewardsNode");o.reawds=e.extraPrize,o.coinNum=e.coinNum,r.default.loadSpriteFrame(e.extraItemIcon).then(function(i){cc.isValid(t.node)&&(o.getChildByName("ExtraRewardsIcon").scale=o.getChildByName("ExtraRewardsIcon").scale*e.extraItemScale/100,o.getChildByName("ExtraRewardsIcon").getComponent(cc.Sprite).spriteFrame=i)}).catch(function(e){cc.error(e)}),o.getChildByName("ExtraRewardsName").getComponent(cc.Label).string=e.extraItemName;var i=this.checkLuxuryRewardLockState();o.getChildByName("suo").active=!i,0==i&&s.default.registerTouchEvent(o.getChildByName("suo"),function(){l.G.StringManager.PopString(l.G.StringManager.getWorldString("season_prize_get_hint",Number(d.getConfigIntValue("sociaty_extraItem_score"))))});var a=0,n=p.default.instance().SociatyData.sociatyMedal;1==this.checkBoxReceiveState(e.coinNum,2)?a=2:n>=e.coinNum&&1==i&&(a=1),2==a?(s.default.setNodeBright(o,!1),this.node.getChildByName("waifaguang").active=!1):this.node.getChildByName("waifaguang").active=1==a,o.receiveState=a,s.default.registerTouchEvent(o,function(e){var o=e.target;if(o.reawds)if(o.reawds.length>1)c.default.addPopView("BaseCtrl","BattlePassRewardPreview","BattlePassRewardPreview",{cb:function(){var e=Number(d.getConfigIntValue("sociaty_extraItem_score"));if(e>h.default.getRoleAttrValByKey(u.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE))return l.G.StringManager.PopString(l.G.StringManager.getWorldString("season_prize_get_hint",e));var t=new m.T_SociatyBattlePassData;t.index=o.coinNum,t.type=2,g.default.c_Sociaty_RoleReceiveSociatyBoxPrize([t])},rewards:o.reawds,rewardState:o.receiveState});else{if(2==o.receiveState)return l.G.StringManager.PopString(l.G.StringManager.getWorldString("common_prompt_receive_over"));if(1==o.receiveState){var i=Number(d.getConfigIntValue("sociaty_extraItem_score"));if(i>h.default.getRoleAttrValByKey(u.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE))return l.G.StringManager.PopString(l.G.StringManager.getWorldString("season_prize_get_hint",i));var a=new m.T_SociatyBattlePassData;a.index=o.coinNum,a.type=2,g.default.c_Sociaty_RoleReceiveSociatyBoxPrize([a])}else t.checkRewardIsHero(o.reawds[0])&&c.default.addPopView("BaseCtrl","DrawNewHeroCardView","DrawNewHeroCardView",{heroId:o.reawds[0].itemID,bShowNew:!0,bAction:!0})}})},t.prototype.initCoinInfo=function(e){var t=this;this.node.getChildByName("CoinBg").getChildByName("CoinNum").getComponent(cc.Label).string=e.coinNum.toString(),0>=e.coinNum&&r.default.loadSpriteFrame("ui/battle_pass/res/bei1").then(function(e){cc.isValid(t.node)&&(t.node.getChildByName("CoinBg").getComponent(cc.Sprite).spriteFrame=e)})},t.prototype.initFreeBoxInof=function(e){var t=this,o=this.node.getChildByName("RewardsNode");o.reawds=e.prize,o.coinNum=e.coinNum,r.default.loadSpriteFrame(e.itemIcon).then(function(i){cc.isValid(t.node)&&(o.getChildByName("RewardsIcon").scale=o.getChildByName("RewardsIcon").scale*e.itemScale/100,o.getChildByName("RewardsIcon").getComponent(cc.Sprite).spriteFrame=i)}).catch(function(e){cc.error(e)}),o.getChildByName("RewardsName").getComponent(cc.Label).string=e.itemName;var i=0,a=p.default.instance().SociatyData.sociatyMedal;1==this.checkBoxReceiveState(e.coinNum,1)?i=2:a>=e.coinNum&&(i=1),2==i?(s.default.setNodeBright(o,!1),this.node.getChildByName("waifaguangReward").active=!1):this.node.getChildByName("waifaguangReward").active=1==i,o.receiveState=i,s.default.registerTouchEvent(o,function(e){var o=e.target;if(o.reawds.length>1)c.default.addPopView("BaseCtrl","BattlePassRewardPreview","BattlePassRewardPreview",{cb:function(){var e=new m.T_SociatyBattlePassData;e.index=o.coinNum,e.type=1,g.default.c_Sociaty_RoleReceiveSociatyBoxPrize([e])},rewards:o.reawds,rewardState:o.receiveState});else{if(2==o.receiveState)return l.G.StringManager.PopString(l.G.StringManager.getWorldString("common_prompt_receive_over"));if(1==o.receiveState){var i=new m.T_SociatyBattlePassData;i.index=o.coinNum,i.type=1,g.default.c_Sociaty_RoleReceiveSociatyBoxPrize([i])}else t.checkRewardIsHero(o.reawds[0])&&c.default.addPopView("BaseCtrl","DrawNewHeroCardView","DrawNewHeroCardView",{heroId:o.reawds[0].itemID,bShowNew:!0,bAction:!0})}})},t.prototype.checkLuxuryRewardLockState=function(){var e=Number(d.getConfigIntValue("sociaty_extraItem_score")),t=!1;return h.default.getRoleAttrValByKey(u.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE)>=e&&(t=!0),t},t.prototype.checkBoxReceiveState=function(e,t){var o=p.default.instance().SociatyBoxData.boxsMap;return!!o.has(e)&&o.get(e).receiveMap.get(t)},t.prototype.checkRewardIsHero=function(e){return!!f.default.getInstance().data["StaticData/HeroTableData"].hasOwnProperty(e.itemID)},n([_],t)}(cc.Component);o.default=y,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../common/PlayerModule":"PlayerModule","../../modules/base/GameView":"GameView","../../modules/manager/LoadResManager":"LoadResManager","../../network/protocol/SociatyProtocols":"SociatyProtocols","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/ConfigUtils":"ConfigUtils","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils","./SociatyCtrl":"SociatyCtrl","./SociatyModel":"SociatyModel"}],SociatyBoxOriginView:[function(e,t,o){"use strict";cc._RF.push(t,"8b6fcdD+stCgLbCPStodnSv","SociatyBoxOriginView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=e("../../StaticData/SociatyCourageMedalGainWayTableData"),l=e("../../Global/GameGlobal"),d=e("./SociatyModel"),u=cc._decorator,h=u.ccclass,p=u.property,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.scrollListNode=null,t.prefabNodeItem=null,t}return a(t,e),t.path=function(){return"ui/sociaty/prefab/SociatyBoxOrigin"},t.prototype.start=function(){var e=[];c.SociatyCourageMedalGainWayTableData.getDataMap().forEach(function(t){e.push(t)});for(var t=0;t<e.length;t++){var o=e[t],i=cc.instantiate(this.prefabNodeItem);i.parent=this.scrollListNode.content,i.active=!0,i.getChildByName("task_desc").getComponent(cc.Label).string=l.G.StringManager.getWorldString(o.info);var a=d.default.instance().getMedalGainValue(o);i.getChildByName("task_progressBar").getChildByName("num").getComponent(cc.Label).string=a+"/"+o.dayMedal,i.getChildByName("task_progressBar").getComponent(cc.ProgressBar).progress=a/o.dayMedal}},n([p(cc.ScrollView)],t.prototype,"scrollListNode",void 0),n([p(cc.Node)],t.prototype,"prefabNodeItem",void 0),n([s.Register_Class,h],t)}(r.default);o.default=f,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/SociatyCourageMedalGainWayTableData":"SociatyCourageMedalGainWayTableData","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","./SociatyModel":"SociatyModel"}],SociatyBoxTableData:[function(e,t,o){"use strict";cc._RF.push(t,"cb18eja1UhOEoT8BMdE5Ou4","SociatyBoxTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.SociatyBoxTableData=void 0;var i=e("../TableReader"),a=e("./BaseTableData"),n=function(){function e(){this.id=0,this.seasonId=0,this.coinNum=0,this.itemName="",this.itemIcon="",this.itemScale=0,this.extraItemName="",this.extraItemIcon="",this.extraItemScale=0,this.prize=new Array,this.extraPrize=new Array,this.pointX=0}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.seasonId=e.getNumber(),this.coinNum=e.getNumber(),this.itemName=e.getString(),this.itemIcon=e.getString(),this.itemScale=e.getNumber(),this.extraItemName=e.getString(),this.extraItemIcon=e.getString(),this.extraItemScale=e.getNumber();for(var o=e.getString(),n=new i.TableReader(o);n.getPos()<n.getLen();)(s=new a.ItemInfo).readOriginal(n),this.prize.push(s);o=e.getString();for(var r=new i.TableReader(o);r.getPos()<r.getLen();){var s;(s=new a.ItemInfo).readOriginal(r),this.extraPrize.push(s)}this.pointX=e.getNumber()},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"SociatyBoxTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.SociatyBoxTableData=n,cc._RF.pop()},{"../TableReader":"TableReader","./BaseTableData":"BaseTableData"}],SociatyBoxView:[function(e,t,o){"use strict";cc._RF.push(t,"4948dDIhDJFApdPyPVw42u9","SociatyBoxView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../StaticData/SociatyBoxTableData"),s=e("../../common/PlayerModule"),c=e("../../modules/base/GameView"),l=e("../../StaticData/SociatyCourageMedalGainWayTableData"),d=e("./SociatyModel"),u=e("../../Global/GameGlobal"),h=e("./SociatyCtrl"),p=e("../../common/EventConst"),f=e("../../modules/manager/EventManager"),g=e("../../utils/GameUtils"),m=e("../../network/protocol/TypeProtocols"),_=cc._decorator,y=_.ccclass,v=_.property,C=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.itemPrefab=null,t.ScrollView=null,t.progressBarNode=null,t.curTrophyNode=null,t.curGetWayLab=null,t._scrollViewChildNode=[],t._curSeasonData=[],t._boxItemSpacing=300,t.rewardCount=0,t.nSeasonLeftTime=0,t}return a(t,e),t.prototype.onLoad=function(){f.default.Instance.on(p.default.SociatySyncBoxEvent,this.initSociatyBoxInfo,this),f.default.Instance.on(p.default.SociatySyncReceiveBoxEvent,this.showRewards,this)},t.prototype.start=function(){var e=this,t=d.default.instance().SociatyData;this.nSeasonLeftTime=t.sociatySeasonLeftTime,r.SociatyBoxTableData.getDataMap().forEach(function(o){t.sociatySeasonID==o.seasonId&&e._curSeasonData.push(o)}),this._curSeasonData.length<=0&&r.SociatyBoxTableData.getDataMap().forEach(function(t){e._curSeasonData[0]&&e._curSeasonData[0].seasonId!=t.seasonId&&(e._curSeasonData=[]),e._curSeasonData.push(t)}),h.default.c_Sociaty_RoleGetSociatyBoxData();var o=this._curSeasonData;this.progressBarNode.width=o[o.length-1].pointX,this.ScrollView.content.width=this.progressBarNode.width+o[0].pointX-this.itemPrefab.width/2+50,this.onRefreshSociatySeasonEndTime(),this.schedule(this.onRefreshSociatySeasonEndTime,1);var i=Number(g.getConfigIntValue("sociaty_extraItem_score")),a=s.default.getRoleAttrValByKey(m.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE);this.node.getChildByName("sociaty_box_suo").active=!(a>=i),this.node.getChildByName("sociaty_box_suo").children[0].getComponent(cc.Label).string=u.G.StringManager.getString("SOCIATY_BOX_TEXT",i)},t.prototype.initCurGetWayInfo=function(){var e=[];l.SociatyCourageMedalGainWayTableData.getDataMap().forEach(function(t){e.push(t)});for(var t=d.default.instance().SociatyPlayerData.dayConvertSociatyMedal,o=0,i=0;i<e.length;i++)o+=e[i].dayMedal;this.curGetWayLab.string=t+"/"+o},t.prototype.initBoxProgress=function(){var e=null;this.curTrophyNode.x=5;var t,o=this._curSeasonData,i=0,a=d.default.instance().SociatyData.sociatyMedal;if(o.forEach(function(t,o){a>=t.coinNum&&(e=t,i=o)}),e)if(t=o[i+1]){var n=a-e.coinNum,r=t.coinNum-e.coinNum,s=(t.pointX-e.pointX)*(n/r),c=e.pointX+s;this.curTrophyNode.x=c,isNaN(this.curTrophyNode.x)&&(this.curTrophyNode.x=5),this.progressBarNode.getChildByName("bar").width=c}else this.progressBarNode.getChildByName("bar").width=this.progressBarNode.width,this.curTrophyNode.x=this.progressBarNode.width-5;else(t=o[i])?(n=a,r=t.coinNum,c=s=t.pointX*(n/r),this.curTrophyNode.x=c,isNaN(this.curTrophyNode.x)&&(this.curTrophyNode.x=5),this.progressBarNode.getChildByName("bar").width=c):(this.progressBarNode.getChildByName("bar").width=this.progressBarNode.width,this.curTrophyNode.x=this.progressBarNode.width-5);this.curTrophyNode.getChildByName("CoinLabel").getComponent(cc.Label).string=a.toString()},t.prototype.onRefreshSociatySeasonEndTime=function(){var e=this.node.getChildByName("sociatyEndTimeLab").getComponent(cc.Label);this.nSeasonLeftTime--;var t=this.nSeasonLeftTime;if(t<=0)return e.node.active=!1,void this.unschedule(this.onRefreshSociatySeasonEndTime);e.string=u.G.StringManager.getString("SEASON_END")+function(e){var t=e%864e5/36e5,o=e%36e5/6e4;return parseInt((e/864e5).toString())+" \u5929 "+parseInt(t.toString())+" \u5c0f\u65f6 "+parseInt(o.toString())+" \u5206\u949f "}.call(this,1e3*t),0==e.node.active&&(e.node.active=!0)},t.prototype.initSociatyBoxInfo=function(){var e=this;this._scrollViewChildNode.forEach(function(e){e.destroy()}),this._scrollViewChildNode=[];var t=c.default.getViewByName("BattlePassRewardPreview");t&&t.view&&(t.view.node.active=!1,t.view.closeView());var o=this._curSeasonData,i=o.length,a=0;this.schedule(function(){var t=cc.instantiate(e.itemPrefab);t.parent=e.progressBarNode,t.getComponent("SociatyBoxItem").show(o[a]),t.x=o[a].pointX,t.y=-50,t.active=!0,e._scrollViewChildNode.push(t),e.curTrophyNode.setSiblingIndex(99),a++},0,i-1,0);var n=d.default.instance().checkReceiveSociatyBoxPrize();this.node.getChildByName("DrawButton").getComponent(cc.Button).interactable=n.length>0,this.node.getChildByName("DrawButton").getComponent(cc.Button).enableAutoGrayEffect=!(n.length>0),this.initBoxProgress(),this.onScrollToPoint(),this.initCurGetWayInfo()},t.prototype.showRewards=function(e){var t=this,o=function(){var e=t.tRewards.slice(6*t.rewardCount,6*(t.rewardCount+1));e.length>0&&c.default.addPopView("BaseCtrl","AcquirePopupView","AcquirePopupView",{items:e,closeCb:function(){t.rewardCount++,o.call(t)}})};this.rewardCount=0,this.tRewards=e,o.call(this)},t.prototype.onTotalGetRewardCallBack=function(){var e=d.default.instance().checkReceiveSociatyBoxPrize();if(e.length<=0)return u.G.StringManager.PopString(u.G.StringManager.getWorldString("common_prompt_not_rewards"));h.default.c_Sociaty_RoleReceiveSociatyBoxPrize(e)},t.prototype.onScrollToPoint=function(){for(var e=!1,t=d.default.instance().SociatyData.sociatyMedal,o=0,i=this._curSeasonData.length;o<i;o++){var a=(y=this._curSeasonData[o]).coinNum;if(a){var n=d.default.instance().SociatyData.sociatyMedal,r=0,c=d.default.instance().checkBoxReceiveState(a,1);0!=c&&c||n>=a&&(r=1);var l=0,u=d.default.instance().checkBoxReceiveState(a,2);if((0==u||!u)&&n>=a){var h=Number(g.getConfigIntValue("sociaty_extraItem_score"));s.default.getRoleAttrValByKey(m.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE)>=h&&(l=1)}if(1==r||1==l){var p=this.ScrollView.getMaxScrollOffset(),f=y.pointX>p.x?p.x:y.pointX;this.ScrollView.setContentPosition(cc.v2(-f+this.itemPrefab.width,0)),e=!0;break}}}if(0==e){var _=null;for(o=0,i=this._curSeasonData.length;o<i;o++){var y;(y=this._curSeasonData[o]).coinNum&&t>=y.coinNum&&(_=y)}_&&(p=this.ScrollView.getMaxScrollOffset(),f=_.pointX>p.x?p.x:_.pointX,this.ScrollView.setContentPosition(cc.v2(-f+this.itemPrefab.width,0)))}},t.prototype.onClickAddCallBack=function(){c.default.addPopView("BaseCtrl","SociatyBoxOriginView","SociatyBoxOriginView")},t.prototype.onHelpCallBack=function(){c.default.addPopView("BaseCtrl","SociatyBoxIntroduceView","SociatyBoxIntroduceView")},t.prototype.onDestroy=function(){f.default.Instance.off(this,p.default.SociatySyncBoxEvent),f.default.Instance.off(this,p.default.SociatySyncReceiveBoxEvent),this.unschedule(this.onRefreshSociatySeasonEndTime)},n([v(cc.Node)],t.prototype,"itemPrefab",void 0),n([v(cc.ScrollView)],t.prototype,"ScrollView",void 0),n([v(cc.Node)],t.prototype,"progressBarNode",void 0),n([v(cc.Node)],t.prototype,"curTrophyNode",void 0),n([v(cc.Label)],t.prototype,"curGetWayLab",void 0),n([y],t)}(cc.Component);o.default=C,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/SociatyBoxTableData":"SociatyBoxTableData","../../StaticData/SociatyCourageMedalGainWayTableData":"SociatyCourageMedalGainWayTableData","../../common/EventConst":"EventConst","../../common/PlayerModule":"PlayerModule","../../modules/base/GameView":"GameView","../../modules/manager/EventManager":"EventManager","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/GameUtils":"GameUtils","./SociatyCtrl":"SociatyCtrl","./SociatyModel":"SociatyModel"}],SociatyChatModel:[function(e,t,o){"use strict";cc._RF.push(t,"0e10395UX5BkLVpSci+AfrD","SociatyChatModel"),Object.defineProperty(o,"__esModule",{value:!0}),o.SociatyChatModel=void 0;var i=function(){function e(){this.m_logTime=0,this.m_chatType=0,this.m_bCloseRoom=!1}return e.prototype.update=function(e,t,o){void 0===e&&(e=null),void 0===t&&(t=null),void 0===o&&(o=null),e?(this.m_logTime=e.logTime,this.m_voChatLog=e,this.m_chatType=1):t?(this.m_logTime=t.chatTime,this.m_chatType=0,this.m_voChat=t):o&&(this.m_chatType=2,this.m_logTime=o.logTime,this.m_voChatFightLog=o)},e}();o.SociatyChatModel=i,cc._RF.pop()},{}],SociatyChatPanel:[function(e,t,o){"use strict";cc._RF.push(t,"66769uirupOxrWYc7d1Ayom","SociatyChatPanel");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/cores/UISuperLayout"),s=e("../../common/PlayerModule"),c=e("../../network/protocol/TypeProtocols"),l=e("../../network/ClientNetwork"),d=e("../../network/protocol/ChatProtocols"),u=e("../../network/protocol/ChatProtocols"),h=e("../../Global/GameGlobal"),p=e("../../modules/manager/EventManager"),f=e("../../common/EventConst"),g=cc._decorator,m=g.ccclass,_=g.property,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.scrollViewNode=null,t.unreadNode=null,t.tMsgDatas=new Array,t.nUnreadMsgCount=0,t}return a(t,e),t.prototype.onLoad=function(){var e=this;p.default.Instance.on(f.default.SyncMachineryCityChatMsgEvent,this.addMachineryCityChatMsg,this);var t=this.tMsgDatas;l.ClientNetwork.getInstance().listenProtocol(d.CHAT_CLIENT_ENUM.P_Chat_CloseFightRoom,function(o){o.resetPos();var i=new u.S_Chat_CloseFightRoom;if(i.read(o)){for(var a=!1,n=0;n<t.length;n++)if(t[n].channel==c.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_SOCIATY&&t[n].chatType==c.TYPE_CHAT.TYPE_CHAT_ROOMFIGHT&&t[n].chatText==i.roomID&&1!=t[n].chatParam){t[n].chatParam=1,a=!0;break}1==a&&e.scrollViewNode.children.forEach(function(t){t.roomId&&t.roomId==i.roomID&&e.scrollViewNode.notifyRefreshItem(t)})}},this),this.schedule(function(){e.nUnreadMsgCount=0,e.tMsgDatas.forEach(function(t){t.bReadState&&0!=t.bReadState||e.nUnreadMsgCount++}),e.nUnreadMsgCount>99&&(e.nUnreadMsgCount=99),e.node.getChildByName("unread").active=e.nUnreadMsgCount>1,e.nUnreadMsgCount>=99?e.node.getChildByName("unread").children[0].getComponent(cc.Label).string=h.G.StringManager.getWorldString("chat_unread_max"):e.node.getChildByName("unread").children[0].getComponent(cc.Label).string=h.G.StringManager.getWorldString("chat_unread",e.nUnreadMsgCount)},.2),this.node.children[0].off("scroll-to-bottom"),this.node.children[0].on("scroll-to-bottom",function(){e.scrollViewNode.scrollView.isScrollBounceBottom=!0},this)},t.prototype.onEnable=function(){this.scrollViewNode.total(this.tMsgDatas.length),this.onClickUnreadCallBack()},t.prototype.addMachineryCityChatMsg=function(e){var t=this;1!=this.checkRoomInChannel(e)&&(this.tMsgDatas.push(e),0!=this.node.active&&(this.scrollViewNode.total(this.tMsgDatas.length),1!=s.default.UUID.equals(e.roleID)&&1!=this.scrollViewNode.scrollView.isScrollBounceBottom||(e.bReadState=1,setTimeout(function(){try{t.scrollViewNode.scrollToFooter(.1)}catch(e){}},50))))},t.prototype.onClickUnreadCallBack=function(){var e=this;this.tMsgDatas.forEach(function(e){e.bReadState=1}),this.scrollViewNode.scrollView.isScrollBounceBottom=!0,setTimeout(function(){try{e.scrollViewNode.scrollToFooter(.1)}catch(t){}},50)},t.prototype.checkRoomInChannel=function(e){for(var t=0;t<this.tMsgDatas.length;t++)if(this.tMsgDatas[t].channel==c.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_SOCIATY&&this.tMsgDatas[t].chatText==e.chatText&&this.tMsgDatas[t].chatType==c.TYPE_CHAT.TYPE_CHAT_ROOMFIGHT)return!0;return!1},t.prototype.onListRender=function(e,t){e.getComponent("ChatItem").show(this.tMsgDatas[t])},t.prototype.onDestroy=function(){this.unscheduleAllCallbacks(),l.ClientNetwork.getInstance().removeMessageTarget(this),p.default.Instance.off(this)},n([_(r.default)],t.prototype,"scrollViewNode",void 0),n([_(cc.Node)],t.prototype,"unreadNode",void 0),n([m],t)}(cc.Component);o.default=y,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../common/EventConst":"EventConst","../../common/PlayerModule":"PlayerModule","../../modules/cores/UISuperLayout":"UISuperLayout","../../modules/manager/EventManager":"EventManager","../../network/ClientNetwork":"ClientNetwork","../../network/protocol/ChatProtocols":"ChatProtocols","../../network/protocol/TypeProtocols":"TypeProtocols"}],SociatyChatView:[function(e,t,o){"use strict";cc._RF.push(t,"5b0e0qLnJpIAqKyZMdJpHww","SociatyChatView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../Global/GameGlobal"),s=e("../../utils/List"),c=e("./SociatyModel"),l=e("../../network/protocol/TypeProtocols"),d=e("../../common/PlayerModule"),u=e("../../utils/GameUtils"),h=e("../../utils/ResourcesManager"),p=e("./SociatyCtrl"),f=e("../../common/EventConst"),g=e("../../modules/manager/EventManager"),m=e("../../utils/ConfigUtils"),_=e("../../utils/GameUtils"),y=e("../../network/protocol/MatchProtocols"),v=e("../../utils/GamePlatform"),C=e("../../network/ClientNetwork"),S=e("../../modules/base/GameView"),T=e("../../utils/GameUtils"),I=e("../../utils/GameTools"),N=e("../../utils/QQGameHallUtils"),b=e("../../utils/KSMinigameUtils"),w=e("../activity/ActivityModule"),E=e("../../common/NetworkProtocolCommon"),P=cc._decorator,R=P.ccclass,L=P.property,A=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.list=null,t.editBoxNode=null,t.emojiLayoutNode=null,t.battleLayoutNode=null,t.cooperationWaitNode=null,t.combatWaitNode=null,t.sendChatBtn=null,t.redEnvelopeNode=null,t._editboxString="",t._createBatleRoomType=0,t._roomId="",t._bCreateRoom=!1,t}return a(t,e),t.prototype.onLoad=function(){var e=this;this.list.node.active=!1,this.list.numItems=c.default.instance().m_sociatyChat.length,g.default.Instance.on(f.default.SyncSociatyChatMsg,function(){e.list.numItems=c.default.instance().m_sociatyChat.length,e.list.scrollTo(c.default.instance().m_sociatyChat.length-1,.05),e.list.node.active=!0},this),this.initEmojiLayoutInfo(),this.onRefreshChatCd(),this.schedule(this.onRefreshChatCd,1),C.ClientNetwork.getInstance().listenProtocol(y.MATCH_CLIENT_ENUM.P_Match_Duel_Fight,this.s_Match_Duel_Fight,this),C.ClientNetwork.getInstance().listenProtocol(y.MATCH_CLIENT_ENUM.P_Match_Duel_Cancel,this.s_Match_Duel_Cancel,this),g.default.Instance.on(f.default.SociatySyncBattleRoom,this.countdownRoomWait,this),g.default.Instance.on(f.default.SociatySyncChangeBattleRoom,function(){return e.list.updateAll()},this),g.default.Instance.on(f.default.SociatyRefreshRedEnvelopeEvent,function(){return e.onRefreshRedEnvelope()},this),this.onRefreshRedEnvelope(),this.schedule(function(){cc.isValid(e.node)&&c.default.instance().getSociatyRedEnvelopeLength()>0&&e.redEnvelopeNode&&cc.tween(e.redEnvelopeNode).to(.2,{angle:5}).to(.2,{angle:-5}).to(.2,{angle:0}).start()},3)},t.prototype.initEmojiLayoutInfo=function(){var e=[],t=m.default.getInstance().data["StaticData/ItemTableData"];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&6===t[o].type&&e.push(t[o]);for(var i=this.emojiLayoutNode,a=0;a<i.children.length;a++){var n=i.children[a];n.emojiId=e[a].id,h.default.loadSprite(e[a].icon,n.getComponent(cc.Sprite)),n.on(cc.Node.EventType.TOUCH_END,function(e){if(c.default.instance().SendChatCd>0)return r.G.StringManager.PopWorldString("chat_cd");p.default.request_C_Sociaty_Chat_Client({chatType:l.TYPE_CHAT.TYPE_CHAT_EXPRESSION,msg:e.target.emojiId.toString()}),i.parent.active=!1})}},t.prototype.onListRender=function(e,t){e.children.forEach(function(e){e.active=!1});var o=c.default.instance().m_sociatyChat[t];switch(o.m_chatType){case 1:this.systemMsgInfo(e,o.m_voChatLog);break;case 0:this.chatMsgInfo(e,o);break;case 2:this.battleMsgInfo(e,o.m_voChatFightLog)}},t.prototype.chatMsgInfo=function(e,t){var o,i=t.m_voChat,a=!1;1==i.roleID.equals(d.default.UUID)&&(a=!0),(o=1==a?e.getChildByName("self"):e.getChildByName("other")).children.forEach(function(e){e.active=!1}),o.active=!0;var n=o.getChildByName("player");n.active=!0,n.roleid=d.default.otherUUidTransformRoieId(i.roleID),u.setRemoteHeadIcon(i.headUrl,i.headID,n.getChildByName("icon").getComponent(cc.Sprite)),i.headFrameID<=0&&(i.headFrameID=200),h.default.loadSprite("ui/headFrame/frame_"+i.headFrameID,n.getChildByName("frame").getComponent(cc.Sprite)),I.default.registerTouchEvent(n,function(e){var t=S.default.getViewByName("MainSceneView");t&&t.view&&t.view.onCallGetRoleSimpleInfo(e.target.roleid)});var r=n.getChildByName("sociatyNameLyout");r.getChildByName("name").getComponent(cc.Label).string=i.nickName;var s=i.sociatyName.length>0?" ["+i.sociatyName+"]":"";switch(r.getChildByName("txt_union_name").getComponent(cc.Label).string=s,r.getChildByName("img_job20").active=!1,r.getChildByName("img_job30").active=!1,i.sociatyJob==l.SOCIATY_JOB.SOCIATY_JOB_OFFICIAL&&(r.getChildByName("img_job20").active=!0),i.sociatyJob==l.SOCIATY_JOB.SOCIATY_JOB_PRESIDENT&&(r.getChildByName("img_job30").active=!0),i.chatType){case l.TYPE_CHAT.TYPE_CHAT_TEXT:this.chatMsgTextInfo(o,i.chatText);break;case l.TYPE_CHAT.TYPE_CHAT_EXPRESSION:this.chatMsgEmojiInfo(o,i.chatText);break;case l.TYPE_CHAT.TYPE_CHAT_ROOMFIGHT:this.chatMsgBattleRoomInfo(o,t)}},t.prototype.chatMsgBattleRoomInfo=function(e,t){e.getChildByName("ppveNode").active=!1,e.getChildByName("machineryNode").active=!1,e.getChildByName("pvpNode").active=!1;var o=t.m_voChat;if(o.heros.size>0){var i=null;(i=e.getChildByName("ppveNode")).getChildByName("btn_join2").roomType=l.FIGHT_TYPE.FIGHT_TYPE_COOPERATION,e.parent.height=145,i&&(i.active=!0),1==t.m_bCloseRoom?(i.getChildByName("btn_join2").getComponent(cc.Button).interactable=!1,i.getChildByName("btn_join2").getComponent(cc.Button).enableAutoGrayEffect=!0,i.getChildByName("btn_join2").getChildByName("txt_join2").active=!1,i.getChildByName("btn_join2").getChildByName("txt_na2").active=!0):(i.getChildByName("btn_join2").getComponent(cc.Button).interactable=!0,i.getChildByName("btn_join2").getComponent(cc.Button).enableAutoGrayEffect=!1,i.getChildByName("btn_join2").getChildByName("txt_join2").active=!0,i.getChildByName("btn_join2").getChildByName("txt_na2").active=!1),i.getChildByName("btn_join2").roomId=o.chatText}else(i=e.getChildByName("pvpNode")).active=!0,1==t.m_bCloseRoom?(i.getChildByName("btn_join1").getComponent(cc.Button).interactable=!1,i.getChildByName("btn_join1").getComponent(cc.Button).enableAutoGrayEffect=!0,i.getChildByName("btn_join1").getChildByName("txt_join1").active=!1,i.getChildByName("btn_join1").getChildByName("txt_na1").active=!0):(i.getChildByName("btn_join1").getComponent(cc.Button).interactable=!0,i.getChildByName("btn_join1").getComponent(cc.Button).enableAutoGrayEffect=!1,i.getChildByName("btn_join1").getChildByName("txt_join1").active=!0,i.getChildByName("btn_join1").getChildByName("txt_na1").active=!1),i.getChildByName("btn_join1").roomId=o.chatText,i.getChildByName("btn_join1").roomType=l.FIGHT_TYPE.FIGHT_TYPE_DUEL_BATTLE,e.parent.height=145},t.prototype.chatMsgEmojiInfo=function(e,t){if(e.getChildByName("EmojiNode").active=!0,t.length>0){var o=m.default.getInstance().getItemByID(Number(t));e.getChildByName("EmojiNode").children[0].active=!1;var i=e.getChildByName("EmojiNode").children[1],a=m.default.getInstance().getResConfig(o.spineId).animation;cc.resources.load(a,sp.SkeletonData,function(e,t){e?console.log("load asset url:"+a+" faild!!!"):(i.getComponent(sp.Skeleton).skeletonData=t,i.getComponent(sp.Skeleton).setSkin("default"),i.getComponent(sp.Skeleton).setAnimation(0,"idle",!1))})}e.parent.height=130},t.prototype.chatMsgTextInfo=function(e,t){e.getChildByName("background").active=!0;var o=function(){var t=e.getChildByName("background").getComponent(cc.Layout),o=t.node.getChildByName("label").getComponent(cc.Label);o.node.width>518&&(o.overflow=cc.Label.Overflow.RESIZE_HEIGHT,o.node.width=518,o._forceUpdateRenderData(),t.updateLayout(),t.node.width=o.node.width+45)},i=e.getChildByName("background").getComponent(cc.Layout),a=i.node.getChildByName("label").getComponent(cc.Label);a.node.off(cc.Node.EventType.SIZE_CHANGED,o),a.node.on(cc.Node.EventType.SIZE_CHANGED,o),a.overflow=cc.Label.Overflow.NONE,a.string=t,a._forceUpdateRenderData(),i.updateLayout(),i.node.width=a.node.width+45,e.parent.height=i.node.height+45},t.prototype.systemMsgInfo=function(e,t){e.getChildByName("system").active=!0;var o;o=t.type==l.SOCIATY_LOG_TYPE.SOCIATY_LOG_TYPE_PLAYERENTER?"sociaty_chat_lvdi":t.type==l.SOCIATY_LOG_TYPE.SOCIATY_LOG_TYPE_PLAYERLEAVE||t.type==l.SOCIATY_LOG_TYPE.SOCIATY_LOG_TYPE_PLAYERKICK?"sociaty_chatdihui":"sociaty_chatzidi",h.default.loadSprite("ui/sociaty/image/"+o,e.getChildByName("system").getComponent(cc.Sprite));var i=t.logTime;Number(t.param2)!=l.SOCIATY_JOB.SOCIATY_JOB_OFFICIAL&&Number(t.param2)!=l.SOCIATY_JOB.SOCIATY_JOB_PRESIDENT&&Number(t.param2)!=l.SOCIATY_JOB.SOCIATY_JOB_MEMBER||(t.param2=r.G.StringManager.getWorldString("union_job_"+t.param2)),e.getChildByName("system").getChildByName("label").getComponent(cc.Label).string=function(e){var t=new Date(1e3*e);return t.getFullYear(),t.getMonth()+1+"\u6708"+t.getDate()+"\u65e5  "+(t.getHours()<10?"0"+t.getHours():t.getHours())+":"+(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+":"+(t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds())}.call(this,i)+"    "+r.G.StringManager.getWorldString("union_log_type_"+t.type,t.param1,t.param2),e.height=e.getChildByName("system").height+5},t.prototype.battleMsgInfo=function(e,t){var o=e.getChildByName("fight");o.active=!0,e.height=o.height+5;var i=t.winRoleID;t.players.forEach(function(e){if(1==e.roleID.equals(i)){var t=o.getChildByName("winPlayerNode");t.getComponent(cc.Label).string=e.nickName,t.children[0].children[0].getComponent(cc.Label).string=e.score.toString()}else{var a=o.getChildByName("losePlayerNode");a.getComponent(cc.Label).string=e.nickName,a.children[0].children[0].getComponent(cc.Label).string=e.score.toString()}})},t.prototype.onEditingReturnCallBack=function(e){e.string.length<=0||(this._editboxString=e.string)},t.prototype.onClickSendCallBack=function(){if(c.default.instance().SendChatCd>0)return r.G.StringManager.PopWorldString("chat_cd");if(this._editboxString=this.editBoxNode.getComponent(cc.EditBox).string,this._editboxString.length<=0)return r.G.StringManager.PopWorldString("chat_client_code1");if(v.GamePlatform.isQQGameRoom()){var e=this;N.QQGameHallUtils.Instance.chatFilterAsync(this._editboxString,N.QQGameHallUtils.CHAT_FILTER_SCENETYPE_MSG).then(function(t){p.default.request_C_Sociaty_Chat_Client({chatType:l.TYPE_CHAT.TYPE_CHAT_TEXT,msg:""==t?e._editboxString:t}),e.editBoxNode.getComponent(cc.EditBox).string="",e._editboxString=""})}else if(v.GamePlatform.isKuaishouMiniGame()){var t=this;b.KSMinigameUtils.Instance.chatFilterAsync(this._editboxString,b.KSMinigameUtils.CHAT_FILTER_SCENETYPE_MSG).then(function(e){1!=e?(p.default.request_C_Sociaty_Chat_Client({chatType:l.TYPE_CHAT.TYPE_CHAT_TEXT,msg:t._editboxString}),t.editBoxNode.getComponent(cc.EditBox).string="",t._editboxString=""):r.G.StringManager.PopStringOnce("\u5185\u5bb9\u542b\u6709\u8fdd\u89c4\u5185\u5bb9")})}else p.default.request_C_Sociaty_Chat_Client({chatType:l.TYPE_CHAT.TYPE_CHAT_TEXT,msg:this._editboxString}),this.editBoxNode.getComponent(cc.EditBox).string="",this._editboxString=""},t.prototype.onTouchEndCloseEmoji=function(e){this.node.getChildByName("btnlist").getChildByName("chat_emoji").getBoundingBoxToWorld().contains(e)||this.emojiLayoutNode.parent.getBoundingBoxToWorld().contains(e)||(this.emojiLayoutNode.parent.active=!1)},t.prototype.onClickEmojiCallBack=function(){0==this.emojiLayoutNode.parent.active?this.emojiLayoutNode.parent.active=!0:this.emojiLayoutNode.parent.active=!1},t.prototype.onClickTelescopingCallBack=function(){this.battleLayoutNode.active=!this.battleLayoutNode.active},t.prototype.onClickCoopCallBack=function(){var e=Number(T.getConfigIntValue("coop_score_limit"));return d.default.getRoleAttrValByKey(l.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE)<e?r.G.StringManager.PopWorldString(r.G.StringManager.getWorldString("coop_score_limit_tip",e)):c.default.instance().SendChatCd>0?r.G.StringManager.PopWorldString("chat_cd"):this._createBatleRoomType>0?r.G.StringManager.PopStringOnce(r.G.StringManager.getString("MATCH_ROOM_FAIL_HAVE")):d.default.getRoleInfoData().cooperationDayLeftNum<=0?r.G.StringManager.PopStringOnce(r.G.StringManager.getString("COOP_TIMES_NOTENOUGH")):void this.createFightRoom(l.FIGHT_TYPE.FIGHT_TYPE_COOPERATION)},t.prototype.onClickBattleCallBack=function(){return c.default.instance().SendChatCd>0?r.G.StringManager.PopWorldString("chat_cd"):this._createBatleRoomType>0?r.G.StringManager.PopString(r.G.StringManager.getString("MATCH_ROOM_FAIL_HAVE")):void this.createFightRoom(l.FIGHT_TYPE.FIGHT_TYPE_DUEL_BATTLE)},t.prototype.onClickCreateRedEnvelopeCallBack=function(){this.battleLayoutNode.active=!1,S.default.addPopView("ShopMainCtrl","SociatyCreateRedEnvelopeView","SociatyCreateRedEnvelopeView")},t.prototype.createFightRoom=function(e){if(w.default.isChickenDinnerMatching())return r.G.StringManager.PopString(r.G.StringManager.getString("CHICKENDINNER_MATCHING")),E.default.callRoleClientLog("CHICKENDINNER_MATCHING11"),void console.log("isChickenDinnerMatching code=11");var t=new y.C_Match_Duel_Fight;t.fightType=e,t.useRoom=0,t.params.push(_.getConfigVersion()),C.ClientNetwork.getInstance().Send(y.MATCH_CLIENT_ENUM.P_Match_Duel_Fight,t),this.battleLayoutNode.active=!1,this._bCreateRoom=!0,c.default.instance().SendChatCd=Number(T.getConfigIntValue("cd_union_chat"))},t.prototype.s_Match_Duel_Fight=function(e){e.resetPos();var t=new y.S_Match_Duel_Fight;if(t.read(e)){if(0!=t.errorcode)return this._createBatleRoomType=0,void(9===t.errorcode?r.G.StringManager.PopString(r.G.StringManager.getString("COOP_TIMES_NOTENOUGH")):13===t.errorcode?r.G.StringManager.PopString(r.G.StringManager.getString("MATCH_ROOM_FAIL_HAVE")):8089===t.errorcode?S.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:r.G.StringManager.getString("BATTLE_VERSION_NOT_MATCH"),confirmCb:function(){v.GamePlatform.isWechat()&&wx.exitMiniProgram()}}):r.G.StringManager.PopString(r.G.StringManager.getString("MATCH_ROOM_FAIL")));if(0==this._bCreateRoom)return;if(t.fightType==l.FIGHT_TYPE.FIGHT_TYPE_COOPERATION){var o=d.default.getBattleHeroCarData(d.default.fightHeroArrayIndex);p.default.request_C_Sociaty_Chat_Client({chatType:l.TYPE_CHAT.TYPE_CHAT_ROOMFIGHT,msg:t.roomID,heros:o})}else p.default.request_C_Sociaty_Chat_Client({chatType:l.TYPE_CHAT.TYPE_CHAT_ROOMFIGHT,msg:t.roomID});this._createBatleRoomType=t.fightType,this._roomId=t.roomID,this._bCreateRoom=!1}},t.prototype.countdownRoomWait=function(){var e=this;if(0!=this._createBatleRoomType&&1!=this.cooperationWaitNode.active&&1!=this.combatWaitNode.active){var t=null,o=0;if(this._createBatleRoomType==l.FIGHT_TYPE.FIGHT_TYPE_COOPERATION&&(this.cooperationWaitNode.active=!0,t=this.cooperationWaitNode.children[2].children[0].children[0]),this._createBatleRoomType==l.FIGHT_TYPE.FIGHT_TYPE_DUEL_BATTLE&&(this.combatWaitNode.active=!0,t=this.combatWaitNode.children[2].children[0].children[0]),t){var i=function(){return 0==t.parent.parent.parent.active?e.unschedule(i):(o++,t.getComponent(cc.Label).string=o.toString(),o>Number(T.getConfigIntValue("cd_union_fight"))?(r.G.StringManager.PopString(r.G.StringManager.getWorldString("sociaty_join_battle_tip")),e.onClickCancelRoomCallBack(),e.unschedule(i)):void 0)};this.unschedule(i),this.schedule(i,1),t.getComponent(cc.Label).string=o.toString()}}},t.prototype.onClickCancelRoomCallBack=function(){var e=new y.C_Match_Duel_Cancel;""!=this._roomId&&(e.roomID=this._roomId,e.longRoomID=this._roomId),C.ClientNetwork.getInstance().Send(y.MATCH_CLIENT_ENUM.P_Match_Duel_Cancel,e)},t.prototype.s_Match_Duel_Cancel=function(e){e.resetPos();var t=new y.S_Match_Duel_Cancel;t.read(e)&&(0==t.errorcode?(this._createBatleRoomType=0,this._roomId="",this.cooperationWaitNode.active=!1,this.combatWaitNode.active=!1):r.G.StringManager.PopString("\u5173\u95ed\u623f\u95f4\u5f02\u5e38 error "+t.errorcode))},t.prototype.onClickJoinRoomCallBack=function(e){var t=this;if(w.default.isChickenDinnerMatching())return r.G.StringManager.PopString(r.G.StringManager.getString("CHICKENDINNER_MATCHING")),E.default.callRoleClientLog("CHICKENDINNER_MATCHING12"),void console.log("isChickenDinnerMatching code=12");var o=function(e){if(e.roomId&&!(e.roomId.length<=0)&&e.roomType){var t=new y.C_Match_Duel_Fight;t.fightType=e.roomType,t.useRoom=0,t.params.push(_.getConfigVersion()),t.roomID=e.roomId,C.ClientNetwork.getInstance().Send(y.MATCH_CLIENT_ENUM.P_Match_Duel_Fight,t)}},i=e.target;if(i.roomType&&i.roomType==l.FIGHT_TYPE.FIGHT_TYPE_COOPERATION){var a=Number(T.getConfigIntValue("coop_score_limit"));if(d.default.getRoleAttrValByKey(l.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE)<a)return r.G.StringManager.PopWorldString(r.G.StringManager.getWorldString("coop_score_limit_tip",a));d.default.getRoleInfoData().cooperationDayLeftNum<=0?S.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:r.G.StringManager.getString("COOP_BATTLE_OVER_TIPS"),confirmCb:function(){o.call(t,i)}}):o.call(this,i)}else i.roomType&&i.roomType==l.FIGHT_TYPE.FIGHT_TYPE_MACHINARIUM||i.roomType&&i.roomType==l.FIGHT_TYPE.FIGHT_TYPE_DUEL_BATTLE&&o.call(this,i)},t.prototype.onRefreshChatCd=function(){var e=c.default.instance().SendChatCd;e>0?(this.sendChatBtn.interactable=!1,this.sendChatBtn.enableAutoGrayEffect=!0,this.sendChatBtn.node.children[2].active=!0,this.sendChatBtn.node.children[1].active=!1,this.sendChatBtn.node.children[2].getComponent(cc.Label).string=e+"s",c.default.instance().SendChatCd--):(this.sendChatBtn.interactable=!0,this.sendChatBtn.enableAutoGrayEffect=!1,this.sendChatBtn.node.children[2].active=!1,this.sendChatBtn.node.children[1].active=!0)},t.prototype.onRefreshRedEnvelope=function(){var e=c.default.instance().getSociatyRedEnvelopeLength();e>0?(this.redEnvelopeNode.active=!0,this.redEnvelopeNode.children[0].children[0].getComponent(cc.Label).string=e+"",this.redEnvelopeNode.children[0].active=1!=e):this.redEnvelopeNode.active=!1,g.default.Instance.emit(f.default.SociatyRefreshRedpoint)},t.prototype.onClickOpenRedEnvelopeCallBack=function(){var e=c.default.instance().getSociatyRedEnvelopeMap().keys().next().value;e&&p.default.c_Sociaty_RoleGetRedEnvelope(e)},t.prototype.onDestroy=function(){(this._createBatleRoomType>0||this._roomId.length>0)&&this.onClickCancelRoomCallBack(),g.default.Instance.off(this,f.default.SyncSociatyChatMsg),g.default.Instance.off(this,f.default.SociatyRefreshRedEnvelopeEvent),g.default.Instance.off(this,f.default.SociatySyncChangeBattleRoom),g.default.Instance.off(this,f.default.SociatySyncBattleRoom),this.unscheduleAllCallbacks(),C.ClientNetwork.getInstance().removeMessageTarget(this),this.unschedule(this.onRefreshChatCd)},n([L(s.default)],t.prototype,"list",void 0),n([L(cc.Node)],t.prototype,"editBoxNode",void 0),n([L(cc.Node)],t.prototype,"emojiLayoutNode",void 0),n([L(cc.Node)],t.prototype,"battleLayoutNode",void 0),n([L(cc.Node)],t.prototype,"cooperationWaitNode",void 0),n([L(cc.Node)],t.prototype,"combatWaitNode",void 0),n([L(cc.Button)],t.prototype,"sendChatBtn",void 0),n([L(cc.Node)],t.prototype,"redEnvelopeNode",void 0),n([R],t)}(cc.Component);o.default=A,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../common/EventConst":"EventConst","../../common/NetworkProtocolCommon":"NetworkProtocolCommon","../../common/PlayerModule":"PlayerModule","../../modules/base/GameView":"GameView","../../modules/manager/EventManager":"EventManager","../../network/ClientNetwork":"ClientNetwork","../../network/protocol/MatchProtocols":"MatchProtocols","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/ConfigUtils":"ConfigUtils","../../utils/GamePlatform":"GamePlatform","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils","../../utils/KSMinigameUtils":"KSMinigameUtils","../../utils/List":"List","../../utils/QQGameHallUtils":"QQGameHallUtils","../../utils/ResourcesManager":"ResourcesManager","../activity/ActivityModule":"ActivityModule","./SociatyCtrl":"SociatyCtrl","./SociatyModel":"SociatyModel"}],SociatyCourageMedalGainWayTableData:[function(e,t,o){"use strict";cc._RF.push(t,"e3d83IDxB1LA7NNq2W+EeBC","SociatyCourageMedalGainWayTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.SociatyCourageMedalGainWayTableData=void 0;var i=e("../TableReader"),a=function(){function e(){this.id=0,this.dayMedal=0,this.info=""}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.dayMedal=e.getNumber(),this.info=e.getString()},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"SociatyCourageMedalGainWayTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.SociatyCourageMedalGainWayTableData=a,cc._RF.pop()},{"../TableReader":"TableReader"}],SociatyCreateRedEnvelopeView:[function(e,t,o){"use strict";cc._RF.push(t,"74016XVe59LUofc9xrB/kbB","SociatyCreateRedEnvelopeView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=e("../../StaticData/SociatyRedEnvelopeTableData"),l=e("../../utils/ResourcesManager"),d=e("../../utils/ConfigUtils"),u=e("../../StaticData/RechargeTableData"),h=e("../../modules/base/GameView"),p=e("../../utils/GameTools"),f=cc._decorator,g=f.ccclass,m=f.property,_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.selfInfoNode=null,t.memberInfoNode=null,t.redEnvelopeInfoNode=null,t.curSelectRedEnvelopeIdx=0,t.sociatyRedEnvelopeKeyArry=[],t}return a(t,e),t.path=function(){return"ui/sociaty/prefab/SociatyCreateRedEnvelope"},t.prototype.start=function(){var e=this;c.SociatyRedEnvelopeTableData.getDataMap().forEach(function(t,o){e.sociatyRedEnvelopeKeyArry.push(o)}),this.initRedEnvelopeNodeInfo()},t.prototype.initRedEnvelopeNodeInfo=function(){var e=this;this.redEnvelopeInfoNode.children.forEach(function(t,o){t.hasEventListener(cc.Node.EventType.TOUCH_END)||t.on(cc.Node.EventType.TOUCH_END,function(t){e.chanegSelectRedEnvelope(t)});var i=c.SociatyRedEnvelopeTableData.getById(e.sociatyRedEnvelopeKeyArry[o]),a=u.RechargeTableData.getById(i.rechargeId);t.getChildByName("txt_label").getComponent(cc.Label).string="\uffe5"+(p.default.getRechargeMoneyByPlatform(a)/100).toString()}),this.chanegSelectRedEnvelope()},t.prototype.initSelfNodeInfo=function(){var e=c.SociatyRedEnvelopeTableData.getById(this.sociatyRedEnvelopeKeyArry[this.curSelectRedEnvelopeIdx]),t=u.RechargeTableData.getById(e.rechargeId),o=d.default.getInstance().getItemByID(t.prize[0].dropID).icon;l.default.loadSprite(o,this.selfInfoNode.children[1].getComponent(cc.Sprite)),this.selfInfoNode.children[2].getComponent(cc.Label).string=t.prize[0].dropNum+""},t.prototype.initMemberNodeInfo=function(){var e=c.SociatyRedEnvelopeTableData.getById(this.sociatyRedEnvelopeKeyArry[this.curSelectRedEnvelopeIdx]),t=d.default.getInstance().getItemByID(e.otherPrize.itemId).icon;l.default.loadSprite(t,this.memberInfoNode.children[1].getComponent(cc.Sprite)),this.memberInfoNode.children[2].getComponent(cc.Label).string=e.otherPrize.minCount+"~"+e.otherPrize.maxCount},t.prototype.chanegSelectRedEnvelope=function(e){var t=this;this.redEnvelopeInfoNode.children.forEach(function(e){e.children[0].active=!1}),e?this.redEnvelopeInfoNode.children.forEach(function(o,i){o==e.target&&(o.children[0].active=!0,t.curSelectRedEnvelopeIdx=i)}):(this.redEnvelopeInfoNode.children[0].children[0].active=!0,this.curSelectRedEnvelopeIdx=0),this.initSelfNodeInfo(),this.initMemberNodeInfo()},t.prototype.onClickSendCakkBack=function(){var e={rechargeID:c.SociatyRedEnvelopeTableData.getById(this.sociatyRedEnvelopeKeyArry[this.curSelectRedEnvelopeIdx]).rechargeId,rechargeNum:1};this.sendEvent("SendProtocolRecharge",e)},t.prototype.onHelpCallBack=function(){h.default.addPopView("BaseCtrl","SociatyRedEnvelopeTipView","SociatyRedEnvelopeTipView")},n([m(cc.Node)],t.prototype,"selfInfoNode",void 0),n([m(cc.Node)],t.prototype,"memberInfoNode",void 0),n([m(cc.Node)],t.prototype,"redEnvelopeInfoNode",void 0),n([s.Register_Class,g],t)}(r.default);o.default=_,cc._RF.pop()},{"../../StaticData/RechargeTableData":"RechargeTableData","../../StaticData/SociatyRedEnvelopeTableData":"SociatyRedEnvelopeTableData","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/base/GameView":"GameView","../../utils/ConfigUtils":"ConfigUtils","../../utils/GameTools":"GameTools","../../utils/ResourcesManager":"ResourcesManager"}],SociatyCreateView:[function(e,t,o){"use strict";cc._RF.push(t,"c2e36V+xtJDTKTALe50RsU3","SociatyCreateView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../common/PlayerModule"),s=e("../../Global/GameGlobal"),c=e("../../modules/base/BaseView"),l=e("../../modules/base/Decorators"),d=e("../../network/protocol/TypeProtocols"),u=e("../../utils/GameTools"),h=e("../../utils/GameUtils"),p=e("./SociatyCtrl"),f=e("../../common/EventConst"),g=e("../../modules/manager/EventManager"),m=e("./SociatyModel"),_=e("../../utils/GamePlatform"),y=e("../../utils/QQGameHallUtils"),v=e("../../utils/KSMinigameUtils"),C=cc._decorator,S=C.ccclass,T=C.property,I=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.m_sociaty_name=null,t.m_sociaty_conditions=null,t.m_sociaty_cscore=null,t.m_sociaty_manifesto=null,t.m_sociaty_consume=null,t.m_btn_left1=null,t.m_btn_right1=null,t.m_btn_left2=null,t.m_btn_right2=null,t.m_btn_create=null,t.m_btn_save=null,t.m_surplus_lab=null,t.inputSociatyName="",t.inputSociatyDeclaration="",t.m_conditions_type=1,t.m_enterScore=0,t}return a(t,e),t.path=function(){return"ui/sociaty/prefab/SociatyCreat"},t.prototype.onLoad=function(){var e=this;u.default.registerTouchEvent(this.m_btn_left1,this.onClickConditionHandler,this,"left"),u.default.registerTouchEvent(this.m_btn_right1,this.onClickConditionHandler,this,"right"),u.default.registerTouchEvent(this.m_btn_left2,this.onClickCoreHandler,this,"left"),u.default.registerTouchEvent(this.m_btn_right2,this.onClickCoreHandler,this,"right"),g.default.Instance.on(f.default.CloseCreateSociatyView,function(){return e.closeView()},this)},t.prototype.init=function(){this.m_sociaty_manifesto.maxLength=Number(h.getConfigIntValue("union_notice_number_words")),this.m_sociaty_name.maxLength=Number(h.getConfigIntValue("union_name_number_words"));var e=m.default.instance().SociatyData;e&&e.sociatyID.length>0?(this.m_btn_save.active=!0,this.m_btn_create.active=!1,this.m_enterScore=e.enterScore,this.m_conditions_type=e.enterType,this.m_sociaty_name.string=e.sociatyName,this.m_sociaty_manifesto.string=e.sociatyNotice,this.inputSociatyName=this.m_sociaty_name.string,this.inputSociatyDeclaration=this.m_sociaty_manifesto.string,this.m_surplus_lab.string=this.m_sociaty_manifesto.string.length+"/"+this.m_sociaty_manifesto.maxLength):(this.m_btn_save.active=!1,this.m_btn_create.active=!0,this.m_sociaty_manifesto.string="\u6b22\u8fce\u6765\u5230\u8054\u76df\uff01",this.m_surplus_lab.string="",this.inputSociatyDeclaration=this.m_sociaty_manifesto.string,this.m_sociaty_manifesto.enabled=!1),this.updateConditonText(this.m_conditions_type),this.m_sociaty_cscore.string=this.m_enterScore+"",this.m_sociaty_consume.string=h.getConfigIntValue("sociaty_create_cost_num")},t.prototype.onClickCreateCallBack=function(){if(r.default.getRoleAttrValByKey(d.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE)<Number(h.getConfigIntValue("sociaty_create_score")))return s.G.StringManager.PopString(s.G.StringManager.getString("SOCIATY_CREATE_TEXT",Number(h.getConfigIntValue("sociaty_create_score"))));if(this.inputSociatyName.length<=0)s.G.StringManager.PopWorldString("union_no_iput_name");else if(this.inputSociatyDeclaration.length<=0)s.G.StringManager.PopWorldString("union_no_iput_notice");else if(Number(this.m_sociaty_consume.string)>r.default.diamondNum)s.G.StringManager.PopWorldString("common_prompt_diamond_insufficient");else{var e=r.default.getRoleAttrValByKey(d.ROLE_ATTR_VALUES.ROLE_ATTR_BATTLE_PASS);if(!e||0==e)return s.G.StringManager.PopWorldString("union_create_limit_battlepass");p.default.c_Sociaty_RoleCreateSociaty({sociatyName:this.inputSociatyName,sociatyFlag:1,sociatyNotice:this.inputSociatyDeclaration,enterType:this.m_conditions_type,enterScore:this.m_enterScore})}},t.prototype.onInputSociatyName=function(e){return e.string.length<=0?this.inputSociatyName="":e.string.length>this.m_sociaty_name.maxLength?s.G.StringManager.getWorldString("union_create_name_len_max"):void(this.inputSociatyName=e.string)},t.prototype.onInputSocityDeclaration=function(e){return this.m_surplus_lab.string=e.string.length+"/"+this.m_sociaty_manifesto.maxLength,e.string.length<=0?this.inputSociatyDeclaration="":e.string.length>this.m_sociaty_manifesto.maxLength?s.G.StringManager.getWorldString("union_create_notice_len_max"):void(this.inputSociatyDeclaration=e.string)},t.prototype.onClickConditionHandler=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var o=e[0];"left"==o?this.m_conditions_type--:this.m_conditions_type++;var i=1,a=3;this.m_conditions_type<i&&(this.m_conditions_type=a),this.m_conditions_type>a&&(this.m_conditions_type=i),this.updateConditonText(this.m_conditions_type)},t.prototype.updateConditonText=function(e){var t=e,o="";t==d.SOCIATY_ENTER_TYPE.SOCIATY_ENTER_TYPE_FREE?o=s.G.StringManager.getWorldString("union_enter_type_free"):t==d.SOCIATY_ENTER_TYPE.SOCIATY_ENTER_TYPE_EXAMINE?o=s.G.StringManager.getWorldString("union_enter_type_examine"):t==d.SOCIATY_ENTER_TYPE.SOCIATY_ENTER_TYPE_FORBID&&(o=s.G.StringManager.getWorldString("union_enter_type_forbid")),this.m_sociaty_conditions.string=o},t.prototype.onClickCoreHandler=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var o=e[0],i=Number(h.getConfigIntValue("union_enterScore_add")),a=Number(h.getConfigIntValue("union_enterScore_min")),n=Number(h.getConfigIntValue("union_enterScore_max"));"left"==o?this.m_enterScore-=i:this.m_enterScore+=i,this.m_enterScore<a&&(this.m_enterScore=n),this.m_enterScore>n&&(this.m_enterScore=a),this.m_sociaty_cscore.string=this.m_enterScore+""},t.prototype.onClickSaveCallBack=function(){if(this.inputSociatyName.length<=0)s.G.StringManager.PopWorldString("union_no_iput_name");else if(this.inputSociatyDeclaration.length<=0)s.G.StringManager.PopWorldString("union_no_iput_notice");else{if(r.default.getRoleAttrValByKey(d.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE)<Number(h.getConfigIntValue("sociaty_change_declaration_limit")))return s.G.StringManager.PopString(s.G.StringManager.getString("SOCIATY_CREATE_TEXT1",Number(h.getConfigIntValue("sociaty_change_declaration_limit"))));if(_.GamePlatform.isQQGameRoom()){var e=this;y.QQGameHallUtils.Instance.chatFilterAsync(this.inputSociatyName,y.QQGameHallUtils.CHAT_FILTER_SCENETYPE_NAME).then(function(t){""==t||t==e.inputSociatyName?p.default.c_Sociaty_RoleModifySociaty({sociatyName:e.inputSociatyName,sociatyFlag:1,sociatyNotice:e.inputSociatyDeclaration,enterType:e.m_conditions_type,enterScore:e.m_enterScore}):s.G.StringManager.PopWorldString("creat_sociaty_error7")})}else if(_.GamePlatform.isKuaishouMiniGame()){var t=this;v.KSMinigameUtils.Instance.chatFilterAsync(this.inputSociatyName,v.KSMinigameUtils.CHAT_FILTER_SCENETYPE_NAME).then(function(e){1!=e?p.default.c_Sociaty_RoleModifySociaty({sociatyName:t.inputSociatyName,sociatyFlag:1,sociatyNotice:t.inputSociatyDeclaration,enterType:t.m_conditions_type,enterScore:t.m_enterScore}):s.G.StringManager.PopStringOnce("\u5185\u5bb9\u542b\u6709\u8fdd\u89c4\u5185\u5bb9")})}else p.default.c_Sociaty_RoleModifySociaty({sociatyName:this.inputSociatyName,sociatyFlag:1,sociatyNotice:this.inputSociatyDeclaration,enterType:this.m_conditions_type,enterScore:this.m_enterScore})}},t.prototype.doSendModifySociaty=function(){p.default.c_Sociaty_RoleModifySociaty({sociatyName:this.inputSociatyName,sociatyFlag:1,sociatyNotice:this.inputSociatyDeclaration,enterType:this.m_conditions_type,enterScore:this.m_enterScore})},t.prototype.onDestroy=function(){g.default.Instance.off(this,f.default.CloseCreateSociatyView)},n([T(cc.EditBox)],t.prototype,"m_sociaty_name",void 0),n([T(cc.Label)],t.prototype,"m_sociaty_conditions",void 0),n([T(cc.Label)],t.prototype,"m_sociaty_cscore",void 0),n([T(cc.EditBox)],t.prototype,"m_sociaty_manifesto",void 0),n([T(cc.Label)],t.prototype,"m_sociaty_consume",void 0),n([T(cc.Node)],t.prototype,"m_btn_left1",void 0),n([T(cc.Node)],t.prototype,"m_btn_right1",void 0),n([T(cc.Node)],t.prototype,"m_btn_left2",void 0),n([T(cc.Node)],t.prototype,"m_btn_right2",void 0),n([T(cc.Node)],t.prototype,"m_btn_create",void 0),n([T(cc.Node)],t.prototype,"m_btn_save",void 0),n([T(cc.Label)],t.prototype,"m_surplus_lab",void 0),n([l.Register_Class,S],t)}(c.default);o.default=I,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../common/EventConst":"EventConst","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/manager/EventManager":"EventManager","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/GamePlatform":"GamePlatform","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils","../../utils/KSMinigameUtils":"KSMinigameUtils","../../utils/QQGameHallUtils":"QQGameHallUtils","./SociatyCtrl":"SociatyCtrl","./SociatyModel":"SociatyModel"}],SociatyCtrl:[function(e,t,o){"use strict";cc._RF.push(t,"3249eTMiDxC+6XH3d1RAkkf","SociatyCtrl"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../network/ClientNetwork"),a=e("../../network/protocol/SociatyProtocols"),n=e("./SociatyModel"),r=e("../../common/EventConst"),s=e("../../modules/manager/EventManager"),c=e("../../Global/GameGlobal"),l=e("../../modules/base/GameView"),d=e("../../utils/ResourcesManager"),u=e("../../network/protocol/long"),h=e("../../network/protocol/TypeProtocols"),p=e("../../network/protocol/ChatProtocols"),f=e("../../network/protocol/BaseProtocols"),g=e("../../utils/GameUtils"),m=e("../../modules/manager/ViewManager"),_=e("../../common/PlayerModule"),y=e("../../network/protocol/ActivityProtocols"),v=e("../../utils/GameTools"),C=e("../../utils/GamePlatform"),S=e("../../utils/DalanReportUtils"),T=e("../../utils/RewardedVideoUnitIdConst"),I=function(){function e(){}return e.registerSociatyProtocol=function(){i.ClientNetwork.getInstance().listenProtocol(a.SOCIATY_CLIENT_ENUM.P_Sociaty_SynData,this.s_sociaty_synData,this),i.ClientNetwork.getInstance().listenProtocol(a.SOCIATY_CLIENT_ENUM.P_Sociaty_RoleGetRecommendSociaty,this.s_Sociaty_RoleGetRecommendSociaty,this),i.ClientNetwork.getInstance().listenProtocol(a.SOCIATY_CLIENT_ENUM.P_Sociaty_RoleGetSociatyData,this.s_Sociaty_RoleGetSociatyData,this),i.ClientNetwork.getInstance().listenProtocol(a.SOCIATY_CLIENT_ENUM.P_Sociaty_RoleCreateSociaty,this.s_Sociaty_RoleCreateSociaty,this),i.ClientNetwork.getInstance().listenProtocol(a.SOCIATY_CLIENT_ENUM.P_Sociaty_RoleGetInviteData,this.s_Sociaty_RoleGetInviteData,this),i.ClientNetwork.getInstance().listenProtocol(a.SOCIATY_CLIENT_ENUM.P_Sociaty_RoleJoinSociaty,this.s_Sociaty_RoleJoinSociaty,this),i.ClientNetwork.getInstance().listenProtocol(p.CHAT_CLIENT_ENUM.P_Chat_Client,this.sSociatyChatClient,this),i.ClientNetwork.getInstance().listenProtocol(p.CHAT_CLIENT_ENUM.P_Chat_ToClient,this.sSociatyChatToClient,this),i.ClientNetwork.getInstance().listenProtocol(a.SOCIATY_CLIENT_ENUM.P_Sociaty_SociatyAddLog,this.sSociatySociatyaddlog,this),i.ClientNetwork.getInstance().listenProtocol(a.SOCIATY_CLIENT_ENUM.P_Sociaty_SendFightLog,this.sSociatySendfightlog,this),i.ClientNetwork.getInstance().listenProtocol(a.SOCIATY_CLIENT_ENUM.P_Sociaty_RoleGetChatData,this.sSociatyRolegetchatdata,this),i.ClientNetwork.getInstance().listenProtocol(a.SOCIATY_CLIENT_ENUM.P_Sociaty_RoleModifySociaty,this.s_Sociaty_RoleModifySociaty,this),i.ClientNetwork.getInstance().listenProtocol(a.SOCIATY_CLIENT_ENUM.P_Sociaty_RoleLeaveSociaty,this.s_Sociaty_RoleLeaveSociaty,this),i.ClientNetwork.getInstance().listenProtocol(a.SOCIATY_CLIENT_ENUM.P_Sociaty_RoleDonate,this.s_Sociaty_RoleDonate,this),i.ClientNetwork.getInstance().listenProtocol(a.SOCIATY_CLIENT_ENUM.P_Sociaty_RoleGetSociatyApplyData,this.s_Sociaty_RoleGetSociatyApplyData,this),i.ClientNetwork.getInstance().listenProtocol(a.SOCIATY_CLIENT_ENUM.P_Sociaty_RoleDispossApplyList,this.s_Sociaty_RoleDispossApplyList,this),i.ClientNetwork.getInstance().listenProtocol(a.SOCIATY_CLIENT_ENUM.P_Sociaty_RoleInvite,this.s_Sociaty_RoleInvite,this),i.ClientNetwork.getInstance().listenProtocol(a.SOCIATY_CLIENT_ENUM.P_Sociaty_RoleChangeJob,this.s_Sociaty_RoleChangeJob,this),i.ClientNetwork.getInstance().listenProtocol(a.SOCIATY_CLIENT_ENUM.P_Sociaty_SynRoleJobChange,this.s_Sociaty_SynRoleJobChange,this),i.ClientNetwork.getInstance().listenProtocol(a.SOCIATY_CLIENT_ENUM.P_Sociaty_RoleKickPlayer,this.s_Sociaty_RoleKickPlayer,this),i.ClientNetwork.getInstance().listenProtocol(p.CHAT_CLIENT_ENUM.P_Chat_CloseFightRoom,this.s_Chat_CloseFightRoom,this),i.ClientNetwork.getInstance().listenProtocol(a.SOCIATY_CLIENT_ENUM.P_Sociaty_RoleDispossInviteList,this.s_Sociaty_RoleDispossInviteList,this),i.ClientNetwork.getInstance().listenProtocol(a.SOCIATY_CLIENT_ENUM.P_Sociaty_RoleGetSociatyBoxData,this.s_Sociaty_RoleGetSociatyBoxData,this),i.ClientNetwork.getInstance().listenProtocol(a.SOCIATY_CLIENT_ENUM.P_Sociaty_RoleReceiveSociatyBoxPrize,this.s_Sociaty_RoleReceiveSociatyBoxPrize,this),i.ClientNetwork.getInstance().listenProtocol(a.SOCIATY_CLIENT_ENUM.P_Sociaty_RoleGetRedEnvelope,this.s_Sociaty_RoleGetRedEnvelope,this),i.ClientNetwork.getInstance().listenProtocol(a.SOCIATY_CLIENT_ENUM.P_Sociaty_RoleGetRankListData,this.s_Sociaty_RoleGetRankListData,this),i.ClientNetwork.getInstance().listenProtocol(y.ACTIVITY_CLIENT_ENUM.P_Activity_SyncSociatyWarData,this.s_Activity_SyncSociatyWarData,this),i.ClientNetwork.getInstance().listenProtocol(y.ACTIVITY_CLIENT_ENUM.P_Activity_SociatyWarRelive,this.s_Activity_SociatyWarRelive,this),i.ClientNetwork.getInstance().listenProtocol(y.ACTIVITY_CLIENT_ENUM.P_Activity_ReceiveSociatyWarWinNumPrize,this.s_Activity_ReceiveSociatyWarWinNumPrize,this),i.ClientNetwork.getInstance().listenProtocol(a.SOCIATY_CLIENT_ENUM.P_Sociaty_RoleGetAuctionData,this.s_Sociaty_RoleGetAuctionData,this),i.ClientNetwork.getInstance().listenProtocol(a.SOCIATY_CLIENT_ENUM.P_Sociaty_RoleSyncAuctionData,this.s_Sociaty_RoleSyncAuctionData,this),i.ClientNetwork.getInstance().listenProtocol(a.SOCIATY_CLIENT_ENUM.P_Sociaty_RoleAuction,this.s_Sociaty_RoleAuction,this),i.ClientNetwork.getInstance().listenProtocol(a.SOCIATY_CLIENT_ENUM.P_Sociaty_RoleFocus,this.s_Sociaty_RoleFocus,this),i.ClientNetwork.getInstance().listenProtocol(a.SOCIATY_CLIENT_ENUM.P_Sociaty_RoleDirectBuy,this.s_Sociaty_RoleDirectBuy,this)},e.s_sociaty_synData=function(e){e.resetPos();var t=new a.S_Sociaty_SynData;if(t.read(e)){var o=!1;Number(t.playerData.sociatyID)!=n.default.instance().SociatyPlayerData.sociatyID&&(o=!0);var i=n.default.instance().bInitiativeExit;if(n.default.instance().SociatyPlayerData=t.playerData,Number(t.playerData.sociatyID)>0)s.default.Instance.emit(r.default.CallRoleGetSociatyData),s.default.Instance.emit(r.default.SociatyRefreshRedEnvelopeEvent),(d=l.default.getViewByName("NotJoinedSociatyview"))&&d.view&&l.default.addPopView("BaseCtrl","SociatyJoinSuccessView","SociatyJoinSuccessView"),s.default.Instance.emit(r.default.SociatyRefreshContributionEvent);else{var d;(d=l.default.getViewByName("SociatyMainView"))&&d.view&&(m.default.closeAllPopView(),0==i&&c.G.StringManager.PopWorldString("sociaty_exit_tip0"));var u=l.default.getViewByName("SociatyJoinSuccessView");u&&u.view&&u.view.closeView(),s.default.Instance.emit(r.default.SociatyRefreshUnreadChatEvent)}1==o&&s.default.Instance.emit(r.default.SociatyRefreshRedpoint)}},e.c_Sociaty_RoleGetRecommendSociaty=function(){var e=new a.C_Sociaty_RoleGetRecommendSociaty;i.ClientNetwork.getInstance().Send(a.SOCIATY_CLIENT_ENUM.P_Sociaty_RoleGetRecommendSociaty,e)},e.s_Sociaty_RoleGetRecommendSociaty=function(e){e.resetPos();var t=new a.S_Sociaty_RoleGetRecommendSociaty;if(t.read(e))if(t.errorcode==a.ErrorCode_Sociaty_RoleGetRecommendSociaty.ErrorCode_Sociaty_RoleGetRecommendSociaty_Success)n.default.instance().SociatyRecommendedList=t.sociatys,s.default.Instance.emit(r.default.RecommendSociatyEvent,t.sociatys);else switch(t.errorcode){case a.ErrorCode_Sociaty_RoleGetRecommendSociaty.ErrorCode_Sociaty_RoleGetRecommendSociaty_Success:break;case a.ErrorCode_Sociaty.ErrorCode_Sociaty_ActiveLeaveSociaty:c.G.StringManager.PopWorldString("sociaty_recommend_leave");break;case a.ErrorCode_Sociaty.ErrorCode_Sociaty_PassiveLeaveSociaty:c.G.StringManager.PopWorldString("sociaty_recommend_passive_leave");break;default:c.G.StringManager.PopString("sociaty_rolegetrecommendsociaty_error:"+t.errorcode)}},e.c_Sociaty_RoleGetSociatyData=function(e){if(e.length<=0)return c.G.StringManager.PopWorldString("union_create_name_len_null");var t=new a.C_Sociaty_RoleGetSociatyData;t.sociatyID=e,i.ClientNetwork.getInstance().Send(a.SOCIATY_CLIENT_ENUM.P_Sociaty_RoleGetSociatyData,t)},e.s_Sociaty_RoleGetSociatyData=function(e){e.resetPos();var t=new a.S_Sociaty_RoleGetSociatyData;if(t.read(e))if(console.log("SociatyCtrl, Sociaty_RoleGetSociatyData, \u8054\u76df\u4fe1\u606fdata=",t),t.errorcode==a.ErrorCode_Sociaty_RoleGetSociatyData.ErrorCode_Sociaty_RoleGetSociatyData_Success){var o=l.default.getViewByName("SociatySearchView");o&&o.view&&o.view.closeView(),t.sociatyData.sociatyID==n.default.instance().SociatyPlayerData.sociatyID?(1==n.default.instance().bPopSociatyInfoView?l.default.addPopView("BaseCtrl","SociatyInfoView","SociatyInfoView",{data:t.sociatyData}):(n.default.instance().SociatyData=t.sociatyData,s.default.Instance.emit(r.default.RefreshSociatyInfo)),n.default.instance().m_sociatyChat.length<=0?this.request_C_Sociaty_RoleGetChatData():s.default.Instance.emit(r.default.SyncSociatyChatMsg),s.default.Instance.emit(r.default.SociatySyncJoinSuccessEvent,t.sociatyData)):1==n.default.instance().bPopSociatyInfoView&&l.default.addPopView("BaseCtrl","SociatyInfoView","SociatyInfoView",{data:t.sociatyData})}else n.default.instance().bPopSociatyInfoView=!1,t.errorcode==a.ErrorCode_Sociaty_RoleGetSociatyData.ErrorCode_Sociaty_RoleGetSociatyData_NoSociaty?c.G.StringManager.PopWorldString("click_union_server_error2"):t.errorcode==a.ErrorCode_Sociaty_RoleGetSociatyData.ErrorCode_Sociaty_RoleGetSociatyData_Failed?c.G.StringManager.PopWorldString("click_union_server_error3"):c.G.StringManager.PopString("S_Sociaty_RoleGetSociatyData error "+t.errorcode)},e.c_Sociaty_RoleCreateSociaty=function(e){var t=new a.C_Sociaty_RoleCreateSociaty;t.enterScore=e.enterScore,t.enterType=e.enterType,t.sociatyFlag=e.sociatyFlag,t.sociatyName=e.sociatyName,t.sociatyNotice=e.sociatyNotice,i.ClientNetwork.getInstance().Send(a.SOCIATY_CLIENT_ENUM.P_Sociaty_RoleCreateSociaty,t)},e.s_Sociaty_RoleCreateSociaty=function(e){e.resetPos();var t=new a.S_Sociaty_RoleCreateSociaty;if(t.read(e))if(t.errorcode==a.ErrorCode_Sociaty_RoleCreateSociaty.ErrorCode_Sociaty_RoleCreateSociaty_Success)s.default.Instance.emit(r.default.CloseNotJoinedSociatyView),s.default.Instance.emit(r.default.CloseCreateSociatyView);else switch(t.errorcode){case a.ErrorCode_Sociaty.ErrorCode_Sociaty_NameLen:case a.ErrorCode_Sociaty_RoleCreateSociaty.ErrorCode_Sociaty_RoleCreateSociaty_NameLen:c.G.StringManager.PopString(c.G.StringManager.getWorldString("creat_sociaty_error6"));break;case a.ErrorCode_Sociaty.ErrorCode_Sociaty_NameHasFilterWords:case a.ErrorCode_Sociaty_RoleCreateSociaty.ErrorCode_Sociaty_RoleCreateSociaty_NameHasFilterWords:c.G.StringManager.PopString(c.G.StringManager.getWorldString("creat_sociaty_error7"));break;case a.ErrorCode_Sociaty.ErrorCode_Sociaty_NoticeLen:case a.ErrorCode_Sociaty_RoleCreateSociaty.ErrorCode_Sociaty_RoleCreateSociaty_NoticeLen:c.G.StringManager.PopString(c.G.StringManager.getWorldString("creat_sociaty_error8"));break;case a.ErrorCode_Sociaty.ErrorCode_Sociaty_NoticeHasFilterWords:case a.ErrorCode_Sociaty_RoleCreateSociaty.ErrorCode_Sociaty_RoleCreateSociaty_NoticeHasFilterWords:c.G.StringManager.PopString(c.G.StringManager.getWorldString("creat_sociaty_error9"));break;case a.ErrorCode_Sociaty_RoleCreateSociaty.ErrorCode_Sociaty_RoleCreateSociaty_NoCost:c.G.StringManager.PopString(c.G.StringManager.getWorldString("creat_sociaty_error10"));break;case a.ErrorCode_Sociaty_RoleCreateSociaty.ErrorCode_Sociaty_RoleCreateSociaty_HaveSameName:c.G.StringManager.PopString(c.G.StringManager.getWorldString("creat_sociaty_error11"));break;default:c.G.StringManager.PopString("S_Sociaty_RoleCreateSociaty error "+t.errorcode)}},e.c_Sociaty_RoleModifySociaty=function(e){var t=new a.C_Sociaty_RoleModifySociaty;t.enterScore=e.enterScore,t.enterType=e.enterType,t.sociatyFlag=e.sociatyFlag,t.sociatyName=e.sociatyName,t.sociatyNotice=e.sociatyNotice,i.ClientNetwork.getInstance().Send(a.SOCIATY_CLIENT_ENUM.P_Sociaty_RoleModifySociaty,t)},e.s_Sociaty_RoleModifySociaty=function(e){e.resetPos();var t=new a.S_Sociaty_RoleModifySociaty;if(t.read(e))if(t.errorcode==a.ErrorCode_Sociaty_RoleModifySociaty.ErrorCode_Sociaty_RoleModifySociaty_Success){n.default.instance().SociatyData=t.sociatyData;var o=l.default.getViewByName("SociatyCreateView");o&&o.view&&o.view.closeView(),s.default.Instance.emit(r.default.RefreshSociatyInfo)}else switch(t.errorcode){case a.ErrorCode_Sociaty_RoleModifySociaty.ErrorCode_Sociaty_RoleModifySociaty_NameLen:case a.ErrorCode_Sociaty.ErrorCode_Sociaty_NameLen:c.G.StringManager.PopString(c.G.StringManager.getWorldString("creat_sociaty_error6"));break;case a.ErrorCode_Sociaty.ErrorCode_Sociaty_NameHasFilterWords:case a.ErrorCode_Sociaty_RoleModifySociaty.ErrorCode_Sociaty_RoleModifySociaty_NameHasFilterWords:c.G.StringManager.PopString(c.G.StringManager.getWorldString("creat_sociaty_error7"));break;case a.ErrorCode_Sociaty.ErrorCode_Sociaty_NoticeLen:case a.ErrorCode_Sociaty_RoleModifySociaty.ErrorCode_Sociaty_RoleModifySociaty_NoticeLen:c.G.StringManager.PopString(c.G.StringManager.getWorldString("creat_sociaty_error8"));break;case a.ErrorCode_Sociaty.ErrorCode_Sociaty_NoticeHasFilterWords:case a.ErrorCode_Sociaty_RoleModifySociaty.ErrorCode_Sociaty_RoleModifySociaty_NoticeHasFilterWords:c.G.StringManager.PopString(c.G.StringManager.getWorldString("creat_sociaty_error9"));break;case a.ErrorCode_Sociaty_RoleModifySociaty.ErrorCode_Sociaty_RoleModifySociaty_HaveSameName:c.G.StringManager.PopString(c.G.StringManager.getWorldString("creat_sociaty_error11"));break;default:c.G.StringManager.PopString("S_Sociaty_RoleModifySociaty error "+t.errorcode)}},e.c_Sociaty_RoleGetInviteData=function(){var e=new a.C_Sociaty_RoleGetInviteData;i.ClientNetwork.getInstance().Send(a.SOCIATY_CLIENT_ENUM.P_Sociaty_RoleGetInviteData,e)},e.s_Sociaty_RoleGetInviteData=function(e){e.resetPos();var t=new a.S_Sociaty_RoleGetInviteData;t.read(e)&&(t.errorcode==a.ErrorCode_Sociaty_RoleGetInviteData.ErrorCode_Sociaty_RoleGetInviteData_Success?(n.default.instance().clearSociatyInviteData(),t.invite.forEach(function(e){n.default.instance().addSociatyInviteData(e,e.sociatyID)}),s.default.Instance.emit(r.default.syncSociatyInvitedData,t.invite),s.default.Instance.emit(r.default.SociatyRefreshRedpoint)):c.G.StringManager.PopString("S_Sociaty_RoleGetInviteData error "+t.errorcode))},e.c_Sociaty_RoleJoinSociaty=function(e){var t=new a.C_Sociaty_RoleJoinSociaty;t.sociatyID=e,i.ClientNetwork.getInstance().Send(a.SOCIATY_CLIENT_ENUM.P_Sociaty_RoleJoinSociaty,t)},e.s_Sociaty_RoleJoinSociaty=function(e){e.resetPos();var t=new a.S_Sociaty_RoleJoinSociaty;if(t.read(e))if(t.errorcode==a.ErrorCode_Sociaty_RoleJoinSociaty.ErrorCode_Sociaty_RoleJoinSociaty_Success)if(t.enterType==h.SOCIATY_ENTER_TYPE.SOCIATY_ENTER_TYPE_FREE)l.default.addPopView("BaseCtrl","SociatyJoinSuccessView","SociatyJoinSuccessView",{data:t.sociatyData});else{var o=l.default.getViewByName("NotJoinedSociatyview");o&&o.view&&o.view.onRefreshSingleListItem(t.sociatyID);var i=l.default.getViewByName("SociatyInfoView");i&&i.view&&i.view.onChangeApplyBtnState(!0),c.G.StringManager.PopString(c.G.StringManager.getWorldString("join_sociaty_client_error1"))}else switch(t.errorcode){case a.ErrorCode_Sociaty.ErrorCode_Sociaty_HaveMaxPlayer:c.G.StringManager.PopWorldString("sociaty_max_people");break;case a.ErrorCode_Sociaty.ErrorCode_Sociaty_NoEnterScore:c.G.StringManager.PopWorldString("sociaty_no_enter_score");break;case a.ErrorCode_Sociaty.ErrorCode_Sociaty_ForbidEnter:c.G.StringManager.PopWorldString("sociaty_forbid_enter");break;case a.ErrorCode_Sociaty.ErrorCode_Sociaty_ActiveLeaveSociaty:c.G.StringManager.PopWorldString("sociaty_active_leave");break;case a.ErrorCode_Sociaty.ErrorCode_Sociaty_PassiveLeaveSociaty:c.G.StringManager.PopWorldString("sociaty_active_passive_leave");break;case a.ErrorCode_Sociaty_RoleJoinSociaty.ErrorCode_Sociaty_RoleJoinSociaty_HaveSociaty:c.G.StringManager.PopWorldString("change_apply_error1");break;case a.ErrorCode_Sociaty_RoleJoinSociaty.ErrorCode_Sociaty_RoleJoinSociaty_NoSociaty:c.G.StringManager.PopWorldString("click_union_server_error2");break;case a.ErrorCode_Sociaty_RoleJoinSociaty.ErrorCode_Sociaty_RoleJoinSociaty_ServerGroup_Error:c.G.StringManager.PopWorldString("sociaty_error_10");break;default:c.G.StringManager.PopString("S_Sociaty_RoleJoinSociaty error "+t.errorcode)}},e.request_C_Sociaty_RoleGetChatData=function(){var e=new a.C_Sociaty_RoleGetChatData;i.ClientNetwork.getInstance().Send(a.SOCIATY_CLIENT_ENUM.P_Sociaty_RoleGetChatData,e)},e.sSociatyChatClient=function(e){e.resetPos();var t=new p.S_Chat_Client;if(t.read(e))if(0===t.errorcode)s.default.Instance.emit(r.default.SociatySyncBattleRoom);else switch(t.errorcode){case p.ErrorCode_Chat_Client.ErrorCode_Chat_Client_Failed:c.G.StringManager.PopString("\u53d1\u9001\u5931\u8d25");break;case p.ErrorCode_Chat_Client.ErrorCode_Chat_Client_ForbidChat:c.G.StringManager.PopString("\u60a8\u5df2\u88ab\u7981\u8a00");break;case p.ErrorCode_Chat_Client.ErrorCode_Chat_Client_LenError:c.G.StringManager.PopString("\u5185\u5bb9\u6587\u5b57\u8fc7\u957f");break;case p.ErrorCode_Chat_Client.ErrorCode_Chat_Client_HasFilterWords:c.G.StringManager.PopString(c.G.StringManager.getString("SEND_MESSAGE_FAIL"))}},e.sSociatyChatToClient=function(e){e.resetPos();var t=new p.S_Chat_ToClient;if(t.read(e)&&t._data&&t._data.channel==h.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_SOCIATY){var o=_.default.getBlackFriendsData(),i={};o&&o.size>=0&&(i=Array.from(o.keys()));for(var a=0;a<i.length;a++)if(1==o.get(i[a]).base.roleID.equals(t._data.roleID))return;var c=n.default.instance().m_sociatyChat;if(c&&c.length>0)for(a=0;a<c.length;a++)if(c[a].m_voChat&&c[a].m_voChat.chatText==t._data.chatText&&c[a].m_voChat.chatType==h.TYPE_CHAT.TYPE_CHAT_ROOMFIGHT)return!0;n.default.instance().addSociatyChat(t._data),s.default.Instance.emit(r.default.SyncSociatyChatMsg),s.default.Instance.emit(r.default.SociatyRefreshUnreadChatEvent),s.default.Instance.emit(r.default.SyncMachineryCityChatMsgEvent,t._data)}},e.sSociatySociatyaddlog=function(e){e.resetPos();var t=new a.S_Sociaty_SociatyAddLog;t.read(e)&&(n.default.instance().addSociatyChat(null,t.logData),s.default.Instance.emit(r.default.SyncSociatyChatMsg),s.default.Instance.emit(r.default.SociatyRefreshUnreadChatEvent))},e.sSociatySendfightlog=function(e){e.resetPos();var t=new a.S_Sociaty_SendFightLog;t.read(e)&&(n.default.instance().addSociatyChat(null,null,t.logData),s.default.Instance.emit(r.default.SyncSociatyChatMsg),s.default.Instance.emit(r.default.SociatyRefreshUnreadChatEvent))},e.sSociatyRolegetchatdata=function(e){e.resetPos();var t=new a.S_Sociaty_RoleGetChatData;if(t.read(e))if(0==t.errorcode)n.default.instance().syncSociatyChatData(t),s.default.Instance.emit(r.default.SyncSociatyChatMsg);else switch(t.errorcode){case a.ErrorCode_Sociaty_RoleGetChatData.ErrorCode_Sociaty_RoleGetChatData_NoPlayer:c.G.StringManager.PopWorldString("sociaty_error_01");break;case a.ErrorCode_Sociaty_RoleGetChatData.ErrorCode_Sociaty_RoleGetChatData_NoSCPlayer:c.G.StringManager.PopWorldString("sociaty_error_02");break;case a.ErrorCode_Sociaty_RoleGetChatData.ErrorCode_Sociaty_RoleGetChatData_NoSociaty:c.G.StringManager.PopWorldString("change_job_error10");break;default:c.G.StringManager.PopString("S_Sociaty_RoleGetChatData_error:"+t.errorcode)}},e.request_C_Sociaty_Chat_Client=function(e){var t=new p.C_Chat_Client;if(t.channel=h.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_SOCIATY,t.isSendSelf=!1,t.receiveRoleID=u.fromNumber(0),t.chatType=e.chatType,t.chatText=e.msg,t.chatParam=0,t.isLiveState=0,e.heros)for(var o in e.heros)if(e.heros[o]){var a=new f.T_Chat_HeroData;a.heroID=e.heros[o]._heroId,t.heros.set(Number(o),a)}if(i.ClientNetwork.getInstance().Send(p.CHAT_CLIENT_ENUM.P_Chat_Client,t),n.default.instance().SendChatCd=Number(g.getConfigIntValue("cd_union_chat")),"bigBlue"==C.GamePlatform.getMiYaVideoTypeNoSet()){var r=S.DalanReportUtils.REPORT_CHAT_CHANNEL_SOCIATY;S.DalanReportUtils.Instance.reprot_chat(r,e.msg)}},e.c_Sociaty_RoleLeaveSociaty=function(){var e=new a.C_Sociaty_RoleLeaveSociaty;i.ClientNetwork.getInstance().Send(a.SOCIATY_CLIENT_ENUM.P_Sociaty_RoleLeaveSociaty,e),n.default.instance().bInitiativeExit=!0},e.s_Sociaty_RoleLeaveSociaty=function(e){e.resetPos();var t=new a.S_Sociaty_RoleLeaveSociaty;if(t.read(e))if(t.errorcode==a.ErrorCode_Sociaty_RoleLeaveSociaty.ErrorCode_Sociaty_RoleLeaveSociaty_Success)s.default.Instance.emit(r.default.CloseSociatyMainView);else switch(t.errorcode){case a.ErrorCode_Sociaty_RoleLeaveSociaty.ErrorCode_Sociaty_RoleLeaveSociaty_PresidentCanNot:c.G.StringManager.PopWorldString("leave_sociaty_error5");break;case a.ErrorCode_Sociaty_RoleLeaveSociaty.ErrorCode_Sociaty_RoleLeaveSociaty_NoPlayer:c.G.StringManager.PopWorldString("sociaty_error_01");break;case a.ErrorCode_Sociaty_RoleLeaveSociaty.ErrorCode_Sociaty_RoleLeaveSociaty_NoSCPlayer:c.G.StringManager.PopWorldString("sociaty_error_02");break;case a.ErrorCode_Sociaty.ErrorCode_Sociaty_InSociatyWar:c.G.StringManager.PopWorldString("sociaty_war_tip3");break;default:c.G.StringManager.PopString("S_Sociaty_RoleLeaveSociaty _error:"+t.errorcode)}},e.c_Sociaty_RoleDonate=function(e,t){var o=new a.C_Sociaty_RoleDonate;o.donateNum=e,o.donateType=t,i.ClientNetwork.getInstance().Send(a.SOCIATY_CLIENT_ENUM.P_Sociaty_RoleDonate,o)},e.s_Sociaty_RoleDonate=function(e){e.resetPos();var t=new a.S_Sociaty_RoleDonate;if(t.read(e))if(t.errorcode==a.ErrorCode_Sociaty_RoleDonate.ErrorCode_Sociaty_RoleDonate_Success){if(t.prize.length>0){l.default.addPopView("BaseCtrl","AcquirePopupView","AcquirePopupView",{items:t.prize});var o=l.default.getViewByName("SociatyDonateView");if(o&&o.view&&o.view.closeView(),setTimeout(function(){s.default.Instance.emit(r.default.SociatySyncBoxEvent),s.default.Instance.emit(r.default.SociatyRefreshContributionEvent)},1e3),1==t.donateType){var i=l.default.getViewNodeByName("MainSceneView");i&&i.getComponent("MainSceneView")&&i.getComponent("MainSceneView").onClientTaskAddAdvert(T.RewardedVideoClientIdConst.SociatyDonateBox)}}}else switch(t.errorcode){case a.ErrorCode_Sociaty_RoleDonate.ErrorCode_Sociaty_RoleDonate_NoCost:c.G.StringManager.PopWorldString("common_prompt_diamond_insufficient");break;case a.ErrorCode_Sociaty_RoleDonate.ErrorCode_Sociaty_RoleDonate_NoPlayer:c.G.StringManager.PopWorldString("sociaty_error_01");break;case a.ErrorCode_Sociaty_RoleDonate.ErrorCode_Sociaty_RoleDonate_NoSCPlayer:c.G.StringManager.PopWorldString("sociaty_error_02");break;case a.ErrorCode_Sociaty_RoleDonate.ErrorCode_Sociaty_RoleDonate_NoSociaty:c.G.StringManager.PopWorldString("change_job_error10");break;case a.ErrorCode_Sociaty_RoleDonate.ErrorCode_Sociaty_RoleDonate_NoDonateNum:c.G.StringManager.PopWorldString("union_donation_error");break;case a.ErrorCode_Sociaty_RoleDonate.ErrorCode_Sociaty_RoleDonate_NoCost:c.G.StringManager.PopWorldString("union_donation_error1");break;default:c.G.StringManager.PopWorldString("S_Sociaty_RoleDonate error  "+t.errorcode)}},e.c_Sociaty_RoleGetSociatyApplyData=function(){var e=new a.C_Sociaty_RoleGetSociatyApplyData;i.ClientNetwork.getInstance().Send(a.SOCIATY_CLIENT_ENUM.P_Sociaty_RoleGetSociatyApplyData,e)},e.s_Sociaty_RoleGetSociatyApplyData=function(e){e.resetPos();var t=new a.S_Sociaty_RoleGetSociatyApplyData;t.read(e)&&(t.errorcode==a.ErrorCode_Sociaty_RoleGetSociatyApplyData.ErrorCode_Sociaty_RoleGetSociatyApplyData_Success?(n.default.instance().clearSociatyApplyData(),t.applyData.players.forEach(function(e){n.default.instance().addSociatyApplyData(e,e.roleID)}),s.default.Instance.emit(r.default.SyncSociatyApplyData,t.applyData.players),s.default.Instance.emit(r.default.SociatyRefreshRedpoint)):c.G.StringManager.PopString("S_Sociaty_RoleGetSociatyApplyData error:"+t.errorcode))},e.c_Sociaty_RoleDispossApplyList=function(e,t){var o=new a.C_Sociaty_RoleDispossApplyList;o.applyRoleID=e,o.dispossType=t,i.ClientNetwork.getInstance().Send(a.SOCIATY_CLIENT_ENUM.P_Sociaty_RoleDispossApplyList,o)},e.s_Sociaty_RoleDispossApplyList=function(e){e.resetPos();var t=new a.S_Sociaty_RoleDispossApplyList;if(t.read(e)){switch(t.errorcode){case a.ErrorCode_Sociaty_RoleDispossApplyList.ErrorCode_Sociaty_RoleDispossApplyList_Success:var o=l.default.getViewByName("SociatyApplyView");o&&o.view&&o.view.onRemoveSingleListItem(t);break;case a.ErrorCode_Sociaty_RoleDispossApplyList.ErrorCode_Sociaty_RoleDispossApplyList_NoInApplyList:c.G.StringManager.PopWorldString("sociaty_no_in_apply_list");break;case a.ErrorCode_Sociaty_RoleDispossApplyList.ErrorCode_Sociaty_RoleDispossApplyList_ApplyPlayerHaveSociaty:c.G.StringManager.PopWorldString("sociaty_player_hava_sociaty");break;case a.ErrorCode_Sociaty.ErrorCode_Sociaty_HaveMaxPlayer:c.G.StringManager.PopWorldString("sociaty_max_people");break;default:c.G.StringManager.PopWorldString("S_Sociaty_RoleDispossApplyList _error:"+t.errorcode)}t.dispossType==a.ProType_Sociaty_RoleDispossApplyList.ProType_Sociaty_RoleDispossApplyList_AddPlayer&&this.c_Sociaty_RoleGetSociatyData(n.default.instance().SociatyPlayerData.sociatyID)}},e.c_Sociaty_RoleInvite=function(e){var t=new a.C_Sociaty_RoleInvite;t.inviteRoleID=e,i.ClientNetwork.getInstance().Send(a.SOCIATY_CLIENT_ENUM.P_Sociaty_RoleInvite,t)},e.s_Sociaty_RoleInvite=function(e){e.resetPos();var t=new a.S_Sociaty_RoleInvite;if(t.read(e))switch(t.errorcode){case a.ErrorCode_Sociaty_RoleInvite.ErrorCode_Sociaty_RoleInvite_Success:c.G.StringManager.PopWorldString("union_sigin_send_invite");var o=l.default.getViewByName("PlayerInfoView");o&&o.view&&o.view.closeView();break;case a.ErrorCode_Sociaty.ErrorCode_Sociaty_HaveMaxPlayer:c.G.StringManager.PopWorldString("sociaty_max_people");break;case a.ErrorCode_Sociaty_RoleInvite.ErrorCode_Sociaty_RoleInvite_NoInvitePlayer:c.G.StringManager.PopWorldString("sociaty_role_invite_error6");break;case a.ErrorCode_Sociaty_RoleInvite.ErrorCode_Sociaty_RoleInvite_NoAuth:c.G.StringManager.PopWorldString("sociaty_role_invite_error5");break;case a.ErrorCode_Sociaty_RoleInvite.ErrorCode_Sociaty_RoleInvite_InviteHaveSociaty:c.G.StringManager.PopWorldString("sociaty_role_invite_error7");break;case a.ErrorCode_Sociaty_RoleInvite.ErrorCode_Sociaty_RoleInvite_NotInSameServerGroup:c.G.StringManager.PopWorldString("sociaty_role_invite_error9");break;default:c.G.StringManager.PopWorldString("S_Sociaty_RoleInvite _error:"+t.errorcode)}},e.c_Sociaty_RoleKickPlayer=function(e){var t=new a.C_Sociaty_RoleKickPlayer;t.kickPlayerID=e,i.ClientNetwork.getInstance().Send(a.SOCIATY_CLIENT_ENUM.P_Sociaty_RoleKickPlayer,t)},e.s_Sociaty_RoleKickPlayer=function(e){e.resetPos();var t=new a.S_Sociaty_RoleKickPlayer;if(t.read(e))switch(t.errorcode){case a.ErrorCode_Sociaty_RoleKickPlayer.ErrorCode_Sociaty_RoleKickPlayer_Success:n.default.instance().roleKickPlayer_init64(t.kickPlayerID),s.default.Instance.emit(r.default.RefreshMemberList);var o=l.default.getViewByName("PlayerInfoView");o&&o.view&&o.view.closeView();break;case a.ErrorCode_Sociaty_RoleKickPlayer.ErrorCode_Sociaty_RoleKickPlayer_NoKickSCPlayer:c.G.StringManager.PopWorldString("change_job_error6");break;case a.ErrorCode_Sociaty_RoleKickPlayer.ErrorCode_Sociaty_RoleKickPlayer_JobNoBeyondKickPlayer:c.G.StringManager.PopWorldString("sociaty_role_kick_player_error8");break;case a.ErrorCode_Sociaty_RoleKickPlayer.ErrorCode_Sociaty_RoleKickPlayer_NoKickPlayer:c.G.StringManager.PopString("\u6ca1\u6709\u88ab\u8e22\u8005\u7528\u6237\u6570\u636e");break;case a.ErrorCode_Sociaty.ErrorCode_Sociaty_InSociatyWar:c.G.StringManager.PopWorldString("sociaty_war_tip3");break;default:c.G.StringManager.PopWorldString("S_Sociaty_RoleKickPlayer _error:"+t.errorcode)}},e.c_Sociaty_RoleChangeJob=function(e,t){var o=new a.C_Sociaty_RoleChangeJob;o.changeRoleID=e,o.newJob=t,i.ClientNetwork.getInstance().Send(a.SOCIATY_CLIENT_ENUM.P_Sociaty_RoleChangeJob,o)},e.s_Sociaty_RoleChangeJob=function(e){e.resetPos();var t=new a.S_Sociaty_RoleChangeJob;if(t.read(e))switch(t.errorcode){case a.ErrorCode_Sociaty_RoleChangeJob.ErrorCode_Sociaty_RoleChangeJob_Success:n.default.instance().changeSociatyPlayerJob(t),s.default.Instance.emit(r.default.RefreshMemberList);var o=l.default.getViewByName("PlayerInfoView");o&&o.view&&o.view.closeView();break;case a.ErrorCode_Sociaty_RoleChangeJob.ErrorCode_Sociaty_RoleChangeJob_NoJobNum:c.G.StringManager.PopWorldString("change_job_error9");break;case a.ErrorCode_Sociaty_RoleChangeJob.ErrorCode_Sociaty_RoleChangeJob_NoChangeSCPlayer:c.G.StringManager.PopWorldString("change_job_error6");break;case a.ErrorCode_Sociaty_RoleChangeJob.ErrorCode_Sociaty_RoleChangeJob_ChangePresidentNoAuth:c.G.StringManager.PopWorldString("change_job_error7");break;case a.ErrorCode_Sociaty_RoleChangeJob.ErrorCode_Sociaty_RoleChangeJob_JobNoBeyondChangePlayer:c.G.StringManager.PopWorldString("change_job_error8");break;case a.ErrorCode_Sociaty_RoleChangeJob.ErrorCode_Sociaty_RoleChangeJob_ChangePlayerNotEnoughScore:c.G.StringManager.PopString(c.G.StringManager.getWorldString("change_job_error11")+g.getConfigIntValue("sociaty_changePlayerNotEnoughScore"));break;default:c.G.StringManager.PopWorldString("S_Sociaty_RoleChangeJob_error:"+t.errorcode)}},e.s_Sociaty_SynRoleJobChange=function(e){e.resetPos();var t=new a.S_Sociaty_SynRoleJobChange;t.read(e)&&(n.default.instance().changeSociatyPlayerJob2(t),s.default.Instance.emit(r.default.RefreshMemberList))},e.s_Chat_CloseFightRoom=function(e){e.resetPos();var t=new p.S_Chat_CloseFightRoom;t.read(e)&&1==n.default.instance().changeChatRoomState(t.roomID)&&s.default.Instance.emit(r.default.SociatySyncChangeBattleRoom)},e.c_Sociaty_RoleDispossInviteList=function(e,t){var o=new a.C_Sociaty_RoleDispossInviteList;o.dispossType=e,o.inviteSociatyID=t,i.ClientNetwork.getInstance().Send(a.SOCIATY_CLIENT_ENUM.P_Sociaty_RoleDispossInviteList,o)},e.s_Sociaty_RoleDispossInviteList=function(e){e.resetPos();var t=new a.S_Sociaty_RoleDispossInviteList;if(t.read(e))switch(t.errorcode){case a.ErrorCode_Sociaty_RoleDispossInviteList.ErrorCode_Sociaty_RoleDispossInviteList_Success:case a.ErrorCode_Sociaty_RoleDispossInviteList.ErrorCode_Sociaty_RoleDispossInviteList_NoSociaty:if(t.dispossType==a.ProType_Sociaty_RoleDispossInviteList.ProType_Sociaty_RoleDispossInviteList_AddSociaty)if(t.errorcode==a.ErrorCode_Sociaty_RoleDispossInviteList.ErrorCode_Sociaty_RoleDispossInviteList_NoSociaty)c.G.StringManager.PopWorldString("change_job_error10");else{var o=l.default.getViewByName("SociatyInvitedView");o&&o.view&&o.view.closeView(),c.G.StringManager.PopWorldString("sociaty_invite_add")}else t.dispossType==a.ProType_Sociaty_RoleDispossInviteList.ProType_Sociaty_RoleDispossInviteList_ClearList?(s.default.Instance.emit(r.default.SociatyClearInvitedList),n.default.instance().clearSociatyInviteData(),s.default.Instance.emit(r.default.SociatyRefreshRedpoint)):t.dispossType==a.ProType_Sociaty_RoleDispossInviteList.ProType_Sociaty_RoleDispossInviteList_DelSociaty&&(s.default.Instance.emit(r.default.SociatyRefuseInvitedEvent,t.inviteSociatyID),n.default.instance().deleteSociatyInviteData(t.inviteSociatyID),s.default.Instance.emit(r.default.SociatyRefreshRedpoint),c.G.StringManager.PopWorldString("sociaty_invite_del"));break;case a.ErrorCode_Sociaty.ErrorCode_Sociaty_HaveMaxPlayer:c.G.StringManager.PopWorldString("sociaty_max_people");break;default:c.G.StringManager.PopWorldString("S_Sociaty_RoleDispossInviteList error:"+t.errorcode)}},e.c_Sociaty_RoleGetSociatyBoxData=function(){var e=new a.C_Sociaty_RoleGetSociatyBoxData;i.ClientNetwork.getInstance().Send(a.SOCIATY_CLIENT_ENUM.P_Sociaty_RoleGetSociatyBoxData,e)},e.s_Sociaty_RoleGetSociatyBoxData=function(e){e.resetPos();var t=new a.S_Sociaty_RoleGetSociatyBoxData;t.read(e)&&(n.default.instance().SociatyBoxData=t.playerBoxData,s.default.Instance.emit(r.default.SociatySyncBoxEvent),s.default.Instance.emit(r.default.SociatyRefreshRedpoint))},e.c_Sociaty_RoleReceiveSociatyBoxPrize=function(e){var t=new a.C_Sociaty_RoleReceiveSociatyBoxPrize;t.getRewards=e,i.ClientNetwork.getInstance().Send(a.SOCIATY_CLIENT_ENUM.P_Sociaty_RoleReceiveSociatyBoxPrize,t)},e.s_Sociaty_RoleReceiveSociatyBoxPrize=function(e){e.resetPos();var t=new a.S_Sociaty_RoleReceiveSociatyBoxPrize;t.read(e)&&(0==t.errorcode&&t.prize.length>0&&(n.default.instance().SociatyBoxData=t.playerBoxData,s.default.Instance.emit(r.default.SociatySyncBoxEvent),s.default.Instance.emit(r.default.SociatySyncReceiveBoxEvent,t.prize),s.default.Instance.emit(r.default.SociatyRefreshRedpoint)),0!=t.errorcode&&c.G.StringManager.PopString("S_Sociaty_RoleReceiveSociatyBoxPrize ERROR "+t.errorcode))},e.c_Sociaty_RoleGetRedEnvelope=function(e){var t=new a.C_Sociaty_RoleGetRedEnvelope;t.id=e,i.ClientNetwork.getInstance().Send(a.SOCIATY_CLIENT_ENUM.P_Sociaty_RoleGetRedEnvelope,t)},e.s_Sociaty_RoleGetRedEnvelope=function(e){e.resetPos();var t=new a.S_Sociaty_RoleGetRedEnvelope;t.read(e)&&(0==t.errorcode?l.default.addPopView("BaseCtrl","SociatyOpenRedEnvelopeView","SociatyOpenRedEnvelopeView",{data:t}):c.G.StringManager.PopString("S_Sociaty_RoleGetRedEnvelope ERROR "+t.errorcode))},e.c_Activity_GetSociatyWarData=function(){var e=new y.C_Activity_GetSociatyWarData;e.activityID=y.ACTIVITY_ID_ENUM.P_Activity_SociatyWar,i.ClientNetwork.getInstance().Send(y.ACTIVITY_CLIENT_ENUM.P_Activity_GetSociatyWarData,e)},e.s_Activity_SyncSociatyWarData=function(e){e.resetPos();var t=new y.S_Activity_SyncSociatyWarData;t.read(e)&&(0==t.error?(s.default.Instance.emit(r.default.SyncSociatyWarEvent,t),n.default.instance().SociatyFightData=t):c.G.StringManager.PopString("S_Activity_SyncSociatyWarData ERROR "+t.error))},e.C_Sociaty_RoleGetRankListData=function(){var e=new a.C_Sociaty_RoleGetRankListData;e.sociatyId=n.default.instance().SociatyPlayerData.sociatyID,i.ClientNetwork.getInstance().Send(a.SOCIATY_CLIENT_ENUM.P_Sociaty_RoleGetRankListData,e)},e.s_Sociaty_RoleGetRankListData=function(e){e.resetPos();var t=new a.S_Sociaty_RoleGetRankListData;t.read(e)&&t.sociatyId==Number(n.default.instance().SociatyPlayerData.sociatyID)&&s.default.Instance.emit(r.default.SyncSociatyWarMemberRankEvent,t.rankListData)},e.c_Activity_SociatyWarRelive=function(e){var t=new y.C_Activity_SociatyWarRelive;t.reliveNum=e,i.ClientNetwork.getInstance().Send(y.ACTIVITY_CLIENT_ENUM.P_Activity_SociatyWarRelive,t)},e.s_Activity_SociatyWarRelive=function(e){e.resetPos();var t=new y.S_Activity_SociatyWarRelive;t.read(e)&&(0==t.errorcode||c.G.StringManager.PopString("S_Activity_SociatyWarRelive ERROR "+t.errorcode))},e.c_Activity_ReceiveSociatyWarWinNumPrize=function(e){var t=new y.C_Activity_ReceiveSociatyWarWinNumPrize;t.activityID=y.ACTIVITY_ID_ENUM.P_Activity_SociatyWar,t.sociatyWarSroce=e,i.ClientNetwork.getInstance().Send(y.ACTIVITY_CLIENT_ENUM.P_Activity_ReceiveSociatyWarWinNumPrize,t)},e.s_Activity_ReceiveSociatyWarWinNumPrize=function(e){e.resetPos();var t=new y.S_Activity_ReceiveSociatyWarWinNumPrize;t.read(e)&&(0==t.errorcode?t.rewards.length>0&&l.default.addPopView("BaseCtrl","AcquirePopupView","AcquirePopupView",{items:t.rewards}):c.G.StringManager.PopString("S_Activity_ReceiveSociatyWarWinNumPrize ERROR "+t.errorcode))},e.c_Sociaty_RoleGetAuctionData=function(){var e=new a.C_Sociaty_RoleGetAuctionData;e.sociatyId=Number(n.default.instance().SociatyPlayerData.sociatyID),i.ClientNetwork.getInstance().Send(a.SOCIATY_CLIENT_ENUM.P_Sociaty_RoleGetAuctionData,e)},e.s_Sociaty_RoleGetAuctionData=function(e){e.resetPos(),(new a.S_Sociaty_RoleGetAuctionData).read(e)},e.c_Sociaty_RoleAuction=function(e,t){var o=new a.C_Sociaty_RoleAuction;o.auctionId=e,o.auctionPrice=t,i.ClientNetwork.getInstance().Send(a.SOCIATY_CLIENT_ENUM.P_Sociaty_RoleAuction,o)},e.s_Sociaty_RoleAuction=function(e){e.resetPos();var t=new a.S_Sociaty_RoleAuction;t.read(e)&&(0==t.errorcode?(s.default.Instance.emit(r.default.SyncSociatyChangeAuctionStateEvent,1),s.default.Instance.emit(r.default.SociatyRefreshContributionEvent)):c.G.StringManager.PopString("\u7ade\u62cd\u5931\u8d25 "))},e.c_Sociaty_RoleFocus=function(e){var t=new a.C_Sociaty_RoleFocus;t.auctionId=e,i.ClientNetwork.getInstance().Send(a.SOCIATY_CLIENT_ENUM.P_Sociaty_RoleFocus,t)},e.s_Sociaty_RoleFocus=function(e){e.resetPos();var t=new a.S_Sociaty_RoleFocus;t.read(e)&&(0==t.errorcode?0==t.focusStatus?c.G.StringManager.PopWorldString("sociaty_auction_tip7"):1==t.focusStatus&&c.G.StringManager.PopWorldString("sociaty_auction_tip6"):c.G.StringManager.PopString("\u5173\u6ce8\u5931\u8d25 "))},e.c_Sociaty_RoleDirectBuy=function(e){var t=new a.C_Sociaty_RoleDirectBuy;t.auctionId=e,i.ClientNetwork.getInstance().Send(a.SOCIATY_CLIENT_ENUM.P_Sociaty_RoleDirectBuy,t)},e.s_Sociaty_RoleDirectBuy=function(e){e.resetPos();var t=new a.S_Sociaty_RoleDirectBuy;t.read(e)&&(0==t.errorcode?(t.prize.length>0&&l.default.addPopView("BaseCtrl","AcquirePopupView","AcquirePopupView",{items:t.prize}),s.default.Instance.emit(r.default.SociatyRefreshContributionEvent)):c.G.StringManager.PopString("\u8d2d\u4e70\u5931\u8d25 "))},e.s_Sociaty_RoleSyncAuctionData=function(e){e.resetPos();var t=new a.S_Sociaty_RoleSyncAuctionData;if(t.read(e)){var o=l.default.getViewByName("SociatyAuctionView");if(o&&o.view){if(n.default.instance().SociatyAuctionData.length<=0)s.default.Instance.emit(r.default.SyncSociatyGetAuctionDataEvent,t.auctionData);else{s.default.Instance.emit(r.default.SyncSociatyChangeAuctionDataEvent,t.auctionData);var i=n.default.instance().getSelfJoinAuction();t.auctionData.forEach(function(e){i.has(e.id)&&0==_.default.UUID.equals(e.roleID)&&s.default.Instance.emit(r.default.SyncSociatyChangeAuctionStateEvent,0)})}n.default.instance().SociatyAuctionData=t.auctionData}}},e.setSociatyFlagImage=function(e,t){d.default.loadSprite("ui/sociaty/image/sociatyFlag/sociatyFlag"+e,t)},e.updateTimer=function(){var e=[];n.default.instance().getSociatyRedEnvelopeMap().forEach(function(t,o){t--,n.default.instance().addSociatyRedEnvelopeData(o,t),t<=0&&e.push(o)}),e.forEach(function(e){n.default.instance().deleteSociatyRedEnvelopeData(e)}),e.length>0&&s.default.Instance.emit(r.default.SociatyRefreshRedEnvelopeEvent);var t=_.default.getServersTime(),o=new Date(1e3*t);0!=o.getHours()&&24!=o.getHours()||v.default.storageData("AuctionClickState",""),3==n.default.instance().getSociatyAuctionState()&&s.default.Instance.emit(r.default.SyncSociatyChangeAuctionDataEvent,[])},e}();o.default=I,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../common/EventConst":"EventConst","../../common/PlayerModule":"PlayerModule","../../modules/base/GameView":"GameView","../../modules/manager/EventManager":"EventManager","../../modules/manager/ViewManager":"ViewManager","../../network/ClientNetwork":"ClientNetwork","../../network/protocol/ActivityProtocols":"ActivityProtocols","../../network/protocol/BaseProtocols":"BaseProtocols","../../network/protocol/ChatProtocols":"ChatProtocols","../../network/protocol/SociatyProtocols":"SociatyProtocols","../../network/protocol/TypeProtocols":"TypeProtocols","../../network/protocol/long":"long","../../utils/DalanReportUtils":"DalanReportUtils","../../utils/GamePlatform":"GamePlatform","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils","../../utils/ResourcesManager":"ResourcesManager","../../utils/RewardedVideoUnitIdConst":"RewardedVideoUnitIdConst","./SociatyModel":"SociatyModel"}],SociatyDonateNumTableData:[function(e,t,o){"use strict";cc._RF.push(t,"51161UvVRJO0o5wqBbXAN5s","SociatyDonateNumTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.SociatyDonateNumTableData=void 0;var i=e("../TableReader"),a=e("./BaseTableData"),n=function(){function e(){this.donateType=0,this.donateNum=0,this.addSociatyExp=0,this.addContribution=0,this.prize=new Array}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.donateType=e.getNumber(),this.donateNum=e.getNumber(),this.addSociatyExp=e.getNumber(),this.addContribution=e.getNumber();for(var o=e.getString(),n=new i.TableReader(o);n.getPos()<n.getLen();){var r=new a.DropItem;r.readOriginal(n),this.prize.push(r)}},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"SociatyDonateNumTableData"},e.prototype.isAutoId=function(){return!0},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.SociatyDonateNumTableData=n,cc._RF.pop()},{"../TableReader":"TableReader","./BaseTableData":"BaseTableData"}],SociatyDonateTableData:[function(e,t,o){"use strict";cc._RF.push(t,"084141KZEBP87BNgF246f6U","SociatyDonateTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.SociatyDonateTableData=void 0;var i=e("../TableReader"),a=e("./BaseTableData"),n=function(){function e(){this.id=0,this.cost=new Array,this.maxDayNum=0}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber();for(var o=e.getString(),n=new i.TableReader(o);n.getPos()<n.getLen();){var r=new a.DropItem;r.readOriginal(n),this.cost.push(r)}this.maxDayNum=e.getNumber()},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"SociatyDonateTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.SociatyDonateTableData=n,cc._RF.pop()},{"../TableReader":"TableReader","./BaseTableData":"BaseTableData"}],SociatyDonateView:[function(e,t,o){"use strict";cc._RF.push(t,"102a5qhUKdN3ZmBXy10U6jj","SociatyDonateView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=e("../../StaticData/SociatyDonateTableData"),l=e("./SociatyModel"),d=e("../../Global/GameGlobal"),u=e("../../modules/base/GameView"),h=e("../../utils/RewardedVideoAd"),p=e("./SociatyCtrl"),f=e("../../utils/RewardedVideoUnitIdConst"),g=cc._decorator,m=g.ccclass,_=g.property,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.diamondCountLab=null,t.advertCountLab=null,t.bDiamondMaxCount=!1,t.bAdvertMaxCount=!1,t}return a(t,e),t.path=function(){return"ui/sociaty/prefab/SociatyDonation"},t.prototype.start=function(){var e=c.SociatyDonateTableData.getById(2),t=l.default.instance().getSociatyDonateNum(2);this.diamondCountLab.string="("+t+"/"+e.maxDayNum+")",t>=e.maxDayNum&&(this.bDiamondMaxCount=!0);var o=c.SociatyDonateTableData.getById(1),i=l.default.instance().getSociatyDonateNum(1);this.advertCountLab.string="("+i+"/"+o.maxDayNum+")",i>=o.maxDayNum&&(this.bAdvertMaxCount=!0)},t.prototype.onClickDiamondCallBack=function(){if(1==this.bDiamondMaxCount)return d.G.StringManager.PopWorldString("chaogong_today_num_is_complete");var e;e=0==l.default.instance().isMaxDayExp()?d.G.StringManager.getWorldString("union_donation_gold"):d.G.StringManager.getWorldString("union_max_day_exp"),u.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:e,confirmCb:function(){p.default.c_Sociaty_RoleDonate(1,2)}})},t.prototype.onClickAdvertCallBack=function(){if(1==this.bAdvertMaxCount)return d.G.StringManager.PopWorldString("farm_speed_up_ad_overy");h.default.createVideo({name:"SociatyDonateBox",adUnitId:f.RewardedVideoUnitIdConst.SociatyDonateBox,advertID:f.RewardedVideoClientIdConst.SociatyDonateBox,finishCb:function(){p.default.c_Sociaty_RoleDonate(1,1)}})},n([_(cc.Label)],t.prototype,"diamondCountLab",void 0),n([_(cc.Label)],t.prototype,"advertCountLab",void 0),n([s.Register_Class,m],t)}(r.default);o.default=y,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/SociatyDonateTableData":"SociatyDonateTableData","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/base/GameView":"GameView","../../utils/RewardedVideoAd":"RewardedVideoAd","../../utils/RewardedVideoUnitIdConst":"RewardedVideoUnitIdConst","./SociatyCtrl":"SociatyCtrl","./SociatyModel":"SociatyModel"}],SociatyFightMatchView:[function(e,t,o){"use strict";cc._RF.push(t,"871617/hHdIYooDoUjCus/F","SociatyFightMatchView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../Global/GameGlobal"),s=e("../../modules/base/BaseView"),c=e("../../modules/base/Decorators"),l=e("../../utils/GameUtils"),d=e("../../common/PlayerModule"),u=e("../../network/protocol/TypeProtocols"),h=e("../../modules/manager/LoadResManager"),p=e("../../utils/GameTools"),f=e("../../network/ClientNetwork"),g=e("../../network/LocalMessage"),m=e("../../modules/base/GameView"),_=e("../../network/protocol/MatchProtocols"),y=e("./SociatyModel"),v=e("../heroCardBag/HeroSkinUtils"),C=e("../../StaticData/HeroSkinTableData"),S=cc._decorator,T=S.ccclass,I=S.property,N=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.playerHeadNode=null,t.matchingNode=null,t.opponentNode=null,t.matchFinishNode=null,t.heroFormationNode=null,t.time=0,t.dt=0,t.matchStatus=0,t}return a(t,e),t.path=function(){return"ui/sociaty/prefab/SociatyFightMatch"},t.prototype.start=function(){this.initPlayerHeadInfo(),this.initPlayerHeroLineup(),this.onInitListenEvent(),this.matchFinishNode.active=!1,this.matchingNode.active=!0;var e=1;y.default.instance().SociatyFightData.dayMatchNum<=3&&(e=3),this.scheduleOnce(function(){var e=new _.C_Match_Fight;e.fightType=u.FIGHT_TYPE.FIGHT_TYPE_BATTLE_SOCIATY_WAR,e.params.push(l.getConfigVersion()),f.ClientNetwork.getInstance().Send(_.MATCH_CLIENT_ENUM.P_Match_Fight,e)},e)},t.prototype.onInitListenEvent=function(){var e=this;f.ClientNetwork.getInstance().listenLocalMessage(g.LOCAL_MESSAGE.LocalMsg_MatchSuccess,function(){e.matchFinishNode.active=!0,e.matchingNode.active=!1,e.opponentNode.children[0].active=!0,e.opponentNode.children[1].active=!1},this),f.ClientNetwork.getInstance().listenLocalMessage(g.LOCAL_MESSAGE.LocalMsg_LoginFightServerSuccess,function(){this.matchStatus=2}.bind(this),this),f.ClientNetwork.getInstance().listenProtocol(_.MATCH_CLIENT_ENUM.P_Match_Fight,function(t){t.resetPos();var o=new _.S_Match_Fight;if(o.read(t)){var i=o.errorcode;8089==i?(m.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:r.G.StringManager.getString("BATTLE_VERSION_NOT_MATCH"),confirmCb:function(){}}),e.onClickCloseCallBack()):(e.matchStatus=0,0!=i&&r.G.StringManager.PopStringOnce(r.G.StringManager.getString("MATCH_ROOM_FAIL")))}},this)},t.prototype.initPlayerHeadInfo=function(){var e=this;l.setRemoteHeadIcon(d.default.getHeadUrl(),d.default.getRoleAttrValByKey(u.ROLE_ATTR_VALUES.ROLE_ATTR_HEADID),this.playerHeadNode.getComponent(cc.Sprite));var t=d.default.getRoleAttrValByKey(u.ROLE_ATTR_VALUES.ROLE_ATTR_HEADFRAMEID);t<=0&&(t=200),h.default.loadSpriteFrame("ui/headFrame/frame_"+t).then(function(t){e.playerHeadNode&&(e.playerHeadNode.children[0].getComponent(cc.Sprite).spriteFrame=t)})},t.prototype.initPlayerHeroLineup=function(){var e=d.default.getBattleHeroCarData(d.default.fightHeroArrayIndex);for(var t in e)if(e[t]){var o=e[t]._heroId,i=v.default.Instance.getCurSkinIdByHeroUUID(null,o);if(i>0){var a=C.HeroSkinTableData.getById(i);null!=a&&(o=a.itemId)}p.default.createNormalItems(o,e[t]._heroLevel,this.heroFormationNode,function(e){e.getChildByName("num").active=!1,e.scale=.75})}},t.prototype.onClickCloseCallBack=function(){var e=new _.C_Match_Cacel;f.ClientNetwork.getInstance().Send(_.MATCH_CLIENT_ENUM.P_Match_Cancel,e),this.closeView()},t.prototype.update=function(e){this.matchStatus<0||(this.dt+=e,this.dt>1&&(0==this.matchStatus?(this.dt=0,this.time++,this.matchingNode.getChildByName("time").getComponent(cc.Label).string=r.G.StringManager.getString("MATCH_TIME",this.time)):2==this.matchStatus&&(this.matchStatus=-1)))},t.prototype.onDestroy=function(){f.ClientNetwork.getInstance().removeMessageTarget(this),f.ClientNetwork.getInstance().removeLocalMessage(g.LOCAL_MESSAGE.LocalMsg_MatchSuccess),f.ClientNetwork.getInstance().removeLocalMessage(g.LOCAL_MESSAGE.LocalMsg_LoginFightServerSuccess)},n([I(cc.Node)],t.prototype,"playerHeadNode",void 0),n([I(cc.Node)],t.prototype,"matchingNode",void 0),n([I(cc.Node)],t.prototype,"opponentNode",void 0),n([I(cc.Node)],t.prototype,"matchFinishNode",void 0),n([I(cc.Node)],t.prototype,"heroFormationNode",void 0),n([c.Register_Class,T],t)}(s.default);o.default=N,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/HeroSkinTableData":"HeroSkinTableData","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/base/GameView":"GameView","../../modules/manager/LoadResManager":"LoadResManager","../../network/ClientNetwork":"ClientNetwork","../../network/LocalMessage":"LocalMessage","../../network/protocol/MatchProtocols":"MatchProtocols","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils","../heroCardBag/HeroSkinUtils":"HeroSkinUtils","./SociatyModel":"SociatyModel"}],SociatyFightMemberRankItem:[function(e,t,o){"use strict";cc._RF.push(t,"35ae6Sp93JLdqNk+AKLIQXN","SociatyFightMemberRankItem");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../utils/GameTools"),s=e("../../modules/base/GameView"),c=e("../../utils/GameUtils"),l=e("../../modules/manager/LoadResManager"),d=e("../../common/PlayerModule"),u=cc._decorator,h=u.ccclass,p=u.property,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.rankIconNodeArr=[],t.rankNumNode=null,t.playerHeadNode=null,t.playerNameLab=null,t.winCountLab=null,t.scoreNumLab=null,t}return a(t,e),t.prototype.show=function(e,t){var o=this;this.rankIconNodeArr.forEach(function(e){e.active=!1}),this.rankNumNode.active=!1,this.rankIconNodeArr[t-1]?this.rankIconNodeArr[t-1].active=!0:(this.rankNumNode.active=!0,this.rankNumNode.children[0].getComponent(cc.Label).string=t.toString()),this.playerNameLab.string=e.nickName,c.setRemoteHeadIcon(e.headUrl,e.headID,this.playerHeadNode.getComponent(cc.Sprite));var i=e.headFrameID;(i<=0||i>=2e3)&&(i=200),l.default.loadSpriteFrame("ui/headFrame/frame_"+i).then(function(e){o.playerHeadNode&&(o.playerHeadNode.children[0].getComponent(cc.Sprite).spriteFrame=e)}),this.winCountLab.string=e.maxContinuousWinNum.toString(),this.scoreNumLab.string=e.score.toString(),e.roleID&&(this.playerHeadNode.roleid=e.roleID),e.roleId&&(this.playerHeadNode.roleid=e.roleId),this.playerHeadNode.roleid=d.default.otherUUidTransformRoieId(this.playerHeadNode.roleid),r.default.registerTouchEvent(this.playerHeadNode,function(e){var t=s.default.getViewByName("MainSceneView");t&&t.view&&t.view.onCallGetRoleSimpleInfo(e.target.roleid)})},n([p(cc.Node)],t.prototype,"rankIconNodeArr",void 0),n([p(cc.Node)],t.prototype,"rankNumNode",void 0),n([p(cc.Node)],t.prototype,"playerHeadNode",void 0),n([p(cc.Label)],t.prototype,"playerNameLab",void 0),n([p(cc.Label)],t.prototype,"winCountLab",void 0),n([p(cc.Label)],t.prototype,"scoreNumLab",void 0),n([h],t)}(cc.Component);o.default=f,cc._RF.pop()},{"../../common/PlayerModule":"PlayerModule","../../modules/base/GameView":"GameView","../../modules/manager/LoadResManager":"LoadResManager","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils"}],SociatyFightRankItem:[function(e,t,o){"use strict";cc._RF.push(t,"728012FgLlI+6wLTiJBuuX/","SociatyFightRankItem");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("./SociatyCtrl"),s=e("../../utils/GameTools"),c=e("./SociatyModel"),l=cc._decorator,d=l.ccclass,u=l.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.rankArrNode=[],t.playerNameLab=null,t.rankNumNode=null,t.presidentNameLab=null,t.levelLab=null,t.sociatyIcon=null,t.scoreNumLab=null,t}return a(t,e),t.prototype.show=function(e,t){var o=JSON.parse(e);this.rankArrNode.forEach(function(e){e.active=!1}),this.rankNumNode.active=!1,this.rankArrNode[t]?this.rankArrNode[t].active=!0:this.rankNumNode.active=!0,this.rankNumNode.children[0].getComponent(cc.Label).string=(t+1).toString(),this.presidentNameLab.string=o.sociatyPresidentName,this.playerNameLab.string=o.sociatyName,this.scoreNumLab.string=o.sociatyTotalScore,this.levelLab.string=o.sociatyLevel,this.node.sociatyId=o.sociatyId,s.default.registerTouchEvent(this.node,function(e){c.default.instance().bPopSociatyInfoView=!0,r.default.c_Sociaty_RoleGetSociatyData(e.target.sociatyId+"")})},n([u(cc.Node)],t.prototype,"rankArrNode",void 0),n([u(cc.Label)],t.prototype,"playerNameLab",void 0),n([u(cc.Node)],t.prototype,"rankNumNode",void 0),n([u(cc.Label)],t.prototype,"presidentNameLab",void 0),n([u(cc.Label)],t.prototype,"levelLab",void 0),n([u(cc.Node)],t.prototype,"sociatyIcon",void 0),n([u(cc.Label)],t.prototype,"scoreNumLab",void 0),n([d],t)}(cc.Component);o.default=h,cc._RF.pop()},{"../../utils/GameTools":"GameTools","./SociatyCtrl":"SociatyCtrl","./SociatyModel":"SociatyModel"}],SociatyFightRankView:[function(e,t,o){"use strict";cc._RF.push(t,"94e61+BQ9JIi7ZKeXy7tr4x","SociatyFightRankView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,o=1,i=arguments.length;o<i;o++)for(var a in t=arguments[o])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},r=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var s=e("../../modules/base/BaseView"),c=e("../../modules/base/Decorators"),l=e("../../utils/List"),d=e("../../utils/GameTools"),u=e("../../Global/GameGlobal"),h=e("../../utils/GamePlatform"),p=e("../../../load"),f=e("../../common/PlayerModule"),g=e("../../network/protocol/TypeProtocols"),m=e("./SociatyModel"),_=e("../../network/protocol/ActivityProtocols"),y=e("../../StaticData/ActivityTableData"),v=e("../../StaticData/SociatyAuctionTableData"),C=cc._decorator,S=C.ccclass,T=C.property,I=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.rankListViewNode=null,t.selfRankInfoNode=null,t.rewardScrollViewNode=null,t.rewardItemPrefab=null,t.sociatyLevelLab=null,t.selectTabName="",t.rankPageIdx=1,t.rankMaxPage=0,t.rankListData=[],t}return a(t,e),t.path=function(){return"ui/sociaty/prefab/SociatyFightRank"},t.prototype.start=function(){this.onClickRankTabCallBack(),this.rankListViewNode.node.on("bounce-bottom",this.onScrollBottom,this)},t.prototype.onScrollBottom=function(){this.rankPageIdx>=this.rankMaxPage||(this.rankPageIdx++,this.callRankListViewData())},t.prototype.callRankListViewData=function(){var e=this,t="http://192.168.1.242/gmsys_mszc/weblogic/webc/ranklistgetranklist.php";(h.GamePlatform.isWechat()||h.GamePlatform.isQQMiniGame()||h.GamePlatform.isByteDanceMiniGame()||h.GamePlatform.isKuaishouMiniGame())&&(t=p.getSubmitReviewState()?u.G.StringManager.getString("RANKLIST_URL"):u.G.StringManager.getString("RANKLIST_URL_MOBILE")),(h.GamePlatform.getMiYa()||h.GamePlatform.isQQGameRoom())&&(t=u.G.StringManager.getString("RANKLIST_URL_MOBILE"));var o=g.RANKLIST_TYPE.RANKLIST_TYPE_SOCIATYWAR_SOCIATY;0==function(){var t=!1,o=y.ActivityTableData.getById(_.ACTIVITY_ID_ENUM.P_Activity_SociatyWar),i=f.default.getServersTime(),a=new Date(1e3*i),n=(a.getSeconds(),a.getMinutes(),a.getHours(),a.getDay()),r=a.getDate(),s=a.getFullYear(),c=a.getMonth()+1;if(o.param2<0||n==o.param2){var l=o.param4.toString().slice(0,-2),d=o.param4.toString().slice(-2),u=o.param5.toString().slice(0,-2),h=o.param5.toString().slice(-2),p=function(e){var t=e.split(" ")[0],o=e.split(" ")[1],i=new Date;return i.setFullYear(t.split("-")[0]),i.setMonth(t.split("-")[1]-1),i.setDate(t.split("-")[2]),i.setHours(o.split(":")[0]),i.setMinutes(o.split(":")[1]),i.setSeconds(o.split(":")[2]),i.getTime()},g=s+"-"+c+"-"+r+" "+l+":"+d+":00",m=Math.floor(p.call(e,g)/1e3),v=s+"-"+c+"-"+r+" "+u+":"+h+":00",C=Math.floor(p.call(e,v)/1e3);t=i>=m&&i<C}else t=!1;return t}.call(this)&&(o=g.RANKLIST_TYPE.RANKLIST_TYPE_SOCIATYWAR_SOCIATY_HISTORY);var i=f.default.uuidTransformRoieId();"bigBlue"==h.GamePlatform.getMiYaVideoTypeNoSet()&&(t=u.G.StringManager.getString("RANKLIST_URL_MOBILE_BIGBLUE")),"ly5add7"==h.GamePlatform.getMiYaVideoTypeNoSet()&&(t=u.G.StringManager.getString("RANKLIST_URL_MOBILE_ADDCHANNEL")),t+="?",t+="ranktype="+o,t+="&roleid="+i,t+="&page="+this.rankPageIdx;var a=new XMLHttpRequest;a.onreadystatechange=function(){if(4==a.readyState&&a.status>=200&&a.status<400){var t=a.responseText.toString();t=(t=(t=t.replace('"','"')).replace("\ufeff","")).replace(" ","");var i=JSON.parse(t),n=i.ranktype,r=i.page;e.rankMaxPage=i.maxpage,Number(o)==Number(n)&&Number(r)==e.rankPageIdx&&e.resolvingSociatyFightRankData(i)}},a.open("GET",t,!0),a.send()},t.prototype.resolvingSociatyFightRankData=function(e){var t,o=0,i=0,a=0,n=m.default.instance().SociatyPlayerData;if(t=n.sociatyID.length<=0||0==Number(n.sociatyID)?0:Number(n.sociatyID),"ranklist"in e){var r=e.ranklist;for(var s in r)if(Object.prototype.hasOwnProperty.call(r,s)){this.rankListData.push(r[s]);var c=JSON.parse(r[s]);t==Number(c.sociatyId)&&(o=Number(s),i=c.sociatyTotalScore,a=c.sociatyLevel)}}o>0?(this.selfRankInfoNode.getChildByName("my_rank_num").getComponent(cc.Label).string=o+"",this.selfRankInfoNode.getChildByName("my_score_label").getComponent(cc.Label).string=i.toString(),this.sociatyLevelLab.string=a+"\u7ea7"):(this.selfRankInfoNode.getChildByName("my_rank_num").getComponent(cc.Label).string=u.G.StringManager.getString("NO_RANK"),this.selfRankInfoNode.getChildByName("my_score_label").getComponent(cc.Label).string=m.default.instance().getFightRankMemberTotalScore(),this.sociatyLevelLab.string=m.default.instance().SociatyData.sociatyLevel+"\u7ea7"),this.rankListViewNode.numItems=this.rankListData.length,this.rankListData.length<=0&&(this.selfRankInfoNode.active=!1)},t.prototype.onRefreshRankListEvent=function(e,t){var o=this.rankListData[t];e.getComponent("SociatyFightRankItem").show(o,t)},t.prototype.initRewardListView=function(){var e=this,t=new Map;v.SociatyAuctionTableData.getDataMap().forEach(function(e){var o=e.minRank,i=e.maxRank;if(o==i){var a=t.get(i.toString())||[],r=e.prize[0],s=n({},r);if(t.has(i.toString())){for(var c=-1,l=0;l<a.length;l++)if(a[l].dropID==s.dropID){c=l;break}c>=0?a[c].dropNum+=s.dropNum:a.push(s)}else a.push(s);t.set(i.toString(),a)}else{var d=o+" - "+i;if(a=t.get(d)||[],r=e.prize[0],s=n({},r),t.has(d)){for(c=-1,l=0;l<a.length;l++)if(a[l].dropID==s.dropID){c=l;break}c>=0?a[c].dropNum+=s.dropNum:a.push(s)}else a.push(s);t.set(d,a)}}),t.forEach(function(t,o){e.createRewardItemInfo(t,o).parent=e.rewardScrollViewNode.content})},t.prototype.createRewardItemInfo=function(e,t){var o=cc.instantiate(this.rewardItemPrefab),i=[o.getChildByName("rank1"),o.getChildByName("rank2"),o.getChildByName("rank3")];i.forEach(function(e){e.active=!1}),t.length<=1?i[Number(t)-1].active=!0:o.getChildByName("rankLabNode").children[0].getComponent(cc.Label).string=t;for(var a=o.getChildByName("ScrollView").getComponent(cc.ScrollView).content,n=0;n<e.length;n++)d.default.createNormalItems(e[n].dropID,e[n].dropNum,a,function(e){e.scale=.75});return o},t.prototype.onClickRankTabCallBack=function(){"ClickRankTab"!=this.selectTabName&&(this.selectTabName="ClickRankTab",this.rankListData.length<=0?this.callRankListViewData():this.rankListViewNode.scrollTo(-1,.1),this.rewardScrollViewNode.node.active=!1,this.rankListViewNode.node.active=!0,this.selfRankInfoNode.active=!0)},t.prototype.onClickRewardTabCallBack=function(){"ClickRewardTab"!=this.selectTabName&&(this.selectTabName="ClickRewardTab",this.rewardScrollViewNode.content.childrenCount<=0?this.initRewardListView():this.rewardScrollViewNode.scrollToTop(),this.rewardScrollViewNode.node.active=!0,this.rankListViewNode.node.active=!1,this.selfRankInfoNode.active=!1)},r([T(l.default)],t.prototype,"rankListViewNode",void 0),r([T(cc.Node)],t.prototype,"selfRankInfoNode",void 0),r([T(cc.ScrollView)],t.prototype,"rewardScrollViewNode",void 0),r([T(cc.Prefab)],t.prototype,"rewardItemPrefab",void 0),r([T(cc.Label)],t.prototype,"sociatyLevelLab",void 0),r([c.Register_Class,S],t)}(s.default);o.default=I,cc._RF.pop()},{"../../../load":"load","../../Global/GameGlobal":"GameGlobal","../../StaticData/ActivityTableData":"ActivityTableData","../../StaticData/SociatyAuctionTableData":"SociatyAuctionTableData","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../network/protocol/ActivityProtocols":"ActivityProtocols","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/GamePlatform":"GamePlatform","../../utils/GameTools":"GameTools","../../utils/List":"List","./SociatyModel":"SociatyModel"}],SociatyFightTipView:[function(e,t,o){"use strict";cc._RF.push(t,"16724UtYctMqJq3IiMqDVmK","SociatyFightTipView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=cc._decorator,l=c.ccclass,d=(c.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.path=function(){return"ui/sociaty/prefab/SociatyFightTip"},n([s.Register_Class,l],t)}(r.default));o.default=d,cc._RF.pop()},{"../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators"}],SociatyFightView:[function(e,t,o){"use strict";cc._RF.push(t,"a3fb1b7meNLnL2necAYJM+N","SociatyFightView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../utils/List"),s=e("../../StaticData/SociatyWarRewardTableData"),c=e("../../utils/GameTools"),l=e("../../common/PlayerModule"),d=e("../../StaticData/ActivityTableData"),u=e("../../network/protocol/ActivityProtocols"),h=e("../../common/EventConst"),p=e("../../modules/manager/EventManager"),f=e("./SociatyCtrl"),g=e("../../StaticData/SociatyWarReliveTableData"),m=e("../../utils/ResourcesManager"),_=e("../../modules/base/GameView"),y=e("./SociatyModel"),v=e("../../Global/GameGlobal"),C=e("../../utils/GameUtils"),S=e("../../network/protocol/TypeProtocols"),T=e("../activity/ActivityModule"),I=e("../../common/NetworkProtocolCommon"),N=cc._decorator,b=N.ccclass,w=N.property,E=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.memberListView=null,t.reviveBtnNode=null,t.matchBtnNode=null,t.openTimeNode=null,t.selfSocreLab=null,t.rewardScoreArrLab=[],t.rewardLayoutNode=null,t.fightIconNode=null,t.fightEffectNode=null,t.auctionBtnNode=null,t.tMemberRankListData=[],t.nReliveNum=0,t}return a(t,e),t.prototype.onLoad=function(){f.default.c_Activity_GetSociatyWarData(),p.default.Instance.on(h.default.SyncSociatyWarEvent,this.onRefreshSociatyWarInfo,this),p.default.Instance.on(h.default.SyncSociatyWarMemberRankEvent,this.onRefreshSociatyWarMemberRank,this),this.scheduleOnce(function(){f.default.C_Sociaty_RoleGetRankListData()},.2)},t.prototype.start=function(){this.chickActivityState(),this.schedule(this.chickActivityState,1);var e=_.default.getViewByName("SociatyMainView");if(e&&e.view){var t=e.view.getSociatyFightRedpointNode();t&&(t.active=!1)}},t.prototype.initRewardsInfo=function(e){var t=this;this.rewardLayoutNode.destroyAllChildren();var o=function(t){var o=!1;return e.prizeReward.forEach(function(e,i){i==t&&(o=e)}),o};s.SociatyWarRewardTableData.getDataMap().forEach(function(i,a){var n=i.prize;c.default.createNormalItems(n[0].dropID,n[0].dropNum,t.rewardLayoutNode,function(a){if(a.scale=.6,a.sociatyWarSroce=i.sociatyWarSroce,1==o.call(t,i.sociatyWarSroce))c.default.setNodeBright(a,!1),c.default.registerTouchEvent(a,function(){v.G.StringManager.PopString(v.G.StringManager.getWorldString("common_prompt_receive_over"))});else if(e.score>=i.sociatyWarSroce){c.default.registerTouchEvent(a,function(e){f.default.c_Activity_ReceiveSociatyWarWinNumPrize(e.target.sociatyWarSroce)});var n=new cc.Node,r=n.addComponent(cc.Sprite);n.parent=a,n.scale=1.2,m.default.loadSprite("ui/drawcard/res/xianzhong",r)}}),t.rewardScoreArrLab[a-1].string=i.sociatyWarSroce.toString()})},t.prototype.chickActivityState=function(){var e=d.ActivityTableData.getById(u.ACTIVITY_ID_ENUM.P_Activity_SociatyWar),t=l.default.getServersTime(),o=new Date(1e3*t),i=(o.getSeconds(),o.getMinutes(),o.getHours()),a=o.getDay(),n=o.getDate(),r=o.getFullYear(),s=o.getMonth()+1;if(e.param2<0||a==e.param2){var h=e.param4.toString().slice(0,-2),p=e.param4.toString().slice(-2),f=e.param5.toString().slice(0,-2),m=e.param5.toString().slice(-2),_=function(e){var t=e.split(" ")[0],o=e.split(" ")[1],i=new Date;return i.setFullYear(t.split("-")[0]),i.setMonth(t.split("-")[1]-1),i.setDate(t.split("-")[2]),i.setHours(o.split(":")[0]),i.setMinutes(o.split(":")[1]),i.setSeconds(o.split(":")[2]),i.getTime()},v=r+"-"+s+"-"+n+" "+h+":"+p+":00",S=Math.floor(_.call(this,v)/1e3),T=r+"-"+s+"-"+n+" "+f+":"+m+":00",I=Math.floor(_.call(this,T)/1e3);if(t>=S&&t<I)this.openTimeNode.active=!1,y.default.instance().SociatyFightData&&y.default.instance().SociatyFightData.failCount>0&&y.default.instance().SociatyFightData.reliveNum>=g.SociatyWarReliveTableData.getDataMap().size?c.default.setNodeBright(this.reviveBtnNode,!1):c.default.setNodeBright(this.matchBtnNode,!0),this.matchBtnNode.isOpen=!0;else{this.openTimeNode.active=!0,c.default.setNodeBright(this.matchBtnNode,!1),this.matchBtnNode.isOpen=!1;var N=Number(C.getConfigIntValue("sociaty_auction_continue_time"))+Number(C.getConfigIntValue("sociaty_auction_show_time"))+I,b=this.checkOpenAuctionCondition();if(this.auctionBtnNode.children[1].active=!1,c.default.setNodeBright(this.auctionBtnNode,!0),t>I)if(this.auctionBtnNode.active=!0,this.matchBtnNode.active=!1,1==b){if(t<N){var w=c.default.getData("AuctionClickState");(!w||w.length<=0)&&(this.auctionBtnNode.children[1].active=!0)}}else c.default.setNodeBright(this.auctionBtnNode,!1)}}else this.openTimeNode.active=!0,c.default.setNodeBright(this.matchBtnNode,!1),this.matchBtnNode.isOpen=!1;this.openTimeNode.children[0].getComponent(cc.Label).string=e.extranceUrl,0==this.matchBtnNode.isOpen?(this.fightIconNode.active=!0,this.fightEffectNode.active=!1,this.reviveBtnNode.active=!1,0==this.auctionBtnNode.active&&(this.matchBtnNode.active=!0)):(this.fightIconNode.active=!1,this.fightEffectNode.active=!0),0!=i&&24!=i||1==this.auctionBtnNode.active&&(this.auctionBtnNode.active=!1,this.matchBtnNode.active=!0)},t.prototype.onRefreshSociatyWarInfo=function(e){e.failCount>0?(this.reviveBtnNode.active=!0,this.matchBtnNode.active=!1,e.reliveNum>=g.SociatyWarReliveTableData.getDataMap().size?(c.default.setNodeBright(this.reviveBtnNode,!1),this.reviveBtnNode.children[1].active=!1):(c.default.setNodeBright(this.reviveBtnNode,!0),this.reviveBtnNode.children[1].active=!0,this.reviveBtnNode.children[1].children[0].getComponent(cc.Label).string=g.SociatyWarReliveTableData.getById(e.reliveNum+1).reliveCost[0].dropNum.toString())):(this.reviveBtnNode.active=!1,this.matchBtnNode.active=!0,c.default.setNodeBright(this.matchBtnNode,this.matchBtnNode.isOpen)),this.initRewardsInfo(e),this.selfSocreLab.string=e.score,this.nReliveNum=e.reliveNum},t.prototype.onRefreshSociatyWarMemberRank=function(e){var t=0;if(e.length<=0){var o=[];y.default.instance().SociatyData.sociatyplayers.forEach(function(e){var t={maxContinuousWinNum:0};t.roleID=e.roleID,t.showID=e.showID,t.isOnline=e.isOnline,t.nickName=e.nickName,t.logoutTime=e.logoutTime,t.headID=e.headID,t.headUrl=e.headUrl,t.headFrameID=e.headFrameID,t.level=e.level,t.score=0,t.job=e.job,t.contribution=e.contribution,t.enterSeasonID=e.enterSeasonID,t.sociatySeasonMedal=e.sociatySeasonMedal,t.sociatyDayMedal=e.sociatyDayMedal,o.push(t)}),e=o}e.sort(function(e,t){return e.score!=t.score?e.score<t.score?1:-1:e.maxContinuousWinNum<t.maxContinuousWinNum?1:void 0}),e.forEach(function(e){t+=e.score}),this.tMemberRankListData=e,this.memberListView.numItems=e.length,y.default.instance().setFightRankMemberTotalScore(t)},t.prototype.onRefreshPvpRankItemEvent=function(e,t){var o=this.tMemberRankListData[t];e.getComponent("SociatyFightMemberRankItem").show(o,t+1)},t.prototype.onClickSociatyRankCallBack=function(){_.default.addPopView("BaseCtrl","SociatyFightRankView","SociatyFightRankView")},t.prototype.onClickMatchCallBack=function(){if(0==this.matchBtnNode.isOpen)return v.G.StringManager.PopWorldString("sociaty_war_tip1");var e=d.ActivityTableData.getById(u.ACTIVITY_ID_ENUM.P_Activity_SociatyWar);return l.default.getRoleAttrValByKey(S.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE)<e.param1?v.G.StringManager.PopString(v.G.StringManager.getString("WUDAOHUI_SCORE_TIP",e.param1)):T.default.isChickenDinnerMatching()?(I.default.callRoleClientLog("CHICKENDINNER_MATCHING13"),v.G.StringManager.PopString(v.G.StringManager.getString("CHICKENDINNER_MATCHING")),void console.log("isChickenDinnerMatching code=13")):void _.default.addPopView("BaseCtrl","SociatyFightMatchView","SociatyFightMatchView")},t.prototype.onClickWarReliveCallBack=function(){var e=this;if(y.default.instance().SociatyFightData.failCount>0&&y.default.instance().SociatyFightData.reliveNum>=g.SociatyWarReliveTableData.getDataMap().size)return v.G.StringManager.PopWorldString("sociaty_war_tip2");var t="<outline color=black width=2> <color=#ffffff>\u662f\u5426\u82b1\u8d39"+this.reviveBtnNode.children[1].children[0].getComponent(cc.Label).string+"</c> <img src='diamond' />  <color=#ffffff>\u590d\u6d3b\uff0c\u590d\u6d3b\u540e\u80dc\u573a\u4e0d\u53d8\uff0c\u8fde\u80dc\u6e05\u96f6\uff01</color> </outline>";_.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:t,isRichText:!0,confirmCb:function(){if(l.default.diamondNum<Number(e.reviveBtnNode.children[1].children[0].getComponent(cc.Label).string))return v.G.StringManager.PopWorldString("common_prompt_diamond_insufficient");f.default.c_Activity_SociatyWarRelive(e.nReliveNum+1)}})},t.prototype.onClickSociaFightTipCallBack=function(){_.default.addPopView("BaseCtrl","SociatyFightTipView","SociatyFightTipView")},t.prototype.onClickSociatyAuctionCallBack=function(){if(0==this.checkOpenAuctionCondition())return v.G.StringManager.PopString(v.G.StringManager.getWorldString("sociaty_auction_tip10",Number(C.getConfigIntValue("sociaty_auction_open_playercount"))));_.default.addPopView("BaseCtrl","SociatyAuctionView","SociatyAuctionView"),c.default.storageData("AuctionClickState",1)},t.prototype.checkOpenAuctionCondition=function(){var e=0;return y.default.instance().SociatyData.sociatyplayers.forEach(function(t){var o=l.default.getServersTime()-t.logoutTime,i=(Math.floor(o/86400),Math.floor(o/3600));Math.floor(o%3600/60),i<72&&e++}),e>=Number(C.getConfigIntValue("sociaty_auction_open_playercount"))},t.prototype.onDestroy=function(){this.unschedule(this.chickActivityState),p.default.Instance.off(this)},n([w(r.default)],t.prototype,"memberListView",void 0),n([w(cc.Node)],t.prototype,"reviveBtnNode",void 0),n([w(cc.Node)],t.prototype,"matchBtnNode",void 0),n([w(cc.Node)],t.prototype,"openTimeNode",void 0),n([w(cc.Label)],t.prototype,"selfSocreLab",void 0),n([w(cc.Label)],t.prototype,"rewardScoreArrLab",void 0),n([w(cc.Node)],t.prototype,"rewardLayoutNode",void 0),n([w(cc.Node)],t.prototype,"fightIconNode",void 0),n([w(cc.Node)],t.prototype,"fightEffectNode",void 0),n([w(cc.Node)],t.prototype,"auctionBtnNode",void 0),n([b],t)}(cc.Component);o.default=E,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/ActivityTableData":"ActivityTableData","../../StaticData/SociatyWarReliveTableData":"SociatyWarReliveTableData","../../StaticData/SociatyWarRewardTableData":"SociatyWarRewardTableData","../../common/EventConst":"EventConst","../../common/NetworkProtocolCommon":"NetworkProtocolCommon","../../common/PlayerModule":"PlayerModule","../../modules/base/GameView":"GameView","../../modules/manager/EventManager":"EventManager","../../network/protocol/ActivityProtocols":"ActivityProtocols","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils","../../utils/List":"List","../../utils/ResourcesManager":"ResourcesManager","../activity/ActivityModule":"ActivityModule","./SociatyCtrl":"SociatyCtrl","./SociatyModel":"SociatyModel"}],SociatyInfoView:[function(e,t,o){"use strict";cc._RF.push(t,"019aaEU7mBMYrlbR4VlPwR9","SociatyInfoView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=e("./SociatyCtrl"),l=e("../../StaticData/SociatyLevelTableData"),d=e("../../utils/List"),u=e("../../common/PlayerModule"),h=e("../../network/protocol/TypeProtocols"),p=e("../../Global/GameGlobal"),f=e("../../modules/base/GameView"),g=e("./SociatyModel"),m=e("../../utils/GameUtils"),_=cc._decorator,y=_.ccclass,v=_.property,C=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.scrollViewNode=null,t.notMemberTip=null,t.sociatyIcon=null,t.sociatyLevel=null,t.sociatyName=null,t.sociatyMemberCount=null,t.sociatyID=null,t.sociatyDeclaration=null,t.totalScoreLab=null,t.list=null,t}return a(t,e),t.path=function(){return"ui/sociaty/prefab/SociatyInfo"},t.prototype.init=function(e){this.scrollViewNode.content.removeAllChildren(),this.initSociatyInfo(e.data),g.default.instance().bPopSociatyInfoView=!1},t.prototype.onRefreshMemberListEvent=function(e,t){var o=this.tMemberListData[t];e.getComponent("SociatyMemberItem").show(o,t)},t.prototype.initSociatyInfo=function(e){var t=this;c.default.setSociatyFlagImage(e.sociatyFlag,this.sociatyIcon),this.sociatyName.string=e.sociatyName;var o=l.SociatyLevelTableData.getById(e.sociatyLevel);this.sociatyMemberCount.string=e.currPlayerNum+"/"+o.maxPlayerNum,this.sociatyID.string=e.sociatyID,this.sociatyDeclaration.string=e.sociatyNotice,this.sociatyLevel.string=e.sociatyLevel.toString(),this.totalScoreLab.string=e.totalScore.toString(),this.tMemberListData=[],e.sociatyplayers.forEach(function(e){t.tMemberListData.push(e)}),this.tMemberListData.sort(function(e,t){return t.job-e.job}),this.list.numItems=this.tMemberListData.length,this.tMemberListData.length<=0?this.notMemberTip.active=!0:this.notMemberTip.active=!1,this.m_data=e;var i=g.default.instance().SociatyPlayerData;if(i.sociatyID.length<=0||0==Number(i.sociatyID)){this.node.getChildByName("btn_join").active=!0;var a=!1,n=f.default.getViewByName("NotJoinedSociatyview");n&&n.view&&(a=n.view.chickApplyState(e.sociatyID)),this.onChangeApplyBtnState(a)}else this.node.getChildByName("btn_join").active=!1},t.prototype.onClickApplyCallBack=function(){return u.default.getRoleAttrValByKey(h.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE)<Number(m.getConfigIntValue("sociaty_open_score"))?p.G.StringManager.PopString(p.G.StringManager.getWorldString("function_open_6")):u.default.getRoleAttrValByKey(h.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE)<this.m_data.enterScore?p.G.StringManager.PopWorldString("sociaty_no_enter_score"):this.m_data.enterType==h.SOCIATY_ENTER_TYPE.SOCIATY_ENTER_TYPE_FORBID?p.G.StringManager.PopWorldString("sociaty_forbid_enter"):void c.default.c_Sociaty_RoleJoinSociaty(this.m_data.sociatyID)},t.prototype.onChangeApplyBtnState=function(e){1==e&&(this.node.getChildByName("btn_join").getComponent(cc.Button).interactable=!1,this.node.getChildByName("btn_join").getComponent(cc.Button).enableAutoGrayEffect=!0,this.node.getChildByName("btn_join").children[0].getComponent(cc.Label).string=p.G.StringManager.getWorldString("join_sociaty_client_error1"))},n([v(cc.ScrollView)],t.prototype,"scrollViewNode",void 0),n([v(cc.Node)],t.prototype,"notMemberTip",void 0),n([v(cc.Sprite)],t.prototype,"sociatyIcon",void 0),n([v(cc.Label)],t.prototype,"sociatyLevel",void 0),n([v(cc.Label)],t.prototype,"sociatyName",void 0),n([v(cc.Label)],t.prototype,"sociatyMemberCount",void 0),n([v(cc.Label)],t.prototype,"sociatyID",void 0),n([v(cc.Label)],t.prototype,"sociatyDeclaration",void 0),n([v(cc.Label)],t.prototype,"totalScoreLab",void 0),n([v(d.default)],t.prototype,"list",void 0),n([s.Register_Class,y],t)}(r.default);o.default=C,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/SociatyLevelTableData":"SociatyLevelTableData","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/base/GameView":"GameView","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/GameUtils":"GameUtils","../../utils/List":"List","./SociatyCtrl":"SociatyCtrl","./SociatyModel":"SociatyModel"}],SociatyInvitedItem:[function(e,t,o){"use strict";cc._RF.push(t,"6e5e5kAbslI5JL4knI4kOVI","SociatyInvitedItem");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("./SociatyCtrl"),s=e("../../network/protocol/SociatyProtocols"),c=e("../../common/PlayerModule"),l=e("./SociatyModel"),d=e("../../Global/GameGlobal"),u=cc._decorator,h=u.ccclass,p=u.property,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.sociatyIcon=null,t.sociatyLevel=null,t.sociatyID=null,t.invitedRole=null,t.sociatyName=null,t}return a(t,e),t.prototype.show=function(e){r.default.setSociatyFlagImage(e.sociatyFlag,this.sociatyIcon),this.sociatyLevel.string=e.sociatyLevel.toString(),this.sociatyID.string=e.sociatyID,this.invitedRole.string=e.nickName,this.sociatyName.string=e.sociatyName},t.prototype.onClickAgreeCallBack=function(){var e=c.default.getServersTime(),t=l.default.instance().SociatyPlayerData.activeLeaveSociaty,o=l.default.instance().SociatyPlayerData.passiveLeaveSociaty;t>0&&e<t?d.G.StringManager.PopString(d.G.StringManager.getWorldString("sociaty_active_leave")):o>0&&e<o?d.G.StringManager.PopString(d.G.StringManager.getWorldString("sociaty_active_passive_leave")):r.default.c_Sociaty_RoleDispossInviteList(s.ProType_Sociaty_RoleDispossInviteList.ProType_Sociaty_RoleDispossInviteList_AddSociaty,this.sociatyID.string)},t.prototype.onClickRefuseCallBack=function(){r.default.c_Sociaty_RoleDispossInviteList(s.ProType_Sociaty_RoleDispossInviteList.ProType_Sociaty_RoleDispossInviteList_DelSociaty,this.sociatyID.string)},n([p(cc.Sprite)],t.prototype,"sociatyIcon",void 0),n([p(cc.Label)],t.prototype,"sociatyLevel",void 0),n([p(cc.Label)],t.prototype,"sociatyID",void 0),n([p(cc.Label)],t.prototype,"invitedRole",void 0),n([p(cc.Label)],t.prototype,"sociatyName",void 0),n([h],t)}(cc.Component);o.default=f,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../common/PlayerModule":"PlayerModule","../../network/protocol/SociatyProtocols":"SociatyProtocols","./SociatyCtrl":"SociatyCtrl","./SociatyModel":"SociatyModel"}],SociatyInvitedView:[function(e,t,o){"use strict";cc._RF.push(t,"f375chdnPlHvqEXtc0fgl3z","SociatyInvitedView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=e("../../utils/List"),l=e("./SociatyCtrl"),d=e("../../common/EventConst"),u=e("../../modules/manager/EventManager"),h=e("../../network/protocol/SociatyProtocols"),p=cc._decorator,f=p.ccclass,g=p.property,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.list=null,t.tInvitedListData=[],t}return a(t,e),t.path=function(){return"ui/sociaty/prefab/SociatyInvited"},t.prototype.onLoad=function(){var e=this;l.default.c_Sociaty_RoleGetInviteData(),u.default.Instance.on(d.default.syncSociatyInvitedData,this.initInvitedData,this),u.default.Instance.on(d.default.SociatyClearInvitedList,function(){e.list.numItems=0,e.tInvitedListData=[],e.node.getChildByName("txt_null").active=!0},this),u.default.Instance.on(d.default.SociatyRefuseInvitedEvent,this.onRefreshRefuseInvited,this)},t.prototype.initInvitedData=function(e){var t=this;this.tInvitedListData=[],e.forEach(function(e){t.tInvitedListData.push(e)}),this.list.numItems=this.tInvitedListData.length,this.node.getChildByName("txt_null").active=!(this.tInvitedListData.length>0)},t.prototype.onRefreshInvitedListEvent=function(e,t){var o=this.tInvitedListData[t];e.getComponent("SociatyInvitedItem").show(o,t)},t.prototype.onClickClearListCakllBack=function(){l.default.c_Sociaty_RoleDispossInviteList(h.ProType_Sociaty_RoleDispossInviteList.ProType_Sociaty_RoleDispossInviteList_ClearList,"")},t.prototype.onRefreshRefuseInvited=function(e){var t=this;this.tInvitedListData.forEach(function(o,i){o.sociatyID==e&&t.tInvitedListData.splice(i,1)}),this.list.numItems=this.tInvitedListData.length,this.node.getChildByName("txt_null").active=!(this.tInvitedListData.length>0)},t.prototype.onDestroy=function(){u.default.Instance.off(this,d.default.syncSociatyInvitedData),u.default.Instance.off(this,d.default.SociatyClearInvitedList)},n([g(c.default)],t.prototype,"list",void 0),n([s.Register_Class,f],t)}(r.default);o.default=m,cc._RF.pop()},{"../../common/EventConst":"EventConst","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/manager/EventManager":"EventManager","../../network/protocol/SociatyProtocols":"SociatyProtocols","../../utils/List":"List","./SociatyCtrl":"SociatyCtrl"}],SociatyJoinSuccessView:[function(e,t,o){"use strict";cc._RF.push(t,"3e7d95vRtNHcL9BjgqNxV+d","SociatyJoinSuccessView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=e("../../Global/GameGlobal"),l=e("../../network/protocol/TypeProtocols"),d=e("../../modules/base/GameView"),u=e("./SociatyCtrl"),h=e("./SociatyModel"),p=e("../../common/EventConst"),f=e("../../modules/manager/EventManager"),g=cc._decorator,m=g.ccclass,_=g.property,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.sociatyLevelLab=null,t.sociatyIcon=null,t.sociatyJoinLab=null,t.sociatyText1=null,t.sociatyText2=null,t}return a(t,e),t.path=function(){return"ui/sociaty/prefab/SociatyJoinSuccess"},t.prototype.onLoad=function(){f.default.Instance.on(p.default.SociatySyncJoinSuccessEvent,this.onRefreshViewInfo,this)},t.prototype.init=function(e){e?this.onRefreshViewInfo(e.data):(h.default.instance().SociatyData.sociatyID.length<=0||0==Number(h.default.instance().SociatyData.sociatyID))&&u.default.c_Sociaty_RoleGetSociatyData(h.default.instance().SociatyPlayerData.sociatyID)},t.prototype.onRefreshViewInfo=function(e){this.sociatyLevelLab.string=e.sociatyLevel;for(var t=e.sociatyplayers.size,o="",i=Array.from(e.sociatyplayers.keys()),a=0;a<t;a++){var n=i[a],r=e.sociatyplayers.get(n);if(r.job==l.SOCIATY_JOB.SOCIATY_JOB_PRESIDENT){o=r.nickName;break}}this.sociatyText1.string=c.G.StringManager.getString("JOIN_SOCIATY_TEXT1",e.sociatyName),this.sociatyText2.string=c.G.StringManager.getString("JOIN_SOCIATY_TEXT2",o)},t.prototype.onClickCloseCallBack=function(){var e=d.default.getViewByName("SociatyMainView");if(!e||!e.view){var t=h.default.instance().SociatyPlayerData;t.sociatyID.length<=0||0==Number(t.sociatyID)?c.G.StringManager.PopWorldString("sociaty_exit_tip0"):d.default.addPopView("BaseCtrl","SociatyMainView","SociatyMainView")}this.closeView()},t.prototype.onDestroy=function(){f.default.Instance.off(this,p.default.SociatySyncJoinSuccessEvent);var e=d.default.getViewByName("NotJoinedSociatyview");e&&e.view&&e.view.closeView();var t=d.default.getViewByName("SociatyInfoView");t&&t.view&&t.view.closeView()},n([_(cc.Label)],t.prototype,"sociatyLevelLab",void 0),n([_(cc.Sprite)],t.prototype,"sociatyIcon",void 0),n([_(cc.Label)],t.prototype,"sociatyJoinLab",void 0),n([_(cc.Label)],t.prototype,"sociatyText1",void 0),n([_(cc.Label)],t.prototype,"sociatyText2",void 0),n([s.Register_Class,m],t)}(r.default);o.default=y,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../common/EventConst":"EventConst","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/base/GameView":"GameView","../../modules/manager/EventManager":"EventManager","../../network/protocol/TypeProtocols":"TypeProtocols","./SociatyCtrl":"SociatyCtrl","./SociatyModel":"SociatyModel"}],SociatyLevelTableData:[function(e,t,o){"use strict";cc._RF.push(t,"c395crL/7VMNYV/vIA4lUg5","SociatyLevelTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.SociatyLevelTableData=void 0;var i=e("../TableReader"),a=function(){function e(){this.id=0,this.maxExp=0,this.maxPlayerNum=0,this.maxSignInExp=0,this.maxDayExp=0,this.maxDayMedal=0,this.addGradeExp=0}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.maxExp=e.getNumber(),this.maxPlayerNum=e.getNumber(),this.maxSignInExp=e.getNumber(),this.maxDayExp=e.getNumber(),this.maxDayMedal=e.getNumber(),this.addGradeExp=e.getNumber()},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"SociatyLevelTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.SociatyLevelTableData=a,cc._RF.pop()},{"../TableReader":"TableReader"}],SociatyMainView:[function(e,t,o){"use strict";cc._RF.push(t,"020a0a7FFxNtqUKX9kbQ+YC","SociatyMainView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r,s=e("../../modules/base/BaseView"),c=e("../../modules/base/Decorators"),l=e("./SociatyModel"),d=e("./SociatyCtrl"),u=e("../../StaticData/SociatyLevelTableData"),h=e("../../modules/base/GameView"),p=e("../../common/EventConst"),f=e("../../modules/manager/EventManager"),g=e("../../network/protocol/TypeProtocols"),m=e("../../Global/GameGlobal"),_=e("../../utils/GameUtils"),y=e("../../utils/GameTools"),v=e("../../common/PlayerModule"),C=e("../../common/CommandValue");(function(e){e[e.SOCIATY_TAB_TYPE_CHAT=1]="SOCIATY_TAB_TYPE_CHAT",e[e.SOCIATY_TAB_TYPE_MEMBER=2]="SOCIATY_TAB_TYPE_MEMBER",e[e.SOCIATY_TAB_TYPE_BOX=3]="SOCIATY_TAB_TYPE_BOX",e[e.SOCIATY_TAB_TYPE_Shop=4]="SOCIATY_TAB_TYPE_Shop",e[e.SOCIATY_TAB_TYPE_Fight=5]="SOCIATY_TAB_TYPE_Fight"})(r||(r={}));var S=cc._decorator,T=S.ccclass,I=S.property,N=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.tabArrNode=[],t.sociatyIcon=null,t.sociatyLevel=null,t.sociatyName=null,t.sociatyMemberCount=null,t.sociatyID=null,t.sociatyExp=null,t.sociatyExpBar=null,t.sociatyDeclaration=null,t.tabViewNode=null,t.sociatyExpLevel=null,t.prefabArr=[],t.manageNode=null,t.sociatyInfoNode=null,t.sociatyApplyRedPoint=null,t.sociatyManageRedPoint=null,t.sociatyBoxRedPoint=null,t.sociatyFightRedPoint=null,t.tabViewNodeArr=[],t.curSelectTabIndex=0,t}return a(t,e),t.path=function(){return"ui/sociaty/prefab/SociatyMain"},t.prototype.onLoad=function(){var e=this,t=cc.instantiate(this.prefabArr[0]);t.name="chatPanelNode",t.active=!0,t.parent=this.tabViewNode,this.tabViewNodeArr.push(t),f.default.Instance.on(p.default.CallRoleGetSociatyData,function(){return d.default.c_Sociaty_RoleGetSociatyData(l.default.instance().SociatyPlayerData.sociatyID)},this),f.default.Instance.on(p.default.RefreshSociatyInfo,this.initSociatyInfo,this),f.default.Instance.on(p.default.CloseSociatyMainView,function(){return e.closeView()},this),f.default.Instance.on(p.default.SociatyApplyBtnRedpointEvent,this.onRefreshApplyRedPoint,this),f.default.Instance.on(p.default.SociatyRefreshBoxRedpointEvent,this.onRefreshBoxRedPoint,this),f.default.Instance.emit(p.default.CallRoleGetSociatyData)},t.prototype.start=function(){this.onClickChatCallBack();var e=h.default.getViewByName("SociatyJoinSuccessView");e&&e.view&&e.view.closeView(),l.default.instance().m_sociatyUnreadChat=[],f.default.Instance.emit(p.default.SociatyRefreshUnreadChatEvent),l.default.instance().getSociatyApplyLength()<=0&&(l.default.instance().SociatyPlayerData.job!=g.SOCIATY_JOB.SOCIATY_JOB_OFFICIAL&&l.default.instance().SociatyPlayerData.job!=g.SOCIATY_JOB.SOCIATY_JOB_PRESIDENT||d.default.c_Sociaty_RoleGetSociatyApplyData()),this.onRefreshApplyRedPoint(),this.onRefreshBoxRedPoint(),this.onRefreshFightRedPoint()},t.prototype.init=function(e){var t=this;e&&e.selectTabIdx&&this.scheduleOnce(function(){t.onClickFightCallBack()},.2)},t.prototype.initSociatyInfo=function(){var e=l.default.instance().SociatyData;d.default.setSociatyFlagImage(e.sociatyFlag,this.sociatyIcon),this.sociatyName.string=e.sociatyName;var t=u.SociatyLevelTableData.getById(e.sociatyLevel);this.sociatyMemberCount.string=e.currPlayerNum+"/"+t.maxPlayerNum,this.sociatyID.string=e.sociatyID,this.sociatyDeclaration.string=e.sociatyNotice,this.sociatyLevel.string=e.sociatyLevel.toString(),this.sociatyExpLevel.string=this.sociatyLevel.string,this.sociatyExp.string=e.sociatyExp+"/"+t.maxExp,this.sociatyExpBar.progress=e.sociatyExp/t.maxExp,this.refreshSociatyFightTabState(e.sociatyLevel)},t.prototype.onClickManageCallBack=function(){this.manageNode.active=!this.manageNode.active,l.default.instance().SociatyPlayerData.job==g.SOCIATY_JOB.SOCIATY_JOB_MEMBER&&(this.manageNode.children[0].active=!1,this.manageNode.children[1].active=!1)},t.prototype.onClickContributeCallBack=function(){h.default.addPopView("BaseCtrl","SociatyDonateView","SociatyDonateView")},t.prototype.onClickChatCallBack=function(e){this.curSelectTabIndex!=r.SOCIATY_TAB_TYPE_CHAT&&(this.tabViewNodeArr.forEach(function(e){e.active=!1}),this.tabArrNode.forEach(function(e){e.opacity=0}),e?e.target.opacity=255:this.tabArrNode[0].opacity=255,this.tabViewNodeArr[0].active=!0,this.sociatyInfoNode.active=!0,this.manageNode.active=!1,this.curSelectTabIndex=r.SOCIATY_TAB_TYPE_CHAT,Number(this.sociatyLevel.string)<Number(_.getConfigIntValue("sociaty_war_need_sociatylevel"))&&(this.tabArrNode[this.tabArrNode.length-1].opacity=255,y.default.setNodeBright(this.tabArrNode[this.tabArrNode.length-1],!1)))},t.prototype.onClickMemberCallBack=function(e){if(this.tabViewNode.getChildByName("chatPanelNode").getComponent("SociatyChatView")._createBatleRoomType>0)h.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:m.G.StringManager.getWorldString("sociaty_exit_tip1"),confirmCb:function(){}});else if(this.curSelectTabIndex!=r.SOCIATY_TAB_TYPE_MEMBER){this.tabViewNodeArr.forEach(function(e){e.active=!1}),this.tabArrNode.forEach(function(e){e.opacity=0});var t=this.tabViewNode.getChildByName("memberPanelNode");if(!t){var o=cc.instantiate(this.prefabArr[1]);o.name="memberPanelNode",o.parent=this.tabViewNode,o.active=!1,this.tabViewNodeArr.push(o),t=o}e.target.opacity=255,t.active=!0,t.getComponent("SociatyMemberView").init(),this.sociatyInfoNode.active=!1,this.manageNode.active=!1,this.curSelectTabIndex=r.SOCIATY_TAB_TYPE_MEMBER,Number(this.sociatyLevel.string)<Number(_.getConfigIntValue("sociaty_war_need_sociatylevel"))&&(this.tabArrNode[this.tabArrNode.length-1].opacity=255,y.default.setNodeBright(this.tabArrNode[this.tabArrNode.length-1],!1))}},t.prototype.onClickBoxCallBack=function(e){if(this.tabViewNode.getChildByName("chatPanelNode").getComponent("SociatyChatView")._createBatleRoomType>0)h.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:m.G.StringManager.getWorldString("sociaty_exit_tip1"),confirmCb:function(){}});else if(this.curSelectTabIndex!=r.SOCIATY_TAB_TYPE_BOX){this.tabViewNodeArr.forEach(function(e){e.active=!1}),this.tabArrNode.forEach(function(e){e.opacity=0});var t=this.tabViewNode.getChildByName("boxPanelNode");if(!t){var o=cc.instantiate(this.prefabArr[2]);o.name="boxPanelNode",o.active=!1,o.parent=this.tabViewNode,this.tabViewNodeArr.push(o),t=o}e.target.opacity=255,t.active=!0,this.sociatyInfoNode.active=!1,this.manageNode.active=!1,this.curSelectTabIndex=r.SOCIATY_TAB_TYPE_BOX,Number(this.sociatyLevel.string)<Number(_.getConfigIntValue("sociaty_war_need_sociatylevel"))&&(this.tabArrNode[this.tabArrNode.length-1].opacity=255,y.default.setNodeBright(this.tabArrNode[this.tabArrNode.length-1],!1))}},t.prototype.onClickShopCallBack=function(e){if(this.tabViewNode.getChildByName("chatPanelNode").getComponent("SociatyChatView")._createBatleRoomType>0)h.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:m.G.StringManager.getWorldString("sociaty_exit_tip1"),confirmCb:function(){}});else if(this.curSelectTabIndex!=r.SOCIATY_TAB_TYPE_Shop){this.tabViewNodeArr.forEach(function(e){e.active=!1}),this.tabArrNode.forEach(function(e){e.opacity=0});var t=this.tabViewNode.getChildByName("shopPanelNode");if(!t){var o=cc.instantiate(this.prefabArr[3]);o.name="shopPanelNode",o.active=!1,o.parent=this.tabViewNode,this.tabViewNodeArr.push(o),t=o}e.target.opacity=255,t.active=!0,this.sociatyInfoNode.active=!1,this.manageNode.active=!1,this.curSelectTabIndex=r.SOCIATY_TAB_TYPE_Shop,Number(this.sociatyLevel.string)<Number(_.getConfigIntValue("sociaty_war_need_sociatylevel"))&&(this.tabArrNode[this.tabArrNode.length-1].opacity=255,y.default.setNodeBright(this.tabArrNode[this.tabArrNode.length-1],!1))}},t.prototype.onClickFightCallBack=function(e){if(0==v.default.checkModulerOnOffState(C.ModulerViewOnOff.SociatyFightView))return m.G.StringManager.PopWorldString("sociaty_war_tip6");if(l.default.instance().SociatyData.sociatyLevel<Number(_.getConfigIntValue("sociaty_war_need_sociatylevel")))return m.G.StringManager.PopString(m.G.StringManager.getWorldString("sociaty_war_tip4",Number(_.getConfigIntValue("sociaty_war_need_sociatylevel"))));if(this.tabViewNode.getChildByName("chatPanelNode").getComponent("SociatyChatView")._createBatleRoomType>0)h.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:m.G.StringManager.getWorldString("sociaty_exit_tip1"),confirmCb:function(){}});else if(this.curSelectTabIndex!=r.SOCIATY_TAB_TYPE_Fight){this.tabViewNodeArr.forEach(function(e){e.active=!1}),this.tabArrNode.forEach(function(e){e.opacity=0});var t=this.tabViewNode.getChildByName("fightPanelNode");if(!t){var o=cc.instantiate(this.prefabArr[4]);o.name="fightPanelNode",o.active=!1,o.parent=this.tabViewNode,this.tabViewNodeArr.push(o),t=o}e?e.target.opacity=255:this.tabArrNode[this.tabArrNode.length-1].opacity=255,t.active=!0,this.sociatyInfoNode.active=!1,this.manageNode.active=!1,this.curSelectTabIndex=r.SOCIATY_TAB_TYPE_Fight}},t.prototype.onClickModifyInfoCallBack=function(){this.manageNode.active=!1,h.default.addPopView("BaseCtrl","SociatyCreateView","SociatyCreateView")},t.prototype.onClickFindSociatyCallBack=function(){this.manageNode.active=!1,h.default.addPopView("BaseCtrl","SociatySearchView","SociatySearchView")},t.prototype.onClickRuleCallBack=function(){this.manageNode.active=!1,h.default.addPopView("BaseCtrl","SociatyRuleView","SociatyRuleView")},t.prototype.onClickApplyCallBack=function(){this.manageNode.active=!1,h.default.addPopView("BaseCtrl","SociatyApplyView","SociatyApplyView")},t.prototype.onClickExitSociatyCallBack=function(){if(this.tabViewNode.getChildByName("chatPanelNode").getComponent("SociatyChatView")._createBatleRoomType>0)h.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:m.G.StringManager.getWorldString("sociaty_exit_tip"),confirmCb:function(){}});else{var e="",t=l.default.instance().SociatyPlayerData;if(t.job==g.SOCIATY_JOB.SOCIATY_JOB_MEMBER||t.job==g.SOCIATY_JOB.SOCIATY_JOB_OFFICIAL)e=m.G.StringManager.getWorldString("union_exit");else if(t.job==g.SOCIATY_JOB.SOCIATY_JOB_PRESIDENT){if(l.default.instance().SociatyData.sociatyplayers.size>1)return e=m.G.StringManager.getWorldString("leave_sociaty_error5"),void h.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:e,confirmCb:function(){}});e=m.G.StringManager.getWorldString("sociaty_exit_1")}h.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:e,confirmCb:function(){d.default.c_Sociaty_RoleLeaveSociaty()}})}},t.prototype.onCloseView=function(){this.tabViewNode.getChildByName("chatPanelNode").getComponent("SociatyChatView")._createBatleRoomType>0?h.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:m.G.StringManager.getWorldString("sociaty_exit_tip"),confirmCb:function(){}}):this.closeView()},t.prototype.onRefreshApplyRedPoint=function(){this.sociatyApplyRedPoint.active=l.default.instance().checkSociatyApplyRedPoint(),this.sociatyManageRedPoint.active=l.default.instance().checkSociatyApplyRedPoint()},t.prototype.onRefreshBoxRedPoint=function(){this.sociatyBoxRedPoint.active=l.default.instance().checkSociatyBoxRedPoint()},t.prototype.onRefreshFightRedPoint=function(){if(this.sociatyFightRedPoint.active=l.default.instance().checkSociatyFightRedPoint(),0==this.sociatyFightRedPoint.active)if(l.default.instance().SociatyData.sociatyLevel<Number(_.getConfigIntValue("sociaty_war_need_sociatylevel")))this.sociatyFightRedPoint.active=!1;else if(this.sociatyFightRedPoint.active=l.default.instance().getSociatyAuctionState()<3,1==this.sociatyFightRedPoint.active){var e=y.default.getData("AuctionClickState");e&&e.length>0&&(this.sociatyFightRedPoint.active=!1)}},t.prototype.getSociatyFightRedpointNode=function(){return this.sociatyFightRedPoint},t.prototype.refreshSociatyFightTabState=function(e){e<Number(_.getConfigIntValue("sociaty_war_need_sociatylevel"))?(this.tabArrNode[this.tabArrNode.length-1].opacity=255,y.default.setNodeBright(this.tabArrNode[this.tabArrNode.length-1],!1)):(y.default.setNodeBright(this.tabArrNode[this.tabArrNode.length-1],!0),this.curSelectTabIndex!=r.SOCIATY_TAB_TYPE_Fight&&(this.tabArrNode[this.tabArrNode.length-1].opacity=0))},t.prototype.onDestroy=function(){f.default.Instance.off(this,p.default.RefreshSociatyInfo),f.default.Instance.off(this,p.default.CloseSociatyMainView),f.default.Instance.off(this,p.default.CallRoleGetSociatyData),f.default.Instance.off(this,p.default.SociatyApplyBtnRedpointEvent),f.default.Instance.off(this,p.default.SociatyRefreshBoxRedpointEvent),this.unscheduleAllCallbacks()},n([I(cc.Node)],t.prototype,"tabArrNode",void 0),n([I(cc.Sprite)],t.prototype,"sociatyIcon",void 0),n([I(cc.Label)],t.prototype,"sociatyLevel",void 0),n([I(cc.Label)],t.prototype,"sociatyName",void 0),n([I(cc.Label)],t.prototype,"sociatyMemberCount",void 0),n([I(cc.Label)],t.prototype,"sociatyID",void 0),n([I(cc.Label)],t.prototype,"sociatyExp",void 0),n([I(cc.ProgressBar)],t.prototype,"sociatyExpBar",void 0),n([I(cc.Label)],t.prototype,"sociatyDeclaration",void 0),n([I(cc.Node)],t.prototype,"tabViewNode",void 0),n([I(cc.Label)],t.prototype,"sociatyExpLevel",void 0),n([I(cc.Prefab)],t.prototype,"prefabArr",void 0),n([I(cc.Node)],t.prototype,"manageNode",void 0),n([I(cc.Node)],t.prototype,"sociatyInfoNode",void 0),n([I(cc.Node)],t.prototype,"sociatyApplyRedPoint",void 0),n([I(cc.Node)],t.prototype,"sociatyManageRedPoint",void 0),n([I(cc.Node)],t.prototype,"sociatyBoxRedPoint",void 0),n([I(cc.Node)],t.prototype,"sociatyFightRedPoint",void 0),n([c.Register_Class,T],t)}(s.default);o.default=N,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/SociatyLevelTableData":"SociatyLevelTableData","../../common/CommandValue":"CommandValue","../../common/EventConst":"EventConst","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/base/GameView":"GameView","../../modules/manager/EventManager":"EventManager","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils","./SociatyCtrl":"SociatyCtrl","./SociatyModel":"SociatyModel"}],SociatyMemberBigItem:[function(e,t,o){"use strict";cc._RF.push(t,"2c163VOljdISo3/oMT4Y9Gd","SociatyMemberBigItem");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/manager/LoadResManager"),s=e("../../utils/GameUtils"),c=e("../../network/protocol/TypeProtocols"),l=e("../../common/PlayerModule"),d=cc._decorator,u=d.ccclass,h=d.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.rankLab=null,t.nameLab=null,t.cupLab=null,t.contributionLab=null,t.headNode=null,t.jobArrNode=[],t.onlineNode=null,t.offlineNode=null,t}return a(t,e),t.prototype.show=function(e,t){var o=this;this.rankLab.string=(t+1).toString(),this.nameLab.string=e.nickName,this.cupLab.string=e.score.toString(),this.contributionLab.string=e.contribution.toString(),s.setRemoteHeadIcon(e.headUrl,e.headID,this.headNode.getComponent(cc.Sprite));var i=e.headFrameID;if((i<=0||i>=2e3)&&(i=200),r.default.loadSpriteFrame("ui/headFrame/frame_"+i).then(function(e){o.headNode.children[0].getComponent(cc.Sprite).spriteFrame=e}),this.jobArrNode.forEach(function(e){e.active=!1}),c.SOCIATY_JOB.SOCIATY_JOB_PRESIDENT==e.job?this.jobArrNode[1].active=!0:c.SOCIATY_JOB.SOCIATY_JOB_OFFICIAL==e.job&&(this.jobArrNode[0].active=!0),this.onlineNode.active=!1,this.offlineNode.active=!1,1==e.isOnline)this.onlineNode.active=!0;else{var a=l.default.getServersTime()-e.logoutTime,n=Math.floor(a/86400),d=Math.floor(a/3600),u=Math.floor(a%3600/60);u<=0&&(u=1);var h;h=n>0?n+"\u5929\u524d":d>0?d+"\u5c0f\u65f6"+u+"\u5206\u949f\u524d":u+"\u5206\u949f\u524d",this.offlineNode.getComponent(cc.Label).string=h,this.offlineNode.active=!0}},n([h(cc.Label)],t.prototype,"rankLab",void 0),n([h(cc.Label)],t.prototype,"nameLab",void 0),n([h(cc.Label)],t.prototype,"cupLab",void 0),n([h(cc.Label)],t.prototype,"contributionLab",void 0),n([h(cc.Node)],t.prototype,"headNode",void 0),n([h(cc.Node)],t.prototype,"jobArrNode",void 0),n([h(cc.Node)],t.prototype,"onlineNode",void 0),n([h(cc.Node)],t.prototype,"offlineNode",void 0),n([u],t)}(cc.Component);o.default=p,cc._RF.pop()},{"../../common/PlayerModule":"PlayerModule","../../modules/manager/LoadResManager":"LoadResManager","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/GameUtils":"GameUtils"}],SociatyMemberItem:[function(e,t,o){"use strict";cc._RF.push(t,"8d8dazG4OBCE6JXGWymgrNK","SociatyMemberItem");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/manager/LoadResManager"),s=e("../../utils/GameUtils"),c=e("../../network/protocol/TypeProtocols"),l=e("../../common/PlayerModule"),d=e("../../utils/GameTools"),u=e("../../modules/base/GameView"),h=e("../../Global/GameGlobal"),p=e("./SociatyModel"),f=cc._decorator,g=f.ccclass,m=f.property,_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.rankLab=null,t.nameLab=null,t.cupLab=null,t.contributionLab=null,t.headNode=null,t.jobArrNode=[],t.onlineNode=null,t.offlineNode=null,t}return a(t,e),t.prototype.show=function(e,t,o){var i=this,a=this.node.getChildByName("selfBg");a&&(a.active=!1);var n=this.node.getChildByName("selfRankLabNode");n&&(n.active=!1);var f=this.node.getChildByName("otherBg");f&&(f.active=!0);var g=this.node.getChildByName("rankLabNode");g&&(g.active=!0),o&&1==o&&(d.default.registerTouchEvent(this.node,function(e){var t=u.default.getViewByName("MainSceneView");t&&t.view&&t.view.onCallGetRoleSimpleInfo(e.target.roleid)}),1==l.default.UUID.equals(e.roleID)&&(a&&(a.active=!0),n&&(n.active=!0),f&&(f.active=!1),g&&(g.active=!1),e.sociatyDayMedal=p.default.instance().SociatyPlayerData.dayConvertSociatyMedal));var m=l.default.otherUUidTransformRoieId(e.roleID);this.node.roleid=m,this.rankLab.string=(t+1).toString(),this.nameLab.string=e.nickName,this.cupLab.string=e.score.toString(),this.contributionLab.string=e.sociatyDayMedal.toString(),s.setRemoteHeadIcon(e.headUrl,e.headID,this.headNode.getComponent(cc.Sprite));var _=e.headFrameID;if((_<=0||_>=2e3)&&(_=200),r.default.loadSpriteFrame("ui/headFrame/frame_"+_).then(function(e){i.headNode.children[0].getComponent(cc.Sprite).spriteFrame=e}),this.jobArrNode.forEach(function(e){e.active=!1}),c.SOCIATY_JOB.SOCIATY_JOB_PRESIDENT==e.job?this.jobArrNode[1].active=!0:c.SOCIATY_JOB.SOCIATY_JOB_OFFICIAL==e.job&&(this.jobArrNode[0].active=!0),this.onlineNode.active=!1,this.offlineNode.active=!1,1==e.isOnline)this.onlineNode.active=!0;else{var y=l.default.getServersTime()-e.logoutTime,v=Math.floor(y/86400),C=Math.floor(y/3600),S=Math.floor(y%3600/60);S<=0&&(S=1);var T="";v>0?(T=h.G.StringManager.getWorldString("union_offline_time4",v),v>30&&(T=h.G.StringManager.getWorldString("union_offline_time5"))):C>0?T=h.G.StringManager.getWorldString("union_offline_time3",C):(S<=1&&(T=h.G.StringManager.getWorldString("union_offline_time1")),T=h.G.StringManager.getWorldString("union_offline_time2",S)),this.offlineNode.getComponent(cc.Label).string=T,this.offlineNode.active=!0}},n([m(cc.Label)],t.prototype,"rankLab",void 0),n([m(cc.Label)],t.prototype,"nameLab",void 0),n([m(cc.Label)],t.prototype,"cupLab",void 0),n([m(cc.Label)],t.prototype,"contributionLab",void 0),n([m(cc.Node)],t.prototype,"headNode",void 0),n([m(cc.Node)],t.prototype,"jobArrNode",void 0),n([m(cc.Node)],t.prototype,"onlineNode",void 0),n([m(cc.Node)],t.prototype,"offlineNode",void 0),n([g],t)}(cc.Component);o.default=_,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../common/PlayerModule":"PlayerModule","../../modules/base/GameView":"GameView","../../modules/manager/LoadResManager":"LoadResManager","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils","./SociatyModel":"SociatyModel"}],SociatyMemberView:[function(e,t,o){"use strict";cc._RF.push(t,"8285a+OcYtEFJJtOT/FZrXv","SociatyMemberView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../utils/List"),s=e("./SociatyModel"),c=e("../../Global/GameGlobal"),l=e("../../common/EventConst"),d=e("../../modules/manager/EventManager"),u=cc._decorator,h=u.ccclass,p=u.property,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.scrollList=null,t.sortTextLab=null,t.totalTextLab=null,t.m_listTypeArr=[1,3,5],t.m_listTypeIdx=0,t}return a(t,e),t.prototype.onLoad=function(){d.default.Instance.on(l.default.RefreshMemberList,this.updateListType,this)},t.prototype.init=function(){this.scrollList.scrollTo(-1),this.updateListType()},t.prototype.onRefreshMemberListEvent=function(e,t){var o=this.tMemberListData[t];e.getComponent("SociatyMemberItem").show(o,t,!0)},t.prototype.onClickSortCallBack=function(){this.m_listTypeIdx++,this.m_listTypeIdx>this.m_listTypeArr.length-1&&(this.m_listTypeIdx=0),this.updateListType()},t.prototype.updateListType=function(){var e=this;this.tMemberListData=[],this.scrollList.numItems=0,this.sortTextLab.string=c.G.StringManager.getWorldString("sociaty_player_sort"+this.m_listTypeArr[this.m_listTypeIdx]);var t=0;s.default.instance().SociatyData.sociatyplayers.forEach(function(o){t+=o.score,e.tMemberListData.push(o)});var o=this;this.tMemberListData.sort(function(e,t){return 1==o.m_listTypeArr[o.m_listTypeIdx]?t.score-e.score:5==o.m_listTypeArr[o.m_listTypeIdx]?t.sociatyDayMedal-e.sociatyDayMedal:t.job-e.job}),this.scrollList.numItems=this.tMemberListData.length,this.totalTextLab.string=t+"",this.totalTextLab.node.parent.active=1===this.m_listTypeArr[this.m_listTypeIdx]},t.prototype.onDestroy=function(){d.default.Instance.off(this,l.default.RefreshMemberList)},n([p(r.default)],t.prototype,"scrollList",void 0),n([p(cc.Label)],t.prototype,"sortTextLab",void 0),n([p(cc.Label)],t.prototype,"totalTextLab",void 0),n([h],t)}(cc.Component);o.default=f,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../common/EventConst":"EventConst","../../modules/manager/EventManager":"EventManager","../../utils/List":"List","./SociatyModel":"SociatyModel"}],SociatyModel:[function(e,t,o){"use strict";cc._RF.push(t,"789d6yATQVCcqhDwfokw7HA","SociatyModel"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../network/protocol/SociatyProtocols"),a=e("./SociatyChatModel"),n=e("../../StaticData/SociatyLevelTableData"),r=e("../../StaticData/SociatyDonateNumTableData"),s=e("../../network/protocol/TypeProtocols"),c=e("../../network/protocol/ObjCollection"),l=e("../../modules/base/GameView"),d=e("../../StaticData/SociatyBoxTableData"),u=e("../../common/PlayerModule"),h=e("../../utils/GameUtils"),p=e("../../network/protocol/TypeProtocols"),f=e("../../StaticData/ActivityTableData"),g=e("../../network/protocol/ActivityProtocols"),m=e("../../utils/GameTools"),_=function(){function e(){this.m_RefreshRecommendedCd=0,this.m_sociatyChat=new Array,this.m_sociatyUnreadChat=new Array,this.bPopSociatyInfoView=!1,this.m_sendChatCd=0,this.bInitiativeExit=!1,this.memberTotalScore=0,this.sociatyFightRankMemberTotalScore=0,this.m_sociatyPlayerData=new i.T_Sociaty_Player,this.m_sociatyData=new i.T_Sociaty_Sociaty,this.m_sociatyChat=[],this.t_sociatyBoxData=new i.T_Sociaty_Player_SociatyBoxData,this.tSociatyInviteMap=new c.ObjMap,this.tSociatyApplyMap=new c.ObjMap,this.t_sociatyRecommended=[],this.m_sociatyUnreadChat=[],this.bInitiativeExit=!1,this.sociatyRedEnvelopeMap=new c.ObjMap,this.memberTotalScore=0,this.tSociatyAuction=[],this.tSelfJoinAuctionArr=new Set}return e.instance=function(){return this._instance||(this._instance=new this),this._instance},e.prototype.destroy=function(){this.m_sociatyChat=[],this.bPopSociatyInfoView=!1,this.m_sociatyUnreadChat=[],this.bInitiativeExit=!1,this.sociatyRedEnvelopeMap.clear(),this.memberTotalScore=0,this.tSociatyAuction=[],this.tSelfJoinAuctionArr.clear()},Object.defineProperty(e.prototype,"SociatyPlayerData",{get:function(){return this.m_sociatyPlayerData},set:function(e){this.clearSociatyRedEnvelopeData();for(var t=e.redEnvelopes.length,o=0;o<t;o++)e.redEnvelopes[o]&&e.durationTimes[o]&&this.addSociatyRedEnvelopeData(e.redEnvelopes[o],e.durationTimes[o]);this.m_sociatyPlayerData=e,e.sociatyID.length<=0||0==Number(e.sociatyID)?(this.SociatyData=new i.T_Sociaty_Sociaty,this.t_sociatyBoxData=new i.T_Sociaty_Player_SociatyBoxData,this.destroy(),this.clearSociatyApplyData()):(this.RefreshRecommendedCd=0,this.SendChatCd=0,this.clearSociatyInviteData())},enumerable:!1,configurable:!0}),e.prototype.changeSociatyPlayer=function(e,t,o){this.SociatyPlayerData[e]&&(o?this.SociatyPlayerData[e]+=t:this.SociatyPlayerData[e]=t)},Object.defineProperty(e.prototype,"RefreshRecommendedCd",{get:function(){return this.m_RefreshRecommendedCd},set:function(e){this.m_RefreshRecommendedCd=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"SociatyRecommendedList",{get:function(){return this.t_sociatyRecommended},set:function(e){this.t_sociatyRecommended=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"SendChatCd",{get:function(){return this.m_sendChatCd},set:function(e){this.m_sendChatCd=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"SociatyData",{get:function(){return this.m_sociatyData},set:function(e){var t=this;this.memberTotalScore=0,e.sociatyplayers.size>0?this.m_sociatyData=e:(this.m_sociatyData.sociatyID=e.sociatyID,this.m_sociatyData.sociatyName=e.sociatyName,this.m_sociatyData.sociatyFlag=e.sociatyFlag,this.m_sociatyData.sociatyNotice=e.sociatyNotice,this.m_sociatyData.enterType=e.enterType,this.m_sociatyData.enterScore=e.enterScore,this.m_sociatyData.sociatyLevel=e.sociatyLevel,this.m_sociatyData.sociatyExp=e.sociatyExp,this.m_sociatyData.sociatyDayExp=e.sociatyDayExp,this.m_sociatyData.sociatySeasonID=e.sociatySeasonID,this.m_sociatyData.sociatySeasonLeftTime=e.sociatySeasonLeftTime,this.m_sociatyData.sociatyGrade=e.sociatyGrade,this.m_sociatyData.sociatyGradeSub=e.sociatyGradeSub,this.m_sociatyData.sociatyGradeExp=e.sociatyGradeExp,this.m_sociatyData.sociatyMedal=e.sociatyMedal,this.m_sociatyData.sociatyDayMedal=e.sociatyDayMedal,this.m_sociatyData.currPlayerNum=e.currPlayerNum),e.sociatyplayers.forEach(function(e){t.memberTotalScore+=e.score})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"SociatyFightData",{get:function(){return this.sociatyFightData},set:function(e){this.sociatyFightData=e},enumerable:!1,configurable:!0}),e.prototype.checkSociatyFightRedPoint=function(){var e=this;return!(this.m_sociatyData.sociatyLevel<Number(h.getConfigIntValue("sociaty_war_need_sociatylevel")))&&0!=function(){var t=!1,o=f.ActivityTableData.getById(g.ACTIVITY_ID_ENUM.P_Activity_SociatyWar),i=u.default.getServersTime(),a=new Date(1e3*i),n=(a.getSeconds(),a.getMinutes(),a.getHours(),a.getDay()),r=a.getDate(),s=a.getFullYear(),c=a.getMonth()+1;if(o.param2<0||n==o.param2){var l=o.param4.toString().slice(0,-2),d=o.param4.toString().slice(-2),h=o.param5.toString().slice(0,-2),p=o.param5.toString().slice(-2),m=function(e){var t=e.split(" ")[0],o=e.split(" ")[1],i=new Date;return i.setFullYear(t.split("-")[0]),i.setMonth(t.split("-")[1]-1),i.setDate(t.split("-")[2]),i.setHours(o.split(":")[0]),i.setMinutes(o.split(":")[1]),i.setSeconds(o.split(":")[2]),i.getTime()},_=s+"-"+c+"-"+r+" "+l+":"+d+":00",y=Math.floor(m.call(e,_)/1e3),v=s+"-"+c+"-"+r+" "+h+":"+p+":00",C=Math.floor(m.call(e,v)/1e3);t=i>=y&&i<C}else t=!1;return t}.call(this)&&1!=function(){return!!e.sociatyFightData&&e.sociatyFightData.failCount>0}.call(this)},Object.defineProperty(e.prototype,"SociatyBoxData",{get:function(){return this.t_sociatyBoxData},set:function(e){this.t_sociatyBoxData=e},enumerable:!1,configurable:!0}),e.prototype.checkSociatyBoxRedPoint=function(){var e=this.checkReceiveSociatyBoxPrize();return!!e&&e.length>0},e.prototype.checkReceiveSociatyBoxPrize=function(){var t=this,o=[],a=e.instance().SociatyData.sociatyMedal,n=[],r=e.instance().SociatyData;return d.SociatyBoxTableData.getDataMap().forEach(function(e){r.sociatySeasonID==e.seasonId&&n.push(e)}),n.length<=0&&d.SociatyBoxTableData.getDataMap().forEach(function(e){n[0]&&n[0].seasonId!=e.seasonId&&(n=[]),n.push(e)}),n.forEach(function(e){var n=0,r=t.checkBoxReceiveState(e.coinNum,1);0!=r&&r||a>=e.coinNum&&(n=1);var s,c=0,l=t.checkBoxReceiveState(e.coinNum,2);if((0==l||!l)&&a>=e.coinNum){var d=Number(h.getConfigIntValue("sociaty_extraItem_score"));u.default.getRoleAttrValByKey(p.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE)>=d&&(c=1)}1==n&&((s=new i.T_SociatyBattlePassData).index=e.coinNum,s.type=1,o.push(s)),1==c&&((s=new i.T_SociatyBattlePassData).index=e.coinNum,s.type=2,o.push(s))}),o},e.prototype.checkBoxReceiveState=function(t,o){var i=e.instance().SociatyBoxData.boxsMap;return!!i.has(t)&&i.get(t).receiveMap.get(o)},e.prototype.addSociatyInviteData=function(e,t){this.tSociatyInviteMap.set(t,e)},e.prototype.deleteSociatyInviteData=function(e){this.tSociatyInviteMap.has(e)&&this.tSociatyInviteMap.delete(e)},e.prototype.clearSociatyInviteData=function(){this.tSociatyInviteMap.clear()},e.prototype.getSociatyInviteLength=function(){return this.tSociatyInviteMap.size},e.prototype.checkSociatyInviteRedPoint=function(){return!!this.tSociatyInviteMap&&this.tSociatyInviteMap.size>0},e.prototype.addSociatyApplyData=function(e,t){this.tSociatyApplyMap.set(t,e)},e.prototype.deleteSociatyApplyData=function(e){this.tSociatyApplyMap.has(e)&&this.tSociatyApplyMap.delete(e)},e.prototype.clearSociatyApplyData=function(){this.tSociatyApplyMap.clear()},e.prototype.getSociatyApplyLength=function(){return this.tSociatyApplyMap.size},e.prototype.checkSociatyApplyRedPoint=function(){return!!this.tSociatyApplyMap&&this.tSociatyApplyMap.size>0},e.prototype.addSociatyChat=function(e,t,o){void 0===e&&(e=null),void 0===t&&(t=null),void 0===o&&(o=null);var i=new a.SociatyChatModel;if(!e||t||o?e||!t||o?e||t||!o||i.update(null,null,o):i.update(t,null):i.update(null,e),this.m_sociatyChat.push(i),this.m_sociatyChat.sort(this.__sort_unionChat),this.SociatyPlayerData.sociatyID.length>0||Number(this.SociatyPlayerData.sociatyID)>0){var n=l.default.getViewByName("SociatyMainView");n&&n.view||this.m_sociatyUnreadChat.push(this.m_sociatyUnreadChat.length+1)}},e.prototype.syncSociatyChatData=function(e){if(this.m_sociatyChat=[],0!=e.logData.logs.length)for(var t=e.logData.logs.length,o=0;o<t;o++){var i=e.logData.logs[o],n=new a.SociatyChatModel;n.update(i,null),this.m_sociatyChat.push(n)}if(0!=e.chatData.length)for(var r=e.chatData.length,s=0;s<r;s++){var c=e.chatData[s],l=new a.SociatyChatModel;l.update(null,c),this.m_sociatyChat.push(l)}this.m_sociatyChat.sort(this.__sort_unionChat)},e.prototype.__sort_unionChat=function(e,t){return e.m_logTime-t.m_logTime},e.prototype.changeChatRoomState=function(e){for(var t=!1,o=0;o<this.m_sociatyChat.length;o++){var i=this.m_sociatyChat[o];if(0==i.m_chatType&&i.m_voChat.chatType==s.TYPE_CHAT.TYPE_CHAT_ROOMFIGHT&&e==i.m_voChat.chatText){i.m_bCloseRoom=!0,t=!0;break}}return t},e.prototype.getSociatyDonateNum=function(e){var t=0;if(this.SociatyPlayerData.donate){var o=this.SociatyPlayerData.donate.get(e);o&&(t=o.dayNum)}return t},e.prototype.isMaxDayExp=function(){var e=!1,t=n.SociatyLevelTableData.getById(this.SociatyData.sociatyLevel);return this.SociatyData.sociatyDayExp>=t.maxDayExp&&(e=!0),e},e.prototype.roleKickPlayer_init64=function(e){for(var t=0;t<this.SociatyData.sociatyplayers.size;t++){var o=Array.from(this.SociatyData.sociatyplayers.keys())[t];this.SociatyData.sociatyplayers.get(o).roleID.equals(e)&&this.SociatyData.sociatyplayers.delete(o)}},e.prototype.changeSociatyPlayerJob=function(e){if(this.SociatyData&&this.SociatyData.sociatyplayers)for(var t=0;t<this.SociatyData.sociatyplayers.size;t++){var o=Array.from(this.SociatyData.sociatyplayers.keys())[t],i=this.SociatyData.sociatyplayers.get(o);if(i.roleID.equals(e.changeRoleID)){i.job=e.newJob;break}}},e.prototype.changeSociatyPlayerJob2=function(e){if(this.SociatyData&&this.SociatyData.sociatyplayers)for(var t=0;t<this.SociatyData.sociatyplayers.size;t++){var o=Array.from(this.SociatyData.sociatyplayers.keys())[t],i=this.SociatyData.sociatyplayers.get(o);if(i.roleID.equals(e.roleID)){i.job=e.roleJob;break}}},e.prototype.getMedalGainValue=function(e){var t=0;switch(e.id){case 1:t=this.SociatyPlayerData.dayConvertSociatyMedal,t-=this.getSociatyDonateNum(1)*r.SociatyDonateNumTableData.getDataMap().get(1).prize[0].dropNum,t-=this.getSociatyDonateNum(2)*r.SociatyDonateNumTableData.getDataMap().get(2).prize[0].dropNum;break;case 2:t=this.getSociatyDonateNum(1)*r.SociatyDonateNumTableData.getDataMap().get(1).prize[0].dropNum;break;case 3:t=this.getSociatyDonateNum(2)*r.SociatyDonateNumTableData.getDataMap().get(2).prize[0].dropNum}return t},e.prototype.addSociatyRedEnvelopeData=function(e,t){this.sociatyRedEnvelopeMap.set(e,t)},e.prototype.clearSociatyRedEnvelopeData=function(){this.sociatyRedEnvelopeMap.clear()},e.prototype.getSociatyRedEnvelopeLength=function(){return this.sociatyRedEnvelopeMap.size},e.prototype.getSociatyRedEnvelopeMap=function(){return this.sociatyRedEnvelopeMap},e.prototype.deleteSociatyRedEnvelopeData=function(e){this.sociatyRedEnvelopeMap.has(e)&&this.sociatyRedEnvelopeMap.delete(e)},e.prototype.checkSociatyRedEnvelopeRedPoint=function(){return!!this.sociatyRedEnvelopeMap&&this.sociatyRedEnvelopeMap.size>0},e.prototype.getMemberTotalScore=function(){return this.memberTotalScore},e.prototype.setFightRankMemberTotalScore=function(e){this.sociatyFightRankMemberTotalScore=e},e.prototype.getFightRankMemberTotalScore=function(){return this.sociatyFightRankMemberTotalScore},e.prototype.getSociatyAuctionState=function(){var e=f.ActivityTableData.getById(g.ACTIVITY_ID_ENUM.P_Activity_SociatyWar),t=u.default.getServersTime(),o=new Date(1e3*t),i=o.getDay(),a=o.getDate(),n=o.getFullYear(),r=o.getMonth()+1;if(e.param2<0||i==e.param2){var s=n+"-"+r+"-"+a+" "+e.param4.toString().slice(0,-2)+":"+e.param4.toString().slice(-2)+":00",c=m.default.timeToTimestamp(s),l=n+"-"+r+"-"+a+" "+e.param5.toString().slice(0,-2)+":"+e.param5.toString().slice(-2)+":00",d=m.default.timeToTimestamp(l);if(t<c)return 6;if(t>=c&&t<d)return this.sociatyFightData&&this.sociatyFightData.failCount,4;var p=d+Number(h.getConfigIntValue("sociaty_auction_show_time")),_=p+Number(h.getConfigIntValue("sociaty_auction_continue_time"));return t<p?1:t>=p&&t<=_+1?2:3}return 5},Object.defineProperty(e.prototype,"SociatyAuctionData",{get:function(){return this.tSociatyAuction},set:function(e){var t=this;this.tSelfJoinAuctionArr.clear(),this.tSociatyAuction=e,e.forEach(function(e){1==u.default.UUID.equals(e.roleID)&&t.tSelfJoinAuctionArr.add(e.id)})},enumerable:!1,configurable:!0}),e.prototype.changeSociatyAuctionData=function(e){var t=this;e.forEach(function(e){for(var o=0;o<t.tSociatyAuction.length;o++)t.tSociatyAuction[o].id==e.id&&(t.tSociatyAuction[o]=e)})},e.prototype.getSelfJoinAuction=function(){return this.tSelfJoinAuctionArr},e}();o.default=_,cc._RF.pop()},{"../../StaticData/ActivityTableData":"ActivityTableData","../../StaticData/SociatyBoxTableData":"SociatyBoxTableData","../../StaticData/SociatyDonateNumTableData":"SociatyDonateNumTableData","../../StaticData/SociatyLevelTableData":"SociatyLevelTableData","../../common/PlayerModule":"PlayerModule","../../modules/base/GameView":"GameView","../../network/protocol/ActivityProtocols":"ActivityProtocols","../../network/protocol/ObjCollection":"ObjCollection","../../network/protocol/SociatyProtocols":"SociatyProtocols","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils","./SociatyChatModel":"SociatyChatModel"}],SociatyOpenRedEnvelopeView:[function(e,t,o){"use strict";cc._RF.push(t,"0d6ecaY5XZDTr9RfjTiPInC","SociatyOpenRedEnvelopeView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=e("../../utils/GameUtils"),l=e("../../utils/ResourcesManager"),d=e("../../Global/GameGlobal"),u=e("../../StaticData/SociatyRedEnvelopeTableData"),h=e("../../utils/GameTools"),p=cc._decorator,f=p.ccclass,g=p.property,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.iconSp=null,t.frameSp=null,t.playerNameLab=null,t.playeTextLab=null,t.timeTextLab=null,t.bgNode=null,t.rewardLayout=null,t}return a(t,e),t.path=function(){return"ui/sociaty/prefab/SociatyOpenRedEnvelope"},t.prototype.onLoad=function(){},t.prototype.init=function(e){var t=this,o=e.data;if(!o)return this.closeView();c.setRemoteHeadIcon(o.headUrl,o.headID,this.iconSp),o.headFrameID<=0&&(o.headFrameID=200),l.default.loadSprite("ui/headFrame/frame_"+o.headFrameID,this.frameSp),this.playerNameLab.string=o.nickName,this.playeTextLab.string=d.G.StringManager.getString("SOCIATY_REDENVELOPE_TEXT",u.SociatyRedEnvelopeTableData.getById(o.redEnvelopeId).name),o.prize.forEach(function(e){h.default.createNormalItems(e.dropID,e.dropNum,t.rewardLayout.node)});var i=function(){var e=Math.floor(o.durationTime/3600),i=Math.floor(o.durationTime/60%60),a=Math.floor(Math.ceil(o.durationTime%60)),n=e<10?"0"+e:e,r=i<10?"0"+i:i,s=a<10?"0"+a:a;t.timeTextLab.string=d.G.StringManager.getString("SOCIATY_REDENVELOPE_TEXT1",n+":"+r+":"+s)};this.schedule(function(){o.durationTime--,o.durationTime<=0?t.timeTextLab.node.active=!1:(t.timeTextLab.node.active=!0,i.call(t))},1),i.call(this),l.default.loadSprite("ui/sociaty/image/"+u.SociatyRedEnvelopeTableData.getById(o.redEnvelopeId).bgPicture,this.bgNode.getComponent(cc.Sprite)),this.scheduleOnce(function(){t.node.on(cc.Node.EventType.TOUCH_END,function(){t.closeView()})},.5)},t.prototype.onDestroy=function(){this.unscheduleAllCallbacks()},n([g(cc.Sprite)],t.prototype,"iconSp",void 0),n([g(cc.Sprite)],t.prototype,"frameSp",void 0),n([g(cc.Label)],t.prototype,"playerNameLab",void 0),n([g(cc.Label)],t.prototype,"playeTextLab",void 0),n([g(cc.Label)],t.prototype,"timeTextLab",void 0),n([g(cc.Node)],t.prototype,"bgNode",void 0),n([g(cc.Layout)],t.prototype,"rewardLayout",void 0),n([s.Register_Class,f],t)}(r.default);o.default=m,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/SociatyRedEnvelopeTableData":"SociatyRedEnvelopeTableData","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils","../../utils/ResourcesManager":"ResourcesManager"}],SociatyProtocols:[function(e,t,o){"use strict";cc._RF.push(t,"6d541pHE4lHII/6rP/cVBDO","SociatyProtocols"),e("DataViewRW");var i=e("ObjCollection"),a=e("long"),n=e("./BaseProtocols").T_Reward,r=e("./BaseProtocols").T_Chat_Data;(function(e){e[e.P_Sociaty_Begin=12e6]="P_Sociaty_Begin",e[e.P_Sociaty_SynData=12000001]="P_Sociaty_SynData",e[e.P_Sociaty_RoleGetRecommendSociaty=12000002]="P_Sociaty_RoleGetRecommendSociaty",e[e.P_Sociaty_RoleGetSociatyData=12000003]="P_Sociaty_RoleGetSociatyData",e[e.P_Sociaty_RoleGetSociatyApplyData=12000004]="P_Sociaty_RoleGetSociatyApplyData",e[e.P_Sociaty_RoleGetSociatySignInData=12000005]="P_Sociaty_RoleGetSociatySignInData",e[e.P_Sociaty_RoleCreateSociaty=12000006]="P_Sociaty_RoleCreateSociaty",e[e.P_Sociaty_RoleJoinSociaty=12000007]="P_Sociaty_RoleJoinSociaty",e[e.P_Sociaty_RoleDispossApplyList=12000008]="P_Sociaty_RoleDispossApplyList",e[e.P_Sociaty_RoleLeaveSociaty=12000009]="P_Sociaty_RoleLeaveSociaty",e[e.P_Sociaty_RoleKickPlayer=12000010]="P_Sociaty_RoleKickPlayer",e[e.P_Sociaty_RoleModifySociaty=12000011]="P_Sociaty_RoleModifySociaty",e[e.P_Sociaty_RoleChangeJob=12000012]="P_Sociaty_RoleChangeJob",e[e.P_Sociaty_RoleDonate=12000013]="P_Sociaty_RoleDonate",e[e.P_Sociaty_RoleInvite=12000014]="P_Sociaty_RoleInvite",e[e.P_Sociaty_RoleDispossInviteList=12000015]="P_Sociaty_RoleDispossInviteList",e[e.P_Sociaty_RoleGetInviteData=12000016]="P_Sociaty_RoleGetInviteData",e[e.P_Sociaty_RoleSignIn=12000017]="P_Sociaty_RoleSignIn",e[e.P_Sociaty_RoleReceiveSignInPrize=12000018]="P_Sociaty_RoleReceiveSignInPrize",e[e.P_Sociaty_RoleGetChatData=12000019]="P_Sociaty_RoleGetChatData",e[e.P_Sociaty_SociatyAddLog=12000020]="P_Sociaty_SociatyAddLog",e[e.P_Sociaty_SendFightLog=12000021]="P_Sociaty_SendFightLog",e[e.P_Sociaty_SynRoleJobChange=12000022]="P_Sociaty_SynRoleJobChange",e[e.P_Sociaty_RoleGetSociatyBoxData=12000023]="P_Sociaty_RoleGetSociatyBoxData",e[e.P_Sociaty_RoleReceiveSociatyBoxPrize=12000024]="P_Sociaty_RoleReceiveSociatyBoxPrize",e[e.P_Sociaty_RoleAddSociatyMsg=12000025]="P_Sociaty_RoleAddSociatyMsg",e[e.P_Sociaty_RoleGetRedEnvelope=12000026]="P_Sociaty_RoleGetRedEnvelope",e[e.P_Sociaty_RoleGetRankListData=12000027]="P_Sociaty_RoleGetRankListData",e[e.P_Sociaty_RoleGetAuctionData=12000028]="P_Sociaty_RoleGetAuctionData",e[e.P_Sociaty_RoleAuction=12000029]="P_Sociaty_RoleAuction",e[e.P_Sociaty_RoleDirectBuy=12000030]="P_Sociaty_RoleDirectBuy",e[e.P_Sociaty_RoleSyncAuctionData=12000031]="P_Sociaty_RoleSyncAuctionData",e[e.P_Sociaty_RoleFocus=12000032]="P_Sociaty_RoleFocus",e[e.P_Sociaty_RoleGetMachinariumData=12000033]="P_Sociaty_RoleGetMachinariumData",e[e.P_Sociaty_SyncMachinariumData=12000034]="P_Sociaty_SyncMachinariumData",e[e.P_Sociaty_RoleGetMachinariumRankListData=12000035]="P_Sociaty_RoleGetMachinariumRankListData",e[e.P_Sociaty_RoleGetMachinariumReward=12000036]="P_Sociaty_RoleGetMachinariumReward",e[e.P_Sociaty_RoleMachinariumSelectCard=12000037]="P_Sociaty_RoleMachinariumSelectCard"})(o.SOCIATY_CLIENT_ENUM||(o.SOCIATY_CLIENT_ENUM={}));var s=function(){function e(){this.dayNum=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.dayNum=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.dayNum)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Sociaty_Player_Donate=s;var c=function(){function e(){this.inviteTime=0,this.roleID=a.fromValue(0),this.nickName="",this.sociatyID="",this.sociatyName="",this.sociatyFlag=0,this.sociatyLevel=0}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<16)return!1;this.inviteTime=e.getInt32(),this.roleID=e.getLong();var t=e.getUint32();if(e.getLen()-e.getPos()<t)return!1;if(this.nickName=e.getString(t),e.getLen()-e.getPos()<4)return!1;var o=e.getUint32();if(e.getLen()-e.getPos()<o)return!1;if(this.sociatyID=e.getString(o),e.getLen()-e.getPos()<4)return!1;var i=e.getUint32();return!(e.getLen()-e.getPos()<i||(this.sociatyName=e.getString(i),e.getLen()-e.getPos()<8||(this.sociatyFlag=e.getInt32(),this.sociatyLevel=e.getInt32(),0)))},e.prototype.writeNoEnd=function(e){e.setInt32(this.inviteTime),e.setLong(this.roleID),e.setString(this.nickName),e.setString(this.sociatyID),e.setString(this.sociatyName),e.setInt32(this.sociatyFlag),e.setInt32(this.sociatyLevel)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Sociaty_Player_Invite=c;var l=function(){function e(){this.activeLeaveSociaty=0,this.passiveLeaveSociaty=0,this.seriesSignInNum=0,this.daySignInSociatyID=0,this.dayReceivePrizeNum=0,this.sociatyID="",this.sociatyName="",this.sociatyLevel=0,this.sociatyFlag=0,this.job=0,this.contribution=0,this.donate=new i.ObjMap,this.dayConvertSociatyMedal=0,this.redEnvelopes=[],this.durationTimes=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<16)return!1;this.activeLeaveSociaty=e.getInt32(),this.passiveLeaveSociaty=e.getInt32(),this.seriesSignInNum=e.getInt32();var t=e.getUint32();if(e.getLen()-e.getPos()<t)return!1;if(this.daySignInSociatyID=e.getString(t),e.getLen()-e.getPos()<8)return!1;this.dayReceivePrizeNum=e.getInt32();var o=e.getUint32();if(e.getLen()-e.getPos()<o)return!1;if(this.sociatyID=e.getString(o),e.getLen()-e.getPos()<4)return!1;var i=e.getUint32();if(e.getLen()-e.getPos()<i)return!1;if(this.sociatyName=e.getString(i),e.getLen()-e.getPos()<20)return!1;this.sociatyLevel=e.getInt32(),this.sociatyFlag=e.getInt32(),this.job=e.getInt32(),this.contribution=e.getInt32();var a=e.getUint32();if(e.getLen()-e.getPos()<8*a)return!1;this.donate.clear();for(var n=0;n<a;++n){var r;r=e.getInt32();var c=new s;if(!c.read(e))return!1;this.donate.set(r,c)}if(e.getLen()-e.getPos()<8)return!1;this.dayConvertSociatyMedal=e.getInt32();var l=e.getUint32();if(e.getLen()-e.getPos()<8*l)return!1;this.redEnvelopes=[];for(var d=0;d<l;++d){var u;u=e.getLong(),this.redEnvelopes.push(u)}if(e.getLen()-e.getPos()<4)return!1;var h=e.getUint32();if(e.getLen()-e.getPos()<4*h)return!1;this.durationTimes=[];for(var p=0;p<h;++p){var f;f=e.getInt32(),this.durationTimes.push(f)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.activeLeaveSociaty),e.setInt32(this.passiveLeaveSociaty),e.setInt32(this.seriesSignInNum),e.setString(this.daySignInSociatyID),e.setInt32(this.dayReceivePrizeNum),e.setString(this.sociatyID),e.setString(this.sociatyName),e.setInt32(this.sociatyLevel),e.setInt32(this.sociatyFlag),e.setInt32(this.job),e.setInt32(this.contribution),e.setUint32(this.donate.size),this.donate.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)}),e.setInt32(this.dayConvertSociatyMedal),e.setUint32(this.redEnvelopes.length),this.redEnvelopes.forEach(function(t){e.setLong(t)}),e.setUint32(this.durationTimes.length),this.durationTimes.forEach(function(t){e.setInt32(t)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Sociaty_Player=l;var d=function(){function e(){this.roleID=a.fromValue(0),this.showID="",this.isOnline=!1,this.nickName="",this.logoutTime=0,this.headID=0,this.headUrl="",this.headFrameID=0,this.level=0,this.score=0,this.job=0,this.contribution=0,this.enterSeasonID=0,this.sociatySeasonMedal=0,this.sociatyDayMedal=0}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<12)return!1;this.roleID=e.getLong();var t=e.getUint32();if(e.getLen()-e.getPos()<t)return!1;if(this.showID=e.getString(t),e.getLen()-e.getPos()<5)return!1;this.isOnline=e.getBool();var o=e.getUint32();if(e.getLen()-e.getPos()<o)return!1;if(this.nickName=e.getString(o),e.getLen()-e.getPos()<12)return!1;this.logoutTime=e.getInt32(),this.headID=e.getInt32();var i=e.getUint32();return!(e.getLen()-e.getPos()<i||(this.headUrl=e.getString(i),e.getLen()-e.getPos()<32||(this.headFrameID=e.getInt32(),this.level=e.getInt32(),this.score=e.getInt32(),this.job=e.getInt32(),this.contribution=e.getInt32(),this.enterSeasonID=e.getInt32(),this.sociatySeasonMedal=e.getInt32(),this.sociatyDayMedal=e.getInt32(),0)))},e.prototype.writeNoEnd=function(e){e.setLong(this.roleID),e.setString(this.showID),e.setBool(this.isOnline),e.setString(this.nickName),e.setInt32(this.logoutTime),e.setInt32(this.headID),e.setString(this.headUrl),e.setInt32(this.headFrameID),e.setInt32(this.level),e.setInt32(this.score),e.setInt32(this.job),e.setInt32(this.contribution),e.setInt32(this.enterSeasonID),e.setInt32(this.sociatySeasonMedal),e.setInt32(this.sociatyDayMedal)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Sociaty_SociatyPlayer=d;var u=function(){function e(){this.applyTime=0,this.roleID=a.fromValue(0),this.showID="",this.nickName="",this.headID=0,this.headUrl="",this.headFrameID=0,this.level=0,this.score=0}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<16)return!1;this.applyTime=e.getInt32(),this.roleID=e.getLong();var t=e.getUint32();if(e.getLen()-e.getPos()<t)return!1;if(this.showID=e.getString(t),e.getLen()-e.getPos()<4)return!1;var o=e.getUint32();if(e.getLen()-e.getPos()<o)return!1;if(this.nickName=e.getString(o),e.getLen()-e.getPos()<8)return!1;this.headID=e.getInt32();var i=e.getUint32();return!(e.getLen()-e.getPos()<i||(this.headUrl=e.getString(i),e.getLen()-e.getPos()<12||(this.headFrameID=e.getInt32(),this.level=e.getInt32(),this.score=e.getInt32(),0)))},e.prototype.writeNoEnd=function(e){e.setInt32(this.applyTime),e.setLong(this.roleID),e.setString(this.showID),e.setString(this.nickName),e.setInt32(this.headID),e.setString(this.headUrl),e.setInt32(this.headFrameID),e.setInt32(this.level),e.setInt32(this.score)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Sociaty_ApplyPlayer=u;var h=function(){function e(){this.players=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();this.players.clear();for(var o=0;o<t;++o){var i;i=e.getLong();var a=new u;if(!a.read(e))return!1;this.players.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setUint32(this.players.size),this.players.forEach(function(t,o){e.setLong(o),t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Sociaty_Apply=h;var p=function(){function e(){this.roleID=a.fromValue(0),this.showID="",this.nickName="",this.headID=0,this.headUrl="",this.headFrameID=0,this.seriesSignInNum=0}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<12)return!1;this.roleID=e.getLong();var t=e.getUint32();if(e.getLen()-e.getPos()<t)return!1;if(this.showID=e.getString(t),e.getLen()-e.getPos()<4)return!1;var o=e.getUint32();if(e.getLen()-e.getPos()<o)return!1;if(this.nickName=e.getString(o),e.getLen()-e.getPos()<8)return!1;this.headID=e.getInt32();var i=e.getUint32();return!(e.getLen()-e.getPos()<i||(this.headUrl=e.getString(i),e.getLen()-e.getPos()<8||(this.headFrameID=e.getInt32(),this.seriesSignInNum=e.getInt32(),0)))},e.prototype.writeNoEnd=function(e){e.setLong(this.roleID),e.setString(this.showID),e.setString(this.nickName),e.setInt32(this.headID),e.setString(this.headUrl),e.setInt32(this.headFrameID),e.setInt32(this.seriesSignInNum)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Sociaty_SignInPlayer=p;var f=function(){function e(){this.currLevel=0,this.currSignInExp=0,this.currPrizeID=0,this.currPrizeNum=0,this.signinPlayer=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<20)return!1;this.currLevel=e.getInt32(),this.currSignInExp=e.getInt32(),this.currPrizeID=e.getInt32(),this.currPrizeNum=e.getInt32();var t=e.getUint32();this.signinPlayer=[];for(var o=0;o<t;++o){var i=new p;if(!i.read(e))return!1;this.signinPlayer.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.currLevel),e.setInt32(this.currSignInExp),e.setInt32(this.currPrizeID),e.setInt32(this.currPrizeNum),e.setUint32(this.signinPlayer.length),this.signinPlayer.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Sociaty_SignIn=f;var g=function(){function e(){this.type=0,this.logTime=0,this.param1="",this.param2=""}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<12)return!1;this.type=e.getInt32(),this.logTime=e.getInt32();var t=e.getUint32();if(e.getLen()-e.getPos()<t)return!1;if(this.param1=e.getString(t),e.getLen()-e.getPos()<4)return!1;var o=e.getUint32();return!(e.getLen()-e.getPos()<o||(this.param2=e.getString(o),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.type),e.setInt32(this.logTime),e.setString(this.param1),e.setString(this.param2)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Sociaty_Log=g;var m=function(){function e(){this.logs=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();this.logs=[];for(var o=0;o<t;++o){var i=new g;if(!i.read(e))return!1;this.logs.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setUint32(this.logs.length),this.logs.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Sociaty_LogData=m;var _=function(){function e(){this.sociatyID="",this.sociatyName="",this.sociatyFlag=0,this.sociatyNotice="",this.enterType=0,this.enterScore=0,this.sociatyLevel=0,this.sociatyExp=0,this.sociatyDayExp=0,this.sociatySeasonID=0,this.sociatySeasonLeftTime=0,this.sociatyGrade=0,this.sociatyGradeSub=0,this.sociatyGradeExp=0,this.sociatyMedal=0,this.sociatyDayMedal=0,this.currPlayerNum=0,this.totalScore=0,this.sociatyplayers=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();if(e.getLen()-e.getPos()<t)return!1;if(this.sociatyID=e.getString(t),e.getLen()-e.getPos()<4)return!1;var o=e.getUint32();if(e.getLen()-e.getPos()<o)return!1;if(this.sociatyName=e.getString(o),e.getLen()-e.getPos()<8)return!1;this.sociatyFlag=e.getInt32();var i=e.getUint32();if(e.getLen()-e.getPos()<i)return!1;if(this.sociatyNotice=e.getString(i),e.getLen()-e.getPos()<60)return!1;this.enterType=e.getInt32(),this.enterScore=e.getInt32(),this.sociatyLevel=e.getInt32(),this.sociatyExp=e.getInt32(),this.sociatyDayExp=e.getInt32(),this.sociatySeasonID=e.getInt32(),this.sociatySeasonLeftTime=e.getInt32(),this.sociatyGrade=e.getInt32(),this.sociatyGradeSub=e.getInt32(),this.sociatyGradeExp=e.getInt32(),this.sociatyMedal=e.getInt32(),this.sociatyDayMedal=e.getInt32(),this.currPlayerNum=e.getInt32(),this.totalScore=e.getInt32();var a=e.getUint32();this.sociatyplayers.clear();for(var n=0;n<a;++n){var r;r=e.getLong();var s=new d;if(!s.read(e))return!1;this.sociatyplayers.set(r,s)}return!0},e.prototype.writeNoEnd=function(e){e.setString(this.sociatyID),e.setString(this.sociatyName),e.setInt32(this.sociatyFlag),e.setString(this.sociatyNotice),e.setInt32(this.enterType),e.setInt32(this.enterScore),e.setInt32(this.sociatyLevel),e.setInt32(this.sociatyExp),e.setInt32(this.sociatyDayExp),e.setInt32(this.sociatySeasonID),e.setInt32(this.sociatySeasonLeftTime),e.setInt32(this.sociatyGrade),e.setInt32(this.sociatyGradeSub),e.setInt32(this.sociatyGradeExp),e.setInt32(this.sociatyMedal),e.setInt32(this.sociatyDayMedal),e.setInt32(this.currPlayerNum),e.setInt32(this.totalScore),e.setUint32(this.sociatyplayers.size),this.sociatyplayers.forEach(function(t,o){e.setLong(o),t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Sociaty_Sociaty=_;var y=function(){function e(){this.heroID=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.heroID=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.heroID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Sociaty_Fight_Hero_Log=y;var v=function(){function e(){this.roleID=a.fromValue(0),this.nickName="",this.headID=0,this.headUrl="",this.headFrameID=0,this.level=1,this.score=0,this.heros=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<12)return!1;this.roleID=e.getLong();var t=e.getUint32();if(e.getLen()-e.getPos()<t)return!1;if(this.nickName=e.getString(t),e.getLen()-e.getPos()<8)return!1;this.headID=e.getInt32();var o=e.getUint32();if(e.getLen()-e.getPos()<o)return!1;if(this.headUrl=e.getString(o),e.getLen()-e.getPos()<16)return!1;this.headFrameID=e.getInt32(),this.level=e.getInt32(),this.score=e.getInt32();var i=e.getUint32();if(e.getLen()-e.getPos()<8*i)return!1;this.heros.clear();for(var a=0;a<i;++a){var n;n=e.getInt32();var r=new y;if(!r.read(e))return!1;this.heros.set(n,r)}return!0},e.prototype.writeNoEnd=function(e){e.setLong(this.roleID),e.setString(this.nickName),e.setInt32(this.headID),e.setString(this.headUrl),e.setInt32(this.headFrameID),e.setInt32(this.level),e.setInt32(this.score),e.setUint32(this.heros.size),this.heros.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Sociaty_Fight_Player_Log=v;var C=function(){function e(){this.logTime=0,this.type=0,this.winRoleID=a.fromValue(0),this.players=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<20)return!1;this.logTime=e.getInt32(),this.type=e.getInt32(),this.winRoleID=e.getLong();var t=e.getUint32();this.players.clear();for(var o=0;o<t;++o){var i;i=e.getLong();var a=new v;if(!a.read(e))return!1;this.players.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.logTime),e.setInt32(this.type),e.setLong(this.winRoleID),e.setUint32(this.players.size),this.players.forEach(function(t,o){e.setLong(o),t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Sociaty_Fight_Log=C;var S=function(){function e(){this.roleID=a.fromValue(0),this.nickName="",this.headID=0,this.headUrl="",this.headFrameID=0,this.msg=""}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<12)return!1;this.roleID=e.getLong();var t=e.getUint32();if(e.getLen()-e.getPos()<t)return!1;if(this.nickName=e.getString(t),e.getLen()-e.getPos()<8)return!1;this.headID=e.getInt32();var o=e.getUint32();if(e.getLen()-e.getPos()<o)return!1;if(this.headUrl=e.getString(o),e.getLen()-e.getPos()<8)return!1;this.headFrameID=e.getInt32();var i=e.getUint32();return!(e.getLen()-e.getPos()<i||(this.msg=e.getString(i),0))},e.prototype.writeNoEnd=function(e){e.setLong(this.roleID),e.setString(this.nickName),e.setInt32(this.headID),e.setString(this.headUrl),e.setInt32(this.headFrameID),e.setString(this.msg)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Sociaty_Box_Player_Msg=S;var T=function(){function e(){this.playermsg=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();this.playermsg=[];for(var o=0;o<t;++o){var i=new S;if(!i.read(e))return!1;this.playermsg.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setUint32(this.playermsg.length),this.playermsg.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Sociaty_Box=T;var I=function(){function e(){this.boxs=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();this.boxs.clear();for(var o=0;o<t;++o){var i;i=e.getInt32();var a=new T;if(!a.read(e))return!1;this.boxs.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setUint32(this.boxs.size),this.boxs.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Sociaty_BoxData=I;var N=function(){function e(){this.receiveMap=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();if(e.getLen()-e.getPos()<5*t)return!1;this.receiveMap.clear();for(var o=0;o<t;++o){var i,a;i=e.getInt32(),a=e.getBool(),this.receiveMap.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setUint32(this.receiveMap.size),this.receiveMap.forEach(function(t,o){e.setInt32(o),e.setBool(t)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Sociaty_Player_SociatyBox=N;var b=function(){function e(){this.boxsMap=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();this.boxsMap.clear();for(var o=0;o<t;++o){var i;i=e.getInt32();var a=new N;if(!a.read(e))return!1;this.boxsMap.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setUint32(this.boxsMap.size),this.boxsMap.forEach(function(t,o){e.setInt32(o),t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Sociaty_Player_SociatyBoxData=b,function(e){e[e.ErrorCode_Sociaty_Success=0]="ErrorCode_Sociaty_Success",e[e.ErrorCode_Sociaty_Failed=10001]="ErrorCode_Sociaty_Failed",e[e.ErrorCode_Sociaty_NoOpen=10002]="ErrorCode_Sociaty_NoOpen",e[e.ErrorCode_Sociaty_NoSociatyLevelTable=10003]="ErrorCode_Sociaty_NoSociatyLevelTable",e[e.ErrorCode_Sociaty_HaveMaxPlayer=10004]="ErrorCode_Sociaty_HaveMaxPlayer",e[e.ErrorCode_Sociaty_ActiveLeaveSociaty=10005]="ErrorCode_Sociaty_ActiveLeaveSociaty",e[e.ErrorCode_Sociaty_PassiveLeaveSociaty=10006]="ErrorCode_Sociaty_PassiveLeaveSociaty",e[e.ErrorCode_Sociaty_NoEnterScore=10007]="ErrorCode_Sociaty_NoEnterScore",e[e.ErrorCode_Sociaty_ForbidEnter=10008]="ErrorCode_Sociaty_ForbidEnter",e[e.ErrorCode_Sociaty_OperLock=10009]="ErrorCode_Sociaty_OperLock",e[e.ErrorCode_Sociaty_NameLen=10010]="ErrorCode_Sociaty_NameLen",e[e.ErrorCode_Sociaty_NameHasFilterWords=10011]="ErrorCode_Sociaty_NameHasFilterWords",e[e.ErrorCode_Sociaty_NoticeLen=10012]="ErrorCode_Sociaty_NoticeLen",e[e.ErrorCode_Sociaty_NoticeHasFilterWords=10013]="ErrorCode_Sociaty_NoticeHasFilterWords",e[e.ErrorCode_Sociaty_NotInSameServerGroup=10014]="ErrorCode_Sociaty_NotInSameServerGroup",e[e.ErrorCode_Sociaty_InSociatyWar=10015]="ErrorCode_Sociaty_InSociatyWar"}(o.ErrorCode_Sociaty||(o.ErrorCode_Sociaty={}));var w=function(){function e(){this.playerData=new l}return e.prototype.read=function(e){return!!this.playerData.read(e)},e.prototype.writeNoEnd=function(e){this.playerData.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Sociaty_SynData=w;var E=function(){function e(){}return e.prototype.read=function(){return!0},e.prototype.writeNoEnd=function(){},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Sociaty_RoleGetRecommendSociaty=E,function(e){e[e.ErrorCode_Sociaty_RoleGetRecommendSociaty_Success=0]="ErrorCode_Sociaty_RoleGetRecommendSociaty_Success",e[e.ErrorCode_Sociaty_RoleGetRecommendSociaty_Failed=1]="ErrorCode_Sociaty_RoleGetRecommendSociaty_Failed",e[e.ErrorCode_Sociaty_RoleGetRecommendSociaty_NoPlayer=2]="ErrorCode_Sociaty_RoleGetRecommendSociaty_NoPlayer",e[e.ErrorCode_Sociaty_RoleGetRecommendSociaty_HaveSociaty=3]="ErrorCode_Sociaty_RoleGetRecommendSociaty_HaveSociaty"}(o.ErrorCode_Sociaty_RoleGetRecommendSociaty||(o.ErrorCode_Sociaty_RoleGetRecommendSociaty={}));var P=function(){function e(){this.errorcode=0,this.sociatys=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.errorcode=e.getInt32();var t=e.getUint32();this.sociatys=[];for(var o=0;o<t;++o){var i=new _;if(!i.read(e))return!1;this.sociatys.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setUint32(this.sociatys.length),this.sociatys.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Sociaty_RoleGetRecommendSociaty=P;var R=function(){function e(){this.sociatyID=""}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();return!(e.getLen()-e.getPos()<t||(this.sociatyID=e.getString(t),0))},e.prototype.writeNoEnd=function(e){e.setString(this.sociatyID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Sociaty_RoleGetSociatyData=R,function(e){e[e.ErrorCode_Sociaty_RoleGetSociatyData_Success=0]="ErrorCode_Sociaty_RoleGetSociatyData_Success",e[e.ErrorCode_Sociaty_RoleGetSociatyData_Failed=1]="ErrorCode_Sociaty_RoleGetSociatyData_Failed",e[e.ErrorCode_Sociaty_RoleGetSociatyData_NoSociaty=2]="ErrorCode_Sociaty_RoleGetSociatyData_NoSociaty"}(o.ErrorCode_Sociaty_RoleGetSociatyData||(o.ErrorCode_Sociaty_RoleGetSociatyData={}));var L=function(){function e(){this.errorcode=0,this.sociatyData=new _}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),!this.sociatyData.read(e)))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),this.sociatyData.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Sociaty_RoleGetSociatyData=L;var A=function(){function e(){}return e.prototype.read=function(){return!0},e.prototype.writeNoEnd=function(){},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Sociaty_RoleGetSociatyApplyData=A,function(e){e[e.ErrorCode_Sociaty_RoleGetSociatyApplyData_Success=0]="ErrorCode_Sociaty_RoleGetSociatyApplyData_Success",e[e.ErrorCode_Sociaty_RoleGetSociatyApplyData_Failed=1]="ErrorCode_Sociaty_RoleGetSociatyApplyData_Failed",e[e.ErrorCode_Sociaty_RoleGetSociatyApplyData_NoPlayer=2]="ErrorCode_Sociaty_RoleGetSociatyApplyData_NoPlayer",e[e.ErrorCode_Sociaty_RoleGetSociatyApplyData_NoSCPlayer=3]="ErrorCode_Sociaty_RoleGetSociatyApplyData_NoSCPlayer",e[e.ErrorCode_Sociaty_RoleGetSociatyApplyData_NoSociaty=4]="ErrorCode_Sociaty_RoleGetSociatyApplyData_NoSociaty"}(o.ErrorCode_Sociaty_RoleGetSociatyApplyData||(o.ErrorCode_Sociaty_RoleGetSociatyApplyData={}));var D=function(){function e(){this.errorcode=0,this.applyData=new h}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),!this.applyData.read(e)))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),this.applyData.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Sociaty_RoleGetSociatyApplyData=D;var M=function(){function e(){}return e.prototype.read=function(){return!0},e.prototype.writeNoEnd=function(){},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Sociaty_RoleGetSociatySignInData=M,function(e){e[e.ErrorCode_Sociaty_RoleGetSociatySignInData_Success=0]="ErrorCode_Sociaty_RoleGetSociatySignInData_Success",e[e.ErrorCode_Sociaty_RoleGetSociatySignInData_Failed=1]="ErrorCode_Sociaty_RoleGetSociatySignInData_Failed",e[e.ErrorCode_Sociaty_RoleGetSociatySignInData_NoPlayer=2]="ErrorCode_Sociaty_RoleGetSociatySignInData_NoPlayer",e[e.ErrorCode_Sociaty_RoleGetSociatySignInData_NoSCPlayer=3]="ErrorCode_Sociaty_RoleGetSociatySignInData_NoSCPlayer",e[e.ErrorCode_Sociaty_RoleGetSociatySignInData_NoSociaty=4]="ErrorCode_Sociaty_RoleGetSociatySignInData_NoSociaty"}(o.ErrorCode_Sociaty_RoleGetSociatySignInData||(o.ErrorCode_Sociaty_RoleGetSociatySignInData={}));var B=function(){function e(){this.errorcode=0,this.signinData=new f}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),!this.signinData.read(e)))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),this.signinData.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Sociaty_RoleGetSociatySignInData=B;var k=function(){function e(){this.sociatyName="",this.sociatyFlag=0,this.sociatyNotice="",this.enterType=0,this.enterScore=0}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();if(e.getLen()-e.getPos()<t)return!1;if(this.sociatyName=e.getString(t),e.getLen()-e.getPos()<8)return!1;this.sociatyFlag=e.getInt32();var o=e.getUint32();return!(e.getLen()-e.getPos()<o||(this.sociatyNotice=e.getString(o),e.getLen()-e.getPos()<8||(this.enterType=e.getInt32(),this.enterScore=e.getInt32(),0)))},e.prototype.writeNoEnd=function(e){e.setString(this.sociatyName),e.setInt32(this.sociatyFlag),e.setString(this.sociatyNotice),e.setInt32(this.enterType),e.setInt32(this.enterScore)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Sociaty_RoleCreateSociaty=k,function(e){e[e.ErrorCode_Sociaty_RoleCreateSociaty_Success=0]="ErrorCode_Sociaty_RoleCreateSociaty_Success",e[e.ErrorCode_Sociaty_RoleCreateSociaty_Failed=1]="ErrorCode_Sociaty_RoleCreateSociaty_Failed",e[e.ErrorCode_Sociaty_RoleCreateSociaty_NoPlayer=2]="ErrorCode_Sociaty_RoleCreateSociaty_NoPlayer",e[e.ErrorCode_Sociaty_RoleCreateSociaty_HaveSociaty=3]="ErrorCode_Sociaty_RoleCreateSociaty_HaveSociaty",e[e.ErrorCode_Sociaty_RoleCreateSociaty_AddSociaty=4]="ErrorCode_Sociaty_RoleCreateSociaty_AddSociaty",e[e.ErrorCode_Sociaty_RoleCreateSociaty_AddSCPlayer=5]="ErrorCode_Sociaty_RoleCreateSociaty_AddSCPlayer",e[e.ErrorCode_Sociaty_RoleCreateSociaty_NameLen=6]="ErrorCode_Sociaty_RoleCreateSociaty_NameLen",e[e.ErrorCode_Sociaty_RoleCreateSociaty_NameHasFilterWords=7]="ErrorCode_Sociaty_RoleCreateSociaty_NameHasFilterWords",e[e.ErrorCode_Sociaty_RoleCreateSociaty_NoticeLen=8]="ErrorCode_Sociaty_RoleCreateSociaty_NoticeLen",e[e.ErrorCode_Sociaty_RoleCreateSociaty_NoticeHasFilterWords=9]="ErrorCode_Sociaty_RoleCreateSociaty_NoticeHasFilterWords",e[e.ErrorCode_Sociaty_RoleCreateSociaty_NoCost=10]="ErrorCode_Sociaty_RoleCreateSociaty_NoCost",e[e.ErrorCode_Sociaty_RoleCreateSociaty_FlagErr=11]="ErrorCode_Sociaty_RoleCreateSociaty_FlagErr",e[e.ErrorCode_Sociaty_RoleCreateSociaty_HaveSameName=12]="ErrorCode_Sociaty_RoleCreateSociaty_HaveSameName"}(o.ErrorCode_Sociaty_RoleCreateSociaty||(o.ErrorCode_Sociaty_RoleCreateSociaty={}));var G=function(){function e(){this.errorcode=0,this.sociatyData=new _}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),!this.sociatyData.read(e)))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),this.sociatyData.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Sociaty_RoleCreateSociaty=G;var O=function(){function e(){this.sociatyID=""}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();return!(e.getLen()-e.getPos()<t||(this.sociatyID=e.getString(t),0))},e.prototype.writeNoEnd=function(e){e.setString(this.sociatyID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Sociaty_RoleJoinSociaty=O,function(e){e[e.ErrorCode_Sociaty_RoleJoinSociaty_Success=0]="ErrorCode_Sociaty_RoleJoinSociaty_Success",e[e.ErrorCode_Sociaty_RoleJoinSociaty_Failed=1]="ErrorCode_Sociaty_RoleJoinSociaty_Failed",e[e.ErrorCode_Sociaty_RoleJoinSociaty_NoPlayer=2]="ErrorCode_Sociaty_RoleJoinSociaty_NoPlayer",e[e.ErrorCode_Sociaty_RoleJoinSociaty_NoSociaty=3]="ErrorCode_Sociaty_RoleJoinSociaty_NoSociaty",e[e.ErrorCode_Sociaty_RoleJoinSociaty_HaveSociaty=4]="ErrorCode_Sociaty_RoleJoinSociaty_HaveSociaty",e[e.ErrorCode_Sociaty_RoleJoinSociaty_EnterType=5]="ErrorCode_Sociaty_RoleJoinSociaty_EnterType",e[e.ErrorCode_Sociaty_RoleJoinSociaty_ServerGroup_Error=6]="ErrorCode_Sociaty_RoleJoinSociaty_ServerGroup_Error"}(o.ErrorCode_Sociaty_RoleJoinSociaty||(o.ErrorCode_Sociaty_RoleJoinSociaty={}));var H=function(){function e(){this.errorcode=0,this.sociatyID="",this.enterType=0,this.sociatyData=new _}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.errorcode=e.getInt32();var t=e.getUint32();return!(e.getLen()-e.getPos()<t||(this.sociatyID=e.getString(t),e.getLen()-e.getPos()<4||(this.enterType=e.getInt32(),!this.sociatyData.read(e))))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setString(this.sociatyID),e.setInt32(this.enterType),this.sociatyData.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Sociaty_RoleJoinSociaty=H,function(e){e[e.ProType_Sociaty_RoleDispossApplyList_AddPlayer=1]="ProType_Sociaty_RoleDispossApplyList_AddPlayer",e[e.ProType_Sociaty_RoleDispossApplyList_DelPlayer=2]="ProType_Sociaty_RoleDispossApplyList_DelPlayer",e[e.ProType_Sociaty_RoleDispossApplyList_ClearList=3]="ProType_Sociaty_RoleDispossApplyList_ClearList"}(o.ProType_Sociaty_RoleDispossApplyList||(o.ProType_Sociaty_RoleDispossApplyList={}));var V=function(){function e(){this.dispossType=0,this.applyRoleID=a.fromValue(0)}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<12||(this.dispossType=e.getInt32(),this.applyRoleID=e.getLong(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.dispossType),e.setLong(this.applyRoleID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Sociaty_RoleDispossApplyList=V,function(e){e[e.ErrorCode_Sociaty_RoleDispossApplyList_Success=0]="ErrorCode_Sociaty_RoleDispossApplyList_Success",e[e.ErrorCode_Sociaty_RoleDispossApplyList_Failed=1]="ErrorCode_Sociaty_RoleDispossApplyList_Failed",e[e.ErrorCode_Sociaty_RoleDispossApplyList_NoPlayer=2]="ErrorCode_Sociaty_RoleDispossApplyList_NoPlayer",e[e.ErrorCode_Sociaty_RoleDispossApplyList_NoSCPlayer=3]="ErrorCode_Sociaty_RoleDispossApplyList_NoSCPlayer",e[e.ErrorCode_Sociaty_RoleDispossApplyList_NoAuth=4]="ErrorCode_Sociaty_RoleDispossApplyList_NoAuth",e[e.ErrorCode_Sociaty_RoleDispossApplyList_NoSociaty=5]="ErrorCode_Sociaty_RoleDispossApplyList_NoSociaty",e[e.ErrorCode_Sociaty_RoleDispossApplyList_NoApplyPlayer=6]="ErrorCode_Sociaty_RoleDispossApplyList_NoApplyPlayer",e[e.ErrorCode_Sociaty_RoleDispossApplyList_NoInApplyList=7]="ErrorCode_Sociaty_RoleDispossApplyList_NoInApplyList",e[e.ErrorCode_Sociaty_RoleDispossApplyList_ApplyPlayerHaveSociaty=8]="ErrorCode_Sociaty_RoleDispossApplyList_ApplyPlayerHaveSociaty",e[e.ErrorCode_Sociaty_RoleDispossApplyList_DispossType=9]="ErrorCode_Sociaty_RoleDispossApplyList_DispossType"}(o.ErrorCode_Sociaty_RoleDispossApplyList||(o.ErrorCode_Sociaty_RoleDispossApplyList={}));var F=function(){function e(){this.errorcode=0,this.dispossType=0,this.applyRoleID=a.fromValue(0),this.applyPlayer=new d}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<16||(this.errorcode=e.getInt32(),this.dispossType=e.getInt32(),this.applyRoleID=e.getLong(),!this.applyPlayer.read(e)))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setInt32(this.dispossType),e.setLong(this.applyRoleID),this.applyPlayer.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Sociaty_RoleDispossApplyList=F;var U=function(){function e(){}return e.prototype.read=function(){return!0},e.prototype.writeNoEnd=function(){},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Sociaty_RoleLeaveSociaty=U,function(e){e[e.ErrorCode_Sociaty_RoleLeaveSociaty_Success=0]="ErrorCode_Sociaty_RoleLeaveSociaty_Success",e[e.ErrorCode_Sociaty_RoleLeaveSociaty_Failed=1]="ErrorCode_Sociaty_RoleLeaveSociaty_Failed",e[e.ErrorCode_Sociaty_RoleLeaveSociaty_NoPlayer=2]="ErrorCode_Sociaty_RoleLeaveSociaty_NoPlayer",e[e.ErrorCode_Sociaty_RoleLeaveSociaty_NoSCPlayer=3]="ErrorCode_Sociaty_RoleLeaveSociaty_NoSCPlayer",e[e.ErrorCode_Sociaty_RoleLeaveSociaty_NoSociaty=4]="ErrorCode_Sociaty_RoleLeaveSociaty_NoSociaty",e[e.ErrorCode_Sociaty_RoleLeaveSociaty_PresidentCanNot=5]="ErrorCode_Sociaty_RoleLeaveSociaty_PresidentCanNot"}(o.ErrorCode_Sociaty_RoleLeaveSociaty||(o.ErrorCode_Sociaty_RoleLeaveSociaty={}));var x=function(){function e(){this.errorcode=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Sociaty_RoleLeaveSociaty=x;var Y=function(){function e(){this.kickPlayerID=a.fromValue(0)}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.kickPlayerID=e.getLong(),0))},e.prototype.writeNoEnd=function(e){e.setLong(this.kickPlayerID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Sociaty_RoleKickPlayer=Y,function(e){e[e.ErrorCode_Sociaty_RoleKickPlayer_Success=0]="ErrorCode_Sociaty_RoleKickPlayer_Success",e[e.ErrorCode_Sociaty_RoleKickPlayer_Failed=1]="ErrorCode_Sociaty_RoleKickPlayer_Failed",e[e.ErrorCode_Sociaty_RoleKickPlayer_NoPlayer=2]="ErrorCode_Sociaty_RoleKickPlayer_NoPlayer",e[e.ErrorCode_Sociaty_RoleKickPlayer_NoSCPlayer=3]="ErrorCode_Sociaty_RoleKickPlayer_NoSCPlayer",e[e.ErrorCode_Sociaty_RoleKickPlayer_NoSociaty=4]="ErrorCode_Sociaty_RoleKickPlayer_NoSociaty",e[e.ErrorCode_Sociaty_RoleKickPlayer_NoAuth=5]="ErrorCode_Sociaty_RoleKickPlayer_NoAuth",e[e.ErrorCode_Sociaty_RoleKickPlayer_NoKickSCPlayer=6]="ErrorCode_Sociaty_RoleKickPlayer_NoKickSCPlayer",e[e.ErrorCode_Sociaty_RoleKickPlayer_NoKickPlayer=7]="ErrorCode_Sociaty_RoleKickPlayer_NoKickPlayer",e[e.ErrorCode_Sociaty_RoleKickPlayer_JobNoBeyondKickPlayer=8]="ErrorCode_Sociaty_RoleKickPlayer_JobNoBeyondKickPlayer"}(o.ErrorCode_Sociaty_RoleKickPlayer||(o.ErrorCode_Sociaty_RoleKickPlayer={}));var j=function(){function e(){this.errorcode=0,this.kickPlayerID=a.fromValue(0)}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<12||(this.errorcode=e.getInt32(),this.kickPlayerID=e.getLong(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setLong(this.kickPlayerID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Sociaty_RoleKickPlayer=j;var W=function(){function e(){this.sociatyName="",this.sociatyFlag=0,this.sociatyNotice="",this.enterType=0,this.enterScore=0}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();if(e.getLen()-e.getPos()<t)return!1;if(this.sociatyName=e.getString(t),e.getLen()-e.getPos()<8)return!1;this.sociatyFlag=e.getInt32();var o=e.getUint32();return!(e.getLen()-e.getPos()<o||(this.sociatyNotice=e.getString(o),e.getLen()-e.getPos()<8||(this.enterType=e.getInt32(),this.enterScore=e.getInt32(),0)))},e.prototype.writeNoEnd=function(e){e.setString(this.sociatyName),e.setInt32(this.sociatyFlag),e.setString(this.sociatyNotice),e.setInt32(this.enterType),e.setInt32(this.enterScore)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Sociaty_RoleModifySociaty=W,function(e){e[e.ErrorCode_Sociaty_RoleModifySociaty_Success=0]="ErrorCode_Sociaty_RoleModifySociaty_Success",e[e.ErrorCode_Sociaty_RoleModifySociaty_Failed=1]="ErrorCode_Sociaty_RoleModifySociaty_Failed",e[e.ErrorCode_Sociaty_RoleModifySociaty_NoPlayer=2]="ErrorCode_Sociaty_RoleModifySociaty_NoPlayer",e[e.ErrorCode_Sociaty_RoleModifySociaty_NoSCPlayer=3]="ErrorCode_Sociaty_RoleModifySociaty_NoSCPlayer",e[e.ErrorCode_Sociaty_RoleModifySociaty_NoSociaty=4]="ErrorCode_Sociaty_RoleModifySociaty_NoSociaty",e[e.ErrorCode_Sociaty_RoleModifySociaty_NoAuth=5]="ErrorCode_Sociaty_RoleModifySociaty_NoAuth",e[e.ErrorCode_Sociaty_RoleModifySociaty_NameLen=6]="ErrorCode_Sociaty_RoleModifySociaty_NameLen",e[e.ErrorCode_Sociaty_RoleModifySociaty_NameHasFilterWords=7]="ErrorCode_Sociaty_RoleModifySociaty_NameHasFilterWords",e[e.ErrorCode_Sociaty_RoleModifySociaty_NoticeLen=8]="ErrorCode_Sociaty_RoleModifySociaty_NoticeLen",e[e.ErrorCode_Sociaty_RoleModifySociaty_NoticeHasFilterWords=9]="ErrorCode_Sociaty_RoleModifySociaty_NoticeHasFilterWords",e[e.ErrorCode_Sociaty_RoleModifySociaty_FlagErr=10]="ErrorCode_Sociaty_RoleModifySociaty_FlagErr",e[e.ErrorCode_Sociaty_RoleModifySociaty_HaveSameName=11]="ErrorCode_Sociaty_RoleModifySociaty_HaveSameName"}(o.ErrorCode_Sociaty_RoleModifySociaty||(o.ErrorCode_Sociaty_RoleModifySociaty={}));var z=function(){function e(){this.errorcode=0,this.sociatyData=new _}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),!this.sociatyData.read(e)))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),this.sociatyData.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Sociaty_RoleModifySociaty=z;var K=function(){function e(){this.changeRoleID=a.fromValue(0),this.newJob=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<12||(this.changeRoleID=e.getLong(),this.newJob=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setLong(this.changeRoleID),e.setInt32(this.newJob)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Sociaty_RoleChangeJob=K,function(e){e[e.ErrorCode_Sociaty_RoleChangeJob_Success=0]="ErrorCode_Sociaty_RoleChangeJob_Success",e[e.ErrorCode_Sociaty_RoleChangeJob_Failed=1]="ErrorCode_Sociaty_RoleChangeJob_Failed",e[e.ErrorCode_Sociaty_RoleChangeJob_NoPlayer=2]="ErrorCode_Sociaty_RoleChangeJob_NoPlayer",e[e.ErrorCode_Sociaty_RoleChangeJob_NoSCPlayer=3]="ErrorCode_Sociaty_RoleChangeJob_NoSCPlayer",e[e.ErrorCode_Sociaty_RoleChangeJob_NoSociaty=4]="ErrorCode_Sociaty_RoleChangeJob_NoSociaty",e[e.ErrorCode_Sociaty_RoleChangeJob_NoAuth=5]="ErrorCode_Sociaty_RoleChangeJob_NoAuth",e[e.ErrorCode_Sociaty_RoleChangeJob_NoChangeSCPlayer=6]="ErrorCode_Sociaty_RoleChangeJob_NoChangeSCPlayer",e[e.ErrorCode_Sociaty_RoleChangeJob_ChangePresidentNoAuth=7]="ErrorCode_Sociaty_RoleChangeJob_ChangePresidentNoAuth",e[e.ErrorCode_Sociaty_RoleChangeJob_JobNoBeyondChangePlayer=8]="ErrorCode_Sociaty_RoleChangeJob_JobNoBeyondChangePlayer",e[e.ErrorCode_Sociaty_RoleChangeJob_NoJobNum=9]="ErrorCode_Sociaty_RoleChangeJob_NoJobNum",e[e.ErrorCode_Sociaty_RoleChangeJob_NewJobBeyondPlayer=10]="ErrorCode_Sociaty_RoleChangeJob_NewJobBeyondPlayer",e[e.ErrorCode_Sociaty_RoleChangeJob_NoChangePlayer=11]="ErrorCode_Sociaty_RoleChangeJob_NoChangePlayer",e[e.ErrorCode_Sociaty_RoleChangeJob_ChangePlayerNotEnoughScore=12]="ErrorCode_Sociaty_RoleChangeJob_ChangePlayerNotEnoughScore"}(o.ErrorCode_Sociaty_RoleChangeJob||(o.ErrorCode_Sociaty_RoleChangeJob={}));var q=function(){function e(){this.errorcode=0,this.changeRoleID=a.fromValue(0),this.newJob=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<16||(this.errorcode=e.getInt32(),this.changeRoleID=e.getLong(),this.newJob=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setLong(this.changeRoleID),e.setInt32(this.newJob)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Sociaty_RoleChangeJob=q;var Q=function(){function e(){this.donateType=0,this.donateNum=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.donateType=e.getInt32(),this.donateNum=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.donateType),e.setInt32(this.donateNum)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Sociaty_RoleDonate=Q,function(e){e[e.ErrorCode_Sociaty_RoleDonate_Success=0]="ErrorCode_Sociaty_RoleDonate_Success",e[e.ErrorCode_Sociaty_RoleDonate_Failed=1]="ErrorCode_Sociaty_RoleDonate_Failed",e[e.ErrorCode_Sociaty_RoleDonate_NoPlayer=2]="ErrorCode_Sociaty_RoleDonate_NoPlayer",e[e.ErrorCode_Sociaty_RoleDonate_NoSCPlayer=3]="ErrorCode_Sociaty_RoleDonate_NoSCPlayer",e[e.ErrorCode_Sociaty_RoleDonate_NoSociaty=4]="ErrorCode_Sociaty_RoleDonate_NoSociaty",e[e.ErrorCode_Sociaty_RoleDonate_DonateNumErr=5]="ErrorCode_Sociaty_RoleDonate_DonateNumErr",e[e.ErrorCode_Sociaty_RoleDonate_NoDonateTable=6]="ErrorCode_Sociaty_RoleDonate_NoDonateTable",e[e.ErrorCode_Sociaty_RoleDonate_NoDonateNum=7]="ErrorCode_Sociaty_RoleDonate_NoDonateNum",e[e.ErrorCode_Sociaty_RoleDonate_NoCost=8]="ErrorCode_Sociaty_RoleDonate_NoCost",e[e.ErrorCode_Sociaty_RoleDonate_NoDonateNumTable=9]="ErrorCode_Sociaty_RoleDonate_NoDonateNumTable"}(o.ErrorCode_Sociaty_RoleDonate||(o.ErrorCode_Sociaty_RoleDonate={}));var X=function(){function e(){this.errorcode=0,this.sociatyData=new _,this.donateType=0,this.donateNum=0,this.prize=[],this.addSociatyExp=0,this.addContribution=0}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;if(this.errorcode=e.getInt32(),!this.sociatyData.read(e))return!1;if(e.getLen()-e.getPos()<12)return!1;this.donateType=e.getInt32(),this.donateNum=e.getInt32();var t=e.getUint32();this.prize=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.prize.push(i)}return!(e.getLen()-e.getPos()<8||(this.addSociatyExp=e.getInt32(),this.addContribution=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),this.sociatyData.writeNoEnd(e),e.setInt32(this.donateType),e.setInt32(this.donateNum),e.setUint32(this.prize.length),this.prize.forEach(function(t){t.writeNoEnd(e)}),e.setInt32(this.addSociatyExp),e.setInt32(this.addContribution)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Sociaty_RoleDonate=X;var J=function(){function e(){this.inviteRoleID=a.fromValue(0)}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.inviteRoleID=e.getLong(),0))},e.prototype.writeNoEnd=function(e){e.setLong(this.inviteRoleID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Sociaty_RoleInvite=J,function(e){e[e.ErrorCode_Sociaty_RoleInvite_Success=0]="ErrorCode_Sociaty_RoleInvite_Success",e[e.ErrorCode_Sociaty_RoleInvite_Failed=1]="ErrorCode_Sociaty_RoleInvite_Failed",e[e.ErrorCode_Sociaty_RoleInvite_NoPlayer=2]="ErrorCode_Sociaty_RoleInvite_NoPlayer",e[e.ErrorCode_Sociaty_RoleInvite_NoSCPlayer=3]="ErrorCode_Sociaty_RoleInvite_NoSCPlayer",e[e.ErrorCode_Sociaty_RoleInvite_NoSociaty=4]="ErrorCode_Sociaty_RoleInvite_NoSociaty",e[e.ErrorCode_Sociaty_RoleInvite_NoAuth=5]="ErrorCode_Sociaty_RoleInvite_NoAuth",e[e.ErrorCode_Sociaty_RoleInvite_NoInvitePlayer=6]="ErrorCode_Sociaty_RoleInvite_NoInvitePlayer",e[e.ErrorCode_Sociaty_RoleInvite_InviteHaveSociaty=7]="ErrorCode_Sociaty_RoleInvite_InviteHaveSociaty",e[e.ErrorCode_Sociaty_RoleInvite_NotInSameServerGroup=8]="ErrorCode_Sociaty_RoleInvite_NotInSameServerGroup"}(o.ErrorCode_Sociaty_RoleInvite||(o.ErrorCode_Sociaty_RoleInvite={}));var Z=function(){function e(){this.errorcode=0,this.inviteRoleID=a.fromValue(0)}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<12||(this.errorcode=e.getInt32(),this.inviteRoleID=e.getLong(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setLong(this.inviteRoleID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Sociaty_RoleInvite=Z,function(e){e[e.ProType_Sociaty_RoleDispossInviteList_AddSociaty=1]="ProType_Sociaty_RoleDispossInviteList_AddSociaty",e[e.ProType_Sociaty_RoleDispossInviteList_DelSociaty=2]="ProType_Sociaty_RoleDispossInviteList_DelSociaty",e[e.ProType_Sociaty_RoleDispossInviteList_ClearList=3]="ProType_Sociaty_RoleDispossInviteList_ClearList"}(o.ProType_Sociaty_RoleDispossInviteList||(o.ProType_Sociaty_RoleDispossInviteList={}));var $=function(){function e(){this.dispossType=0,this.inviteSociatyID=0}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.dispossType=e.getInt32();var t=e.getUint32();return!(e.getLen()-e.getPos()<t||(this.inviteSociatyID=e.getString(t),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.dispossType),e.setString(this.inviteSociatyID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Sociaty_RoleDispossInviteList=$,function(e){e[e.ErrorCode_Sociaty_RoleDispossInviteList_Success=0]="ErrorCode_Sociaty_RoleDispossInviteList_Success",e[e.ErrorCode_Sociaty_RoleDispossInviteList_Failed=1]="ErrorCode_Sociaty_RoleDispossInviteList_Failed",e[e.ErrorCode_Sociaty_RoleDispossInviteList_NoPlayer=2]="ErrorCode_Sociaty_RoleDispossInviteList_NoPlayer",e[e.ErrorCode_Sociaty_RoleDispossInviteList_HaveSociaty=3]="ErrorCode_Sociaty_RoleDispossInviteList_HaveSociaty",e[e.ErrorCode_Sociaty_RoleDispossInviteList_NoSociaty=4]="ErrorCode_Sociaty_RoleDispossInviteList_NoSociaty",e[e.ErrorCode_Sociaty_RoleDispossInviteList_NoInviteSociaty=5]="ErrorCode_Sociaty_RoleDispossInviteList_NoInviteSociaty",e[e.ErrorCode_Sociaty_RoleDispossInviteList_DispossType=6]="ErrorCode_Sociaty_RoleDispossInviteList_DispossType"}(o.ErrorCode_Sociaty_RoleDispossInviteList||(o.ErrorCode_Sociaty_RoleDispossInviteList={}));var ee=function(){function e(){this.errorcode=0,this.dispossType=0,this.inviteSociatyID=""}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<12)return!1;this.errorcode=e.getInt32(),this.dispossType=e.getInt32();var t=e.getUint32();return!(e.getLen()-e.getPos()<t||(this.inviteSociatyID=e.getString(t),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setInt32(this.dispossType),e.setString(this.inviteSociatyID)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Sociaty_RoleDispossInviteList=ee;var te=function(){function e(){}return e.prototype.read=function(){return!0},e.prototype.writeNoEnd=function(){},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Sociaty_RoleGetInviteData=te,function(e){e[e.ErrorCode_Sociaty_RoleGetInviteData_Success=0]="ErrorCode_Sociaty_RoleGetInviteData_Success",e[e.ErrorCode_Sociaty_RoleGetInviteData_Failed=1]="ErrorCode_Sociaty_RoleGetInviteData_Failed",e[e.ErrorCode_Sociaty_RoleGetInviteData_NoPlayer=2]="ErrorCode_Sociaty_RoleGetInviteData_NoPlayer"}(o.ErrorCode_Sociaty_RoleGetInviteData||(o.ErrorCode_Sociaty_RoleGetInviteData={}));var oe=function(){function e(){this.errorcode=0,this.invite=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.errorcode=e.getInt32();var t=e.getUint32();this.invite.clear();for(var o=0;o<t;++o){var i;i=e.getLong();var a=new c;if(!a.read(e))return!1;this.invite.set(i,a)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setUint32(this.invite.size),this.invite.forEach(function(t,o){e.setLong(o),t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Sociaty_RoleGetInviteData=oe;var ie=function(){function e(){}return e.prototype.read=function(){return!0},e.prototype.writeNoEnd=function(){},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Sociaty_RoleSignIn=ie,function(e){e[e.ErrorCode_Sociaty_RoleSignIn_Success=0]="ErrorCode_Sociaty_RoleSignIn_Success",e[e.ErrorCode_Sociaty_RoleSignIn_Failed=1]="ErrorCode_Sociaty_RoleSignIn_Failed",e[e.ErrorCode_Sociaty_RoleSignIn_NoPlayer=2]="ErrorCode_Sociaty_RoleSignIn_NoPlayer",e[e.ErrorCode_Sociaty_RoleSignIn_NoSCPlayer=3]="ErrorCode_Sociaty_RoleSignIn_NoSCPlayer",e[e.ErrorCode_Sociaty_RoleSignIn_NoSociaty=4]="ErrorCode_Sociaty_RoleSignIn_NoSociaty",e[e.ErrorCode_Sociaty_RoleSignIn_HaveSignIn=5]="ErrorCode_Sociaty_RoleSignIn_HaveSignIn",e[e.ErrorCode_Sociaty_RoleSignIn_SeriesNumTableEmpty=6]="ErrorCode_Sociaty_RoleSignIn_SeriesNumTableEmpty"}(o.ErrorCode_Sociaty_RoleSignIn||(o.ErrorCode_Sociaty_RoleSignIn={}));var ae=function(){function e(){this.errorcode=0,this.sociatyData=new _,this.signinData=new f}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),!this.sociatyData.read(e)||!this.signinData.read(e)))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),this.sociatyData.writeNoEnd(e),this.signinData.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Sociaty_RoleSignIn=ae;var ne=function(){function e(){}return e.prototype.read=function(){return!0},e.prototype.writeNoEnd=function(){},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Sociaty_RoleReceiveSignInPrize=ne,function(e){e[e.ErrorCode_Sociaty_RoleReceiveSignInPrize_Success=0]="ErrorCode_Sociaty_RoleReceiveSignInPrize_Success",e[e.ErrorCode_Sociaty_RoleReceiveSignInPrize_Failed=1]="ErrorCode_Sociaty_RoleReceiveSignInPrize_Failed",e[e.ErrorCode_Sociaty_RoleReceiveSignInPrize_NoPlayer=2]="ErrorCode_Sociaty_RoleReceiveSignInPrize_NoPlayer",e[e.ErrorCode_Sociaty_RoleReceiveSignInPrize_NoSCPlayer=3]="ErrorCode_Sociaty_RoleReceiveSignInPrize_NoSCPlayer",e[e.ErrorCode_Sociaty_RoleReceiveSignInPrize_NoSociaty=4]="ErrorCode_Sociaty_RoleReceiveSignInPrize_NoSociaty",e[e.ErrorCode_Sociaty_RoleReceiveSignInPrize_NoSignIn=5]="ErrorCode_Sociaty_RoleReceiveSignInPrize_NoSignIn",e[e.ErrorCode_Sociaty_RoleReceiveSignInPrize_NoSignInSociaty=6]="ErrorCode_Sociaty_RoleReceiveSignInPrize_NoSignInSociaty",e[e.ErrorCode_Sociaty_RoleReceiveSignInPrize_HaveReceive=7]="ErrorCode_Sociaty_RoleReceiveSignInPrize_HaveReceive",e[e.ErrorCode_Sociaty_RoleReceiveSignInPrize_NoPrize=8]="ErrorCode_Sociaty_RoleReceiveSignInPrize_NoPrize",e[e.ErrorCode_Sociaty_RoleReceiveSignInPrize_NoPrizeTable=9]="ErrorCode_Sociaty_RoleReceiveSignInPrize_NoPrizeTable",e[e.ErrorCode_Sociaty_RoleReceiveSignInPrize_NoPrizeNum=10]="ErrorCode_Sociaty_RoleReceiveSignInPrize_NoPrizeNum"}(o.ErrorCode_Sociaty_RoleReceiveSignInPrize||(o.ErrorCode_Sociaty_RoleReceiveSignInPrize={}));var re=function(){function e(){this.errorcode=0,this.prize=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.errorcode=e.getInt32();var t=e.getUint32();this.prize=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.prize.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setUint32(this.prize.length),this.prize.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Sociaty_RoleReceiveSignInPrize=re;var se=function(){function e(){}return e.prototype.read=function(){return!0},e.prototype.writeNoEnd=function(){},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Sociaty_RoleGetChatData=se,function(e){e[e.ErrorCode_Sociaty_RoleGetChatData_Success=0]="ErrorCode_Sociaty_RoleGetChatData_Success",e[e.ErrorCode_Sociaty_RoleGetChatData_Failed=1]="ErrorCode_Sociaty_RoleGetChatData_Failed",e[e.ErrorCode_Sociaty_RoleGetChatData_NoPlayer=2]="ErrorCode_Sociaty_RoleGetChatData_NoPlayer",e[e.ErrorCode_Sociaty_RoleGetChatData_NoSCPlayer=3]="ErrorCode_Sociaty_RoleGetChatData_NoSCPlayer",e[e.ErrorCode_Sociaty_RoleGetChatData_NoSociaty=4]="ErrorCode_Sociaty_RoleGetChatData_NoSociaty"}(o.ErrorCode_Sociaty_RoleGetChatData||(o.ErrorCode_Sociaty_RoleGetChatData={}));var ce=function(){function e(){this.errorcode=0,this.roleID=a.fromValue(0),this.logData=new m,this.chatData=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<12)return!1;if(this.errorcode=e.getInt32(),this.roleID=e.getLong(),!this.logData.read(e))return!1;if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();this.chatData=[];for(var o=0;o<t;++o){var i=new r;if(!i.read(e))return!1;this.chatData.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setLong(this.roleID),this.logData.writeNoEnd(e),e.setUint32(this.chatData.length),this.chatData.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Sociaty_RoleGetChatData=ce;var le=function(){function e(){this.logData=new g}return e.prototype.read=function(e){return!!this.logData.read(e)},e.prototype.writeNoEnd=function(e){this.logData.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Sociaty_SociatyAddLog=le;var de=function(){function e(){this.logData=new C}return e.prototype.read=function(e){return!!this.logData.read(e)},e.prototype.writeNoEnd=function(e){this.logData.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Sociaty_SendFightLog=de;var ue=function(){function e(){this.roleID=a.fromValue(0),this.roleJob=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<12||(this.roleID=e.getLong(),this.roleJob=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setLong(this.roleID),e.setInt32(this.roleJob)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Sociaty_SynRoleJobChange=ue;var he=function(){function e(){}return e.prototype.read=function(){return!0},e.prototype.writeNoEnd=function(){},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Sociaty_RoleGetSociatyBoxData=he,function(e){e[e.ErrorCode_Sociaty_RoleGetSociatyBoxData_Success=0]="ErrorCode_Sociaty_RoleGetSociatyBoxData_Success",e[e.ErrorCode_Sociaty_RoleGetSociatyBoxData_Failed=1]="ErrorCode_Sociaty_RoleGetSociatyBoxData_Failed",e[e.ErrorCode_Sociaty_RoleGetSociatyBoxData_NoPlayer=2]="ErrorCode_Sociaty_RoleGetSociatyBoxData_NoPlayer",e[e.ErrorCode_Sociaty_RoleGetSociatyBoxData_NoSCPlayer=3]="ErrorCode_Sociaty_RoleGetSociatyBoxData_NoSCPlayer",e[e.ErrorCode_Sociaty_RoleGetSociatyBoxData_NoSociaty=4]="ErrorCode_Sociaty_RoleGetSociatyBoxData_NoSociaty"}(o.ErrorCode_Sociaty_RoleGetSociatyBoxData||(o.ErrorCode_Sociaty_RoleGetSociatyBoxData={}));var pe=function(){function e(){this.errorcode=0,this.boxData=new I,this.playerBoxData=new b}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),!this.boxData.read(e)||!this.playerBoxData.read(e)))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),this.boxData.writeNoEnd(e),this.playerBoxData.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Sociaty_RoleGetSociatyBoxData=pe;var fe=function(){function e(){this.index=0,this.type=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.index=e.getInt32(),this.type=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.index),e.setInt32(this.type)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_SociatyBattlePassData=fe;var ge=function(){function e(){this.getRewards=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();if(e.getLen()-e.getPos()<8*t)return!1;this.getRewards=[];for(var o=0;o<t;++o){var i=new fe;if(!i.read(e))return!1;this.getRewards.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setUint32(this.getRewards.length),this.getRewards.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Sociaty_RoleReceiveSociatyBoxPrize=ge,function(e){e[e.ErrorCode_Sociaty_RoleReceiveSociatyBoxPrize_Success=0]="ErrorCode_Sociaty_RoleReceiveSociatyBoxPrize_Success",e[e.ErrorCode_Sociaty_RoleReceiveSociatyBoxPrize_Failed=1]="ErrorCode_Sociaty_RoleReceiveSociatyBoxPrize_Failed",e[e.ErrorCode_Sociaty_RoleReceiveSociatyBoxPrize_NoPlayer=2]="ErrorCode_Sociaty_RoleReceiveSociatyBoxPrize_NoPlayer",e[e.ErrorCode_Sociaty_RoleReceiveSociatyBoxPrize_NoSCPlayer=3]="ErrorCode_Sociaty_RoleReceiveSociatyBoxPrize_NoSCPlayer",e[e.ErrorCode_Sociaty_RoleReceiveSociatyBoxPrize_NoSociaty=4]="ErrorCode_Sociaty_RoleReceiveSociatyBoxPrize_NoSociaty",e[e.ErrorCode_Sociaty_RoleReceiveSociatyBoxPrize_NoBox=5]="ErrorCode_Sociaty_RoleReceiveSociatyBoxPrize_NoBox",e[e.ErrorCode_Sociaty_RoleReceiveSociatyBoxPrize_NoGrade=6]="ErrorCode_Sociaty_RoleReceiveSociatyBoxPrize_NoGrade",e[e.ErrorCode_Sociaty_RoleReceiveSociatyBoxPrize_NoGradeSub=7]="ErrorCode_Sociaty_RoleReceiveSociatyBoxPrize_NoGradeSub",e[e.ErrorCode_Sociaty_RoleReceiveSociatyBoxPrize_NoMedal=8]="ErrorCode_Sociaty_RoleReceiveSociatyBoxPrize_NoMedal",e[e.ErrorCode_Sociaty_RoleReceiveSociatyBoxPrize_EnterSeasonCond=9]="ErrorCode_Sociaty_RoleReceiveSociatyBoxPrize_EnterSeasonCond",e[e.ErrorCode_Sociaty_RoleReceiveSociatyBoxPrize_HaveReceive=10]="ErrorCode_Sociaty_RoleReceiveSociatyBoxPrize_HaveReceive",e[e.ErrorCode_Sociaty_RoleReceiveSociatyBoxPrize_NoBoxTable=11]="ErrorCode_Sociaty_RoleReceiveSociatyBoxPrize_NoBoxTable"}(o.ErrorCode_Sociaty_RoleReceiveSociatyBoxPrize||(o.ErrorCode_Sociaty_RoleReceiveSociatyBoxPrize={}));var me=function(){function e(){this.errorcode=0,this.boxData=new I,this.playerBoxData=new b,this.prize=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;if(this.errorcode=e.getInt32(),!this.boxData.read(e))return!1;if(!this.playerBoxData.read(e))return!1;if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();this.prize=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.prize.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),this.boxData.writeNoEnd(e),this.playerBoxData.writeNoEnd(e),e.setUint32(this.prize.length),this.prize.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Sociaty_RoleReceiveSociatyBoxPrize=me;var _e=function(){function e(){this.boxID=0,this.msg=""}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.boxID=e.getInt32();var t=e.getUint32();return!(e.getLen()-e.getPos()<t||(this.msg=e.getString(t),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.boxID),e.setString(this.msg)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Sociaty_RoleAddSociatyMsg=_e,function(e){e[e.ErrorCode_Sociaty_RoleAddSociatyMsg_Success=0]="ErrorCode_Sociaty_RoleAddSociatyMsg_Success",e[e.ErrorCode_Sociaty_RoleAddSociatyMsg_Failed=1]="ErrorCode_Sociaty_RoleAddSociatyMsg_Failed",e[e.ErrorCode_Sociaty_RoleAddSociatyMsg_NoPlayer=2]="ErrorCode_Sociaty_RoleAddSociatyMsg_NoPlayer",e[e.ErrorCode_Sociaty_RoleAddSociatyMsg_NoSCPlayer=3]="ErrorCode_Sociaty_RoleAddSociatyMsg_NoSCPlayer",e[e.ErrorCode_Sociaty_RoleAddSociatyMsg_NoSociaty=4]="ErrorCode_Sociaty_RoleAddSociatyMsg_NoSociaty",e[e.ErrorCode_Sociaty_RoleAddSociatyMsg_NoBox=5]="ErrorCode_Sociaty_RoleAddSociatyMsg_NoBox",e[e.ErrorCode_Sociaty_RoleAddSociatyMsg_MsgNoEmpty=6]="ErrorCode_Sociaty_RoleAddSociatyMsg_MsgNoEmpty",e[e.ErrorCode_Sociaty_RoleAddSociatyMsg_MsgHasFilterWords=7]="ErrorCode_Sociaty_RoleAddSociatyMsg_MsgHasFilterWords",e[e.ErrorCode_Sociaty_RoleAddSociatyMsg_NoReceive=8]="ErrorCode_Sociaty_RoleAddSociatyMsg_NoReceive"}(o.ErrorCode_Sociaty_RoleAddSociatyMsg||(o.ErrorCode_Sociaty_RoleAddSociatyMsg={}));var ye=function(){function e(){this.errorcode=0,this.boxData=new I}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.errorcode=e.getInt32(),!this.boxData.read(e)))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),this.boxData.writeNoEnd(e)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Sociaty_RoleAddSociatyMsg=ye;var ve=function(){function e(){this.id=a.fromValue(0)}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.id=e.getLong(),0))},e.prototype.writeNoEnd=function(e){e.setLong(this.id)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Sociaty_RoleGetRedEnvelope=ve;var Ce=function(){function e(){this.errorcode=0,this.sendRoleID=a.fromValue(0),this.nickName="",this.headID=0,this.headUrl="",this.headFrameID=0,this.redEnvelopeId=0,this.durationTime=0,this.prize=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<16)return!1;this.errorcode=e.getInt32(),this.sendRoleID=e.getLong();var t=e.getUint32();if(e.getLen()-e.getPos()<t)return!1;if(this.nickName=e.getString(t),e.getLen()-e.getPos()<8)return!1;this.headID=e.getInt32();var o=e.getUint32();if(e.getLen()-e.getPos()<o)return!1;if(this.headUrl=e.getString(o),e.getLen()-e.getPos()<16)return!1;this.headFrameID=e.getInt32(),this.redEnvelopeId=e.getInt32(),this.durationTime=e.getInt32();var i=e.getUint32();this.prize=[];for(var a=0;a<i;++a){var r=new n;if(!r.read(e))return!1;this.prize.push(r)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setLong(this.sendRoleID),e.setString(this.nickName),e.setInt32(this.headID),e.setString(this.headUrl),e.setInt32(this.headFrameID),e.setInt32(this.redEnvelopeId),e.setInt32(this.durationTime),e.setUint32(this.prize.length),this.prize.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Sociaty_RoleGetRedEnvelope=Ce;var Se=function(){function e(){this.rankId=0,this.roleId=a.fromValue(0),this.nickName="",this.headID=0,this.headUrl="",this.headFrameID=0,this.score=0,this.maxContinuousWinNum=0,this.reliveNum=0,this.updateTime=0}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<16)return!1;this.rankId=e.getInt32(),this.roleId=e.getLong();var t=e.getUint32();if(e.getLen()-e.getPos()<t)return!1;if(this.nickName=e.getString(t),e.getLen()-e.getPos()<8)return!1;this.headID=e.getInt32();var o=e.getUint32();return!(e.getLen()-e.getPos()<o||(this.headUrl=e.getString(o),e.getLen()-e.getPos()<20||(this.headFrameID=e.getInt32(),this.score=e.getInt32(),this.maxContinuousWinNum=e.getInt32(),this.reliveNum=e.getInt32(),this.updateTime=e.getInt32(),0)))},e.prototype.writeNoEnd=function(e){e.setInt32(this.rankId),e.setLong(this.roleId),e.setString(this.nickName),e.setInt32(this.headID),e.setString(this.headUrl),e.setInt32(this.headFrameID),e.setInt32(this.score),e.setInt32(this.maxContinuousWinNum),e.setInt32(this.reliveNum),e.setInt32(this.updateTime)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Sociaty_RankListData=Se;var Te=function(){function e(){this.auctionTime=0,this.roleID=a.fromValue(0),this.roleName="",this.auctionPrice=0,this.isAuctionSuccess=!1}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<16)return!1;this.auctionTime=e.getInt32(),this.roleID=e.getLong();var t=e.getUint32();return!(e.getLen()-e.getPos()<t||(this.roleName=e.getString(t),e.getLen()-e.getPos()<5||(this.auctionPrice=e.getInt32(),this.isAuctionSuccess=e.getBool(),0)))},e.prototype.writeNoEnd=function(e){e.setInt32(this.auctionTime),e.setLong(this.roleID),e.setString(this.roleName),e.setInt32(this.auctionPrice),e.setBool(this.isAuctionSuccess)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_SociatyAuctionLog=Te;var Ie=function(){function e(){this.id=0,this.beginTime=0,this.cdTime=0,this.durationTime=0,this.prizeId=0,this.prizes=[],this.auctionNum=0,this.roleID=a.fromValue(0),this.roleName=0,this.isBuy=!1,this.focus=[],this.auctionLogs=[],this.isFinished=!1}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<24)return!1;this.id=e.getInt32(),this.beginTime=e.getInt32(),this.cdTime=e.getInt32(),this.durationTime=e.getInt32(),this.prizeId=e.getInt32();var t=e.getUint32();this.prizes=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.prizes.push(i)}if(e.getLen()-e.getPos()<16)return!1;this.auctionNum=e.getInt32(),this.roleID=e.getLong();var a=e.getUint32();if(e.getLen()-e.getPos()<a)return!1;if(this.roleName=e.getString(a),e.getLen()-e.getPos()<5)return!1;this.isBuy=e.getBool();var r=e.getUint32();if(e.getLen()-e.getPos()<8*r)return!1;this.focus=[];for(var s=0;s<r;++s){var c;c=e.getLong(),this.focus.push(c)}if(e.getLen()-e.getPos()<4)return!1;var l=e.getUint32();this.auctionLogs=[];for(var d=0;d<l;++d){var u=new Te;if(!u.read(e))return!1;this.auctionLogs.push(u)}return!(e.getLen()-e.getPos()<1||(this.isFinished=e.getBool(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.id),e.setInt32(this.beginTime),e.setInt32(this.cdTime),e.setInt32(this.durationTime),e.setInt32(this.prizeId),e.setUint32(this.prizes.length),this.prizes.forEach(function(t){t.writeNoEnd(e)}),e.setInt32(this.auctionNum),e.setLong(this.roleID),e.setString(this.roleName),e.setBool(this.isBuy),e.setUint32(this.focus.length),this.focus.forEach(function(t){e.setLong(t)}),e.setUint32(this.auctionLogs.length),this.auctionLogs.forEach(function(t){t.writeNoEnd(e)}),e.setBool(this.isFinished)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Sociaty_AuctionData=Ie;var Ne=function(){function e(){this.prizeId=0,this.prizes=[],this.roleID=a.fromValue(0),this.prizeType=0}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.prizeId=e.getInt32();var t=e.getUint32();this.prizes=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.prizes.push(i)}return!(e.getLen()-e.getPos()<12||(this.roleID=e.getLong(),this.prizeType=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.prizeId),e.setUint32(this.prizes.length),this.prizes.forEach(function(t){t.writeNoEnd(e)}),e.setLong(this.roleID),e.setInt32(this.prizeType)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Sociaty_AuctionPrizeData=Ne;var be=function(){function e(){this.rankId=0,this.roleId=a.fromValue(0)}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<12||(this.rankId=e.getInt32(),this.roleId=e.getLong(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.rankId),e.setLong(this.roleId)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_SociatyWar_RankListData=be;var we=function(){function e(){this.sociatyId=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.sociatyId=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.sociatyId)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Sociaty_RoleGetRankListData=we;var Ee=function(){function e(){this.sociatyId=0,this.rankListData=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.sociatyId=e.getInt32();var t=e.getUint32();this.rankListData=[];for(var o=0;o<t;++o){var i=new Se;if(!i.read(e))return!1;this.rankListData.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.sociatyId),e.setUint32(this.rankListData.length),this.rankListData.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Sociaty_RoleGetRankListData=Ee;var Pe=function(){function e(){this.sociatyId=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.sociatyId=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.sociatyId)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Sociaty_RoleGetAuctionData=Pe;var Re=function(){function e(){this.sociatyId=0,this.auctionData=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.sociatyId=e.getInt32();var t=e.getUint32();this.auctionData=[];for(var o=0;o<t;++o){var i=new Ie;if(!i.read(e))return!1;this.auctionData.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.sociatyId),e.setUint32(this.auctionData.length),this.auctionData.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Sociaty_RoleGetAuctionData=Re;var Le=function(){function e(){this.auctionId=0,this.auctionPrice=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.auctionId=e.getInt32(),this.auctionPrice=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.auctionId),e.setInt32(this.auctionPrice)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Sociaty_RoleAuction=Le;var Ae=function(){function e(){this.errorcode=0,this.auctionPrice=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.errorcode=e.getInt32(),this.auctionPrice=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setInt32(this.auctionPrice)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Sociaty_RoleAuction=Ae;var De=function(){function e(){this.auctionData=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<4)return!1;var t=e.getUint32();this.auctionData=[];for(var o=0;o<t;++o){var i=new Ie;if(!i.read(e))return!1;this.auctionData.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setUint32(this.auctionData.length),this.auctionData.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Sociaty_RoleSyncAuctionData=De;var Me=function(){function e(){this.auctionId=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.auctionId=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.auctionId)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Sociaty_RoleDirectBuy=Me;var Be=function(){function e(){this.errorcode=0,this.prize=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.errorcode=e.getInt32();var t=e.getUint32();this.prize=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.prize.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setUint32(this.prize.length),this.prize.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Sociaty_RoleDirectBuy=Be;var ke=function(){function e(){this.auctionId=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.auctionId=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.auctionId)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Sociaty_RoleFocus=ke;var Ge=function(){function e(){this.errorcode=0,this.focusStatus=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.errorcode=e.getInt32(),this.focusStatus=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setInt32(this.focusStatus)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Sociaty_RoleFocus=Ge;var Oe=function(){function e(){this.roleId=a.fromValue(0),this.nickName="",this.headID=0,this.headUrl="",this.headFrameID=0,this.score=0,this.dayMaxRound=0}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<12)return!1;this.roleId=e.getLong();var t=e.getUint32();if(e.getLen()-e.getPos()<t)return!1;if(this.nickName=e.getString(t),e.getLen()-e.getPos()<8)return!1;this.headID=e.getInt32();var o=e.getUint32();return!(e.getLen()-e.getPos()<o||(this.headUrl=e.getString(o),e.getLen()-e.getPos()<12||(this.headFrameID=e.getInt32(),this.score=e.getInt32(),this.dayMaxRound=e.getInt32(),0)))},e.prototype.writeNoEnd=function(e){e.setLong(this.roleId),e.setString(this.nickName),e.setInt32(this.headID),e.setString(this.headUrl),e.setInt32(this.headFrameID),e.setInt32(this.score),e.setInt32(this.dayMaxRound)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Sociaty_HeadData=Oe;var He=function(){function e(){this.rankId=0,this.roles=new i.ObjMap,this.round=0,this.totalTime=0,this.updateTime=0}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.rankId=e.getInt32();var t=e.getUint32();this.roles.clear();for(var o=0;o<t;++o){var i;i=e.getLong();var a=new Oe;if(!a.read(e))return!1;this.roles.set(i,a)}return!(e.getLen()-e.getPos()<12||(this.round=e.getInt32(),this.totalTime=e.getInt32(),this.updateTime=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.rankId),e.setUint32(this.roles.size),this.roles.forEach(function(t,o){e.setLong(o),t.writeNoEnd(e)}),e.setInt32(this.round),e.setInt32(this.totalTime),e.setInt32(this.updateTime)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.T_Sociaty_MachinariumRankListData=He;var Ve=function(){function e(){this.roleId=a.fromValue(0)}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.roleId=e.getLong(),0))},e.prototype.writeNoEnd=function(e){e.setLong(this.roleId)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Sociaty_RoleGetMachinariumData=Ve;var Fe=function(){function e(){this.sociatyId=0,this.roleId=a.fromValue(0),this.cardId=0,this.dayMaxRound=0,this.dayFailNum=0,this.rankListData=[],this.allRound=0,this.rewardStatus=new i.ObjMap}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<28)return!1;this.sociatyId=e.getInt32(),this.roleId=e.getLong(),this.cardId=e.getInt32(),this.dayMaxRound=e.getInt32(),this.dayFailNum=e.getInt32();var t=e.getUint32();this.rankListData=[];for(var o=0;o<t;++o){var i=new He;if(!i.read(e))return!1;this.rankListData.push(i)}if(e.getLen()-e.getPos()<8)return!1;this.allRound=e.getInt32();var a=e.getUint32();if(e.getLen()-e.getPos()<8*a)return!1;this.rewardStatus.clear();for(var n=0;n<a;++n){var r,s;r=e.getInt32(),s=e.getInt32(),this.rewardStatus.set(r,s)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.sociatyId),e.setLong(this.roleId),e.setInt32(this.cardId),e.setInt32(this.dayMaxRound),e.setInt32(this.dayFailNum),e.setUint32(this.rankListData.length),this.rankListData.forEach(function(t){t.writeNoEnd(e)}),e.setInt32(this.allRound),e.setUint32(this.rewardStatus.size),this.rewardStatus.forEach(function(t,o){e.setInt32(o),e.setInt32(t)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Sociaty_SyncMachinariumData=Fe;var Ue=function(){function e(){this.sociatyId=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.sociatyId=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.sociatyId)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Sociaty_RoleGetMachinariumRankListData=Ue;var xe=function(){function e(){this.sociatyId=0,this.rankListData=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.sociatyId=e.getInt32();var t=e.getUint32();this.rankListData=[];for(var o=0;o<t;++o){var i=new He;if(!i.read(e))return!1;this.rankListData.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.sociatyId),e.setUint32(this.rankListData.length),this.rankListData.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Sociaty_RoleGetMachinariumRankListData=xe;var Ye=function(){function e(){this.round=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.round=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.round)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Sociaty_RoleGetMachinariumReward=Ye;var je=function(){function e(){this.errorcode=0,this.prize=[]}return e.prototype.read=function(e){if(e.getLen()-e.getPos()<8)return!1;this.errorcode=e.getInt32();var t=e.getUint32();this.prize=[];for(var o=0;o<t;++o){var i=new n;if(!i.read(e))return!1;this.prize.push(i)}return!0},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setUint32(this.prize.length),this.prize.forEach(function(t){t.writeNoEnd(e)})},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Sociaty_RoleGetMachinariumReward=je;var We=function(){function e(){this.cardId=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<4||(this.cardId=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.cardId)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.C_Sociaty_RoleMachinariumSelectCard=We;var ze=function(){function e(){this.errorcode=0,this.cardId=0}return e.prototype.read=function(e){return!(e.getLen()-e.getPos()<8||(this.errorcode=e.getInt32(),this.cardId=e.getInt32(),0))},e.prototype.writeNoEnd=function(e){e.setInt32(this.errorcode),e.setInt32(this.cardId)},e.prototype.write=function(e){this.writeNoEnd(e),e.markEnd()},e}();o.S_Sociaty_RoleMachinariumSelectCard=ze,cc._RF.pop()},{"./BaseProtocols":"BaseProtocols",DataViewRW:"DataViewRW",ObjCollection:"ObjCollection",long:"long"}],SociatyRecommendItem:[function(e,t,o){"use strict";cc._RF.push(t,"5008dhsZhtHw7tk6Ao6rB2A","SociatyRecommendItem");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../common/PlayerModule"),s=e("../../Global/GameGlobal"),c=e("../../StaticData/SociatyLevelTableData"),l=e("./SociatyCtrl"),d=e("../../network/protocol/TypeProtocols"),u=e("./SociatyModel"),h=cc._decorator,p=h.ccclass,f=h.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.unionIcon=null,t.unionLevel=null,t.unionName=null,t.unionMemberCount=null,t.unionCupCount=null,t.totalScoreLab=null,t}return a(t,e),t.prototype.onLoad=function(){},t.prototype.initData=function(e){this.m_data=e,this.unionName.string=this.m_data.sociatyName,this.unionCupCount.string=this.m_data.enterScore+"",this.unionLevel.string=this.m_data.sociatyLevel+"";var t=c.SociatyLevelTableData.getById(this.m_data.sociatyLevel);this.unionMemberCount.string=this.m_data.currPlayerNum+"/"+t.maxPlayerNum,this.node.sociatyID=this.m_data.sociatyID,this.node.bApplyState=!1,this.totalScoreLab.string=e.totalScore.toString()},t.prototype.onClickSociatyCallBack=function(){u.default.instance().bPopSociatyInfoView=!0,l.default.c_Sociaty_RoleGetSociatyData(this.m_data.sociatyID)},t.prototype.onClickApplyCallBack=function(){return r.default.getRoleAttrValByKey(d.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE)<this.m_data.enterScore?s.G.StringManager.PopWorldString("sociaty_no_enter_score"):this.m_data.enterType==d.SOCIATY_ENTER_TYPE.SOCIATY_ENTER_TYPE_FORBID?s.G.StringManager.PopWorldString("sociaty_forbid_enter"):void l.default.c_Sociaty_RoleJoinSociaty(this.m_data.sociatyID)},n([f(cc.Sprite)],t.prototype,"unionIcon",void 0),n([f(cc.Label)],t.prototype,"unionLevel",void 0),n([f(cc.Label)],t.prototype,"unionName",void 0),n([f(cc.Label)],t.prototype,"unionMemberCount",void 0),n([f(cc.Label)],t.prototype,"unionCupCount",void 0),n([f(cc.Label)],t.prototype,"totalScoreLab",void 0),n([p],t)}(cc.Component);o.default=g,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/SociatyLevelTableData":"SociatyLevelTableData","../../common/PlayerModule":"PlayerModule","../../network/protocol/TypeProtocols":"TypeProtocols","./SociatyCtrl":"SociatyCtrl","./SociatyModel":"SociatyModel"}],SociatyRedEnvelopeTableData:[function(e,t,o){"use strict";cc._RF.push(t,"0f4f0OUDlVIxIlUgVSdsw8c","SociatyRedEnvelopeTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.SociatyRedEnvelopeTableData=o.RedEnvelopeRandom=void 0;var i=e("../TableReader"),a=e("./BaseTableData"),n=function(){function e(){this.itemId=0,this.minCount=0,this.maxCount=0}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.itemId=e.getNumber(),this.minCount=e.getNumber(),this.maxCount=e.getNumber()},e}();o.RedEnvelopeRandom=n;var r=function(){function e(){this.id=0,this.rechargeId=0,this.name="",this.durationTime=0,this.selfPrize=new Array,this.otherPrize=new n,this.bgPicture=""}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.rechargeId=e.getNumber(),this.name=e.getString(),this.durationTime=e.getNumber();for(var o=e.getString(),n=new i.TableReader(o);n.getPos()<n.getLen();){var r=new a.DropItem;r.readOriginal(n),this.selfPrize.push(r)}this.otherPrize.readOriginal(e),this.bgPicture=e.getString()},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"SociatyRedEnvelopeTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.SociatyRedEnvelopeTableData=r,cc._RF.pop()},{"../TableReader":"TableReader","./BaseTableData":"BaseTableData"}],SociatyRedEnvelopeTipView:[function(e,t,o){"use strict";cc._RF.push(t,"99721e3FrBIPr4nVYcSmgat","SociatyRedEnvelopeTipView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=cc._decorator,l=c.ccclass,d=(c.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.path=function(){return"ui/sociaty/prefab/SociatyRedEnvelopeTip"},n([s.Register_Class,l],t)}(r.default));o.default=d,cc._RF.pop()},{"../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators"}],SociatyRuleView:[function(e,t,o){"use strict";cc._RF.push(t,"ec88flHtwtGzqItq3jV2Rl8","SociatyRuleView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=e("./SociatyModel"),l=e("../../StaticData/SociatyLevelTableData"),d=cc._decorator,u=d.ccclass,h=d.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.expLab=null,t}return a(t,e),t.path=function(){return"ui/sociaty/prefab/SociatyRule"},t.prototype.start=function(){var e=c.default.instance().SociatyData.sociatyDayExp,t=l.SociatyLevelTableData.getById(c.default.instance().SociatyData.sociatyLevel);this.expLab.string=e+"/"+t.maxDayExp},n([h(cc.Label)],t.prototype,"expLab",void 0),n([s.Register_Class,u],t)}(r.default);o.default=p,cc._RF.pop()},{"../../StaticData/SociatyLevelTableData":"SociatyLevelTableData","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","./SociatyModel":"SociatyModel"}],SociatySearchView:[function(e,t,o){"use strict";cc._RF.push(t,"dcb2dygpbhPM45b8Kia7Hm8","SociatySearchView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=e("../../utils/GameTools"),l=e("../../Global/GameGlobal"),d=e("./SociatyCtrl"),u=e("./SociatyModel"),h=cc._decorator.ccclass,p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.path=function(){return"ui/sociaty/prefab/SociatySearch"},t.prototype.onLoad=function(){var e=this.node.getChildByName("btn_join");this.m_editbox=this.node.getChildByName("editbox"),c.default.registerTouchEvent(e,this.__btn_join_clickHandler,this)},t.prototype.__btn_join_clickHandler=function(){var e=this.m_editbox.getComponent(cc.EditBox).string;e.length<=0?l.G.StringManager.PopWorldString("click_union_client_error1"):isNaN(Number(e))?l.G.StringManager.PopWorldString("click_union_client_error2"):(u.default.instance().bPopSociatyInfoView=!0,d.default.c_Sociaty_RoleGetSociatyData(e))},n([s.Register_Class,h],t)}(r.default);o.default=p,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../utils/GameTools":"GameTools","./SociatyCtrl":"SociatyCtrl","./SociatyModel":"SociatyModel"}],SociatyShopItem:[function(e,t,o){"use strict";cc._RF.push(t,"5cce9d2PHxG8ZmJn8xFkVFc","SociatyShopItem");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../StaticData/RandShopPositionTableData"),s=e("../../StaticData/RandShopItemTableData"),c=e("../../utils/ConfigUtils"),l=e("../../common/PlayerModule"),d=e("../../modules/manager/LoadResManager"),u=e("../../utils/GameTools"),h=e("../../Global/GameGlobal"),p=e("../../modules/base/GameView"),f=cc._decorator,g=f.ccclass,m=(f.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.tShopObj={shopID:0,shopPosition:0,shopItemID:0,costNum:0,gives:null,costs:null,bSellOut:!1},t.cb=null,t}return a(t,e),t.prototype.init=function(e,t,o){var i=this;if(this.tShopObj.shopID=3,this.tShopObj.shopPosition=t,this.tShopObj.shopItemID=e.shopItemID,this.tShopObj.bSellOut=!1,this.tShopObj.costNum=0,this.cb=o,0==e.shopItemID){this.node.getChildByName("lock").active=!0;var a=h.G.StringManager.getString("SOCIATY_LEVEL_TEXT",r.RandShopPositionTableData.getById(t).conditionLevel);this.node.getChildByName("lock").getChildByName("cup").getComponent(cc.Label).string=a}else{var n=s.RandShopItemTableData.getById(e.shopItemID).give;this.tShopObj.gives=n;var p=c.default.getInstance().getItemByID(n[0].dropID);if(2===p.type){var f=c.default.getInstance().getHeroConfig(n[0].dropID),g=l.default.getHeroCarData()[n[0].dropID];if(g&&0==g.bHeroLock)this.node.getChildByName("shop_new").active=!0;else{d.default.loadSpriteFrame("ui/bag/img/bar"+f.hero_color).then(function(e){cc.isValid(i)?i.node.getChildByName("cardNumber").getChildByName("pro_bar").getChildByName("bar").getComponent(cc.Sprite).spriteFrame=e:console.log(" load sprite_splash error ")}).catch(function(e){cc.error(e)});var m=l.default.getHeroCarData()[n[0].dropID].heroLevel,_=c.default.getInstance().getNpcTemplateConfig(f.npc_id,m).up_res.split("|")[0].split("#"),y=l.default.getItemCountByBag(Number(_[0])),v=Number(_[1]);this.node.getChildByName("cardNumber").getChildByName("pro_bar").getComponent(cc.ProgressBar).progress=y/v,this.node.getChildByName("cardNumber").getChildByName("number").getComponent(cc.Label).string=y+"/"+v}d.default.loadSpriteFrame("ui/cardpic_l/"+f.image).then(function(e){cc.isValid(i)?i.node.getChildByName("heroImg").getComponent(cc.Sprite).spriteFrame=e:console.log(" load sprite_splash error ")}).catch(function(e){cc.error(e)})}else d.default.loadSpriteFrame(p.big_icon).then(function(e){cc.isValid(i)?i.node.getChildByName("heroImg").getComponent(cc.Sprite).spriteFrame=e:console.log(" load sprite_splash error ")}).catch(function(e){cc.error(e)});var C=s.RandShopItemTableData.getById(e.shopItemID);if(C.cost[0]){this.tShopObj.costs=C.cost,this.node.getChildByName("priceNode").active=!0;var S=c.default.getInstance().getItemByID(C.cost[0].dropID).icon;d.default.loadSpriteFrame(S).then(function(e){cc.isValid(i)?i.node.getChildByName("priceNode").getChildByName("costIcon").getComponent(cc.Sprite).spriteFrame=e:console.log(" load sprite_splash error ")}).catch(function(e){cc.error(e)}),this.node.getChildByName("priceNode").getChildByName("cost").getComponent(cc.Label).string=C.cost[0].dropNum.toString(),this.tShopObj.costNum=C.cost[0].dropNum}else this.node.getChildByName("free").active=!0,e.buyNum<=0&&(this.node.getChildByName("redpoint").active=!0);this.node.getChildByName("name").getComponent(cc.Label).string=c.default.getInstance().getItemByID(n[0].dropID).name+"x"+n[0].dropNum,e.buyNum>=C.buyNum&&(this.node.getChildByName("over").active=!0,this.node.getChildByName("free").active=!1,this.node.getChildByName("priceNode").active=!1,this.node.getChildByName("cardNumber").active=!1,u.default.setNodeBright(this.node,!1),this.tShopObj.bSellOut=!0)}},t.prototype.onClickShopItemCallBack=function(){var e=this;return this.tShopObj.shopItemID<=0?h.G.StringManager.PopString(h.G.StringManager.getString("SOCIATY_SHOP_LOCK_TEXT")):1==this.tShopObj.bSellOut?h.G.StringManager.PopString(h.G.StringManager.getString("SOCIATY_SHOP_SOLD_OUT_TEXT")):l.default.getItemCountByBag(1009)<this.tShopObj.costNum?h.G.StringManager.PopString(h.G.StringManager.getString("SOCIATY_SHOP_ERROR_TEXT")):void p.default.addPopView("BaseCtrl","ShopConfirmBuy","ShopConfirmBuy",{itemData:{shopID:3,tGive:this.tShopObj.gives,tCost:this.tShopObj.costs},cb:function(){e.cb(e.tShopObj)}})},n([g],t)}(cc.Component));o.default=m,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/RandShopItemTableData":"RandShopItemTableData","../../StaticData/RandShopPositionTableData":"RandShopPositionTableData","../../common/PlayerModule":"PlayerModule","../../modules/base/GameView":"GameView","../../modules/manager/LoadResManager":"LoadResManager","../../utils/ConfigUtils":"ConfigUtils","../../utils/GameTools":"GameTools"}],SociatyShopTipView:[function(e,t,o){"use strict";cc._RF.push(t,"158a68bChBNrLYCJI7XbDph","SociatyShopTipView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=cc._decorator.ccclass,l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.path=function(){return"ui/sociaty/prefab/SociatyShopTip"},n([s.Register_Class,c],t)}(r.default);o.default=l,cc._RF.pop()},{"../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators"}],SociatyShopView:[function(e,t,o){"use strict";cc._RF.push(t,"612d5Da6+JMm6jpcccL45y/","SociatyShopView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../network/protocol/RoleProtocols"),s=e("../../network/ClientNetwork"),c=e("../../common/EventConst"),l=e("../../modules/manager/EventManager"),d=e("../../modules/base/GameView"),u=e("../../Global/GameGlobal"),h=e("../../common/PlayerModule"),p=cc._decorator,f=p.ccclass,g=p.property,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.shopItemPrefab=null,t.contributionLab=null,t.shopItemLayout=null,t}return a(t,e),t.prototype.start=function(){var e=this,t=new r.C_Role_GetRandShop;t.shopID=3,s.ClientNetwork.getInstance().Send(r.ROLE_CLIENT_ENUM.P_Role_GetRandShop,t),l.default.Instance.on(c.default.SociatyRefreshContributionEvent,this.onRefreshPlayerContribution,this),l.default.Instance.emit(c.default.SociatyRefreshContributionEvent),s.ClientNetwork.getInstance().listenProtocol(r.ROLE_CLIENT_ENUM.P_Role_SynRandShopData,function(t){t.resetPos();var o=new r.S_Role_SynRandShopData;o.read(t)&&3===o.shopID&&e.initShopInfo(o.shopData)},this),s.ClientNetwork.getInstance().listenProtocol(r.ROLE_CLIENT_ENUM.P_Role_RandShopBuy,function(t){t.resetPos();var o=new r.S_Role_RandShopBuy;if(o.read(t))if(0===o.errorcode&&o.prize.length>0){d.default.addPopView("BaseCtrl","AcquirePopupView","AcquirePopupView",{items:o.prize});var i=d.default.getViewByName("ShopConfirmBuy");i&&i.view&&(i.view.node.active=!1,i.view.closeView()),e.scheduleOnce(function(){e.onRefreshPlayerContribution()},.6)}else u.G.StringManager.PopString("SociatyShopView S_Role_RandShopBuy ERROR  "+o.errorcode)},this)},t.prototype.initShopInfo=function(e){var t=this;this.shopItemLayout.node.destroyAllChildren(),this.scheduleOnce(function(){e.positions.forEach(function(e,o){var i=cc.instantiate(t.shopItemPrefab);i.parent=t.shopItemLayout.node,i.getComponent("SociatyShopItem").init(e,o,t.callRoleRandShopBuy)})})},t.prototype.onRefreshPlayerContribution=function(){this.contributionLab.string=h.default.getItemCountByBag(1009)},t.prototype.onClickContributeCallBack=function(){d.default.addPopView("BaseCtrl","SociatyDonateView","SociatyDonateView")},t.prototype.onClickExplainCallBack=function(){d.default.addPopView("BaseCtrl","SociatyShopTipView","SociatyShopTipView")},t.prototype.callRoleRandShopBuy=function(e){var t=new r.C_Role_RandShopBuy;t.shopID=e.shopID,t.shopPosition=e.shopPosition,t.shopItemID=e.shopItemID,s.ClientNetwork.getInstance().Send(r.ROLE_CLIENT_ENUM.P_Role_RandShopBuy,t)},t.prototype.onDestroy=function(){l.default.Instance.off(this,c.default.SociatyRefreshContributionEvent),s.ClientNetwork.getInstance().removeMessageTarget(this)},n([g(cc.Prefab)],t.prototype,"shopItemPrefab",void 0),n([g(cc.Label)],t.prototype,"contributionLab",void 0),n([g(cc.Layout)],t.prototype,"shopItemLayout",void 0),n([f],t)}(cc.Component);o.default=m,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../common/EventConst":"EventConst","../../common/PlayerModule":"PlayerModule","../../modules/base/GameView":"GameView","../../modules/manager/EventManager":"EventManager","../../network/ClientNetwork":"ClientNetwork","../../network/protocol/RoleProtocols":"RoleProtocols"}],SociatyWarRankListTableData:[function(e,t,o){"use strict";cc._RF.push(t,"24e76OYcQZIkq+jqzrbApyz","SociatyWarRankListTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.SociatyWarRankListTableData=void 0;var i=e("../TableReader"),a=e("./BaseTableData"),n=function(){function e(){this.id=0,this.rankMin=0,this.rankMax=0,this.rankType=0,this.mailid=0,this.prize=new Array}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.rankMin=e.getNumber(),this.rankMax=e.getNumber(),this.rankType=e.getNumber(),this.mailid=e.getNumber();for(var o=e.getString(),n=new i.TableReader(o);n.getPos()<n.getLen();){var r=new a.DropItem;r.readOriginal(n),this.prize.push(r)}},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"SociatyWarRankListTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.SociatyWarRankListTableData=n,cc._RF.pop()},{"../TableReader":"TableReader","./BaseTableData":"BaseTableData"}],SociatyWarReliveTableData:[function(e,t,o){"use strict";cc._RF.push(t,"b1d0146FLxIi69R57q4ZPxN","SociatyWarReliveTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.SociatyWarReliveTableData=void 0;var i=e("../TableReader"),a=e("./BaseTableData"),n=function(){function e(){this.id=0,this.reliveNum=0,this.reliveCost=new Array}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.reliveNum=e.getNumber();for(var o=e.getString(),n=new i.TableReader(o);n.getPos()<n.getLen();){var r=new a.DropItem;r.readOriginal(n),this.reliveCost.push(r)}},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"SociatyWarReliveTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.SociatyWarReliveTableData=n,cc._RF.pop()},{"../TableReader":"TableReader","./BaseTableData":"BaseTableData"}],SociatyWarRewardTableData:[function(e,t,o){"use strict";cc._RF.push(t,"e511c7VkJtJMqKGlxqSuPQW","SociatyWarRewardTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.SociatyWarRewardTableData=void 0;var i=e("../TableReader"),a=e("./BaseTableData"),n=function(){function e(){this.id=0,this.sociatyWarSroce=0,this.prize=new Array,this.heroId=0,this.heroScale=0}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.sociatyWarSroce=e.getNumber();for(var o=e.getString(),n=new i.TableReader(o);n.getPos()<n.getLen();){var r=new a.DropItem;r.readOriginal(n),this.prize.push(r)}this.heroId=e.getNumber(),this.heroScale=e.getNumber()},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"SociatyWarRewardTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.SociatyWarRewardTableData=n,cc._RF.pop()},{"../TableReader":"TableReader","./BaseTableData":"BaseTableData"}],SoloSilverTableData:[function(e,t,o){"use strict";cc._RF.push(t,"f3a3dsYlS9IdLsIN3Wg6Ww+","SoloSilverTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.SoloSilverTableData=void 0;var i=e("../TableReader"),a=function(){function e(){this.id=0,this.nTimeMin=0,this.nTimeMax=0,this.nSilverNum=0,this.nTimeInterval=0}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.nTimeMin=e.getNumber(),this.nTimeMax=e.getNumber(),this.nSilverNum=e.getNumber(),this.nTimeInterval=e.getNumber()},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"SoloSilverTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.SoloSilverTableData=a,cc._RF.pop()},{"../TableReader":"TableReader"}],SoundTableData:[function(e,t,o){"use strict";cc._RF.push(t,"80d554Xk0tFhprlKfcUgA2H","SoundTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.SoundTableData=void 0;var i=e("../TableReader"),a=function(){function e(){this.id=0,this.res="",this.describe=""}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.res=e.getString(),this.describe=e.getString()},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"SoundTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.SoundTableData=a,cc._RF.pop()},{"../TableReader":"TableReader"}],Sound:[function(e,t,o){"use strict";cc._RF.push(t,"c4c01TOyiJDx4M6ij7oD3ha","Sound"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../utils/GameUtils"),a=e("./subUtils/SubpackageTools"),n=function(){function e(){}return e.playMusic=function(t){this.isPlayMusic&&(e.s_strCurrentBg=t,a.LoadResAsync(i.removeFileSuffix(t),cc.AudioClip,!1).then(function(e){e&&cc.audioEngine.playMusic(e,!0)}))},e.playMusicForState=function(){""==e.s_strCurrentBg&&cc.audioEngine.isMusicPlaying()||e.playMusic("")},e.stopMusic=function(){cc.audioEngine.stopMusic()},e.pauseMusic=function(){cc.audioEngine.pauseMusic()},e.resumeMusic=function(){cc.audioEngine.resumeMusic()},e.playSound=function(e,t,o){void 0===t&&(t=!1),void 0===o&&(o=null);var n=0;this.isPlayEffect&&null!=e&&e.length>0?a.LoadResAsync(i.removeFileSuffix(e),cc.AudioClip,!1).then(function(e){e&&(n=cc.audioEngine.playEffect(e,t)),o&&o(n)}):o&&o(n)},e.stopSound=function(e){cc.audioEngine.stopEffect(e)},e.pauseAllSound=function(){cc.audioEngine.pauseAllEffects()},e.resumeAllSound=function(){cc.audioEngine.resumeAllEffects()},e.initVolumeMusic=function(){"1"==i.getLocalData(e.MUSIC_OPEN_CONFIG,"1")?(cc.audioEngine.setMusicVolume(1),this.isPlayMusic=!0):(cc.audioEngine.setMusicVolume(0),this.isPlayMusic=!1)},e.initVolumeSound=function(){"1"==i.getLocalData(e.SOUND_OPEN_CONFIG,"1")?(cc.audioEngine.setEffectsVolume(1),this.isPlayEffect=!0):(cc.audioEngine.setEffectsVolume(0),this.isPlayEffect=!1)},e.isMusicEnable=function(){return"1"==i.getLocalData(e.MUSIC_OPEN_CONFIG,"1")},e.isSoundEnable=function(){return"1"==i.getLocalData(e.SOUND_OPEN_CONFIG,"1")},e.disableMusic=function(){i.setLocalData(e.MUSIC_OPEN_CONFIG,"0"),e.initVolumeMusic()},e.enableMusic=function(){i.setLocalData(e.MUSIC_OPEN_CONFIG,"1"),e.initVolumeMusic()},e.disableSound=function(){i.setLocalData(e.SOUND_OPEN_CONFIG,"0"),e.initVolumeSound()},e.enableSound=function(){i.setLocalData(e.SOUND_OPEN_CONFIG,"1"),e.initVolumeSound()},e.stopAllSound=function(){cc.audioEngine.stopAllEffects()},e.s_strCurrentBg="",e.MUSIC_OPEN_CONFIG="ClientMusic",e.SOUND_OPEN_CONFIG="ClientSound",e.isPlayMusic=!0,e.isPlayEffect=!1,e}();o.default=n,cc._RF.pop()},{"../utils/GameUtils":"GameUtils","./subUtils/SubpackageTools":"SubpackageTools"}],SpineMaker:[function(e,t,o){"use strict";cc._RF.push(t,"5fefb/s2uJMGKU7WuyKxlca","SpineMaker");var i=this&&this.__awaiter||function(e,t,o,i){return new(o||(o=Promise))(function(a,n){function r(e){try{c(i.next(e))}catch(t){n(t)}}function s(e){try{c(i.throw(e))}catch(t){n(t)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(r,s)}c((i=i.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){var o,i,a,n,r={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return n={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function s(e){return function(t){return c([e,t])}}function c(n){if(o)throw new TypeError("Generator is already executing.");for(;r;)try{if(o=1,i&&(a=2&n[0]?i.return:n[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return r.label++,{value:n[1],done:!1};case 5:r.label++,i=n[1],n=[0];continue;case 7:n=r.ops.pop(),r.trys.pop();continue;default:if(!(a=(a=r.trys).length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){r=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){r.label=n[1];break}if(6===n[0]&&r.label<a[1]){r.label=a[1],a=n;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(n);break}a[2]&&r.ops.pop(),r.trys.pop();continue}n=t.call(e,r)}catch(s){n=[6,s],i=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.SpineMaker=void 0;var n=e("../../Global/GameGlobal"),r=e("../../utils/subUtils/SubpackageTools"),s=e("../GameUtils"),c=e("../UIManager"),l=e("../ConfigUtils"),d=function(){function e(){}return e.initSpineByName=function(e,t){return i(this,void 0,Promise,function(){var o,i,n,s,c,l,d,u,h;return a(this,function(a){switch(a.label){case 0:return o=new sp.SkeletonData,t.localeCompare(e)?[3,3]:(o=cc.resources.get(t,sp.SkeletonData))?[3,2]:[4,new Promise(function(e){r.LoadResAsync(t,sp.SkeletonData).then(function(t){t&&e(t)}).catch(function(e){cc.error(e)})})];case 1:o=a.sent(),a.label=2;case 2:return[3,7];case 3:return[4,new Promise(function(t){cc.resources.loadDir(e,function(e,o){if(e)throw e;t(o)})})];case 4:return i=a.sent(),(n=cc.resources.get(t,cc.Asset))?[3,6]:[4,new Promise(function(e){r.LoadResAsync(t,cc.Asset).then(function(t){t&&e(t)}).catch(function(e){cc.error(e)})})];case 5:n=a.sent(),a.label=6;case 6:for(s=void 0,c=void 0,l=0,d=i;l<d.length;l++)(u=d[l])instanceof cc.Texture2D?s=u:".atlas"==u._native&&(c=u._nativeAsset);h=e.split("/"),o.skeletonJson=n,o.atlasText=c,o.textures=[s],o.textureNames=[h[h.length-1]+".png"],a.label=7;case 7:return[2,o]}})})},e.initSpine=function(){return i(this,void 0,Promise,function(){return a(this,function(){return[2,null]})})},e.createSpineV2=function(e,t){return i(this,void 0,Promise,function(){var o,i,d,u,h,p;return a(this,function(a){switch(a.label){case 0:return(o=n.G.UIManager.getNextSceneTag())==c.SceneTag.NONE&&(o=n.G.UIManager.getCurSceneTag()),(i=l.default.getInstance().getResConfig(e))?(d=s.removeFileSuffix(i.animation),[4,r.LoadResAsync(d,sp.SkeletonData)]):(console.log("cannot find spine id "+e),[2,null]);case 1:return u=a.sent(),void 0===t&&(t=new cc.Node).setScale(i.scale/100),(h=t.addComponent(sp.Skeleton)).skeletonData=u,(p=n.G.UIManager.getNextSceneTag())==c.SceneTag.NONE&&(p=n.G.UIManager.getCurSceneTag()),o!=p?[2,null]:(h.paused=!1,[2,h])}})})},e}();o.SpineMaker=d,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../utils/subUtils/SubpackageTools":"SubpackageTools","../ConfigUtils":"ConfigUtils","../GameUtils":"GameUtils","../UIManager":"UIManager"}],StringManager:[function(e,t,o){"use strict";cc._RF.push(t,"67cb6cgY8hPTaSTUIq2wH8B","StringManager");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r},r=this&&this.__awaiter||function(e,t,o,i){return new(o||(o=Promise))(function(a,n){function r(e){try{c(i.next(e))}catch(t){n(t)}}function s(e){try{c(i.throw(e))}catch(t){n(t)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(r,s)}c((i=i.apply(e,t||[])).next())})},s=this&&this.__generator||function(e,t){var o,i,a,n,r={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return n={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function s(e){return function(t){return c([e,t])}}function c(n){if(o)throw new TypeError("Generator is already executing.");for(;r;)try{if(o=1,i&&(a=2&n[0]?i.return:n[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return r.label++,{value:n[1],done:!1};case 5:r.label++,i=n[1],n=[0];continue;case 7:n=r.ops.pop(),r.trys.pop();continue;default:if(!(a=(a=r.trys).length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){r=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){r.label=n[1];break}if(6===n[0]&&r.label<a[1]){r.label=a[1],a=n;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(n);break}a[2]&&r.ops.pop(),r.trys.pop();continue}n=t.call(e,r)}catch(s){n=[6,s],i=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.StringManager=o.PopStringEndHandler=void 0;var c=e("../network/protocol/ObjCollection"),l=e("../StaticData/WorldTableData"),d=e("../TableReader"),u=e("../utils/ConfigUtils"),h=e("../utils/GameUtils"),p=e("./subUtils/SubpackageTools"),f=e("./UIManager"),g=function(){function e(){}return e.prototype.onPopStringEnd=function(){},e}();o.PopStringEndHandler=g;var m=cc._decorator,_=m.ccclass,y=(m.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.m_pDict={},t}var o;return a(t,e),o=t,t.prototype.onLoad=function(){return r(this,void 0,void 0,function(){return s(this,function(){return cc.isValid(this)?(this.init(),[2]):[2]})})},t.prototype.init=function(){return r(this,void 0,void 0,function(){var e,t=this;return s(this,function(o){switch(o.label){case 0:return e=this,[4,p.LoadResAsync("config/language_ch",cc.JsonAsset).then(function(t){var o=t;e.m_pDict=o.json}).catch(function(e){cc.error(e)})];case 1:return o.sent(),d.PreLoadCsvSync("WorldTableData",function(){t.m_pWorldDict=new c.ObjMap,l.WorldTableData.getDataMap().forEach(function(e){t.m_pWorldDict.set(e.wordKey,e)})}),[2]}})})},t.prototype.getString=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];var i=this.m_pDict[e];return i?this.formatStr(i,t):null},t.prototype.formatStr=function(e,t){var o=e,i="",a=o.split(/%d|%02d|%s|%f|%.f|%.0f|%.1f/);if(a.length>=2){for(var n=0,r=0;r<a.length;r++){var s=a[r];n==a.length-1?i+=s:t&&null!=t[n]&&(i+=s+t[n]),n++}return i}return o},t.prototype.PopWorldString=function(e,t){var o=this.getWorldString(e);this.PopString(o,t)},t.prototype.PopString=function(e,t){console.log("PopString: "+e);var o=cc.winSize,i=cc.v2(o.width/2,o.height/2);this.PopString3(e,cc.director.getScene(),i,t)},t.prototype.PopString2=function(e,t,o){var i=cc.winSize,a=cc.v2(i.width/2,i.height/2);this.PopString3(e,t,a,null,.5,2,o)},t.prototype.PopString3=function(e,t,o,i,a,n){var r=this;if(null!=t&&null!=e){var s=cc.director.getScene();h.LoadNode("ui/CommonPrefab/FlyWord").then(function(t){if(0!=cc.isValid(s)&&t){var c=t.getChildByName("tipLabel");c.getComponent(cc.Label).string=e;var l=o;l||(l.x=cc.winSize.width/2,l.y=cc.winSize.height/2),t.setPosition(l.x,l.y),i&&(i instanceof cc.Font?c.getComponent(cc.Label).font=i:c.getComponent(cc.Label).fontFamily=i),t.zIndex=f.GameMainLayerZorder.GMZ_FLYWORD+99,s.addChild(t),t.getChildByName("bgSpr");var d=function(){t.destroy()},u=(cc.sequence(cc.delayTime(.1),cc.callFunc(function(){c.color=cc.color(51,51,51)}),cc.delayTime(.1),cc.callFunc(function(){c.color=cc.color(102,102,102)}),cc.delayTime(.1),cc.callFunc(function(){c.color=cc.color(153,153,153)}),cc.delayTime(.1),cc.callFunc(function(){c.color=cc.color(204,204,204)})),cc.sequence(cc.fadeIn(a),cc.callFunc(function(){c.color=cc.Color.WHITE}),cc.delayTime(n),cc.callFunc(function(){c.color=cc.Color.BLACK}),cc.fadeOut(a),cc.callFunc(d)),cc.sequence(cc.fadeIn(a),cc.delayTime(n),cc.fadeOut(a)),t.getComponent(cc.Animation)),h=r;u&&(u.play("FlyWord"),h.scheduleOnce(d,2.5))}}).catch(function(e){cc.error(e)})}},t.prototype.checkStringByKey=function(e){var t=u.default.getInstance().getKeyWordConfig();for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)&&-1!=e.indexOf(t[o].keyWord))return!1;return!0},t.prototype.replaceStringByKey=function(e){for(var t=0,o=u.default.getInstance().getKeyWordConfig();t<o.length;t++)for(var i=o[t];-1!=e.indexOf(i.keyWord);){var a="",n=e.split(i.keyWord);if(n)for(var r=0,s=0;s<n.length;s++){var c=n[s];r==n.length-1?a+=c:a+=c+"**",r++}return a}return e},t.prototype.getChineseNum=function(e){return e<=0||e>10?"":this.getString(o.STRMGR_CH_NUM[e-1])},t.prototype.PopStringOnceEnd=function(){var e=cc.director.getScene();if(e){var t=e.getChildByName("500");t&&t.destroy()}},t.prototype.PopStringOnce=function(e,t){void 0===t&&(t=null),console.log("StringManager, PopStringOnce, contents="+e),this.PopStringOnceEnd();var o=cc.director.getScene(),i=cc.winSize,a=new cc.Vec2(i.width/2,i.height/2);h.LoadNode("ui/CommonPrefab/FlyWord").then(function(i){0!=cc.isValid(o)&&i&&(i.getChildByName("tipLabel").getComponent(cc.Label).string=e,i.setPosition(a),i.name="500",i.zIndex=f.GameMainLayerZorder.GMZ_FLYWORD,o.addChild(i),t&&t())}).catch(function(e){cc.error(e)})},t.prototype.getWorldString=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];var i=this.m_pWorldDict.get(e);if(i){var a=i.ch;return this.formatStr(a,t)}return e},t.s_pIns=null,t.STRMGR_CH_NUM=["CH_1","CH_2","CH_3","CH_4","CH_5","CH_6","CH_7","CH_8","CH_9","CH_10"],o=n([_],t)}(cc.Component));o.StringManager=y,cc._RF.pop()},{"../StaticData/WorldTableData":"WorldTableData","../TableReader":"TableReader","../network/protocol/ObjCollection":"ObjCollection","../utils/ConfigUtils":"ConfigUtils","../utils/GameUtils":"GameUtils","./UIManager":"UIManager","./subUtils/SubpackageTools":"SubpackageTools"}],StringValueTableData:[function(e,t,o){"use strict";cc._RF.push(t,"28ed8EduxdC9q3SEfBvfUpI","StringValueTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.StringValueTableData=void 0;var i=e("../TableReader"),a=function(){function e(){this.id=0,this.string_value="",this.derivation=0}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.string_value=e.getString(),this.derivation=e.getNumber()},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"StringValueTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.StringValueTableData=a,cc._RF.pop()},{"../TableReader":"TableReader"}],SubGameHallItem:[function(e,t,o){"use strict";cc._RF.push(t,"f95ecU5LcpOFplICVMeznRt","SubGameHallItem");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../StaticData/SubGameTableData"),s=e("../../modules/base/Decorators"),c=e("../../network/ClientNetwork"),l=e("../../network/LocalMessage"),d=e("../../utils/GameUtils"),u=cc._decorator,h=u.ccclass,p=u.property,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.gameIcon=null,t.passedNode=null,t.choosed=null,t._subGameId=0,t}return a(t,e),t.prototype.show=function(e,t){d.setTexture(this.gameIcon,r.SubGameTableData.getById(e).gameImage),this._subGameId=e,this.choosed.node.active=!1,this.passedNode.active=t},t.prototype.refreshChoose=function(e){this.choosed.node.active=e==this._subGameId},t.prototype.chooseBtnClick=function(){c.ClientNetwork.getInstance().pushLocalMessage(l.LOCAL_MESSAGE.LocalMsg_ChooseSubGame,this._subGameId)},n([p(cc.Sprite)],t.prototype,"gameIcon",void 0),n([p(cc.Node)],t.prototype,"passedNode",void 0),n([p(cc.Sprite)],t.prototype,"choosed",void 0),n([s.Register_Class,h],t)}(cc.Component);o.default=f,cc._RF.pop()},{"../../StaticData/SubGameTableData":"SubGameTableData","../../modules/base/Decorators":"Decorators","../../network/ClientNetwork":"ClientNetwork","../../network/LocalMessage":"LocalMessage","../../utils/GameUtils":"GameUtils"}],SubGameHallView:[function(e,t,o){"use strict";cc._RF.push(t,"eee17NopxBCZ7H8wg8YuYTk","SubGameHallView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=e("../../modules/cores/UISuperLayout"),l=e("../../modules/manager/subGame/SubGameManager"),d=e("../../modules/manager/ViewManager"),u=e("../../network/ClientNetwork"),h=e("../../network/LocalMessage"),p=e("../../StaticData/SubGameTableData"),f=e("../../utils/GameLoading"),g=e("../../utils/ResourceLoader"),m=e("../../utils/UIManager"),_=e("./SubGameHallItem"),y=e("../../Global/GameGlobal"),v=cc._decorator,C=v.ccclass,S=v.property,T=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.layout=null,t._subGames=new Array,t}return a(t,e),t.path=function(){return"ui/subGame/subGameHallView"},t.prototype.init=function(){var e=this;p.SubGameTableData.getDataMap().forEach(function(t){e._subGames.push(t.id)}),this.layout.total(this._subGames.length),u.ClientNetwork.getInstance().listenLocalMessage(h.LOCAL_MESSAGE.LocalMsg_ChooseSubGame,function(t){var o=t[0];l.default.setChooseSubGame(o);for(var i=0,a=e.layout.children;i<a.length;i++){var n=a[i].getComponent(_.default);n&&n.refreshChoose(o)}},this)},t.prototype.onRefreshEvent=function(e,t){var o=this.getSubGameIdByIndex(t);o<0||(e.getComponent(_.default).show(o,l.default.getSubGamePassed(o)),0==t&&(l.default.setChooseSubGame(o),e.getComponent(_.default).refreshChoose(o)))},t.prototype.getSubGameIdByIndex=function(e){return e<0||e>=this._subGames.length?-1:this._subGames[e]},t.prototype.checkIsPassed=function(){for(var e=null,t=0,o=this.layout.children;t<o.length;t++){var i=o[t].getComponent(_.default);if(i&&1==i.choosed.node.active){e=i;break}}return e?l.default.getSubGamePassed(e._subGameId):null},t.prototype.enterSubGame=function(){var e=this.checkIsPassed();if(null==e)return y.G.StringManager.PopString("\u8bf7\u9009\u62e9\u8981\u6e38\u73a9\u7684\u6e38\u620f\uff01");if(1==e)return y.G.StringManager.PopString("\u5f53\u524d\u5c0f\u6e38\u620f\u5df2\u901a\u5173\uff0c\u8bf7\u9009\u62e9\u5176\u4ed6\u5c0f\u6e38\u620f\u6e38\u73a9\uff01");var t=l.default.getSubGameBundleName();t.length>0&&(g.ResourceLoaderLayer.setType(m.ResourceType.subgame_from_main),f.default.setCallBack(null,function(){var e=cc.assetManager.getBundle(t);e&&e.loadScene("subgamescene",function(e,t){e?f.default.hide():(d.default.__closeAllView__(),f.default.hide(),cc.director.runScene(t))})}),f.default.show())},n([S(c.default)],t.prototype,"layout",void 0),n([s.Register_Class,C],t)}(r.default);o.default=T,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/SubGameTableData":"SubGameTableData","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/cores/UISuperLayout":"UISuperLayout","../../modules/manager/ViewManager":"ViewManager","../../modules/manager/subGame/SubGameManager":"SubGameManager","../../network/ClientNetwork":"ClientNetwork","../../network/LocalMessage":"LocalMessage","../../utils/GameLoading":"GameLoading","../../utils/ResourceLoader":"ResourceLoader","../../utils/UIManager":"UIManager","./SubGameHallItem":"SubGameHallItem"}],SubGameManager:[function(e,t,o){"use strict";cc._RF.push(t,"5635dHTwR9O5Z4SiPCP2f4x","SubGameManager");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../../network/ClientNetwork"),s=e("../../../network/LocalMessage"),c=e("../../../StaticData/SubGameTableData"),l=e("../../../utils/ResourcesManager"),d=e("../../../utils/subUtils/TypeDef"),u=e("../../base/BaseSingle"),h=e("../../base/GameView"),p=cc._decorator,f=p.ccclass,g=(p.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._chooseGameId=0,t}return a(t,e),t.prototype.onCreate=function(){var e=this;r.ClientNetwork.getInstance().listenLocalMessage(s.LOCAL_MESSAGE.LocalMsg_BackSubGame,function(t){cc.director.loadScene("mainScene",function(){h.default.addLayerView("BaseCtrl","MainSceneView","MainSceneView",null,null,function(){var o=e.getSubGameBundleName();o.length>0&&l.default.removeBundle(o),t&&1==t[0]&&e.saveSubGamePassed(e.getChooseSubGame())})})},this)},t.prototype.onDestroy=function(){},t.prototype.setChooseSubGame=function(e){this._chooseGameId=e},t.prototype.getChooseSubGame=function(){return this._chooseGameId},t.prototype.getSubGameBundleName=function(){var e=c.SubGameTableData.getById(this._chooseGameId);return e?e.resUrl:""},t.prototype.saveSubGamePassed=function(e){cc.sys.localStorage.setItem(this.getSubGameKeyStr(e),"1")},t.prototype.getSubGamePassed=function(e){var t=cc.sys.localStorage.getItem(this.getSubGameKeyStr(e));return!!t&&1==parseInt(t)},t.prototype.getSubGameKeyStr=function(e){return d.GlobalVar.getAccountName()+"_subgame_"+e},n([f],t)}(u.BaseSingle));o.default=u.SingleFactory.getInstance(g),cc._RF.pop()},{"../../../StaticData/SubGameTableData":"SubGameTableData","../../../network/ClientNetwork":"ClientNetwork","../../../network/LocalMessage":"LocalMessage","../../../utils/ResourcesManager":"ResourcesManager","../../../utils/subUtils/TypeDef":"TypeDef","../../base/BaseSingle":"BaseSingle","../../base/GameView":"GameView"}],SubGameTableData:[function(e,t,o){"use strict";cc._RF.push(t,"dd450y38kZIC497XmnpCc1X","SubGameTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.SubGameTableData=void 0;var i=e("../TableReader"),a=function(){function e(){this.id=0,this.resUrl="",this.gameImage=""}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.resUrl=e.getString(),this.gameImage=e.getString()},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"SubGameTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.SubGameTableData=a,cc._RF.pop()},{"../TableReader":"TableReader"}],SubpackageTools:[function(e,t,o){"use strict";cc._RF.push(t,"093631meuNBbpA2VsBVCVnA","SubpackageTools"),Object.defineProperty(o,"__esModule",{value:!0}),o.SubpackageTools=o.LoadResAsyncAutoRelease=o.LoadResAsync=void 0;var i=e("../../Global/GameGlobal"),a=e("../../network/CustomEventDef"),n=e("../UIManager");o.LoadResAsync=function(e,t,o,i){return void 0===o&&(o=!1),new Promise(function(a){cc.resources.load(e,t,i,function(e,t){if(e){if(o)throw e;cc.error(e),a(null)}else a(t)})})},o.LoadResAsyncAutoRelease=function(e,t,o){o||(o=i.G.UIManager.getNextSceneTag())==n.SceneTag.NONE&&(o=i.G.UIManager.getCurSceneTag());var a=cc.resources.get(e,t);return Promise.resolve(a),a?Promise.resolve(a):new Promise(function(o){cc.resources.load(e,t,function(e,t){e?(cc.error(e),o(null)):o(t)})})};var r=function(){function e(){}return Object.defineProperty(e,"isGuiding",{get:function(){return cc.director.emit(a.CustomEventDef.isGuiding),e.s_isGuideing},set:function(t){e.s_isGuideing=t},enumerable:!1,configurable:!0}),e.s_isGuideing=!1,e}();o.SubpackageTools=r,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../network/CustomEventDef":"CustomEventDef","../UIManager":"UIManager"}],Summon:[function(e,t,o){"use strict";cc._RF.push(t,"cae1chBncRGFbJzPJVOi6zN","Summon"),o.__esModule=!0,o.default=void 0;var i=s(e("../../utils/ConfigUtils")),a=s(e("../../utils/Tools")),n=s(e("../CombatManager")),r=s(e("../../utils/Debug"));function s(e){return e&&e.__esModule?e:{default:e}}var c=function(){function e(){this.templateId=0,this.id=0,this.cd=0,this.summonNpcList=[],this.summonNpcIndex=-1,this.pBindNpcObj=null}var t=e.prototype;return t.init=function(e,t){this.id=a.default.getInstance().genId(),this.templateId=e,this.pBindNpcObj=t;var o=i.default.getInstance().getSummonConfig(e);o||r.default.error("Summon logic init failed, template id = "+e+", bind npc id = "+this.pBindNpcObj.templateId),this.cd=o.cd,this.summonNpcList=o.summon_npc.split("|")},t.unbind=function(){this.pBindNpcObj=null,this.summonNpcList=null},t.update=function(e){this.deltaTime>0?this.deltaTime=this.deltaTime-1e3*e:(n.default.getInstance().summon(this.getCurSummonNpcId(),this.pBindNpcObj.getLevel(),this.pBindNpcObj.getCamp()),this.deltaTime=this.cd)},t.getCurSummonNpcId=function(){return this.summonNpcIndex++,this.summonNpcIndex>=this.summonNpcList.length&&(this.summonNpcIndex=0),this.summonNpcList[this.summonNpcIndex]},e}();o.default=c,t.exports=o.default,cc._RF.pop()},{"../../utils/ConfigUtils":"ConfigUtils","../../utils/Debug":"Debug","../../utils/Tools":"Tools","../CombatManager":"CombatManager"}],SweepMainView:[function(e,t,o){"use strict";cc._RF.push(t,"75b773g+8NFj6wZXbR9P3my","SweepMainView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../common/PlayerModule"),s=e("../../Global/GameGlobal"),c=e("../../modules/base/BaseView"),l=e("../../modules/base/Decorators"),d=e("../../modules/base/GameView"),u=e("../../network/ClientNetwork"),h=e("../../network/protocol/RoleProtocols"),p=e("../../utils/GameUtils"),f=e("../../utils/ConfigUtils"),g=e("../../network/LocalMessage"),m=cc._decorator,_=m.ccclass,y=m.property,v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.m_btn_sweep=null,t.m_btn_sweep_buy=null,t.m_txt_roundNum=null,t.m_txt_ticketNum=null,t.m_ticket_cost=1,t.rewardCount=0,t.tRewards=new Array,t}return a(t,e),t.path=function(){return"ui/sweep/sweepMainView"},t.prototype.onLoad=function(){},t.prototype.start=function(){var e=this;u.ClientNetwork.getInstance().listenProtocol(h.ROLE_CLIENT_ENUM.P_Role_Cooperation_Sweep,this.__recieve_coop_sweep,this),u.ClientNetwork.getInstance().listenLocalMessage(g.LOCAL_MESSAGE.LocalMsg_itemChange_sweepCard,function(){e.updateView()},this),this.m_roundMax=r.default.getRoleInfoData().cooperADRoundNum,this.m_txt_roundNum.string=this.m_roundMax+"",this.m_itemTicketID=Number(p.getConfigIntValue("cooper_sweep_id")),this.updateView()},t.prototype.updateView=function(){this.m_ticketNum=r.default.getItemCountByBag(this.m_itemTicketID),this.m_txt_ticketNum.string=this.m_ticketNum+"/"+this.m_ticket_cost,this.m_ticketNum>0?(this.m_btn_sweep.active=!0,this.m_btn_sweep_buy.active=!1):(this.m_btn_sweep.active=!1,this.m_btn_sweep_buy.active=!0)},t.prototype.onClickBtnSweep=function(){if(this.m_ticketNum<this.m_ticket_cost){var e=f.default.getInstance().getItemByID(this.m_itemTicketID),t=s.G.StringManager.getWorldString("utils_notEnough",e.name);s.G.StringManager.PopString(t)}else{var o=Number(p.getConfigIntValue("coopration_mixround_noprize"));if(this.m_roundMax<=o)return s.G.StringManager.PopString(s.G.StringManager.getString("SWEEP_ROUND_MIN"));if(r.default.getRoleInfoData().cooperationDayLeftNum<=0)return s.G.StringManager.PopString(s.G.StringManager.getString("COOP_TIMES_NOTENOUGH"));var i=new h.C_Role_Cooperation_Sweep;i.count=this.m_ticket_cost,u.ClientNetwork.getInstance().Send(h.ROLE_CLIENT_ENUM.P_Role_Cooperation_Sweep,i)}},t.prototype.__recieve_coop_sweep=function(e){e.resetPos();var t=new h.S_Role_Cooperation_Sweep;if(t.read(e))if(0==t.errorcode){if(t.prize.length>0){var o=d.default.getViewByName("MainSceneView");if(o&&o.view)return this.node.active=!1,this.tRewards=t.prize,this.rewardCount=0,void this.onShowSweepRewards();r.default.setRechargePrizeData(t.prize)}}else s.G.StringManager.PopString(["\u626b\u8361\u6210\u529f","\u5f53\u5929\u8fdb\u884c\u4e00\u6b21\u5408\u4f5c\u540e\u65b9\u53ef\u626b\u8361","\u5408\u4f5c\u6b21\u6570\u4e0d\u8db3","\u626b\u8361\u5361\u4e0d\u8db3","\u626b\u8361\u56de\u5408\u6570\u5f02\u5e38"][t.errorcode])},t.prototype.onShowSweepRewards=function(){var e=this;if(!(this.tRewards.length<=0)){var t=this.tRewards.slice(6*this.rewardCount,6*(this.rewardCount+1));if(t.length<=0)return this.closeView();t.length>0&&d.default.addPopView("BaseCtrl","AcquirePopupView","AcquirePopupView",{items:t,closeCb:function(){e.rewardCount++,e.onShowSweepRewards()}})}},t.prototype.onClickBtnSweep_buy=function(){d.default.addPopView("ShopMainCtrl","PopUpBuyView","PopUpBuyView",{closeCb:function(){}})},n([y(cc.Node)],t.prototype,"m_btn_sweep",void 0),n([y(cc.Node)],t.prototype,"m_btn_sweep_buy",void 0),n([y(cc.Label)],t.prototype,"m_txt_roundNum",void 0),n([y(cc.Label)],t.prototype,"m_txt_ticketNum",void 0),n([l.Register_Class,_],t)}(c.default);o.default=v,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/base/GameView":"GameView","../../network/ClientNetwork":"ClientNetwork","../../network/LocalMessage":"LocalMessage","../../network/protocol/RoleProtocols":"RoleProtocols","../../utils/ConfigUtils":"ConfigUtils","../../utils/GameUtils":"GameUtils"}],SystemChatPanel:[function(e,t,o){"use strict";cc._RF.push(t,"9b2d2FwT5BJd6FRC2LaomP3","SystemChatPanel");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/cores/UISuperLayout"),s=e("../../common/PlayerModule"),c=e("../../network/protocol/TypeProtocols"),l=e("../../network/ClientNetwork"),d=e("../../network/protocol/ChatProtocols"),u=e("../../network/protocol/ChatProtocols"),h=e("../../Global/GameGlobal"),p=cc._decorator,f=p.ccclass,g=p.property,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.scrollViewNode=null,t.unreadNode=null,t.tMsgDatas=new Array,t.nUnreadMsgCount=0,t}return a(t,e),t.prototype.onLoad=function(){var e=this,t=this.tMsgDatas;l.ClientNetwork.getInstance().listenProtocol(d.CHAT_CLIENT_ENUM.P_Chat_CloseFightRoom,function(o){o.resetPos();var i=new u.S_Chat_CloseFightRoom;if(i.read(o)){for(var a=!1,n=0;n<t.length;n++)if(t[n].chatType==c.TYPE_CHAT.TYPE_CHAT_ROOMFIGHT&&t[n].chatText==i.roomID&&1!=t[n].chatParam){t[n].chatParam=1,a=!0;break}1==a&&e.scrollViewNode.children.forEach(function(t){t.roomId&&t.roomId==i.roomID&&e.scrollViewNode.notifyRefreshItem(t)})}},this),this.schedule(function(){e.nUnreadMsgCount=0,e.tMsgDatas.forEach(function(t){t.bReadState&&0!=t.bReadState||e.nUnreadMsgCount++}),e.nUnreadMsgCount>99&&(e.nUnreadMsgCount=99),e.node.getChildByName("unread").active=e.nUnreadMsgCount>1,e.nUnreadMsgCount>=99?e.node.getChildByName("unread").children[0].getComponent(cc.Label).string=h.G.StringManager.getWorldString("chat_unread_max"):e.node.getChildByName("unread").children[0].getComponent(cc.Label).string=h.G.StringManager.getWorldString("chat_unread",e.nUnreadMsgCount)},.2)},t.prototype.onEnable=function(){this.scrollViewNode.total(this.tMsgDatas.length),this.onClickUnreadCallBack()},t.prototype.addSystemChatMsg=function(e){var t=this;1!=this.checkRoomInChannel(e)&&(this.tMsgDatas.push(e),0!=this.node.active&&(this.scrollViewNode.total(this.tMsgDatas.length),1!=s.default.UUID.equals(e.roleID)&&1!=this.scrollViewNode.scrollView.isScrollBounceBottom||(e.bReadState=1,setTimeout(function(){try{t.scrollViewNode.scrollToFooter(.1)}catch(e){}},50))))},t.prototype.onClickUnreadCallBack=function(){var e=this;this.tMsgDatas.forEach(function(e){e.bReadState=1}),this.scrollViewNode.scrollView.isScrollBounceBottom=!0,setTimeout(function(){try{e.scrollViewNode.scrollToFooter(.1)}catch(t){}},50)},t.prototype.checkRoomInChannel=function(e){for(var t=0;t<this.tMsgDatas.length;t++)if(this.tMsgDatas[t].chatText==e.chatText&&this.tMsgDatas[t].chatType==c.TYPE_CHAT.TYPE_CHAT_ROOMFIGHT)return!0;return!1},t.prototype.onListRender=function(e,t){e.getComponent("ChatItem").show(this.tMsgDatas[t])},t.prototype.onDestroy=function(){this.unscheduleAllCallbacks(),l.ClientNetwork.getInstance().removeMessageTarget(this)},n([g(r.default)],t.prototype,"scrollViewNode",void 0),n([g(cc.Node)],t.prototype,"unreadNode",void 0),n([f],t)}(cc.Component);o.default=m,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../common/PlayerModule":"PlayerModule","../../modules/cores/UISuperLayout":"UISuperLayout","../../network/ClientNetwork":"ClientNetwork","../../network/protocol/ChatProtocols":"ChatProtocols","../../network/protocol/TypeProtocols":"TypeProtocols"}],TableReader:[function(e,t,o){"use strict";cc._RF.push(t,"57f5bqOMMFA3IyTj+Rrg7Gv","TableReader");var i=this&&this.__awaiter||function(e,t,o,i){return new(o||(o=Promise))(function(a,n){function r(e){try{c(i.next(e))}catch(t){n(t)}}function s(e){try{c(i.throw(e))}catch(t){n(t)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(r,s)}c((i=i.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){var o,i,a,n,r={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return n={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function s(e){return function(t){return c([e,t])}}function c(n){if(o)throw new TypeError("Generator is already executing.");for(;r;)try{if(o=1,i&&(a=2&n[0]?i.return:n[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return r.label++,{value:n[1],done:!1};case 5:r.label++,i=n[1],n=[0];continue;case 7:n=r.ops.pop(),r.trys.pop();continue;default:if(!(a=(a=r.trys).length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){r=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){r.label=n[1];break}if(6===n[0]&&r.label<a[1]){r.label=a[1],a=n;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(n);break}a[2]&&r.ops.pop(),r.trys.pop();continue}n=t.call(e,r)}catch(s){n=[6,s],i=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.ReadTable=o.TableReader=o.GetDataMapAsync=o.GetTableDataAsync=o.PreLoadCsv=o.PreLoadCsvSync=o.CSV_DIR=void 0;var n=e("./utils/GamePlatform"),r=e("./network/protocol/long");o.CSV_DIR="StaticData/";var s=new Set(["ActivityTableData","RoyaleRangeTableData","RoyaleRankListTableData"]);function c(e){return"bigBlue"==n.GamePlatform.getMiYaVideoTypeNoSet()&&1==s.has(e)?"DaLan/":""}function l(e){var t=o.CSV_DIR+c(e)+e,i=cc.resources.get(t,cc.TextAsset);return i?Promise.resolve(i):new Promise(function(t){cc.resources.load(o.CSV_DIR+c(e)+e,cc.TextAsset,function(e,o){t(e?null:o)})})}o.PreLoadCsvSync=function(e,t){return void 0===t&&(t=null),i(this,void 0,Promise,function(){var o;return a(this,function(i){switch(i.label){case 0:return[4,l(e)];case 1:return o=i.sent(),t&&(o||console.error("************\u8868\u52a0\u8f7d\u5931\u8d25\uff1a",e),t(o)),[2,o]}})})},o.PreLoadCsv=l,o.GetTableDataAsync=function(e,t){return i(this,void 0,Promise,function(){return a(this,function(o){switch(o.label){case 0:return[4,l(e.getFilename())];case 1:return o.sent()?[2,Promise.resolve(e.getById(t))]:[2,Promise.resolve(null)]}})})},o.GetDataMapAsync=function(e){return i(this,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return[4,l(e.getFilename())];case 1:return t.sent()?[2,e.getDataMap()]:[2,null]}})})};var d=function(){function e(e){this.m_str=e,this.m_pos=0}return e.prototype.getChar=function(e){return void 0===e&&(e=0),this.m_str[e]},e.prototype.readChar=function(){return this.getChar(this.m_pos++)},e.prototype.getNumber=function(){return Number(this.readNextToken())},e.prototype.getString=function(){return this.readNextToken()},e.prototype.getBoolean=function(){return Boolean(parseInt(this.readNextToken()))},e.prototype.getLong=function(){return r.fromString(this.readNextToken())},e.prototype.getLen=function(){return this.m_str.length},e.prototype.getPos=function(){return this.m_pos},e.prototype.resetPos=function(){this.m_pos=0},e.prototype.advance=function(e){this.m_pos+=e},e.prototype.readNextToken=function(e){if(void 0===e&&(e=!1),this.getPos()==this.getLen())return"";if(this.getPos()>this.getLen())throw new Error("readNextToken value.getPos="+this.getPos()+" > value.getLen="+this.getLen());for(var t="",o="",i=!1;!(this.getPos()>=this.getLen());)if("\r"!=(o=this.readChar()))if(i)'"'==o?this.getPos()<this.getLen()&&'"'==this.getChar()?(t+='"',this.advance(1)):i=!1:t+=o;else if('"'==o&&0==t.length)i=!0;else{if(","==o||"#"==o)break;if("\n"==o){if(!e)break}else t+=o}return t},e}();o.TableReader=d,o.ReadTable=function(e,t){var i=cc.resources.get(o.CSV_DIR+c(e)+e,cc.TextAsset);if(i)for(var a=i.text.split("\r\n"),n=0,r=3;r<a.length;++r)if(0!=a[r].length){var s=new d(a[r]),l=new t;l.readOriginal(s),l.isAutoId()?++n:(l.id<=0&&console.log("TableReader Warning: "+e+":"+r+" id <= 0"),n=l.id),l.insertData(n)}},cc._RF.pop()},{"./network/protocol/long":"long","./utils/GamePlatform":"GamePlatform"}],TalkingDataAPI:[function(e,t,o){"use strict";cc._RF.push(t,"e4b2dsYJJFBZoHoK/4HtG5e","TalkingDataAPI"),Object.defineProperty(o,"__esModule",{value:!0}),o.TalkingDataAPI=void 0;var i=e("./utils/GamePlatform"),a=function(){function e(){}return e.getSDK=function(){var e=GameGlobal.tdAppSdk;return console.log("tdsdk",e),e},e.event=function(t,o){if(console.log("TalkingDataAPI event:",t,", param:",o),0==i.GamePlatform.isWechat())return!1;null==o?e.getSDK().event({id:t,label:t}):e.getSDK().event({id:t,label:t,params:o})},e}();o.TalkingDataAPI=a,cc._RF.pop()},{"./utils/GamePlatform":"GamePlatform"}],TaskAchRewardItem:[function(e,t,o){"use strict";cc._RF.push(t,"08b5a58arxNobSyjoyh+JCE","TaskAchRewardItem");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../common/PlayerModule"),s=e("../../utils/ConfigUtils"),c=e("../../network/protocol/TypeProtocols"),l=e("../../network/ClientNetwork"),d=e("../../network/protocol/RoleProtocols"),u=e("../../network/protocol/RoleProtocols"),h=e("../../utils/GameTools"),p=cc._decorator,f=p.ccclass,g=p.property,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.m_spTaskRewardIcon=null,t.m_lTaskRewardNum=null,t.m_btnTaskTake=null,t.m_lTaskUnConplete=null,t.m_layoutBoxRewards=null,t.m_lTaskRewardPoint=null,t.m_nTaskId=0,t.m_bTaskComplete=!1,t}return a(t,e),t.prototype.onLoad=function(){},t.prototype.start=function(){},t.prototype.onDestroy=function(){},t.prototype.onClickTake=function(){if(1==this.m_bTaskComplete){var e=new u.C_Role_TakeTask;e.taskID=this.m_nTaskId,l.ClientNetwork.getInstance().Send(d.ROLE_CLIENT_ENUM.P_Role_TakeTask,e)}},t.prototype.initData=function(e,t){this.m_nTaskId=e.taskID,this.m_lTaskRewardNum.string=""+t.finishCount;var o=s.default.getInstance().getDorpItemsByID(t.prizeID).dropRandom.split("|");for(var i in o){var a=o[i].split("#");if(1005==a[0])this.m_lTaskRewardPoint.string=a[1];else{var n=a[0];s.default.getInstance().getItemByID(n).icon,h.default.createNormalItems(n,a[1],this.m_layoutBoxRewards.node,function(e){e.scale=.7})}}r.default.getItemCountByBag(1005)/t.finishCount>=1&&(this.m_bTaskComplete=!0),e.taskState==c.TASK_STATE.TASK_STATE_EXECUTING?(this.m_btnTaskTake.node.active=!1,this.m_lTaskUnConplete.node.active=!0,1==this.m_bTaskComplete&&(this.m_btnTaskTake.node.active=!0,this.m_lTaskUnConplete.node.active=!1)):(this.m_btnTaskTake.node.active=!1,this.m_lTaskUnConplete.node.active=!1,this.node.getChildByName("achievement_item").getChildByName("finish").active=!0)},n([g(cc.Sprite)],t.prototype,"m_spTaskRewardIcon",void 0),n([g(cc.Label)],t.prototype,"m_lTaskRewardNum",void 0),n([g(cc.Button)],t.prototype,"m_btnTaskTake",void 0),n([g(cc.Label)],t.prototype,"m_lTaskUnConplete",void 0),n([g(cc.Layout)],t.prototype,"m_layoutBoxRewards",void 0),n([g(cc.Label)],t.prototype,"m_lTaskRewardPoint",void 0),n([f],t)}(cc.Component);o.default=m,cc._RF.pop()},{"../../common/PlayerModule":"PlayerModule","../../network/ClientNetwork":"ClientNetwork","../../network/protocol/RoleProtocols":"RoleProtocols","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/ConfigUtils":"ConfigUtils","../../utils/GameTools":"GameTools"}],TaskAchRewardView:[function(e,t,o){"use strict";cc._RF.push(t,"35bb948jr1IAKaNP76jE/MQ","TaskAchRewardView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/Decorators"),s=e("../../modules/base/BaseView"),c=e("../../common/PlayerModule"),l=e("../../network/protocol/TypeProtocols"),d=e("../../network/ClientNetwork"),u=e("../../network/LocalMessage"),h=e("../../utils/ResourcesManager"),p=e("../../StaticData/TaskTableData"),f=e("../../utils/LogUtil"),g=e("../../modules/manager/LoadResManager"),m=cc._decorator,_=m.ccclass,y=m.property,v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.m_scrollView=null,t}return a(t,e),t.path=function(){return"ui/task/taskPrefabs/taskAchRewardLayer"},t.prototype.onLoad=function(){this.refresh();var e=this;d.ClientNetwork.getInstance().listenLocalMessage(u.LOCAL_MESSAGE.LocalMsg_RefreshTask,function(){e.refresh()}.bind(this),this)},t.prototype.start=function(){},t.prototype.initTopView=function(){var e=this;g.default.loadPrefab("ui/CommonPrefab/TopView").then(function(t){t.parent=e.node,t.getComponent("TopView").bindExitEvent(function(){e.closeView()})}).catch(function(e){f.default.info(e)})},t.prototype.onDestroy=function(){},t.prototype.onClickClose=function(){this.closeView()},t.prototype.isTotalAchievementTask=function(e,t){return e==l.TASK_SHOW_TYPE.TASK_SHOW_TYPE_ACHIEVEMENT&&t==l.TASK_CLIENT_TYPE.TASK_CLIENT_TYPE_ACHIEVEMENT_TOTAL},t.prototype.isAchievementComplete=function(e){return e.taskState==l.TASK_STATE.TASK_STATE_EXECUTING&&p.TaskTableData.getById(e.taskID).finishCount<=c.default.getItemCountByBag(1005)?1:0},t.prototype.isAchievementTaked=function(e){return e.taskState==l.TASK_STATE.TASK_STATE_FINISH?1:0},t.prototype.refresh=function(){var e=this;this.m_scrollView.content.removeAllChildren();var t=Array.from(c.default.getRoleTaskData().tasks.values()),o=this;t.sort(function(e,t){return o.isAchievementComplete(t)-o.isAchievementComplete(e)||o.isAchievementTaked(e)-o.isAchievementTaked(t)||e.taskID-t.taskID}),t.forEach(function(t){var o=p.TaskTableData.getById(t.taskID);o.groupType==l.TASK_GROUP_TYPE.TASK_GROUP_TYPE_COMMON&&e.isTotalAchievementTask(o.showType,o.clientType)&&h.default.loadPrefab("ui/task/taskPrefabs/taskAchRewardtItem",e.m_scrollView.content,function(i){i.getComponent("TaskAchRewardItem").initData(t,o),e.m_scrollView.scrollToTop()})})},n([y(cc.ScrollView)],t.prototype,"m_scrollView",void 0),n([r.Register_Class,_],t)}(s.default);o.default=v,cc._RF.pop()},{"../../StaticData/TaskTableData":"TaskTableData","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/manager/LoadResManager":"LoadResManager","../../network/ClientNetwork":"ClientNetwork","../../network/LocalMessage":"LocalMessage","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/LogUtil":"LogUtil","../../utils/ResourcesManager":"ResourcesManager"}],TaskAchievementItem:[function(e,t,o){"use strict";cc._RF.push(t,"8a457hFlKpOdb2+DRvhgeU6","TaskAchievementItem");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../common/PlayerModule"),s=e("../../utils/ConfigUtils"),c=e("../../network/protocol/TypeProtocols"),l=e("../../network/ClientNetwork"),d=e("../../utils/ResourcesManager"),u=e("../../network/protocol/RoleProtocols"),h=e("../../network/protocol/RoleProtocols"),p=e("../../modules/base/GameView"),f=e("../../Global/GameGlobal"),g=cc._decorator,m=g.ccclass,_=g.property,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.m_lTaskPoint=null,t.m_lTaskName=null,t.m_lTaskDesc=null,t.m_pTaskProgress=null,t.m_lTaskProNum=null,t.m_spTaskRewardIcon=null,t.m_lTaskRewardNum=null,t.m_btnTaskTake=null,t.m_lTaskUnConplete=null,t.m_lTaskRewardPoint=null,t.m_nTaskId=0,t.m_bTaskComplete=!1,t}return a(t,e),t.prototype.onLoad=function(){},t.prototype.start=function(){},t.prototype.onDestroy=function(){},t.prototype.onClickTake=function(){if(1==this.m_bTaskComplete){var e=new h.C_Role_TakeTask;e.taskID=this.m_nTaskId,l.ClientNetwork.getInstance().Send(u.ROLE_CLIENT_ENUM.P_Role_TakeTask,e)}},t.prototype.onClickAchievement=function(){p.default.addPopView("BaseCtrl","taskAchievementLayer","taskAchievementLayer",{cb:function(){}})},t.prototype.initData=function(e,t){this.m_nTaskId=e.taskID,this.m_lTaskName.string=f.G.StringManager.getWorldString(t.info),this.m_lTaskDesc.string=f.G.StringManager.getWorldString(t.info2,t.info3),this.m_pTaskProgress.progress=e.taskCount/t.finishCount,this.m_lTaskProNum.string=e.taskCount+"/"+t.finishCount;var o=s.default.getInstance().getDorpItemsByID(t.prizeID).dropRandom.split("|");for(var i in o){var a=o[i].split("#");if(1005==a[0])this.m_lTaskRewardPoint.string=a[1];else{var n=a[0],l=s.default.getInstance().getItemByID(n).icon;d.default.loadSprite(l,this.m_spTaskRewardIcon,null),this.m_lTaskRewardNum.string=a[1],1==a[1]&&(this.m_spTaskRewardIcon.node.x=0,this.m_lTaskRewardNum.node.active=!1)}}if(t.type==c.TASK_TYPE.TASK_TEYP_CONDITION_ITEMNUMBYTYPE){var u=r.default.getRoleBagItems(),h=0;u.forEach(function(e){if(e){var o=s.default.getInstance().getItemByID(e.itemId);if(o&&o.type==t.finishParam1){var i=!1;h+=1,t.finishParam4>0?r.default.getHeroCarData()[e.itemId].heroLevel>=t.finishParam4&&(i=!0):t.finishParam2>0?o.quality==t.finishParam2&&(i=!0):i=!0,0==i&&(h-=1)}}}),5==t.finishParam1&&(h-=1),h>0&&(this.m_pTaskProgress.progress=h/t.finishCount,this.m_lTaskProNum.string=h+"/"+t.finishCount,h>=t.finishCount&&(this.m_bTaskComplete=!0))}else if(t.type==c.TASK_TYPE.TASK_TYPE_CONDITION_MAXCUPSCOUNT){var p=r.default.getRoleAttrValByKey(c.ROLE_ATTR_VALUES.ROLE_ATTR_MAX_SCORE);this.m_pTaskProgress.progress=p/t.finishCount,this.m_lTaskProNum.string=p+"/"+t.finishCount,p/t.finishCount>=1&&(this.m_bTaskComplete=!0)}else if(t.type==c.TASK_TYPE.TASK_TYPE_COUNT_PROFICIENCY){var g=function(){var e=0;return r.default.getHeroCarData().forEach(function(o){if(1==o.bHeroLock){var i=r.default.getHeroProficiencyDataById(o.heroId);i&&i.proficiency>=t.finishParam2&&e++}}),e}.call(this);this.m_pTaskProgress.progress=g/t.finishParam1,this.m_lTaskProNum.string=g+"/"+t.finishParam1,e.taskCount/t.finishCount>=1&&(this.m_bTaskComplete=!0)}else e.taskCount/t.finishCount>=1&&(this.m_bTaskComplete=!0);e.taskState==c.TASK_STATE.TASK_STATE_EXECUTING?(this.m_btnTaskTake.node.active=!1,this.m_lTaskUnConplete.node.active=!0,1==this.m_bTaskComplete&&(this.m_btnTaskTake.node.active=!0,this.m_lTaskUnConplete.node.active=!1)):(this.m_btnTaskTake.node.active=!1,this.m_lTaskUnConplete.node.active=!0,this.m_lTaskUnConplete.string="\u5df2\u5b8c\u6210")},n([_(cc.Label)],t.prototype,"m_lTaskPoint",void 0),n([_(cc.Label)],t.prototype,"m_lTaskName",void 0),n([_(cc.Label)],t.prototype,"m_lTaskDesc",void 0),n([_(cc.ProgressBar)],t.prototype,"m_pTaskProgress",void 0),n([_(cc.Label)],t.prototype,"m_lTaskProNum",void 0),n([_(cc.Sprite)],t.prototype,"m_spTaskRewardIcon",void 0),n([_(cc.Label)],t.prototype,"m_lTaskRewardNum",void 0),n([_(cc.Button)],t.prototype,"m_btnTaskTake",void 0),n([_(cc.Label)],t.prototype,"m_lTaskUnConplete",void 0),n([_(cc.Label)],t.prototype,"m_lTaskRewardPoint",void 0),n([m],t)}(cc.Component);o.default=y,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../common/PlayerModule":"PlayerModule","../../modules/base/GameView":"GameView","../../network/ClientNetwork":"ClientNetwork","../../network/protocol/RoleProtocols":"RoleProtocols","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/ConfigUtils":"ConfigUtils","../../utils/ResourcesManager":"ResourcesManager"}],TaskAchievementView:[function(e,t,o){"use strict";cc._RF.push(t,"4c198pnbrpG07ew4AflRdBj","TaskAchievementView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../common/PlayerModule"),s=e("../../network/protocol/TypeProtocols"),c=e("../../network/ClientNetwork"),l=e("../../network/LocalMessage"),d=e("../../utils/ResourcesManager"),u=e("../../StaticData/TaskTableData"),h=e("../../modules/base/GameView"),p=e("./TaskView"),f=cc._decorator,g=f.ccclass,m=f.property,_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.m_lTaskAchPoint=null,t.m_scrollView=null,t.m_spTotalRedPoint=null,t.m_spPVPRedPoint=null,t.m_spCOOPRedPoint=null,t.m_spHeroRedPoint=null,t.m_spOtherRedPoint=null,t.m_curSelTab=s.TASK_CLIENT_TYPE.TASK_CLIENT_TYPE_ACHIEVEMENT_PVP,t}return a(t,e),t.prototype.onLoad=function(){var e=this;c.ClientNetwork.getInstance().listenLocalMessage(l.LOCAL_MESSAGE.LocalMsg_RefreshTask,function(){e.refresh()}.bind(this),this),c.ClientNetwork.getInstance().listenLocalMessage(l.LOCAL_MESSAGE.LocalMsg_SyncAchPoint,function(){e.m_lTaskAchPoint.string=""+r.default.getItemCountByBag(1005),1==p.default.showAchTabRedPoint(s.TASK_CLIENT_TYPE.TASK_CLIENT_TYPE_ACHIEVEMENT_TOTAL)&&(this.m_spTotalRedPoint.node.active=!0)}.bind(this),this)},t.prototype.start=function(){},t.prototype.onDestroy=function(){},t.prototype.onClickAchievement=function(){h.default.addPopView("BaseCtrl","TaskAchRewardView","TaskAchRewardView",{cb:function(){}})},t.prototype.onClickPVP=function(){this.m_curSelTab!=s.TASK_CLIENT_TYPE.TASK_CLIENT_TYPE_ACHIEVEMENT_PVP&&(this.m_curSelTab=s.TASK_CLIENT_TYPE.TASK_CLIENT_TYPE_ACHIEVEMENT_PVP,this.refresh())},t.prototype.onClickCOOP=function(){this.m_curSelTab!=s.TASK_CLIENT_TYPE.TASK_CLIENT_TYPE_ACHIEVEMENT_COOP&&(this.m_curSelTab=s.TASK_CLIENT_TYPE.TASK_CLIENT_TYPE_ACHIEVEMENT_COOP,this.refresh())},t.prototype.onClickHero=function(){this.m_curSelTab!=s.TASK_CLIENT_TYPE.TASK_CLIENT_TYPE_ACHIEVEMENT_HERO&&(this.m_curSelTab=s.TASK_CLIENT_TYPE.TASK_CLIENT_TYPE_ACHIEVEMENT_HERO,this.refresh())},t.prototype.onClickOther=function(){this.m_curSelTab!=s.TASK_CLIENT_TYPE.TASK_CLIENT_TYPE_ACHIEVEMENT_OTHER&&(this.m_curSelTab=s.TASK_CLIENT_TYPE.TASK_CLIENT_TYPE_ACHIEVEMENT_OTHER,this.refresh())},t.prototype.isAchievementTask=function(e,t){return e==s.TASK_SHOW_TYPE.TASK_SHOW_TYPE_ACHIEVEMENT&&t==this.m_curSelTab},t.prototype.isAchievementComplete=function(e){return e.taskState==s.TASK_STATE.TASK_STATE_EXECUTING&&u.TaskTableData.getById(e.taskID).finishCount<=e.taskCount?1:0},t.prototype.refresh=function(){var e=this;this.m_lTaskAchPoint.string=""+r.default.getItemCountByBag(1005),this.m_scrollView.content.removeAllChildren(),this.showRedPoint();var t=Array.from(r.default.getRoleTaskData().tasks.values()),o=this;t.sort(function(e,t){return o.isAchievementComplete(t)-o.isAchievementComplete(e)||e.taskID-t.taskID}),t.forEach(function(t){if(t.taskState==s.TASK_STATE.TASK_STATE_EXECUTING){var o=u.TaskTableData.getById(t.taskID);o.groupType==s.TASK_GROUP_TYPE.TASK_GROUP_TYPE_COMMON&&e.isAchievementTask(o.showType,o.clientType)&&d.default.loadPrefab("ui/task/taskPrefabs/taskAchievementItem",e.m_scrollView.content,function(i){i.getComponent("TaskAchievementItem").initData(t,o),e.m_scrollView.scrollToTop()})}})},t.prototype.showRedPoint=function(){this.m_spTotalRedPoint.node.active=!1,this.m_spPVPRedPoint.node.active=!1,this.m_spCOOPRedPoint.node.active=!1,this.m_spHeroRedPoint.node.active=!1,this.m_spOtherRedPoint.node.active=!1,1==p.default.showAchTabRedPoint(s.TASK_CLIENT_TYPE.TASK_CLIENT_TYPE_ACHIEVEMENT_PVP)&&(this.m_spPVPRedPoint.node.active=!0),1==p.default.showAchTabRedPoint(s.TASK_CLIENT_TYPE.TASK_CLIENT_TYPE_ACHIEVEMENT_COOP)&&(this.m_spCOOPRedPoint.node.active=!0),1==p.default.showAchTabRedPoint(s.TASK_CLIENT_TYPE.TASK_CLIENT_TYPE_ACHIEVEMENT_HERO)&&(this.m_spHeroRedPoint.node.active=!0),1==p.default.showAchTabRedPoint(s.TASK_CLIENT_TYPE.TASK_CLIENT_TYPE_ACHIEVEMENT_OTHER)&&(this.m_spOtherRedPoint.node.active=!0),1==p.default.showAchTabRedPoint(s.TASK_CLIENT_TYPE.TASK_CLIENT_TYPE_ACHIEVEMENT_TOTAL)&&(this.m_spTotalRedPoint.node.active=!0)},n([m(cc.Label)],t.prototype,"m_lTaskAchPoint",void 0),n([m(cc.ScrollView)],t.prototype,"m_scrollView",void 0),n([m(cc.Sprite)],t.prototype,"m_spTotalRedPoint",void 0),n([m(cc.Sprite)],t.prototype,"m_spPVPRedPoint",void 0),n([m(cc.Sprite)],t.prototype,"m_spCOOPRedPoint",void 0),n([m(cc.Sprite)],t.prototype,"m_spHeroRedPoint",void 0),n([m(cc.Sprite)],t.prototype,"m_spOtherRedPoint",void 0),n([g],t)}(cc.Component);o.default=_,cc._RF.pop()},{"../../StaticData/TaskTableData":"TaskTableData","../../common/PlayerModule":"PlayerModule","../../modules/base/GameView":"GameView","../../network/ClientNetwork":"ClientNetwork","../../network/LocalMessage":"LocalMessage","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/ResourcesManager":"ResourcesManager","./TaskView":"TaskView"}],TaskBoxTableData:[function(e,t,o){"use strict";cc._RF.push(t,"ba39anXZ3BDGpsJNnUiNWZp","TaskBoxTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.TaskBoxTableData=void 0;var i=e("../TableReader"),a=function(){function e(){this.groupType=0,this.boxID=0,this.needBoxItemNum=0,this.prizeID=0,this.strScop=new Array}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.groupType=e.getNumber(),this.boxID=e.getNumber(),this.needBoxItemNum=e.getNumber(),this.prizeID=e.getNumber();for(var o=e.getString(),a=new i.TableReader(o);a.getPos()<a.getLen();){var n;n=a.getString(),this.strScop.push(n)}},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"TaskBoxTableData"},e.prototype.isAutoId=function(){return!0},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.TaskBoxTableData=a,cc._RF.pop()},{"../TableReader":"TableReader"}],TaskDayItem:[function(e,t,o){"use strict";cc._RF.push(t,"683acC+M6lKC7/gd6HZzsl+","TaskDayItem");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../utils/ConfigUtils"),s=e("../../network/protocol/TypeProtocols"),c=e("../../network/ClientNetwork"),l=e("../../utils/ResourcesManager"),d=e("../../network/protocol/RoleProtocols"),u=e("../../network/protocol/RoleProtocols"),h=e("../../modules/base/GameView"),p=e("../../common/CombatModule"),f=e("../../utils/RewardedVideoUnitIdConst"),g=e("../../utils/RewardedVideoAd"),m=e("../sociaty/SociatyModel"),_=e("../../Global/GameGlobal"),y=e("../../utils/GameUtils"),v=e("../../common/PlayerModule"),C=e("../../network/protocol/TypeProtocols"),S=cc._decorator,T=S.ccclass,I=S.property,N=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.m_lTaskName=null,t.m_lTaskDesc=null,t.m_pTaskProgress=null,t.m_lTaskProNum=null,t.m_spTaskRewardIcon=null,t.m_lTaskRewardNum=null,t.m_TaskTakeGoTo=null,t.m_TaskTakeGetReward=null,t.m_nodeTaskComplete=null,t.m_nodeTaskTake=null,t.m_spTaskQuality=null,t.m_nTaskId=0,t.m_nTaskIndx=0,t.m_bTaskComplete=!1,t.m_jumpType=0,t.m_tRewards=[],t}return a(t,e),t.prototype.onLoad=function(){},t.prototype.start=function(){},t.prototype.onDestroy=function(){},t.prototype.onClickTake=function(){var e=this;if(1==this.m_bTaskComplete)h.default.addPopView("BaseCtrl","ReceiveRewardView","ReceiveRewardView",{tRewards:this.m_tRewards,cb1:function(){var t=new u.C_Role_TakeTask;t.taskID=e.m_nTaskId,c.ClientNetwork.getInstance().Send(d.ROLE_CLIENT_ENUM.P_Role_TakeTask,t)},cb2:function(){e.onDoubleClickCallBack()}});else{var t=h.default.getViewByName("TaskView");if(t&&t.view&&t.view.closeView(),1===this.m_jumpType)h.default.addPopView("BaseCtrl","BattleRoomMainView","BattleRoomMainView",{CombatType:p.CombatType.SOLO});else if(2===this.m_jumpType){var o=Number(y.getConfigIntValue("coop_score_limit"));if(v.default.getRoleAttrValByKey(s.ROLE_ATTR_VALUES.ROLE_ATTR_SCORE)<o)return _.G.StringManager.PopWorldString(_.G.StringManager.getWorldString("coop_score_limit_tip",o));if(v.default.getRoleInfoData().cooperationDayLeftNum<=0||v.default.getRoleInfoData().cooperationDayWatchAdNum>Number(y.getConfigIntValue("match_cooperation_day_add_num"))){var i=_.G.StringManager.getString("ASSISTBATTLE_TIP_COOP");return h.default.addPopView("BaseCtrl","AssistBattleView","AssistBattleView",{fightType:C.FIGHT_TYPE.FIGHT_TYPE_COOPERATION,title:i.split("|")[0],tips:i.split("|")[1]})}h.default.addPopView("BaseCtrl","BattleRoomMainView","BattleRoomMainView",{CombatType:p.CombatType.COOP})}else if(6===this.m_jumpType){var a=m.default.instance().SociatyPlayerData;if(a.sociatyID.length<=0||0==Number(a.sociatyID))return _.G.StringManager.PopString(_.G.StringManager.getString("JUMP_SOCIATY_ERROR_TEXT"));h.default.addPopView("BaseCtrl","SociatyMainView","SociatyMainView")}}},t.prototype.onDoubleClickCallBack=function(){var e=this;g.default.createVideo({name:"task_double_reward",adUnitId:f.RewardedVideoUnitIdConst.TaskDoubleReward,advertID:f.RewardedVideoClientIdConst.Task_Double_Box,finishCb:function(){var t=new u.C_Role_TakeTask;t.taskID=e.m_nTaskId,t.isExtra=!0,c.ClientNetwork.getInstance().Send(d.ROLE_CLIENT_ENUM.P_Role_TakeTask,t),setTimeout(function(){var e=h.default.getViewByName("MainSceneView");e&&e.view&&e.view.onClientTaskAddAdvert(f.RewardedVideoClientIdConst.Task_Double_Box)},1e3)}})},t.prototype.initData=function(e,t,o){this.m_nTaskId=e.taskID,this.m_nTaskIndx=o,this.m_lTaskName.string=t.info_ps,this.m_lTaskDesc.string=t.info2_ps,this.m_pTaskProgress.progress=e.taskCount/t.finishCount,this.m_lTaskProNum.string=e.taskCount+"/"+t.finishCount;var i=r.default.getInstance().getDorpItemsByID(t.prizeID).dropRandom.split("|");for(var a in i){var n=i[a].split("#"),c=n[0],d=r.default.getInstance().getItemByID(c).icon;l.default.loadSprite(d,this.m_spTaskRewardIcon,null),this.m_lTaskRewardNum.string=n[1],this.m_tRewards.push({itemId:n[0],itemNum:n[1]})}l.default.loadSprite(t.ask_achieventment_icon,this.m_spTaskQuality,null),e.taskCount/t.finishCount>=1&&(this.m_bTaskComplete=!0),e.taskState==s.TASK_STATE.TASK_STATE_FINISH?(this.m_nodeTaskComplete.active=!0,this.m_nodeTaskTake.active=!1):1==this.m_bTaskComplete?(this.m_TaskTakeGetReward.active=!0,this.m_TaskTakeGoTo.active=!1):(this.m_TaskTakeGetReward.active=!1,this.m_TaskTakeGoTo.active=!0),this.m_jumpType=t.jumpType},n([I(cc.Label)],t.prototype,"m_lTaskName",void 0),n([I(cc.Label)],t.prototype,"m_lTaskDesc",void 0),n([I(cc.ProgressBar)],t.prototype,"m_pTaskProgress",void 0),n([I(cc.Label)],t.prototype,"m_lTaskProNum",void 0),n([I(cc.Sprite)],t.prototype,"m_spTaskRewardIcon",void 0),n([I(cc.Label)],t.prototype,"m_lTaskRewardNum",void 0),n([I(cc.Node)],t.prototype,"m_TaskTakeGoTo",void 0),n([I(cc.Node)],t.prototype,"m_TaskTakeGetReward",void 0),n([I(cc.Node)],t.prototype,"m_nodeTaskComplete",void 0),n([I(cc.Node)],t.prototype,"m_nodeTaskTake",void 0),n([I(cc.Sprite)],t.prototype,"m_spTaskQuality",void 0),n([T],t)}(cc.Component);o.default=N,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../common/CombatModule":"CombatModule","../../common/PlayerModule":"PlayerModule","../../modules/base/GameView":"GameView","../../network/ClientNetwork":"ClientNetwork","../../network/protocol/RoleProtocols":"RoleProtocols","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/ConfigUtils":"ConfigUtils","../../utils/GameUtils":"GameUtils","../../utils/ResourcesManager":"ResourcesManager","../../utils/RewardedVideoAd":"RewardedVideoAd","../../utils/RewardedVideoUnitIdConst":"RewardedVideoUnitIdConst","../sociaty/SociatyModel":"SociatyModel"}],TaskDayView:[function(e,t,o){"use strict";cc._RF.push(t,"c7738HXxflIk6iMQgkCZHOr","TaskDayView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0}),o.TIP_TYPE=void 0;var r,s=e("../../common/PlayerModule"),c=e("../../network/protocol/TypeProtocols"),l=e("../../network/ClientNetwork"),d=e("../../network/LocalMessage"),u=e("../../utils/ResourcesManager"),h=e("../../StaticData/TaskTableData"),p=e("../../modules/base/GameView"),f=e("../../network/protocol/RoleProtocols"),g=e("../../Global/GameGlobal"),m=e("../../utils/RewardedVideoAd"),_=e("../../utils/RewardedVideoUnitIdConst"),y=e("../../utils/GamePlatform"),v=e("../../utils/ByteDanceMiniGameUtils"),C=e("../../utils/subUtils/TypeDef"),S=e("../../utils/TimeOffSetManager"),T=e("../../utils/GameUtils"),I=e("../../utils/GameTools");(function(e){e[e.TIP_TYPE_VIDEO=1]="TIP_TYPE_VIDEO",e[e.TIP_TYPE_BOX=2]="TIP_TYPE_BOX",e[e.TIP_TYPE_REFRESH=3]="TIP_TYPE_REFRESH"})(r=o.TIP_TYPE||(o.TIP_TYPE={}));var N=cc._decorator,b=N.ccclass,w=N.property,E=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.m_scrollView=null,t.m_spBox1=null,t.m_spBox2=null,t.m_spBox3=null,t.m_spVideoRedPoint=null,t.takeLabel=null,t.time=null,t.watchBtn=null,t.m_ListBoxs=[],t.m_nCurBoxId=-1,t}var o;return a(t,e),o=t,t.prototype.onLoad=function(){var e=this;if(this.m_spBox1.node.on(cc.Node.EventType.TOUCH_END,function(){e.onClickVideoBox(1)}),this.m_spBox2.node.on(cc.Node.EventType.TOUCH_END,function(){e.onClickVideoBox(2)}),this.m_spBox3.node.on(cc.Node.EventType.TOUCH_END,function(){e.onClickVideoBox(3)}),this.m_ListBoxs.push(this.m_spBox1),this.m_ListBoxs.push(this.m_spBox2),this.m_ListBoxs.push(this.m_spBox3),o.m_nCurBoxGroupType=3,y.GamePlatform.isQQGameRoom()||y.GamePlatform.IsH5SmallBag()||y.GamePlatform.IsMiYaIosH5()||y.GamePlatform.IsDysbSmallBag()||y.GamePlatform.Is5Add7SmallBag()){var t=this.node.getChildByName("free_box_node").getChildByName("watchVideo"),i=this.node.getChildByName("free_box_node").getChildByName("watchQQVideo");t.active=!1,i.active=!0}this.setBoxCountDown(),this.refreshBoxs();var a=this;l.ClientNetwork.getInstance().listenLocalMessage(d.LOCAL_MESSAGE.LocalMsg_RefreshTask,function(){a.refresh()}.bind(this),this),l.ClientNetwork.getInstance().listenLocalMessage(d.LOCAL_MESSAGE.LocalMsg_RefreshTaskBox,function(){a.setBoxCountDown(),a.refreshBoxs()}.bind(this),this)},t.prototype.start=function(){this.changeAdButtonSkins()},t.prototype.onDestroy=function(){},t.prototype.setBoxCountDown=function(){o.m_LastTakeBoxTime=Number(T.getLocalData(o.getTakeTimeKey(),0)),o.getTakeleftTime()>0?this.schedule(this.refreshTimeCountDown,.1):this.unschedule(this.refreshTimeCountDown),this.refreshTimeCountDown()},t.prototype.refreshTimeCountDown=function(){var e=o.getTakeleftTime(),t=e<=0;this.takeLabel.node.active=t,this.time.node.active=!t,this.watchBtn.interactable=t,I.default.setNodeBright(this.watchBtn.node,t),e>0?this.time.string=S.TimeOffSetManager.getSecondStr2(e):(this.refreshBoxRedPoint(),this.unschedule(this.refreshTimeCountDown))},t.getTakeleftTime=function(){var e=S.TimeOffSetManager.getServerUTCSecond();return Number(T.getConfigIntValue("task_box_time_count_down"))-(e-o.m_LastTakeBoxTime)},t.getTakeTimeKey=function(){return C.GlobalVar.getAccountName()+o.takeTimeKey},t.prototype.onClickVideo=function(){o.getNextBoxId()>3?g.G.StringManager.PopStringOnce(g.G.StringManager.getString("TASK_BOX_TIMES_NOTENOUGH")):m.default.createVideo({name:"task_free_box",adUnitId:_.RewardedVideoUnitIdConst.TaskFreeBox,advertID:_.RewardedVideoClientIdConst.Task_Free_Box,finishCb:function(){var e=new f.C_Role_TakeTaskBox;e.groupType=c.TASK_GROUP_TYPE.TASK_GROUP_TYPE_RAND,e.boxID=o.getNextBoxId(),l.ClientNetwork.getInstance().Send(f.ROLE_CLIENT_ENUM.P_Role_TakeTaskBox,e)}})},t.prototype.onClickVideoBox=function(e){p.default.addPopView("BaseCtrl","taskRewardTips","taskRewardTips",{type:r.TIP_TYPE_BOX,id:e})},t.prototype.refresh=function(){var e=this;this.m_scrollView.content.removeAllChildren(),s.default.getRoleTaskData().extra.randTask.forEach(function(t,o){var i=h.TaskTableData.getById(t.taskID);i.groupType==c.TASK_GROUP_TYPE.TASK_GROUP_TYPE_RAND&&u.default.loadPrefab("ui/task/taskPrefabs/taskDayItem",e.m_scrollView.content,function(a){a.getComponent("TaskDayItem").initData(s.default.getRoleTaskData().tasks.get(t.taskID),i,o),e.m_scrollView.scrollToTop()})});var t=p.default.getViewByName("ReceiveRewardView");t&&t.view&&(t.view.node.active=!1,t.view.closeView())},t.getNextBoxId=function(){var e=0;return s.default.getRoleTaskData().extra.taskgroup.get(c.TASK_GROUP_TYPE.TASK_GROUP_TYPE_RAND)&&(e=s.default.getRoleTaskData().extra.taskgroup.get(c.TASK_GROUP_TYPE.TASK_GROUP_TYPE_RAND).boxs.size),e+1},t.prototype.refreshBoxs=function(){this.m_spVideoRedPoint.node.active=!1;var e=0;s.default.getRoleTaskData().extra.taskgroup.get(c.TASK_GROUP_TYPE.TASK_GROUP_TYPE_RAND)&&(e=s.default.getRoleTaskData().extra.taskgroup.get(c.TASK_GROUP_TYPE.TASK_GROUP_TYPE_RAND).boxs.size);for(var t=0;t<e;t++)cc.find("baoxiang_open",this.m_ListBoxs[t].node).active=!0;this.node.getChildByName("free_box_node").getChildByName("watchQQVideo").getChildByName("num").getComponent(cc.Label).string=e+"/3",e+=1,this.m_nCurBoxId=e,this.refreshBoxRedPoint()},t.prototype.refreshBoxRedPoint=function(){this.m_nCurBoxId>3?this.m_spVideoRedPoint.node.active=!1:this.m_spVideoRedPoint.node.active=!0,this.m_spVideoRedPoint.node.active&&o.getTakeleftTime()>0&&(this.m_spVideoRedPoint.node.active=!1)},t.prototype.changeAdButtonSkins=function(){y.GamePlatform.isByteDanceMiniGame()&&v.default.getInstance().changeSkinOfAdButton(this.node.getChildByName("free_box_node").getChildByName("watchVideo").getChildByName("Background"),"advertise_big")},t.m_nCurBoxGroupType=-1,t.m_LastTakeBoxTime=0,t.takeTimeKey="taskdayboxtimeinterval",n([w(cc.ScrollView)],t.prototype,"m_scrollView",void 0),n([w(cc.Sprite)],t.prototype,"m_spBox1",void 0),n([w(cc.Sprite)],t.prototype,"m_spBox2",void 0),n([w(cc.Sprite)],t.prototype,"m_spBox3",void 0),n([w(cc.Sprite)],t.prototype,"m_spVideoRedPoint",void 0),n([w(cc.Label)],t.prototype,"takeLabel",void 0),n([w(cc.Label)],t.prototype,"time",void 0),n([w(cc.Button)],t.prototype,"watchBtn",void 0),o=n([b],t)}(cc.Component);o.default=E,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/TaskTableData":"TaskTableData","../../common/PlayerModule":"PlayerModule","../../modules/base/GameView":"GameView","../../network/ClientNetwork":"ClientNetwork","../../network/LocalMessage":"LocalMessage","../../network/protocol/RoleProtocols":"RoleProtocols","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/ByteDanceMiniGameUtils":"ByteDanceMiniGameUtils","../../utils/GamePlatform":"GamePlatform","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils","../../utils/ResourcesManager":"ResourcesManager","../../utils/RewardedVideoAd":"RewardedVideoAd","../../utils/RewardedVideoUnitIdConst":"RewardedVideoUnitIdConst","../../utils/TimeOffSetManager":"TimeOffSetManager","../../utils/subUtils/TypeDef":"TypeDef"}],TaskGroupTableData:[function(e,t,o){"use strict";cc._RF.push(t,"5a21dVRzWRMQoBz8Ylo4CFh","TaskGroupTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.TaskGroupTableData=void 0;var i=e("../TableReader"),a=function(){function e(){this.id=0,this.boxItemID=0}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.boxItemID=e.getNumber()},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"TaskGroupTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.TaskGroupTableData=a,cc._RF.pop()},{"../TableReader":"TableReader"}],TaskTableData:[function(e,t,o){"use strict";cc._RF.push(t,"cbebc3BghZB8otNeyKla/q2","TaskTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.TaskTableData=void 0;var i=e("../TableReader"),a=function(){function e(){this.id=0,this.type=0,this.showType=0,this.clientType=0,this.groupType=0,this.jumpType=0,this.init=!1,this.cdTime=0,this.weekDay=new Array,this.activityID=0,this.conditionLevel=0,this.conditionMinScore=0,this.conditionMaxScore=0,this.conditionFinishLevel=0,this.conditionFinishMinScore=0,this.conditionFinishMaxScore=0,this.takeConGrowthFundID=0,this.nextTask=new Array,this.finishTask=new Array,this.randGroup=0,this.randWeight=0,this.finishCount=0,this.finishParam1=0,this.finishParam2=0,this.finishParam3=0,this.finishParam4=0,this.finishParam5=0,this.prizeID=0,this.extraprizeID=0,this.order=0,this.info="",this.info2="",this.info3="",this.info_ps="",this.info2_ps="",this.isShowJumpButton=0,this.functionTriggerId=0,this.ask_achieventment_icon="",this.task_achieventment_IsHidden=0,this.quality=0}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.type=e.getNumber(),this.showType=e.getNumber(),this.clientType=e.getNumber(),this.groupType=e.getNumber(),this.jumpType=e.getNumber(),this.init=e.getBoolean(),this.cdTime=e.getNumber();for(var o=e.getString(),a=new i.TableReader(o);a.getPos()<a.getLen();){var n=void 0;n=a.getNumber(),this.weekDay.push(n)}this.activityID=e.getNumber(),this.conditionLevel=e.getNumber(),this.conditionMinScore=e.getNumber(),this.conditionMaxScore=e.getNumber(),this.conditionFinishLevel=e.getNumber(),this.conditionFinishMinScore=e.getNumber(),this.conditionFinishMaxScore=e.getNumber(),this.takeConGrowthFundID=e.getNumber(),o=e.getString();for(var r=new i.TableReader(o);r.getPos()<r.getLen();)n=void 0,n=r.getNumber(),this.nextTask.push(n);o=e.getString();for(var s=new i.TableReader(o);s.getPos()<s.getLen();)n=void 0,n=s.getNumber(),this.finishTask.push(n);this.randGroup=e.getNumber(),this.randWeight=e.getNumber(),this.finishCount=e.getNumber(),this.finishParam1=e.getNumber(),this.finishParam2=e.getNumber(),this.finishParam3=e.getNumber(),this.finishParam4=e.getNumber(),this.finishParam5=e.getNumber(),this.prizeID=e.getNumber(),this.extraprizeID=e.getNumber(),this.order=e.getNumber(),this.info=e.getString(),this.info2=e.getString(),this.info3=e.getString(),this.info_ps=e.getString(),this.info2_ps=e.getString(),this.isShowJumpButton=e.getNumber(),this.functionTriggerId=e.getNumber(),this.ask_achieventment_icon=e.getString(),this.task_achieventment_IsHidden=e.getNumber(),this.quality=e.getNumber()},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"TaskTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.TaskTableData=a,cc._RF.pop()},{"../TableReader":"TableReader"}],TaskView:[function(e,t,o){"use strict";cc._RF.push(t,"b1696HqNpxPVLwUno4tuz2W","TaskView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/Decorators"),s=e("../../modules/base/BaseView"),c=e("../../common/PlayerModule"),l=e("../../utils/ConfigUtils"),d=e("../../network/protocol/TypeProtocols"),u=e("../../network/ClientNetwork"),h=e("../../network/LocalMessage"),p=e("../../utils/ResourcesManager"),f=e("../../network/protocol/RoleProtocols"),g=e("../../StaticData/TaskTableData"),m=e("../../utils/LogUtil"),_=e("../../modules/manager/LoadResManager"),y=e("../../network/protocol/RoleProtocols"),v=e("../../modules/base/GameView"),C=e("../../network/protocol/RoleProtocols"),S=e("../../network/protocol/RoleProtocols"),T=e("../../Global/GameGlobal"),I=e("./TaskDayView"),N=e("../../utils/RewardedVideoUnitIdConst"),b=e("../../utils/GameTools"),w=e("../../utils/TimeOffSetManager"),E=cc._decorator,P=E.ccclass,R=E.property,L=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.m_spDayRedPoint=null,t.m_spAchievementRedPoint=null,t.m_NodeContent=null,t.m_nCurSelectType=d.TASK_GROUP_TYPE.TASK_GROUP_TYPE_RAND,t.m_nodeDayTask=null,t.m_nodeAchTask=null,t}var o;return a(t,e),o=t,t.path=function(){return"ui/task/taskPrefabs/taskLayer"},t.prototype.onLoad=function(){u.ClientNetwork.getInstance().listenProtocol(f.ROLE_CLIENT_ENUM.P_Role_ReplaceRandTask,function(e){e.resetPos();var t=new S.S_Role_ReplaceRandTask;if(t.read(e)){if(2==t.errorcode)return void T.G.StringManager.PopStringOnce(T.G.StringManager.getString("TASK_REFRESH_TIMES_NOTENOUGH"))}else cc.log("\u8bfb\u53d6\u5931\u8d25")},this),u.ClientNetwork.getInstance().listenProtocol(f.ROLE_CLIENT_ENUM.P_Role_TakeTask,function(e){e.resetPos();var t=new y.S_Role_TakeTask;if(t.read(e)){if(0!=t.errorcode)return void T.G.StringManager.PopString("S_Role_TakeTask Error "+t.errorcode);var o=v.default.getViewByName("ReceiveRewardView");o&&o.view&&o.view.closeView(),v.default.addPopView("BaseCtrl","AcquirePopupView","AcquirePopupView",{items:t.prize})}else cc.log("\u8bfb\u53d6\u5931\u8d25")},this),u.ClientNetwork.getInstance().listenProtocol(f.ROLE_CLIENT_ENUM.P_Role_TakeTaskBox,function(e){var t=this;e.resetPos();var o=new C.S_Role_TakeTaskBox;if(o.read(e)){if(0!=o.errorcode)return void T.G.StringManager.PopString("\u9886\u53d6\u4efb\u52a1\u5b9d\u7bb1\u5931\u8d25 Error "+o.errorcode);var i=v.default.getViewByName("MainSceneView");i&&i.view&&i.view.onClientTaskAddAdvert(N.RewardedVideoClientIdConst.Task_Free_Box);var a=l.default.getInstance().getResConfig(20001);I.default.getNextBoxId()<=3&&b.default.storageData(I.default.getTakeTimeKey(),w.TimeOffSetManager.getServerUTCSecond()),p.default.loadSpine(a.animation,function(e){e.parent=t.node,e.getComponent(sp.Skeleton).setAnimation(0,"attack",!1),e.getComponent(sp.Skeleton).setCompleteListener(function(t){"attack"===(t.animation?t.animation.name:"")&&(e.active=!1,u.ClientNetwork.getInstance().pushLocalMessage(h.LOCAL_MESSAGE.LocalMsg_RefreshTaskBox),v.default.addPopView("BaseCtrl","AcquirePopupView","AcquirePopupView",{items:o.prize}))})})}else T.G.StringManager.PopString("\u9886\u53d6\u4efb\u52a1\u5b9d\u7bb1\u5931\u8d25 Error ")},this),this.refreshData(this.m_nCurSelectType)},t.prototype.start=function(){this.initTopView()},t.prototype.initTopView=function(){var e=this;_.default.loadPrefab("ui/CommonPrefab/TopView").then(function(t){t.parent=e.node,t.getComponent("TopView").bindExitEvent(function(){e.closeView()})}).catch(function(e){m.default.info(e)})},t.prototype.onDestroy=function(){},t.prototype.onClose=function(){u.ClientNetwork.getInstance().removeMessageTarget(this),this.closeView()},t.prototype.onClickDayTab=function(){this.m_nCurSelectType!=d.TASK_GROUP_TYPE.TASK_GROUP_TYPE_RAND&&this.refreshData(d.TASK_GROUP_TYPE.TASK_GROUP_TYPE_RAND)},t.prototype.onClickAchievementTab=function(){this.m_nCurSelectType!=d.TASK_GROUP_TYPE.TASK_GROUP_TYPE_COMMON&&this.refreshData(d.TASK_GROUP_TYPE.TASK_GROUP_TYPE_COMMON)},t.prototype.refreshData=function(e){var t=this;if(this.m_nCurSelectType=e,null!=t.m_nodeDayTask&&(t.m_nodeDayTask.node.active=!1),null!=t.m_nodeAchTask&&(t.m_nodeAchTask.node.active=!1),e==d.TASK_GROUP_TYPE.TASK_GROUP_TYPE_RAND){if(this.m_spDayRedPoint.node.active=!1,o.showAchievementRedPoint()&&(this.m_spAchievementRedPoint.node.active=!0),t.m_nodeDayTask)return t.m_nodeDayTask.node.active=!0,void t.m_nodeDayTask.refresh();p.default.loadPrefab("ui/task/taskPrefabs/taskDayLayer",this.m_NodeContent,function(e){t.m_nodeDayTask=e.getComponent("TaskDayView"),t.m_nodeDayTask.refresh()})}else{if(this.m_spAchievementRedPoint.node.active=!1,o.showDayRedPoint()&&(this.m_spDayRedPoint.node.active=!0),t.m_nodeAchTask)return t.m_nodeAchTask.node.active=!0,void t.m_nodeAchTask.refresh();p.default.loadPrefab("ui/task/taskPrefabs/taskAchievementLayer",this.m_NodeContent,function(e){t.m_nodeAchTask=e.getComponent("TaskAchievementView"),t.m_nodeAchTask.refresh()})}},t.showRedPoints=function(){return!(!o.showDayRedPoint()&&!o.showAchievementRedPoint())},t.showDayBoxRedPoint=function(){return!c.default.getRoleTaskData().extra.taskgroup.get(o.m_nCurBoxGroupType)||c.default.getRoleTaskData().extra.taskgroup.get(o.m_nCurBoxGroupType).boxs.size<3&&I.default.getTakeleftTime()<=0},t.showDayRedPoint=function(){if(1==o.showDayBoxRedPoint())return!0;var e=0;return c.default.getRoleTaskData().extra.randTask.forEach(function(t){var o=g.TaskTableData.getById(t.taskID),i=c.default.getRoleTaskData().tasks.get(t.taskID);o&&i&&i.taskState!=d.TASK_STATE.TASK_STATE_FINISH&&i.taskCount>=o.finishCount&&e++}),e>0},t.showAchTabRedPoint=function(e){var t=0;return c.default.getRoleTaskData().tasks.forEach(function(o){var i=g.TaskTableData.getById(o.taskID);if(i&&i.groupType==d.TASK_GROUP_TYPE.TASK_GROUP_TYPE_COMMON&&i.showType==d.TASK_SHOW_TYPE.TASK_SHOW_TYPE_ACHIEVEMENT&&i.clientType==e&&o.taskState==d.TASK_STATE.TASK_STATE_EXECUTING)if(i.type==d.TASK_TYPE.TASK_TEYP_CONDITION_ITEMNUMBYTYPE){var a=c.default.getRoleBagItems(),n=0;a.forEach(function(e){if(e){var t=l.default.getInstance().getItemByID(e.itemId);if(t&&t.type==i.finishParam1){var o=!1;n+=1,i.finishParam4>0?c.default.getHeroCarData()[e.itemId].heroLevel>=i.finishParam4&&(o=!0):i.finishParam2>0?t.quality==i.finishParam2&&(o=!0):o=!0,0==o&&(n-=1)}}}),5==i.finishParam1&&(n-=1),n>=i.finishCount&&(t=1)}else i.type==d.TASK_TYPE.TASK_TYPE_CONDITION_MAXCUPSCOUNT?c.default.getRoleAttrValByKey(d.ROLE_ATTR_VALUES.ROLE_ATTR_MAX_SCORE)/i.finishCount>=1&&(t+=1):(e==d.TASK_CLIENT_TYPE.TASK_CLIENT_TYPE_ACHIEVEMENT_TOTAL&&c.default.getItemCountByBag(1005)>=i.finishCount||o.taskCount>=i.finishCount)&&t++}),t>0},t.showAchievementRedPoint=function(){return 1==o.showAchTabRedPoint(d.TASK_CLIENT_TYPE.TASK_CLIENT_TYPE_ACHIEVEMENT_PVP)||1==o.showAchTabRedPoint(d.TASK_CLIENT_TYPE.TASK_CLIENT_TYPE_ACHIEVEMENT_COOP)||1==o.showAchTabRedPoint(d.TASK_CLIENT_TYPE.TASK_CLIENT_TYPE_ACHIEVEMENT_HERO)||1==o.showAchTabRedPoint(d.TASK_CLIENT_TYPE.TASK_CLIENT_TYPE_ACHIEVEMENT_OTHER)||1==o.showAchTabRedPoint(d.TASK_CLIENT_TYPE.TASK_CLIENT_TYPE_ACHIEVEMENT_TOTAL)},t.m_nCurBoxGroupType=3,n([R(cc.Sprite)],t.prototype,"m_spDayRedPoint",void 0),n([R(cc.Sprite)],t.prototype,"m_spAchievementRedPoint",void 0),n([R(cc.Node)],t.prototype,"m_NodeContent",void 0),o=n([r.Register_Class,P],t)}(s.default);o.default=L,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/TaskTableData":"TaskTableData","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/base/GameView":"GameView","../../modules/manager/LoadResManager":"LoadResManager","../../network/ClientNetwork":"ClientNetwork","../../network/LocalMessage":"LocalMessage","../../network/protocol/RoleProtocols":"RoleProtocols","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/ConfigUtils":"ConfigUtils","../../utils/GameTools":"GameTools","../../utils/LogUtil":"LogUtil","../../utils/ResourcesManager":"ResourcesManager","../../utils/RewardedVideoUnitIdConst":"RewardedVideoUnitIdConst","../../utils/TimeOffSetManager":"TimeOffSetManager","./TaskDayView":"TaskDayView"}],TeamChatPanel:[function(e,t,o){"use strict";cc._RF.push(t,"f5d55jJTZJCQ7xs03H4w2aH","TeamChatPanel");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/cores/UISuperLayout"),s=e("./ChatItem"),c=cc._decorator,l=c.ccclass,d=c.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.layout=null,t.datas=[],t}return a(t,e),t.prototype.onLoad=function(){this.layout.total(this.datas.length)},t.prototype.onRefreshEvent=function(e,t){var o=this.datas[t];e.getComponent(s.default).show(o)},t.prototype.addMessage=function(e){var t=this;this.datas.push(e),this.layout.total(this.datas.length),setTimeout(function(){cc.isValid(t)&&t.layout.scrollToFooter(.1)},100)},n([d(r.default)],t.prototype,"layout",void 0),n([l],t)}(cc.Component);o.default=u,cc._RF.pop()},{"../../modules/cores/UISuperLayout":"UISuperLayout","./ChatItem":"ChatItem"}],TimeOffSetManager:[function(e,t,o){"use strict";cc._RF.push(t,"de090+VQ9VHWLa6sxSmlBUA","TimeOffSetManager"),Object.defineProperty(o,"__esModule",{value:!0}),o.TimeOffSetManager=void 0;var i=e("../Global/GameGlobal"),a=function(){function e(){}return e.ProofTime=function(e){if(0==this.s_ServerClientTimeOffset)this.s_ServerClientTimeOffset=e-this.utcSecond();else{var t=e-this.utcSecond();this.s_ServerClientTimeOffset=this.s_ServerClientTimeOffset>t?this.s_ServerClientTimeOffset:t}},e.GetOffset=function(){return this.s_ServerClientTimeOffset},e.getServerUTCSecond=function(){return Math.floor(this.utcSecond()+this.GetOffset())},e.getWeekday=function(){var e=this.getServerUTCSecond(),t=new Date;return t.setTime(1e3*e),t.getDay()},e.getHour=function(){var e=this.getServerUTCSecond(),t=new Date;return t.setTime(1e3*e),t.getHours()},e.getMin=function(){var e=this.getServerUTCSecond(),t=new Date;return t.setTime(1e3*e),t.getMinutes()},e.getSecond=function(){var e=this.getServerUTCSecond(),t=new Date;return t.setTime(1e3*e),t.getSeconds()},e.getyDateStr=function(){var e=this.getServerUTCSecond(),t=new Date;return t.setTime(1e3*e),t.toDateString()},e.getSpanDays=function(e,t){var o=new Date;o.setTime(1e3*e),o.setHours(0,0,0,0);var i=o.getTime()/1e3,a=new Date;a.setTime(1e3*t),a.setHours(0,0,0,0);var n=a.getTime()/1e3;return Math.floor((i-n)/86400)},e.utcSecond=function(){return(new Date).getTime()/1e3},e.utcTime=function(){return(new Date).getTime()},e.getLeftSecondByUTC=function(e){var t=e-this.getServerUTCSecond();return t<0&&(t=0),t},e.getOpenServerDays=function(){},e.formatTime=function(e){e=Math.floor(e);var t=new Date;return e&&(10==e.toString().length?t.setTime(1e3*e):13==e.toString().length?t.setTime(e):cc.error("!!! WRONG TIME")),t},e.GetCrossZhengBaOpenTimeDays=function(e,t){var o=-1,i=new Date;i.setTime(1e3*e),i.setHours(0,0,0,0);var a=i.getTime()/1e3,n=new Date;n.setTime(1e3*t),n.setHours(0,0,0,0);var r=n.getTime()/1e3;if(i&&(o=i.getDay()),-1==o)return 0;var s=0;o>=1&&o<=5&&(s=8-o),6==o?s=9:0==o&&(s=8);var c=(r-a)/86400;return s>c?s-c:0},e.GetCrossPeakTimeDays=function(e,t){var o=-1,i=new Date;i.setTime(1e3*e),i.setHours(0,0,0,0);var a=i.getTime()/1e3,n=new Date;n.setTime(1e3*t),n.setHours(0,0,0,0);var r=n.getTime()/1e3;if(i&&(o=i.getDay()),-1==o)return 0;var s,c=(r-a)/86400;return(s=0==o?20:6-o+14)>c?s-c:0},e.getKaiFuQingDianTime=function(t,o,i){if(0==t)return{jieShu:o,startTime:i};var a,n,r=e.formatTime(t);r.setHours(0,0,0,0),n=r.getTime()/1e3;var s=e.getServerUTCSecond();return(a=e.getSpanDays(s,r.getTime()/1e3))<0?{jieShu:o,startTime:i}:{jieShu:o=Math.floor(a/7)+1,startTime:i=n+604800*(o-1)}},e.formatNumber=function(e){return e>=10?e+"":"0"+e},e.getTimeStr=function(e,t,o){var i="";return i=this.formatNumber(e)+":"+this.formatNumber(t),"number"==typeof o&&(i=i+":"+this.formatNumber(o)),i},e.getTimeStr2=function(e,t){return this.formatNumber(e)+":"+this.formatNumber(t)},e.getSecondStr=function(e){var t=Math.floor(e/3600),o=Math.floor(e%3600/60),i=e%3600%60;return this.getTimeStr(t,o,i)},e.getSecondStr2=function(e){Math.floor(e/3600);var t=Math.floor(e%3600/60),o=e%3600%60;return this.getTimeStr2(t,o)},e.getSecondStr3=function(e){var t=Math.floor(e/3600),o=Math.floor(e%3600/60),i=e%3600%60;return t>0?this.getTimeStr(t,o,i):this.getTimeStr2(o,i)},e.formaterWithOutSecond=function(e){var t="",o=e/86400,a=e/3600%24,n=e/60%60;return o>0&&(t+=i.G.StringManager.formatStr(i.G.StringManager.getWorldString("timeUtils_days"),[o])),(o>0||a>0)&&(t+=i.G.StringManager.formatStr(i.G.StringManager.getWorldString("timeUtils_hours"),[a])),(o>0||a>0||n>0)&&(t+=i.G.StringManager.formatStr(i.G.StringManager.getWorldString("timeUtils_minutes"),[n])),t},e.formaterWithOutSecond2=function(e){var t="",o=Math.floor(e/86400),a=Math.floor(e/3600%24),n=Math.floor(e/60%60),r=e%60;return e>=86400?(t+=o+i.G.StringManager.getWorldString("timeUtils_days"),t+=a+i.G.StringManager.getWorldString("timeUtils_hours")):(e>=3600?(t+=a+i.G.StringManager.getWorldString("timeUtils_hours"),t+=n+i.G.StringManager.getWorldString("timeUtils_minutes")):e>=60?(t+=n+i.G.StringManager.getWorldString("timeUtils_minutes"),t+=r+"\u79d2"):t+=r+"\u79d2",t)},e.formaterOnlineTime=function(e,t){var o=e/86400,a=e/3600%24,n=e/60%60,r="";return o>=1?(r=i.G.StringManager.formatStr(i.G.StringManager.getWorldString("timeUtils_daysAgo"),[o]),o>t&&(r=i.G.StringManager.getWorldString("outLine_Seven")),r):(a<=24&&a>0?r=i.G.StringManager.formatStr(i.G.StringManager.getWorldString("timeUtils_hoursAgo"),[a]):n>0?r=i.G.StringManager.formatStr(i.G.StringManager.getWorldString("timeUtils_minutesAgo"),[n]):n<=0&&(r=i.G.StringManager.getWorldString("timeUtils_just")),r)},e.getMilisecond=function(){return(new Date).getTime()},e.getFormatDate=function(){function e(e){return e>=0&&e<=9?"0"+e:e}var t=new Date;return t.getFullYear()+"-"+e(t.getMonth()+1)+"-"+e(t.getDate())+" "+e(t.getHours())+":"+e(t.getMinutes())+":"+e(t.getSeconds())},e.s_ServerClientTimeOffset=0,e}();o.TimeOffSetManager=a,cc._RF.pop()},{"../Global/GameGlobal":"GameGlobal"}],TipPopWindowView:[function(e,t,o){"use strict";cc._RF.push(t,"76b51QrPAxJEow2fgd7SIIN","TipPopWindowView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../Global/GameGlobal"),s=e("../modules/base/BaseView"),c=e("../modules/base/Decorators"),l=cc._decorator,d=l.ccclass,u=l.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.contentLabel=null,t.buyCrownNode=null,t.contentRichLabel=null,t.GotoCb=null,t.ConfirmCb=null,t.cancelCb=null,t}return a(t,e),t.path=function(){return"ui/CommonPrefab/TipPopWindow"},t.prototype.init=function(e){e.content&&(e.isRichText?this.contentRichLabel.string=e.content:this.contentLabel.string=e.content),e.gotoCb&&(this.GotoCb=e.gotoCb,this.node.getChildByName("goto").active=!0),e.confirmCb&&(this.ConfirmCb=e.confirmCb,this.node.getChildByName("btnconfirm").active=!0),e.onlyConfirmBtn&&(this.node.getChildByName("close").active=!1,this.node.getChildByName("quit").active=!1,this.node.getChildByName("btnconfirm").active=!0,this.node.getChildByName("btnconfirm").x=0),e.view&&"BattlePassView"==e.view&&(this.buyCrownNode.active=!0,this.buyCrownNode.getComponent(cc.RichText).string=r.G.StringManager.getString("BATTLE_PASS_BUY_TIP")),e.cancelCb&&(this.cancelCb=e.cancelCb)},t.prototype.gotoCallBack=function(){this.GotoCb&&(this.GotoCb(),e.prototype.closeView.call(this))},t.prototype.onConfirmCallBack=function(){this.ConfirmCb&&(this.ConfirmCb(),e.prototype.closeView.call(this))},t.prototype.closeView=function(){this.cancelCb&&this.cancelCb(),e.prototype.closeView.call(this)},n([u(cc.Label)],t.prototype,"contentLabel",void 0),n([u(cc.Node)],t.prototype,"buyCrownNode",void 0),n([u(cc.RichText)],t.prototype,"contentRichLabel",void 0),n([c.Register_Class,d],t)}(s.default);o.default=h,cc._RF.pop()},{"../Global/GameGlobal":"GameGlobal","../modules/base/BaseView":"BaseView","../modules/base/Decorators":"Decorators"}],Tools:[function(e,t,o){"use strict";cc._RF.push(t,"4dff6xaZaVMNp+vfdaZi9sB","Tools"),o.__esModule=!0,o.default=void 0;var i=r(e("../combat/CombatManager")),a=e("../utils/GameUtils"),n=r(e("./Debug"));function r(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(){this.curId=1e8}e.getInstance=function(){return this.Instance||(this.Instance=new e),this.Instance};var t=e.prototype;return t.resetId=function(){this.curId=1e8},t.genId=function(){return this.curId=this.curId+1,this.curId},e.rand=function(e,t){return Math.floor(Math.random()*(t-e))+e+1},e.playEffect=function(e,t,o,i){var r=this;0!=(0,a.getBattleEffectOnOff)()&&cc.resources.load(e,sp.SkeletonData,function(a,s){a?n.default.error("load err errff"+e):r.onLoadEffect(s,t,o,i)})},e.onLoadEffect=function(e,t,o,a){if(a||(a=1),t&&t.isValid){var n=i.default.getInstance().getController().getEffectSpNode();n.parent=t,n.x=o.x,n.y=o.y,n.scaleX=a,n.scaleY=a;var r=n.getComponent(sp.Skeleton);r&&(r.skeletonData=e,r.setSkin("default"),r.setAnimation(0,"idle",!1))}},e.playAudioEffect=function(t){if(t&&""!=t)return!this.checkGameMuteVolume()&&void cc.resources.load(t,cc.AudioClip,function(t,o){t?e.error("load audio effect failed, msg = "+t.message):cc.audioEngine.playEffect(o)})},e.playAudioMusic=function(t){if(this.checkGameMuteVolume())return!1;cc.resources.load(t,cc.AudioClip,function(t,o){t?e.error("load audio music failed, msg = "+t.message):cc.audioEngine.playMusic(o,!0)})},e.playBtnAudioMusic=function(t,o,i){if(this.checkGameMuteVolume())return!1;cc.resources.load(t,cc.AudioClip,function(t,a){t?e.error("load audio music failed, msg = "+t.message):cc.audioEngine.play(a,o,i)})},e.initGameVolume=function(){"1"==(0,a.getLocalData)("GameVolume")?(0==cc.audioEngine.isMusicPlaying()&&this.playAudioMusic("music/mainuibg"),cc.audioEngine.setMusicVolume(1)):cc.audioEngine.setMusicVolume(0)},e.checkGameMuteVolume=function(){return"0"==(0,a.getLocalData)("GameVolume")},e.arrOverAdd=function(e){if(!e||e.length<=0)return[];for(var t=[],o=0;o<e.length;o++)t[o]=0==o?parseInt(e[o]):t[o-1]+parseInt(e[o]);return t},e.getArrIndex=function(e,t,o){var i=0;if(e>=t[t.length-1])return o[i=t.length-1];for(var a=0;a<o.length;a++){if(e<=t[a]){i=a;break}if(e>t[a]&&e<=t[a+1]){i=a+1;break}}return o[i]},e}();o.default=s,s.Instance=null,t.exports=o.default,cc._RF.pop()},{"../combat/CombatManager":"CombatManager","../utils/GameUtils":"GameUtils","./Debug":"Debug"}],TopView:[function(e,t,o){"use strict";cc._RF.push(t,"194b5tl7clBD4mzL544aO75","TopView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../common/PlayerModule"),s=e("../common/EventConst"),c=e("../modules/manager/EventManager"),l=e("../utils/GameTools"),d=e("../modules/base/GameView"),u=e("../utils/GameUtils"),h=e("../common/CommandValue"),p=e("../Global/GameGlobal"),f=e("../utils/GamePlatform"),g=cc._decorator,m=g.ccclass,_=g.property,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.exitBtn=null,t.goldDiamondNode=null,t._cb=null,t}return a(t,e),t.prototype.start=function(){var e=this;f.GamePlatform.isKuaishouMiniGame()&&null!=this.exitBtn&&cc.sys.os==cc.sys.OS_ANDROID&&(this.exitBtn.getComponent(cc.Widget).left=100),this.node.width=cc.winSize.width,this.node.height=cc.winSize.height,this.initGoldDiamond(),c.default.Instance.on(s.default.SyncGoldChange,function(){e.initGoldDiamond()},this),c.default.Instance.on(s.default.SyncDiamondChange,function(){e.initGoldDiamond()},this),c.default.Instance.on(s.default.SyncDemonFruitChangeEvent,function(){e.onRefreshDemonFruitNum()},this),l.default.registerTouchEvent(this.goldDiamondNode.getChildByName("diamondbg"),function(){var e=d.default.getViewByName("ShopMainView");e?0==e.view.node.active&&(e.view.init({skipType:"Diamond"}),e.view.node.active=!0,e.view.node.zIndex=100,cc.find("Canvas").getChildByName("UI_Mask_"+e.view.node.name).active=!0):d.default.addPopView("ShopMainCtrl","ShopMainView","ShopMainView",{skipType:"Diamond"})}),l.default.registerTouchEvent(this.goldDiamondNode.getChildByName("goldbg"),function(){var e=d.default.getViewByName("ShopMainView");e?0==e.view.node.active&&(e.view.init({skipType:"Gold"}),e.view.node.active=!0,e.view.node.zIndex=100,cc.find("Canvas").getChildByName("UI_Mask_"+e.view.node.name).active=!0):d.default.addPopView("ShopMainCtrl","ShopMainView","ShopMainView",{skipType:"Gold"})}),l.default.registerTouchEvent(this.node.getChildByName("voucherbg"),function(){var e=d.default.getViewByName("ShopMainView");e?0==e.view.node.active&&(e.view.init({skipType:"Voucher"}),e.view.node.active=!0,e.view.node.zIndex=100,cc.find("Canvas").getChildByName("UI_Mask_"+e.view.node.name).active=!0):d.default.addPopView("ShopMainCtrl","ShopMainView","ShopMainView",{skipType:"Voucher"})}),l.default.registerTouchEvent(this.goldDiamondNode.getChildByName("hpbg"),function(){var t=e.goldDiamondNode.getChildByName("hpPopup"),o=t.active;t.active=!o}),l.default.registerTouchEvent(this.goldDiamondNode.getChildByName("emoguobg"),function(){var e=d.default.getViewByName("NavigationMainView");if(e&&e.view);else if(1==r.default.checkModulerOnOffState(h.ModulerViewOnOff.NavigationView)){var t=d.default.getViewByName("HeroCardInfoView");t&&t.view&&t.view.closeView();var o=d.default.getViewByName("HeroCardsMainView");o&&o.view&&o.view.closeView(),d.default.addPopView("BaseCtrl","NavigationMainView","NavigationMainView")}else p.G.StringManager.PopString("\u5927\u6d77\u822a\u6d3b\u52a8\u672a\u5f00\u542f")})},t.prototype.bindExitEvent=function(e){this._cb=e},t.prototype.exitBtnCallBack=function(){this._cb&&this._cb()},t.prototype.initGoldDiamond=function(){this.goldDiamondNode.getChildByName("goldbg").getChildByName("gold_number").getComponent(cc.Label).string=r.default.goldNum,this.goldDiamondNode.getChildByName("diamondbg").getChildByName("diamond_number").getComponent(cc.Label).string=r.default.diamondNum,this.onRefreshDemonFruitNum()},t.prototype.initVoucher=function(){if(1==u.checkOpenVoucher()){var e=this.node.getChildByName("voucherbg");e&&(e.active||(e.active=!0),e.getChildByName("voucher_number").getComponent(cc.Label).string=(r.default.voucherNum/100).toString())}},t.prototype.hideVoucher=function(){var e=this.node.getChildByName("voucherbg");e&&(e.active=!1)},t.prototype.onRefreshDemonFruitNum=function(){this.goldDiamondNode.getChildByName("emoguobg").getChildByName("number").getComponent(cc.Label).string=r.default.getItemCountByBag(1012)},t.prototype.onDestroy=function(){c.default.Instance.off(this)},n([_(cc.Button)],t.prototype,"exitBtn",void 0),n([_(cc.Node)],t.prototype,"goldDiamondNode",void 0),n([m],t)}(cc.Component);o.default=y,cc._RF.pop()},{"../Global/GameGlobal":"GameGlobal","../common/CommandValue":"CommandValue","../common/EventConst":"EventConst","../common/PlayerModule":"PlayerModule","../modules/base/GameView":"GameView","../modules/manager/EventManager":"EventManager","../utils/GamePlatform":"GamePlatform","../utils/GameTools":"GameTools","../utils/GameUtils":"GameUtils"}],TotalWatchADBoxInfoClientTableData:[function(e,t,o){"use strict";cc._RF.push(t,"26844wYBv5DF76fgSakwpjV","TotalWatchADBoxInfoClientTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.TotalWatchADBoxInfoClientTableData=void 0;var i=e("../TableReader"),a=function(){function e(){this.id=0,this.admax=0,this.info=""}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.admax=e.getNumber(),this.info=e.getString()},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"TotalWatchADBoxInfoClientTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.TotalWatchADBoxInfoClientTableData=a,cc._RF.pop()},{"../TableReader":"TableReader"}],TotalWatchADBoxTableData:[function(e,t,o){"use strict";cc._RF.push(t,"22c8e11ojZJ27jIHJzt9gnm","TotalWatchADBoxTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.TotalWatchADBoxTableData=void 0;var i=e("../TableReader"),a=function(){function e(){this.index=0,this.day=0,this.time=0,this.prizeID=0,this.extraPrizeId=0,this.showPicture="",this.scale=0,this.tipsPicture="",this.dayicon="",this.strScope=new Array}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.index=e.getNumber(),this.day=e.getNumber(),this.time=e.getNumber(),this.prizeID=e.getNumber(),this.extraPrizeId=e.getNumber(),this.showPicture=e.getString(),this.scale=e.getNumber(),this.tipsPicture=e.getString(),this.dayicon=e.getString();for(var o=e.getString(),a=new i.TableReader(o);a.getPos()<a.getLen();){var n;n=a.getString(),this.strScope.push(n)}},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"TotalWatchADBoxTableData"},e.prototype.isAutoId=function(){return!0},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.TotalWatchADBoxTableData=a,cc._RF.pop()},{"../TableReader":"TableReader"}],TypeDef:[function(e,t,o){"use strict";cc._RF.push(t,"a26c5CGl3JD2JhNY5AZvqrr","TypeDef"),Object.defineProperty(o,"__esModule",{value:!0}),o.GlobalVar=o.ExchangeItems_FlyType=o.FriendsSortType=void 0,function(e){e[e.ByNormal=0]="ByNormal",e[e.ByRelation=1]="ByRelation",e[e.ByBattleAbility=2]="ByBattleAbility",e[e.ByRoleLevel=3]="ByRoleLevel",e[e.ByOffLineTime=4]="ByOffLineTime"}(o.FriendsSortType||(o.FriendsSortType={})),function(e){e[e.ExchangeItems_Fly=0]="ExchangeItems_Fly",e[e.ExchangeItems_NoFly=1]="ExchangeItems_NoFly"}(o.ExchangeItems_FlyType||(o.ExchangeItems_FlyType={}));var i=function(){function e(){}return e.getAccountName=function(){return e.m_pStrAccount},e.setAccountName=function(t){e.m_pStrAccount=t},e.getPassword=function(){return e.m_pStrPassword},e.setPassword=function(t){e.m_pStrPassword=t},e.getRoleId=function(){return e.m_roleId},e.setRoleId=function(t){e.m_roleId=t},e.getZoneId=function(){return e.m_zoneId},e.setZoneId=function(t){e.m_zoneId=t},e.getPlatform=function(){return e.m_platform},e.setPlatform=function(t){e.m_platform=t},e.getServerURL=function(){return e.m_ServerURL},e.setServerURL=function(t){e.m_ServerURL=t},e.getServerGroup=function(){return e.m_ServerGroup},e.setServerGroup=function(t){e.m_ServerGroup=t},e.s_currentbaoxiangStar=0,e.m_pStrAccount="",e.m_pStrPassword="",e.m_roleId=0,e.m_zoneId=0,e.m_platform=0,e.m_ServerURL="",e.m_ServerGroup=0,e}();o.GlobalVar=i,cc._RF.pop()},{}],TypeProtocols:[function(e,t,o){"use strict";cc._RF.push(t,"e4955SRi/VFObwGa8RP5ybz","TypeProtocols"),e("DataViewRW"),e("ObjCollection"),e("long"),function(e){e[e.RECHARGE_ORDER_STATE_CREATE=0]="RECHARGE_ORDER_STATE_CREATE",e[e.RECHARGE_ORDER_STATE_SUCCESS=1]="RECHARGE_ORDER_STATE_SUCCESS",e[e.RECHARGE_ORDER_STATE_RECHARGEING=2]="RECHARGE_ORDER_STATE_RECHARGEING",e[e.RECHARGE_ORDER_STATE_GMRECHARGE=3]="RECHARGE_ORDER_STATE_GMRECHARGE"}(o.RECHARGE_ORDER_STATE||(o.RECHARGE_ORDER_STATE={})),function(e){e[e.TYPE_ITEM_MATERIAL=1]="TYPE_ITEM_MATERIAL",e[e.TYPE_ITEM_HERO=2]="TYPE_ITEM_HERO",e[e.TYPE_ITEM_BOX=3]="TYPE_ITEM_BOX",e[e.TYPE_ITEM_HEAD=4]="TYPE_ITEM_HEAD",e[e.TYPE_ITEM_HEADFRAME=5]="TYPE_ITEM_HEADFRAME",e[e.TYPE_ITEM_EXPRESSION=6]="TYPE_ITEM_EXPRESSION",e[e.TYPE_ITEM_MAPSKIN=7]="TYPE_ITEM_MAPSKIN",e[e.TYPE_ITEM_CHOOSEBOX=8]="TYPE_ITEM_CHOOSEBOX",e[e.TYPE_ITEM_RUNE=9]="TYPE_ITEM_RUNE",e[e.TYPE_ITEM_PET=10]="TYPE_ITEM_PET",e[e.TYPE_ITEM_CARSKIN=11]="TYPE_ITEM_CARSKIN",e[e.TYPE_ITEM_HEROSKIN=12]="TYPE_ITEM_HEROSKIN"}(o.TYPE_ITEM||(o.TYPE_ITEM={})),function(e){e[e.TYPE_ITEM_EXPIRY_CUM=0]="TYPE_ITEM_EXPIRY_CUM",e[e.TYPE_ITEM_EXPIRY_REPLACE=1]="TYPE_ITEM_EXPIRY_REPLACE",e[e.TYPE_ITEM_EXPIRY_NOREPLACE=2]="TYPE_ITEM_EXPIRY_NOREPLACE"}(o.TYPE_ITEM_EXPIRY||(o.TYPE_ITEM_EXPIRY={})),function(e){e[e.TYPE_ROLE_SEX_MAN=1]="TYPE_ROLE_SEX_MAN",e[e.TYPE_ROLE_SEX_WOMAN=2]="TYPE_ROLE_SEX_WOMAN"}(o.TYPE_ROLE_SEX||(o.TYPE_ROLE_SEX={})),function(e){e[e.TYPE_DROP_ITEM=1]="TYPE_DROP_ITEM",e[e.TYPE_DROP_SCORE=2]="TYPE_DROP_SCORE",e[e.TYPE_DROP_THEMEBOXEXP=3]="TYPE_DROP_THEMEBOXEXP",e[e.TYPE_DROP_EXP=4]="TYPE_DROP_EXP",e[e.TYPE_DROP_TIMELOCKBOX=5]="TYPE_DROP_TIMELOCKBOX",e[e.TYPE_DROP_SOCIATYMEDAL=6]="TYPE_DROP_SOCIATYMEDAL",e[e.TYPE_DROP_ANNIVERSARY_SCORE=7]="TYPE_DROP_ANNIVERSARY_SCORE"}(o.TYPE_DROP||(o.TYPE_DROP={})),function(e){e[e.TYPE_DROP_PROBABILITY_ALONE=1]="TYPE_DROP_PROBABILITY_ALONE",e[e.TYPE_DROP_PROBABILITY_TOTAL=2]="TYPE_DROP_PROBABILITY_TOTAL"}(o.TYPE_DROP_PROBABILITY||(o.TYPE_DROP_PROBABILITY={})),function(e){e[e.TYPE_DROP_REPLENISH_NULL=0]="TYPE_DROP_REPLENISH_NULL",e[e.TYPE_DROP_REPLENISH_LAST=1]="TYPE_DROP_REPLENISH_LAST",e[e.TYPE_DROP_REPLENISH_AVERAGE=2]="TYPE_DROP_REPLENISH_AVERAGE"}(o.TYPE_DROP_REPLENISH||(o.TYPE_DROP_REPLENISH={})),function(e){e[e.TYPE_DROP_ADDITION_NULL=0]="TYPE_DROP_ADDITION_NULL",e[e.TYPE_DROP_ADDITION_SCORE=1]="TYPE_DROP_ADDITION_SCORE"}(o.TYPE_DROP_ADDITION||(o.TYPE_DROP_ADDITION={})),function(e){e[e.TYPE_RECHARGE_EXTRA_PRIVILEGE_VIP=1]="TYPE_RECHARGE_EXTRA_PRIVILEGE_VIP",e[e.TYPE_RECHARGE_EXTRA_PRIVILEGE_MONTHCARD=2]="TYPE_RECHARGE_EXTRA_PRIVILEGE_MONTHCARD",e[e.TYPE_RECHARGE_EXTRA_THEME_BOX_RECHARGE=3]="TYPE_RECHARGE_EXTRA_THEME_BOX_RECHARGE",e[e.TYPE_RECHARGE_EXTRA_FARMLAND=4]="TYPE_RECHARGE_EXTRA_FARMLAND",e[e.TYPE_RECHARGE_EXTRA_PRIVILEGE_WEEKCARD=5]="TYPE_RECHARGE_EXTRA_PRIVILEGE_WEEKCARD",e[e.TYPE_RECHARGE_EXTRA_GROWTHFUND=6]="TYPE_RECHARGE_EXTRA_GROWTHFUND",e[e.TYPE_RECHARGE_EXTRA_VOUCHER=7]="TYPE_RECHARGE_EXTRA_VOUCHER"}(o.TYPE_RECHARGE_EXTRA||(o.TYPE_RECHARGE_EXTRA={})),function(e){e[e.ROLE_ATTR_START=0]="ROLE_ATTR_START",e[e.ROLE_ATTR_SEX=1]="ROLE_ATTR_SEX",e[e.ROLE_ATTR_CREATETIME=2]="ROLE_ATTR_CREATETIME",e[e.ROLE_ATTR_LOGOUTTIME=3]="ROLE_ATTR_LOGOUTTIME",e[e.ROLE_ATTR_SERVERMAILTIME=4]="ROLE_ATTR_SERVERMAILTIME",e[e.ROLE_ATTR_DAY_REFRESH_TIME=5]="ROLE_ATTR_DAY_REFRESH_TIME",e[e.ROLE_ATTR_DAY_REFRESH_TIME_2=6]="ROLE_ATTR_DAY_REFRESH_TIME_2",e[e.ROLE_ATTR_MONTH_REFRESH_TIME=7]="ROLE_ATTR_MONTH_REFRESH_TIME",e[e.ROLE_ATTR_LOGINNUM=8]="ROLE_ATTR_LOGINNUM",e[e.ROLE_ATTR_DAY_LOGINNUM=9]="ROLE_ATTR_DAY_LOGINNUM",e[e.ROLE_ATTR_DAY_ONLINE_TIME=10]="ROLE_ATTR_DAY_ONLINE_TIME",e[e.ROLE_ATTR_INDULGE_BIRTH=11]="ROLE_ATTR_INDULGE_BIRTH",e[e.ROLE_ATTR_HEADID=12]="ROLE_ATTR_HEADID",e[e.ROLE_ATTR_HEADFRAMEID=13]="ROLE_ATTR_HEADFRAMEID",e[e.ROLE_ATTR_RECHARGENUM=14]="ROLE_ATTR_RECHARGENUM",e[e.ROLE_ATTR_MONTHRECHARGENUM=15]="ROLE_ATTR_MONTHRECHARGENUM",e[e.ROLE_ATTR_LEVEL=16]="ROLE_ATTR_LEVEL",e[e.ROLE_ATTR_EXP=17]="ROLE_ATTR_EXP",e[e.ROLE_ATTR_VIPLEVEL=18]="ROLE_ATTR_VIPLEVEL",e[e.ROLE_ATTR_VIPEXP=19]="ROLE_ATTR_VIPEXP",e[e.ROLE_ATTR_SCORE=20]="ROLE_ATTR_SCORE",e[e.ROLE_ATTR_MAX_SCORE=21]="ROLE_ATTR_MAX_SCORE",e[e.ROLE_ATTR_MAX_SEASON_SCORE=22]="ROLE_ATTR_MAX_SEASON_SCORE",e[e.ROLE_ATTR_PRIVILEGE_VIP=23]="ROLE_ATTR_PRIVILEGE_VIP",e[e.ROLE_ATTR_PRIVILEGE_MONTHCARDTIME=24]="ROLE_ATTR_PRIVILEGE_MONTHCARDTIME",e[e.ROLE_ATTR_PRIVILEGE_MONTHCARDPRIZE=25]="ROLE_ATTR_PRIVILEGE_MONTHCARDPRIZE",e[e.ROLE_ATTR_MODIFYNAMENUM=26]="ROLE_ATTR_MODIFYNAMENUM",e[e.ROLE_ATTR_GUIDE=27]="ROLE_ATTR_GUIDE",e[e.ROLE_ATTR_ISURLHEAD=28]="ROLE_ATTR_ISURLHEAD",e[e.ROLE_ATTR_MAPSKINID=29]="ROLE_ATTR_MAPSKINID",e[e.ROLE_ATTR_ONLINE_DAYNUM=30]="ROLE_ATTR_ONLINE_DAYNUM",e[e.ROLE_ATTR_PRIVILEGE_WEEKCARDTIME=31]="ROLE_ATTR_PRIVILEGE_WEEKCARDTIME",e[e.ROLE_ATTR_LOOPDROPPRIZE_INDEX=32]="ROLE_ATTR_LOOPDROPPRIZE_INDEX",e[e.ROLE_ATTR_BATTLE_PASS=33]="ROLE_ATTR_BATTLE_PASS",e[e.ROLE_ATTR_BATTLE_PASS_CURRENCY_DAY=34]="ROLE_ATTR_BATTLE_PASS_CURRENCY_DAY",e[e.ROLE_ATTR_DAYLIVETIME=35]="ROLE_ATTR_DAYLIVETIME",e[e.ROLE_ATTR_GOLDENLEAGUE_SCORE=36]="ROLE_ATTR_GOLDENLEAGUE_SCORE",e[e.ROLE_ATTR_GOLDENLEAGUE_SEASON=37]="ROLE_ATTR_GOLDENLEAGUE_SEASON",e[e.ROLE_ATTR_GAME_ONLINE_TIME=38]="ROLE_ATTR_GAME_ONLINE_TIME",e[e.ROLE_ATTR_LATE_NIGHT_FIGHT_COUNT=39]="ROLE_ATTR_LATE_NIGHT_FIGHT_COUNT",e[e.ROLE_ATTR_PETID=40]="ROLE_ATTR_PETID",e[e.ROLE_ATTR_DAY_RECHARGE_ID=41]="ROLE_ATTR_DAY_RECHARGE_ID",e[e.ROLE_ATTR_DAY_RECHARGE_TIME=42]="ROLE_ATTR_DAY_RECHARGE_TIME",e[e.ROLE_ATTR_DAY_RECHARGE_SELECTID=43]="ROLE_ATTR_DAY_RECHARGE_SELECTID",e[e.ROLE_ATTR_BATTLEPASS_SELECT=44]="ROLE_ATTR_BATTLEPASS_SELECT",e[e.ROLE_ATTR_SOCIATY_MEDAL_DAY=45]="ROLE_ATTR_SOCIATY_MEDAL_DAY",e[e.ROLE_ATTR_SOCIATY_WAR_SCORE=46]="ROLE_ATTR_SOCIATY_WAR_SCORE",e[e.ROLE_ATTR_SOCIATY_WAR_SEASON=47]="ROLE_ATTR_SOCIATY_WAR_SEASON",e[e.ROLE_ATTR_CARSKINID=48]="ROLE_ATTR_CARSKINID",e[e.ROLE_ATTR_CONTINUE_RECHARGE_DAYNUM=49]="ROLE_ATTR_CONTINUE_RECHARGE_DAYNUM",e[e.ROLE_ATTR_CONTINUE_RECHARGE_TIME=50]="ROLE_ATTR_CONTINUE_RECHARGE_TIME",e[e.ROLE_ATTR_CONTINUE_RECHARGE_GETSTATUS=51]="ROLE_ATTR_CONTINUE_RECHARGE_GETSTATUS",e[e.ROLE_ATTR_DAY_BATTLE_NUM=52]="ROLE_ATTR_DAY_BATTLE_NUM",e[e.ROLE_ATTR_DAY_LOCAL_CHAT_NUM=53]="ROLE_ATTR_DAY_LOCAL_CHAT_NUM",e[e.ROLE_ATTR_SKYCASTLE_BOX_COIN_NUM=54]="ROLE_ATTR_SKYCASTLE_BOX_COIN_NUM",e[e.ROLE_ATTR_DAY_WORLD_CHAT_NUM=55]="ROLE_ATTR_DAY_WORLD_CHAT_NUM",e[e.ROLE_ATTR_DAY_ACTIVITY_CHAT_NUM=56]="ROLE_ATTR_DAY_ACTIVITY_CHAT_NUM",e[e.ROLE_ATTR_SKYCASTLE_RECHARGE_TIME=57]="ROLE_ATTR_SKYCASTLE_RECHARGE_TIME",e[e.ROLE_ATTR_SKYCASTLE_RECHARGE_SELECTID=58]="ROLE_ATTR_SKYCASTLE_RECHARGE_SELECTID",e[e.ROLE_ATTR_BATTLEPASS_SELECT_GOLD=59]="ROLE_ATTR_BATTLEPASS_SELECT_GOLD",e[e.ROLE_ATTR_WEEK_COOPERATION=60]="ROLE_ATTR_WEEK_COOPERATION",e[e.ROLE_ATTR_DAY_WEEK_COOPERATION_CHAT_NUM=61]="ROLE_ATTR_DAY_WEEK_COOPERATION_CHAT_NUM",e[e.ROLE_ATTR_ROYALE_EQUIPID=62]="ROLE_ATTR_ROYALE_EQUIPID",e[e.ROLE_ATTR_ROYALE_BATTLEPASS=63]="ROLE_ATTR_ROYALE_BATTLEPASS",e[e.ROLE_ATTR_ROYALE_DRAW_LUCKY=64]="ROLE_ATTR_ROYALE_DRAW_LUCKY",e[e.ROLE_ATTR_ROYALE_BOX_COIN_NUM=65]="ROLE_ATTR_ROYALE_BOX_COIN_NUM",e[e.ROLE_ATTR_ANNIVERSARY_TRIAL_SCORE=66]="ROLE_ATTR_ANNIVERSARY_TRIAL_SCORE",e[e.ROLE_ATTR_ANNIVERSARY_BATTLEPASS=67]="ROLE_ATTR_ANNIVERSARY_BATTLEPASS",e[e.ROLE_ATTR_ANNIVERSARY_BOX_COIN_NUM=68]="ROLE_ATTR_ANNIVERSARY_BOX_COIN_NUM",e[e.ROLE_ATTR_ANNIVERSARY_TRIAL_MAX_SCORE=69]="ROLE_ATTR_ANNIVERSARY_TRIAL_MAX_SCORE",e[e.ROLE_ATTR_FogHidden_BOX_COIN_NUM=70]="ROLE_ATTR_FogHidden_BOX_COIN_NUM",e[e.ROLE_ATTR_FogHidden_BATTLEPASS=71]="ROLE_ATTR_FogHidden_BATTLEPASS",e[e.ROLE_ATTR_SCORE_FUND_BATTLEPASS=72]="ROLE_ATTR_SCORE_FUND_BATTLEPASS",e[e.ROLE_ATTR_MACHINARIUM_BATTLEPASS=73]="ROLE_ATTR_MACHINARIUM_BATTLEPASS",e[e.ROLE_ATTR_MACHINARIUM_BATTLEPASS_COIN_NUM=74]="ROLE_ATTR_MACHINARIUM_BATTLEPASS_COIN_NUM",e[e.ROLE_ATTR_CONTINUE_RECHARGE_GETSTATUS_2=75]="ROLE_ATTR_CONTINUE_RECHARGE_GETSTATUS_2",e[e.ROLE_ATTR_CONTINUE_RECHARGE_TIME_2=76]="ROLE_ATTR_CONTINUE_RECHARGE_TIME_2",e[e.ROLE_ATTR_CONTINUE_RECHARGE_DAYNUM_2=77]="ROLE_ATTR_CONTINUE_RECHARGE_DAYNUM_2"}(o.ROLE_ATTR_VALUES||(o.ROLE_ATTR_VALUES={})),function(e){e[e.ATTR_TYPE_MIN=1]="ATTR_TYPE_MIN",e[e.ATTR_TYPE_ATTACK=1]="ATTR_TYPE_ATTACK",e[e.ATTR_TYPE_ATTACKSPEED=2]="ATTR_TYPE_ATTACKSPEED",e[e.ATTR_TYPE_CRITRATE=3]="ATTR_TYPE_CRITRATE",e[e.ATTR_TYPE_CRITDAMAGE=4]="ATTR_TYPE_CRITDAMAGE",e[e.ATTR_TYPE_SKILLSTRENGTH_A=5]="ATTR_TYPE_SKILLSTRENGTH_A",e[e.ATTR_TYPE_SKILLSTRENGTH_B=6]="ATTR_TYPE_SKILLSTRENGTH_B",e[e.ATTR_TYPE_SKILLSTRENGTH_C=7]="ATTR_TYPE_SKILLSTRENGTH_C",e[e.ATTR_TYPE_SKILLSTRENGTH_D=8]="ATTR_TYPE_SKILLSTRENGTH_D",e[e.ATTR_TYPE_SKILLSTRENGTH_E=9]="ATTR_TYPE_SKILLSTRENGTH_E",e[e.ATTR_TYPE_FIX_DAMAGE=10]="ATTR_TYPE_FIX_DAMAGE",e[e.ATTR_TYPE_ATTACK_PERCENT=11]="ATTR_TYPE_ATTACK_PERCENT",e[e.ATTR_TYPE_ATTACKSPEED_PERCENT=12]="ATTR_TYPE_ATTACKSPEED_PERCENT",e[e.ATTR_TYPE_NONE_13=13]="ATTR_TYPE_NONE_13",e[e.ATTR_TYPE_NONE_14=14]="ATTR_TYPE_NONE_14",e[e.ATTR_TYPE_DAMAGECHANGE_PERCENT=15]="ATTR_TYPE_DAMAGECHANGE_PERCENT",e[e.ATTR_TYPE_NONE_16=16]="ATTR_TYPE_NONE_16",e[e.ATTR_TYPE_NONE_17=17]="ATTR_TYPE_NONE_17",e[e.ATTR_TYPE_NONE_18=18]="ATTR_TYPE_NONE_18",e[e.ATTR_TYPE_NONE_19=19]="ATTR_TYPE_NONE_19",e[e.ATTR_TYPE_NONE_20=20]="ATTR_TYPE_NONE_20",e[e.ATTR_TYPE_MAX=20]="ATTR_TYPE_MAX"}(o.ATTR_TYPE||(o.ATTR_TYPE={})),function(e){e[e.ACTIVITY_GROUP_FOREVER=1]="ACTIVITY_GROUP_FOREVER",e[e.ACTIVITY_GROUP_TIME=2]="ACTIVITY_GROUP_TIME"}(o.ACTIVITY_GROUP||(o.ACTIVITY_GROUP={})),function(e){e[e.ACTIVITY_TYPE_EMPTY=1]="ACTIVITY_TYPE_EMPTY",e[e.ACTIVITY_TYPE_EXCLUCKDRAW=2]="ACTIVITY_TYPE_EXCLUCKDRAW",e[e.ACTIVITY_TYPE_RANDOMARENA=3]="ACTIVITY_TYPE_RANDOMARENA",e[e.ACTIVITY_TYPE_DAYPRIZE=4]="ACTIVITY_TYPE_DAYPRIZE",e[e.ACTIVITY_TYPE_GOLDENLEAGUE=5]="ACTIVITY_TYPE_GOLDENLEAGUE",e[e.ACTIVITY_TYPE_RECHARGE=6]="ACTIVITY_TYPE_RECHARGE",e[e.ACTIVITY_TYPE_COOPERATION=7]="ACTIVITY_TYPE_COOPERATION",e[e.ACTIVITY_TYPE_RANDOMPRIZE=8]="ACTIVITY_TYPE_RANDOMPRIZE",e[e.ACTIVITY_TYPE_DAYRECHARGE=9]="ACTIVITY_TYPE_DAYRECHARGE",e[e.ACTIVITY_TYPE_RECHARGERANDOMCHOOSE=10]="ACTIVITY_TYPE_RECHARGERANDOMCHOOSE",e[e.ACTIVITY_TYPE_OPENBOXREBATE=11]="ACTIVITY_TYPE_OPENBOXREBATE",e[e.ACTIVITY_TYPE_TOTALRECHARGE=12]="ACTIVITY_TYPE_TOTALRECHARGE",e[e.ACTIVITY_TYPE_MIRRORARENA=13]="ACTIVITY_TYPE_MIRRORARENA",e[e.ACTIVITY_TYPE_TOTALGIVEPRIZE=14]="ACTIVITY_TYPE_TOTALGIVEPRIZE",e[e.ACTIVITY_TYPE_ACTIVITYCOIN=15]="ACTIVITY_TYPE_ACTIVITYCOIN",e[e.ACTIVITY_TYPE_LIMITCHALLENGE=16]="ACTIVITY_TYPE_LIMITCHALLENGE",e[e.ACTIVITY_TYPE_WISHINGCOINFIGHTDROP=17]="ACTIVITY_TYPE_WISHINGCOINFIGHTDROP",e[e.ACTIVITY_TYPE_WISHINGPOOL=18]="ACTIVITY_TYPE_WISHINGPOOL",e[e.ACTIVITY_TYPE_LOOP_DAY_TASK=19]="ACTIVITY_TYPE_LOOP_DAY_TASK",e[e.ACTIVITY_TYPE_OLD_ROLE_BACK=20]="ACTIVITY_TYPE_OLD_ROLE_BACK",e[e.ACTIVITY_TYPE_TASK=21]="ACTIVITY_TYPE_TASK",e[e.ACTIVITY_TYPE_QQ_NEWYEAR_ORDER=22]="ACTIVITY_TYPE_QQ_NEWYEAR_ORDER",e[e.ACTIVITY_TYPE_QQ_NEWYEAR_CASH=23]="ACTIVITY_TYPE_QQ_NEWYEAR_CASH",e[e.ACTIVITY_TYPE_LAYER_TASK=24]="ACTIVITY_TYPE_LAYER_TASK",e[e.ACTIVITY_TYPE_LAYER_POS_LUCKDRAW=25]="ACTIVITY_TYPE_LAYER_POS_LUCKDRAW",e[e.ACTIVITY_TYPE_EXCHANGE=26]="ACTIVITY_TYPE_EXCHANGE",e[e.ACTIVITY_TYPE_EATCHICKEN=27]="ACTIVITY_TYPE_EATCHICKEN",e[e.ACTIVITY_TYPE_SOCIATYWAR=28]="ACTIVITY_TYPE_SOCIATYWAR",e[e.ACTIVITY_TYPE_GREATSAILING=29]="ACTIVITY_TYPE_GREATSAILING",e[e.ACTIVITY_TYPE_CASTLESKY=30]="ACTIVITY_TYPE_CASTLESKY",e[e.ACTIVITY_TYPE_WEEK_COOPERATION=31]="ACTIVITY_TYPE_WEEK_COOPERATION",e[e.ACTIVITY_TYPE_ANNIVERSARY_TRIAL=32]="ACTIVITY_TYPE_ANNIVERSARY_TRIAL",e[e.ACTIVITY_TYPE_FOG_HIDDEN=33]="ACTIVITY_TYPE_FOG_HIDDEN",e[e.ACTIVITY_TYPE_MACHINARIUM=34]="ACTIVITY_TYPE_MACHINARIUM"}(o.ACTIVITY_TYPE||(o.ACTIVITY_TYPE={})),function(e){e[e.ACTIVITY_DAYPRIZE_OPEN_CONDITION_NULL=0]="ACTIVITY_DAYPRIZE_OPEN_CONDITION_NULL",e[e.ACTIVITY_DAYPRIZE_OPEN_CONDITION_RECHARGE=1]="ACTIVITY_DAYPRIZE_OPEN_CONDITION_RECHARGE"}(o.ACTIVITY_DAYPRIZE_OPEN_CONDITION||(o.ACTIVITY_DAYPRIZE_OPEN_CONDITION={})),function(e){e[e.MAIL_STATE_UNREAD=1]="MAIL_STATE_UNREAD",e[e.MAIL_STATE_READ=2]="MAIL_STATE_READ",e[e.MAIL_STATE_TAKEANNEX=3]="MAIL_STATE_TAKEANNEX"}(o.MAIL_STATE||(o.MAIL_STATE={})),function(e){e[e.MAIL_PARAM_TYPE_INT=1]="MAIL_PARAM_TYPE_INT",e[e.MAIL_PARAM_TYPE_STRING=2]="MAIL_PARAM_TYPE_STRING"}(o.MAIL_PARAM_TYPE||(o.MAIL_PARAM_TYPE={})),function(e){e[e.TASK_GROUP_TYPE_COMMON=1]="TASK_GROUP_TYPE_COMMON",e[e.TASK_GROUP_TYPE_DAY=2]="TASK_GROUP_TYPE_DAY",e[e.TASK_GROUP_TYPE_RAND=3]="TASK_GROUP_TYPE_RAND"}(o.TASK_GROUP_TYPE||(o.TASK_GROUP_TYPE={})),function(e){e[e.TASK_STATE_EXECUTING=0]="TASK_STATE_EXECUTING",e[e.TASK_STATE_FINISH=1]="TASK_STATE_FINISH"}(o.TASK_STATE||(o.TASK_STATE={})),function(e){e[e.TASK_TYPE_CONDITION_TASK=1]="TASK_TYPE_CONDITION_TASK",e[e.TASK_TYPE_COUNT_CLIENT=2]="TASK_TYPE_COUNT_CLIENT",e[e.TASK_TYPE_COUNT_ADVERT=3]="TASK_TYPE_COUNT_ADVERT",e[e.TASK_TYPE_COUNT_ADDITEM=4]="TASK_TYPE_COUNT_ADDITEM",e[e.TASK_TEYP_CONDITION_ITEMNUM=5]="TASK_TEYP_CONDITION_ITEMNUM",e[e.TASK_TYPE_COUNT_ADDITEMBYTYPE=6]="TASK_TYPE_COUNT_ADDITEMBYTYPE",e[e.TASK_TEYP_CONDITION_ITEMNUMBYTYPE=7]="TASK_TEYP_CONDITION_ITEMNUMBYTYPE",e[e.TASK_TYPE_COUNT_DELITEM=8]="TASK_TYPE_COUNT_DELITEM",e[e.TASK_TYPE_COUNT_HEROLEVELUP=9]="TASK_TYPE_COUNT_HEROLEVELUP",e[e.TASK_TYPE_COUNT_SUPPORTBOX=10]="TASK_TYPE_COUNT_SUPPORTBOX",e[e.TASK_TYPE_COUNT_ONEXCHANGE=11]="TASK_TYPE_COUNT_ONEXCHANGE",e[e.TASK_TYPE_COUNT_RANDSHOPREFRESH=12]="TASK_TYPE_COUNT_RANDSHOPREFRESH",e[e.TASK_TYPE_COUNT_FIGHTBALANCE=13]="TASK_TYPE_COUNT_FIGHTBALANCE",e[e.TASK_TYPE_COUNT_FIGHTPRIZE=14]="TASK_TYPE_COUNT_FIGHTPRIZE",e[e.TASK_TYPE_COUNT_FIGHTHEROFIGHTLEVELUP=15]="TASK_TYPE_COUNT_FIGHTHEROFIGHTLEVELUP",e[e.TASK_TYPE_COUNT_FIGHTHEROBUILDNUM=16]="TASK_TYPE_COUNT_FIGHTHEROBUILDNUM",e[e.TASK_TYPE_COUNT_FIGHTHEROMIXNUM=17]="TASK_TYPE_COUNT_FIGHTHEROMIXNUM",e[e.TASK_TYPE_COUNT_FIGHTMONSTERDEATHNUM=18]="TASK_TYPE_COUNT_FIGHTMONSTERDEATHNUM",e[e.TASK_TYPE_CONDITION_ITEMLEVELNUMBYTYPE=19]="TASK_TYPE_CONDITION_ITEMLEVELNUMBYTYPE",e[e.TASK_TYPE_COUNT_ADDFIGHTCOOPERATIONNUM=20]="TASK_TYPE_COUNT_ADDFIGHTCOOPERATIONNUM",e[e.TASK_TYPE_COUNT_FIGHTCUMULATIVEROUND=21]="TASK_TYPE_COUNT_FIGHTCUMULATIVEROUND",e[e.TASK_TYPE_COUNT_FIGHTCUMULATIVESP=22]="TASK_TYPE_COUNT_FIGHTCUMULATIVESP",e[e.TASK_TYPE_COUNT_FIGHTHEROTYPE=23]="TASK_TYPE_COUNT_FIGHTHEROTYPE",e[e.TASK_TYPE_COUNT_FIGHTHEROQUALITY=24]="TASK_TYPE_COUNT_FIGHTHEROQUALITY",e[e.TASK_TYPE_COUNT_SHAREPLAYERNUM=25]="TASK_TYPE_COUNT_SHAREPLAYERNUM",e[e.TASK_TYPE_COUNT_FARMHARVESTQUALITY=26]="TASK_TYPE_COUNT_FARMHARVESTQUALITY",e[e.TASK_TYPE_CONDITION_MAXCUPSCOUNT=27]="TASK_TYPE_CONDITION_MAXCUPSCOUNT",e[e.TASK_TYPE_COUNT_FIGHTCUMULATIVEONCESP=28]="TASK_TYPE_COUNT_FIGHTCUMULATIVEONCESP",e[e.TASK_TYPE_COUNT_WORLDCHAT=29]="TASK_TYPE_COUNT_WORLDCHAT",e[e.TASK_TYPE_COUNT_FIGHTCUMULATIVEONCEROUND=30]="TASK_TYPE_COUNT_FIGHTCUMULATIVEONCEROUND",e[e.TASK_TYPE_COUNT_HEROARRAYUP=31]="TASK_TYPE_COUNT_HEROARRAYUP",e[e.TASK_TYPE_COUNT_RANDSHOPBUY=32]="TASK_TYPE_COUNT_RANDSHOPBUY",e[e.TASK_TYPE_COUNT_FINISHTASK=33]="TASK_TYPE_COUNT_FINISHTASK",e[e.TASK_TYPE_COUNT_DAYSHAREPLAYERNUM=34]="TASK_TYPE_COUNT_DAYSHAREPLAYERNUM",e[e.TASK_TYPE_CONDITION_ROLELEVEL=35]="TASK_TYPE_CONDITION_ROLELEVEL",e[e.TASK_TYPE_CONDITION_GROUPMATCHMAXOVERSTEPPRE=36]="TASK_TYPE_CONDITION_GROUPMATCHMAXOVERSTEPPRE",e[e.TASK_TYPE_COUNT_FIGHTBALANCE_MONSTERDEATHNUM=37]="TASK_TYPE_COUNT_FIGHTBALANCE_MONSTERDEATHNUM",e[e.TASK_TYPE_COUNT_FIGHTBALANCE_HEROMIXNUM=38]="TASK_TYPE_COUNT_FIGHTBALANCE_HEROMIXNUM",e[e.TASK_TYPE_COUNT_FIGHTBALANCE_WIN_RANDOMARENA=39]="TASK_TYPE_COUNT_FIGHTBALANCE_WIN_RANDOMARENA",e[e.TASK_TYPE_COUNT_FIGHTBALANCE_WIN=40]="TASK_TYPE_COUNT_FIGHTBALANCE_WIN",e[e.TASK_TYPE_COUNT_FIGHTBALANCE_OTHERPLAYER=41]="TASK_TYPE_COUNT_FIGHTBALANCE_OTHERPLAYER",e[e.TASK_TYPE_COUNT_FIGHTBALANCE_BATTLEHERO=42]="TASK_TYPE_COUNT_FIGHTBALANCE_BATTLEHERO",e[e.TASK_TYPE_CONDITION_BATTLERUNE=43]="TASK_TYPE_CONDITION_BATTLERUNE",e[e.TASK_TYPE_CONDITION_RUNEBYID=44]="TASK_TYPE_CONDITION_RUNEBYID",e[e.TASK_TYPE_COUNT_TIMELOCKBOXRECEIVE=45]="TASK_TYPE_COUNT_TIMELOCKBOXRECEIVE",e[e.TASK_TYPE_COUNT_TOTALLOGIN=46]="TASK_TYPE_COUNT_TOTALLOGIN",e[e.TASK_TYPE_COUNT_FIGHTBALANCE_HEROFIGHTLEVEL=47]="TASK_TYPE_COUNT_FIGHTBALANCE_HEROFIGHTLEVEL",e[e.TASK_TYPE_COUNT_FIGHTBALANCE_GOLDENLEAGUE=48]="TASK_TYPE_COUNT_FIGHTBALANCE_GOLDENLEAGUE",e[e.TASK_TYPE_COUNT_DRAWPRIZEBYTYPE=49]="TASK_TYPE_COUNT_DRAWPRIZEBYTYPE",e[e.TASK_TYPE_COUNT_LIVETIME=50]="TASK_TYPE_COUNT_LIVETIME",e[e.TASK_TYPE_COUNT_RECHARGENUM=51]="TASK_TYPE_COUNT_RECHARGENUM",e[e.TASK_TYPE_COUNT_FARMPLANT=52]="TASK_TYPE_COUNT_FARMPLANT",e[e.TASK_TYPE_COUNT_SOCIATYDONATE=53]="TASK_TYPE_COUNT_SOCIATYDONATE",e[e.TASK_TYPE_COUNT_CAR_HP=54]="TASK_TYPE_COUNT_CAR_HP",e[e.TASK_TYPE_COUNT_FIGHTBALANCE_ACTIVITY=55]="TASK_TYPE_COUNT_FIGHTBALANCE_ACTIVITY",e[e.TASK_TYPE_COUNT_CHICKENRANK=56]="TASK_TYPE_COUNT_CHICKENRANK",e[e.TASK_TYPE_COUNT_PROFICIENCY=57]="TASK_TYPE_COUNT_PROFICIENCY"}(o.TASK_TYPE||(o.TASK_TYPE={})),function(e){e[e.TASK_CHANNELS_LIVE=17]="TASK_CHANNELS_LIVE",e[e.TASK_SUMMONER=18]="TASK_SUMMONER",e[e.TASK_SHOW_TYPE_ACHIEVEMENT=19]="TASK_SHOW_TYPE_ACHIEVEMENT",e[e.TASK_CHANNELS_LIVE_ADVANCE=20]="TASK_CHANNELS_LIVE_ADVANCE",e[e.TASK_CHANNELS_LIVE_REWARD=21]="TASK_CHANNELS_LIVE_REWARD",e[e.ASK_CHANNELS_LIVE_FLYBACK=22]="ASK_CHANNELS_LIVE_FLYBACK",e[e.ASK_CHANNELS_LIVE_NEW_REPORTED=23]="ASK_CHANNELS_LIVE_NEW_REPORTED"}(o.TASK_SHOW_TYPE||(o.TASK_SHOW_TYPE={})),function(e){e[e.TASK_CLIENT_TYPE_ACHIEVEMENT_LIVE_TIME=1]="TASK_CLIENT_TYPE_ACHIEVEMENT_LIVE_TIME",e[e.TASK_CLIENT_TYPE_ACHIEVEMENT_BATTLE_WIN=2]="TASK_CLIENT_TYPE_ACHIEVEMENT_BATTLE_WIN",e[e.TASK_CLIENT_TYPE_ACHIEVEMENT_BATTLE=3]="TASK_CLIENT_TYPE_ACHIEVEMENT_BATTLE",e[e.TASK_CLIENT_TYPE_ACHIEVEMENT_COOP_TOTAL=4]="TASK_CLIENT_TYPE_ACHIEVEMENT_COOP_TOTAL",e[e.TASK_CLIENT_TYPE_ACHIEVEMENT_COOP_MAX=5]="TASK_CLIENT_TYPE_ACHIEVEMENT_COOP_MAX",e[e.TASK_CLIENT_TYPE_ACHIEVEMENT_COOP_COUNT=6]="TASK_CLIENT_TYPE_ACHIEVEMENT_COOP_COUNT",e[e.TASK_CLIENT_TYPE_ACHIEVEMENT_PVP=7]="TASK_CLIENT_TYPE_ACHIEVEMENT_PVP",e[e.TASK_CLIENT_TYPE_ACHIEVEMENT_COOP=8]="TASK_CLIENT_TYPE_ACHIEVEMENT_COOP",e[e.TASK_CLIENT_TYPE_ACHIEVEMENT_HERO=9]="TASK_CLIENT_TYPE_ACHIEVEMENT_HERO",e[e.TASK_CLIENT_TYPE_ACHIEVEMENT_OTHER=10]="TASK_CLIENT_TYPE_ACHIEVEMENT_OTHER",e[e.TASK_CLIENT_TYPE_ACHIEVEMENT_TOTAL=11]="TASK_CLIENT_TYPE_ACHIEVEMENT_TOTAL",e[e.TASK_CLIENT_TYPE_ACHIEVEMENT_ANNIVERSARY_BATTLE=64]="TASK_CLIENT_TYPE_ACHIEVEMENT_ANNIVERSARY_BATTLE"}(o.TASK_CLIENT_TYPE||(o.TASK_CLIENT_TYPE={})),function(e){e[e.TYPE_CHAT_CHANNEL_SYSTEM=1]="TYPE_CHAT_CHANNEL_SYSTEM",e[e.TYPE_CHAT_CHANNEL_WORLD=2]="TYPE_CHAT_CHANNEL_WORLD",e[e.TYPE_CHAT_CHANNEL_PRIVATE=3]="TYPE_CHAT_CHANNEL_PRIVATE",e[e.TYPE_CHAT_CHANNEL_TEAM=4]="TYPE_CHAT_CHANNEL_TEAM",e[e.TYPE_CHAT_CHANNEL_SOCIATY=5]="TYPE_CHAT_CHANNEL_SOCIATY",e[e.TYPE_CHAT_CHANNEL_SKYCASTLE_EASY=6]="TYPE_CHAT_CHANNEL_SKYCASTLE_EASY",e[e.TYPE_CHAT_CHANNEL_SKYCASTLE_HARD=7]="TYPE_CHAT_CHANNEL_SKYCASTLE_HARD",e[e.TYPE_CHAT_CHANNEL_SKYCASTLE_NIGHTMARE=8]="TYPE_CHAT_CHANNEL_SKYCASTLE_NIGHTMARE",e[e.TYPE_CHAT_CHANNEL_ACTIVITY=9]="TYPE_CHAT_CHANNEL_ACTIVITY",e[e.TYPE_CHAT_CHANNEL_WEEK_COOPERATION=10]="TYPE_CHAT_CHANNEL_WEEK_COOPERATION"}(o.TYPE_CHAT_CHANNEL||(o.TYPE_CHAT_CHANNEL={})),function(e){e[e.TYPE_CHAT_TEXT=1]="TYPE_CHAT_TEXT",e[e.TYPE_CHAT_EXPRESSION=2]="TYPE_CHAT_EXPRESSION",e[e.TYPE_CHAT_ROOMFIGHT=3]="TYPE_CHAT_ROOMFIGHT"}(o.TYPE_CHAT||(o.TYPE_CHAT={})),function(e){e[e.FUNCTION_OPEN_ID_FRIEND=1006]="FUNCTION_OPEN_ID_FRIEND",e[e.FUNCTION_OPEN_ID_SOCIATY=1037]="FUNCTION_OPEN_ID_SOCIATY"}(o.FUNCTION_OPEN_ID||(o.FUNCTION_OPEN_ID={})),function(e){e[e.BRIEF_EVENT_TYPE_RECHARGE=1]="BRIEF_EVENT_TYPE_RECHARGE",e[e.BRIEF_EVENT_TYPE_ITEM=2]="BRIEF_EVENT_TYPE_ITEM",e[e.BRIEF_EVENT_TYPE_FIGHTBALANCE=3]="BRIEF_EVENT_TYPE_FIGHTBALANCE",e[e.BRIEF_EVENT_TYPE_SHARE=4]="BRIEF_EVENT_TYPE_SHARE",e[e.BRIEF_EVENT_TYPE_CDK=5]="BRIEF_EVENT_TYPE_CDK",e[e.BRIEF_EVENT_TYPE_TASK=6]="BRIEF_EVENT_TYPE_TASK",e[e.BRIEF_EVENT_TYPE_DECDROPLOCK=7]="BRIEF_EVENT_TYPE_DECDROPLOCK",e[e.BRIEF_EVENT_TYPE_ADDDROP=8]="BRIEF_EVENT_TYPE_ADDDROP",e[e.BRIEF_EVENT_TYPE_EATCHICKEN=9]="BRIEF_EVENT_TYPE_EATCHICKEN",e[e.BRIEF_EVENT_TYPE_DELITEM=10]="BRIEF_EVENT_TYPE_DELITEM"}(o.BRIEF_EVENT_TYPE||(o.BRIEF_EVENT_TYPE={})),function(e){e[e.ROBOT_BUILD_TYPE_RAND=1]="ROBOT_BUILD_TYPE_RAND",e[e.ROBOT_BUILD_TYPE_RAND_DEL=2]="ROBOT_BUILD_TYPE_RAND_DEL",e[e.ROBOT_BUILD_TYPE_ORDER=3]="ROBOT_BUILD_TYPE_ORDER"}(o.ROBOT_BUILD_TYPE||(o.ROBOT_BUILD_TYPE={})),function(e){e[e.ROLE_EXCHANGE_COST_TYPE_COMMON=1]="ROLE_EXCHANGE_COST_TYPE_COMMON"}(o.ROLE_EXCHANGE_COST_TYPE||(o.ROLE_EXCHANGE_COST_TYPE={})),function(e){e[e.FIGHT_PATTERN_BATTLE=1]="FIGHT_PATTERN_BATTLE",e[e.FIGHT_PATTERN_COOPERATION=2]="FIGHT_PATTERN_COOPERATION",e[e.FIGHT_PATTERN_BATTLE_GUIDE=3]="FIGHT_PATTERN_BATTLE_GUIDE",e[e.FIGHT_PATTERN_COOPERATION_GUIDE=4]="FIGHT_PATTERN_COOPERATION_GUIDE"}(o.FIGHT_PATTERN||(o.FIGHT_PATTERN={})),function(e){e[e.FIGHT_TYPE_MIN=1]="FIGHT_TYPE_MIN",e[e.FIGHT_TYPE_BATTLE=1]="FIGHT_TYPE_BATTLE",e[e.FIGHT_TYPE_COOPERATION=2]="FIGHT_TYPE_COOPERATION",e[e.FIGHT_TYPE_DUEL_BATTLE=3]="FIGHT_TYPE_DUEL_BATTLE",e[e.FIGHT_TYPE_BATTLE_GUIDE=4]="FIGHT_TYPE_BATTLE_GUIDE",e[e.FIGHT_TYPE_COOPERATION_GUIDE=5]="FIGHT_TYPE_COOPERATION_GUIDE",e[e.FIGHT_TYPE_BATTLE_SHOW=6]="FIGHT_TYPE_BATTLE_SHOW",e[e.FIGHT_TYPE_BATTLE_GOLDENLEAGUE=7]="FIGHT_TYPE_BATTLE_GOLDENLEAGUE",e[e.FIGHT_TYPE_BATTLE_EAT_CHICKEN=8]="FIGHT_TYPE_BATTLE_EAT_CHICKEN",e[e.FIGHT_TYPE_BATTLE_SOCIATY_WAR=9]="FIGHT_TYPE_BATTLE_SOCIATY_WAR",e[e.FIGHT_TYPE_BATTLE_GREAT_SAILING=10]="FIGHT_TYPE_BATTLE_GREAT_SAILING",e[e.FIGHT_TYPE_SKY_CASTLE=11]="FIGHT_TYPE_SKY_CASTLE",e[e.FIGHT_TYPE_WEEK_COOPERATION=12]="FIGHT_TYPE_WEEK_COOPERATION",e[e.FIGHT_TYPE_ANNIVERSARY_TRIAL=13]="FIGHT_TYPE_ANNIVERSARY_TRIAL",e[e.FIGHT_TYPE_FOG_HIDDEN=14]="FIGHT_TYPE_FOG_HIDDEN",e[e.FIGHT_TYPE_MACHINARIUM=15]="FIGHT_TYPE_MACHINARIUM",e[e.FIGHT_TYPE_MAX=15]="FIGHT_TYPE_MAX"}(o.FIGHT_TYPE||(o.FIGHT_TYPE={})),function(e){e[e.FIGHT_MODULE_TEST=0]="FIGHT_MODULE_TEST",e[e.FIGHT_MODULE_ROBOT=1]="FIGHT_MODULE_ROBOT",e[e.FIGHT_MODULE_ONLINE=2]="FIGHT_MODULE_ONLINE"}(o.FIGHT_MODULE||(o.FIGHT_MODULE={})),function(e){e[e.FIGHT_ROLE_IDENTITY_HOST=1]="FIGHT_ROLE_IDENTITY_HOST",e[e.FIGHT_ROLE_IDENTITY_GUEST=2]="FIGHT_ROLE_IDENTITY_GUEST"}(o.FIGHT_ROLE_IDENTITY||(o.FIGHT_ROLE_IDENTITY={})),function(e){e[e.RANKLIST_TYPE_MIN=1]="RANKLIST_TYPE_MIN",e[e.RANKLIST_TYPE_BATTLE=1]="RANKLIST_TYPE_BATTLE",e[e.RANKLIST_TYPE_COOPERATION=2]="RANKLIST_TYPE_COOPERATION",e[e.RANKLIST_TYPE_BEREPORT=3]="RANKLIST_TYPE_BEREPORT",e[e.RANKLIST_TYPE_SEASION_HISTORY=4]="RANKLIST_TYPE_SEASION_HISTORY",e[e.RANKLIST_TYPE_ACTIVITY_GOLDENLEAGUE=5]="RANKLIST_TYPE_ACTIVITY_GOLDENLEAGUE",e[e.RANKLIST_TYPE_ACTIVITY_GOLDENLEAGUEHISTORY=6]="RANKLIST_TYPE_ACTIVITY_GOLDENLEAGUEHISTORY",e[e.RANKLIST_TYPE_SOCIATY=7]="RANKLIST_TYPE_SOCIATY",e[e.RANKLIST_TYPE_SOCIATYWAR_SOCIATY=8]="RANKLIST_TYPE_SOCIATYWAR_SOCIATY",e[e.RANKLIST_TYPE_SOCIATYWAR_PERSONAL=9]="RANKLIST_TYPE_SOCIATYWAR_PERSONAL",e[e.RANKLIST_TYPE_SOCIATYWAR_SOCIATY_HISTORY=10]="RANKLIST_TYPE_SOCIATYWAR_SOCIATY_HISTORY",e[e.RANKLIST_TYPE_GREATSAILING=11]="RANKLIST_TYPE_GREATSAILING",e[e.RANKLIST_TYPE_ACHIEVEMENT=12]="RANKLIST_TYPE_ACHIEVEMENT",e[e.RANKLIST_TYPE_WEEK_COOPERATION=13]="RANKLIST_TYPE_WEEK_COOPERATION",e[e.RANKLIST_TYPE_ANNIVERSARY_TRIAL=14]="RANKLIST_TYPE_ANNIVERSARY_TRIAL",e[e.RANKLIST_TYPE_DIAMOND=15]="RANKLIST_TYPE_DIAMOND",e[e.RANKLIST_TYPE_VOUCHER=16]="RANKLIST_TYPE_VOUCHER",e[e.RANKLIST_TYPE_FOGHIDDEN1=17]="RANKLIST_TYPE_FOGHIDDEN1",e[e.RANKLIST_TYPE_FOGHIDDEN2=18]="RANKLIST_TYPE_FOGHIDDEN2",e[e.RANKLIST_TYPE_FOGHIDDEN3=19]="RANKLIST_TYPE_FOGHIDDEN3",e[e.RANKLIST_TYPE_OCCUPATION=20]="RANKLIST_TYPE_OCCUPATION",e[e.RANKLIST_TYPE_MACHINARIUM=21]="RANKLIST_TYPE_MACHINARIUM",e[e.RANKLIST_TYPE_MAX=21]="RANKLIST_TYPE_MAX"}(o.RANKLIST_TYPE||(o.RANKLIST_TYPE={})),function(e){e[e.MONSTER_TYPE_COMMON=1]="MONSTER_TYPE_COMMON",e[e.MONSTER_TYPE_ELITE=2]="MONSTER_TYPE_ELITE",e[e.MONSTER_TYPE_BOSS=3]="MONSTER_TYPE_BOSS"}(o.MONSTER_TYPE||(o.MONSTER_TYPE={})),function(e){e[e.THEME_BOX_EXP_TYPE_ALL=0]="THEME_BOX_EXP_TYPE_ALL",e[e.THEME_BOX_EXP_TYPE_BOSS_NUM=1]="THEME_BOX_EXP_TYPE_BOSS_NUM"}(o.THEME_BOX_EXP_TYPE||(o.THEME_BOX_EXP_TYPE={})),function(e){e[e.THEME_BOX_PRIZE_LEVEL_TYPE_COMMON=1]="THEME_BOX_PRIZE_LEVEL_TYPE_COMMON",e[e.THEME_BOX_PRIZE_LEVEL_TYPE_RECHARGE=2]="THEME_BOX_PRIZE_LEVEL_TYPE_RECHARGE"}(o.THEME_BOX_PRIZE_LEVEL_TYPE||(o.THEME_BOX_PRIZE_LEVEL_TYPE={})),function(e){e[e.CHAMPIONSHIP_TYPE_GRADE=1]="CHAMPIONSHIP_TYPE_GRADE",e[e.CHAMPIONSHIP_TYPE_COOPRATION=2]="CHAMPIONSHIP_TYPE_COOPRATION",e[e.CHAMPIONSHIP_TYPE_BATTLE=3]="CHAMPIONSHIP_TYPE_BATTLE"}(o.CHAMPIONSHIP_TYPE||(o.CHAMPIONSHIP_TYPE={})),function(e){e[e.CHAMPIONSHIP_STATE_NOOPEN=0]="CHAMPIONSHIP_STATE_NOOPEN",e[e.CHAMPIONSHIP_STATE_OPEN=1]="CHAMPIONSHIP_STATE_OPEN",e[e.CHAMPIONSHIP_STATE_SETTLEMENT=2]="CHAMPIONSHIP_STATE_SETTLEMENT",e[e.CHAMPIONSHIP_STATE_END=3]="CHAMPIONSHIP_STATE_END",e[e.CHAMPIONSHIP_STATE_CLEAR=4]="CHAMPIONSHIP_STATE_CLEAR"}(o.CHAMPIONSHIP_STATE||(o.CHAMPIONSHIP_STATE={})),function(e){e[e.CHAMPIONSHIP_SCORE_TYPE_CUP=1]="CHAMPIONSHIP_SCORE_TYPE_CUP",e[e.CHAMPIONSHIP_SCORE_TYPE_ROUND=2]="CHAMPIONSHIP_SCORE_TYPE_ROUND"}(o.CHAMPIONSHIP_SCORE_TYPE||(o.CHAMPIONSHIP_SCORE_TYPE={})),function(e){e[e.CHAMPIONSHIP_SCORE_RANK_SCORE=1]="CHAMPIONSHIP_SCORE_RANK_SCORE",e[e.CHAMPIONSHIP_SCORE_RANK_MAXSCORE=2]="CHAMPIONSHIP_SCORE_RANK_MAXSCORE"}(o.CHAMPIONSHIP_RANK_TYPE||(o.CHAMPIONSHIP_RANK_TYPE={})),function(e){e[e.SUBSCRIBE_SEND_TYPE_METERING=1]="SUBSCRIBE_SEND_TYPE_METERING",e[e.SUBSCRIBE_SEND_TYPE_PERMANENT=2]="SUBSCRIBE_SEND_TYPE_PERMANENT"}(o.SUBSCRIBE_SEND_TYPE||(o.SUBSCRIBE_SEND_TYPE={})),function(e){e[e.SUBSCRIBE_TIME_TYPE_DAY=1]="SUBSCRIBE_TIME_TYPE_DAY",e[e.SUBSCRIBE_TIME_TYPE_WEEK=2]="SUBSCRIBE_TIME_TYPE_WEEK",e[e.SUBSCRIBE_TIME_TYPE_UTC=3]="SUBSCRIBE_TIME_TYPE_UTC"}(o.SUBSCRIBE_TIME_TYPE||(o.SUBSCRIBE_TIME_TYPE={})),function(e){e[e.ACCESSTOKEN_TYPE_FORMAL=1]="ACCESSTOKEN_TYPE_FORMAL",e[e.ACCESSTOKEN_TYPE_TEST=2]="ACCESSTOKEN_TYPE_TEST"}(o.ACCESSTOKEN_TYPE||(o.ACCESSTOKEN_TYPE={})),function(e){e[e.FIGHTCHECK_TYPE_SYNCCOUNT=1]="FIGHTCHECK_TYPE_SYNCCOUNT",e[e.FIGHTCHECK_TYPE_SYNCSP=2]="FIGHTCHECK_TYPE_SYNCSP",e[e.FIGHTCHECK_TYPE_SYNCROUND=3]="FIGHTCHECK_TYPE_SYNCROUND",e[e.FIGHTCHECK_TYPE_SYNCATTR=4]="FIGHTCHECK_TYPE_SYNCATTR",e[e.FIGHTCHECK_TYPE_SYNCTIME=5]="FIGHTCHECK_TYPE_SYNCTIME"}(o.FIGHTCHECK_TYPE||(o.FIGHTCHECK_TYPE={})),function(e){e[e.FIGHTCHECK_SP_TYPE_MAX_DIFFERENCE=1]="FIGHTCHECK_SP_TYPE_MAX_DIFFERENCE",e[e.FIGHTCHECK_SP_TYPE_MIN_MINUS=2]="FIGHTCHECK_SP_TYPE_MIN_MINUS",e[e.FIGHTCHECK_SP_TYPE_MAX_ADD=3]="FIGHTCHECK_SP_TYPE_MAX_ADD",e[e.FIGHTCHECK_SP_TYPE_MIN_COST=4]="FIGHTCHECK_SP_TYPE_MIN_COST"}(o.FIGHTCHECK_SP_TYPE||(o.FIGHTCHECK_SP_TYPE={})),function(e){e[e.SP_CHANGE_TYPE_INIT=1]="SP_CHANGE_TYPE_INIT",e[e.SP_CHANGE_TYPE_RECONNECT=2]="SP_CHANGE_TYPE_RECONNECT",e[e.SP_CHANGE_TYPE_CREATE_TOWER=3]="SP_CHANGE_TYPE_CREATE_TOWER",e[e.SP_CHANGE_TYPE_LEVELUP=4]="SP_CHANGE_TYPE_LEVELUP",e[e.SP_CHANGE_TYPE_ADD_DEAD=5]="SP_CHANGE_TYPE_ADD_DEAD",e[e.SP_CHANGE_TYPE_ADD_PASS=6]="SP_CHANGE_TYPE_ADD_PASS",e[e.SP_CHANGE_TYPE_ADD_MINE=7]="SP_CHANGE_TYPE_ADD_MINE",e[e.SP_CHANGE_TYPE_ADD_OBLATION=8]="SP_CHANGE_TYPE_ADD_OBLATION",e[e.SP_CHANGE_TYPE_ADD_THIEF=9]="SP_CHANGE_TYPE_ADD_THIEF",e[e.SP_CHANGE_TYPE_ADD_SELL_HERO=10]="SP_CHANGE_TYPE_ADD_SELL_HERO",e[e.SP_CHANGE_TYPE_BEGIN=11]="SP_CHANGE_TYPE_BEGIN"}(o.SP_CHANGE_TYPE||(o.SP_CHANGE_TYPE={})),function(e){e[e.FIGHTCHECK_DETAIL_TYPE_ALLTIME=1]="FIGHTCHECK_DETAIL_TYPE_ALLTIME",e[e.FIGHTCHECK_DETAIL_TYPE_AVERAGE=2]="FIGHTCHECK_DETAIL_TYPE_AVERAGE",e[e.FIGHTCHECK_DETAIL_TYPE_MAXDIFSP=3]="FIGHTCHECK_DETAIL_TYPE_MAXDIFSP",e[e.FIGHTCHECK_DETAIL_TYPE_MINUSSP=4]="FIGHTCHECK_DETAIL_TYPE_MINUSSP",e[e.FIGHTCHECK_DETAIL_TYPE_MAXADDSP=5]="FIGHTCHECK_DETAIL_TYPE_MAXADDSP",e[e.FIGHTCHECK_DETAIL_TYPE_MINCOSTSP=6]="FIGHTCHECK_DETAIL_TYPE_MINCOSTSP",e[e.FIGHTCHECK_DETAIL_TYPE_COSTSPRANGENUM=7]="FIGHTCHECK_DETAIL_TYPE_COSTSPRANGENUM",e[e.FIGHTCHECK_DETAIL_TYPE_CONTINUEROUND=8]="FIGHTCHECK_DETAIL_TYPE_CONTINUEROUND",e[e.FIGHTCHECK_DETAIL_TYPE_ROUNDSPEED=9]="FIGHTCHECK_DETAIL_TYPE_ROUNDSPEED",e[e.FIGHTCHECK_DETAIL_TYPE_ATTR=10]="FIGHTCHECK_DETAIL_TYPE_ATTR",e[e.FIGHTCHECK_DETAIL_TYPE_TIME=11]="FIGHTCHECK_DETAIL_TYPE_TIME"}(o.FIGHTCHECK_DETAIL_TYPE||(o.FIGHTCHECK_DETAIL_TYPE={})),function(e){e[e.FIGHT_SP_CHANGE_TYPE_COST=0]="FIGHT_SP_CHANGE_TYPE_COST",e[e.FIGHT_SP_CHANGE_TYPE_ADD=1]="FIGHT_SP_CHANGE_TYPE_ADD"}(o.FIGHT_SP_CHANGE_TYPE||(o.FIGHT_SP_CHANGE_TYPE={})),function(e){e[e.FIGHT_SP_COST_RANGE_1=1]="FIGHT_SP_COST_RANGE_1"}(o.FIGHT_SP_COST_RANGE||(o.FIGHT_SP_COST_RANGE={})),function(e){e[e.FIGHT_TABLE_ID_BATTLEHEROAWAKEN=1]="FIGHT_TABLE_ID_BATTLEHEROAWAKEN",e[e.FIGHT_TABLE_ID_BATTLELEVELUP=2]="FIGHT_TABLE_ID_BATTLELEVELUP",e[e.FIGHT_TABLE_ID_BATTLENPCMONEY=3]="FIGHT_TABLE_ID_BATTLENPCMONEY",e[e.FIGHT_TABLE_ID_BATTLERUNEFINAL=4]="FIGHT_TABLE_ID_BATTLERUNEFINAL",e[e.FIGHT_TABLE_ID_BATTLERUNE=5]="FIGHT_TABLE_ID_BATTLERUNE",e[e.FIGHT_TABLE_ID_BATTLEBUFF=8]="FIGHT_TABLE_ID_BATTLEBUFF",e[e.FIGHT_TABLE_ID_MAX_DAMAGE_PVE=11]="FIGHT_TABLE_ID_MAX_DAMAGE_PVE",e[e.FIGHT_TABLE_ID_MAX_DAMAGE_PVP=12]="FIGHT_TABLE_ID_MAX_DAMAGE_PVP",e[e.FIGHT_TABLE_ID_CLIENT_CHECK8089=13]="FIGHT_TABLE_ID_CLIENT_CHECK8089",e[e.FIGHT_TABLE_ID_CLIENT_CHECK8090=14]="FIGHT_TABLE_ID_CLIENT_CHECK8090",e[e.FIGHT_TABLE_ID_CLIENT_CHECK8091=15]="FIGHT_TABLE_ID_CLIENT_CHECK8091",e[e.FIGHT_TABLE_ID_CLIENT_CHECK8092=16]="FIGHT_TABLE_ID_CLIENT_CHECK8092",e[e.FIGHT_TABLE_ID_CLIENT_CHECK8093=20]="FIGHT_TABLE_ID_CLIENT_CHECK8093",e[e.FIGHT_TABLE_ID_CLIENT_CHAT=21]="FIGHT_TABLE_ID_CLIENT_CHAT",e[e.FIGHT_TABLE_ID_CLIENT_290XIAOYU650=22]="FIGHT_TABLE_ID_CLIENT_290XIAOYU650",e[e.FIGHT_TABLE_ID_CLIENT_GREATSAILING=23]="FIGHT_TABLE_ID_CLIENT_GREATSAILING",e[e.FIGHT_TABLE_ID_CLIENT_CHECK8094=24]="FIGHT_TABLE_ID_CLIENT_CHECK8094",e[e.FIGHT_TABLE_ID_CLIENT_CHECK8095=25]="FIGHT_TABLE_ID_CLIENT_CHECK8095",e[e.FIGHT_TABLE_ID_FIGHT_LOG=26]="FIGHT_TABLE_ID_FIGHT_LOG",e[e.FIGHT_TABLE_ID_FIGHT_HERO_NO_HAVE=56]="FIGHT_TABLE_ID_FIGHT_HERO_NO_HAVE",e[e.FIGHT_TABLE_ID_FIGHT_HERO_10=57]="FIGHT_TABLE_ID_FIGHT_HERO_10"}(o.FIGHT_TABLE_ID||(o.FIGHT_TABLE_ID={})),function(e){e[e.GOLDENLEAGUE_STAGE_NORMAL=0]="GOLDENLEAGUE_STAGE_NORMAL",e[e.GOLDENLEAGUE_STAGE_AFTER=1]="GOLDENLEAGUE_STAGE_AFTER",e[e.GOLDENLEAGUE_STAGE_FIGHT=2]="GOLDENLEAGUE_STAGE_FIGHT"}(o.GOLDENLEAGUE_STAGE||(o.GOLDENLEAGUE_STAGE={})),function(e){e[e.TASK_EXTRA_TYPE_NORECEIVE=0]="TASK_EXTRA_TYPE_NORECEIVE",e[e.TASK_EXTRA_TYPE_RECEIVE=1]="TASK_EXTRA_TYPE_RECEIVE"}(o.TASK_EXTRA_TYPE||(o.TASK_EXTRA_TYPE={})),function(e){e[e.GAME_NOTICE_PARAM_TYPE_TEXT=1]="GAME_NOTICE_PARAM_TYPE_TEXT"}(o.GAME_NOTICE_PARAM_TYPE||(o.GAME_NOTICE_PARAM_TYPE={})),function(e){e[e.HALL_OF_FAME_TYPE_BATTLE=1]="HALL_OF_FAME_TYPE_BATTLE",e[e.HALL_OF_FAME_TYPE_COOPRATION=2]="HALL_OF_FAME_TYPE_COOPRATION",e[e.HALL_OF_FAME_TYPE_GOLDENLEAGUE=3]="HALL_OF_FAME_TYPE_GOLDENLEAGUE"}(o.HALL_OF_FAME_TYPE||(o.HALL_OF_FAME_TYPE={})),function(e){e[e.TIME_LOCK_BOX_STATE_FREE=0]="TIME_LOCK_BOX_STATE_FREE",e[e.TIME_LOCK_BOX_STATE_UNLOCK=1]="TIME_LOCK_BOX_STATE_UNLOCK",e[e.TIME_LOCK_BOX_STATE_WAIT=2]="TIME_LOCK_BOX_STATE_WAIT",e[e.TIME_LOCK_BOX_STATE_OPEN=3]="TIME_LOCK_BOX_STATE_OPEN"}(o.TIME_LOCK_BOX_STATE||(o.TIME_LOCK_BOX_STATE={})),function(e){e[e.TIME_LOCK_BOX_RECEIVE_COST_NULL=0]="TIME_LOCK_BOX_RECEIVE_COST_NULL",e[e.TIME_LOCK_BOX_RECEIVE_COST_1=1]="TIME_LOCK_BOX_RECEIVE_COST_1",e[e.TIME_LOCK_BOX_RECEIVE_COST_2=2]="TIME_LOCK_BOX_RECEIVE_COST_2",e[e.TIME_LOCK_BOX_RECEIVE_COST_FREE=3]="TIME_LOCK_BOX_RECEIVE_COST_FREE"}(o.TIME_LOCK_BOX_RECEIVE_COST||(o.TIME_LOCK_BOX_RECEIVE_COST={})),function(e){e[e.DRAWPRIZE_TYPE_RUNE_ONE=1]="DRAWPRIZE_TYPE_RUNE_ONE",e[e.DRAWPRIZE_TYPE_RUNE_TEN=2]="DRAWPRIZE_TYPE_RUNE_TEN",e[e.DRAWPRIZE_TYPE_MAX=2]="DRAWPRIZE_TYPE_MAX"}(o.DRAWPRIZE_TYPE||(o.DRAWPRIZE_TYPE={})),function(e){e[e.ONOFF_ID_GUARD_NO_PRIZE=1]="ONOFF_ID_GUARD_NO_PRIZE",e[e.ONOFF_ID_DRAW_PRIZE=2]="ONOFF_ID_DRAW_PRIZE",e[e.ONOFF_ID_FIGHT_GUART_LOG=3]="ONOFF_ID_FIGHT_GUART_LOG",e[e.ONOFF_ID_GUARD_SP_MAX_DIFFERENCE=4]="ONOFF_ID_GUARD_SP_MAX_DIFFERENCE",e[e.ONOFF_ID_GUARD_SP_MIN_MINUS=5]="ONOFF_ID_GUARD_SP_MIN_MINUS",e[e.ONOFF_ID_GUARD_SP_MAX_ADD=6]="ONOFF_ID_GUARD_SP_MAX_ADD",e[e.ONOFF_ID_GUARD_SP_MIN_COST=7]="ONOFF_ID_GUARD_SP_MIN_COST",e[e.ONOFF_ID_GUARD_SP_COST_RANGE=8]="ONOFF_ID_GUARD_SP_COST_RANGE",e[e.ONOFF_ID_GUARD_SPEED=9]="ONOFF_ID_GUARD_SPEED",e[e.ONOFF_ID_GUARD_ATTRIBUTE=10]="ONOFF_ID_GUARD_ATTRIBUTE",e[e.ONOFF_ID_GUARD_MAX_DAMAGE_PVE=11]="ONOFF_ID_GUARD_MAX_DAMAGE_PVE",e[e.ONOFF_ID_GUARD_MAX_DAMAGE_PVP=12]="ONOFF_ID_GUARD_MAX_DAMAGE_PVP",e[e.ONOFF_ID_GUARD_CLIENT_CHECK8089=13]="ONOFF_ID_GUARD_CLIENT_CHECK8089",e[e.ONOFF_ID_GUARD_CLIENT_CHECK8090=14]="ONOFF_ID_GUARD_CLIENT_CHECK8090",e[e.ONOFF_ID_GUARD_CLIENT_CHECK8091=15]="ONOFF_ID_GUARD_CLIENT_CHECK8091",e[e.ONOFF_ID_GUARD_CLIENT_CHECK8092=16]="ONOFF_ID_GUARD_CLIENT_CHECK8092",e[e.ONOFF_ID_EAT_CHICKEN=17]="ONOFF_ID_EAT_CHICKEN",e[e.ONOFF_ID_SOCIATY_WAR=18]="ONOFF_ID_SOCIATY_WAR",e[e.ONOFF_ID_PUSH_GIFT=19]="ONOFF_ID_PUSH_GIFT",e[e.ONOFF_ID_GUARD_CLIENT_CHECK8093=20]="ONOFF_ID_GUARD_CLIENT_CHECK8093",e[e.ONOFF_ID_GUARD_CLIENT_CHAT=21]="ONOFF_ID_GUARD_CLIENT_CHAT",e[e.ONOFF_ID_GUARD_CLIENT_290XIAOYU6500=22]="ONOFF_ID_GUARD_CLIENT_290XIAOYU6500",e[e.ONOFF_ID_GUARD_CLIENT_GREATSAILING=23]="ONOFF_ID_GUARD_CLIENT_GREATSAILING",e[e.ONOFF_ID_GUARD_CLIENT_CHECK8094=24]="ONOFF_ID_GUARD_CLIENT_CHECK8094",e[e.ONOFF_ID_GUARD_CLIENT_CHECK8095=25]="ONOFF_ID_GUARD_CLIENT_CHECK8095",e[e.ONOFF_ID_FIGHT_LOG=26]="ONOFF_ID_FIGHT_LOG"}(o.ONOFF_ID||(o.ONOFF_ID={})),function(e){e[e.LUCKYTIME_POPWAY_LOGIN=1]="LUCKYTIME_POPWAY_LOGIN",e[e.LUCKYTIME_POPWAY_MAX_SCORE=2]="LUCKYTIME_POPWAY_MAX_SCORE"}(o.LUCKYTIME_POPWAY||(o.LUCKYTIME_POPWAY={})),function(e){e[e.EATCHICKEN_STAGE_NONE=0]="EATCHICKEN_STAGE_NONE",e[e.EATCHICKEN_STAGE_NORMAL=1]="EATCHICKEN_STAGE_NORMAL",e[e.EATCHICKEN_STAGE_ASSEMBLE=2]="EATCHICKEN_STAGE_ASSEMBLE",e[e.EATCHICKEN_STAGE_MATCHING=3]="EATCHICKEN_STAGE_MATCHING",e[e.EATCHICKEN_STAGE_FIGHT=4]="EATCHICKEN_STAGE_FIGHT",e[e.EATCHICKEN_STAGE_WAIT=5]="EATCHICKEN_STAGE_WAIT"}(o.EATCHICKEN_STAGE||(o.EATCHICKEN_STAGE={})),function(e){e[e.SOCIATY_JOB_PRESIDENT=30]="SOCIATY_JOB_PRESIDENT",e[e.SOCIATY_JOB_OFFICIAL=20]="SOCIATY_JOB_OFFICIAL",e[e.SOCIATY_JOB_MEMBER=10]="SOCIATY_JOB_MEMBER"}(o.SOCIATY_JOB||(o.SOCIATY_JOB={})),function(e){e[e.SOCIATY_ENTER_TYPE_FREE=1]="SOCIATY_ENTER_TYPE_FREE",e[e.SOCIATY_ENTER_TYPE_EXAMINE=2]="SOCIATY_ENTER_TYPE_EXAMINE",e[e.SOCIATY_ENTER_TYPE_FORBID=3]="SOCIATY_ENTER_TYPE_FORBID"}(o.SOCIATY_ENTER_TYPE||(o.SOCIATY_ENTER_TYPE={})),function(e){e[e.SOCIATY_LOG_TYPE_PLAYERENTER=1]="SOCIATY_LOG_TYPE_PLAYERENTER",e[e.SOCIATY_LOG_TYPE_PLAYERLEAVE=2]="SOCIATY_LOG_TYPE_PLAYERLEAVE",e[e.SOCIATY_LOG_TYPE_PLAYERKICK=3]="SOCIATY_LOG_TYPE_PLAYERKICK",e[e.SOCIATY_LOG_TYPE_AUTOCHANGEPRESIDENT=4]="SOCIATY_LOG_TYPE_AUTOCHANGEPRESIDENT",e[e.SOCIATY_LOG_TYPE_CHANGEJOB=5]="SOCIATY_LOG_TYPE_CHANGEJOB",e[e.SOCIATY_LOG_TYPE_LEVELUP=6]="SOCIATY_LOG_TYPE_LEVELUP",e[e.SOCIATY_LOG_TYPE_GRADEUP=7]="SOCIATY_LOG_TYPE_GRADEUP"}(o.SOCIATY_LOG_TYPE||(o.SOCIATY_LOG_TYPE={})),function(e){e[e.QQHALL_REWARD_TYPE_BLUE_NEW=1]="QQHALL_REWARD_TYPE_BLUE_NEW",e[e.QQHALL_REWARD_TYPE_BLUE_YEAR=2]="QQHALL_REWARD_TYPE_BLUE_YEAR",e[e.QQHALL_REWARD_TYPE_BLUE_LEVEL=3]="QQHALL_REWARD_TYPE_BLUE_LEVEL",e[e.QQHALL_REWARD_TYPE_BLUE_DAY_YEAR=4]="QQHALL_REWARD_TYPE_BLUE_DAY_YEAR",e[e.QQHALL_REWARD_TYPE_BLUE_DAY_SUPER=5]="QQHALL_REWARD_TYPE_BLUE_DAY_SUPER",e[e.QQHALL_REWARD_TYPE_BLUE_DAY_LEVEL=6]="QQHALL_REWARD_TYPE_BLUE_DAY_LEVEL",e[e.QQHALL_REWARD_TYPE_HALL_NEW=7]="QQHALL_REWARD_TYPE_HALL_NEW",e[e.QQHALL_REWARD_TYPE_HALL_LEVEL=8]="QQHALL_REWARD_TYPE_HALL_LEVEL",e[e.QQHALL_REWARD_TYPE_HALL_DAY=9]="QQHALL_REWARD_TYPE_HALL_DAY"}(o.QQHALL_REWARD_TYPE||(o.QQHALL_REWARD_TYPE={})),function(e){e[e.SOCIATYWAR_STAGE_NORMAL=0]="SOCIATYWAR_STAGE_NORMAL",e[e.SOCIATYWAR_STAGE_AFTER=1]="SOCIATYWAR_STAGE_AFTER",e[e.SOCIATYWAR_STAGE_FIGHT=2]="SOCIATYWAR_STAGE_FIGHT"}(o.SOCIATYWAR_STAGE||(o.SOCIATYWAR_STAGE={})),function(e){e[e.SKYCASTLE_TYPE_EASY=1]="SKYCASTLE_TYPE_EASY",e[e.SKYCASTLE_TYPE_HARD=2]="SKYCASTLE_TYPE_HARD",e[e.SKYCASTLE_TYPE_NIGHTMARE=3]="SKYCASTLE_TYPE_NIGHTMARE"}(o.SKYCASTLE_TYPE||(o.SKYCASTLE_TYPE={})),function(e){e[e.CHAT_CHANNEL_SYSTEM_GROUP=1]="CHAT_CHANNEL_SYSTEM_GROUP",e[e.CHAT_CHANNEL_WORLD_GROUP=2]="CHAT_CHANNEL_WORLD_GROUP",e[e.CHAT_CHANNEL_PRIVATE_GROUP=3]="CHAT_CHANNEL_PRIVATE_GROUP",e[e.CHAT_CHANNEL_TEAM_GROUP=4]="CHAT_CHANNEL_TEAM_GROUP",e[e.CHAT_CHANNEL_SOCIATY_GROUP=5]="CHAT_CHANNEL_SOCIATY_GROUP",e[e.CHAT_CHANNEL_ACTICITY_GROUP=9]="CHAT_CHANNEL_ACTICITY_GROUP"}(o.CHAT_CHANNEL_GROUP_TYPE||(o.CHAT_CHANNEL_GROUP_TYPE={})),function(e){e[e.RECHARGE_CHRISTMAS=1]="RECHARGE_CHRISTMAS",e[e.RECHARGE_ROYALE=2]="RECHARGE_ROYALE"}(o.TYPE_SELF_SELECT||(o.TYPE_SELF_SELECT={})),function(e){e[e.CLIENT_CALL_PHP_CHECKTABLE=1]="CLIENT_CALL_PHP_CHECKTABLE"}(o.TYPE_CLIENT_CALL_PHP||(o.TYPE_CLIENT_CALL_PHP={})),cc._RF.pop()},{DataViewRW:"DataViewRW",ObjCollection:"ObjCollection",long:"long"}],UIManager:[function(e,t,o){"use strict";cc._RF.push(t,"877cdfejvpIZ6E1axUS4rPS","UIManager");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r},r=this&&this.__awaiter||function(e,t,o,i){return new(o||(o=Promise))(function(a,n){function r(e){try{c(i.next(e))}catch(t){n(t)}}function s(e){try{c(i.throw(e))}catch(t){n(t)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(r,s)}c((i=i.apply(e,t||[])).next())})},s=this&&this.__generator||function(e,t){var o,i,a,n,r={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return n={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function s(e){return function(t){return c([e,t])}}function c(n){if(o)throw new TypeError("Generator is already executing.");for(;r;)try{if(o=1,i&&(a=2&n[0]?i.return:n[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return r.label++,{value:n[1],done:!1};case 5:r.label++,i=n[1],n=[0];continue;case 7:n=r.ops.pop(),r.trys.pop();continue;default:if(!(a=(a=r.trys).length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){r=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){r.label=n[1];break}if(6===n[0]&&r.label<a[1]){r.label=a[1],a=n;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(n);break}a[2]&&r.ops.pop(),r.trys.pop();continue}n=t.call(e,r)}catch(s){n=[6,s],i=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.UIManager=o.ShowPopLayerMsgData=o.GameMainLayerZorder=o.RootNodeName=o.PopLayerParam=o.ResourceType=o.PopNodeType=o.SceneType=o.SceneName=o.SceneTag=o.PrefabUrl=o.PopNodeTag=void 0;var c,l,d,u,h,p,f=e("../Global/GameGlobal"),g=e("../network/ClientNetwork"),m=e("../network/LocalMessage"),_=e("../network/ReconnectLayer"),y=e("./ConfigInt"),v=e("./GameUtils"),C=e("./subUtils/PopLayer"),S=e("./subUtils/SingleNodeCache"),T=e("./subUtils/SpineMaker"),I=e("./subUtils/WaitingLayer"),N=e("../modules/base/GameView"),b=e("./ResourceLoader"),w=e("./GameLoading"),E=e("../modules/manager/ViewManager"),P=e("./ResourcesManager");(function(e){e[e.NONE=-1]="NONE",e[e.ReconnectLayer=0]="ReconnectLayer",e[e.FightReconnectLayer=1]="FightReconnectLayer",e[e.PveView=2]="PveView",e[e.MatchLayer=3]="MatchLayer",e[e.HeroLayer=4]="HeroLayer",e[e.RankListLayer=5]="RankListLayer",e[e.FightResultPPVE=6]="FightResultPPVE",e[e.FightResultPVPWIN=7]="FightResultPVPWIN",e[e.FightResultPVPLOSE=8]="FightResultPVPLOSE",e[e.NewHandFinish=9]="NewHandFinish",e[e.BattleDetails=10]="BattleDetails"})(c=o.PopNodeTag||(o.PopNodeTag={})),function(e){e.ReconnectLayer="ui/CommonPrefab/Reconnect",e.FightReconnectLayer="ui/CommonPrefab/FightReconnect",e.WaittingLayer="ui/CommonPrefab/WaitingLayer",e.MainTopButtonLayer="ui/bag/bag_top",e.MainBagLayer="ui/bag/main_background",e.PveMainLayer="ui/pve/pve_main",e.MatchLayer="ui/match/match",e.RankListLayer="ui/ranklist/ranklist",e.RankListItem="ui/ranklist/ranklistitem",e.FightResultPPVE="ui/result/ppve",e.FightResultPVPWIN="ui/result/win",e.FightResultPVPLOSE="ui/result/lose",e.ShopSuperSale="ui/shop/prefab/superSale",e.ShopSuperChosen="ui/shop/prefab/superChosen",e.BattleDetails="ui/battleDetails/prefab/battleDetails_mian"}(l=o.PrefabUrl||(o.PrefabUrl={})),function(e){e[e.NONE=0]="NONE",e[e.AccountScene=1]="AccountScene",e[e.MainScene=2]="MainScene",e[e.PveFightScene=3]="PveFightScene",e[e.PvpFightScene=4]="PvpFightScene",e[e.LoginScene=5]="LoginScene"}(d=o.SceneTag||(o.SceneTag={})),function(e){e.NONE="",e.AccountScene="AccountScene",e.MainScene="mainScene",e.LoginScene="login",e.PveFightScene="combat",e.PvpFightScene="combat",e.CreateRoleScene=""}(u=o.SceneName||(o.SceneName={})),function(e){e[e.Type0=0]="Type0",e[e.Type1=1]="Type1",e[e.Type2=2]="Type2",e[e.Type3=3]="Type3"}(h=o.SceneType||(o.SceneType={})),function(e){e[e.Normal=0]="Normal",e[e.FullScreen=1]="FullScreen"}(p=o.PopNodeType||(o.PopNodeType={})),function(e){e[e.game_main_from_out_game=0]="game_main_from_out_game",e[e.game_main_from_pve=1]="game_main_from_pve",e[e.game_main_from_pvp=2]="game_main_from_pvp",e[e.fight_pve_from_main=3]="fight_pve_from_main",e[e.fight_pvp_from_main=4]="fight_pvp_from_main",e[e.subgame_from_main=5]="subgame_from_main"}(o.ResourceType||(o.ResourceType={}));var R,L;o.PopLayerParam=function(){this.isZoomAnimation=!0,this.isLeftAnimation=!1,this.isRightAnimation=!1,this.m_popType=C.POPLYAERSTATE.POPLYAERSTATE_CHEEK},function(e){e.RootNodeName_Top="RootNodeName_Top",e.RootNodeName_Bottom="RootNodeName_Bottom"}(R=o.RootNodeName||(o.RootNodeName={})),function(e){e[e.GMZ_MAINMOVE_NODE=-300]="GMZ_MAINMOVE_NODE",e[e.GMZ_GAMEMAINLAYER_BACKIMG=-2]="GMZ_GAMEMAINLAYER_BACKIMG",e[e.GMZ_GAMEMAINLAYER_MOVESCROLL=-1]="GMZ_GAMEMAINLAYER_MOVESCROLL",e[e.GMZ_INTERFACENODE=0]="GMZ_INTERFACENODE",e[e.GMZ_FULLSCREENNODE=50]="GMZ_FULLSCREENNODE",e[e.GMZ_ROLEINFOLAYER=117]="GMZ_ROLEINFOLAYER",e[e.GMZ_MENUBUTTON=117]="GMZ_MENUBUTTON",e[e.GMZ_FRIENDHEADMESSAGE=120]="GMZ_FRIENDHEADMESSAGE",e[e.GMZ_POPNODE=374]="GMZ_POPNODE",e[e.GMZ_CLICKEFFECT=400]="GMZ_CLICKEFFECT",e[e.GMZ_GAMELOADING=500]="GMZ_GAMELOADING",e[e.GMZ_TASKPUSH=999]="GMZ_TASKPUSH",e[e.GMZ_NEW_TALK=1e3]="GMZ_NEW_TALK",e[e.GMZ_FLYWORD=9999]="GMZ_FLYWORD",e[e.GMZ_DISCONNECT=300]="GMZ_DISCONNECT"}(L=o.GameMainLayerZorder||(o.GameMainLayerZorder={}));o.ShowPopLayerMsgData=function(){this.type=p.Normal,this.popNodeTag=c.NONE};var A=cc._decorator,D=A.ccclass,M=A.property,B=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._test=1,t.poplayerCacheNode=null,t._popnodeCache=null,t._loadingScene="",t.curSceneName="",t.curSceneTag=d.NONE,t.nextSceneTag=d.NONE,t.curSceneType=h.Type0,t.isBackGame=!1,t.SceneList=new Array,t.tagList=new Array,t.typeList=new Array,t.currentScene=null,t.popNode=null,t.popNodezIndex=0,t.fullScreenPopNode=null,t.fullScreenPopNodeIndex=0,t.garbageCollect=0,t.loadSceneCount=0,t.renderTexture=new cc.RenderTexture,t}var o;return a(t,e),o=t,t.prototype.onLoad=function(){this.backKeyListener(),cc.game.on(cc.game.EVENT_HIDE,function(){console.log("\u6e38\u620f\u8fdb\u5165\u540e\u53f0BackGround"),g.ClientNetwork.getInstance().pushLocalMessage(m.LOCAL_MESSAGE.LocalMsg_Game_BackGround)},this),cc.game.on(cc.game.EVENT_SHOW,function(){console.log("\u6e38\u620f\u8fdb\u5165\u524d\u53f0FrontGround"),o.isAppEnterHideShow=!0,g.ClientNetwork.getInstance().pushLocalMessage(m.LOCAL_MESSAGE.LocalMsg_Game_FrontGround)},this),this.renderTexture.initWithSize(cc.winSize.width,cc.winSize.height,cc.game._renderContext.STENCIL_INDEX8),this._popnodeCache=this.poplayerCacheNode.getComponent(S.default),this.setCanCachPopTag()},t.prototype.addTopBottomInfo=function(e,t){console.log("HHHHHHHHHHHHHHHHHHHHHH addTopBottomInfo"),this.getCurSceneName()!==u.MainScene?h.Type1==t?(this.addTopInfo(e),this.addBottonInfo(e)):h.Type2==t?this.addBottonInfo(e):h.Type3==t&&this.addBottonInfo(e):this.addTopInfo(e),e.name!=u.LoginScene&&e.name!=u.AccountScene&&(e.name,u.CreateRoleScene)},t.prototype.showWaitingLayer=function(e,t,o){return void 0===t&&(t=5),void 0===o&&(o=1),r(this,void 0,void 0,function(){return s(this,function(i){switch(i.label){case 0:return[4,I.default.show(e,t,o)];case 1:return i.sent(),[2]}})})},t.prototype.addTopInfo=function(e){var t=e.getChildByName(R.RootNodeName_Top);t&&t.removeFromParent(),v.LoadNode(l.MainTopButtonLayer).then(function(t){0!=cc.isValid(e,!0)?(t.parent=e,t.name=R.RootNodeName_Top,t.width=cc.winSize.width,t.width>1440&&(t.width=1440),g.ClientNetwork.getInstance().pushLocalMessage(m.LOCAL_MESSAGE.LocalMsg_RootTopCreateFinshed,t,e)):t.destroy()}).catch(function(e){cc.error(e)})},t.prototype.addBottonInfo=function(e){var t=e.getChildByName(R.RootNodeName_Bottom);t&&t.removeFromParent(),cc.instantiate(this.menuButtonPrefab)},t.prototype.setTopVisible=function(e){var t=f.G.UIManager.getRunningScene();if(t.name==u.MainScene);else{var o=t.getChildByName(R.RootNodeName_Top);o&&(o.active=e)}},t.prototype.setBottonVisible=function(e){var t=f.G.UIManager.getRunningScene();if(t.name==u.MainScene);else{var o=t.getChildByName(R.RootNodeName_Bottom);o&&(o.active=e)}},t.prototype.hideWaitingLayer=function(e,t){void 0===t&&(t=!1),I.default.hide(e,t)},t.prototype.setProgress=function(e,t){if(b.ResourceLoaderLayer.getState()==b.ResoureGameState.Other)I.default.setProgress(e/t);else{if(b.ResourceLoaderLayer.getState()==b.ResoureGameState.ResoureGameState_Pve||b.ResourceLoaderLayer.getState()==b.ResoureGameState.ResoureGameState_Pvp)return;var o=f.G.gameLoading.getComponentInChildren(w.default);o&&o.hideGameLoading()}},t.prototype.showReconnectLayer=function(e){if(e.name==u.AccountScene||e.name==u.LoginScene)return!1;var t=g.ClientNetwork.getInstance().getWebSocket();return!(t&&t.readyState!=WebSocket.CLOSED&&t.readyState!=WebSocket.CLOSING||(_.default.ShowReconnectLayer(),0))},t.prototype.getFileSuffix=function(e){if(!e)return null;var t=e.split(".");return t[t.length-1]},t.prototype.addDisConnectBtn=function(e){if(void 0===e&&(e=null),e.name!=u.AccountScene&&e.name!=u.LoginScene&&cc.sys.os==cc.sys.OS_WINDOWS){var t=new cc.Node,o=t.addComponent(cc.Sprite);v.setTexture(o,"ui/mainScene/anjian02");var i=this;t.on(cc.Node.EventType.TOUCH_START,function(){cc.log("all asset count = "+cc.assetManager.assets.count);var e=cc.assetManager.assets,t=0,o="",a=0;e.forEach(function(e){if(o=e.nativeUrl,t++,"png"==i.getFileSuffix(o)||"jpg"==i.getFileSuffix(o)){var n=e,r=(n.width*n.height*("jpg"==i.getFileSuffix(o)?3:4)/1024/1024).toFixed(2);a+=+r,console.log("==*== \u5927\u5c0f=\u300b"+o+"==============>"+r+"M")}}),console.log("==*== \u56fe\u7247\u603b\u5927\u5c0f=\u300b"+a+"M "+t),cc.log("HHHHHHHHHHHHHHH disconnect")}),t.name="disconnectbtn";var a,n=e.getChildByName("disconnectbtn");n&&n.removeFromParent(),e.addChild(t,L.GMZ_DISCONNECT),a=cc.winSize.height-25,t.setPosition(25,a),f.G.UIManager.getCurSceneTag(),t.active=!0}},t.prototype.addClickEffectNode=function(e){if(e.name!=u.AccountScene&&e.name!=u.LoginScene&&e.name!=u.CreateRoleScene&&e.name!=u.PveFightScene&&e.name!=u.PveFightScene){var t=e.getChildByName("clickEffectNode");t&&t.removeFromParent();var o=cc.winSize,i=new cc.Node;i.name="clickEffectNode",i.setContentSize(o),i.setPosition(cc.Vec2.ZERO),i.setAnchorPoint(0,0),i.zIndex=L.GMZ_CLICKEFFECT,i.on("touchend",function(e){var t=e.getLocation(),o=N.default.getViewByName("HeroCardsMainView");o&&o.view&&o.view.carHpAdditionNode&&(o.view.carHpAdditionNode.active=!1);var a=N.default.getViewByName("MainSceneView");if(a&&a.view&&a.view._chatNode&&cc.isValid(a.view._chatNode)){var n=a.view._chatNode.getChildByName("chatMain");n&&n.getComponent("ChatMainView").onTouchEndCloseEmoji(t)}var r=N.default.getViewByName("UnionMainView");r&&r.view&&r.view.fullScreenTouchEvent(t);var s=i.getComponentInChildren(sp.Skeleton);if(s)return s.node.setPosition(t),void s.setAnimation(0,"idle",!1);i.removeAllChildren(),T.SpineMaker.createSpineV2(2e4).then(function(e){cc.isValid(i,!0)&&e&&i&&(e.node.setPosition(t),i.addChild(e.node),e.setAnimation(0,"idle",!1))}).catch(function(e){cc.error(e)})},i),i._touchListener.swallowTouches=!1,e.addChild(i)}},t.prototype.LoadScene=function(e,t,o,i,a,n,c,l){return void 0===o&&(o=0),void 0===i&&(i=null),void 0===a&&(a=!0),void 0===n&&(n=!1),void 0===c&&(c=null),void 0===l&&(l=null),r(this,void 0,void 0,function(){var r;return s(this,function(){return this._loadingScene?(cc.error("one scene at a time, now loading",this._loadingScene),[2]):(this.noticeSceneBeginLoad(t),r=f.G.UIManager.getCurSceneName(),console.log("qiehuanchangjing from  "+r+" to "+e),r==e?(f.G.UIManager.clearAllPopNode(),f.G.UIManager.clearAllFullScreenPopNode(),i&&c?i.call(c,!1,f.G.UIManager.getRunningScene(),l):i&&i(!1,f.G.UIManager.getRunningScene(),l),f.G.UIManager.noticeSceneLoaded(),[2]):(this._loadingScene=e,this.showWaitingLayer(e),this.scheduleOnce(function(){this.triggerLoad(e,t,o,i,a,n,c,l)}.bind(this),0),[2]))})})},t.prototype.triggerLoad=function(e,t,o,i,a,n,c,l){return void 0===o&&(o=0),void 0===i&&(i=null),void 0===a&&(a=!0),void 0===n&&(n=!1),void 0===c&&(c=null),void 0===l&&(l=null),r(this,void 0,void 0,function(){var a;return s(this,function(n){switch(n.label){case 0:return a=this,cc.log("### triggerLoad "+t+" ###"),t==d.PveFightScene||d.PvpFightScene,[4,cc.director.loadScene(e,function(n,r){if(a._loadingScene="",a.setProgress(100,100),r){a.currentScene=r,r.name=e,console.log("### LoadScene "+e+" ###"),a.setCurSceneInfo(e,t,o);var s=cc.winSize;a.popNodezIndex=0,a.popNode=new cc.Node,a.popNode.name="popNode",r.addChild(a.popNode,L.GMZ_POPNODE),a.fullScreenPopNode=new cc.Node,a.fullScreenPopNode.name="fullScreenPopNode",a.fullScreenPopNodeIndex=0,a.fullScreenPopNode.setPosition(s.width/2,s.height/2),r.addChild(a.fullScreenPopNode,L.GMZ_FULLSCREENNODE),u.MainScene,a.addClickEffectNode(r)}i&&(c?i.call(c,n,r,l):i(n,r,l)),a.hideWaitingLayer(e),a.showReconnectLayer(r),a.noticeSceneLoaded(),E.default.__closeAllView__()})];case 1:return n.sent(),[2]}})})},t.prototype.onDestroy=function(){cc.sys.os==cc.sys.OS_ANDROID&&(console.log("android backKeyListener onDestroy"),cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this))},t.prototype.backKeyListener=function(){console.log("android backKeyListener"),cc.sys.os==cc.sys.OS_ANDROID&&cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this)},t.prototype.onKeyDown=function(e){switch(console.log("android backKeyListener onKeyDown"),e.keyCode){case cc.macro.KEY.back:}},t.prototype.noticeSceneLoaded=function(){cc.log("### noticeSceneLoaded ###");var e={loadScene:d.NONE,lastScene:d.NONE};this.tagList.length>0&&(e.loadScene=this.tagList[0]),this.tagList.length>1&&(e.lastScene=this.tagList[1]),g.ClientNetwork.getInstance().pushLocalMessage(m.LOCAL_MESSAGE.LocalMsg_GUIDE_RESET),g.ClientNetwork.getInstance().pushLocalMessage(m.LOCAL_MESSAGE.LocalMsg_SceneLoaded,e)},t.prototype.noticeSceneBeginLoad=function(e){cc.log("### noticeSceneBeginLoad "+e+" ###");var t={curSceneTag:d.NONE,targetSceneTag:d.NONE};t.curSceneTag=this.curSceneTag,t.targetSceneTag=e,g.ClientNetwork.getInstance().pushLocalMessage(m.LOCAL_MESSAGE.LocalMsg_SceneBeginLoad,t)},t.prototype.getCurSceneName=function(){return this.curSceneName},t.prototype.getCurSceneTag=function(){return this.curSceneTag},t.prototype.getLastSceneName=function(){return this.SceneList[1]},t.prototype.getSceneNameByTag=function(e){for(var t=0;t<this.tagList.length;t++)if(e==this.tagList[t])return this.SceneList[t];return cc.log("NO this Scene Tag = "+e),""},t.prototype.setCurSceneInfo=function(e,t,o){this.curSceneName=e,this.curSceneTag=t,this.curSceneType=o,this.nextSceneTag=d.NONE,this.tracertScene(e,t,o)},t.prototype.setNextSceneInfo=function(e){this.nextSceneTag=e},t.prototype.getNextSceneTag=function(){return this.nextSceneTag},t.prototype.tracertScene=function(e,t,o){this.typeList.unshift(o),this.typeList.length>y.MAXSCENETRACERTNUM&&this.typeList.pop(),this.tagList.unshift(t),this.tagList.length>y.MAXSCENETRACERTNUM&&this.tagList.pop(),this.SceneList.unshift(e),this.SceneList.length>y.MAXSCENETRACERTNUM&&this.SceneList.pop()},t.prototype.gotoMainScene=function(e,t,o){var i=this;0!=P.default.funcOpen()?(v.snapshot(),cc.director.loadScene("ReleaseScene",function(a,n){E.default.__closeAllView__();var r=n.getComponentInChildren(cc.Sprite);if(r){var s=cc.view.getDesignResolutionSize(),c=cc.view.getCanvasSize().width/s.width,l=cc.view.getCanvasSize().height/s.height,h=cc.view.getCanvasSize().height/r.node.height;c>l&&(h=cc.view.getCanvasSize().width/r.node.width,r.node.width*=h),r.spriteFrame.setTexture(i.renderTexture)}P.default.releaseAssets(1)&&cc.sys.garbageCollect(),i.scheduleOnce(function(){f.G.UIManager.LoadScene(u.MainScene,d.MainScene,0,t,!0,!0,e,o)},.1)})):f.G.UIManager.LoadScene(u.MainScene,d.MainScene,0,t,!0,!0,e,o)},t.prototype.popScene=function(e,t){if(void 0===t&&(t=!0),!(this.SceneList.length<1)){var o=this.SceneList[1],i=this.tagList[1],a=this.typeList[1];f.G.UIManager.LoadScene(o,i,a,e,t)}},t.prototype.addMask=function(e,t,o){void 0===o&&(o=null);var i=t+"_MASK";if(!this.popNode.getChildByName(i)){var a=new cc.Node;a.addComponent(cc.BlockInputEvents),a.addComponent(cc.Sprite).spriteFrame=f.G.mask,this.popNode.addChild(a);var n=cc.winSize;a.zIndex=this.popNodezIndex,a.setAnchorPoint(0,0),a.setPosition(0,0),a.setContentSize(n),a.opacity=GameConfigInt.CONFIG_LAYER_POPLAYER_OPACITY,a.name=i,a.on("touchend",function(){var o=e.getComponentInChildren(C.PopLayerInterface);o&&o.touchLayer(),o&&o.m_popType==C.POPLYAERSTATE.POPLYAERSTATE_CHEEK?f.G.UIManager.popPopNode(t):o&&o.m_popType==C.POPLYAERSTATE.POPLYAERSTATE_OPER&&o.touchLayer},a)}},t.prototype.removeMask=function(e){var t=e+"_MASK",o=this.popNode.getChildByName(t);o&&(this.popNode.removeChild(o),o.destroy())},t.prototype.getMask=function(e){var t=e+"_MASK";return this.popNode.getChildByName(t)},t.prototype.pushPopNode=function(e,t){var o=this.popNode.getChildByName(t+"");if(!cc.isValid(o,!0)){this.popNode.addChild(e,this.popNodezIndex),e.name=t+"";var i=e.getComponentInChildren(C.PopLayerInterface);if(i)if(v.setTouchEnabled(!1),i.isZoomAnimation)e.stopAllActions(),e.setScale(0),e.runAction(cc.sequence(cc.scaleTo(.2,1.1),cc.scaleTo(.1,1),cc.callFunc(i.actionFinished,i))),setTimeout(function(){v.setTouchEnabled(!0)},310);else if(i.isLeftAnimation){e.setPosition(-e.getContentSize().width,e.getPosition().y);var a=cc.sequence(cc.moveBy(.2,cc.v2(cc.winSize.width,0)),cc.callFunc(i.actionFinished,i));e.runAction(a),setTimeout(function(){v.setTouchEnabled(!0)},210)}else i.isRightAnimation?(e.setPosition(e.getContentSize().width),a=cc.sequence(cc.moveBy(.2,cc.v2(-cc.winSize.width,0)),cc.callFunc(i.actionFinished,i)),e.runAction(a),setTimeout(function(){v.setTouchEnabled(!0)},210)):setTimeout(function(){v.setTouchEnabled(!0)},10);this.popNodezIndex++}},t.prototype.pushFullScreenPopNode=function(e,t){var o=this.fullScreenPopNode.getChildByName(t+"");if(!cc.isValid(o,!0)){var i=new cc.Node;i.addComponent(cc.BlockInputEvents),e.addChild(i,-1);var a=cc.winSize;i.setAnchorPoint(0,0),i.setPosition(0,0),i.setContentSize(a),this.fullScreenPopNode.addChild(e,this.fullScreenPopNodeIndex),this.fullScreenPopNodeIndex++,e.name=t+""}},t.prototype.popPopNode=function(e){console.log("release asset "+cc.assetManager.assets.count),this.garbageCollect++>20&&(cc.sys.garbageCollect(),this.garbageCollect=0);var t=this.popNode.getChildByName(e+"");if(t||(t=this.fullScreenPopNode.getChildByName(e+"")),t){if(t.getActionByTag(100))return;var o=this,i=function(){o.recyclePopLayer(t),o.removeMask(e),o.resetzIndex(),c.ReconnectLayer==e&&(o.popNode.zIndex=0),g.ClientNetwork.getInstance().pushLocalMessage(m.LOCAL_MESSAGE.LocalMsg_ClosePopLayer,e)},a=t.getComponentInChildren(C.PopLayerInterface);if(a&&(a.onClose(),!0===a.isZoomAnimation)){var n=new Array;n.push(cc.scaleTo(.1,1.2)),n.push(cc.scaleTo(.2,0)),n.push(cc.callFunc(i,t)),t.setScale(1),t.stopAllActions();var r=cc.sequence(n);return r.setTag(100),void t.runAction(r)}i()}},t.prototype.resetzIndex=function(){this.popNode.childrenCount<=0&&(this.popNodezIndex=0),this.fullScreenPopNode.childrenCount<=0&&(this.fullScreenPopNodeIndex=0)},t.prototype.clearAllPopNode=function(){this.clearAllChildren(this.popNode.children)},t.prototype.clearAllFullScreenPopNode=function(){this.clearAllChildren(this.fullScreenPopNode.children)},t.prototype.clearAllChildren=function(e){for(;null!=e&&e.length>0;)this.recyclePopLayer(e[0])},t.prototype.getRunningScene=function(){return cc.director.getScene()},t.prototype.showRootTopNode=function(e){var t=cc.director.getScene().getChildByName(R.RootNodeName_Top);t&&(t.active=e)},t.prototype.getRootTopNode=function(){return cc.director.getScene().getChildByName(R.RootNodeName_Top)},t.prototype.hasChild=function(e){var t=this.popNode.getChildByName(e+"");return!!t||!!(t=this.fullScreenPopNode.getChildByName(e+""))},t.prototype.getPopNode=function(e){var t=this.popNode.getChildByName(e+"");return t||this.fullScreenPopNode.getChildByName(e+"")},t.prototype.getNormalPopNode=function(){return this.popNode},t.prototype.getFullScreenPopNode=function(){return this.fullScreenPopNode},t.prototype.hasPopNode=function(){var e=this.popNode.childrenCount,t=this.fullScreenPopNode.childrenCount;return e>0||t>0},t.prototype.setAnchorPoint=function(e,t,o){var i=(t-e.anchorX)*e.width,a=(o-e.anchorY)*e.height;e.x+=i,e.y+=a;for(var n=0,r=e.children;n<r.length;n++){var s=r[n];s.x-=i,s.y-=a}e.setAnchorPoint(new cc.Vec2(t,o))},t.prototype.isFinghtingScene=function(){var e=f.G.UIManager.getCurSceneTag();return e==d.PvpFightScene||e==d.PveFightScene},t.prototype.getPoplayerNode=function(e){return this._popnodeCache.getNode(e)},t.prototype.recyclePopLayer=function(e){var t=e.getComponentInChildren(C.PopLayerInterface);t||(t=e.getComponent(C.PopLayerInterface)),t?this._popnodeCache.recycleNode(e):(e.destroy(),e.removeFromParent(!0))},t.prototype.showPopLayer=function(e,t,o,i,a,n){return void 0===t&&(t=!0),void 0===o&&(o=!0),void 0===i&&(i=c.NONE),void 0===a&&(a=p.Normal),void 0===n&&(n={isLeftAnimation:!1,isRightAnimation:!1,isZoomAnimation:!0,m_popType:C.POPLYAERSTATE.POPLYAERSTATE_CHEEK}),r(this,void 0,Promise,function(){var r,l,d,u,h;return s(this,function(s){switch(s.label){case 0:return(r=f.G.UIManager.getPopNode(i))&&(console.log("already has this ui, tag = "+i),this.recyclePopLayer(r),this.removeMask(i),this.resetzIndex()),i==c.NONE&&cc.error("!!! Tag not -1"),(l=this.getPoplayerNode(i))?[3,4]:(d=void 0,u=void 0,"string"!=typeof e?[3,2]:(d=e,[4,v.LoadResAsync(e,cc.Prefab,!1,function(){})]));case 1:return u=s.sent(),[3,3];case 2:d=e.url&&e.url.length>0?e.url:e.name,u=e,s.label=3;case 3:if(console.log(d),!u)return[2,null];l=cc.instantiate(u),s.label=4;case 4:return l.parent=null,l.name=i.toString(),o&&f.G.UIManager.setAnchorPoint(l,.5,.5),(h=l.getComponentInChildren(C.PopLayerInterface))&&(h.isLeftAnimation=n.isLeftAnimation,h.isRightAnimation=n.isRightAnimation,h.isZoomAnimation=n.isZoomAnimation,h.m_popType=n.m_popType,h.setTag(i)),t&&(a==p.Normal?f.G.UIManager.pushPopNode(l,i):a==p.FullScreen&&f.G.UIManager.pushFullScreenPopNode(l,i)),l.width=cc.winSize.width,l.height=cc.winSize.height,c.ReconnectLayer==i&&(this.popNode.zIndex=L.GMZ_FLYWORD+1),[2,l]}})})},t.prototype.updateBtnWithMain=function(){cc.director.getScene(),this.getCurSceneTag(),d.MainScene},t.prototype.setCanCachPopTag=function(){},t.isAppEnterHideShow=!1,n([M(cc.Node)],t.prototype,"poplayerCacheNode",void 0),o=n([D],t)}(cc.Component);o.UIManager=B,cc._RF.pop()},{"../Global/GameGlobal":"GameGlobal","../modules/base/GameView":"GameView","../modules/manager/ViewManager":"ViewManager","../network/ClientNetwork":"ClientNetwork","../network/LocalMessage":"LocalMessage","../network/ReconnectLayer":"ReconnectLayer","./ConfigInt":"ConfigInt","./GameLoading":"GameLoading","./GameUtils":"GameUtils","./ResourceLoader":"ResourceLoader","./ResourcesManager":"ResourcesManager","./subUtils/PopLayer":"PopLayer","./subUtils/SingleNodeCache":"SingleNodeCache","./subUtils/SpineMaker":"SpineMaker","./subUtils/WaitingLayer":"WaitingLayer"}],UISuperItem:[function(e,t,o){"use strict";cc._RF.push(t,"05ad9vH0ANAc6m/Oc1rzygv","UISuperItem");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("./UISuperLayout"),s=cc._decorator,c=s.ccclass,l=(s.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),Object.defineProperty(t.prototype,"width",{get:function(){return this.layout.vertical?(this.layout.accommodWidth-this.layout.spacingWidth)/this.layout.column:this.node.width*this.layout.getUsedScaleValue(this.node.scaleX)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.layout.horizontal?(this.layout.accommodHeight-this.layout.spacingWidth)/this.layout.column:this.node.height*this.layout.getUsedScaleValue(this.node.scaleY)},enumerable:!1,configurable:!0}),t.prototype.onLoad=function(){this.node.watchSelf=this.watchSelf.bind(this),this.node.saveOriginSize=this.saveOriginSize.bind(this);var e=this.node.getComponent(cc.Widget);e&&(cc.warn("UISuperItem: item\u4e0d\u5141\u8bb8\u6302cc.Widget\u7ec4\u4ef6 \u8bf7\u624b\u52a8\u79fb\u9664"),this.node.removeComponent(e))},t.prototype.saveOriginSize=function(){this.originSize=cc.size(this.width,this.height),this.node.setContentSize(this.originSize),this.originScale=cc.v2(this.node.scaleX,this.node.scaleY)},t.prototype.init=function(e){this.layout=e,this.layout.node.on(r.UIChangeBrotherEvnet,this.onChangeBrother,this),this.saveOriginSize(),this.node.on(cc.Node.EventType.SIZE_CHANGED,this.watchSize,this),this.node.on(cc.Node.EventType.SCALE_CHANGED,this.watchSize,this),this.onChangeBrother()},t.prototype.onDestroy=function(){this.layout.node.off(r.UIChangeBrotherEvnet,this.onChangeBrother,this),this.node.off(cc.Node.EventType.SIZE_CHANGED,this.watchSize,this),this.node.off(cc.Node.EventType.SCALE_CHANGED,this.watchSize,this),this.unlisten()},t.prototype.onChangeBrother=function(){var e,t=this.layout.getBrotherNode(this.node);(null==t?void 0:t.uuid)!=(null===(e=this.brother)||void 0===e?void 0:e.uuid)&&(this.unlisten(),this.brother=t,this.listen(),this.watchBrother())},t.prototype.listen=function(){var e,t;null===(e=this.brother)||void 0===e||e.on("leave",this.unlisten,this),null===(t=this.brother)||void 0===t||t.on(cc.Node.EventType.POSITION_CHANGED,this.watchBrother,this)},t.prototype.unlisten=function(){var e,t;null===(e=this.brother)||void 0===e||e.off("leave",this.unlisten,this),null===(t=this.brother)||void 0===t||t.off(cc.Node.EventType.POSITION_CHANGED,this.watchBrother,this),this.brother=null},t.prototype.watchSize=function(){this.layout.column>1?(this.node.setContentSize(this.originSize),this.node.setScale(this.originScale)):(!this.layout.vertical||this.node.getContentSize().width==this.originSize.width&&this.node.scaleX==this.originScale.x?!this.layout.horizontal||this.node.getContentSize().height==this.originSize.height&&this.node.scaleY==this.originScale.y||(cc.warn("\u6c34\u5e73\u6392\u5217\u4e0d\u5141\u8bb8\u4fee\u6539\u3010\u9ad8\u5ea6\u3011"),this.node.height=this.originSize.height,this.node.scaleY=this.originScale.y):(cc.warn("\u5782\u76f4\u6392\u5217\u4e0d\u5141\u8bb8\u4fee\u6539\u3010\u5bbd\u5ea6\u3011"),this.node.width=this.originSize.width,this.node.scaleX=this.originScale.x),this.brother&&this.watchBrother(),this.layout.resetScrollView(),this.node.emit(cc.Node.EventType.POSITION_CHANGED)),0==this.node.index&&this.layout.isNormalSize&&this.node.setPosition(this.layout.getGroupHeader(this.node))},t.prototype.watchBrother=function(){this.brother&&(this.layout.headerToFooter?this.headerToFooterRelativeToFooter(this.brother):this.footerToHeaderRelativeToFooter(this.brother))},t.prototype.isOutOfBoundary=function(e){return!(!this.layout.vertical||0!=e.y)||!(!this.layout.horizontal||0!=e.x)},t.prototype.footerToHeaderWatchHeader=function(){if(!(this.layout.getSiblingIndex(this.node)>=this.layout.column)){var e=this.layout.footer.index+1;if(e>=this.layout.maxItemTotal){if(!this.layout.footerLoop||this.layout.scrollToHeaderOrFooter)return;e=0}var t=this.layout.isOutOfBoundaryFooter(this.node);this.isOutOfBoundary(t)&&(this.node.index=e,this.layout.notifyRefreshItem(this.node),this.node.emit("leave"),this.layout.setSiblingIndex(this.node,this.layout.children.length-1))}},t.prototype.footerToHeaderWatchFooter=function(){if(!(this.layout.getSiblingIndex(this.node)<this.layout.children.length-this.layout.column)){var e=this.layout.header.index-1;if(e<0){if(!this.layout.headerLoop||this.layout.scrollToHeaderOrFooter)return;e=this.node.index}var t=this.layout.isOutOfBoundaryHeader(this.node);this.isOutOfBoundary(t)&&(this.node.index=e,this.layout.notifyRefreshItem(this.node),this.node.emit("leave"),this.unlisten(),this.footerToHeaderRelativeToHeader(this.layout.header),this.layout.setSiblingIndex(this.node,0))}},t.prototype.headerToFooterWatchHeader=function(){if(!(this.layout.getSiblingIndex(this.node)>=this.layout.column)){var e=this.layout.footer.index+1;if(e>this.layout.maxItemTotal-1){if(!this.layout.footerLoop||this.layout.scrollToHeaderOrFooter)return;e=0}var t=this.layout.isOutOfBoundaryHeader(this.node);this.isOutOfBoundary(t)&&(this.node.index=e,this.layout.notifyRefreshItem(this.node),this.node.emit("leave"),this.layout.setSiblingIndex(this.node,this.layout.children.length-1))}},t.prototype.headerToFooterWatchFooter=function(){if(!(this.layout.getSiblingIndex(this.node)<this.layout.children.length-this.layout.column)){var e=this.layout.header.index-1;if(e<0){if(!this.layout.headerLoop||this.layout.scrollToHeaderOrFooter)return;e=this.node.index}var t=this.layout.isOutOfBoundaryFooter(this.node);this.isOutOfBoundary(t)&&(this.node.index=e,this.layout.notifyRefreshItem(this.node),this.node.emit("leave"),this.unlisten(),this.headerToFooterRelativeToHeader(this.layout.header),this.layout.setSiblingIndex(this.node,0))}},t.prototype.watchSelf=function(e){e?this.layout.headerToFooter?this.headerToFooterWatchFooter():this.footerToHeaderWatchHeader():this.layout.headerToFooter?this.headerToFooterWatchHeader():this.footerToHeaderWatchFooter()},t.prototype.footerToHeaderRelativeToHeader=function(e){var t=this.node.getPosition();this.layout.vertical?(this.layout.isGroupHeader(e)?(t.x=this.layout.getGroupFooter(this.node).x,t.y=this.layout.getGroupBottomY(this.node,e)):(t.x=this.layout.getGroupLeftX(this.node,e),t.y=e.y),0==this.node.index&&(t.x=this.layout.getGroupHeader(this.node).x)):(this.layout.isGroupHeader(e)?(t.x=this.layout.getGroupRightX(this.node,e),t.y=this.layout.getGroupFooter(this.node).y):(t.x=e.x,t.y=this.layout.getGroupTopY(this.node,e)),0==this.node.index&&(t.y=this.layout.getGroupHeader(this.node).y)),this.node.setPosition(t)},t.prototype.footerToHeaderRelativeToFooter=function(e){var t=this.node.getPosition();this.layout.vertical?this.layout.isGroupFooter(e)?(t.x=this.layout.getGroupHeader(this.node).x,t.y=this.layout.getGroupTopY(this.node,e)):(t.x=this.layout.getGroupRightX(this.node,e),t.y=e.y):this.layout.isGroupFooter(e)?(t.x=this.layout.getGroupLeftX(this.node,e),t.y=this.layout.getGroupHeader(this.node).y):(t.x=e.x,t.y=this.layout.getGroupBottomY(this.node,e)),this.node.setPosition(t)},t.prototype.headerToFooterRelativeToHeader=function(e){var t=this.node.getPosition();this.layout.vertical?(this.layout.isGroupHeader(e)?(t.x=this.layout.getGroupFooter(this.node).x,t.y=this.layout.getGroupTopY(this.node,e)):(t.x=this.layout.getGroupLeftX(this.node,e),t.y=e.y),0==this.node.index&&(t.x=this.layout.getGroupHeader(this.node).x)):(this.layout.isGroupHeader(e)?(t.x=this.layout.getGroupLeftX(this.node,e),t.y=this.layout.getGroupFooter(this.node).y):(t.x=e.x,t.y=this.layout.getGroupTopY(this.node,e)),0==this.node.index&&(t.y=this.layout.getGroupHeader(this.node).y)),this.node.setPosition(t)},t.prototype.headerToFooterRelativeToFooter=function(e){var t=this.node.getPosition();this.layout.vertical?this.layout.isGroupFooter(e)?(t.x=this.layout.getGroupHeader(this.node).x,t.y=this.layout.getGroupBottomY(this.node,e)):(t.x=this.layout.getGroupRightX(this.node,e),t.y=e.y):this.layout.isGroupFooter(e)?(t.x=this.layout.getGroupRightX(this.node,e),t.y=this.layout.getGroupHeader(this.node).y):(t.x=e.x,t.y=this.layout.getGroupBottomY(this.node,e)),this.node.setPosition(t)},n([c],t)}(cc.Component));o.default=l,cc._RF.pop()},{"./UISuperLayout":"UISuperLayout"}],UISuperLayout:[function(e,t,o){"use strict";cc._RF.push(t,"699eb1xVINCcZBBHwAgwDBT","UISuperLayout");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r},r=this&&this.__awaiter||function(e,t,o,i){return new(o||(o=Promise))(function(a,n){function r(e){try{c(i.next(e))}catch(t){n(t)}}function s(e){try{c(i.throw(e))}catch(t){n(t)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(r,s)}c((i=i.apply(e,t||[])).next())})},s=this&&this.__generator||function(e,t){var o,i,a,n,r={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return n={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function s(e){return function(t){return c([e,t])}}function c(n){if(o)throw new TypeError("Generator is already executing.");for(;r;)try{if(o=1,i&&(a=2&n[0]?i.return:n[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return r.label++,{value:n[1],done:!1};case 5:r.label++,i=n[1],n=[0];continue;case 7:n=r.ops.pop(),r.trys.pop();continue;default:if(!(a=(a=r.trys).length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){r=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){r.label=n[1];break}if(6===n[0]&&r.label<a[1]){r.label=a[1],a=n;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(n);break}a[2]&&r.ops.pop(),r.trys.pop();continue}n=t.call(e,r)}catch(s){n=[6,s],i=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}},c=this&&this.__spreadArrays||function(){for(var e=0,t=0,o=arguments.length;t<o;t++)e+=arguments[t].length;var i=Array(e),a=0;for(t=0;t<o;t++)for(var n=arguments[t],r=0,s=n.length;r<s;r++,a++)i[a]=n[r];return i};Object.defineProperty(o,"__esModule",{value:!0}),o.UISuperDirection=o.UISuperAxis=o.UIChangeBrotherEvnet=void 0;var l,d,u=e("./UISuperScrollView"),h=e("./UISuperItem"),p=cc._decorator,f=p.ccclass,g=p.property;o.UIChangeBrotherEvnet="UIChangeBrotherEvnet",function(e){e[e.HORIZONTAL=0]="HORIZONTAL",e[e.VERTICAL=1]="VERTICAL"}(l=o.UISuperAxis||(o.UISuperAxis={})),function(e){e[e.HEADER_TO_FOOTER=0]="HEADER_TO_FOOTER",e[e.FOOTER_TO_HEADER=1]="FOOTER_TO_HEADER"}(d=o.UISuperDirection||(o.UISuperDirection={}));var m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.startAxis=l.VERTICAL,t.direction=d.HEADER_TO_FOOTER,t.paddingTop=0,t.paddingBottom=0,t.paddingLeft=0,t.paddingRight=0,t.spacing=cc.Vec2.ZERO,t.column=2,t.multiple=2,t.prefab=null,t.headerLoop=!1,t.footerLoop=!1,t.affectedByScale=!0,t.refreshItemEvents=[],t._isinited=!1,t._maxPrefabTotal=0,t._children=[],t._scrollView=null,t._maxItemTotal=0,t._prevLayoutPosition=cc.Vec2.ZERO,t.scrollToHeaderOrFooter=!1,t}return a(t,e),Object.defineProperty(t.prototype,"layoutDirection",{get:function(){var e=cc.Vec2.ZERO;return this.vertical?e.y=this.node.y-this._prevLayoutPosition.y:e.x=this.node.x-this._prevLayoutPosition.x,this._prevLayoutPosition=this.node.getPosition(),e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isScrollToFooter",{get:function(){return this.vertical?this.layoutDirection.y<0:this.layoutDirection.x>0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"children",{get:function(){return this._children},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxItemTotal",{get:function(){return this._maxItemTotal},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxPrefabTotal",{get:function(){return this._maxPrefabTotal},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"viewSize",{get:function(){return this.scrollView.view.getContentSize()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"vertical",{get:function(){return this.startAxis==l.VERTICAL},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"horizontal",{get:function(){return this.startAxis==l.HORIZONTAL},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"headerToFooter",{get:function(){return this.direction==d.HEADER_TO_FOOTER},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"footerToHeader",{get:function(){return this.direction==d.FOOTER_TO_HEADER},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"spacingWidth",{get:function(){return this.spacing.x*(this.column-1)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"spacingHeight",{get:function(){return this.spacing.y*(this.column-1)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"accommodWidth",{get:function(){return this.viewSize.width-this.paddingLeft-this.paddingRight},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"accommodHeight",{get:function(){return this.viewSize.height-this.paddingTop-this.paddingBottom},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scrollView",{get:function(){return this._scrollView||(this._scrollView=this.node.parent.parent.getComponent(u.default)),this._scrollView},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"header",{get:function(){return this._children[0]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"footer",{get:function(){return this._children[this._children.length-1]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"topBoundary",{get:function(){return this.headerToFooter?this.headerBoundaryY+this.paddingTop:this.footerBoundaryY+this.paddingTop},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bottomBoundary",{get:function(){return this.headerToFooter?this.footerBoundaryY-this.paddingBottom:this.headerBoundaryY-this.paddingBottom},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"leftBoundary",{get:function(){return this.headerToFooter?this.headerBoundaryX-this.paddingLeft:this.footerBoundaryX-this.paddingLeft},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rightBoundary",{get:function(){return this.headerToFooter?this.footerBoundaryX+this.paddingRight:this.headerBoundaryX+this.paddingRight},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"headerBoundaryX",{get:function(){return this.headerToFooter?this.node.x+this.header.x-this.header.anchorX*this.getScaleWidth(this.header):this.node.x+this.header.x+(1-this.header.anchorX)*this.getScaleWidth(this.header)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"headerBoundaryY",{get:function(){return this.headerToFooter?this.node.y+this.header.y+(1-this.header.anchorY)*this.getScaleHeight(this.header):this.node.y+this.header.y-this.header.anchorY*this.getScaleHeight(this.header)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"footerBoundaryX",{get:function(){return this.headerToFooter?this.node.x+this.footer.x+(1-this.footer.anchorX)*this.getScaleWidth(this.footer):this.node.x+this.footer.x-this.footer.anchorX*this.getScaleWidth(this.footer)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"footerBoundaryY",{get:function(){return this.headerToFooter?this.node.y+this.footer.y-this.footer.anchorY*this.getScaleHeight(this.footer):this.node.y+this.footer.y+(1-this.footer.anchorY)*this.getScaleHeight(this.footer)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isNormalSize",{get:function(){return this.node.getContentSize().equals(this.viewSize)},enumerable:!1,configurable:!0}),t.prototype.getContentSize=function(){var e=this.getReallySize(),t=this.scrollView.view.getContentSize();return e.height<t.height&&(e.height=t.height),e.width<t.width&&(e.width=t.width),e},t.prototype.getReallySize=function(){if(0==this.node.childrenCount)return this.viewSize;var e=cc.Size.ZERO;return this.headerToFooter?(e.width=this.footerBoundaryX+-this.headerBoundaryX+this.paddingLeft+this.paddingRight,e.height=this.headerBoundaryY+-this.footerBoundaryY+this.paddingTop+this.paddingBottom):(e.width=this.headerBoundaryX+-this.footerBoundaryX+this.paddingLeft+this.paddingRight,e.height=this.footerBoundaryY+-this.headerBoundaryY+this.paddingTop+this.paddingBottom),e},t.prototype.resetScrollView=function(){this.scrollView.reset()},t.prototype.getUsedScaleValue=function(e){return this.affectedByScale?Math.abs(e):1},t.prototype.total=function(e,t){return void 0===t&&(t=null),r(this,void 0,void 0,function(){var o,i;return s(this,function(a){switch(a.label){case 0:return this.scrollView.stopAutoScroll(),this.scrollView.release(),this.initlized(),[4,this.asyncCreateItem(e,t)];case 1:return a.sent(),o=this.getDataOffset(e),i=this.getReallyOffset(o),this.refreshItems(e,i),this._maxItemTotal=e,[2]}})})},t.prototype.getBrotherNode=function(e){var t=this.getSiblingIndex(e)-1;return this._children[t]},t.prototype.isGroupHeader=function(e){var t=this.getGroupHeader(e),o=this.vertical?cc.v2(t.x,0):cc.v2(0,t.y);return(this.vertical?cc.v2(e.x,0):cc.v2(0,e.y)).fuzzyEquals(o,1e-4)},t.prototype.isGroupFooter=function(e){var t=this.getGroupFooter(e),o=this.vertical?cc.v2(t.x,0):cc.v2(0,t.y);return(this.vertical?cc.v2(e.x,0):cc.v2(0,e.y)).fuzzyEquals(o,1e-4)},t.prototype.getGroupHeader=function(e){var t=cc.Vec2.ZERO;return e?(this.vertical?this.headerToFooter?(t.x=e.anchorX*this.getScaleWidth(e)+this.paddingLeft*e.scaleX-this.node.anchorX*this.viewSize.width*e.scaleX,t.y=(1-e.anchorY)*-this.getScaleHeight(e)-this.paddingTop+(1-this.node.anchorY)*this.viewSize.height):(t.x=e.anchorX*this.getScaleWidth(e)+this.paddingLeft-this.node.anchorX*this.viewSize.width,t.y=e.anchorY*this.getScaleHeight(e)+this.paddingBottom-this.node.anchorY*this.viewSize.height):this.headerToFooter?(t.x=e.anchorX*this.getScaleWidth(e)+this.paddingLeft-this.node.anchorX*this.viewSize.width,t.y=(1-e.anchorY)*-e.height-this.paddingTop+(1-this.node.anchorY)*this.viewSize.height):(t.x=this.accommodWidth*this.node.anchorX-this.getScaleWidth(e)*(1-e.anchorX),t.y=(1-e.anchorY)*-e.height-this.paddingTop+(1-this.node.anchorY)*this.viewSize.height),t):t},t.prototype.getGroupFooter=function(e){var t=cc.Vec2.ZERO;return e?(this.vertical?(t.x=(this.accommodWidth+this.paddingLeft)*this.node.anchorX-(this.getScaleWidth(e)*(1-e.anchorX)+this.node.anchorX*this.paddingRight),t.y=e.y):(t.x=e.x,t.y=-((this.accommodHeight+this.paddingTop)*this.node.anchorY-this.getScaleHeight(e)*e.anchorY)+(1-e.anchorY)*this.paddingBottom),t):t},t.prototype.getGroupRightX=function(e,t){return e&&t?t.x+this.getScaleWidth(t)*(1-t.anchorX)+this.getScaleWidth(e)*e.anchorX+this.spacing.x:this.getGroupHeader(e).x},t.prototype.getGroupLeftX=function(e,t){return e&&t?t.x-this.getScaleWidth(t)*t.anchorX-this.getScaleWidth(e)*(1-e.anchorX)-this.spacing.x:this.getGroupFooter(e).x},t.prototype.getGroupBottomY=function(e,t){return t.y-this.getScaleHeight(t)*t.anchorY-this.getScaleHeight(e)*(1-e.anchorY)-this.spacing.y},t.prototype.getGroupTopY=function(e,t){return t.y+this.getScaleHeight(t)*(1-t.anchorY)+this.getScaleHeight(e)*e.anchorY+this.spacing.y},t.prototype.isOutOfBoundaryHeader=function(e,t){void 0===t&&(t=1.5);var o=e.width*this.getUsedScaleValue(e.scaleX)*t,i=-e.height*this.getUsedScaleValue(e.scaleY)*t;return this.scrollView.getHowMuchOutOfBoundary(cc.v2(o,i))},t.prototype.isOutOfBoundaryFooter=function(e,t){void 0===t&&(t=1.5);var o=-e.width*this.getUsedScaleValue(e.scaleX)*t,i=e.height*this.getUsedScaleValue(e.scaleY)*t;return this.scrollView.getHowMuchOutOfBoundary(cc.v2(o,i))},t.prototype.scrollToHeader=function(e,t){this.scrollToHeaderOrFooter=e>0,this.scrollView.stopAutoScroll(),this.scrollView.isTouch=!1,this.resetToHeader(),this.headerToFooter?this.vertical?this.scrollView.scrollToTop(e,t):this.scrollView.scrollToLeft(e,t):this.vertical?this.scrollView.scrollToBottom(e,t):this.scrollView.scrollToRight(e,t)},t.prototype.scrollToFooter=function(e,t){this.scrollToHeaderOrFooter=e>0,this.scrollView.stopAutoScroll(),this.scrollView.isTouch=!1,this.resetToFooter(),this.headerToFooter?this.vertical?this.scrollView.scrollToBottom(e,t):this.scrollView.scrollToRight(e,t):this.vertical?this.scrollView.scrollToTop(e,t):this.scrollView.scrollToLeft(e,t)},t.prototype.notifyRefreshItem=function(e){cc.Component.EventHandler.emitEvents(this.refreshItemEvents,e,e.index)},t.prototype.getSiblingIndex=function(e){return this._children.indexOf(e)},t.prototype.setSiblingIndex=function(e,t){t=-1!==t?t:this._children.length-1;var i=this._children.indexOf(e);t!==i&&(this._children.splice(i,1),t<this._children.length?this._children.splice(t,0,e):this._children.push(e),this.node.emit(o.UIChangeBrotherEvnet))},t.prototype.onLoad=function(){this.initlized()},t.prototype.initlized=function(){this._isinited||(this.node.anchorX=.5,this.node.anchorY=.5,this.node.setContentSize(this.viewSize),this.node.getContentSize=this.getContentSize.bind(this),this.node.setPosition(cc.Vec2.ZERO),this.column=this.column<1?1:this.column,this.node.on(cc.Node.EventType.POSITION_CHANGED,this.onChangePosition,this),this.scrollView.view.on(cc.Node.EventType.SIZE_CHANGED,this.resetItemSize,this),this._isinited=!0)},t.prototype.onDestroy=function(){this.node.off(cc.Node.EventType.POSITION_CHANGED,this.onChangePosition,this),this.scrollView.view.off(cc.Node.EventType.SIZE_CHANGED,this.resetItemSize,this)},t.prototype.onChangePosition=function(){var e=this.isScrollToFooter;this.headerToFooter?e?this.footerToHeaderWatchChilds(e):this.headerToFooterWatchChilds(e):e?this.headerToFooterWatchChilds(e):this.footerToHeaderWatchChilds(e),(this.vertical&&0==this.node.y||this.horizontal&&0==this.node.x)&&this.header&&this.header.setPosition(this.getGroupHeader(this.header))},t.prototype.resetItemSize=function(){for(var e=0;e<this.children.length;e++)this.children[e].saveOriginSize();var t=this.getGroupHeader(this.header);for(this.vertical?this.header.x=t.x:this.header.y=t.y,e=0;e<this.children.length;e++)this.children[e].emit(cc.Node.EventType.POSITION_CHANGED)},t.prototype.getScaleWidth=function(e){return e.width*this.getUsedScaleValue(e.scaleX)},t.prototype.getScaleHeight=function(e){return e.height*this.getUsedScaleValue(e.scaleY)},t.prototype.getTempChildren=function(){for(var e=[],t=0;t<this._children.length;t++){var o=this._children[t];e.push(o)}return e},t.prototype.headerToFooterWatchChilds=function(e){for(var t=this.getTempChildren(),o=0;o<t.length;o++){var i=t[o];"function"==typeof i.watchSelf&&i.watchSelf(e)}},t.prototype.footerToHeaderWatchChilds=function(e){for(var t=this.getTempChildren(),o=t.length-1;o>=0;o--){var i=t[o];"function"==typeof i.watchSelf&&i.watchSelf(e)}},t.prototype.getDataOffset=function(e){if(this.footer&&this.footer.index+1>=e){var t=this.footer.index+1-e;return 0==t?0:-t}return 0==this._maxItemTotal||e<this._maxItemTotal||this._maxItemTotal<this._maxPrefabTotal?0:this.isGroupFooter(this.footer)?0:e-this._maxItemTotal},t.prototype.getReallyOffset=function(e){if(!this.header)return 0;if(e>0){for(var t=0;t<e;t++){if(this.isGroupFooter(this.footer))return t;var o=this.header.getPosition();this.vertical?this.isGroupFooter(this.header)?(this.headerToFooter?o.y=this.getGroupBottomY(this.header,this.header):o.y=this.getGroupTopY(this.header,this.header),o.x=this.getGroupHeader(this.header).x):o.x=this.getGroupRightX(this.header,this.header):this.isGroupFooter(this.header)?(this.headerToFooter?o.x=this.getGroupRightX(this.header,this.header):o.x=this.getGroupLeftX(this.header,this.header),o.y=this.getGroupHeader(this.header).y):o.y=this.getGroupBottomY(this.header,this.header),this.header.setPosition(o)}return e}for(t=0;t<Math.abs(e);t++)o=cc.Vec2.ZERO,this.vertical?this.isGroupHeader(this.header)?(o.x=this.getGroupFooter(this.header).x,this.headerToFooter?o.y=this.getGroupTopY(this.header,this.header):o.y=this.getGroupBottomY(this.header,this.header)):(o.x=this.getGroupLeftX(this.header,this.header),o.y=this.header.y):this.isGroupHeader(this.header)?(o.y=this.getGroupFooter(this.header).y,this.headerToFooter?o.x=this.getGroupLeftX(this.header,this.header):o.x=this.getGroupRightX(this.header,this.header)):(o.y=this.getGroupTopY(this.header,this.header),o.x=this.header.x),this.header.setPosition(o);return this.scrollView.calculateBoundary(),e},t.prototype.refreshItems=function(e,t){if(void 0===t&&(t=0),this.header)for(var o=this.header.index-1+t,i=0;i<this._children.length;i++){var a=this._children[i];++o>e-1?o=0:o<0&&(o=e-1),a.index=o,this.notifyRefreshItem(a)}},t.prototype.resetToHeader=function(){for(var e,t,o=0;o<this._children.length;o++){var i=this._children[o];i.index=o,this.notifyRefreshItem(i)}this.headerLoop||this.footerLoop?this.scrollToHeaderOrFooter||null===(t=this.header)||void 0===t||t.setPosition(this.getGroupHeader(this.header)):null===(e=this.header)||void 0===e||e.setPosition(this.getGroupHeader(this.header))},t.prototype.resetToFooter=function(){for(var e=this._maxItemTotal,t=this._children.length-1;t>=0;t--){var o=this._children[t];o.index=--e,this.notifyRefreshItem(o)}},t.prototype.removeChilds=function(e){for(var t=this.node.childrenCount-e,o=0;o<t;o++){var i=this.footer;this.remChild(i),i.destroy(),this.node.removeChild(i)}if(this.header){var a=this.getGroupHeader(this.header);this.vertical?this.header.x=a.x:this.header.y=a.y}},t.prototype.asyncCreateItem=function(e,t){var o;return r(this,void 0,void 0,function(){var i,a=this;return s(this,function(n){switch(n.label){case 0:return null===(o=this._gener)||void 0===o||o.return(""),this.node.childrenCount>e?[2,this.removeChilds(e)]:this._maxPrefabTotal>0&&this._maxPrefabTotal==this.node.childrenCount?[2]:(i=e-this.node.childrenCount,this._gener=this.getGeneratorLength(i,function(){var o=cc.instantiate(a.prefab);o.index=a.node.childrenCount,a.addChild(o);var i,n,r=o.getComponent(h.default)||o.addComponent(h.default);if(a.node.addChild(o),r.init(a),a.notifyRefreshItem(o),1==a.node.childrenCount){var s=a.getGroupHeader(a.header);a.header.setPosition(s),a.scrollView.calculateBoundary()}return a.vertical?(i=a.getReallySize().height,n=a.viewSize.height):(i=a.getReallySize().width,n=a.viewSize.width),t&&a.node.childrenCount==e&&t(),!(i>=n*a.multiple&&a.isGroupFooter(a.footer)&&(a._maxPrefabTotal=a.node.childrenCount,1))}),[4,this.exeGenerator(this._gener,10)]);case 1:return n.sent(),[2]}})})},t.prototype.addChild=function(e){this._children.push(e),this.node.emit(o.UIChangeBrotherEvnet)},t.prototype.remChild=function(e){var t=this._children.indexOf(e);-1!=t&&(this._children.splice(t,1),this.node.emit(o.UIChangeBrotherEvnet))},t.prototype.getGeneratorLength=function(e,t){var o,i,a=[];for(o=2;o<arguments.length;o++)a[o-2]=arguments[o];return s(this,function(o){switch(o.label){case 0:i=0,o.label=1;case 1:return i<e?t.apply(void 0,c([i],a))?[4]:[3,3]:[3,5];case 2:return o.sent(),[3,4];case 3:return[2];case 4:return i++,[3,1];case 5:return[2]}})},t.prototype.exeGenerator=function(e,t){return new Promise(function(o){var i=e,a=function(){for(var e=(new Date).getTime(),n=i.next();;n=i.next()){if(null==n||n.done)return void o(null);if((new Date).getTime()-e>t)return void setTimeout(function(){return a()},1e3*cc.director.getDeltaTime())}};a()})},n([g({type:cc.Enum(l),displayName:"\u6392\u5217\u65b9\u5411"})],t.prototype,"startAxis",void 0),n([g({type:cc.Enum(d),displayName:"\u6392\u5217\u5b50\u8282\u70b9\u7684\u65b9\u5411"})],t.prototype,"direction",void 0),n([g({displayName:"\u4e0a\u8fb9\u8ddd"})],t.prototype,"paddingTop",void 0),n([g({displayName:"\u4e0b\u8fb9\u8ddd"})],t.prototype,"paddingBottom",void 0),n([g({displayName:"\u5de6\u8fb9\u8ddd"})],t.prototype,"paddingLeft",void 0),n([g({displayName:"\u53f3\u8fb9\u8ddd"})],t.prototype,"paddingRight",void 0),n([g({displayName:"\u95f4\u9694"})],t.prototype,"spacing",void 0),n([g({displayName:"\u6bcf\u7ec4item\u4e2a\u6570",tooltip:"\u5355\u884c\u7684\u5217\u6570 \u6216 \u5355\u5217\u7684\u884c\u6570"})],t.prototype,"column",void 0),n([g({displayName:"item\u521b\u5efa\u500d\u7387",tooltip:"\u76f8\u5bf9\u4e8eview\u7684\u5c3a\u5bf8 \u9ed8\u8ba42\u500d"})],t.prototype,"multiple",void 0),n([g({type:cc.Prefab,displayName:"item Prefab"})],t.prototype,"prefab",void 0),n([g({displayName:"\u5934\u90e8\u6ed1\u52a8\u5faa\u73af"})],t.prototype,"headerLoop",void 0),n([g({displayName:"\u5c3e\u90e8\u6ed1\u52a8\u5faa\u73af"})],t.prototype,"footerLoop",void 0),n([g],t.prototype,"affectedByScale",void 0),n([g(cc.Component.EventHandler)],t.prototype,"refreshItemEvents",void 0),n([f],t)}(cc.Component);o.default=m,cc._RF.pop()},{"./UISuperItem":"UISuperItem","./UISuperScrollView":"UISuperScrollView"}],UISuperScrollView:[function(e,t,o){"use strict";cc._RF.push(t,"cf9af4O7wZKvocAG07bRvtr","UISuperScrollView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("./UISuperLayout"),s=cc._decorator,c=s.ccclass,l=s.property,d=s.menu,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.headerOutOffset=200,t.headerMultiple=2,t.footerOutOffset=200,t.footerMultiple=2,t.pullDownEvents=[],t.pullUpEvents=[],t.isMoveHeader=!1,t.isMoveFooter=!1,t.isLockHeader=!1,t.isLockFooter=!1,t.headerProgress=0,t.footerProgress=0,t._layout=null,t.lastoffsetY=0,t.isMoveBottom=!1,t.isMoveTop=!1,t.isScrollTop=!1,t.isScrollBottom=!1,t.isTouch=!1,t.contentNodeLastY=0,t.isTouchMove=!1,t.isScrollBounceBottom=!1,t}return a(t,e),Object.defineProperty(t.prototype,"view",{get:function(){return this._view},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"autoScrolling",{get:function(){return this._autoScrolling},set:function(e){this._autoScrolling=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"layout",{get:function(){return null==this._layout&&(this._layout=this.content.getComponent(r.default)),this._layout},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isHeader",{get:function(){var e,t,o,i;if(this.layout.headerToFooter){if(null===(e=this.layout)||void 0===e?void 0:e.header)return 0==(null===(t=this.layout)||void 0===t?void 0:t.header.index)}else if(null===(o=this.layout)||void 0===o?void 0:o.footer)return(null===(i=this.layout)||void 0===i?void 0:i.footer.index)==this.layout.maxItemTotal-1;return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isFooter",{get:function(){var e,t,o;if(this.layout.headerToFooter){if(null===(e=this.layout)||void 0===e?void 0:e.footer)return this.layout.footer.index==this.layout.maxItemTotal-1}else if(null===(t=this.layout)||void 0===t?void 0:t.header)return 0==(null===(o=this.layout)||void 0===o?void 0:o.header.index);return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isCalculPull",{get:function(){return this.pullDownEvents.length>0||this.pullUpEvents.length>0},enumerable:!1,configurable:!0}),t.prototype.calculateBoundary=function(){this._calculateBoundary()},t.prototype.getHowMuchOutOfBoundary=function(e){return this._getHowMuchOutOfBoundary(e)},t.prototype.onLoad=function(){this.contentNodeLastY=0,this.node.on(cc.Node.EventType.SIZE_CHANGED,this.onChangeSize,this),this.node.on("scroll-began",this.onScrollBeganEvent,this),this.node.on("bounce-bottom",this.onScrollBounceBottom,this),this.node.on("scroll-ended",this.onScrollEndEvent,this)},t.prototype.onDestroy=function(){this.node.off(cc.Node.EventType.SIZE_CHANGED,this.onChangeSize,this),this.node.off("scroll-ended",this.onScrollEndEvent,this),this.node.off("bounce-bottom",this.onScrollBounceBottom,this),this.node.off("scroll-began",this.onScrollBeganEvent,this)},t.prototype.onScrollBounceBottom=function(){this.isScrollBounceBottom=!0},t.prototype.onScrollBeganEvent=function(){this.isTouchMove=!0,this.isScrollBounceBottom=!1},t.prototype.onScrollEndEvent=function(){this.isTouchMove=!1},t.prototype.onChangeSize=function(){var e=this.view.getComponent(cc.Widget);e&&e.updateAlignment()},t.prototype.release=function(){if(this.isMoveHeader=!1,this.isMoveFooter=!1,this.isLockHeader||this.isLockFooter){var e=this.getHowMuchOutOfBoundary(),t=this.vertical?e.y:-e.x,o=!0;(0==t||this.isLockHeader&&t<0||this.isLockFooter&&t>0)&&(this.clearProgress(),o=!1),this.isLockHeader=!1,this.isLockFooter=!1,o&&(this._outOfBoundaryAmountDirty=!0,this._processInertiaScroll())}else this.clearProgress()},t.prototype.reset=function(){this._outOfBoundaryAmountDirty=!0,this.getHowMuchOutOfBoundary().fuzzyEquals(cc.v2(0,0),1e-4)||this._processInertiaScroll()},t.prototype._onTouchMoved=function(t,o){if(e.prototype._onTouchMoved.call(this,t,o),this.isCalculPull){var i=this.getHowMuchOutOfBoundary(),a=this.vertical?i.y:-i.x;a>0&&this.isHeader&&!this.isLockHeader&&!this.isLockFooter?(this.headerProgress=a<1e-4?0:a/this.headerOutOffset,this.isMoveHeader=this.headerProgress>=this.headerMultiple,this.emitPullDownEvent({action:!1,progress:this.headerProgress,progressStage:this.isMoveHeader?"wait":"touch"}),this.emitPullUpEvent({action:!1,progress:0,progressStage:"release"})):a<0&&this.isFooter&&!this.isLockFooter&&!this.isLockHeader&&(this.footerProgress=-a<1e-4?0:-a/this.footerOutOffset,this.isMoveFooter=this.footerProgress>=this.footerMultiple,this.emitPullUpEvent({action:!1,progress:this.footerProgress,progressStage:this.isMoveFooter?"wait":"touch"}),this.emitPullDownEvent({action:!1,progress:0,progressStage:"release"}))}},t.prototype._dispatchEvent=function(t){e.prototype._dispatchEvent.call(this,t),"scroll-ended"==t&&(this.layout.scrollToHeaderOrFooter=!1)},t.prototype._getContentTopBoundary=function(){var e,t=this.view.getContentSize(),o=0;return o=(null===(e=this.layout)||void 0===e?void 0:e.header)&&this.layout.getReallySize().height>t.height?this.layout.topBoundary:this._getContentBottomBoundary()+t.height,this.isHeader&&this.isLockHeader&&(o+=this.headerOutOffset),o},t.prototype._getContentBottomBoundary=function(){var e,t=this.view.getContentSize(),o=0;return o=(null===(e=this.layout)||void 0===e?void 0:e.footer)&&this.layout.getReallySize().height>t.height?this.layout.bottomBoundary:this.layout.node.y-this.layout.node.getAnchorPoint().y*t.height,this.isFooter&&this.isLockFooter&&(o-=this.footerOutOffset),o},t.prototype._getContentLeftBoundary=function(){var e,t=this.view.getContentSize(),o=0;return o=(null===(e=this.layout)||void 0===e?void 0:e.header)&&this.layout.getReallySize().width>t.width?this.layout.leftBoundary:this.layout.node.x-this.layout.node.getAnchorPoint().x*t.width,this.isHeader&&this.isLockHeader&&(o-=this.headerOutOffset),o},t.prototype._getContentRightBoundary=function(){var e,t=this.view.getContentSize(),o=0;return o=(null===(e=this.layout)||void 0===e?void 0:e.footer)&&this.layout.getReallySize().width>t.width?this.layout.rightBoundary:this._getContentLeftBoundary()+t.width,this.isFooter&&this.isLockFooter&&(o+=this.footerOutOffset),o},t.prototype._startAutoScroll=function(t,o,i){this.isCalculPull&&(this.isMoveHeader&&!this.isLockHeader?(this.isLockHeader=!0,this.vertical&&(t.y-=this.headerOutOffset),this.horizontal&&(t.x+=this.headerOutOffset),this.emitPullDownEvent({action:!0,progress:this.headerProgress,progressStage:"lock"})):this.isMoveFooter&&!this.isLockFooter&&(this.isLockFooter=!0,this.vertical&&(t.y+=this.footerOutOffset),this.horizontal&&(t.x-=this.footerOutOffset),this.emitPullUpEvent({action:!0,progress:this.footerProgress,progressStage:"lock"}))),e.prototype._startAutoScroll.call(this,t,o,i)},t.prototype._updateScrollBar=function(t){if(e.prototype._updateScrollBar.call(this,t),this.isCalculPull&&!this._autoScrollBraking&&this.autoScrolling){var o=this.vertical?t.y:-t.x;if(o>0){var i=o<1e-4?0:o/this.headerOutOffset,a=void 0;this.isLockHeader?(this.headerProgress=1==this.headerProgress?this.headerProgress:Math.max(i,1),a="lock"):(this.headerProgress=i<this.headerProgress?i:this.headerProgress,a="release"),this.emitPullDownEvent({action:!1,progress:this.headerProgress,progressStage:a})}else o<0?(i=-o<1e-4?0:-o/this.footerOutOffset,a=void 0,this.isLockFooter?(this.footerProgress=1==this.footerProgress?this.footerProgress:Math.max(i,1),a="lock"):(this.footerProgress=i<this.footerProgress?i:this.footerProgress,a="release"),this.emitPullUpEvent({action:!1,progress:this.footerProgress,progressStage:a})):0==o&&(this.isLockHeader||this.isLockFooter||this.clearProgress())}},t.prototype.clearProgress=function(){this.headerProgress=0,this.footerProgress=0,this.emitPullDownEvent({action:!1,progress:0,progressStage:"release"}),this.emitPullUpEvent({action:!1,progress:0,progressStage:"release"})},t.prototype.emitPullDownEvent=function(e){cc.Component.EventHandler.emitEvents(this.pullDownEvents,this,e)},t.prototype.emitPullUpEvent=function(e){cc.Component.EventHandler.emitEvents(this.pullUpEvents,this,e)},n([l({displayName:"\u9876\u90e8\u504f\u79fb\u91cf",tooltip:"\u4e0b\u62c9\u65f6\u8d85\u8fc7\u6b64\u504f\u79fb\u4f1a\u53d1\u9001\u4e0b\u62c9\u4e8b\u4ef6"})],t.prototype,"headerOutOffset",void 0),n([l({displayName:"\u6ee1\u8db3\u89e6\u53d1Header\u7684\u500d\u6570"})],t.prototype,"headerMultiple",void 0),n([l({displayName:"\u5e95\u90e8\u504f\u79fb\u91cf",tooltip:"\u4e0a\u62c9\u65f6\u8d85\u8fc7\u6b64\u504f\u79fb\u4f1a\u53d1\u9001\u4e0a\u62c9\u4e8b\u4ef6"})],t.prototype,"footerOutOffset",void 0),n([l({displayName:"\u6ee1\u8db3\u89e6\u53d1Footer\u7684\u500d\u6570"})],t.prototype,"footerMultiple",void 0),n([l({type:cc.Component.EventHandler,displayName:"\u4e0b\u62c9\u4e8b\u4ef6"})],t.prototype,"pullDownEvents",void 0),n([l({type:cc.Component.EventHandler,displayName:"\u4e0a\u62c9\u4e8b\u4ef6"})],t.prototype,"pullUpEvents",void 0),n([c,d("UISpuerScrollView")],t)}(cc.ScrollView);o.default=u,cc._RF.pop()},{"./UISuperLayout":"UISuperLayout"}],UserProtocolView:[function(e,t,o){"use strict";cc._RF.push(t,"984bbCieslPK6VDix5c0Enl","UserProtocolView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=e("../../network/ClientNetwork"),l=e("../../network/LocalMessage"),d=e("../../utils/GamePlatform"),u=e("../../utils/QQMiniGameUtils"),h=e("../../StaticData/WorldNoticeTableData"),p=e("../../utils/GameTools"),f=cc._decorator,g=f.ccclass,m=f.property,_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.m_txt_content=null,t}return a(t,e),t.path=function(){return"ui/protocol/UserProtocolView"},t.prototype.start=function(){d.GamePlatform.isKuaishouMiniGame()?this.requestProtocolByType("kuaishou"):d.GamePlatform.Is5Add7SmallBag()?this.m_txt_content.string=h.WorldNoticeTableData.getById(1).content:this.requestProtocolByType()},t.prototype.init=function(e){e.showClose&&e.showClose?(this.node.getChildByName("close").active=!0,this.node.getChildByName("btncancel").active=!1,this.node.getChildByName("btnconfirm").active=!1):(this.node.getChildByName("close").active=!1,this.node.getChildByName("btncancel").active=!0,this.node.getChildByName("btnconfirm").active=!0)},t.prototype.onClickAgree=function(){c.ClientNetwork.getInstance().pushLocalMessage(l.LOCAL_MESSAGE.LocalMsg_AgreeUserProtocol)},t.prototype.onClickDisagree=function(){u.QQMiniGameUtils.getInstance().quitGame()},t.prototype.onShowContent=function(e){var t=this,o=e.split("\r\n");p.default.startFraming(o.length,function(e){var i=o[e],a=new cc.Node,n=a.addComponent(cc.RichText);a.parent=t.m_txt_content.node.parent,a.active=!0,n.string=i,n.fontSize=18,n.maxWidth=580,n.cacheMode=cc.Label.CacheMode.CHAR,n.lineHeight=30})},t.prototype.requestProtocolByType=function(e,t){var o=this;void 0===e&&(e=""),void 0===t&&(t=1);var i="https://mszctest.gameserver.iplay11g.com/gmsys/weblogic/webc/getuserhelp.php?type="+t+"&platform="+e,a=new XMLHttpRequest;a.onload=function(){if(a.status>=200&&a.status<400){console.log("requestProtocolByType success",a);var e=a.responseText;if(e){var t=JSON.parse(e).value;o.onShowContent(t)}}},a.onerror=function(){console.log("requestProtocolByType Error, type="+t)},a.open("GET",i,!0),a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.timeout=1e4,a.send()},n([m(cc.RichText)],t.prototype,"m_txt_content",void 0),n([s.Register_Class,g],t)}(r.default);o.default=_,cc._RF.pop()},{"../../StaticData/WorldNoticeTableData":"WorldNoticeTableData","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../network/ClientNetwork":"ClientNetwork","../../network/LocalMessage":"LocalMessage","../../utils/GamePlatform":"GamePlatform","../../utils/GameTools":"GameTools","../../utils/QQMiniGameUtils":"QQMiniGameUtils"}],VOLegendControl:[function(e,t,o){"use strict";cc._RF.push(t,"9f3edRIOEFEJoDp354cPiR0","VOLegendControl");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../common/PlayerModule"),r=e("../../../modules/base/BaseSingle"),s=e("../../../utils/GameUtils"),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.onCreate=function(){},t.prototype.onDestroy=function(){},t.prototype.refreshShowWorshipRedPoint=function(){for(var e=0;e<3;e++){var t=this.getWorshipData(e+1);if(t&&0==n.default.getCostGetDataByID(t))return!0}return!1},t.prototype.getWorshipData=function(e){return Number(s.getConfigIntValue("legend_worship_rank"+e))},t}(r.BaseSingle);o.default=r.SingleFactory.getInstance(c),cc._RF.pop()},{"../../../common/PlayerModule":"PlayerModule","../../../modules/base/BaseSingle":"BaseSingle","../../../utils/GameUtils":"GameUtils"}],ViewManager:[function(e,t,o){"use strict";cc._RF.push(t,"b8530TixL5NkpAA1W0j4XZV","ViewManager");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0}),o.AddViewEvent=void 0;var n=e("../base/BaseScene"),r=e("../base/BaseSingle"),s=e("./LoadResManager"),c=e("../../Global/GameGlobal"),l=e("../base/Configuration"),d=e("../../utils/LogUtil"),u=e("../../network/ClientNetwork"),h=e("../../network/LocalMessage");o.AddViewEvent=function(e){return function(t,o){var i=t.constructor.name,a=p.__ViewEventList__,n=a.get(i);if(n)n.push({key:e||o,func:o});else{var r=[];r.push({key:e||o,func:o}),a.set(i,r)}}};var p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._maxLayerZorder=0,t}return a(t,e),t.prototype.onCreate=function(){this._viewNodeList=[],this._nodeList=[],this._maxLayerZorder=0,this._popCtrlList=[],this._layerCtrlList=[],t.__ViewEventList__=new Map,this._onceFlagList=new Map},t.prototype.onDestroy=function(){t.__ViewEventList__=null,this._nodeList=null,this._viewNodeList=null},Object.defineProperty(t.prototype,"popCtrlList",{get:function(){return this._popCtrlList},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"layerCtrlList",{get:function(){return this._layerCtrlList},enumerable:!1,configurable:!0}),t.prototype.showOrHide=function(e){for(var t=0,o=this._popCtrlList;t<o.length;t++){var i=o[t];"hide"==e?i.onGameHide():"show"==e&&i.onGameShow()}for(var a=0,n=this._layerCtrlList;a<n.length;a++)i=n[a],"hide"==e?i.onGameHide():"show"==e&&i.onGameShow()},t.prototype.__showScene__=function(e,t,o,i){var a=this,r="resources/";if("string"==typeof e?r=e:e&&(r=e.path()),d.default.info("entry scene path",r),r){var s=r.replace(/(\w*)*(\/.*)*/gi,"$1"),c=r.replace(s+"/","");n.default.lastSceneName=cc.director.getScene().name;var l=function(e){a.__closeAllView__(),d.default.info("run scece",e.name),cc.director.runScene(e,function(){},function(){n.default.params=t,n.default.curSceneName=c;var e=cc.find("Canvas").getComponent("BaseScene");n.default.scene=e,a._nodeList=[],a._nodeList.push(e),i&&i()}),o&&o()};cc.assetManager.resources.loadScene(c,function(e,t){e?d.default.error("load scene error| scenePath => ",r):l(t)})}else d.default.error("\u8df3\u8f6c\u573a\u666f\u8def\u5f84("+r+")\u4e0d\u5b58\u5728, \u8bf7\u91cd\u5199 path \u9759\u6001\u51fd\u6570")},t.prototype.__showView__=function(e,t,o,i,a,n,r,u){var h=this;if(!t.isOnlyOne()||!this._onceFlagList.get(o)){u||(u=cc.find("Canvas")),null!=n&&null!=n||(n=0),c.G.UIManager.showWaitingLayer(c.G.UIManager.getCurSceneName());var p=null;a!=l.VIEW_OPTION.OVERLAY&&a!=l.VIEW_OPTION.SINGLE||(p=t.getMaskNode())&&(p.name="UI_Mask_"+o,p.zIndex=this._maxLayerZorder+n+10,u.addChild(p),p.active=!1),this._onceFlagList.set(o,1),this.makeIndexAlign(),this.openViewOptionHandler(a);var f=new e;f.cName=o,f.__init__();var g=t.path();return""==g?(d.default.error("path is null "),void p.destroy()):cc.assetManager.resources?void s.default.loadPrefab(g).then(function(e){a==l.VIEW_OPTION.OVERLAY||a==l.VIEW_OPTION.SINGLE?h._popCtrlList.push(f):a==l.VIEW_OPTION.LAYER&&h._layerCtrlList.push(f),c.G.UIManager.hideWaitingLayer(c.G.UIManager.getCurSceneName());var s=e;s.name=o,f.__initWithData__(i),h.initViewCtrl(f,s,t,i,a,n,u,p),r&&r(f.view)}).catch(function(e){!e&&u.isValid||(d.default.error("\u52a0\u8f7d\u5f39\u7a97\u5931\u8d25: ",g,"isValid =>",u.isValid,"err info :",e),p.destroy(),c.G.UIManager.hideWaitingLayer(c.G.UIManager.getCurSceneName()),h._onceFlagList.delete(o))}):(d.default.error("bundle \u4e0d\u5b58\u5728 ==> "),void p.destroy())}d.default.info("dialog is exist",o)},t.prototype.initViewCtrl=function(e,t,o,i,a,r,s,c){var d=t.getComponent(o);e.view=d||t.addComponent(o),d=e.view,e.view.maskNode=c,e.view.maskNode&&(e.view.maskNode.active=!0),s.addChild(t),e.view.__init__(i),this.bindViewEvent(e),e.afterInit(),this.pushNodeList(d),this.pushViewNodeList(t),e.view.__viewAnimaHandler__(o.anima()),a==l.VIEW_OPTION.OVERLAY||a==l.VIEW_OPTION.SINGLE?(t.zIndex=this._maxLayerZorder+r+10,this.doApperaOrDisAppera()):a==l.VIEW_OPTION.LAYER&&(t.zIndex=r,r>this._maxLayerZorder&&(this._maxLayerZorder=r)),n.default.scene&&cc.isValid(n.default.scene)&&n.default.scene.__onAppera__(e)},t.prototype.checkTopMaskNode=function(e){if(e)(t=e.view.maskNode)&&(t.active=!0,0==e.view.node.active&&(t.active=!1));else if(this._popCtrlList.length>0){var t,o=this._popCtrlList[this._popCtrlList.length-1];(t=o.view.maskNode)&&(t.active=!0,0==o.view.node.active&&(t.active=!1))}},t.prototype.doApperaOrDisAppera=function(){if(this._popCtrlList.length>0){var e=this._popCtrlList[this._popCtrlList.length-1];this.checkTopMaskNode(e),e.__onAppera__()}if(this._popCtrlList.length>1){var t=this._popCtrlList[this._popCtrlList.length-2],o=t.view.maskNode;o&&(o.active=!1),t.__onDisappera__()}},t.prototype.bindViewEvent=function(e){var o=t.__ViewEventList__,i=e.constructor.name,a=o.get(i);if(a)for(var n=0,r=a;n<r.length;n++){var s=r[n];e[s.func]&&e.bindEvent(s.key,e[s.func],e)}},t.prototype.makeIndexAlign=function(){for(var e=0,t=this._popCtrlList;e<t.length;e++){var o=t[e].view.node;o&&o.zIndex&&o.zIndex!=this._maxLayerZorder+10&&(o.zIndex=this._maxLayerZorder+10)}},t.prototype.openViewOptionHandler=function(){},t.prototype.__closeView__=function(e){this._popNodeList(e),this._popViewNodeList(e.node);for(var t=0,o=this._popCtrlList.length;t<o;t++)if(this._popCtrlList[t].view===e){if((a=this._popCtrlList.splice(t,1))&&a.length>0&&(this._onceFlagList.delete(a[0].cName),a[0].__destroy__()),this._popCtrlList.length>0){var i=this._popCtrlList[this._popCtrlList.length-1];this.checkTopMaskNode(i),i.__onAppera__()}return void this.checkPopListSize()}for(t=0,o=this._layerCtrlList.length;t<o;t++){var a;if(this._layerCtrlList[t].view===e)return void((a=this._layerCtrlList.splice(t,1))&&a.length>0&&(this._onceFlagList.delete(a[0].cName),a[0].__destroy__()))}},t.prototype.checkPopListSize=function(){this._popCtrlList.length<=0&&(d.default.info("\u6240\u6709\u5f39\u7a97\u5173\u95ed\u5b8c\u6bd5"),n.default.scene&&cc.isValid(n.default.scene)&&n.default.scene.__onCloseAllPopView__())},t.prototype.closeAllPopView=function(){this.__closeAllPopView__()},t.prototype.__closeAllPopView__=function(){for(var e=0,t=this._popCtrlList;e<t.length;e++){var o=t[e];this._onceFlagList.delete(o.cName),o.__destroy__()}this._popCtrlList=[],this._viewNodeList=this._viewNodeList.filter(function(e){return"MainSceneView"===e.name}),this._nodeList=this._nodeList.filter(function(e){return"MainSceneView"===e.node.name}),this.checkPopListSize()},t.prototype.__closeAllLayerView__=function(){for(var e=0,t=this._layerCtrlList;e<t.length;e++){var o=t[e];this._onceFlagList.delete(o.cName),o.__destroy__()}this._layerCtrlList=[]},t.prototype.__closeAllView__=function(){this._nodeList=[],this._viewNodeList=[],this.__closeAllPopView__(),this.__closeAllLayerView__(),this._maxLayerZorder=0,this._onceFlagList=new Map},t.prototype.destroy=function(){this.__closeAllView__(),this._maxLayerZorder=0},t.prototype._popNodeList=function(e){for(var t=0,o=this._nodeList.length;t<o;t++)if(this._nodeList[t]===e)return this._nodeList.splice(t,1),void u.ClientNetwork.getInstance().pushLocalMessage(h.LOCAL_MESSAGE.LocalMsg_close_view)},t.prototype.pushNodeList=function(e){this._nodeList.push(e)},Object.defineProperty(t.prototype,"nodeList",{get:function(){return this._nodeList},enumerable:!1,configurable:!0}),t.prototype.pushViewNodeList=function(e){this._viewNodeList.push(e)},Object.defineProperty(t.prototype,"viewNodeList",{get:function(){return this._viewNodeList},enumerable:!1,configurable:!0}),t.prototype.getGameViewShowCount=function(){for(var e=0,t=0,o=this._viewNodeList.length;t<o;t++)cc.isValid(this._viewNodeList[t])&&1==this._viewNodeList[t].active&&"MainSceneView"!=this._viewNodeList[t].name&&e++;return e},t.prototype._popViewNodeList=function(e){for(var t=0,o=this._viewNodeList.length;t<o;t++)if(this._viewNodeList[t]===e){this._viewNodeList.splice(t,1);break}},t}(r.BaseSingle);o.default=r.SingleFactory.getInstance(p),cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../network/ClientNetwork":"ClientNetwork","../../network/LocalMessage":"LocalMessage","../../utils/LogUtil":"LogUtil","../base/BaseScene":"BaseScene","../base/BaseSingle":"BaseSingle","../base/Configuration":"Configuration","./LoadResManager":"LoadResManager"}],VipServiceView:[function(e,t,o){"use strict";cc._RF.push(t,"dd3270pupRMQLN3i3ntGjx6","VipServiceView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=e("../../utils/GamePlatform"),l=e("../../utils/GameUtils"),d=e("../../utils/TimeOffSetManager"),u=cc._decorator,h=u.ccclass,p=(u.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.path=function(){return"ui/vipService/VipServiceView"},t.prototype.init=function(){},t.prototype.onLoad=function(){},t.prototype.start=function(){this.m_qrCode=this.node.getChildByName("img_qrCode").getComponent(cc.Sprite),this.m_qrCode.spriteFrame=new cc.SpriteFrame;var e=this.getImgUrl();e=e+"?"+d.TimeOffSetManager.getMilisecond(),console.log("vipservice url="+e),e&&cc.assetManager.loadRemote(e,function(e,t){if(cc.isValid(this,!0)&&null==e&&t){var o=new cc.SpriteFrame(t);this.m_qrCode.spriteFrame=o}}.bind(this))},t.prototype.onDestroy=function(){},t.prototype.getImgUrl=function(){var e=c.GamePlatform.getMiYaVideoTypeNoSet();return e.length>0&&"mzf"==e?l.getConfigIntValue("vipService_qrCode_url_mengzuofang"):e.length>0&&"bigBlue"==e?l.getConfigIntValue("vipService_qrCode_url_bigBlue"):l.getConfigIntValue("vipService_qrCode_url_miya")},n([s.Register_Class,h],t)}(r.default));o.default=p,cc._RF.pop()},{"../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../utils/GamePlatform":"GamePlatform","../../utils/GameUtils":"GameUtils","../../utils/TimeOffSetManager":"TimeOffSetManager"}],VoucherConfirmBuy:[function(e,t,o){"use strict";cc._RF.push(t,"f8955bG9OlIwqSAdJSWpphv","VoucherConfirmBuy");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../utils/GameTools"),c=e("../../modules/base/Decorators"),l=cc._decorator,d=l.ccclass,u=l.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.contentRichLabel=null,t.haveNumLab=null,t.buyNode=null,t.cancelNode=null,t}return a(t,e),t.path=function(){return"ui/shop/prefab/voucher_buy"},t.prototype.onLoad=function(){},t.prototype.start=function(){},t.prototype.init=function(e){var t=this;if(!e)return!1;s.default.registerTouchEvent(this.buyNode,function(){e.confirmCb&&(e.confirmCb(),t.closeView())}),s.default.registerTouchEvent(this.cancelNode,function(){e.cancelCb&&(e.cancelCb(),t.closeView())}),this.contentRichLabel.string=e.content,this.haveNumLab.string=(e.playerVoucher/100).toString()},n([u(cc.RichText)],t.prototype,"contentRichLabel",void 0),n([u(cc.Label)],t.prototype,"haveNumLab",void 0),n([u(cc.Node)],t.prototype,"buyNode",void 0),n([u(cc.Node)],t.prototype,"cancelNode",void 0),n([c.Register_Class,d],t)}(r.default);o.default=h,cc._RF.pop()},{"../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../utils/GameTools":"GameTools"}],VoucherRechargeTableData:[function(e,t,o){"use strict";cc._RF.push(t,"9b518C8sP5MoZRMS9on2Diw","VoucherRechargeTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.VoucherRechargeTableData=void 0;var i=e("../TableReader"),a=function(){function e(){this.id=0,this.rechargeid=0,this.desc="",this.icon="",this.platform=0}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.rechargeid=e.getNumber(),this.desc=e.getString(),this.icon=e.getString(),this.platform=e.getNumber()},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"VoucherRechargeTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.VoucherRechargeTableData=a,cc._RF.pop()},{"../TableReader":"TableReader"}],WaitingLayer:[function(e,t,o){"use strict";cc._RF.push(t,"bbcee0vNcpJE5rYyzLAN4Ul","WaitingLayer");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r},r=this&&this.__awaiter||function(e,t,o,i){return new(o||(o=Promise))(function(a,n){function r(e){try{c(i.next(e))}catch(t){n(t)}}function s(e){try{c(i.throw(e))}catch(t){n(t)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(r,s)}c((i=i.apply(e,t||[])).next())})},s=this&&this.__generator||function(e,t){var o,i,a,n,r={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return n={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function s(e){return function(t){return c([e,t])}}function c(n){if(o)throw new TypeError("Generator is already executing.");for(;r;)try{if(o=1,i&&(a=2&n[0]?i.return:n[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return r.label++,{value:n[1],done:!1};case 5:r.label++,i=n[1],n=[0];continue;case 7:n=r.ops.pop(),r.trys.pop();continue;default:if(!(a=(a=r.trys).length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){r=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){r.label=n[1];break}if(6===n[0]&&r.label<a[1]){r.label=a[1],a=n;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(n);break}a[2]&&r.ops.pop(),r.trys.pop();continue}n=t.call(e,r)}catch(s){n=[6,s],i=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=e("../../Global/GameGlobal"),l=e("../../network/ClientNetwork"),d=e("../../modules/base/Decorators"),u=e("../../modules/base/BaseView"),h=e("../GameUtils"),p=cc._decorator,f=p.ccclass,g=p.property,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.showNode=null,t.progress=null,t.percent=null,t.tips=null,t.ui=null,t.lastProgress=0,t._bTimeout=!1,t}var o;return a(t,e),o=t,t.path=function(){return"ui/CommonPrefab/WaitingLayer"},t.isShowing=function(){return this.s_ShowWaitingLayer},t.prototype.onEnable=function(){this._timeOut&&(clearTimeout(this._timeOut),this._timeOut=null),this._timeOut=setTimeout(function(){c.G.UIManager.hideWaitingLayer(c.G.UIManager.getCurSceneName(),!0)},4e3)},t.prototype.onDisable=function(){this._timeOut&&(clearTimeout(this._timeOut),this._timeOut=null)},t.show=function(e,t,i){return void 0===t&&(t=5),void 0===i&&(i=1),r(this,void 0,void 0,function(){var a;return s(this,function(){return o.s_ShowWaitingLayer=!0,cc.director.getScene(),c.G.UIManager.getRunningScene(),(a=cc.director.getScene().getChildByName("WaitingLayer"))?(a.active=!0,a.getComponentInChildren(o).showAnimationLater(e,i),o.setTimeout(t)):o.s_ShowWaitingLayer&&((a=cc.instantiate(c.G.waitingLayer)).name="WaitingLayer",cc.director.getScene().addChild(a,9999),a.active=!0,a.getComponentInChildren(o).showAnimationLater(e,i),o.setTimeout(t),h.backgroundFitScreen(a,a)),[2]})})},t.hide=function(e,t){void 0===t&&(t=!1),t&&l.ClientNetwork.getInstance().WaitingMsg.clear();var i=cc.director.getScene().getChildByName("WaitingLayer");if(i){if(l.ClientNetwork.getInstance().WaitingMsg.delete(e),0==l.ClientNetwork.getInstance().WaitingMsg.size){i.active=!1;var a=i.getComponentInChildren(o);a.unscheduleAllCallbacks(),o.setProgress(1),a.clear(),o.s_ShowWaitingLayer=!1}}else o.s_ShowWaitingLayer=!1},t.setProgress=function(){},t.setTips=function(e,t){void 0===t&&(t=!1);var i=cc.director.getScene().getChildByName("WaitingLayer");if(i){var a=i.getComponentInChildren(o);if(a.progress.node.active)return!1;if(!a.tips.node.active||t)return a.tips.node.active=!0,a.tips.string="",!0}return!1},t.setPos=function(e,t){var o=cc.director.getScene().getChildByName("WaitingLayer");o&&(o.x=e,o.y=t)},t.setTimeout=function(e){var t=cc.director.getScene().getChildByName("WaitingLayer");if(t){var i=t.getComponentInChildren(o);e>0?(i._bTimeout=!0,i.scheduleOnce(function(){i.showNode.active&&i._bTimeout&&(cc.log("!!! WaitingLayer Timeout !!!"),l.ClientNetwork.getInstance().WaitingMsg.forEach(function(e){cc.log("WaitingLayer WaitingMsg: "+e)}),l.ClientNetwork.getInstance().Disconnect(),o.hide("",!0))},e)):i._bTimeout=!1}},t.prototype.showAnimationLater=function(e,t){var o=this;void 0===t&&(t=1),this.showNode.active=!1,this.ui.active=!1,this.clear(),this.scheduleOnce(function(){o.ui.active=!0},t)},t.prototype.clear=function(){this.progress.node.active=!1,this.lastProgress=0,this.tips.node.active=!1,this.node.x=0,this.node.y=0,this._bTimeout=!1},t.s_ShowWaitingLayer=!1,n([g(cc.Node)],t.prototype,"showNode",void 0),n([g(cc.ProgressBar)],t.prototype,"progress",void 0),n([g(cc.Label)],t.prototype,"percent",void 0),n([g(cc.Label)],t.prototype,"tips",void 0),n([g(cc.Node)],t.prototype,"ui",void 0),o=n([d.Register_Class,f],t)}(u.default);o.default=m,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../network/ClientNetwork":"ClientNetwork","../GameUtils":"GameUtils"}],WechatUtils:[function(e,t,o){"use strict";cc._RF.push(t,"70e84YLthhJRZltv30LXSZh","WechatUtils"),Object.defineProperty(o,"__esModule",{value:!0}),o.WechatUtils=o.Wechat360dianjing=o.KSPostEventType=o.AQYPostEventType=o.XTPostEventType=o.UcPostEventType=o.BiliPostEventType=o.FeishuPostEventType=o.wxPayType=o.ShareType=void 0;var i,a,n=e("../../load"),r=e("../common/PlayerModule"),s=e("../Global/GameGlobal"),c=e("../network/ClientNetwork"),l=e("../network/LocalMessage"),d=e("../network/protocol/MatchProtocols"),u=e("../network/protocol/RechargeProtocols"),h=e("../network/protocol/RoleProtocols"),p=e("../StaticData/RechargeTableData"),f=e("./GamePlatform"),g=e("./GameUtils"),m=e("./subUtils/TypeDef"),_=e("../common/NetworkProtocolCommon"),y=e("../network/protocol/TypeProtocols"),v=e("../modules/base/GameView"),C=e("../StaticData/TaskTableData"),S=e("../TalkingDataAPI"),T=e("./LogUtil"),I=e("../model/ServerAddrInfo"),N=e("../common/CommandValue"),b=e("./TimeOffSetManager"),w=e("../view/activity/ActivityModule"),E=e("../view/machineryCityActivity/MachineryCityModel");(function(e){e[e.InviteFriend=0]="InviteFriend",e[e.BattleRoom=1]="BattleRoom"})(o.ShareType||(o.ShareType={})),function(e){e[e.wxPayType_midas=1]="wxPayType_midas",e[e.wxPayType_custormer=2]="wxPayType_custormer"}(i=o.wxPayType||(o.wxPayType={})),function(e){e.Active_Type="0",e.Active_Register_Type="1",e.Active_Pay_Type="2",e.Next_Day_Open="6",e.Game_Addiction="25"}(o.FeishuPostEventType||(o.FeishuPostEventType={})),function(e){e.APP_FIRST_ACTIVE="APP_FIRST_ACTIVE",e.FORM_SUBMIT="FORM_SUBMIT",e.USER_COST="USER_COST",e.RETENTION="RETENTION",e.ACTION_VALID="ACTION_VALID"}(o.BiliPostEventType||(o.BiliPostEventType={})),function(e){e[e.APP_FIRST_ACTIVE=1]="APP_FIRST_ACTIVE",e[e.FORM_SUBMIT=27]="FORM_SUBMIT",e[e.USER_COST=1e3]="USER_COST",e[e.RETENTION=1001]="RETENTION"}(o.UcPostEventType||(o.UcPostEventType={})),function(e){e[e.APP_FIRST_ACTIVE=0]="APP_FIRST_ACTIVE",e[e.FORM_SUBMIT=1]="FORM_SUBMIT",e[e.USER_COST=2]="USER_COST"}(o.XTPostEventType||(o.XTPostEventType={})),function(e){e[e.APP_FIRST_ACTIVE=13]="APP_FIRST_ACTIVE",e[e.USER_COST=17]="USER_COST"}(a=o.AQYPostEventType||(o.AQYPostEventType={})),function(e){e[e.APP_FIRST_ACTIVE=1]="APP_FIRST_ACTIVE",e[e.FORM_SUBMIT=2]="FORM_SUBMIT",e[e.USER_COST=3]="USER_COST",e[e.RETENTION=7]="RETENTION",e[e.ACTION_VALID=84]="ACTION_VALID"}(o.KSPostEventType||(o.KSPostEventType={})),function(e){e.ORDER="ORDER",e.REGISTERED="REGISTERED",e.ROLE_CREAT="ROLE_CREAT"}(o.Wechat360dianjing||(o.Wechat360dianjing={}));var P=function(){function e(){this.m_nPlatformOS=1,this.m_strEncryptedData="",this.m_strIv="",this.gameOpenLink="",this.m_weichatLoginData=null,this.m_gameClubBtn=null,this.m_syncLiveTime=null,this.m_bFeishuConversion=!1,this.m_click_auth=!1,this.m_wxShareVideoBtn=null,this.m_wxVideoRecordTime=0,this.m_isClickVideoRecord=!1,this.m_isRecording=!1,this.m_RetryNoticeServerPay=!1,this.isOpenAQYJump=""}return e.getInstance=function(){return this.Instance||(this.Instance=new e),this.Instance},e.prototype.getWechatLoginData=function(){return this.m_weichatLoginData},e.prototype.getGameOpenLink=function(){return this.gameOpenLink},e.prototype.getWechatOS=function(){return this.m_nPlatformOS},e.prototype.userLogin=function(){console.log("WechatUtils, userLogin!");var e=this;wx.checkSession({success:function(){console.log("checkSession");try{e.onLogin()}catch(t){console.log("AccountScene onLoginRet fail"),e.onLogin()}},fail:function(){e.onLogin()}})},e.prototype.requestGameClubOpenlink=function(){var e="https://mszcs1.gameserver.iplay11g.com/gmsys/gameClubOpenlink.php?"+Math.random(),t=this;wx.request({url:e+"?"+Math.random(),data:{x:"",y:""},header:{"content-type":"application/json"},method:"GET",success:function(e){e&&(console.log("get openLink success ",e.data.openlink),t.gameOpenLink=e.data.openlink)},fail:function(e){console.log("gameClub get Openlink fail"+e)}})},e.prototype.requestWXServer=function(){var e="https://mszcs1.gameserver.iplay11g.com/gmsys/weblogic/webc/weixingameloginbygroup.php";!0===n.getSubmitReviewState()&&(e="https://mszctest.gameserver.iplay11g.com/gmsys/weblogic/webc/weixingameloginbygroup.php");var t=this;wx.request({url:e,data:{accountname:this.m_weichatLoginData.accountname,open_id:this.m_weichatLoginData.openid,systematic:t.m_nPlatformOS,session_key:this.m_weichatLoginData.session_key,ver:n.wechatminiLoaclGameVer,groupid:m.GlobalVar.getServerGroup().toString()},success:function(e){if(e){var o=JSON.stringify(e.data);t.m_weichatLoginData.sign=e.data.sign,console.log("servergroup requestWXServer ret="+o),c.ClientNetwork.getInstance().pushLocalMessage(l.LOCAL_MESSAGE.LocalMsg_GetServerAddr,e.data)}else c.ClientNetwork.getInstance().pushLocalMessage(l.LOCAL_MESSAGE.LocalMsg_GetServerAddr,{error:-2})},fail:function(e){console.log("servergroup requestWXServer failed1"+e),c.ClientNetwork.getInstance().pushLocalMessage(l.LOCAL_MESSAGE.LocalMsg_GetServerAddr,{error:-2})}})},e.prototype.onLogin=function(){var e=this;cc.sys.os==cc.sys.OS_IOS?this.m_nPlatformOS=2:cc.sys.os==cc.sys.OS_WINDOWS&&(this.m_nPlatformOS=3);var t=I.ServerAddrInfo.getInstance().getServerListUrl();wx.login({success:function(o){o.code&&(console.log(o.code),console.log(e.m_nPlatformOS),wx.request({url:t,data:{jscode:o.code,systematic:e.m_nPlatformOS,ver:n.wechatminiLoaclGameVer},success:function(t){if(t){var o=JSON.stringify(t.data);console.log("servergroup wxgetserverlist res.data="+o),e.m_weichatLoginData=t.data.data;var i=JSON.stringify(t.data.servers);console.log("servergroup wxgetserverlist servers="+i),I.ServerAddrInfo.getInstance().initServerList(t.data.servers),c.ClientNetwork.getInstance().pushLocalMessage(l.LOCAL_MESSAGE.LocalMsg_SDK_LoginRet,{error:0})}else c.ClientNetwork.getInstance().pushLocalMessage(l.LOCAL_MESSAGE.LocalMsg_SDK_LoginRet,{error:-2})},fail:function(e){console.log("onLogin failed1"+e),c.ClientNetwork.getInstance().pushLocalMessage(l.LOCAL_MESSAGE.LocalMsg_SDK_LoginRet,{error:-2})}}))},fail:function(e){console.log("onLogin failed"+e),c.ClientNetwork.getInstance().pushLocalMessage(l.LOCAL_MESSAGE.LocalMsg_SDK_LoginRet,{error:-2})}})},e.prototype.getUserInfo=function(){T.default.log("WechatUtils, getUserInfo!");var e=this;wx.getUserInfo({success:function(t){e.storageUserInfo(t),e.m_strEncryptedData=t.encryptedData,e.m_strIv=t.iv,e.userLogin()},fail:function(){console.log("getUserInfo fail")}})},e.prototype.storageUserInfo=function(e){var t=e.userInfo;T.default.log("getUserInfo success"+t.nickName+t.avatarUrl),wx.setStorage({key:"wxNickName",data:t.nickName}),wx.setStorage({key:"wxImage",data:t.avatarUrl}),wx.setStorage({key:"wxSex",data:t.gender}),wx.setStorage({key:"wxAuth",data:!0})},e.prototype.userInfoSetInSQL=function(e){wx.getStorage({key:"third_Session",success:function(t){wx.request({url:"Our Server ApiUrl",data:{third_Session:t.data,nickName:e.nickName,avatarUrl:e.avatarUrl,gender:e.gender,province:e.province,city:e.city,country:e.country},success:function(){}})}})},e.prototype.userAuth=function(e,t){void 0===e&&(e=null),void 0===t&&(t=null);var o=this,i=wx.getSystemInfoSync(),a=i.screenWidth,n=i.screenHeight;wx.getSetting({success:function(i){if(console.log(i.authSetting),i.authSetting["scope.userInfo"])console.log("\u7528\u6237\u5df2\u6388\u6743"),e&&e();else{console.log("\u7528\u6237\u672a\u6388\u6743");var r=wx.createUserInfoButton({type:"text",text:"",style:{left:0,top:0,width:a,height:n,backgroundColor:"#00000000",color:"#000000",fontSize:0,textAlign:"center",lineHeight:n}});r.offTap(function(){console.log("\u7528\u6237\u6388\u6743:offTap",i)}),r.onTap(function(i){o.m_click_auth||(o.m_click_auth=!0,setTimeout(function(){o.m_click_auth=!1},1e3),i.userInfo?(console.log("\u7528\u6237\u6388\u6743:",i),o.storageUserInfo(i),e&&e(),r.destroy()):(console.log("\u7528\u6237\u62d2\u7edd\u6388\u6743:",i),t&&t(),r.destroy()))})}}})},e.prototype.retryNoticeServerPay=function(e){var t=this;if(!t.m_RetryNoticeServerPay){var o=Number(g.getConfigIntValue("rechargeProtectCounht")),i=Number(g.getConfigIntValue("rechargeProtectTimeInterval"));console.log("retryNoticeServerPay begin="+b.TimeOffSetManager.getServerUTCSecond()+" orderId="+e+" count="+o+" interval="+i);var a=0;t.m_RetryNoticeServerPay=!0;var n=setInterval(function(){if(a>=o)return clearInterval(n),g.setLocalData("userPayRechargeInfo",""),t.m_RetryNoticeServerPay=!1,void console.log("retryNoticeServerPay orderId="+e+" countMax="+b.TimeOffSetManager.getServerUTCSecond());if(""==g.getLocalData("userPayRechargeInfo",""))return clearInterval(n),t.m_RetryNoticeServerPay=!1,void console.log("retryNoticeServerPay orderId="+e+" localNull="+b.TimeOffSetManager.getServerUTCSecond());console.log("retryNoticeServerPay nextTry orderId="+e),a++;var i=new u.C_Recharge_Role_WeiXinGameMidasPay;i.orderuuid=e,c.ClientNetwork.getInstance().Send(u.RECHARGE_CLIENT_ENUM.P_Recharge_Role_WeiXinGameMidasPay,i,!1)},i)}},e.prototype.noticeServerPay=function(e){var t=r.default.checkModulerOnOffState(N.ModulerViewOnOff.rechargeProtect),o=new u.C_Recharge_Role_WeiXinGameMidasPay;o.orderuuid=e,c.ClientNetwork.getInstance().Send(u.RECHARGE_CLIENT_ENUM.P_Recharge_Role_WeiXinGameMidasPay,o,!1)?(cc.error("SendData NCS_ROLE_TEST_ADD_CHONGZHI finish!"),t||g.setLocalData("userPayRechargeInfo",""),console.log("pay success"+g.getLocalData("userPayRechargeInfo",""))):cc.error("SendData NCS_ROLE_TEST_ADD_CHONGZHI Error!"),t&&this.retryNoticeServerPay(e)},e.prototype.pay=function(e,t,o,a){console.log("rechargeInfo"+o),console.log("GlobalVar.getZoneId()"+m.GlobalVar.getZoneId());var n=p.RechargeTableData.getById(e);if(n){console.log("buyQuantity"+n.money),console.log("wxPayChange payType = "+a);var r=this.isAndroidwxChangePay(a);_.default.callRoleClientLog("wxPT="+a+" isCh="+r+" id="+e),a==i.wxPayType_custormer?this.customerServicePay(e,n,o,a):a==i.wxPayType_midas&&this.midasPay(e,n,o)}else g.MESSAGETIPS("RECHARGE_ID_NOTEXIST")},e.prototype.midasPay=function(e,t,o){var i=this,a="android";cc.sys.os==cc.sys.OS_WINDOWS&&(a="windows"),g.setLocalData("userPayRechargeInfo",o),console.log("pay prepare"+g.getLocalData("userPayRechargeInfo","")),wx.requestMidasPayment({mode:"game",env:0,offerId:"1450031718",platform:a,buyQuantity:t.money,currencyType:"CNY",zoneId:"98",success:function(){console.log("\u652f\u4ed8\u6210\u529f"),i.noticeServerPay(o)},fail:function(e){var t=e.errMsg,o=e.errCode;_.default.callRoleClientLog("wechat pay failed "+o),console.log(t,o),g.setLocalData("userPayRechargeInfo",""),console.log("pay fail"+g.getLocalData("userPayRechargeInfo",""))}})},e.prototype.customerServicePay=function(e,t,o,i){var a=JSON.parse(o);console.log("rechargeInfo out_trade_no"+a.out_trade_no),console.log("rechargeInfo total_fee"+a.total_fee),console.log("rechargeInfo info"+t.info),console.log("rechargeInfo recharge_time"+a.recharge_time);var r=s.G.StringManager.getWorldString(t.name);e>6&&(e=6);var c="https://mszctest-1300944069.file.myqcloud.com/diamond/"+e+".png",l="https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx31c34d17d4dc63b8&redirect_uri=https://mszcs1.gameserver.iplay11g.com/gmsys/web/wxPay.html?response_type=code&scope=snsapi_base&connect_redirect=1#wechat_redirect";this.isAndroidwxChangePay(i)&&(l="https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx31c34d17d4dc63b8&redirect_uri=https://mszcs1.gameserver.iplay11g.com/gmsys/web/wxPayV2.html?response_type=code&scope=snsapi_base&connect_redirect=1#wechat_redirect"),n.getSubmitReviewState()&&(l="https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx31c34d17d4dc63b8&redirect_uri=https://mszctest.gameserver.iplay11g.com/gmsys/web/wxPay.html?response_type=code&scope=snsapi_base&connect_redirect=1#wechat_redirect",this.isAndroidwxChangePay(i)&&(l="https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx31c34d17d4dc63b8&redirect_uri=https://mszctest.gameserver.iplay11g.com/gmsys/web/wxPayV2.html?response_type=code&scope=snsapi_base&connect_redirect=1#wechat_redirect"));var d='{"type": "image", "title": "'+t.info+'","nickName":"\u5145\u503c\u5c0f\u52a9\u624b","avatarUrl":"https://mszctest-1300944069.file.myqcloud.com/diamond/zhanche.png", "url": "'+l+'", "desc": "'+r+'","img": "'+c+'"';console.log("rechargeInfo openSetting"+d);var u=',"api_reply_type": "receive_reply","reply_type":"multiple","title": "'+t.info+'","description": "'+r+'","url": "'+l+'","thumb_url": "'+c+'"';console.log("rechargeInfo revSetting"+u);var h=(new Date).getTime(),p=',"params":"&state='+a.out_trade_no+"_"+t.info+"_"+a.total_fee+"_"+h+"_"+a.recharge_time+'"}';console.log("rechargeInfo param"+p);var f={sessionFrom:d+u+p,showMessageCard:!0,sendMessageTitle:"\u5854\u9632\u7cbe\u7075",sendMessagePath:"game",sendMessageImg:"https://mszctest-1300944069.file.myqcloud.com/diamond/recharge1.png",success:function(e){console.log("success =",e)},fail:function(e){console.log("fail =",e)},complete:function(e){console.log("complete =",e)}};wx.openCustomerServiceConversation(f)},e.prototype.inviteFriend=function(e,t,o,i,a,n){if(void 0===n&&(n=null),!s.G.UIManager.isFinghtingScene()){wx.shareAppMessage({title:e,imageUrlId:t,imageUrl:o,query:i});var r=new h.C_Role_ClientFinishShare;r.shareID=a,r.is_share=0,c.ClientNetwork.getInstance().Send(h.ROLE_CLIENT_ENUM.P_Role_ClientFinishShare,r),setTimeout(function(){n&&n()},500)}},e.prototype.checkInviteInfo=function(e){if(f.GamePlatform.isWechat()){var t;for(var o in(t=e||wx.getLaunchOptionsSync()).query){if("battle"==o){var i=t.query.battle;if(i){console.log("checkInviteInfo battleInfo"+i);var a=i.split(".");if((n=new d.C_Match_Duel_Fight).fightType=Number(a[0]),n.useRoom=0,n.roomID=a[1],n.params.push(g.getConfigVersion()),Number(a[0])==y.FIGHT_TYPE.FIGHT_TYPE_MACHINARIUM&&0==E.default.Instance.getMachineryCityState())return!1;if(w.default.isChickenDinnerMatching())return s.G.StringManager.PopString(s.G.StringManager.getString("CHICKENDINNER_MATCHING")),_.default.callRoleClientLog("CHICKENDINNER_MATCHING4"),void console.log("isChickenDinnerMatching code=4");c.ClientNetwork.getInstance().Send(d.MATCH_CLIENT_ENUM.P_Match_Duel_Fight,n,!1)}}if("invite"==o){var n,r=t.query.invite;r&&(console.log("checkInviteInfo inviteInfo"+r),(n=new h.C_Role_ShareBindMaster).masterID=r,c.ClientNetwork.getInstance().Send(h.ROLE_CLIENT_ENUM.P_Role_ShareBindMaster,n,!1))}}}},e.prototype.getChannelID=function(){var e=wx.getLaunchOptionsSync(),t=e.query,o=(t.gdt_vid,t.weixinadinfo),i=t.channel,a=t.ad_id,n=t.unit_id,r=t.ksUnitId,s=t.clue_token,c=t.promotion_id;if(s)return a?Number(a)%1e9:c?Number(c)%1e9:60102;if(a)return Number(a)%1e9;if(n)return Number(n);if(r)return Number(r);var l=0;return o&&o.split("."),i?(l=Number(i),wx.setStorage({key:"wxaid",data:l}),l):(console.log("getChannelID "+JSON.stringify(e)),5e4)},e.prototype.onCreatGameClubBtn=function(e){if(!this.m_gameClubBtn){wx.getSystemInfoSync(),e.getBoundingBoxToWorld();var t=cc.size(e.width+10,e.height+10),o=cc.view.getFrameSize(),i=cc.director.getWinSize(),a=(.5*i.width+e.x-.5*t.width)/i.width*o.width,n=(.5*i.height-e.y-.5*t.height)/i.height*o.height,r=t.width/i.width*o.width,s=t.height/i.height*o.height;this.m_gameClubBtn=wx.createGameClubButton({type:"text",text:"",style:{left:a,top:n,width:r,height:s,lineHeight:0,backgroundColor:"",color:"#3296fa",textAlign:"center",fontSize:16,borderRadius:4}})}},e.prototype.onVideoShareBtnToGameClub=function(){this.m_wxVideoRecordTime>6e4&&(this.m_wxVideoRecordTime=6e4),wx.operateGameRecorderVideo({title:"",desc:"",query:"share=gameRecordVideo",path:"",bgm:"",timeRange:[[0,this.m_wxVideoRecordTime]],volume:1,atempo:1,audioMix:!1,success:function(e){return console.log("\u5bf9\u5c40\u56de\u653e\u5206\u4eab\u6210\u529f",e)},fail:function(e){return console.error("\u5bf9\u5c40\u56de\u653e\u5206\u4eab\u5931\u8d25",e)},complete:function(e){return console.log("\u5bf9\u5c40\u56de\u653e\u5206\u4eab\u5b8c\u6210",e)}})},e.prototype.onCreatVideoShareBtn=function(e){if(!this.m_wxShareVideoBtn){wx.getSystemInfoSync(),e.getBoundingBoxToWorld();var t=cc.size(e.width+10,e.height+10),o=cc.view.getFrameSize(),i=cc.director.getWinSize(),a=(.5*i.width+e.x-.5*t.width)/i.width*o.width,n=(.5*i.height-e.y-.5*t.height)/i.height*o.height,r=t.width/i.width*o.width,s=t.height/i.height*o.height;this.m_wxShareVideoBtn=wx.createGameRecorderShareButton({style:{left:a+10,top:n,width:120,height:s,iconMarginRight:r,lineHeight:0,backgroundColor:"transparent",color:"#fff",textAlign:"center",fontSize:12,borderRadius:4,paddingLeft:1,paddingRight:20},image:"",icon:"",text:"",share:{bgm:"",TimeRanges:[[1e3,this.m_wxVideoRecordTime]]}})}},e.prototype.wxReportAnalytics=function(e,t){f.GamePlatform.isWechat()&&wx.reportAnalytics(e,t)},e.prototype.wxOpenChannelsLive=function(){wx.openChannelsLive?wx.openChannelsLive({finderUserName:"sphKR1PR00Z3jIQ",success:function(e){console.log("\u6253\u5f00\u89c6\u9891\u53f7\u76f4\u64ad\u6210\u529f  ",e)},fail:function(e){console.log("\u6253\u5f00\u89c6\u9891\u53f7\u76f4\u64ad\u5931\u8d25 ",e)},complete:function(e){console.log("\u6253\u5f00\u89c6\u9891\u53f7\u76f4\u64ad\u8c03\u7528\u7ed3\u675f\u7684\u56de\u8c03\u51fd\u6570",e)}}):wx.showModal({title:"\u63d0\u793a",content:"\u5f53\u524d\u5fae\u4fe1\u7248\u672c\u8fc7\u4f4e\uff0c\u65e0\u6cd5\u4f7f\u7528\u8be5\u529f\u80fd\uff0c\u8bf7\u5347\u7ea7\u5230\u6700\u65b0\u5fae\u4fe1\u7248\u672c\u540e\u91cd\u8bd5\u3002"})},e.prototype.wxOnGameLiveStateChange=function(){var e=this;wx.onGameLiveStateChange&&wx.onGameLiveStateChange(function(t){if("start"===t.state){e.setSameLiveFeedId(t.feedId),e.wxSyncLiveTimeUpdate();var o=new h.C_Role_Live_Begin;c.ClientNetwork.getInstance().Send(h.ROLE_CLIENT_ENUM.P_Role_Live_Begin,o)}"end"===t.state&&(e.m_syncLiveTime&&(clearInterval(e.m_syncLiveTime),e.m_syncLiveTime=null),e.wxGetUserRecentGameLiveInfo())})},e.prototype.wxGetUserRecentGameLiveInfo=function(){var e=this,t=this.getGameLiveFeedId();if(!t)return s.G.StringManager.PopString("\u672a\u67e5\u8be2\u5230\u5f53\u524d\u76f4\u64ad\u6570\u636e!");wx.getUserGameLiveDetails?wx.getUserGameLiveDetails({feedIdList:[t],success:function(e){var t=new h.C_Role_WeiXinAnalyzingMessage;t.encryptedData=e.encryptedData,t.iv=e.iv,c.ClientNetwork.getInstance().Send(h.ROLE_CLIENT_ENUM.P_Role_WeiXinAnalyzingMessage,t)},fail:function(t){setTimeout(function(){if(0==t.err_code){e.setSameLiveFeedId(""),wx.showModal({title:"\u63d0\u793a",content:"\u83b7\u53d6\u5fae\u4fe1\u76f4\u64ad\u6570\u636e\u9519\u8bef\uff0c\u8bf7\u4e0a\u4f20\u65e5\u5fd7\u5230\u5fae\u4fe1\uff01"});var o=[];return o[0]=t.err_code,void f.GamePlatform.reportWXLog(o)}e.wxGetUserRecentGameLiveInfo()},1e3)}}):wx.showModal({title:"\u63d0\u793a",content:"\u5f53\u524d\u5fae\u4fe1\u7248\u672c\u8fc7\u4f4e\uff0c\u65e0\u6cd5\u4f7f\u7528\u8be5\u529f\u80fd\uff0c\u8bf7\u5347\u7ea7\u5230\u6700\u65b0\u5fae\u4fe1\u7248\u672c\u540e\u91cd\u8bd5\u3002"})},e.prototype.wxSyncLiveTimeUpdate=function(){var e=this;this.m_syncLiveTime&&(clearInterval(this.m_syncLiveTime),this.m_syncLiveTime=null),this.m_syncLiveTime=setInterval(function(){if(e.wxGetGameLiveState()){var t=new h.C_Role_Live_Update;c.ClientNetwork.getInstance().Send(h.ROLE_CLIENT_ENUM.P_Role_Live_Update,t),setTimeout(function(){var e=[];Array.from(r.default.getRoleTaskData().tasks.values()).forEach(function(t){var o=C.TaskTableData.getById(t.taskID);o.type==y.TASK_TYPE.TASK_TYPE_COUNT_CLIENT&&o.clientType==y.TASK_CLIENT_TYPE.TASK_CLIENT_TYPE_ACHIEVEMENT_LIVE_TIME&&e.push(t)});var t=r.default.getRoleAttrValByKey(y.ROLE_ATTR_VALUES.ROLE_ATTR_DAYLIVETIME);e.forEach(function(e){e.taskCount=t});for(var o=0;o<e.length;o++){var i=new h.C_Role_ClientTaskUpdateCount;i.taskID=e[o].taskID,i.count=e[o].taskCount,c.ClientNetwork.getInstance().Send(h.ROLE_CLIENT_ENUM.P_Role_ClientTaskUpdateCount,i,!1)}c.ClientNetwork.getInstance().pushLocalMessage(l.LOCAL_MESSAGE.LocalMsg_RefreshTask);var a=v.default.getViewByName("MainSceneView");a&&a.view&&a.view.onSyncChangeLiveTaskData()},500)}else clearInterval(e.m_syncLiveTime),e.m_syncLiveTime=null},6e4)},e.prototype.wxOffGameLiveStateChange=function(){wx.offGameLiveStateChange&&wx.offGameLiveStateChange()},e.prototype.wxGetGameLiveState=function(){return!!wx.getGameLiveState&&wx.getGameLiveState().isLive},e.prototype.wxOpenChannelsLiveCollection=function(){wx.openChannelsLiveCollection?wx.openChannelsLiveCollection({openIds:["odsRR5LjOn0uTKVnZp6m6HsSXVlo","odsRR5FMCyq5zovt6zjpPZ6yycxE","odsRR5EhT35UbdJUBrTlk6qZ0PnA","odsRR5OLSTjLgvO6NavSH6FjheIk"]}):wx.showModal({title:"\u63d0\u793a",content:"\u5f53\u524d\u5fae\u4fe1\u7248\u672c\u8fc7\u4f4e\uff0c\u65e0\u6cd5\u4f7f\u7528\u8be5\u529f\u80fd\uff0c\u8bf7\u5347\u7ea7\u5230\u6700\u65b0\u5fae\u4fe1\u7248\u672c\u540e\u91cd\u8bd5\u3002"})},e.prototype.getGameLiveFeedId=function(){var e=g.getLocalData("GameLiveFeedId");return e.length<=0?null:e},e.prototype.setSameLiveFeedId=function(e){g.setLocalData("GameLiveFeedId",e)},e.prototype.onSendKSConversionInfo=function(e,t){void 0===t&&(t=0);var o=this;if(wx.getStorageSync("ks_callback"))wx.getStorage({key:"ks_callback",success:function(i){console.log(i.data),o.onSyncKSreturnback(i.data,e,t)}});else{var i=function(){var e=wx.getLaunchOptionsSync().query;return e.callback&&e.ksUnitId?(console.log("\u6253\u5370\u5feb\u624b\u53c2\u6570",e.callback),e.callback):null}.call(this);if(!i)return void console.log("not get ks_callback---------------------------------------------------!");wx.setStorage({key:"ks_callback",data:i,success:function(){o.onSyncKSreturnback(i,e,t)}})}},e.prototype.onSyncKSreturnback=function(e,t,o){if(console.log("\u6253\u5370\u53c2\u6570\u5feb\u624b---------------------------  ",e,t,o),e){var i={};i=3==t?{callback:e,event_type:t,purchase_amount:o.toFixed(2)}:{callback:e,event_type:t},wx.request({url:"https://mszcs1.gameserver.iplay11g.com/gmsys/weblogic/webc/gifshowreturnback.php",data:i,success:function(e){console.log("onSendKS success=======================",e.data),S.TalkingDataAPI.event("onSendKS.success",{code:e.data}),_.default.callRoleClientLog(e.data)},fail:function(e){console.log("onSendKS failed1======================="+e),S.TalkingDataAPI.event("onSendKS.failed",{code:e}),_.default.callRoleClientLog("onSendKS.failed")}})}},e.prototype.onSendAQiYiConversionInfo=function(e,t){void 0===t&&(t=0);var o=this;if(wx.getStorageSync("aqiyi_clickid"))wx.getStorage({key:"aqiyi_clickid",success:function(i){console.log(i.data),o.onSyncAQiYireturnback(i.data,e,t)}});else{var i=function(){var e=wx.getLaunchOptionsSync().query;return e.c?(console.log("\u6253\u5370\u53c2\u6570",e.c),e.c):null}.call(this);if(!i)return S.TalkingDataAPI.event("aqyNoclickid"),_.default.callRoleClientLog("aqyNoclickid"),void console.log("not get aqyNoclickid!");wx.setStorage({key:"aqiyi_clickid",data:i,success:function(){o.onSyncAQiYireturnback(i,e,t)}})}},e.prototype.onSyncAQiYireturnback=function(e,t,o){console.log("\u6253\u5370\u53c2\u6570aqiyi  ",e,t,o),e&&(o=o||0,wx.request({url:"https://mszctest.gameserver.iplay11g.com/gmsys/weblogic/webc/iqiyi/iqiyireturnback.php",data:{impress_id:e,event_type:t,pmao:o},success:function(e){console.log("onSendAQY success",e.data),S.TalkingDataAPI.event("onSendAQY.success",{code:e.data}),_.default.callRoleClientLog(e.data)},fail:function(e){console.log("onSendAQY failed1"+e),S.TalkingDataAPI.event("onSendAQY.failed",{code:e}),_.default.callRoleClientLog("onSendAQY.failed")}}))},e.prototype.onSendXTConversionInfo=function(e,t){void 0===t&&(t=0);var o=this;if(wx.getStorageSync("xt_clickid"))wx.getStorage({key:"xt_clickid",success:function(i){console.log(i.data),o.onSyncXTreturnback(i.data,e,t)}});else{var i=function(){var e=wx.getLaunchOptionsSync().query;return e.clickid?(console.log("\u6253\u5370\u53c2\u6570",e.clickid),e.clickid):null}.call(this);if(!i)return S.TalkingDataAPI.event("xtNoclickid"),_.default.callRoleClientLog("xtNoclickid"),void console.log("not get xtNoclickid!");wx.setStorage({key:"xt_clickid",data:i,success:function(){o.onSyncXTreturnback(i,e,t)}})}},e.prototype.onSyncXTreturnback=function(e,t,o){console.log("\u6253\u5370\u53c2\u6570XT  ",e,t,o),e&&(o=o||0,wx.request({url:"https://mszcs1.gameserver.iplay11g.com/gmsys/weblogic/webc/bytedanceliveturnback.php",data:{callback:e,event_type:t,pay_amount:o},success:function(e){console.log("onSendXT success",e.data),S.TalkingDataAPI.event("onSendXT.success",{code:e.data}),_.default.callRoleClientLog(e.data)},fail:function(e){console.log("onSendXT failed1"+e),S.TalkingDataAPI.event("onSendXT.failed",{code:e}),_.default.callRoleClientLog("onSendXT.failed")}}))},e.prototype.onSendUcConversionInfo=function(e,t){void 0===t&&(t="0");var o=this;if(wx.getStorageSync("uc_trackid"))wx.getStorage({key:"uc_trackid",success:function(i){console.log(i.data),o.onSyncUcreturnback(i.data,e,t)}});else{var i=function(){var e=wx.getLaunchOptionsSync().query;return e.uctrackid?(console.log("\u6253\u5370\u53c2\u6570",e.uctrackid),e.uctrackid):null}.call(this);if(!i)return S.TalkingDataAPI.event("ucNoTrackid"),_.default.callRoleClientLog("ucNoTrackid"),void console.log("not get ucNoTrackid!");wx.setStorage({key:"uc_trackid",data:i,success:function(){o.onSyncUcreturnback(i,e,t)}})}},e.prototype.onSyncUcreturnback=function(e,t,o){console.log("\u6253\u5370\u53c2\u6570Uc  ",e,t,o),e&&(o=o||"0",wx.request({url:"https://mszctest.gameserver.iplay11g.com/gmsys/weblogic/webc/ucreturnback.php",data:{uctrackid:e,type:t,money:o,source:"ucdata"},success:function(e){console.log("onSendUC success",e.data),S.TalkingDataAPI.event("onSendUC.success",{code:e.data}),_.default.callRoleClientLog(e.data)},fail:function(e){console.log("onSendUC failed1"+e),S.TalkingDataAPI.event("onSendUC.failed",{code:e}),_.default.callRoleClientLog("onSendUC.failed")}}))},e.prototype.onSendBiliConversionInfo=function(e,t){void 0===t&&(t=1);var o=this;if(wx.getStorageSync("bili_trackid"))wx.getStorage({key:"bili_trackid",success:function(i){console.log(i.data),o.onSyncBilireturnback(i.data,e,t)}});else{var i=function(){var e=wx.getLaunchOptionsSync().query;return e.trackid?(console.log("\u6253\u5370\u53c2\u6570",e.trackid),e.trackid):null}.call(this);if(!i)return S.TalkingDataAPI.event("biliNoTrackid"),_.default.callRoleClientLog("biliNoTrackid"),void console.log("not get biliNoTrackid!");wx.setStorage({key:"bili_trackid",data:i,success:function(){o.onSyncBilireturnback(i,e,t)}})}},e.prototype.onSyncBilireturnback=function(e,t,o){console.log("\u6253\u5370\u53c2\u6570B\u7ad9  ",e,t,o),e&&(o=o||1,wx.request({url:"https://mszcs1.gameserver.iplay11g.com/gmsys/weblogic/webc/bilibilireturnback.php",data:{conv_type:t,track_id:e,conv_value:o},success:function(e){console.log("onSendBili success",e.data),S.TalkingDataAPI.event("onSendBili.success",{code:e.data}),_.default.callRoleClientLog(e.data)},fail:function(e){console.log("onSendBili failed1"+e),S.TalkingDataAPI.event("onSendBili.failed",{code:e}),_.default.callRoleClientLog("onSendBili.failed")}}))},e.prototype.onSendFeishuConversionInfo=function(e,t){void 0===t&&(t=0);var o=this;if(wx.getStorageSync("feishu_clue_token"))wx.getStorage({key:"feishu_clue_token",success:function(i){console.log(i.data),o.onSyncFeishureturnback(i.data,e,t)}});else{var i=function(){var e=wx.getLaunchOptionsSync().query;return e.clue_token?e.clue_token:null}.call(this);if(!i)return S.TalkingDataAPI.event("feishuNoClueToken"),_.default.callRoleClientLog("feishuNoClueToken"),console.log("not get clue_token!");wx.setStorage({key:"feishu_clue_token",data:i,success:function(){o.onSyncFeishureturnback(i,e,t)}})}},e.prototype.onSyncFeishureturnback=function(e,t,o){if(e){o=o||0;var i={clue_token:e,union_id:this.m_weichatLoginData.accountname,open_id:this.m_weichatLoginData.openid,event_type:t,pay_amount:o,packageID:this.getChannelID()};_.default.callRoleClientLog(JSON.stringify(i)),wx.request({url:"https://mszcs1.gameserver.iplay11g.com/gmsys/weblogic/webc/feishureturnback.php",data:{clue_token:e,union_id:this.m_weichatLoginData.accountname,open_id:this.m_weichatLoginData.openid,event_type:t,pay_amount:o},success:function(e){console.log("onSendFeishu success",e.data),S.TalkingDataAPI.event("onSendFeishu.success",{code:e.data}),_.default.callRoleClientLog(e.data)},fail:function(e){console.log("onSendFeishu failed1"+e),S.TalkingDataAPI.event("onSendFeishu.failed",{code:e}),_.default.callRoleClientLog("onSendFeishu.failed")}})}},e.prototype.getGameClubTaskInfo=function(e){wx.getGameClubData({dataTypeList:e,success:function(e){if(e){console.log("get gameClubTask success ",e);var t=new h.C_Role_WeiXinAnalyzingMessage;t.encryptedData=e.encryptedData,t.iv=e.iv,c.ClientNetwork.getInstance().Send(h.ROLE_CLIENT_ENUM.P_Role_WeiXinAnalyzingMessage,t)}},fail:function(e){console.log("get gameClubTask fail"+e)},complete:function(e){console.log("get gameClubTask complete =========================================",e)}})},e.prototype.shareRenderTexture=function(e){var t=cc.game.canvas,o=t.width,i=t.height,a=1*o,n=1*i,r=0*o,s=0*i,c=t.toTempFilePathSync({x:r,y:s,width:a,height:n,destWidth:500,destHeight:400});console.log("getRenderTexture"+c),wx.shareAppMessage({title:e,imageUrl:c})},e.prototype.startVideoRecording=function(){var e=wx.getGameRecorder(),t=this;console.log("\u662f\u5426\u652f\u6301\u5f55\u5236\u6e38\u620f\u753b\u9762",e.isFrameSupported()),e.on("start",function(){console.log("start video Recorfing")}),e.on("stop",function(e){console.log("stop video Recorfing"),console.log("\u5bf9\u5c40\u56de\u653e\u65f6\u957f: "+e.duration),t.m_wxVideoRecordTime=e.duration,c.ClientNetwork.getInstance().pushLocalMessage(l.LOCAL_MESSAGE.LocalMsg_ShowGameRecorderBtn)}),e.on("resume",function(){console.log("resume video Recorfing")}),e.on("abort",function(){console.log("abort video")}),e.isFrameSupported()?(e.start(),t.m_isClickVideoRecord=!0):s.G.StringManager.PopString("\u8be5\u8bbe\u5907\u4e0d\u652f\u6301\u89c6\u9891\u5f55\u5236")},e.prototype.stopVideoRecording=function(){wx.getGameRecorder().stop()},e.prototype.canChangeAndroidWxPay=function(){var e=r.default.checkModulerOnOffState(49);console.log("wxPayChange functiononOff = "+e);var t=new Set;t.add(101042391),t.add(101000246),t.add(214009229),t.add(102000864),t.add(101029209),t.add(101000014);var o=r.default.getRoleAttrValByKey(y.ROLE_ATTR_VALUES.ROLE_ATTR_RECHARGENUM),i=Number(g.getConfigIntValue("changeWxPayRechargeNum")),a=Number(r.default.otherUUidTransformRoieId(r.default.UUID));return console.log("wxPayChange rechargeNum="+o+" min="+i+" roleId="+a),!(o<i&&!t.has(a)||(console.log("wxPayChange check os"),!f.GamePlatform.isWechat()||!e||cc.sys.os!=cc.sys.OS_ANDROID))},e.prototype.isAndroidwxChangePay=function(e){return null!=this.getNormalwxPayType()&&this.getNormalwxPayType()!=e},e.prototype.getNormalwxPayType=function(){return f.GamePlatform.isWechat()?cc.sys.os==cc.sys.OS_ANDROID||cc.sys.os==cc.sys.OS_WINDOWS?i.wxPayType_midas:cc.sys.os==cc.sys.OS_IOS?i.wxPayType_custormer:null:null},e.prototype.requestAndroidwxChangePay=function(e,t,o){var i="https://mszcs1.gameserver.iplay11g.com/gmsys/weblogic/webc/checkPay.php";n.getSubmitReviewState()&&(i="https://mszctest.gameserver.iplay11g.com/weblogic/webc/checkPay.php"),i+="?roleid="+r.default.otherUUidTransformRoieId(r.default.UUID)+"&rechargeid="+t,console.log("wxPayChange url = "+i),wx.request({url:i,success:function(e){var t=JSON.stringify(e.data);if(console.log("wxPayChange json = "+t),e){var i=Number(e.data.errorcode);console.log("wxPayChange ret = "+i),o&&o(0==i)}else o&&o(!1)},fail:function(){o&&o(!1)}})},e.prototype.onSendAiQiYiConversionInfo=function(){var e=this;"1"==this.isOpenAQYJump?wx.request({url:"https://mszctest.gameserver.iplay11g.com/gmsys/weblogic/webc/iqiyi/iqiyiweixingameadvertiseclient.php",success:function(t){console.log("onSendAiQIYiConversionInfo success",t.data);var o=JSON.stringify(t.data);console.log("onSendAiQIYiConversionInfo res.data="+o),t.data.length<=0||(wx.getStorageSync("isAIQIYI")?wx.getStorage({key:"isAIQIYI",success:function(t){console.log(t.data),e.onSyncAIQIYIturnback(t.data,a.APP_FIRST_ACTIVE)}}):wx.setStorage({key:"isAIQIYI",data:t.data,success:function(){e.onSyncAIQIYIturnback(t.data,a.APP_FIRST_ACTIVE)}}))},fail:function(e){console.log("onSendAiQIYiConversionInfo failed1"+e)}}):console.log("this.isOpenAQYJump========false=====1")},e.prototype.requestAiQiYiJumpIsOpen=function(){var e="https://mszcs1.gameserver.iplay11g.com/gmsys/gameClubOpenlink.php?"+Math.random(),t=this;wx.request({url:e,success:function(e){e&&(t.isOpenAQYJump=e.data.isOpenAiQiYi)},fail:function(e){t.isOpenAQYJump="0",console.log("requestAiQiYiJumpIsOpen fail"+e)}})},e.prototype.onSyncAIQIYIturnback=function(e,t,o){if(void 0===o&&(o=0),"1"==this.isOpenAQYJump)if(e.length<=0)console.log("tdata.length========null=====");else{console.log("onSyncAIQIYIturnback=============",e);var i=decodeURI(e.callback_url).replace("__PAYMENT_AMOUNT__",String(o));console.log("url-----------------------------------",i),wx.request({url:i,data:{event_type:t},success:function(e){console.log("onSyncAIQIYIturnback success",e)},fail:function(e){console.log("onSyncAIQIYIturnback failed",e)}})}else console.log("this.isOpenAQYJump========false=====2")},e.prototype.isFrom360dianjing=function(){return"wechat360dianjing"==this.geValueFromQuery("isFrom")},e.prototype.returnBack_360dianjing=function(e,t){if(0!=this.isFrom360dianjing()){var o=this.geValueFromQuery("impression_id"),i=this.geValueFromQuery("qhclickid"),a=this.geValueFromQuery("sourceid"),n="ocpc_zs_convert";a.length>0?(n="ocpc_zs_convert",i=a):i.length>0?n="ocpc_ps_convert":o.length>0&&(n="ocpc_web_convert"),console.log("returnBack_360dianjing, pEvent=",e),console.log("returnBack_360dianjing, data_industry=",n),console.log("returnBack_360dianjing, qhclickid=",i),console.log("returnBack_360dianjing, impression_id=",o),console.log("returnBack_360dianjing, sourceid=",a),wx.request({url:"https://mszctest.gameserver.iplay11g.com/gmsys/weblogic/webc/wechat360dianjing/wechat360dianjingreturnback.php",data:{event:e,data_industry:n,qhclickid:i,impression_id:o,value:t},success:function(e){console.log("returnBack_360dianjing success",e)},fail:function(e){console.log("returnBack_360dianjing failed",e)}})}},e.prototype.geValueFromQuery=function(e){var t=wx.getLaunchOptionsSync().query;return null!=t[e]?t[e]:""},e.Instance=null,e}();o.WechatUtils=P,cc._RF.pop()},{"../../load":"load","../Global/GameGlobal":"GameGlobal","../StaticData/RechargeTableData":"RechargeTableData","../StaticData/TaskTableData":"TaskTableData","../TalkingDataAPI":"TalkingDataAPI","../common/CommandValue":"CommandValue","../common/NetworkProtocolCommon":"NetworkProtocolCommon","../common/PlayerModule":"PlayerModule","../model/ServerAddrInfo":"ServerAddrInfo","../modules/base/GameView":"GameView","../network/ClientNetwork":"ClientNetwork","../network/LocalMessage":"LocalMessage","../network/protocol/MatchProtocols":"MatchProtocols","../network/protocol/RechargeProtocols":"RechargeProtocols","../network/protocol/RoleProtocols":"RoleProtocols","../network/protocol/TypeProtocols":"TypeProtocols","../view/activity/ActivityModule":"ActivityModule","../view/machineryCityActivity/MachineryCityModel":"MachineryCityModel","./GamePlatform":"GamePlatform","./GameUtils":"GameUtils","./LogUtil":"LogUtil","./TimeOffSetManager":"TimeOffSetManager","./subUtils/TypeDef":"TypeDef"}],WeekCooperationChatPanel:[function(e,t,o){"use strict";cc._RF.push(t,"e5250SKhrNMmZD5Lv3ClN69","WeekCooperationChatPanel");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/cores/UISuperLayout"),s=e("../../common/PlayerModule"),c=e("../../network/protocol/TypeProtocols"),l=e("../../network/ClientNetwork"),d=e("../../network/protocol/ChatProtocols"),u=e("../../network/protocol/ChatProtocols"),h=e("../../Global/GameGlobal"),p=cc._decorator,f=p.ccclass,g=p.property,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.scrollViewNode=null,t.unreadNode=null,t.tMsgDatas=new Array,t.nUnreadMsgCount=0,t}return a(t,e),t.prototype.onLoad=function(){var e=this,t=this.tMsgDatas;l.ClientNetwork.getInstance().listenProtocol(d.CHAT_CLIENT_ENUM.P_Chat_CloseFightRoom,function(o){o.resetPos();var i=new u.S_Chat_CloseFightRoom;if(i.read(o)){for(var a=!1,n=0;n<t.length;n++)if(t[n].chatType==c.TYPE_CHAT.TYPE_CHAT_ROOMFIGHT&&t[n].chatText==i.roomID&&1!=t[n].chatParam){t[n].chatParam=1,a=!0;break}1==a&&e.scrollViewNode.children.forEach(function(t){t.roomId&&t.roomId==i.roomID&&e.scrollViewNode.notifyRefreshItem(t)})}},this),this.schedule(function(){e.nUnreadMsgCount=0,e.tMsgDatas.forEach(function(t){t.bReadState&&0!=t.bReadState||e.nUnreadMsgCount++}),e.nUnreadMsgCount>99&&(e.nUnreadMsgCount=99),e.node.getChildByName("unread").active=e.nUnreadMsgCount>1,e.nUnreadMsgCount>=99?e.node.getChildByName("unread").children[0].getComponent(cc.Label).string=h.G.StringManager.getWorldString("chat_unread_max"):e.node.getChildByName("unread").children[0].getComponent(cc.Label).string=h.G.StringManager.getWorldString("chat_unread",e.nUnreadMsgCount)},.2),this.node.children[0].off("scroll-to-bottom"),this.node.children[0].on("scroll-to-bottom",function(){e.scrollViewNode.scrollView.isScrollBounceBottom=!0},this)},t.prototype.onEnable=function(){this.scrollViewNode.total(this.tMsgDatas.length),this.onClickUnreadCallBack()},t.prototype.addChatMsg=function(e){var t=this;1!=this.checkRoomInChannel(e)&&(this.tMsgDatas.push(e),0!=this.node.active&&(this.scrollViewNode.total(this.tMsgDatas.length),1!=s.default.UUID.equals(e.roleID)&&1!=this.scrollViewNode.scrollView.isScrollBounceBottom||(e.bReadState=1,setTimeout(function(){try{t.scrollViewNode.scrollToFooter(.1)}catch(e){}},50))))},t.prototype.onClickUnreadCallBack=function(){var e=this;this.tMsgDatas.forEach(function(e){e.bReadState=1}),this.scrollViewNode.scrollView.isScrollBounceBottom=!0,setTimeout(function(){try{e.scrollViewNode.scrollToFooter(.1)}catch(t){}},50)},t.prototype.checkRoomInChannel=function(e){for(var t=0;t<this.tMsgDatas.length;t++)if(this.tMsgDatas[t].chatText==e.chatText&&this.tMsgDatas[t].chatType==c.TYPE_CHAT.TYPE_CHAT_ROOMFIGHT)return!0;return!1},t.prototype.onListRender=function(e,t){e.getComponent("ChatItem").show(this.tMsgDatas[t])},t.prototype.onDestroy=function(){this.unscheduleAllCallbacks(),l.ClientNetwork.getInstance().removeMessageTarget(this)},n([g(r.default)],t.prototype,"scrollViewNode",void 0),n([g(cc.Node)],t.prototype,"unreadNode",void 0),n([f],t)}(cc.Component);o.default=m,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../common/PlayerModule":"PlayerModule","../../modules/cores/UISuperLayout":"UISuperLayout","../../network/ClientNetwork":"ClientNetwork","../../network/protocol/ChatProtocols":"ChatProtocols","../../network/protocol/TypeProtocols":"TypeProtocols"}],WeekCooperationRankListTableData:[function(e,t,o){"use strict";cc._RF.push(t,"acf7eAUDdpC+L2z8CEBwtqK","WeekCooperationRankListTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.WeekCooperationRankListTableData=void 0;var i=e("../TableReader"),a=e("./BaseTableData"),n=function(){function e(){this.id=0,this.rankMin=0,this.rankMax=0,this.seasonId=0,this.mailid=0,this.prize=new Array}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.rankMin=e.getNumber(),this.rankMax=e.getNumber(),this.seasonId=e.getNumber(),this.mailid=e.getNumber();for(var o=e.getString(),n=new i.TableReader(o);n.getPos()<n.getLen();){var r=new a.DropItem;r.readOriginal(n),this.prize.push(r)}},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"WeekCooperationRankListTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.WeekCooperationRankListTableData=n,cc._RF.pop()},{"../TableReader":"TableReader","./BaseTableData":"BaseTableData"}],WeekCooperationReliveIntroduceView:[function(e,t,o){"use strict";cc._RF.push(t,"71a55Jz/s5JUaFF497TIlWo","WeekCooperationReliveIntroduceView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=cc._decorator,l=c.ccclass,d=(c.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.path=function(){return"ui/weekCooperationRelive/prefab/WeekCooperationReliveIntroduce"},n([s.Register_Class,l],t)}(r.default));o.default=d,cc._RF.pop()},{"../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators"}],WeekCooperationReliveMainView:[function(e,t,o){"use strict";cc._RF.push(t,"9cd73twQEhNN50gGgItLvj2","WeekCooperationReliveMainView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=e("../../modules/base/GameView"),l=e("../../utils/List"),d=e("../../network/ClientNetwork"),u=e("../../network/protocol/RoleProtocols"),h=e("../../network/protocol/MatchProtocols"),p=e("../../utils/GameTools"),f=e("../../network/protocol/TypeProtocols"),g=e("../../common/PlayerModule"),m=e("../../Global/GameGlobal"),_=e("../../StaticData/WeekCooperationRankListTableData"),y=e("../../StaticData/ActivityTableData"),v=e("../../network/protocol/ActivityProtocols"),C=e("../../common/CombatModule"),S=e("../activity/ActivityModule"),T=e("../../common/EventConst"),I=e("../../modules/manager/EventManager"),N=e("../../common/CommandValue"),b=e("../../network/protocol/TypeProtocols"),w=e("../../StaticData/WeekCooperationReliveTableData"),E=e("../../utils/GameUtils"),P=e("../../utils/ResourcesManager"),R=e("../../StaticData/OccupationRankListTableData"),L=cc._decorator,A=L.ccclass,D=L.property,M=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.rankListPanelNode=null,t.shopPanelNode=null,t.myRankInfoNode=null,t.shopItemPrefab=null,t.m_chatNode=null,t.snowNumLab=null,t.fightBtnNode=null,t.buyCountBtnNode=null,t.assistFightBtnNode=null,t.m_RankJobImageNode=null,t.m_JobRankListNode=null,t.m_JobMyRankNode=null,t.m_tRankListData=[],t.m_nRankPageIdx=1,t.m_nRankMaxPage=0,t.m_nGetRandShopId=6,t.m_snowItemId=1016,t.tJobRankListData=[],t.nJobRankPageIdx=1,t.nJobRankMaxPage=0,t}return a(t,e),t.path=function(){return"ui/weekCooperationRelive/prefab/WeekCooperationReliveMain"},t.prototype.onLoad=function(){this.hideMainChatView()},t.prototype.start=function(){this.setChatViewVisible(!0),this.initListenMessageEvent(),this.callRankListData();var e=new u.C_Role_GetRandShop;e.shopID=this.m_nGetRandShopId,d.ClientNetwork.getInstance().Send(u.ROLE_CLIENT_ENUM.P_Role_GetRandShop,e),this.initWeekCooperationState(),this.rankListPanelNode.node.on("bounce-bottom",this.onScrollBottom,this);var t=S.default.getWeekCooperationData().refleshRobotId;if(!t||isNaN(t)||t<=0)return m.G.StringManager.PopString("\u804c\u4e1aID\u6570\u636e\u9519\u8bef\uff01");P.default.loadSprite("ui/weekCooperationRelive/image/job"+t,this.m_RankJobImageNode.getComponent(cc.Sprite)),this.m_JobRankListNode.node.on("bounce-bottom",this.onJobRankScrollBottom,this)},t.prototype.setChatViewVisible=function(e){1==e?this.initChatView():this.destroyChatView()},t.prototype.initChatView=function(){var e=c.default.getViewByName("MainSceneView");if(e&&e.view){e.view.onSetChatBtnNodeActive(!1);var t=e.view.getMainChatNode();if(cc.isValid(t)){t.parent=this.node;var o=t.getChildByName("chatMain").getComponent("ChatMainView");o.setShowChannelTab([b.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_WEEK_COOPERATION,b.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_PRIVATE]),o.setChatChannel(b.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_WEEK_COOPERATION)}}this.m_chatNode.active=!0},t.prototype.destroyChatView=function(){this.m_chatNode.active=!1},t.prototype.hideMainChatView=function(){I.default.Instance.emit(T.default.SyncChatViewChange,N.ChatViewVisible.Retracting)},t.prototype.initListenMessageEvent=function(){var e=this;d.ClientNetwork.getInstance().listenProtocol(v.ACTIVITY_CLIENT_ENUM.P_Activity_WeekCooperationRelive,function(t){t.resetPos();var o=new v.S_Activity_WeekCooperationRelive;if(o.read(t))if(0===o.errorcode){e.assistFightBtnNode.active=!1,e.buyCountBtnNode.active=!1,e.fightBtnNode.active=!0,e.scheduleOnce(function(){var t=y.ActivityTableData.getById(v.ACTIVITY_ID_ENUM.P_Activity_WeekCooperationRelive),o=S.default.getWeekCooperationData(),i=t.param3-o.failcount;e.fightBtnNode.children[1].getComponent(cc.Label).string=i+"/"+(t.param3+o.reliveNum)},.2);var i=c.default.getViewByName("WeekCooperationReviveView");i&&i.view&&i.view.closeView()}else m.G.StringManager.PopString("\u51b0\u5821\u590d\u6d3b\u6570\u636e\u9519\u8bef "+o.errorcode)},this),d.ClientNetwork.getInstance().listenProtocol(u.ROLE_CLIENT_ENUM.P_Role_SynRandShopData,function(t){t.resetPos();var o=new u.S_Role_SynRandShopData;o.read(t)&&o.shopID===e.m_nGetRandShopId&&e.initShopListInfo(o.shopData)},this),d.ClientNetwork.getInstance().listenProtocol(u.ROLE_CLIENT_ENUM.P_Role_RandShopBuy,function(t){t.resetPos();var o=new u.S_Role_RandShopBuy;if(o.read(t))if(0===o.errorcode&&o.prize.length>0){c.default.addPopView("BaseCtrl","AcquirePopupView","AcquirePopupView",{items:o.prize});var i=c.default.getViewByName("ShopConfirmBuy");i&&i.view&&(i.view.node.active=!1,i.view.closeView()),e.snowNumLab.string=g.default.getItemCountByBag(e.m_snowItemId)}else m.G.StringManager.PopString("S_Role_RandShopBuy ERROR  "+o.errorcode)},this),d.ClientNetwork.getInstance().listenProtocol(h.MATCH_CLIENT_ENUM.P_Match_Fight,function(t){t.resetPos();var o=new h.S_Match_Fight;if(o.read(t)){var i=o.errorcode;8089==i?(e.unscheduleAllCallbacks(),c.default.addPopView("BaseCtrl","TipPopWindowView","TipPopWindowView",{content:m.G.StringManager.getString("BATTLE_VERSION_NOT_MATCH"),confirmCb:function(){var t=new h.C_Match_Cacel;d.ClientNetwork.getInstance().Send(h.MATCH_CLIENT_ENUM.P_Match_Cancel,t),e.onClickCloseCallBack()}})):0!=i&&m.G.StringManager.PopStringOnce(m.G.StringManager.getString("MATCH_ROOM_FAIL"))}},this)},t.prototype.initWeekCooperationState=function(){var e=y.ActivityTableData.getById(v.ACTIVITY_ID_ENUM.P_Activity_WeekCooperationRelive),t=S.default.getWeekCooperationData();if(t.reliveNum>=w.WeekCooperationReliveTableData.getDataMap().size&&t.failcount>=e.param3)this.assistFightBtnNode.active=!0,this.buyCountBtnNode.active=!1,this.fightBtnNode.active=!1;else if(e.param3-t.failcount<=0)this.assistFightBtnNode.active=!1,this.buyCountBtnNode.active=!0,this.fightBtnNode.active=!1,this.buyCountBtnNode.children[1].getComponent(cc.Label).string=w.WeekCooperationReliveTableData.getById(t.reliveNum+1).reliveCost[0].dropNum.toString();else{this.assistFightBtnNode.active=!1,this.buyCountBtnNode.active=!1,this.fightBtnNode.active=!0;var o=e.param3-t.failcount;this.fightBtnNode.children[1].getComponent(cc.Label).string=o+"/"+(e.param3+t.reliveNum)}},t.prototype.onScrollBottom=function(){this.m_nRankPageIdx>=this.m_nRankMaxPage||(this.m_nRankPageIdx++,this.callRankListData())},t.prototype.callRankListData=function(){var e=this,t=p.default.getDevelopRankListUrl();t+="?",t+="ranktype="+f.RANKLIST_TYPE.RANKLIST_TYPE_WEEK_COOPERATION,t+="&roleid="+g.default.uuidTransformRoieId(),t+="&page="+this.m_nRankPageIdx;var o=new XMLHttpRequest;o.onreadystatechange=function(){if(4==o.readyState&&o.status>=200&&o.status<400){var t=o.responseText.toString();t=(t=(t=t.replace('"','"')).replace("\ufeff","")).replace(" ","");var i=JSON.parse(t),a=i.page;e.m_nRankMaxPage=i.maxpage,Number(i.ranktype)==f.RANKLIST_TYPE.RANKLIST_TYPE_WEEK_COOPERATION&&Number(a)==e.m_nRankPageIdx&&e.resolvingWeekCoopRankData(i)}},o.open("GET",t,!0),o.send()},t.prototype.onRefreshRankEvent=function(e,t){var o=this.m_tRankListData[t];e.getComponent("RankListItem").initData(f.RANKLIST_TYPE.RANKLIST_TYPE_WEEK_COOPERATION,t+1,o)},t.prototype.resolvingWeekCoopRankData=function(e){1==Number(e.page)&&(this.m_tRankListData=[]);var t=this.myRankInfoNode.getChildByName("my_rank_num").getComponent(cc.Label),o=this.myRankInfoNode.getChildByName("my_score_label").getComponent(cc.Label),i=this.myRankInfoNode.getChildByName("my_time_label").getComponent(cc.Label),a=0,n=0;if("playerrank"in e&&(t.string=e.playerrank,"playerdata"in e)){var r=JSON.parse(e.playerdata);a=r.round,n=r.totaltime}if(0==Number(a)&&(a=S.default.getWeekCooperationData().historyMaxScore),o.string=a.toString(),i.string=function(e){var t=e%6e4/1e3;return parseInt((e%36e5/6e4).toString())+" \u5206 "+t+" \u79d2 "}.call(this,1e3*n),i.node.active=!(n<=0),"ranklist"in e){var s=e.ranklist;for(var c in s)Object.prototype.hasOwnProperty.call(s,c)&&this.m_tRankListData.push(s[c])}this.rankListPanelNode.numItems=this.m_tRankListData.length},t.prototype.initShopListInfo=function(e){var t=this;this.shopPanelNode.getChildByName("ShopLyoutNode").destroyAllChildren(),this.scheduleOnce(function(){e.positions.forEach(function(e,o){var i=cc.instantiate(t.shopItemPrefab);i.parent=t.shopPanelNode.getChildByName("ShopLyoutNode"),i.getComponent("NavigationShopItem").init(e,o,t.callRoleRandShopBuy),i.scale=.8})}),this.snowNumLab.string=g.default.getItemCountByBag(this.m_snowItemId)},t.prototype.onSetChatMsg=function(e){if(e.length<=0)return this.m_chatNode.getChildByName("msgNode").active=!1;var t=this.m_chatNode.getChildByName("msgNode"),o=t.getChildByName("label_chat"),i=t.getChildByName("label_chatDotLab");o.getComponent(cc.Label).string=e,i.active=!1,e.length>9&&(i.active=!0),t.active=!0},t.prototype.callRoleRandShopBuy=function(e){var t=new u.C_Role_RandShopBuy;t.shopID=6,t.shopPosition=e.shopPosition,t.shopItemID=e.shopItemID,d.ClientNetwork.getInstance().Send(u.ROLE_CLIENT_ENUM.P_Role_RandShopBuy,t)},t.prototype.onClickRankCallBack=function(){1!=this.rankListPanelNode.node.active&&(this.rankListPanelNode.node.active=!0,this.m_JobRankListNode.node.active=!1,this.myRankInfoNode.active=!0,this.shopPanelNode.active=!1,this.m_JobMyRankNode.active=!1,this.m_tRankListData.length<=0&&this.callRankListData())},t.prototype.onClickJobRankListCallBack=function(){1!=this.m_JobRankListNode.node.active&&(this.rankListPanelNode.node.active=!1,this.m_JobRankListNode.node.active=!0,this.myRankInfoNode.active=!1,this.shopPanelNode.active=!1,this.m_JobMyRankNode.active=!0,this.tJobRankListData.length<=0&&this.callJobRankListData())},t.prototype.onClickShopCallBack=function(){1!=this.shopPanelNode.active&&(this.shopPanelNode.active=!0,this.m_JobRankListNode.node.active=!1,this.myRankInfoNode.active=!1,this.rankListPanelNode.node.active=!1,this.m_JobMyRankNode.active=!1)},t.prototype.onClickFightCallBack=function(){return g.default.getRoleAttrValByKey(f.ROLE_ATTR_VALUES.ROLE_ATTR_WEEK_COOPERATION)<=0?m.G.StringManager.PopWorldString(m.G.StringManager.getWorldString("weekCooperationRelive_tip1",E.getConfigIntValue("week_cooperation_need_wave"))):0==S.default.getWeekCooperationIsOpen()?m.G.StringManager.PopWorldString(m.G.StringManager.getWorldString("weekCooperationRelive_tip2")):void c.default.addPopView("BaseCtrl","BattleRoomMainView","BattleRoomMainView",{CombatType:C.CombatType.COOP})},t.prototype.onClickChatBtnCallBack=function(){I.default.Instance.emit(T.default.SyncChatViewChange,[N.ChatViewVisible.Popup,b.TYPE_CHAT_CHANNEL.TYPE_CHAT_CHANNEL_WEEK_COOPERATION])},t.prototype.onClickReliveCallBack=function(){var e=this.buyCountBtnNode.children[1].getComponent(cc.Label).string,t=S.default.getWeekCooperationData();c.default.addPopView("BaseCtrl","WeekCooperationReviveView","WeekCooperationReviveView",{consume:e,surplus:w.WeekCooperationReliveTableData.getDataMap().size-t.reliveNum,callBack:function(){if(g.default.diamondNum<Number(e))return m.G.StringManager.PopWorldString("common_prompt_diamond_insufficient");var o=new v.C_Activity_WeekCooperationRelive;o.reliveNum=t.reliveNum+1,d.ClientNetwork.getInstance().Send(v.ACTIVITY_CLIENT_ENUM.P_Activity_WeekCooperationRelive,o)}})},t.prototype.onClickAssistFightCallBack=function(){if(0==S.default.getWeekCooperationIsOpen())return m.G.StringManager.PopWorldString(m.G.StringManager.getWorldString("weekCooperationRelive_tip2"));var e=c.default.getViewByName("WeekCooperationReviveView");e&&e.view&&e.view.closeView();var t=m.G.StringManager.getString("ASSISTBATTLE_TIP_WEEKCOOP");c.default.addPopView("BaseCtrl","AssistBattleView","AssistBattleView",{fightType:b.FIGHT_TYPE.FIGHT_TYPE_WEEK_COOPERATION,title:t.split("|")[0],tips:t.split("|")[1]})},t.prototype.onClickIntroduceCallBack=function(){c.default.addPopView("BaseCtrl","WeekCooperationReliveIntroduceView","WeekCooperationReliveIntroduceView")},t.prototype.onClickBoxRewardsCallBack=function(e,t){if(1==Number(t)){var o=[];_.WeekCooperationRankListTableData.getDataMap().forEach(function(e){o.push(e)}),c.default.addPopView("BaseCtrl","WeekCooperationReliveRewardsView","WeekCooperationReliveRewardsView",{tData:o})}else if(2==Number(t)){var i=[];R.OccupationRankListTableData.getDataMap().forEach(function(e){e.occupation==S.default.getWeekCooperationData().refleshRobotId&&i.push(e)}),c.default.addPopView("BaseCtrl","WeekCooperationReliveRewardsView","WeekCooperationReliveRewardsView",{tData:i})}},t.prototype.onClickCloseCallBack=function(){this.destroyChatView(),this.hideMainChatView(),this.closeView(),c.default.addPopView("BaseCtrl","ActivityMainView","ActivityMainView")},t.prototype.onJobRankScrollBottom=function(){this.nJobRankPageIdx>=this.nJobRankMaxPage||(this.nJobRankPageIdx++,this.callJobRankListData())},t.prototype.callJobRankListData=function(){var e=this,t=p.default.getDevelopRankListUrl();t+="?",t+="ranktype="+f.RANKLIST_TYPE.RANKLIST_TYPE_OCCUPATION,t+="&roleid="+g.default.uuidTransformRoieId(),t+="&page="+this.nJobRankPageIdx;var o=new XMLHttpRequest;o.onreadystatechange=function(){if(4==o.readyState&&o.status>=200&&o.status<400){var t=o.responseText.toString();t=(t=(t=t.replace('"','"')).replace("\ufeff","")).replace(" ","");var i=JSON.parse(t),a=i.page;e.nJobRankMaxPage=i.maxpage,Number(i.ranktype)==f.RANKLIST_TYPE.RANKLIST_TYPE_OCCUPATION&&Number(a)==e.nJobRankPageIdx&&e.resolvingWeekCoopJobRankData(i)}},o.timeout=3e3,o.ontimeout=function(){cc.isValid(e)&&m.G.StringManager.PopString("\u6392\u884c\u699c\u8bf7\u6c42\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\uff01")},o.onerror=function(){cc.isValid(e)&&m.G.StringManager.PopString("\u6392\u884c\u699c\u8bf7\u6c42\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\uff01")},o.open("GET",t,!0),o.send()},t.prototype.onRefreshJobRankEvent=function(e,t){var o=this.tJobRankListData[t];e.getComponent("RankListItem").initData(f.RANKLIST_TYPE.RANKLIST_TYPE_OCCUPATION,t+1,o)},t.prototype.resolvingWeekCoopJobRankData=function(e){1==Number(e.page)&&(this.tJobRankListData=[]);var t=this.m_JobMyRankNode.getChildByName("my_rank_num").getComponent(cc.Label),o=this.m_JobMyRankNode.getChildByName("my_score_label").getComponent(cc.Label),i=this.m_JobMyRankNode.getChildByName("my_time_label").getComponent(cc.Label),a=0,n=0;if("playerrank"in e&&(t.string=e.playerrank,"playerdata"in e)){var r=JSON.parse(e.playerdata);a=r.round,n=r.totaltime}if(0==Number(a)&&(a=S.default.getWeekCooperationData().maxContinuousWinNum),o.string=a.toString(),i.string=function(e){var t=e%6e4/1e3;return parseInt((e%36e5/6e4).toString())+" \u5206 "+t+" \u79d2 "}.call(this,1e3*n),i.node.active=!(n<=0),"ranklist"in e){var s=e.ranklist;for(var c in s)Object.prototype.hasOwnProperty.call(s,c)&&this.tJobRankListData.push(s[c])}this.m_JobRankListNode.numItems=this.tJobRankListData.length},t.prototype.onDestroy=function(){this.unscheduleAllCallbacks(),d.ClientNetwork.getInstance().removeMessageTarget(this)},n([D(l.default)],t.prototype,"rankListPanelNode",void 0),n([D(cc.Node)],t.prototype,"shopPanelNode",void 0),n([D(cc.Node)],t.prototype,"myRankInfoNode",void 0),n([D(cc.Prefab)],t.prototype,"shopItemPrefab",void 0),n([D(cc.Node)],t.prototype,"m_chatNode",void 0),n([D(cc.Label)],t.prototype,"snowNumLab",void 0),n([D(cc.Node)],t.prototype,"fightBtnNode",void 0),n([D(cc.Node)],t.prototype,"buyCountBtnNode",void 0),n([D(cc.Node)],t.prototype,"assistFightBtnNode",void 0),n([D(cc.Node)],t.prototype,"m_RankJobImageNode",void 0),n([D(l.default)],t.prototype,"m_JobRankListNode",void 0),n([D(cc.Node)],t.prototype,"m_JobMyRankNode",void 0),n([s.Register_Class,A],t)}(r.default);o.default=M,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../StaticData/ActivityTableData":"ActivityTableData","../../StaticData/OccupationRankListTableData":"OccupationRankListTableData","../../StaticData/WeekCooperationRankListTableData":"WeekCooperationRankListTableData","../../StaticData/WeekCooperationReliveTableData":"WeekCooperationReliveTableData","../../common/CombatModule":"CombatModule","../../common/CommandValue":"CommandValue","../../common/EventConst":"EventConst","../../common/PlayerModule":"PlayerModule","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/base/GameView":"GameView","../../modules/manager/EventManager":"EventManager","../../network/ClientNetwork":"ClientNetwork","../../network/protocol/ActivityProtocols":"ActivityProtocols","../../network/protocol/MatchProtocols":"MatchProtocols","../../network/protocol/RoleProtocols":"RoleProtocols","../../network/protocol/TypeProtocols":"TypeProtocols","../../utils/GameTools":"GameTools","../../utils/GameUtils":"GameUtils","../../utils/List":"List","../../utils/ResourcesManager":"ResourcesManager","../activity/ActivityModule":"ActivityModule"}],WeekCooperationReliveRewardsView:[function(e,t,o){"use strict";cc._RF.push(t,"3d82fPZM55AJ5hvd81nWlIc","WeekCooperationReliveRewardsView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=e("../../utils/GameTools"),l=cc._decorator,d=l.ccclass,u=l.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.m_RewardItemNode=null,t.m_RewardScrollView=null,t}return a(t,e),t.path=function(){return"ui/weekCooperationRelive/prefab/WeekCooperationReviveRewards"},t.prototype.init=function(e){var t=this;if(!e)return this.closeView();e.tData.forEach(function(e){var o=cc.instantiate(t.m_RewardItemNode);o.parent=t.m_RewardScrollView.content,o.active=!0,o.getChildByName("rank1").active=!1,o.getChildByName("rank2").active=!1,o.getChildByName("rank3").active=!1,e.rankMin==e.rankMax&&o.getChildByName("rank"+e.rankMin)?o.getChildByName("rank"+e.rankMin).active=!0:o.getChildByName("rankLabNode").children[0].getComponent(cc.Label).string=e.rankMin+" - "+e.rankMax;for(var i=0;i<e.prize.length;i++)c.default.createNormalItems(e.prize[i].dropID,e.prize[i].dropNum,o.getChildByName("RewardsNode"),function(e){e.scale=.8})})},n([u(cc.Node)],t.prototype,"m_RewardItemNode",void 0),n([u(cc.ScrollView)],t.prototype,"m_RewardScrollView",void 0),n([s.Register_Class,d],t)}(r.default);o.default=h,cc._RF.pop()},{"../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../utils/GameTools":"GameTools"}],WeekCooperationReliveTableData:[function(e,t,o){"use strict";cc._RF.push(t,"ea184cqj2lIaKA62s8g/6zX","WeekCooperationReliveTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.WeekCooperationReliveTableData=void 0;var i=e("../TableReader"),a=e("./BaseTableData"),n=function(){function e(){this.id=0,this.reliveNum=0,this.reliveCost=new Array}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.reliveNum=e.getNumber();for(var o=e.getString(),n=new i.TableReader(o);n.getPos()<n.getLen();){var r=new a.DropItem;r.readOriginal(n),this.reliveCost.push(r)}},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"WeekCooperationReliveTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.WeekCooperationReliveTableData=n,cc._RF.pop()},{"../TableReader":"TableReader","./BaseTableData":"BaseTableData"}],WeekCooperationReviveView:[function(e,t,o){"use strict";cc._RF.push(t,"43e45uVGOxERKYSJc/2ol/M","WeekCooperationReviveView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=e("../../modules/base/GameView"),l=cc._decorator,d=l.ccclass,u=l.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.consumeLabel=null,t.surplusLabel=null,t}return a(t,e),t.path=function(){return"ui/weekCooperationRelive/prefab/WeekCooperationRevive"},t.prototype.init=function(e){e.consume&&(this.consumeLabel.string=e.consume),e.surplus&&(this.surplusLabel.string=e.surplus),e.callBack&&(this.m_callback=e.callBack)},t.prototype.onClickConfirmCallBack=function(){this.m_callback&&this.m_callback()},t.prototype.onClickAssistFightCallBack=function(){var e=c.default.getViewByName("WeekCooperationReliveMainView");e&&e.view&&e.view.onClickAssistFightCallBack()},n([u(cc.Label)],t.prototype,"consumeLabel",void 0),n([u(cc.Label)],t.prototype,"surplusLabel",void 0),n([s.Register_Class,d],t)}(r.default);o.default=h,cc._RF.pop()},{"../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../modules/base/GameView":"GameView"}],WorldChatPanel:[function(e,t,o){"use strict";cc._RF.push(t,"8a072txXchNOZLSgz2IlCKv","WorldChatPanel");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../common/PlayerModule"),s=e("../../modules/cores/UISuperLayout"),c=e("./ChatItem"),l=e("../../Global/GameGlobal"),d=cc._decorator,u=d.ccclass,h=d.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.layout=null,t.unreadNode=null,t.datas=[],t.unreadMsgCount=0,t}return a(t,e),t.prototype.onLoad=function(){for(var e=this,t=r.default.getHistoryWorldChats(),o=0;o<t.length;o++)this.datas.push(t[o]);this.layout.total(this.datas.length,function(){setTimeout(function(){cc.isValid(e)&&e.layout.scrollToFooter(.1)},10)}),this.schedule(function(){e.unreadMsgCount=0,e.datas.forEach(function(t){t.bReadState&&0!=t.bReadState||e.unreadMsgCount++}),e.unreadMsgCount>99&&(e.unreadMsgCount=99),e.unreadMsgCount>0?e.unreadNode.active=!0:e.unreadNode.active=!1,e.unreadMsgCount>=99?e.unreadNode.children[0].getComponent(cc.Label).string=l.G.StringManager.getWorldString("chat_unread_max"):e.unreadNode.children[0].getComponent(cc.Label).string=l.G.StringManager.getWorldString("chat_unread",e.unreadMsgCount)},.2)},t.prototype.onEnable=function(){this.layout.total(this.datas.length),this.onClickUnreadCallBack()},t.prototype.onRefreshEvent=function(e,t){var o=this.datas[t];e.getComponent(c.default).show(o)},t.prototype.removeMessage=function(e){this.datas.splice(0,e),this.layout.total(this.datas.length)},t.prototype.addMessage=function(e){var t=this;if(this.datas.push(e),0!=this.node.active)return this.layout.total(this.datas.length),1==r.default.UUID.equals(e.roleID)||1==this.layout.scrollView.isScrollBounceBottom?(this.datas.forEach(function(e){e.bReadState=1}),void this.scheduleOnce(function(){t.layout.scrollToFooter(.1)})):void 0},t.prototype.onClickUnreadCallBack=function(){var e=this;this.datas.forEach(function(e){e.bReadState=1}),this.layout.scrollView.isScrollBounceBottom=!0,this.scheduleOnce(function(){e.layout.scrollToFooter(.1)})},t.prototype.onRefreshLayout=function(){var e=this;this.layout.total(this.datas.length),this.scheduleOnce(function(){e.layout.scrollToFooter(.1),e.layout.scrollView.isScrollBounceBottom=!0})},t.prototype.onDestroy=function(){this.unscheduleAllCallbacks()},n([h(s.default)],t.prototype,"layout",void 0),n([h(cc.Node)],t.prototype,"unreadNode",void 0),n([u],t)}(cc.Component);o.default=p,cc._RF.pop()},{"../../Global/GameGlobal":"GameGlobal","../../common/PlayerModule":"PlayerModule","../../modules/cores/UISuperLayout":"UISuperLayout","./ChatItem":"ChatItem"}],WorldNoticeTableData:[function(e,t,o){"use strict";cc._RF.push(t,"5d690N8HjNBbKKushHsZ+uR","WorldNoticeTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.WorldNoticeTableData=void 0;var i=e("../TableReader"),a=function(){function e(){this.id=0,this.type=0,this.content="",this.allshow=0,this.duration=0}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.id=e.getNumber(),this.type=e.getNumber(),this.content=e.getString(),this.allshow=e.getNumber(),this.duration=e.getNumber()},e.getById=function(t){return e.getDataMap().get(t)},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"WorldNoticeTableData"},e.prototype.isAutoId=function(){return!1},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.WorldNoticeTableData=a,cc._RF.pop()},{"../TableReader":"TableReader"}],WorldTableData:[function(e,t,o){"use strict";cc._RF.push(t,"c36760xippBbLxZs1rr2Env","WorldTableData"),Object.defineProperty(o,"__esModule",{value:!0}),o.WorldTableData=void 0;var i=e("../TableReader"),a=function(){function e(){this.wordKey="",this.system="",this.ch="",this.en=""}return e.prototype.readOriginal=function(e,t){void 0===t&&(t=Number.MAX_SAFE_INTEGER),this.wordKey=e.getString(),this.system=e.getString(),this.ch=e.getString(),this.en=e.getString()},e.getDataMap=function(){return e.dataMap||(e.dataMap=new Map,i.ReadTable(e.getFilename(),e)),e.dataMap},e.getFilename=function(){return"WorldTableData"},e.prototype.isAutoId=function(){return!0},e.prototype.insertData=function(t){e.dataMap.set(t,this)},e}();o.WorldTableData=a,cc._RF.pop()},{"../TableReader":"TableReader"}],base64:[function(e,t,o){"use strict";cc._RF.push(t,"b35faX4ixFCALZOnJcUZd7b","base64");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0}),o.Base64=void 0;var r=cc._decorator,s=r.ccclass,c=(r.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",t}return a(t,e),t.prototype.encode=function(e){var t,o,i,a,n,r,s,c="",l=0;for(e=this._utf16to8(e);l<e.length;)a=(t=e.charCodeAt(l++))>>2,n=(3&t)<<4|(o=e.charCodeAt(l++))>>4,r=(15&o)<<2|(i=e.charCodeAt(l++))>>6,s=63&i,isNaN(o)?r=s=64:isNaN(i)&&(s=64),c=c+this._keyStr.charAt(a)+this._keyStr.charAt(n)+this._keyStr.charAt(r)+this._keyStr.charAt(s);return c},t.prototype.decode=function(e){var t,o,i,a,n,r,s="",c=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");c<e.length;)t=this._keyStr.indexOf(e.charAt(c++))<<2|(a=this._keyStr.indexOf(e.charAt(c++)))>>4,o=(15&a)<<4|(n=this._keyStr.indexOf(e.charAt(c++)))>>2,i=(3&n)<<6|(r=this._keyStr.indexOf(e.charAt(c++))),s+=String.fromCharCode(t),64!=n&&(s+=String.fromCharCode(o)),64!=r&&(s+=String.fromCharCode(i));return this._utf8to16(s)},t.prototype._utf16to8=function(e){var t,o,i,a;for(t="",i=e.length,o=0;o<i;o++)(a=e.charCodeAt(o))>=1&&a<=127?t+=e.charAt(o):a>2047?(t+=String.fromCharCode(224|a>>12&15),t+=String.fromCharCode(128|a>>6&63),t+=String.fromCharCode(128|a>>0&63)):(t+=String.fromCharCode(192|a>>6&31),t+=String.fromCharCode(128|a>>0&63));return t},t.prototype._utf8to16=function(e){var t,o,i,a,n,r;for(t="",i=e.length,o=0;o<i;)switch((a=e.charCodeAt(o++))>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:t+=e.charAt(o-1);break;case 12:case 13:n=e.charCodeAt(o++),t+=String.fromCharCode((31&a)<<6|63&n);break;case 14:n=e.charCodeAt(o++),r=e.charCodeAt(o++),t+=String.fromCharCode((15&a)<<12|(63&n)<<6|(63&r)<<0)}return t},n([s],t)}(cc.Component));o.Base64=c,cc._RF.pop()},{}],fightPlayersInfoView:[function(e,t){"use strict";cc._RF.push(t,"afefe4eJSJEzaLwxzja8QzR","fightPlayersInfoView");var o=n(e("../combat/CombatManager")),i=n(e("../combat/unit/CarObj")),a=e("../utils/ConstValue");function n(e){return e&&e.__esModule?e:{default:e}}cc.Class({extends:cc.Component,properties:{},init:function(e){this.parent=e,this.show=!1,this.playerList={},this.carList={},this.playerNodeList={},this.playerNodeList[0]=cc.find("player1",this.node),this.playerNodeList[1]=cc.find("player2",this.node),this.playerNodeList[2]=cc.find("player3",this.node),this.node.setScale(0)},createCar:function(e,t,a){var n=new i.default;return n.setCamp(t),n.init(e,a,cc.v2(0,0)),o.default.getInstance().carList[t]=n,n},onBtnShow:function(){if(1==this.show){var e=cc.scaleTo(.5,0,0).clone().easing(cc.easeElasticIn(.95));this.node.runAction(e)}else{var t=cc.scaleTo(.5,1,1).clone().easing(cc.easeElasticOut(.95));this.node.runAction(t)}this.show=!this.show,this.parent.arrow.scaleY*=-1},update:function(){o.default.getInstance().gameState,a.Game_State.Fighting},chageCarState:function(e){this.carList[e]&&(this.carList[e].state=a.NPC_STATE.Dead,this.carList[e].hp=0,this.refreshPlayerInfo(e))},refreshPlayerInfo:function(e){var t=this,o=cc.find("head_bg/icon",this.playerNodeList[e-10]);cc.resources.load("ui/headpic/"+(Math.floor(8*Math.random())+1),cc.SpriteFrame,function(i,a){o.getComponent(cc.Sprite).spriteFrame=a,t.parent.playerHeadIconArray[e-10].getComponent(cc.Sprite).spriteFrame=a}),cc.find("head_bg/name",this.playerNodeList[e-10]).getComponent(cc.Label).string="player"+e,cc.find("progressBar",this.playerNodeList[e-10]).getComponent(cc.ProgressBar).progress=this.carList[e].hp/this.carList[e].maxHp,cc.find("progressBar/blood",this.playerNodeList[e-10]).getComponent(cc.Label).string=this.carList[e].hp}}),cc._RF.pop()},{"../combat/CombatManager":"CombatManager","../combat/unit/CarObj":"CarObj","../utils/ConstValue":"ConstValue"}],flyWord:[function(e,t,o){"use strict";cc._RF.push(t,"1e01dJjXvRP3qWFFtO+4lS3","flyWord");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0}),o.flyWord=void 0;var r=cc._decorator,s=r.ccclass,c=r.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.label=null,t.bg=null,t}return a(t,e),t.prototype.start=function(){},t.prototype.removeSelf=function(){this.node.destroy},n([c(cc.Label)],t.prototype,"label",void 0),n([c(cc.Sprite)],t.prototype,"bg",void 0),n([s],t)}(cc.Component);o.flyWord=l,cc._RF.pop()},{}],load:[function(e,t,o){"use strict";cc._RF.push(t,"c307bT4E0RKfp5BGJSMoF/E","load");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r},r=this&&this.__awaiter||function(e,t,o,i){return new(o||(o=Promise))(function(a,n){function r(e){try{c(i.next(e))}catch(t){n(t)}}function s(e){try{c(i.throw(e))}catch(t){n(t)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(r,s)}c((i=i.apply(e,t||[])).next())})},s=this&&this.__generator||function(e,t){var o,i,a,n,r={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return n={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function s(e){return function(t){return c([e,t])}}function c(n){if(o)throw new TypeError("Generator is already executing.");for(;r;)try{if(o=1,i&&(a=2&n[0]?i.return:n[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return r.label++,{value:n[1],done:!1};case 5:r.label++,i=n[1],n=[0];continue;case 7:n=r.ops.pop(),r.trys.pop();continue;default:if(!(a=(a=r.trys).length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){r=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){r.label=n[1];break}if(6===n[0]&&r.label<a[1]){r.label=a[1],a=n;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(n);break}a[2]&&r.ops.pop(),r.trys.pop();continue}n=t.call(e,r)}catch(s){n=[6,s],i=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.getByteDanceSubmitReviewShopState=o.getQQMiniGameSubmitReviewShopState=o.getVersionPhpUrl=o.getSubmitReviewShopState=o.getSubmitReviewState=o.wechatminiLoaclGameVer=void 0;var c=cc._decorator,l=c.ccclass,d=c.property,u=["GuidePlotTableData","LoadingBgTableData","LoadingTipsTableData","ResTableData","ItemTableData","HeroTableData","NameTableData"];o.wechatminiLoaclGameVer="1.1.23";var h="",p="true",f="false",g="true",m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.tip=null,t.loginBtn=null,t.ProgressBar=null,t.isScriptLoaded=!1,t.lastProgress=0,t.resProgress=0,t.wechatSDKVer="",t}return a(t,e),t.prototype.onLoad=function(){var e=this;console.log("cc.sys.platform="+cc.sys.platform+", isWechat="+(cc.sys.platform==cc.sys.WECHAT_GAME)+", isQQMiniGame="+("undefined"!=typeof qq)),this.wxReportAnalytics("load",{}),this.scheduleOnce(function(){e.loadSubPackage("scripts")}),this.backgroundFitScreen(this.node.parent,this.node.parent.getChildByName("bg")),this.schedule(this.autoAddPregress,.1)},t.prototype.autoAddPregress=function(){this.ProgressBar.node.active=!0,this.resProgress>.99||(this.resProgress+=.0033,this.ProgressBar.progress=this.resProgress)},t.prototype.PreLoadCsvSync=function(e,t){return r(this,void 0,Promise,function(){var o;return s(this,function(i){switch(i.label){case 0:return[4,this.PreLoadCsv(e)];case 1:return o=i.sent(),t&&(o||console.error("************\u8868\u52a0\u8f7d\u5931\u8d25\uff1a",e),t(o)),[2,o]}})})},t.prototype.PreLoadCsv=function(e){var t="StaticData/"+e,o=cc.loader.getRes(t,cc.TextAsset);return o?Promise.resolve(o):new Promise(function(t){cc.loader.loadRes("StaticData/"+e,cc.TextAsset,function(e,o){t(e?null:o)})})},t.prototype.requestResUpdate=function(){return r(this,void 0,Promise,function(){var e;return s(this,function(){return e=this,wx.request({url:"https://mszcs1.gameserver.iplay11g.com/gmsys/version.php?"+Math.random(),data:{x:"",y:""},header:{"content-type":"application/json"},method:"GET",success:function(t){console.log(t.data.gameVer),console.log(t.data.resVer),console.log(t.data.shopState),console.log(t.data.clearRes),h=t.data.gameVer,p=t.data.shopState,f=t.data.clearRes,null!=t.data.shopState_android&&(g=t.data.shopState_android);try{var o=wx.getStorageSync("resVer");o&&t.data.resVer==o?e.loadStaticData():(wx.setStorage({key:"resVer",data:t.data.resVer}),e.addResource())}catch(i){}},fail:function(){console.log("request fail"),e.wxReportAnalytics("requestverion",{result:1}),e.scheduleOnce(function(){e.requestResUpdate()},1)},complete:function(){console.log("request complete")}}),[2]})})},t.prototype.loadStaticData=function(){return r(this,void 0,void 0,function(){var e,t,o,i,a,n;return s(this,function(){for(e=u.length,t=0,o=this,i=function(i){i&&i.addRef(),t++,o.tip.string="\u6b63\u5728\u52a0\u8f7d\u914d\u7f6e\u8868...",t==e&&(o.resProgress=1,o.ProgressBar.progress=o.resProgress,o.ProgressBar.node.active=!1,o.tip.string="\u6b63\u5728\u52a0\u8f7d\u521d\u59cb\u573a\u666f...",cc.assetManager.loadBundle("scene",function(e,t){t.loadScene("login",function(e,t){o.wxReportAnalytics("loadscene",{}),o.unschedule(o.autoAddPregress),cc.director.runScene(t)})}))},this.wxReportAnalytics("loadstaticdata",{}),a=0;a<e;a++)n=u[a],this.PreLoadCsvSync(n,i);return[2]})})},t.prototype.LoadResAsync=function(e,t,o,i){return void 0===o&&(o=!1),new Promise(function(a){cc.resources.load(e,t,i,function(e,t){if(e){if(o)throw e;cc.error(e),a(null)}else a(t)})})},t.prototype.LoadResAsyncAutoRelease=function(e,t){var o=cc.resources.get(e,t);return Promise.resolve(o),o?Promise.resolve(o):new Promise(function(o){cc.resources.load(e,t,function(e,t){e?(cc.error(e),o(null)):o(t)})})},t.prototype.loadBundleAsync=function(e){return r(this,void 0,Promise,function(){return s(this,function(){return[2,new Promise(function(t){cc.assetManager.loadBundle(e,function(e,o){e?(cc.error(e),t(null)):t(o)})})]})})},t.prototype.setProgressData=function(){this.tip.string="\u6b63\u5728\u4e0b\u8f7d\u538b\u7f29\u5305\u8d44\u6e90"+Math.ceil(100*this.resProgress)+"%...";var e=this.node.parent.getChildByName("ProgressBar").getComponent(cc.ProgressBar);e.node.active=!0,e.progress=this.resProgress,this.node.parent.getChildByName("ProgressBar").getChildByName("tip").getComponent(cc.Label).string=Math.ceil(100*this.resProgress)+"%...",1==this.resProgress&&(e.node.active=!1)},t.prototype.addResource=function(){return r(this,void 0,void 0,function(){var e;return s(this,function(){return(e=this).wxReportAnalytics("requestverion",{result:0}),"true"==f&&(console.log("wechatminiClearRes true"),cc.assetManager.cacheManager.clearCache()),e.autoUpdate(),e.loadStaticData(),[2]})})},t.prototype.loadSubPackage=function(e){this.loginBtn.active=!1,this.tip.string="\u6b63\u5728\u52a0\u8f7d\u811a\u672c...";var t=this;wx.loadSubpackage({name:e,success:function(){t.wxReportAnalytics("loadscripts",{result:0}),t.requestResUpdate()},fail:function(){t.wxReportAnalytics("loadscripts",{result:1}),wx.showToast({title:"\u52a0\u8f7d\u5931\u8d25\uff0c\u8bf7\u68c0\u67e5\u7f51\u7edc\u5e76\u91cd\u65b0\u8fdb\u5165\u5c0f\u6e38\u620f",icon:"none",duration:2e3})}}).onProgressUpdate(function(e){console.log("\u4e0b\u8f7d\u8fdb\u5ea6",e.progress),console.log("\u5df2\u7ecf\u4e0b\u8f7d\u7684\u6570\u636e\u957f\u5ea6",e.totalBytesWritten),console.log("\u9884\u671f\u9700\u8981\u4e0b\u8f7d\u7684\u6570\u636e\u603b\u957f\u5ea6",e.totalBytesExpectedToWrite),t.tip.string="\u6b63\u5728\u4e0b\u8f7d\u811a\u672c\u8d44\u6e90..."})},t.prototype.getUserInfo=function(){var e=this;wx.getUserInfo({success:function(t){e.storageUserInfo(t),e.loadSubPackage("scripts")},fail:function(){console.log("getUserInfo fail")}})},t.prototype.storageUserInfo=function(e){var t=e.userInfo;console.log("getUserInfo success"+t.nickName+t.avatarUrl),wx.setStorage({key:"wxNickName",data:t.nickName}),wx.setStorage({key:"wxImage",data:t.avatarUrl})},t.prototype.userAuth=function(){var e=this,t=wx.getSystemInfoSync(),o=t.screenWidth,i=t.screenHeight;e.wechatSDKVer=t.SDKVersion,wx.getSetting({success:function(t){if(console.log(t.authSetting),t.authSetting["scope.userInfo"])console.log("\u7528\u6237\u5df2\u6388\u6743");else{console.log("\u7528\u6237\u672a\u6388\u6743");var a=wx.createUserInfoButton({type:"text",text:"_",style:{left:0,top:0,width:o,height:i,backgroundColor:"#00000000",color:"#000000",fontSize:0,textAlign:"center",lineHeight:i}});a.onTap(function(t){t.userInfo?(console.log("\u7528\u6237\u6388\u6743:",t),e.storageUserInfo(t),e.loadSubPackage("scripts"),a.destroy()):console.log("\u7528\u6237\u62d2\u7edd\u6388\u6743:",t)})}}})},t.prototype.start=function(){},t.prototype.update=function(){},t.prototype.backgroundFitScreen=function(e,t){e.setContentSize(cc.winSize),.5==e.anchorX&&e.setPosition(cc.winSize.width/2,e.position.y),.5==e.anchorY&&e.setPosition(e.position.x,cc.winSize.height/2);var o=cc.view.getDesignResolutionSize(),i=e.width/o.width,a=e.height/o.height;if(t){var n=e.height/t.height;i>a&&(n=e.width/t.width,t.width*=n)}},t.prototype.compareVersion=function(e,t){e=e.split("."),t=t.split(".");for(var o=Math.max(e.length,t.length);e.length<o;)e.push("0");for(;t.length<o;)t.push("0");for(var i=0;i<o;i++){var a=parseInt(e[i]),n=parseInt(t[i]);if(a>n)return 1;if(a<n)return-1}return 0},t.prototype.autoUpdate=function(){var e=wx.getSystemInfoSync();if(this.wechatSDKVer=e.SDKVersion,"undefined"==typeof ks)if(this.compareVersion(this.wechatSDKVer,"1.9.90 ")>=0||"undefined"!=typeof tt||"undefined"!=typeof qq||"undefined"!=typeof ks){var t=wx.getUpdateManager();t.onCheckForUpdate(function(e){e.hasUpdate?console.log("res.hasUpdate:",e.hasUpdate):console.log("res.hasUpdate:",!1)}),t.onUpdateReady(function(){wx.showModal({title:"\u66f4\u65b0\u63d0\u793a",content:"\u68c0\u6d4b\u5230\u65b0\u7248\u672c\uff0c\u662f\u5426\u4e0b\u8f7d\u65b0\u7248\u672c\u5e76\u91cd\u542f\u5c0f\u7a0b\u5e8f\uff1f",success:function(e){e.confirm?t.applyUpdate():e.cancel&&wx.showModal({title:"\u6e29\u99a8\u63d0\u793a~",content:"\u672c\u6b21\u7248\u672c\u66f4\u65b0\u6d89\u53ca\u5230\u65b0\u7684\u529f\u80fd\u6dfb\u52a0\uff0c\u65e7\u7248\u672c\u65e0\u6cd5\u6b63\u5e38\u8bbf\u95ee\u7684\u54e6~",showCancel:!1,confirmText:"\u786e\u5b9a\u66f4\u65b0",success:function(e){e.confirm&&t.applyUpdate()}})}})}),t.onUpdateFailed(function(){wx.showModal({title:"\u5df2\u7ecf\u6709\u65b0\u7248\u672c\u4e86\u54df~",content:"\u65b0\u7248\u672c\u5df2\u7ecf\u4e0a\u7ebf\u5566~\uff0c\u8bf7\u60a8\u5220\u9664\u5f53\u524d\u5c0f\u7a0b\u5e8f\uff0c\u91cd\u65b0\u641c\u7d22\u6253\u5f00\u54df~"})})}else wx.showModal({title:"\u63d0\u793a",content:"\u5f53\u524d\u5fae\u4fe1\u7248\u672c\u8fc7\u4f4e\uff0c\u65e0\u6cd5\u4f7f\u7528\u8be5\u529f\u80fd\uff0c\u8bf7\u5347\u7ea7\u5230\u6700\u65b0\u5fae\u4fe1\u7248\u672c\u540e\u91cd\u8bd5\u3002"})},t.prototype.wxReportAnalytics=function(e,t){if(null==typeof ks&&!wx.getStorageSync(e)){wx.setStorage({key:e,data:1});var o=GameGlobal.tdAppSdk;if(!o)return;null==t?o.event({id:e,label:e}):(console.log("TalkingDataAPI event:",e,", param:",t),o.event({id:e,label:e,params:t}))}},n([d(cc.Label)],t.prototype,"tip",void 0),n([d(cc.Node)],t.prototype,"loginBtn",void 0),n([d(cc.ProgressBar)],t.prototype,"ProgressBar",void 0),n([l],t)}(cc.Component);function _(){if(""!=h){console.log("wechatminiRemoteGameVer"+h),console.log("wechatminiLoaclGameVer"+o.wechatminiLoaclGameVer);for(var e=o.wechatminiLoaclGameVer.split("."),t=h.split("."),i=Math.max(e.length,t.length);e.length<i;)e.push("0");for(;t.length<i;)t.push("0");for(var a=0;a<i;a++){var n=parseInt(e[a]),r=parseInt(t[a]);if(n>r)return!0;if(n<r)return!1}}return!1}o.default=m,o.getSubmitReviewState=_,o.getSubmitReviewShopState=function(){return!0===_()&&"false"===p},o.getVersionPhpUrl=function(){return"https://mszcs1.gameserver.iplay11g.com/gmsys/version.php"},o.getQQMiniGameSubmitReviewShopState=function(){return"false"==g},o.getByteDanceSubmitReviewShopState=function(){return"false"==g},cc._RF.pop()},{}],long:[function(e,t){"use strict";cc._RF.push(t,"a870bS2NElKMaVw8gCtGmpx","long"),t.exports=i;var o=null;try{o=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(w){}function i(e,t,o){this.low=0|e,this.high=0|t,this.unsigned=!!o}function a(e){return!0===(e&&e.__isLong__)}i.prototype.__isLong__,Object.defineProperty(i.prototype,"__isLong__",{value:!0}),i.isLong=a;var n={},r={};function s(e,t){var o,i,a;return t?(a=0<=(e>>>=0)&&e<256)&&(i=r[e])?i:(o=l(e,(0|e)<0?-1:0,!0),a&&(r[e]=o),o):(a=-128<=(e|=0)&&e<128)&&(i=n[e])?i:(o=l(e,e<0?-1:0,!1),a&&(n[e]=o),o)}function c(e,t){if(isNaN(e))return t?y:_;if(t){if(e<0)return y;if(e>=f)return I}else{if(e<=-g)return N;if(e+1>=g)return T}return e<0?c(-e,t).neg():l(e%p|0,e/p|0,t)}function l(e,t,o){return new i(e,t,o)}i.fromInt=s,i.fromNumber=c,i.fromBits=l;var d=Math.pow;function u(e,t,o){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return _;if("number"==typeof t?(o=t,t=!1):t=!!t,(o=o||10)<2||36<o)throw RangeError("radix");var i;if((i=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===i)return u(e.substring(1),t,o).neg();for(var a=c(d(o,8)),n=_,r=0;r<e.length;r+=8){var s=Math.min(8,e.length-r),l=parseInt(e.substring(r,r+s),o);if(s<8){var h=c(d(o,s));n=n.mul(h).add(c(l))}else n=(n=n.mul(a)).add(c(l))}return n.unsigned=t,n}function h(e,t){return"number"==typeof e?c(e,t):"string"==typeof e?u(e,t):l(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}i.fromString=u,i.fromValue=h;var p=4294967296,f=p*p,g=f/2,m=s(1<<24),_=s(0);i.ZERO=_;var y=s(0,!0);i.UZERO=y;var v=s(1);i.ONE=v;var C=s(1,!0);i.UONE=C;var S=s(-1);i.NEG_ONE=S;var T=l(-1,2147483647,!1);i.MAX_VALUE=T;var I=l(-1,-1,!0);i.MAX_UNSIGNED_VALUE=I;var N=l(0,-2147483648,!1);i.MIN_VALUE=N;var b=i.prototype;b.toInt=function(){return this.unsigned?this.low>>>0:this.low},b.toNumber=function(){return this.unsigned?(this.high>>>0)*p+(this.low>>>0):this.high*p+(this.low>>>0)},b.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(N)){var t=c(e),o=this.div(t),i=o.mul(t).sub(this);return o.toString(e)+i.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var a=c(d(e,6),this.unsigned),n=this,r="";;){var s=n.div(a),l=(n.sub(s.mul(a)).toInt()>>>0).toString(e);if((n=s).isZero())return l+r;for(;l.length<6;)l="0"+l;r=""+l+r}},b.getHighBits=function(){return this.high},b.getHighBitsUnsigned=function(){return this.high>>>0},b.getLowBits=function(){return this.low},b.getLowBitsUnsigned=function(){return this.low>>>0},b.getNumBitsAbs=function(){if(this.isNegative())return this.eq(N)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},b.isZero=function(){return 0===this.high&&0===this.low},b.eqz=b.isZero,b.isNegative=function(){return!this.unsigned&&this.high<0},b.isPositive=function(){return this.unsigned||this.high>=0},b.isOdd=function(){return 1==(1&this.low)},b.isEven=function(){return 0==(1&this.low)},b.equals=function(e){return a(e)||(e=h(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&this.high===e.high&&this.low===e.low},b.eq=b.equals,b.notEquals=function(e){return!this.eq(e)},b.neq=b.notEquals,b.ne=b.notEquals,b.lessThan=function(e){return this.comp(e)<0},b.lt=b.lessThan,b.lessThanOrEqual=function(e){return this.comp(e)<=0},b.lte=b.lessThanOrEqual,b.le=b.lessThanOrEqual,b.greaterThan=function(e){return this.comp(e)>0},b.gt=b.greaterThan,b.greaterThanOrEqual=function(e){return this.comp(e)>=0},b.gte=b.greaterThanOrEqual,b.ge=b.greaterThanOrEqual,b.compare=function(e){if(a(e)||(e=h(e)),this.eq(e))return 0;var t=this.isNegative(),o=e.isNegative();return t&&!o?-1:!t&&o?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},b.comp=b.compare,b.negate=function(){return!this.unsigned&&this.eq(N)?N:this.not().add(v)},b.neg=b.negate,b.add=function(e){a(e)||(e=h(e));var t=this.high>>>16,o=65535&this.high,i=this.low>>>16,n=65535&this.low,r=e.high>>>16,s=65535&e.high,c=e.low>>>16,d=0,u=0,p=0,f=0;return p+=(f+=n+(65535&e.low))>>>16,u+=(p+=i+c)>>>16,d+=(u+=o+s)>>>16,d+=t+r,l((p&=65535)<<16|(f&=65535),(d&=65535)<<16|(u&=65535),this.unsigned)},b.subtract=function(e){return a(e)||(e=h(e)),this.add(e.neg())},b.sub=b.subtract,b.multiply=function(e){if(this.isZero())return _;if(a(e)||(e=h(e)),o)return l(o.mul(this.low,this.high,e.low,e.high),o.get_high(),this.unsigned);if(e.isZero())return _;if(this.eq(N))return e.isOdd()?N:_;if(e.eq(N))return this.isOdd()?N:_;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(m)&&e.lt(m))return c(this.toNumber()*e.toNumber(),this.unsigned);var t=this.high>>>16,i=65535&this.high,n=this.low>>>16,r=65535&this.low,s=e.high>>>16,d=65535&e.high,u=e.low>>>16,p=65535&e.low,f=0,g=0,y=0,v=0;return y+=(v+=r*p)>>>16,g+=(y+=n*p)>>>16,y&=65535,g+=(y+=r*u)>>>16,f+=(g+=i*p)>>>16,g&=65535,f+=(g+=n*u)>>>16,g&=65535,f+=(g+=r*d)>>>16,f+=t*p+i*u+n*d+r*s,l((y&=65535)<<16|(v&=65535),(f&=65535)<<16|(g&=65535),this.unsigned)},b.mul=b.multiply,b.divide=function(e){if(a(e)||(e=h(e)),e.isZero())throw Error("division by zero");var t,i,n;if(o)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?l((this.unsigned?o.div_u:o.div_s)(this.low,this.high,e.low,e.high),o.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?y:_;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return y;if(e.gt(this.shru(1)))return C;n=y}else{if(this.eq(N))return e.eq(v)||e.eq(S)?N:e.eq(N)?v:(t=this.shr(1).div(e).shl(1)).eq(_)?e.isNegative()?v:S:(i=this.sub(e.mul(t)),n=t.add(i.div(e)));if(e.eq(N))return this.unsigned?y:_;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();n=_}for(i=this;i.gte(e);){t=Math.max(1,Math.floor(i.toNumber()/e.toNumber()));for(var r=Math.ceil(Math.log(t)/Math.LN2),s=r<=48?1:d(2,r-48),u=c(t),p=u.mul(e);p.isNegative()||p.gt(i);)p=(u=c(t-=s,this.unsigned)).mul(e);u.isZero()&&(u=v),n=n.add(u),i=i.sub(p)}return n},b.div=b.divide,b.modulo=function(e){return a(e)||(e=h(e)),o?l((this.unsigned?o.rem_u:o.rem_s)(this.low,this.high,e.low,e.high),o.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},b.mod=b.modulo,b.rem=b.modulo,b.not=function(){return l(~this.low,~this.high,this.unsigned)},b.and=function(e){return a(e)||(e=h(e)),l(this.low&e.low,this.high&e.high,this.unsigned)},b.or=function(e){return a(e)||(e=h(e)),l(this.low|e.low,this.high|e.high,this.unsigned)},b.xor=function(e){return a(e)||(e=h(e)),l(this.low^e.low,this.high^e.high,this.unsigned)},b.shiftLeft=function(e){return a(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?l(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):l(0,this.low<<e-32,this.unsigned)},b.shl=b.shiftLeft,b.shiftRight=function(e){return a(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?l(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):l(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},b.shr=b.shiftRight,b.shiftRightUnsigned=function(e){return a(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?l(this.low>>>e|this.high<<32-e,this.high>>>e,this.unsigned):l(32===e?this.high:this.high>>>e-32,0,this.unsigned)},b.shru=b.shiftRightUnsigned,b.shr_u=b.shiftRightUnsigned,b.rotateLeft=function(e){var t;return a(e)&&(e=e.toInt()),0==(e&=63)?this:32===e?l(this.high,this.low,this.unsigned):e<32?(t=32-e,l(this.low<<e|this.high>>>t,this.high<<e|this.low>>>t,this.unsigned)):(t=32-(e-=32),l(this.high<<e|this.low>>>t,this.low<<e|this.high>>>t,this.unsigned))},b.rotl=b.rotateLeft,b.rotateRight=function(e){var t;return a(e)&&(e=e.toInt()),0==(e&=63)?this:32===e?l(this.high,this.low,this.unsigned):e<32?(t=32-e,l(this.high<<t|this.low>>>e,this.low<<t|this.high>>>e,this.unsigned)):(t=32-(e-=32),l(this.low<<t|this.high>>>e,this.high<<t|this.low>>>e,this.unsigned))},b.rotr=b.rotateRight,b.toSigned=function(){return this.unsigned?l(this.low,this.high,!1):this},b.toUnsigned=function(){return this.unsigned?this:l(this.low,this.high,!0)},b.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},b.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},b.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},i.fromBytes=function(e,t,o){return o?i.fromBytesLE(e,t):i.fromBytesBE(e,t)},i.fromBytesLE=function(e,t){return new i(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},i.fromBytesBE=function(e,t){return new i(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)},cc._RF.pop()},{}],pako:[function(e,t,o){"use strict";cc._RF.push(t,"5a951lcLCFPwJH4DGTdt7QE","pako"),function(e,i){"object"==typeof o&&void 0!==t?i(o):"function"==typeof define&&define.amd?define(["exports"],i):i((e="undefined"!=typeof globalThis?globalThis:e||self).pako={})}(void 0,function(e){function t(e){for(var t=e.length;--t>=0;)e[t]=0}var o=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),i=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),a=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),n=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),r=new Array(576);t(r);var s=new Array(60);t(s);var c=new Array(512);t(c);var l=new Array(256);t(l);var d=new Array(29);t(d);var u,h,p,f=new Array(30);function g(e,t,o,i,a){this.static_tree=e,this.extra_bits=t,this.extra_base=o,this.elems=i,this.max_length=a,this.has_stree=e&&e.length}function m(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}t(f);var _=function(e){return e<256?c[e]:c[256+(e>>>7)]},y=function(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},v=function(e,t,o){e.bi_valid>16-o?(e.bi_buf|=t<<e.bi_valid&65535,y(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=o-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=o)},C=function(e,t,o){v(e,o[2*t],o[2*t+1])},S=function(e,t){var o=0;do{o|=1&e,e>>>=1,o<<=1}while(--t>0);return o>>>1},T=function(e){16===e.bi_valid?(y(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)},I=function(e,t){var o,i,a,n,r,s,c=t.dyn_tree,l=t.max_code,d=t.stat_desc.static_tree,u=t.stat_desc.has_stree,h=t.stat_desc.extra_bits,p=t.stat_desc.extra_base,f=t.stat_desc.max_length,g=0;for(n=0;n<=15;n++)e.bl_count[n]=0;for(c[2*e.heap[e.heap_max]+1]=0,o=e.heap_max+1;o<573;o++)(n=c[2*c[2*(i=e.heap[o])+1]+1]+1)>f&&(n=f,g++),c[2*i+1]=n,i>l||(e.bl_count[n]++,r=0,i>=p&&(r=h[i-p]),s=c[2*i],e.opt_len+=s*(n+r),u&&(e.static_len+=s*(d[2*i+1]+r)));if(0!==g){do{for(n=f-1;0===e.bl_count[n];)n--;e.bl_count[n]--,e.bl_count[n+1]+=2,e.bl_count[f]--,g-=2}while(g>0);for(n=f;0!==n;n--)for(i=e.bl_count[n];0!==i;)(a=e.heap[--o])>l||(c[2*a+1]!==n&&(e.opt_len+=(n-c[2*a+1])*c[2*a],c[2*a+1]=n),i--)}},N=function(e,t,o){var i,a,n=new Array(16),r=0;for(i=1;i<=15;i++)n[i]=r=r+o[i-1]<<1;for(a=0;a<=t;a++){var s=e[2*a+1];0!==s&&(e[2*a]=S(n[s]++,s))}},b=function(){var e,t,n,m,_,y=new Array(16);for(n=0,m=0;m<28;m++)for(d[m]=n,e=0;e<1<<o[m];e++)l[n++]=m;for(l[n-1]=m,_=0,m=0;m<16;m++)for(f[m]=_,e=0;e<1<<i[m];e++)c[_++]=m;for(_>>=7;m<30;m++)for(f[m]=_<<7,e=0;e<1<<i[m]-7;e++)c[256+_++]=m;for(t=0;t<=15;t++)y[t]=0;for(e=0;e<=143;)r[2*e+1]=8,e++,y[8]++;for(;e<=255;)r[2*e+1]=9,e++,y[9]++;for(;e<=279;)r[2*e+1]=7,e++,y[7]++;for(;e<=287;)r[2*e+1]=8,e++,y[8]++;for(N(r,287,y),e=0;e<30;e++)s[2*e+1]=5,s[2*e]=S(e,5);u=new g(r,o,257,286,15),h=new g(s,i,0,30,15),p=new g(new Array(0),a,0,19,7)},w=function(e){var t;for(t=0;t<286;t++)e.dyn_ltree[2*t]=0;for(t=0;t<30;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0},E=function(e){e.bi_valid>8?y(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},P=function(e,t,o,i){E(e),i&&(y(e,o),y(e,~o)),e.pending_buf.set(e.window.subarray(t,t+o),e.pending),e.pending+=o},R=function(e,t,o,i){var a=2*t,n=2*o;return e[a]<e[n]||e[a]===e[n]&&i[t]<=i[o]},L=function(e,t,o){for(var i=e.heap[o],a=o<<1;a<=e.heap_len&&(a<e.heap_len&&R(t,e.heap[a+1],e.heap[a],e.depth)&&a++,!R(t,i,e.heap[a],e.depth));)e.heap[o]=e.heap[a],o=a,a<<=1;e.heap[o]=i},A=function(e,t,a){var n,r,s,c,u=0;if(0!==e.last_lit)do{n=e.pending_buf[e.d_buf+2*u]<<8|e.pending_buf[e.d_buf+2*u+1],r=e.pending_buf[e.l_buf+u],u++,0===n?C(e,r,t):(s=l[r],C(e,s+256+1,t),0!==(c=o[s])&&(r-=d[s],v(e,r,c)),s=_(--n),C(e,s,a),0!==(c=i[s])&&(n-=f[s],v(e,n,c)))}while(u<e.last_lit);C(e,256,t)},D=function(e,t){var o,i,a,n=t.dyn_tree,r=t.stat_desc.static_tree,s=t.stat_desc.has_stree,c=t.stat_desc.elems,l=-1;for(e.heap_len=0,e.heap_max=573,o=0;o<c;o++)0!==n[2*o]?(e.heap[++e.heap_len]=l=o,e.depth[o]=0):n[2*o+1]=0;for(;e.heap_len<2;)n[2*(a=e.heap[++e.heap_len]=l<2?++l:0)]=1,e.depth[a]=0,e.opt_len--,s&&(e.static_len-=r[2*a+1]);for(t.max_code=l,o=e.heap_len>>1;o>=1;o--)L(e,n,o);a=c;do{o=e.heap[1],e.heap[1]=e.heap[e.heap_len--],L(e,n,1),i=e.heap[1],e.heap[--e.heap_max]=o,e.heap[--e.heap_max]=i,n[2*a]=n[2*o]+n[2*i],e.depth[a]=(e.depth[o]>=e.depth[i]?e.depth[o]:e.depth[i])+1,n[2*o+1]=n[2*i+1]=a,e.heap[1]=a++,L(e,n,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],I(e,t),N(n,l,e.bl_count)},M=function(e,t,o){var i,a,n=-1,r=t[1],s=0,c=7,l=4;for(0===r&&(c=138,l=3),t[2*(o+1)+1]=65535,i=0;i<=o;i++)a=r,r=t[2*(i+1)+1],++s<c&&a===r||(s<l?e.bl_tree[2*a]+=s:0!==a?(a!==n&&e.bl_tree[2*a]++,e.bl_tree[32]++):s<=10?e.bl_tree[34]++:e.bl_tree[36]++,s=0,n=a,0===r?(c=138,l=3):a===r?(c=6,l=3):(c=7,l=4))},B=function(e,t,o){var i,a,n=-1,r=t[1],s=0,c=7,l=4;for(0===r&&(c=138,l=3),i=0;i<=o;i++)if(a=r,r=t[2*(i+1)+1],!(++s<c&&a===r)){if(s<l)do{C(e,a,e.bl_tree)}while(0!=--s);else 0!==a?(a!==n&&(C(e,a,e.bl_tree),s--),C(e,16,e.bl_tree),v(e,s-3,2)):s<=10?(C(e,17,e.bl_tree),v(e,s-3,3)):(C(e,18,e.bl_tree),v(e,s-11,7));s=0,n=a,0===r?(c=138,l=3):a===r?(c=6,l=3):(c=7,l=4)}},k=function(e){var t;for(M(e,e.dyn_ltree,e.l_desc.max_code),M(e,e.dyn_dtree,e.d_desc.max_code),D(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*n[t]+1];t--);return e.opt_len+=14+3*(t+1),t},G=function(e,t,o,i){var a;for(v(e,t-257,5),v(e,o-1,5),v(e,i-4,4),a=0;a<i;a++)v(e,e.bl_tree[2*n[a]+1],3);B(e,e.dyn_ltree,t-1),B(e,e.dyn_dtree,o-1)},O=function(e){var t,o=4093624447;for(t=0;t<=31;t++,o>>>=1)if(1&o&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<256;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0},H=!1,V=function(e,t,o,i){v(e,0+(i?1:0),3),P(e,t,o,!0)},F=function(e){H||(b(),H=!0),e.l_desc=new m(e.dyn_ltree,u),e.d_desc=new m(e.dyn_dtree,h),e.bl_desc=new m(e.bl_tree,p),e.bi_buf=0,e.bi_valid=0,w(e)},U=V,x=function(e,t,o,i){var a,n,c=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=O(e)),D(e,e.l_desc),D(e,e.d_desc),c=k(e),a=e.opt_len+3+7>>>3,(n=e.static_len+3+7>>>3)<=a&&(a=n)):a=n=o+5,o+4<=a&&-1!==t?V(e,t,o,i):4===e.strategy||n===a?(v(e,2+(i?1:0),3),A(e,r,s)):(v(e,4+(i?1:0),3),G(e,e.l_desc.max_code+1,e.d_desc.max_code+1,c+1),A(e,e.dyn_ltree,e.dyn_dtree)),w(e),i&&E(e)},Y=function(e,t,o){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&o,e.last_lit++,0===t?e.dyn_ltree[2*o]++:(e.matches++,t--,e.dyn_ltree[2*(l[o]+256+1)]++,e.dyn_dtree[2*_(t)]++),e.last_lit===e.lit_bufsize-1},j=function(e){v(e,2,3),C(e,256,r),T(e)},W=function(e,t,o,i){for(var a=65535&e|0,n=e>>>16&65535|0,r=0;0!==o;){o-=r=o>2e3?2e3:o;do{n=n+(a=a+t[i++]|0)|0}while(--r);a%=65521,n%=65521}return a|n<<16|0},z=new Uint32Array(function(){for(var e,t=[],o=0;o<256;o++){e=o;for(var i=0;i<8;i++)e=1&e?3988292384^e>>>1:e>>>1;t[o]=e}return t}()),K=function(e,t,o,i){var a=z,n=i+o;e^=-1;for(var r=i;r<n;r++)e=e>>>8^a[255&(e^t[r])];return-1^e},q={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Q={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8},X=F,J=U,Z=x,$=Y,ee=j,te=Q.Z_NO_FLUSH,oe=Q.Z_PARTIAL_FLUSH,ie=Q.Z_FULL_FLUSH,ae=Q.Z_FINISH,ne=Q.Z_BLOCK,re=Q.Z_OK,se=Q.Z_STREAM_END,ce=Q.Z_STREAM_ERROR,le=Q.Z_DATA_ERROR,de=Q.Z_BUF_ERROR,ue=Q.Z_DEFAULT_COMPRESSION,he=Q.Z_FILTERED,pe=Q.Z_HUFFMAN_ONLY,fe=Q.Z_RLE,ge=Q.Z_FIXED,me=Q.Z_DEFAULT_STRATEGY,_e=Q.Z_UNKNOWN,ye=Q.Z_DEFLATED,ve=286,Ce=30,Se=19,Te=2*ve+1,Ie=15,Ne=function(e,t){return e.msg=q[t],t},be=function(e){return(e<<1)-(e>4?9:0)},we=function(e){for(var t=e.length;--t>=0;)e[t]=0},Ee=function(e,t,o){return(t<<e.hash_shift^o)&e.hash_mask},Pe=function(e){var t=e.state,o=t.pending;o>e.avail_out&&(o=e.avail_out),0!==o&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+o),e.next_out),e.next_out+=o,t.pending_out+=o,e.total_out+=o,e.avail_out-=o,t.pending-=o,0===t.pending&&(t.pending_out=0))},Re=function(e,t){Z(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,Pe(e.strm)},Le=function(e,t){e.pending_buf[e.pending++]=t},Ae=function(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},De=function(e,t){var o,i,a=e.max_chain_length,n=e.strstart,r=e.prev_length,s=e.nice_match,c=e.strstart>e.w_size-262?e.strstart-(e.w_size-262):0,l=e.window,d=e.w_mask,u=e.prev,h=e.strstart+258,p=l[n+r-1],f=l[n+r];e.prev_length>=e.good_match&&(a>>=2),s>e.lookahead&&(s=e.lookahead);do{if(l[(o=t)+r]===f&&l[o+r-1]===p&&l[o]===l[n]&&l[++o]===l[n+1]){n+=2,o++;do{}while(l[++n]===l[++o]&&l[++n]===l[++o]&&l[++n]===l[++o]&&l[++n]===l[++o]&&l[++n]===l[++o]&&l[++n]===l[++o]&&l[++n]===l[++o]&&l[++n]===l[++o]&&n<h);if(i=258-(h-n),n=h-258,i>r){if(e.match_start=t,r=i,i>=s)break;p=l[n+r-1],f=l[n+r]}}}while((t=u[t&d])>c&&0!=--a);return r<=e.lookahead?r:e.lookahead},Me=function(e){var t,o,i,a,n,r,s,c,l,d,u=e.w_size;do{if(a=e.window_size-e.lookahead-e.strstart,e.strstart>=u+(u-262)){e.window.set(e.window.subarray(u,u+u),0),e.match_start-=u,e.strstart-=u,e.block_start-=u,t=o=e.hash_size;do{i=e.head[--t],e.head[t]=i>=u?i-u:0}while(--o);t=o=u;do{i=e.prev[--t],e.prev[t]=i>=u?i-u:0}while(--o);a+=u}if(0===e.strm.avail_in)break;if(r=e.strm,s=e.window,c=e.strstart+e.lookahead,l=a,d=void 0,(d=r.avail_in)>l&&(d=l),o=0===d?0:(r.avail_in-=d,s.set(r.input.subarray(r.next_in,r.next_in+d),c),1===r.state.wrap?r.adler=W(r.adler,s,d,c):2===r.state.wrap&&(r.adler=K(r.adler,s,d,c)),r.next_in+=d,r.total_in+=d,d),e.lookahead+=o,e.lookahead+e.insert>=3)for(n=e.strstart-e.insert,e.ins_h=e.window[n],e.ins_h=Ee(e,e.ins_h,e.window[n+1]);e.insert&&(e.ins_h=Ee(e,e.ins_h,e.window[n+3-1]),e.prev[n&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=n,n++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<262&&0!==e.strm.avail_in)},Be=function(e,t){for(var o,i;;){if(e.lookahead<262){if(Me(e),e.lookahead<262&&t===te)return 1;if(0===e.lookahead)break}if(o=0,e.lookahead>=3&&(e.ins_h=Ee(e,e.ins_h,e.window[e.strstart+3-1]),o=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==o&&e.strstart-o<=e.w_size-262&&(e.match_length=De(e,o)),e.match_length>=3)if(i=$(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=Ee(e,e.ins_h,e.window[e.strstart+3-1]),o=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=Ee(e,e.ins_h,e.window[e.strstart+1]);else i=$(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(i&&(Re(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,t===ae?(Re(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(Re(e,!1),0===e.strm.avail_out)?1:2},ke=function(e,t){for(var o,i,a;;){if(e.lookahead<262){if(Me(e),e.lookahead<262&&t===te)return 1;if(0===e.lookahead)break}if(o=0,e.lookahead>=3&&(e.ins_h=Ee(e,e.ins_h,e.window[e.strstart+3-1]),o=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==o&&e.prev_length<e.max_lazy_match&&e.strstart-o<=e.w_size-262&&(e.match_length=De(e,o),e.match_length<=5&&(e.strategy===he||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){a=e.strstart+e.lookahead-3,i=$(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=a&&(e.ins_h=Ee(e,e.ins_h,e.window[e.strstart+3-1]),o=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,i&&(Re(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if((i=$(e,0,e.window[e.strstart-1]))&&Re(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(i=$(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,t===ae?(Re(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(Re(e,!1),0===e.strm.avail_out)?1:2},Ge=function(e,t){for(var o,i,a,n,r=e.window;;){if(e.lookahead<=258){if(Me(e),e.lookahead<=258&&t===te)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(i=r[a=e.strstart-1])===r[++a]&&i===r[++a]&&i===r[++a]){n=e.strstart+258;do{}while(i===r[++a]&&i===r[++a]&&i===r[++a]&&i===r[++a]&&i===r[++a]&&i===r[++a]&&i===r[++a]&&i===r[++a]&&a<n);e.match_length=258-(n-a),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(o=$(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(o=$(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),o&&(Re(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===ae?(Re(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(Re(e,!1),0===e.strm.avail_out)?1:2},Oe=function(e,t){for(var o;;){if(0===e.lookahead&&(Me(e),0===e.lookahead)){if(t===te)return 1;break}if(e.match_length=0,o=$(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,o&&(Re(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===ae?(Re(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(Re(e,!1),0===e.strm.avail_out)?1:2};function He(e,t,o,i,a){this.good_length=e,this.max_lazy=t,this.nice_length=o,this.max_chain=i,this.func=a}var Ve=[new He(0,0,0,0,function(e,t){var o=65535;for(o>e.pending_buf_size-5&&(o=e.pending_buf_size-5);;){if(e.lookahead<=1){if(Me(e),0===e.lookahead&&t===te)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var i=e.block_start+o;if((0===e.strstart||e.strstart>=i)&&(e.lookahead=e.strstart-i,e.strstart=i,Re(e,!1),0===e.strm.avail_out))return 1;if(e.strstart-e.block_start>=e.w_size-262&&(Re(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===ae?(Re(e,!0),0===e.strm.avail_out?3:4):(e.strstart>e.block_start&&(Re(e,!1),e.strm.avail_out),1)}),new He(4,4,8,4,Be),new He(4,5,16,8,Be),new He(4,6,32,32,Be),new He(4,4,16,16,ke),new He(8,16,32,32,ke),new He(8,16,128,128,ke),new He(8,32,128,256,ke),new He(32,128,258,1024,ke),new He(32,258,258,4096,ke)];function Fe(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=ye,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(2*Te),this.dyn_dtree=new Uint16Array(2*(2*Ce+1)),this.bl_tree=new Uint16Array(2*(2*Se+1)),we(this.dyn_ltree),we(this.dyn_dtree),we(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(Ie+1),this.heap=new Uint16Array(2*ve+1),we(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*ve+1),we(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}var Ue=function(e){if(!e||!e.state)return Ne(e,ce);e.total_in=e.total_out=0,e.data_type=_e;var t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?42:113,e.adler=2===t.wrap?0:1,t.last_flush=te,X(t),re},xe=function(e){var t,o=Ue(e);return o===re&&((t=e.state).window_size=2*t.w_size,we(t.head),t.max_lazy_match=Ve[t.level].max_lazy,t.good_match=Ve[t.level].good_length,t.nice_match=Ve[t.level].nice_length,t.max_chain_length=Ve[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=2,t.match_available=0,t.ins_h=0),o},Ye=function(e,t,o,i,a,n){if(!e)return ce;var r=1;if(t===ue&&(t=6),i<0?(r=0,i=-i):i>15&&(r=2,i-=16),a<1||a>9||o!==ye||i<8||i>15||t<0||t>9||n<0||n>ge)return Ne(e,ce);8===i&&(i=9);var s=new Fe;return e.state=s,s.strm=e,s.wrap=r,s.gzhead=null,s.w_bits=i,s.w_size=1<<s.w_bits,s.w_mask=s.w_size-1,s.hash_bits=a+7,s.hash_size=1<<s.hash_bits,s.hash_mask=s.hash_size-1,s.hash_shift=~~((s.hash_bits+3-1)/3),s.window=new Uint8Array(2*s.w_size),s.head=new Uint16Array(s.hash_size),s.prev=new Uint16Array(s.w_size),s.lit_bufsize=1<<a+6,s.pending_buf_size=4*s.lit_bufsize,s.pending_buf=new Uint8Array(s.pending_buf_size),s.d_buf=1*s.lit_bufsize,s.l_buf=3*s.lit_bufsize,s.level=t,s.strategy=n,s.method=o,xe(e)},je={deflateInit:function(e,t){return Ye(e,t,ye,15,8,me)},deflateInit2:Ye,deflateReset:xe,deflateResetKeep:Ue,deflateSetHeader:function(e,t){return e&&e.state?2!==e.state.wrap?ce:(e.state.gzhead=t,re):ce},deflate:function(e,t){var o,i;if(!e||!e.state||t>ne||t<0)return e?Ne(e,ce):ce;var a=e.state;if(!e.output||!e.input&&0!==e.avail_in||666===a.status&&t!==ae)return Ne(e,0===e.avail_out?de:ce);a.strm=e;var n=a.last_flush;if(a.last_flush=t,42===a.status)if(2===a.wrap)e.adler=0,Le(a,31),Le(a,139),Le(a,8),a.gzhead?(Le(a,(a.gzhead.text?1:0)+(a.gzhead.hcrc?2:0)+(a.gzhead.extra?4:0)+(a.gzhead.name?8:0)+(a.gzhead.comment?16:0)),Le(a,255&a.gzhead.time),Le(a,a.gzhead.time>>8&255),Le(a,a.gzhead.time>>16&255),Le(a,a.gzhead.time>>24&255),Le(a,9===a.level?2:a.strategy>=pe||a.level<2?4:0),Le(a,255&a.gzhead.os),a.gzhead.extra&&a.gzhead.extra.length&&(Le(a,255&a.gzhead.extra.length),Le(a,a.gzhead.extra.length>>8&255)),a.gzhead.hcrc&&(e.adler=K(e.adler,a.pending_buf,a.pending,0)),a.gzindex=0,a.status=69):(Le(a,0),Le(a,0),Le(a,0),Le(a,0),Le(a,0),Le(a,9===a.level?2:a.strategy>=pe||a.level<2?4:0),Le(a,3),a.status=113);else{var r=ye+(a.w_bits-8<<4)<<8;r|=(a.strategy>=pe||a.level<2?0:a.level<6?1:6===a.level?2:3)<<6,0!==a.strstart&&(r|=32),r+=31-r%31,a.status=113,Ae(a,r),0!==a.strstart&&(Ae(a,e.adler>>>16),Ae(a,65535&e.adler)),e.adler=1}if(69===a.status)if(a.gzhead.extra){for(o=a.pending;a.gzindex<(65535&a.gzhead.extra.length)&&(a.pending!==a.pending_buf_size||(a.gzhead.hcrc&&a.pending>o&&(e.adler=K(e.adler,a.pending_buf,a.pending-o,o)),Pe(e),o=a.pending,a.pending!==a.pending_buf_size));)Le(a,255&a.gzhead.extra[a.gzindex]),a.gzindex++;a.gzhead.hcrc&&a.pending>o&&(e.adler=K(e.adler,a.pending_buf,a.pending-o,o)),a.gzindex===a.gzhead.extra.length&&(a.gzindex=0,a.status=73)}else a.status=73;if(73===a.status)if(a.gzhead.name){o=a.pending;do{if(a.pending===a.pending_buf_size&&(a.gzhead.hcrc&&a.pending>o&&(e.adler=K(e.adler,a.pending_buf,a.pending-o,o)),Pe(e),o=a.pending,a.pending===a.pending_buf_size)){i=1;break}i=a.gzindex<a.gzhead.name.length?255&a.gzhead.name.charCodeAt(a.gzindex++):0,Le(a,i)}while(0!==i);a.gzhead.hcrc&&a.pending>o&&(e.adler=K(e.adler,a.pending_buf,a.pending-o,o)),0===i&&(a.gzindex=0,a.status=91)}else a.status=91;if(91===a.status)if(a.gzhead.comment){o=a.pending;do{if(a.pending===a.pending_buf_size&&(a.gzhead.hcrc&&a.pending>o&&(e.adler=K(e.adler,a.pending_buf,a.pending-o,o)),Pe(e),o=a.pending,a.pending===a.pending_buf_size)){i=1;break}i=a.gzindex<a.gzhead.comment.length?255&a.gzhead.comment.charCodeAt(a.gzindex++):0,Le(a,i)}while(0!==i);a.gzhead.hcrc&&a.pending>o&&(e.adler=K(e.adler,a.pending_buf,a.pending-o,o)),0===i&&(a.status=103)}else a.status=103;if(103===a.status&&(a.gzhead.hcrc?(a.pending+2>a.pending_buf_size&&Pe(e),a.pending+2<=a.pending_buf_size&&(Le(a,255&e.adler),Le(a,e.adler>>8&255),e.adler=0,a.status=113)):a.status=113),0!==a.pending){if(Pe(e),0===e.avail_out)return a.last_flush=-1,re}else if(0===e.avail_in&&be(t)<=be(n)&&t!==ae)return Ne(e,de);if(666===a.status&&0!==e.avail_in)return Ne(e,de);if(0!==e.avail_in||0!==a.lookahead||t!==te&&666!==a.status){var s=a.strategy===pe?Oe(a,t):a.strategy===fe?Ge(a,t):Ve[a.level].func(a,t);if(3!==s&&4!==s||(a.status=666),1===s||3===s)return 0===e.avail_out&&(a.last_flush=-1),re;if(2===s&&(t===oe?ee(a):t!==ne&&(J(a,0,0,!1),t===ie&&(we(a.head),0===a.lookahead&&(a.strstart=0,a.block_start=0,a.insert=0))),Pe(e),0===e.avail_out))return a.last_flush=-1,re}return t!==ae?re:a.wrap<=0?se:(2===a.wrap?(Le(a,255&e.adler),Le(a,e.adler>>8&255),Le(a,e.adler>>16&255),Le(a,e.adler>>24&255),Le(a,255&e.total_in),Le(a,e.total_in>>8&255),Le(a,e.total_in>>16&255),Le(a,e.total_in>>24&255)):(Ae(a,e.adler>>>16),Ae(a,65535&e.adler)),Pe(e),a.wrap>0&&(a.wrap=-a.wrap),0!==a.pending?re:se)},deflateEnd:function(e){if(!e||!e.state)return ce;var t=e.state.status;return 42!==t&&69!==t&&73!==t&&91!==t&&103!==t&&113!==t&&666!==t?Ne(e,ce):(e.state=null,113===t?Ne(e,le):re)},deflateSetDictionary:function(e,t){var o=t.length;if(!e||!e.state)return ce;var i=e.state,a=i.wrap;if(2===a||1===a&&42!==i.status||i.lookahead)return ce;if(1===a&&(e.adler=W(e.adler,t,o,0)),i.wrap=0,o>=i.w_size){0===a&&(we(i.head),i.strstart=0,i.block_start=0,i.insert=0);var n=new Uint8Array(i.w_size);n.set(t.subarray(o-i.w_size,o),0),t=n,o=i.w_size}var r=e.avail_in,s=e.next_in,c=e.input;for(e.avail_in=o,e.next_in=0,e.input=t,Me(i);i.lookahead>=3;){var l=i.strstart,d=i.lookahead-2;do{i.ins_h=Ee(i,i.ins_h,i.window[l+3-1]),i.prev[l&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=l,l++}while(--d);i.strstart=l,i.lookahead=2,Me(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=2,i.match_available=0,e.next_in=s,e.input=c,e.avail_in=r,i.wrap=a,re},deflateInfo:"pako deflate (from Nodeca project)"},We=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},ze={assign:function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var o=t.shift();if(o){if("object"!=typeof o)throw new TypeError(o+"must be non-object");for(var i in o)We(o,i)&&(e[i]=o[i])}}return e},flattenChunks:function(e){for(var t=0,o=0,i=e.length;o<i;o++)t+=e[o].length;for(var a=new Uint8Array(t),n=0,r=0,s=e.length;n<s;n++){var c=e[n];a.set(c,r),r+=c.length}return a}},Ke=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(po){Ke=!1}for(var qe=new Uint8Array(256),Qe=0;Qe<256;Qe++)qe[Qe]=Qe>=252?6:Qe>=248?5:Qe>=240?4:Qe>=224?3:Qe>=192?2:1;qe[254]=qe[254]=1;var Xe=function(e,t){if(t<65534&&e.subarray&&Ke)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));for(var o="",i=0;i<t;i++)o+=String.fromCharCode(e[i]);return o},Je={string2buf:function(e){if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(e);var t,o,i,a,n,r=e.length,s=0;for(a=0;a<r;a++)55296==(64512&(o=e.charCodeAt(a)))&&a+1<r&&56320==(64512&(i=e.charCodeAt(a+1)))&&(o=65536+(o-55296<<10)+(i-56320),a++),s+=o<128?1:o<2048?2:o<65536?3:4;for(t=new Uint8Array(s),n=0,a=0;n<s;a++)55296==(64512&(o=e.charCodeAt(a)))&&a+1<r&&56320==(64512&(i=e.charCodeAt(a+1)))&&(o=65536+(o-55296<<10)+(i-56320),a++),o<128?t[n++]=o:o<2048?(t[n++]=192|o>>>6,t[n++]=128|63&o):o<65536?(t[n++]=224|o>>>12,t[n++]=128|o>>>6&63,t[n++]=128|63&o):(t[n++]=240|o>>>18,t[n++]=128|o>>>12&63,t[n++]=128|o>>>6&63,t[n++]=128|63&o);return t},buf2string:function(e,t){var o,i,a=t||e.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(e.subarray(0,t));var n=new Array(2*a);for(i=0,o=0;o<a;){var r=e[o++];if(r<128)n[i++]=r;else{var s=qe[r];if(s>4)n[i++]=65533,o+=s-1;else{for(r&=2===s?31:3===s?15:7;s>1&&o<a;)r=r<<6|63&e[o++],s--;s>1?n[i++]=65533:r<65536?n[i++]=r:(r-=65536,n[i++]=55296|r>>10&1023,n[i++]=56320|1023&r)}}}return Xe(n,i)},utf8border:function(e,t){(t=t||e.length)>e.length&&(t=e.length);for(var o=t-1;o>=0&&128==(192&e[o]);)o--;return o<0?t:0===o?t:o+qe[e[o]]>t?o:t}},Ze=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0},$e=Object.prototype.toString,et=Q.Z_NO_FLUSH,tt=Q.Z_SYNC_FLUSH,ot=Q.Z_FULL_FLUSH,it=Q.Z_FINISH,at=Q.Z_OK,nt=Q.Z_STREAM_END,rt=Q.Z_DEFAULT_COMPRESSION,st=Q.Z_DEFAULT_STRATEGY,ct=Q.Z_DEFLATED;function lt(e){this.options=ze.assign({level:rt,method:ct,chunkSize:16384,windowBits:15,memLevel:8,strategy:st},e||{});var t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Ze,this.strm.avail_out=0;var o=je.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(o!==at)throw new Error(q[o]);if(t.header&&je.deflateSetHeader(this.strm,t.header),t.dictionary){var i;if(i="string"==typeof t.dictionary?Je.string2buf(t.dictionary):"[object ArrayBuffer]"===$e.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,(o=je.deflateSetDictionary(this.strm,i))!==at)throw new Error(q[o]);this._dict_set=!0}}function dt(e,t){var o=new lt(t);if(o.push(e,!0),o.err)throw o.msg||q[o.err];return o.result}lt.prototype.push=function(e,t){var o,i,a=this.strm,n=this.options.chunkSize;if(this.ended)return!1;for(i=t===~~t?t:!0===t?it:et,"string"==typeof e?a.input=Je.string2buf(e):"[object ArrayBuffer]"===$e.call(e)?a.input=new Uint8Array(e):a.input=e,a.next_in=0,a.avail_in=a.input.length;;)if(0===a.avail_out&&(a.output=new Uint8Array(n),a.next_out=0,a.avail_out=n),(i===tt||i===ot)&&a.avail_out<=6)this.onData(a.output.subarray(0,a.next_out)),a.avail_out=0;else{if((o=je.deflate(a,i))===nt)return a.next_out>0&&this.onData(a.output.subarray(0,a.next_out)),o=je.deflateEnd(this.strm),this.onEnd(o),this.ended=!0,o===at;if(0!==a.avail_out){if(i>0&&a.next_out>0)this.onData(a.output.subarray(0,a.next_out)),a.avail_out=0;else if(0===a.avail_in)break}else this.onData(a.output)}return!0},lt.prototype.onData=function(e){this.chunks.push(e)},lt.prototype.onEnd=function(e){e===at&&(this.result=ze.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var ut=lt,ht=dt,pt=function(e,t){return(t=t||{}).raw=!0,dt(e,t)},ft=function(e,t){return(t=t||{}).gzip=!0,dt(e,t)},gt=function(e,t){var o,i,a,n,r,s,c,l,d,u,h,p,f,g,m,_,y,v,C,S,T,I,N,b,w=e.state;o=e.next_in,N=e.input,i=o+(e.avail_in-5),a=e.next_out,b=e.output,n=a-(t-e.avail_out),r=a+(e.avail_out-257),s=w.dmax,c=w.wsize,l=w.whave,d=w.wnext,u=w.window,h=w.hold,p=w.bits,f=w.lencode,g=w.distcode,m=(1<<w.lenbits)-1,_=(1<<w.distbits)-1;e:do{p<15&&(h+=N[o++]<<p,p+=8,h+=N[o++]<<p,p+=8),y=f[h&m];t:for(;;){if(h>>>=v=y>>>24,p-=v,0==(v=y>>>16&255))b[a++]=65535&y;else{if(!(16&v)){if(0==(64&v)){y=f[(65535&y)+(h&(1<<v)-1)];continue t}if(32&v){w.mode=12;break e}e.msg="invalid literal/length code",w.mode=30;break e}C=65535&y,(v&=15)&&(p<v&&(h+=N[o++]<<p,p+=8),C+=h&(1<<v)-1,h>>>=v,p-=v),p<15&&(h+=N[o++]<<p,p+=8,h+=N[o++]<<p,p+=8),y=g[h&_];o:for(;;){if(h>>>=v=y>>>24,p-=v,!(16&(v=y>>>16&255))){if(0==(64&v)){y=g[(65535&y)+(h&(1<<v)-1)];continue o}e.msg="invalid distance code",w.mode=30;break e}if(S=65535&y,p<(v&=15)&&(h+=N[o++]<<p,(p+=8)<v&&(h+=N[o++]<<p,p+=8)),(S+=h&(1<<v)-1)>s){e.msg="invalid distance too far back",w.mode=30;break e}if(h>>>=v,p-=v,S>(v=a-n)){if((v=S-v)>l&&w.sane){e.msg="invalid distance too far back",w.mode=30;break e}if(T=0,I=u,0===d){if(T+=c-v,v<C){C-=v;do{b[a++]=u[T++]}while(--v);T=a-S,I=b}}else if(d<v){if(T+=c+d-v,(v-=d)<C){C-=v;do{b[a++]=u[T++]}while(--v);if(T=0,d<C){C-=v=d;do{b[a++]=u[T++]}while(--v);T=a-S,I=b}}}else if(T+=d-v,v<C){C-=v;do{b[a++]=u[T++]}while(--v);T=a-S,I=b}for(;C>2;)b[a++]=I[T++],b[a++]=I[T++],b[a++]=I[T++],C-=3;C&&(b[a++]=I[T++],C>1&&(b[a++]=I[T++]))}else{T=a-S;do{b[a++]=b[T++],b[a++]=b[T++],b[a++]=b[T++],C-=3}while(C>2);C&&(b[a++]=b[T++],C>1&&(b[a++]=b[T++]))}break}}break}}while(o<i&&a<r);o-=C=p>>3,h&=(1<<(p-=C<<3))-1,e.next_in=o,e.next_out=a,e.avail_in=o<i?i-o+5:5-(o-i),e.avail_out=a<r?r-a+257:257-(a-r),w.hold=h,w.bits=p},mt=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),_t=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),yt=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),vt=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),Ct=function(e,t,o,i,a,n,r,s){var c,l,d,u,h,p,f,g,m,_=s.bits,y=0,v=0,C=0,S=0,T=0,I=0,N=0,b=0,w=0,E=0,P=null,R=0,L=new Uint16Array(16),A=new Uint16Array(16),D=null,M=0;for(y=0;y<=15;y++)L[y]=0;for(v=0;v<i;v++)L[t[o+v]]++;for(T=_,S=15;S>=1&&0===L[S];S--);if(T>S&&(T=S),0===S)return a[n++]=20971520,a[n++]=20971520,s.bits=1,0;for(C=1;C<S&&0===L[C];C++);for(T<C&&(T=C),b=1,y=1;y<=15;y++)if(b<<=1,(b-=L[y])<0)return-1;if(b>0&&(0===e||1!==S))return-1;for(A[1]=0,y=1;y<15;y++)A[y+1]=A[y]+L[y];for(v=0;v<i;v++)0!==t[o+v]&&(r[A[t[o+v]]++]=v);if(0===e?(P=D=r,p=19):1===e?(P=mt,R-=257,D=_t,M-=257,p=256):(P=yt,D=vt,p=-1),E=0,v=0,y=C,h=n,I=T,N=0,d=-1,u=(w=1<<T)-1,1===e&&w>852||2===e&&w>592)return 1;for(;;){f=y-N,r[v]<p?(g=0,m=r[v]):r[v]>p?(g=D[M+r[v]],m=P[R+r[v]]):(g=96,m=0),c=1<<y-N,C=l=1<<I;do{a[h+(E>>N)+(l-=c)]=f<<24|g<<16|m|0}while(0!==l);for(c=1<<y-1;E&c;)c>>=1;if(0!==c?(E&=c-1,E+=c):E=0,v++,0==--L[y]){if(y===S)break;y=t[o+r[v]]}if(y>T&&(E&u)!==d){for(0===N&&(N=T),h+=C,b=1<<(I=y-N);I+N<S&&!((b-=L[I+N])<=0);)I++,b<<=1;if(w+=1<<I,1===e&&w>852||2===e&&w>592)return 1;a[d=E&u]=T<<24|I<<16|h-n|0}}return 0!==E&&(a[h+E]=y-N<<24|64<<16|0),s.bits=T,0},St=Q.Z_FINISH,Tt=Q.Z_BLOCK,It=Q.Z_TREES,Nt=Q.Z_OK,bt=Q.Z_STREAM_END,wt=Q.Z_NEED_DICT,Et=Q.Z_STREAM_ERROR,Pt=Q.Z_DATA_ERROR,Rt=Q.Z_MEM_ERROR,Lt=Q.Z_BUF_ERROR,At=Q.Z_DEFLATED,Dt=function(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)};function Mt(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}var Bt,kt,Gt=function(e){if(!e||!e.state)return Et;var t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,Nt},Ot=function(e){if(!e||!e.state)return Et;var t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,Gt(e)},Ht=function(e,t){var o;if(!e||!e.state)return Et;var i=e.state;return t<0?(o=0,t=-t):(o=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?Et:(null!==i.window&&i.wbits!==t&&(i.window=null),i.wrap=o,i.wbits=t,Ot(e))},Vt=function(e,t){if(!e)return Et;var o=new Mt;e.state=o,o.window=null;var i=Ht(e,t);return i!==Nt&&(e.state=null),i},Ft=!0,Ut=function(e){if(Ft){Bt=new Int32Array(512),kt=new Int32Array(32);for(var t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(Ct(1,e.lens,0,288,Bt,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;Ct(2,e.lens,0,32,kt,0,e.work,{bits:5}),Ft=!1}e.lencode=Bt,e.lenbits=9,e.distcode=kt,e.distbits=5},xt=function(e,t,o,i){var a,n=e.state;return null===n.window&&(n.wsize=1<<n.wbits,n.wnext=0,n.whave=0,n.window=new Uint8Array(n.wsize)),i>=n.wsize?(n.window.set(t.subarray(o-n.wsize,o),0),n.wnext=0,n.whave=n.wsize):((a=n.wsize-n.wnext)>i&&(a=i),n.window.set(t.subarray(o-i,o-i+a),n.wnext),(i-=a)?(n.window.set(t.subarray(o-i,o),0),n.wnext=i,n.whave=n.wsize):(n.wnext+=a,n.wnext===n.wsize&&(n.wnext=0),n.whave<n.wsize&&(n.whave+=a))),0},Yt={inflateReset:Ot,inflateReset2:Ht,inflateResetKeep:Gt,inflateInit:function(e){return Vt(e,15)},inflateInit2:Vt,inflate:function(e,t){var o,i,a,n,r,s,c,l,d,u,h,p,f,g,m,_,y,v,C,S,T,I,N,b,w=0,E=new Uint8Array(4),P=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return Et;12===(o=e.state).mode&&(o.mode=13),r=e.next_out,a=e.output,c=e.avail_out,n=e.next_in,i=e.input,s=e.avail_in,l=o.hold,d=o.bits,u=s,h=c,I=Nt;e:for(;;)switch(o.mode){case 1:if(0===o.wrap){o.mode=13;break}for(;d<16;){if(0===s)break e;s--,l+=i[n++]<<d,d+=8}if(2&o.wrap&&35615===l){o.check=0,E[0]=255&l,E[1]=l>>>8&255,o.check=K(o.check,E,2,0),l=0,d=0,o.mode=2;break}if(o.flags=0,o.head&&(o.head.done=!1),!(1&o.wrap)||(((255&l)<<8)+(l>>8))%31){e.msg="incorrect header check",o.mode=30;break}if((15&l)!==At){e.msg="unknown compression method",o.mode=30;break}if(d-=4,T=8+(15&(l>>>=4)),0===o.wbits)o.wbits=T;else if(T>o.wbits){e.msg="invalid window size",o.mode=30;break}o.dmax=1<<o.wbits,e.adler=o.check=1,o.mode=512&l?10:12,l=0,d=0;break;case 2:for(;d<16;){if(0===s)break e;s--,l+=i[n++]<<d,d+=8}if(o.flags=l,(255&o.flags)!==At){e.msg="unknown compression method",o.mode=30;break}if(57344&o.flags){e.msg="unknown header flags set",o.mode=30;break}o.head&&(o.head.text=l>>8&1),512&o.flags&&(E[0]=255&l,E[1]=l>>>8&255,o.check=K(o.check,E,2,0)),l=0,d=0,o.mode=3;case 3:for(;d<32;){if(0===s)break e;s--,l+=i[n++]<<d,d+=8}o.head&&(o.head.time=l),512&o.flags&&(E[0]=255&l,E[1]=l>>>8&255,E[2]=l>>>16&255,E[3]=l>>>24&255,o.check=K(o.check,E,4,0)),l=0,d=0,o.mode=4;case 4:for(;d<16;){if(0===s)break e;s--,l+=i[n++]<<d,d+=8}o.head&&(o.head.xflags=255&l,o.head.os=l>>8),512&o.flags&&(E[0]=255&l,E[1]=l>>>8&255,o.check=K(o.check,E,2,0)),l=0,d=0,o.mode=5;case 5:if(1024&o.flags){for(;d<16;){if(0===s)break e;s--,l+=i[n++]<<d,d+=8}o.length=l,o.head&&(o.head.extra_len=l),512&o.flags&&(E[0]=255&l,E[1]=l>>>8&255,o.check=K(o.check,E,2,0)),l=0,d=0}else o.head&&(o.head.extra=null);o.mode=6;case 6:if(1024&o.flags&&((p=o.length)>s&&(p=s),p&&(o.head&&(T=o.head.extra_len-o.length,o.head.extra||(o.head.extra=new Uint8Array(o.head.extra_len)),o.head.extra.set(i.subarray(n,n+p),T)),512&o.flags&&(o.check=K(o.check,i,p,n)),s-=p,n+=p,o.length-=p),o.length))break e;o.length=0,o.mode=7;case 7:if(2048&o.flags){if(0===s)break e;p=0;do{T=i[n+p++],o.head&&T&&o.length<65536&&(o.head.name+=String.fromCharCode(T))}while(T&&p<s);if(512&o.flags&&(o.check=K(o.check,i,p,n)),s-=p,n+=p,T)break e}else o.head&&(o.head.name=null);o.length=0,o.mode=8;case 8:if(4096&o.flags){if(0===s)break e;p=0;do{T=i[n+p++],o.head&&T&&o.length<65536&&(o.head.comment+=String.fromCharCode(T))}while(T&&p<s);if(512&o.flags&&(o.check=K(o.check,i,p,n)),s-=p,n+=p,T)break e}else o.head&&(o.head.comment=null);o.mode=9;case 9:if(512&o.flags){for(;d<16;){if(0===s)break e;s--,l+=i[n++]<<d,d+=8}if(l!==(65535&o.check)){e.msg="header crc mismatch",o.mode=30;break}l=0,d=0}o.head&&(o.head.hcrc=o.flags>>9&1,o.head.done=!0),e.adler=o.check=0,o.mode=12;break;case 10:for(;d<32;){if(0===s)break e;s--,l+=i[n++]<<d,d+=8}e.adler=o.check=Dt(l),l=0,d=0,o.mode=11;case 11:if(0===o.havedict)return e.next_out=r,e.avail_out=c,e.next_in=n,e.avail_in=s,o.hold=l,o.bits=d,wt;e.adler=o.check=1,o.mode=12;case 12:if(t===Tt||t===It)break e;case 13:if(o.last){l>>>=7&d,d-=7&d,o.mode=27;break}for(;d<3;){if(0===s)break e;s--,l+=i[n++]<<d,d+=8}switch(o.last=1&l,d-=1,3&(l>>>=1)){case 0:o.mode=14;break;case 1:if(Ut(o),o.mode=20,t===It){l>>>=2,d-=2;break e}break;case 2:o.mode=17;break;case 3:e.msg="invalid block type",o.mode=30}l>>>=2,d-=2;break;case 14:for(l>>>=7&d,d-=7&d;d<32;){if(0===s)break e;s--,l+=i[n++]<<d,d+=8}if((65535&l)!=(l>>>16^65535)){e.msg="invalid stored block lengths",o.mode=30;break}if(o.length=65535&l,l=0,d=0,o.mode=15,t===It)break e;case 15:o.mode=16;case 16:if(p=o.length){if(p>s&&(p=s),p>c&&(p=c),0===p)break e;a.set(i.subarray(n,n+p),r),s-=p,n+=p,c-=p,r+=p,o.length-=p;break}o.mode=12;break;case 17:for(;d<14;){if(0===s)break e;s--,l+=i[n++]<<d,d+=8}if(o.nlen=257+(31&l),l>>>=5,d-=5,o.ndist=1+(31&l),l>>>=5,d-=5,o.ncode=4+(15&l),l>>>=4,d-=4,o.nlen>286||o.ndist>30){e.msg="too many length or distance symbols",o.mode=30;break}o.have=0,o.mode=18;case 18:for(;o.have<o.ncode;){for(;d<3;){if(0===s)break e;s--,l+=i[n++]<<d,d+=8}o.lens[P[o.have++]]=7&l,l>>>=3,d-=3}for(;o.have<19;)o.lens[P[o.have++]]=0;if(o.lencode=o.lendyn,o.lenbits=7,N={bits:o.lenbits},I=Ct(0,o.lens,0,19,o.lencode,0,o.work,N),o.lenbits=N.bits,I){e.msg="invalid code lengths set",o.mode=30;break}o.have=0,o.mode=19;case 19:for(;o.have<o.nlen+o.ndist;){for(;_=(w=o.lencode[l&(1<<o.lenbits)-1])>>>16&255,y=65535&w,!((m=w>>>24)<=d);){if(0===s)break e;s--,l+=i[n++]<<d,d+=8}if(y<16)l>>>=m,d-=m,o.lens[o.have++]=y;else{if(16===y){for(b=m+2;d<b;){if(0===s)break e;s--,l+=i[n++]<<d,d+=8}if(l>>>=m,d-=m,0===o.have){e.msg="invalid bit length repeat",o.mode=30;break}T=o.lens[o.have-1],p=3+(3&l),l>>>=2,d-=2}else if(17===y){for(b=m+3;d<b;){if(0===s)break e;s--,l+=i[n++]<<d,d+=8}d-=m,T=0,p=3+(7&(l>>>=m)),l>>>=3,d-=3}else{for(b=m+7;d<b;){if(0===s)break e;s--,l+=i[n++]<<d,d+=8}d-=m,T=0,p=11+(127&(l>>>=m)),l>>>=7,d-=7}if(o.have+p>o.nlen+o.ndist){e.msg="invalid bit length repeat",o.mode=30;break}for(;p--;)o.lens[o.have++]=T}}if(30===o.mode)break;if(0===o.lens[256]){e.msg="invalid code -- missing end-of-block",o.mode=30;break}if(o.lenbits=9,N={bits:o.lenbits},I=Ct(1,o.lens,0,o.nlen,o.lencode,0,o.work,N),o.lenbits=N.bits,I){e.msg="invalid literal/lengths set",o.mode=30;break}if(o.distbits=6,o.distcode=o.distdyn,N={bits:o.distbits},I=Ct(2,o.lens,o.nlen,o.ndist,o.distcode,0,o.work,N),o.distbits=N.bits,I){e.msg="invalid distances set",o.mode=30;break}if(o.mode=20,t===It)break e;case 20:o.mode=21;case 21:if(s>=6&&c>=258){e.next_out=r,e.avail_out=c,e.next_in=n,e.avail_in=s,o.hold=l,o.bits=d,gt(e,h),r=e.next_out,a=e.output,c=e.avail_out,n=e.next_in,i=e.input,s=e.avail_in,l=o.hold,d=o.bits,12===o.mode&&(o.back=-1);break}for(o.back=0;_=(w=o.lencode[l&(1<<o.lenbits)-1])>>>16&255,y=65535&w,!((m=w>>>24)<=d);){if(0===s)break e;s--,l+=i[n++]<<d,d+=8}if(_&&0==(240&_)){for(v=m,C=_,S=y;_=(w=o.lencode[S+((l&(1<<v+C)-1)>>v)])>>>16&255,y=65535&w,!(v+(m=w>>>24)<=d);){if(0===s)break e;s--,l+=i[n++]<<d,d+=8}l>>>=v,d-=v,o.back+=v}if(l>>>=m,d-=m,o.back+=m,o.length=y,0===_){o.mode=26;break}if(32&_){o.back=-1,o.mode=12;break}if(64&_){e.msg="invalid literal/length code",o.mode=30;break}o.extra=15&_,o.mode=22;case 22:if(o.extra){for(b=o.extra;d<b;){if(0===s)break e;s--,l+=i[n++]<<d,d+=8}o.length+=l&(1<<o.extra)-1,l>>>=o.extra,d-=o.extra,o.back+=o.extra}o.was=o.length,o.mode=23;case 23:for(;_=(w=o.distcode[l&(1<<o.distbits)-1])>>>16&255,y=65535&w,!((m=w>>>24)<=d);){if(0===s)break e;s--,l+=i[n++]<<d,d+=8}if(0==(240&_)){for(v=m,C=_,S=y;_=(w=o.distcode[S+((l&(1<<v+C)-1)>>v)])>>>16&255,y=65535&w,!(v+(m=w>>>24)<=d);){if(0===s)break e;s--,l+=i[n++]<<d,d+=8}l>>>=v,d-=v,o.back+=v}if(l>>>=m,d-=m,o.back+=m,64&_){e.msg="invalid distance code",o.mode=30;break}o.offset=y,o.extra=15&_,o.mode=24;case 24:if(o.extra){for(b=o.extra;d<b;){if(0===s)break e;s--,l+=i[n++]<<d,d+=8}o.offset+=l&(1<<o.extra)-1,l>>>=o.extra,d-=o.extra,o.back+=o.extra}if(o.offset>o.dmax){e.msg="invalid distance too far back",o.mode=30;break}o.mode=25;case 25:if(0===c)break e;if(p=h-c,o.offset>p){if((p=o.offset-p)>o.whave&&o.sane){e.msg="invalid distance too far back",o.mode=30;break}p>o.wnext?(p-=o.wnext,f=o.wsize-p):f=o.wnext-p,p>o.length&&(p=o.length),g=o.window}else g=a,f=r-o.offset,p=o.length;p>c&&(p=c),c-=p,o.length-=p;do{a[r++]=g[f++]}while(--p);0===o.length&&(o.mode=21);break;case 26:if(0===c)break e;a[r++]=o.length,c--,o.mode=21;break;case 27:if(o.wrap){for(;d<32;){if(0===s)break e;s--,l|=i[n++]<<d,d+=8}if(h-=c,e.total_out+=h,o.total+=h,h&&(e.adler=o.check=o.flags?K(o.check,a,h,r-h):W(o.check,a,h,r-h)),h=c,(o.flags?l:Dt(l))!==o.check){e.msg="incorrect data check",o.mode=30;break}l=0,d=0}o.mode=28;case 28:if(o.wrap&&o.flags){for(;d<32;){if(0===s)break e;s--,l+=i[n++]<<d,d+=8}if(l!==(4294967295&o.total)){e.msg="incorrect length check",o.mode=30;break}l=0,d=0}o.mode=29;case 29:I=bt;break e;case 30:I=Pt;break e;case 31:return Rt;case 32:default:return Et}return e.next_out=r,e.avail_out=c,e.next_in=n,e.avail_in=s,o.hold=l,o.bits=d,(o.wsize||h!==e.avail_out&&o.mode<30&&(o.mode<27||t!==St))&&xt(e,e.output,e.next_out,h-e.avail_out),u-=e.avail_in,h-=e.avail_out,e.total_in+=u,e.total_out+=h,o.total+=h,o.wrap&&h&&(e.adler=o.check=o.flags?K(o.check,a,h,e.next_out-h):W(o.check,a,h,e.next_out-h)),e.data_type=o.bits+(o.last?64:0)+(12===o.mode?128:0)+(20===o.mode||15===o.mode?256:0),(0===u&&0===h||t===St)&&I===Nt&&(I=Lt),I},inflateEnd:function(e){if(!e||!e.state)return Et;var t=e.state;return t.window&&(t.window=null),e.state=null,Nt},inflateGetHeader:function(e,t){if(!e||!e.state)return Et;var o=e.state;return 0==(2&o.wrap)?Et:(o.head=t,t.done=!1,Nt)},inflateSetDictionary:function(e,t){var o,i=t.length;return e&&e.state?0!==(o=e.state).wrap&&11!==o.mode?Et:11===o.mode&&W(1,t,i,0)!==o.check?Pt:xt(e,t,i,i)?(o.mode=31,Rt):(o.havedict=1,Nt):Et},inflateInfo:"pako inflate (from Nodeca project)"},jt=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1},Wt=Object.prototype.toString,zt=Q.Z_NO_FLUSH,Kt=Q.Z_FINISH,qt=Q.Z_OK,Qt=Q.Z_STREAM_END,Xt=Q.Z_NEED_DICT,Jt=Q.Z_STREAM_ERROR,Zt=Q.Z_DATA_ERROR,$t=Q.Z_MEM_ERROR;function eo(e){this.options=ze.assign({chunkSize:65536,windowBits:15,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Ze,this.strm.avail_out=0;var o=Yt.inflateInit2(this.strm,t.windowBits);if(o!==qt)throw new Error(q[o]);if(this.header=new jt,Yt.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=Je.string2buf(t.dictionary):"[object ArrayBuffer]"===Wt.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(o=Yt.inflateSetDictionary(this.strm,t.dictionary))!==qt))throw new Error(q[o])}function to(e,t){var o=new eo(t);if(o.push(e),o.err)throw o.msg||q[o.err];return o.result}eo.prototype.push=function(e,t){var o,i,a,n=this.strm,r=this.options.chunkSize,s=this.options.dictionary;if(this.ended)return!1;for(i=t===~~t?t:!0===t?Kt:zt,"[object ArrayBuffer]"===Wt.call(e)?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;){for(0===n.avail_out&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),(o=Yt.inflate(n,i))===Xt&&s&&((o=Yt.inflateSetDictionary(n,s))===qt?o=Yt.inflate(n,i):o===Zt&&(o=Xt));n.avail_in>0&&o===Qt&&n.state.wrap>0&&0!==e[n.next_in];)Yt.inflateReset(n),o=Yt.inflate(n,i);switch(o){case Jt:case Zt:case Xt:case $t:return this.onEnd(o),this.ended=!0,!1}if(a=n.avail_out,n.next_out&&(0===n.avail_out||o===Qt))if("string"===this.options.to){var c=Je.utf8border(n.output,n.next_out),l=n.next_out-c,d=Je.buf2string(n.output,c);n.next_out=l,n.avail_out=r-l,l&&n.output.set(n.output.subarray(c,c+l),0),this.onData(d)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(o!==qt||0!==a){if(o===Qt)return o=Yt.inflateEnd(this.strm),this.onEnd(o),this.ended=!0,!0;if(0===n.avail_in)break}}return!0},eo.prototype.onData=function(e){this.chunks.push(e)},eo.prototype.onEnd=function(e){e===qt&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=ze.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var oo=ut,io=ht,ao=pt,no=ft,ro=eo,so=to,co=function(e,t){return(t=t||{}).raw=!0,to(e,t)},lo=to,uo=Q,ho={Deflate:oo,deflate:io,deflateRaw:ao,gzip:no,Inflate:ro,inflate:so,inflateRaw:co,ungzip:lo,constants:uo};e.Deflate=oo,e.Inflate=ro,e.constants=uo,e.default=ho,e.deflate=io,e.deflateRaw=ao,e.gzip=no,e.inflate=so,e.inflateRaw=co,e.ungzip=lo,Object.defineProperty(e,"__esModule",{value:!0})}),cc._RF.pop()},{}],protocolView:[function(e,t,o){"use strict";cc._RF.push(t,"4f586lRtYZCvLhu0mNCm1LR","protocolView");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=e("../../StaticData/WorldNoticeTableData"),l=e("../../utils/GameTools"),d=cc._decorator,u=d.ccclass,h=d.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.m_txt_content=null,t.m_scrollView=null,t.m_nCurSelectType=0,t}return a(t,e),t.path=function(){return"ui/protocol/protocolView"},t.prototype.start=function(){var e=this;this.scheduleOnce(function(){e.onClickUserTab()},.3)},t.prototype.init=function(){},t.prototype.onClickUserTab=function(){1!=this.m_nCurSelectType&&(this.m_scrollView.getComponent(cc.ScrollView).content.removeAllChildren(),this.m_nCurSelectType=1,this.onShowContent(c.WorldNoticeTableData.getById(3).content))},t.prototype.onClickSecondTab=function(){2!=this.m_nCurSelectType&&(this.m_scrollView.getComponent(cc.ScrollView).content.removeAllChildren(),this.m_nCurSelectType=2,this.onShowContent(c.WorldNoticeTableData.getById(4).content))},t.prototype.onShowContent=function(e){var t=this,o=e.split("#");l.default.startFraming(o.length,function(e){var i=o[e],a=new cc.Node,n=a.addComponent(cc.RichText);a.parent=t.m_scrollView.getComponent(cc.ScrollView).content,a.active=!0,n.string=i,n.fontSize=18,n.maxWidth=860,n.cacheMode=cc.Label.CacheMode.CHAR,n.lineHeight=30}),this.m_scrollView.getComponent(cc.ScrollView).scrollToTop()},n([h(cc.RichText)],t.prototype,"m_txt_content",void 0),n([h(cc.ScrollView)],t.prototype,"m_scrollView",void 0),n([s.Register_Class,u],t)}(r.default);o.default=p,cc._RF.pop()},{"../../StaticData/WorldNoticeTableData":"WorldNoticeTableData","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../utils/GameTools":"GameTools"}],seedrandom:[function(e,t){"use strict";cc._RF.push(t,"a0091lipfBJK4PRgaSopHrE","seedrandom"),function(o,i,a){var n,r=256,s=6,c="random",l=a.pow(r,s),d=a.pow(2,52),u=2*d,h=r-1;function p(e,t,o){var n=[],h=_(m((t=1==t?{entropy:!0}:t||{}).entropy?[e,v(i)]:null==e?y():e,3),n),p=new f(n),C=function(){for(var e=p.g(s),t=l,o=0;e<d;)e=(e+o)*r,t*=r,o=p.g(1);for(;e>=u;)e/=2,t/=2,o>>>=1;return(e+o)/t};return C.int32=function(){return 0|p.g(4)},C.quick=function(){return p.g(4)/4294967296},C.double=C,_(v(p.S),i),(t.pass||o||function(e,t,o,i){return i&&(i.S&&g(i,p),e.state=function(){return g(p,{})}),o?(a[c]=e,t):e})(C,h,"global"in t?t.global:this==a,t.state)}function f(e){var t,o=e.length,i=this,a=0,n=i.i=i.j=0,s=i.S=[];for(o||(e=[o++]);a<r;)s[a]=a++;for(a=0;a<r;a++)s[a]=s[n=h&n+e[a%o]+(t=s[a])],s[n]=t;(i.g=function(e){for(var t,o=0,a=i.i,n=i.j,s=i.S;e--;)t=s[a=h&a+1],o=o*r+s[h&(s[a]=s[n=h&n+t])+(s[n]=t)];return i.i=a,i.j=n,o})(r)}function g(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function m(e,t){var o,i=[],a=typeof e;if(t&&"object"==a)for(o in e)try{i.push(m(e[o],t-1))}catch(n){}return i.length?i:"string"==a?e:e+"\0"}function _(e,t){for(var o,i=e+"",a=0;a<i.length;)t[h&a]=h&(o^=19*t[h&a])+i.charCodeAt(a++);return v(t)}function y(){try{var e;return n&&(e=n.randomBytes)?e=e(r):(e=new Uint8Array(r),(o.crypto||o.msCrypto).getRandomValues(e)),v(e)}catch(s){var t=o.navigator,a=t&&t.plugins;return[+new Date,o,a,o.screen,v(i)]}}function v(e){return String.fromCharCode.apply(0,e)}if(_(a.random(),i),"object"==typeof t&&t.exports){t.exports=p;try{n=e("crypto")}catch(C){}}else"function"==typeof define&&define.amd?define(function(){return p}):a["seed"+c]=p}("undefined"!=typeof self?self:void 0,[],Math),cc._RF.pop()},{crypto:76}],taskRewardTips:[function(e,t,o){"use strict";cc._RF.push(t,"d68edZRJwxNfJqisYm6beTO","taskRewardTips");var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var a,n=arguments.length,r=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(n<3?a(r):n>3?a(t,o,r):a(t,o))||r);return n>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../modules/base/BaseView"),s=e("../../modules/base/Decorators"),c=e("../../StaticData/TaskBoxTableData"),l=e("../../utils/ByteDanceMiniGameUtils"),d=e("../../utils/GamePlatform"),u=e("./TaskDayView"),h=cc._decorator,p=h.ccclass,f=h.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.m_nodeTaskRefresh=null,t.m_nodeTaskBox=null,t.m_nodeTaskVideo=null,t.m_arrLabel=[],t.gotoCb=null,t}return a(t,e),t.path=function(){return"ui/task/taskPrefabs/taskRewardTips"},t.prototype.start=function(){this.changeAdButtonSkins()},t.prototype.init=function(e){e.type==u.TIP_TYPE.TIP_TYPE_VIDEO?this.m_nodeTaskVideo.active=!0:e.type==u.TIP_TYPE.TIP_TYPE_BOX?(this.m_nodeTaskBox.active=!0,this.initBoxData(e.id)):this.m_nodeTaskRefresh.active=!0,e.cb&&(this.gotoCb=e.cb)},t.prototype.exitCallBack=function(){this.closeView()},t.prototype.gotoCallBack=function(){this.gotoCb&&(this.gotoCb(),this.exitCallBack())},t.prototype.initBoxData=function(e){var t=this;c.TaskBoxTableData.getDataMap().forEach(function(o){o.boxID==e&&o.strScop.forEach(function(e,o){t.m_arrLabel[o].string="x"+e})})},t.prototype.changeAdButtonSkins=function(){d.GamePlatform.isByteDanceMiniGame()&&l.default.getInstance().changeSkinOfAdButton(this.m_nodeTaskRefresh.getChildByName("goto"),"btn_refreshtask")},n([f(cc.Node)],t.prototype,"m_nodeTaskRefresh",void 0),n([f(cc.Node)],t.prototype,"m_nodeTaskBox",void 0),n([f(cc.Node)],t.prototype,"m_nodeTaskVideo",void 0),n([f(cc.Label)],t.prototype,"m_arrLabel",void 0),n([s.Register_Class,p],t)}(r.default);o.default=g,cc._RF.pop()},{"../../StaticData/TaskBoxTableData":"TaskBoxTableData","../../modules/base/BaseView":"BaseView","../../modules/base/Decorators":"Decorators","../../utils/ByteDanceMiniGameUtils":"ByteDanceMiniGameUtils","../../utils/GamePlatform":"GamePlatform","./TaskDayView":"TaskDayView"}]},{},["load","Global","GameGlobal","GameInstance","GlobalMsgListener","HotUpdatePanel","JsonExportToCSV","LoadMainSceneMap","MainSceneMap1","MainSceneMap2","MainSceneMap703","MainSceneMap704","MainSceneMap705","NextScenePanel","ActivityDayPrizeTableData","ActivityTableData","AnniversaryBattlePassTableData","AnniversaryCardTableData","AnniversaryRankListTableData","BaseTableData","BatchRandBossTableData","BattlePassTableData","CarSummonTableData","CarTalentTableData","CastleSkyBoxTableData","ChatChannelTableData","ClientIntDataTableData","ConfigIntTableData","CostGetTableData","DiscountRechargeTableData","DrawPrizePoolTableData","DrawPrizeTableData","EatChickenRankListTableData","ErrorCodeTableData","FogHiddenBoxTableData","FogHiddenPrizeTableData","GoldenLeagueRankListTableData","GoldenLeagueRewardTableData","GreatSailingRankListTableData","GreatSailingRefreshTableData","GreatSailingReliveTableData","GreatSailingTableData","GuidePlotTableData","HeroBubbleTableData","HeroSkinTableData","LegendTableData","LoadingBgTableData","LoadingTipsTableData","LuckyGiftSelectTableData","MachinariumBattlePassTableData","MachinariumCardTableData","MachinariumRankListTableData","MachinariumRewardTableData","MachinariumRotationTableData","ModifyNameNumTableData","NameTableData","NewerThreeDaysGiftTableData","OccupationRankListTableData","OnOffTableData","PetPrizeTableData","PetTableData","ProficiencyTableData","PushGiftTableData","QQHallRewardTableData","RandRechargeGroupTableData","RandShopItemTableData","RandShopPositionTableData","RandShopTableData","RankListPrizeTableData","RechargeTableData","RecruitTableData","RobotNickNameTableData","RobotTableData","RoleScoreFundTableData","RoyaleBattlePassTableData","RoyaleRangeTableData","RoyaleRankListTableData","RoyaleRoomTableData","SeasonTableData","SkyCastlePrizeTableData","SociatyAuctionTableData","SociatyBoxTableData","SociatyCourageMedalGainWayTableData","SociatyDonateNumTableData","SociatyDonateTableData","SociatyLevelTableData","SociatyRedEnvelopeTableData","SociatyWarRankListTableData","SociatyWarReliveTableData","SociatyWarRewardTableData","SoloSilverTableData","SoundTableData","StringValueTableData","SubGameTableData","TaskBoxTableData","TaskGroupTableData","TaskTableData","TotalWatchADBoxInfoClientTableData","TotalWatchADBoxTableData","VoucherRechargeTableData","WeekCooperationRankListTableData","WeekCooperationReliveTableData","WorldNoticeTableData","WorldTableData","TableReader","TalkingDataAPI","BatchModel","CombatManager","CombatStatistic","FightResultView","PlayerCombatModel","ShopModel","AI","CarSummon","PassiveSkill","Skill","Summon","BattleMap112","BuffObj","CarObj","CombatObj","DropEquipObj","DropMaterialsObj","FlyingObj","HeroObj","NpcObj","ObstacleObj","ButtonSafe","CombatModule","CommandValue","EventConst","NeedRestart","NetworkProtocolCommon","PlayerModule","GameController","Guide","GuideCommand","BattleGuideCfg","BattleSecondGuideCfg","BattleThreeGuideCfg","GuideConst","MatchingCoopGuideCfg","MatchingGuideCfg","GuideController","GuideFinish","GuideTrigger","Locator","NewHandFinish","EndGame","CardModel","ServerAddrInfo","AdapterComponent","BaseCtrl","BaseModel","BaseScene","BaseSingle","BaseView","Configuration","Decorators","GameView","UISuperItem","UISuperLayout","UISuperScrollView","EventManager","LoadResManager","ModelManager","NotificationManager","ViewManager","CheatManager","CheatTables","CheatValue","SafeNumber","SubGameManager","CheckCRC","ClientNetwork","CustomEventDef","FightNetwork","FightReconnectLayer","HttpClient","LocalMessage","LockStepManager","ReconnectLayer","ActivityProtocols","BaseProtocols","ChatProtocols","DataViewRW","FightProtocols","FriendProtocls","LoginProtocols","MatchProtocols","ObjCollection","RechargeProtocols","RoleProtocols","SociatyProtocols","TypeProtocols","long","ByteDanceMiniGameUtils","ConfigInt","ConfigUtils","ConstValue","DalanReportUtils","Debug","FontsManager","GameLoading","GamePlatform","GameTools","GameUtils","H5Utils","KSMinigameUtils","LeniuGameUtils","List","ListItem","LogUtil","MD5","NameManager","QQGameHallUtils","QQMiniGameUtils","RandomSeed","ResourceLoader","ResourcesConfig","ResourcesManager","RewardedVideoAd","RewardedVideoUnitIdConst","Sound","StringManager","TimeOffSetManager","Tools","UIManager","WechatUtils","base64","flyWord","pako","seedrandom","GameScheduler","GuideLayer","PopLayer","SingleNodeCache","SpineMaker","SubpackageTools","TypeDef","WaitingLayer","AcquirePopupView","AddCoopCountAdvertise","AddCoopCountAdvertiseByQQ","AssistBattleView","CDKEYView","CardItemView","DetainmentView","EquipTempView","ExchangeCodeView","FightCardView","FightTopView","GameClubTaskItem","GameClubView","LoadView","LoginView","LoopRollMsg","LuckyGiftSelectRewardView","MainSceneView","MarqueeView","NavigationBarView","QQExchange","RandomHeroView","RebootClientView","ReceiveRewardView","SelectHeroCardRewardView","TipPopWindowView","TopView","ActivityFristRechargeView","ActivityGoldenLeagueIntroduceView","ActivityGoldenLeagueMatch","ActivityGoldenLeagueRanktem","ActivityGoldenLeagueRewardtem","ActivityGoldenLeagueView","ActivityMainView","ActivityModule","AdJumpTipView","AdvertisingBoxPreview","AdvertisingGiftsGuangGaoView","AdvertisingGiftsMainView","AdvertisingGiftsMengXinView","AdvertisingGiftsView","AdvertisingOriginView","AnniversaryBattlePassBuyView","AnniversaryBattlePassItem","AnniversaryBattlePassView","AnniversaryBoxIntroduceView","AnniversaryCtrl","AnniversaryIntroduceView","AnniversaryMainView","AnniversaryModule","AnniversaryRankView","AnniversaryRechargeView","AnniversaryReturnBackView","AnniversaryShopView","AnnouncementView","BattleDetailsView","BattlePassIntroduceView","BattlePassRewardPreview","BattlePassSelectView","BattlePassView","BattleRoomMainView","MatchMainView","ChannelsLiveIntroduceView","ChannelsLiveTaskItem","ChannelsLiveView","ActivityChatPanel","ChatItem","ChatMainView","FriendChatPanel","SociatyChatPanel","SystemChatPanel","TeamChatPanel","WeekCooperationChatPanel","WorldChatPanel","ChickenDinnerIntroduceView","ChickenDinnerMainView","ChickenDinnerRanktem","ChickenDinnerSettlementView","ChickenDinnerSwordDetailedView","DrawCardIntroduceView","DrawCardMainCtrl","DrawCardMainView","DrawCardOptionalBoxView","DrawCardShowView","DrawNewHeroCardView","fightPlayersInfoView","FirstCharge","FogHiddenBattlePassBuyView","FogHiddenBattlePassItem","FogHiddenBattlePassView","FogHiddenBoxIntroduceView","FogHiddenCtrl","FogHiddenHelpView","FogHiddenMainView","FogHiddenModel","FogHiddenRankView","FogHiddenRechargeView","FogHiddenRewardsView","FogHiddenShopIntroduceView","FogHiddenShopView","FriendApplyItem","FriendInfoView","FriendItem","FriendMainView","FriendPopupTips","FriendRecommendItem","FriendTips","GuidePlot","GuideTalk","BattleCardInfo","CardUpgrade","CardView","HeroCardEditTabView","HeroCardInfoView","HeroCardsMainView","HeroSkinUtils","HeroSkinView","HeroUnlockGroupTipView","ProficiencyHelp","InviteFriendView","LegendCtrl","LegendIntroduceView","LegendPalacePreview","LegendPalaceView","LegendView","RewardsPreviewView","VOLegendControl","MachineryCityBattlePassBuyView","MachineryCityBattlePassItem","MachineryCityBattlePassView","MachineryCityBoxIntroduceView","MachineryCityCardGropuView","MachineryCityChatItem","MachineryCityChatView","MachineryCityCtrl","MachineryCityHelpView","MachineryCityMainView","MachineryCityModel","MachineryCityRankView","MachineryCityRechargeView","MachineryCityShopIntroduceView","MachineryCityShopView","MachineryCitySociatyMemberRankItem","MachineryCitySociatyRankItem","MailCtrl","MailUtils","MailView","CarSkinUtils","ChangeCarSkinView","NavigationIntroduceView","NavigationMainView","NavigationRankItem","NavigationShopItem","HeroGroupProficiency","PlayerChangeNameView","PlayerHeadView","PlayerInfoView","PrivacyProtocolView","UserProtocolView","protocolView","NewerThreeDaysGiftUtils","NewerThreeDaysGiftView","PushGiftUtils","PushGiftView","PveRewards","PveTemplate","PveView","QQBlueReview","QQBlueReviewItem","QQBlueVipView","QQHallListItem","QQHallVipView","RankListItem","RankListView","RoyaleBattlePassBuyView","RoyaleBattlePassHelpView","RoyaleBattlePassItem","RoyaleBattlePassView","RoyaleIntroduceView","RoyaleMainView","RoyaleRechargeView","RoyaleShopView","RoyaleUtils","SeasonClosingView","ServerListItem","ServerListMainView","LookVideoView","PopUpBuyView","ShopConfirmBuy","ShopContinuousRechargeTipView","ShopHelpView","ShopMainCtrl","ShopMainView","VoucherConfirmBuy","SkyCastleArenaView","SkyCastleBoxHelpView","SkyCastleBoxItem","SkyCastleBoxView","SkyCastleCtrl","SkyCastleHelpView","SkyCastleModule","SkyCastleRechargeView","SkyCastleShopItem","SkyCastleShopView","SkyCastleUtils","NotJoinedSociatyview","SociatyApplyItem","SociatyApplyView","SociatyAuctionAttentionView","SociatyAuctionDetailsView","SociatyAuctionItem","SociatyAuctionLogItem","SociatyAuctionLogView","SociatyAuctionView","SociatyBoxIntroduceView","SociatyBoxItem","SociatyBoxOriginView","SociatyBoxView","SociatyChatModel","SociatyChatView","SociatyCreateRedEnvelopeView","SociatyCreateView","SociatyCtrl","SociatyDonateView","SociatyFightMatchView","SociatyFightMemberRankItem","SociatyFightRankItem","SociatyFightRankView","SociatyFightTipView","SociatyFightView","SociatyInfoView","SociatyInvitedItem","SociatyInvitedView","SociatyJoinSuccessView","SociatyMainView","SociatyMemberBigItem","SociatyMemberItem","SociatyMemberView","SociatyModel","SociatyOpenRedEnvelopeView","SociatyRecommendItem","SociatyRedEnvelopeTipView","SociatyRuleView","SociatySearchView","SociatyShopItem","SociatyShopTipView","SociatyShopView","SubGameHallItem","SubGameHallView","SweepMainView","TaskAchRewardItem","TaskAchRewardView","TaskAchievementItem","TaskAchievementView","TaskDayItem","TaskDayView","TaskView","taskRewardTips","VipServiceView","WeekCooperationReliveIntroduceView","WeekCooperationReliveMainView","WeekCooperationReliveRewardsView","WeekCooperationReviveView"]);